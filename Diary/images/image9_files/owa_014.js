self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentSuggestions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[106],{1315:function(e){e.exports={b:"Caa",d:"Daa",c:"Eaa",a:"Faa"}},1586:function(e,t,r){"use strict";var n=r(934),a={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function o(e){switch(e?e.toLowerCase():null){case a.ONE_DRIVE_PRO.toLowerCase():return 0;case a.GDRIVE.toLowerCase():return 5;case a.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case a.DROPBOX.toLowerCase():return 2;case a.BOX.toLowerCase():return 3;case a.WOPI_BOX.toLowerCase():return 7;case a.WOPI_EGNYTE.toLowerCase():return 8;case a.MAILBOX.toLowerCase():return 4;case a.FACEBOOK.toLowerCase():return 6;default:return null}}function i(e){return null==e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:n.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}function c(e){return null==e?null:{fileType:n.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:e.Thumbnail?e.Thumbnail.Url:"",previewUrl:e.Preview?e.Preview.Url:"",type:e.MimeType}}function u(e){if(!e)return null;for(var t=[],r=0;r<e.length;r++){var a=e[r],o={fileType:n.a.Local,name:a.name,size:a.size,type:a.type,fileObject:a};t.push(o)}return t}function s(e,t,r){var a=[],o={fileType:n.a.MailItem,name:e,size:r||0,mimeContent:t};return a.push(o),a}var d=r(12);function l(e,t,r){if(e.length!=t.length)return d.c.error("The sizes of subjects and latestItemIds are different"),null;for(var a=[],o=0;o<e.length;o++){var i={fileType:n.a.MailItem,name:e[o],size:r&&r[o]||0,itemId:t[o]};a.push(i)}return a}var f=r(494);function h(e){return e.map(function(e){return{fileType:n.a.Uri,name:e.name,type:Object(f.a)(e.url),size:0,uri:e.url}})}r.d(t,"b",function(){return o}),r.d(t,"e",function(){return u}),r.d(t,"g",function(){return l}),r.d(t,"c",function(){return i}),r.d(t,"d",function(){return c}),r.d(t,"h",function(){return h}),r.d(t,"f",function(){return s}),r.d(t,"a",function(){return n.a})},2569:function(e,t,r){"use strict";r.r(t);var n=r(1),a=Object(n.action)("getAttachmentSuggestionsAction",function(e){return{referenceItemId:e}}),o=r(31),i=Object(n.action)("storeAttachmentSuggestionsOnItemAction",function(e,t){return{referenceItemId:e,attachmentSuggestions:t}}),c=(Object(n.mutator)(i,function(e){var t=o.H.items.get(e.referenceItemId);t&&(t.AttachmentSuggestions=e.attachmentSuggestions)}),Object(n.action)("storeContextualMRUSuggestionsOnItemAction",function(e,t){return{referenceItemId:e,contextualSuggestions:t}})),u=(Object(n.mutator)(c,function(e){var t=o.H.items.get(e.referenceItemId);t&&(t.ContextualAttachmentSuggestions=e.contextualSuggestions)}),r(1600)),s=Object(n.action)("storeMRUSuggestionsAction",function(e){return{mruAttachments:e}}),d=(Object(n.mutator)(s,function(e){Object(u.a)().attachments=e.mruAttachments}),Object(n.action)("getContextualMRUSuggestionsAction",function(e){return{referenceItemId:e}})),l=Object(n.action)("getMRUSuggestionsAction"),f=Object(n.action)("getReplyWithSuggestionsAction",function(e){return{referenceItemId:e}}),h=r(5);Object(n.orchestrator)(a,function(e){Object(h.d)("mc-replyWithContextualMRU")&&e.referenceItemId?d(e.referenceItemId):((Object(h.d)("mc-replyWith")||Object(h.d)("mc-replyWithNAMPrime")||Object(h.d)("mc-replyWithContextual"))&&f(e.referenceItemId),(Object(h.d)("mc-replyWith")||Object(h.d)("mc-replyWithNAMPrime")||Object(h.d)("mc-replyWithMRUClassic")||Object(h.d)("mc-replyWithMRUCloudy"))&&l())});var m=r(0),p=r(12);function v(e){try{var t=!!e.Source.LastShared&&!e.Source.WebUrl,r=e.Source.Author?e.Source.Author.DisplayName:"";return{Author:r,CreatedBy:r,DateAccessed:e.Source.LastAccessDateTime,DateCreated:null,DateModified:e.Source.LastModifiedDateTime,Endpoint:t?2:1,FileExtension:e.Source.FileExtension,FileName:e.Source.FileName,FileSize:e.Source.FileSize,FileSourceType:e.ContentSource||e.Provenance,Id:t?e.Source.LastShared.AttachmentId:e.Id,ModifiedBy:b(e),ReferenceId:e.ReferenceId,SourceTitle:e.Source.SiteTitle||e.Source.LastShared.SharingSubject,Text:e.Source.Title,Title:e.Source.Title,Url:e.Source.Url}}catch(e){return p.c.info("[convertMRUAttachmentToReplyWithAttachmentSuggestion] Error accessing MRUAttachment properties: "+e.message),null}}function b(e){return e.Source.LastModifiedBy?e.Source.LastModifiedBy.DisplayName:e.Source.LastShared.SharedBy.DisplayName}var g=r(18),O=r(242),y=r(282),S="application/json;charset=utf-8",I="/search/api/v1/recommendations",j="recEnableSharedClassicAttachments",_="maxMRUFiles1",A="suggestedattachments";function w(e){return m.__awaiter(this,void 0,void 0,function(){var t,r,n,a,o,i,c,u,s,d,l;return m.__generator(this,function(f){switch(f.label){case 0:t=null,r=0,n="",a=null,f.label=1;case 1:return f.trys.push([1,7,8,9]),Object(g.o)("MRUQueryExecuted"),a=new g.a("QueryResponseInformation",{logVerbose:!0}),o=Object(h.d)("mc-replyWithMRUClassic"),a.addCustomData({endpoint:1}),[4,P()];case 2:return i=f.sent(),c=function(e,t,r){var n={};n.headers=new Headers,n.headers.set("Authorization","Bearer "+e),n.headers.set("Content-Type",S),n.method="POST";var a=Object(O.getDefaultAnchorMailboxCookie)();a&&n.headers.append("X-AnchorMailbox",a);n.headers.set("X-Client-LocalTime",(new Date).toISOString());var o=[];r?o.push(A):t&&(o.push(j),Object(h.d)("mc-replyWithMRUCloudyLimited")&&o.push(_));o.length&&n.headers.set("X-Client-Flights",o.join(","));var i={EntityRequests:[r?{Context:{EntityId:r}}:{}],Scenario:{Name:"AttachFile"}};return n.body=JSON.stringify(i),n}(i,o,e),a.addCheckmark("Request"),[4,fetch(I,c)];case 3:return u=f.sent(),a.addCheckmark("Response"),u&&200==u.status?[4,u.text()]:[3,5];case 4:return s=f.sent(),d=JSON.parse(s),t=function(e){try{var t=e.EntitySets[0].ResultSets[0].Results;return t.map(v)}catch(e){return p.c.info("[fetchMRUSuggestions_getAttachmentsFromResponse] Error: "+e.message),[]}}(d),r=t.length,[3,6];case 5:n=u?u.status+"-"+u.statusText:"No response",f.label=6;case 6:return[3,9];case 7:return l=f.sent(),n=l.message,[3,9];case 8:return n&&p.c.info("getMRUSuggestions: Error "+n),a.addCustomData({numResults:r}),n?a.endWithError("ServerError",new Error(n)):a.end(),[2,t];case 9:return[2]}})})}function P(){return m.__awaiter(this,void 0,void 0,function(){var e,t,r;return m.__generator(this,function(n){switch(n.label){case 0:return e=m.__read(Object(y.getAccessTokenforResourceAsLazy)(window.location.origin),2),t=e[0],r=e[1],t?[3,2]:[4,r];case 1:t=n.sent(),n.label=2;case 2:return[2,t]}})})}Object(n.orchestrator)(d,function(e){return m.__awaiter(this,void 0,void 0,function(){var t,r;return m.__generator(this,function(n){switch(n.label){case 0:return t=e.referenceItemId,o.H.items.get(t)?[4,w(t)]:[3,2];case 1:r=n.sent(),c(t,r),n.label=2;case 2:return[2]}})})}),Object(n.orchestrator)(l,function(){return m.__awaiter(this,void 0,void 0,function(){var e;return m.__generator(this,function(t){switch(t.label){case 0:return[4,w(null)];case 1:return(e=t.sent())&&s(e),[2]}})})});var C=r(661),E=r(660),R=r(226),x=r.n(R),T=r(385),D=r.n(T),M="EntityExtraction/SubstrateSearchSuggestions",U="EntityExtraction/ReplyWithQueryCoverage",F=x()({PropertyName:M,DistinguishedPropertySetId:"Common",PropertyType:"String"}),L=x()({PropertyName:U,DistinguishedPropertySetId:"Common",PropertyType:"String"});function N(e){return m.__awaiter(this,void 0,void 0,function(){var t,r,n,a,o;return m.__generator(this,function(i){switch(i.label){case 0:return null!=(t=k(e)).SubstrateSearchSuggestions||null!=t.ReplyWithQueryCoverage?[3,2]:(r=D()({BaseShape:"IdOnly",AdditionalProperties:[F,L]}),[4,Object(C.a)([e.ItemId.Id],r,null,null,e.MailboxInfo&&e.MailboxInfo.requestOptions)]);case 1:n=i.sent(),Object(E.a)(n[0])&&((a=n[0])&&a.Items&&a.Items[0]?(o=a.Items[0],t=k(o)):p.c.info("getReplyWithProperties: Unable to parse GetItem response properly.")),i.label=2;case 2:return[2,t]}})})}function k(e){var t={SubstrateSearchSuggestions:null,ReplyWithQueryCoverage:null},r=e.ExtendedProperty;if(r)for(var n=r.length,a=0;a<n;a++){var o=r[a];o.ExtendedFieldURI.PropertyName===M?t.SubstrateSearchSuggestions=o:o.ExtendedFieldURI.PropertyName===U&&(t.ReplyWithQueryCoverage=o)}return t}var W=r(75),B="/ows/search/api/v1/";function z(e){return m.__awaiter(this,void 0,void 0,function(){var t,r,n,a,o=this;return m.__generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t=function(e){var t={},r=function(e){var t=[];if(null!=e.ReplyWithQueryCoverage)for(var r=JSON.parse(e.ReplyWithQueryCoverage.Value)[0],n=r.coverageCheckResults,a=Object.keys(n),o=0;o<a.length;o++){var i=a[o];n[i]||t.push(i)}return t}(e);return JSON.parse(e.SubstrateSearchSuggestions.Value)[0].requests.forEach(function(e){var n=e.InputText;if(!r.includes(n)){var a=function(e,t){for(var r,n,a=B+e,o=0;o<t.length;o++)r=t[o].Key,n=t[o].Value,a+=0==o?"?":"&",a+=r+"="+n;return a}(e.Endpoint,e.UrlParameters);t[n]=a}}),t}(e),r={},(n=Object.keys(t)).length>0?(Object(g.o)("ReplyWithQueryExecuted"),[4,Promise.all(n.map(function(e){return m.__awaiter(o,void 0,void 0,function(){var n,a;return m.__generator(this,function(o){switch(o.label){case 0:return n=r,a=e,[4,G(t[e])];case 1:return[2,n[a]=o.sent()]}})})}))]):[3,2];case 1:return i.sent(),[2,V(r)];case 2:return[3,4];case 3:return a=i.sent(),p.c.info("Failed to parse property, error: "+a.message),[3,4];case 4:return[2,null]}})})}function G(e){return m.__awaiter(this,void 0,void 0,function(){var t,r,n,a,o;return m.__generator(this,function(i){switch(i.label){case 0:t=null,r=0,n="",a=null,i.label=1;case 1:return i.trys.push([1,3,4,5]),(a=new g.a("QueryResponseInformation")).addCustomData({endpoint:0}),[4,Object(W.b)(e)];case 2:return t=i.sent(),a.addCheckmark("Response"),t&&0!=t.length||(n="No response payload"),[3,5];case 3:return o=i.sent(),n=o.message,[3,5];case 4:return r=function(e){try{return e.Groups[0].Suggestions.length}catch(e){return 0}}(t),a.addCustomData({numResults:r}),n?a.endWithError("ServerError",new Error(n)):a.end(),[2,t];case 5:return[2]}})})}function V(e){try{var t={};return Object.keys(e).forEach(function(r){t[r]=e[r].Groups[0].Suggestions;for(var n=0;n<t[r].length;n++)t[r][n].Endpoint=0}),t}catch(e){return p.c.info("getSentenceToAttachmentSuggestionsMap: Failed to execute, error: "+e.message),null}}function X(e){return m.__awaiter(this,void 0,void 0,function(){var t,r;return m.__generator(this,function(n){switch(n.label){case 0:return t=null,[4,N(e)];case 1:return(r=n.sent())?[4,z(r)]:[3,3];case 2:t=n.sent(),n.label=3;case 3:return[2,t]}})})}Object(n.orchestrator)(f,function(e){return m.__awaiter(this,void 0,void 0,function(){var t,r,n;return m.__generator(this,function(a){switch(a.label){case 0:return t=e.referenceItemId,!(r=o.H.items.get(t))||r.AttachmentSuggestions?[3,2]:[4,X(r)];case 1:n=a.sent(),i(t,n),a.label=2;case 2:return[2]}})})});var H=r(1586),Q=r(3676);function q(e,t){return m.__awaiter(this,void 0,void 0,function(){var r;return m.__generator(this,function(n){switch(n.label){case 0:return r=null,Object(Q.i)()!==Q.c.NotLoaded?[3,2]:[4,Q.k.import()];case 1:return n.sent()(function(n){r=J(Object(Q.g)(),e),t(r)}),[3,3];case 2:r=J(Object(Q.g)(),e),t(r),n.label=3;case 3:return[2]}})})}function J(e,t){var r=function(e){for(var t=0;t<e.length;t++)if(0==e[t].type)return e[t].model.Id;return p.c.warn("createCloudFileFromAttachmentData: Could not get OneDrive Pro provider ID. Attachment will not upload."),""}(e);return{fileType:H.a.CloudSuggestion,name:t.FileName,size:null,providerId:r,providerType:0,location:t.Url,providerEndpointUrl:null,isFolder:!1,fileId:t.Id,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:null}}r.d(t,"getAttachmentSuggestionsAction",function(){return a}),r.d(t,"createCloudFileFromAttachmentData",function(){return q})},3621:function(e,t,r){"use strict";var n=r(1),a=r(8),o=r(3724),i={providers:new a.ObservableMap,loadState:o.a.NotLoaded,removalPending:new a.ObservableMap},c=Object(n.createStore)("fileProviderStoreV2",i);t.a=c},3627:function(e,t,r){"use strict";r.d(t,"b",function(){return o}),r.d(t,"a",function(){return a}),r.d(t,"c",function(){return i});var n=r(1),a=Object(n.action)("FILE_PROVIDER_ADDED",function(e){return{providerViewState:e}}),o=Object(n.action)("FILE_PROVIDER_REMOVED",function(e){return{providerType:e}}),i=Object(n.action)("PROVIDERS_LOADED",function(e){return{providers:e}})},3640:function(e,t,r){"use strict";var n=r(0),a=r(4199),o=r.n(a),i=r(3878),c=r.n(i);function u(e){var t=c()({ProviderType:e});return o()(t)}var s=r(4200),d=r.n(s),l=r(3879),f=r.n(l);function h(e){var t=f()({ProviderType:e});return d()(t)}var m=r(4145),p=r(5);r.d(t,"a",function(){return j}),r.d(t,"b",function(){return w});var v="code",b="token",g=3e3,O=3;function y(e){return{state:e}}function S(e){return e.state}function I(e){return e.code}function j(e,t,r,a,o){var i={providerType:e,getAuthUrlInfo:null,getCSRFToken:S,getOAuthCode:I};return function e(t,r,a,o,i,c,s){return n.__awaiter(this,void 0,void 0,function(){var d,l;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),d=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,h(t)];case 1:return l=n.sent(),d=l.AttachmentDataProviderCreator.ProviderAppKey,a=l.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,u(t)];case 3:l=n.sent(),d=l.ProviderAppKey,n.label=4;case 4:return r.getAuthUrlInfo=Object(m.d)(t,a,o,d,i,c),[3,6];case 5:return n.sent(),s>0&&setTimeout(function(){return e(t,r,a,o,i,c,--s)},g),[3,6];case 6:return[2]}})})}(e,i,t,r,a,o,O),i}var _=null;function A(){if(!_){(_={})[3]=j(3,"https://app.box.com/api/oauth2/authorize",Object(m.c)(3),v,y),_[2]=j(2,"https://www.dropbox.com/oauth2/authorize",Object(m.b)(2),v,y);var e=j(6,"https://www.facebook.com/dialog/oauth",Object(m.b)(6),b,function(e){return{state:e,scope:"user_photos,email"}});e.getCSRFToken=S,e.getOAuthCode=function(e){return e.access_token},_[6]=e;var t=j(5,"https://accounts.google.com/o/oauth2/auth",m.a+"/ADPRedirect.aspx",v,function(e){var t={state:e,provider:5..toString(),url:Object(m.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});t.getCSRFToken=function(e){return JSON.parse(e.state).state},_[5]=t,_[1]=j(1,"https://login.live.com/oauth20_authorize.srf",Object(m.c)(1),v,function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}),Object(p.d)("doc-fileProvider-wopiClient")&&(_[7]=j(7,"",Object(m.c)(7),v,y),_[8]=j(8,"",Object(m.c)(8),v,y),_[9]=j(9,"",Object(m.c)(9),v,y))}return _}function w(e){var t=A();return e in t?t[e]:null}},3660:function(e,t,r){"use strict";r.d(t,"b",function(){return o}),r.d(t,"a",function(){return i});var n=r(0),a=r(3621),o=function(){return n.__spread(Object(a.a)().providers.values())},i=function(e){return Object(a.a)().providers.get(e)||null}},3676:function(e,t,r){"use strict";var n=r(3823),a=r(3794),o=(r(3621),r(3627)),i=r(3685),c=(r(4112),r(4080),r(3660));var u=r(3780),s=r(3),d=r(3724),l=r(3640);r.d(t,"k",function(){return h}),r.d(t,"m",function(){return m}),r.d(t,"j",function(){return p}),r.d(t,"l",function(){return v}),r.d(t,"a",function(){return i.b}),r.d(t,"b",function(){return n.a}),r.d(t,"f",function(){return l.b}),r.d(t,"c",function(){return d.a}),r.d(t,"d",function(){return o.a}),r.d(t,"e",function(){return o.b}),r.d(t,"h",function(){return a.a}),r.d(t,"i",function(){return u.a}),r.d(t,"g",function(){return c.b}),r.d(t,"n",function(){return o.c});var f=new s.c(function(){return Promise.all([r.e(0),r.e(1),r.e(2),r.e(6),r.e(200)]).then(r.bind(null,11732))}),h=new s.b(f,function(e){return e.loadProviders}),m=new s.b(f,function(e){return e.removeFileProvider}),p=new s.b(f,function(e){return e.addFileProvider}),v=new s.b(f,function(e){return e.removeAndAddFileProvider})},3685:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return o}),r.d(t,"c",function(){return i});var n,a=r(0);!function(e){e[e.Groups=1e4]="Groups"}(n||(n={}));var o=Object.freeze([1,3,2,6,5,7,8,9]),i=Object.freeze(a.__spread(o,[0,4,10]))},3724:function(e,t,r){"use strict";var n;r.d(t,"a",function(){return n}),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(n||(n={}))},3780:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r(3621);function a(){return Object(n.a)().loadState}},3794:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n=r(4198),a=r(4079),o=r(4159),i=r(4),c=r(98);function u(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:case 1:return Object(i.a)(o.a);case 2:case 9:return Object(i.a)(n.b);case 3:case 7:return Object(i.a)(n.a);case 5:return Object(i.a)(n.e);case 6:return Object(i.a)(n.d);case 4:return Object(i.a)(n.f);case 10:return Object(i.a)(a.b);case 8:return Object(i.a)(n.c);default:return Object(c.a)(e)}}},3823:function(e,t,r){"use strict";var n;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(n||(n={})),t.a=n},3878:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.default=function(e){return n.__assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}},3879:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.default=function(e){return n.__assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}},4079:function(e){e.exports={a:"Bda",b:"Cda"}},4080:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var n=r(9),a=r(56),o=r(98),i=r(5);function c(e){var t=Object(n.a)();switch(e){case 5:return Object(a.a)()&&t.AttachmentPolicy.GoogleDriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 4:case 0:return!0;case 3:return Object(a.a)()&&t.AttachmentPolicy.BoxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 2:return Object(a.a)()&&t.AttachmentPolicy.DropboxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 6:return Object(a.a)()&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(i.d)("doc-fileProvider-facebook");case 1:return!!Object(a.a)()||Object(i.d)("doc-filePicker-oneDriveConsumerForO365")&&t.AttachmentPolicy.OnedriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 10:return Object(i.d)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(i.d)("doc-fileProvider-wopiClient");default:return Object(o.a)(e)}}},4112:function(e,t,r){"use strict";r.d(t,"a",function(){return a}),r.d(t,"b",function(){return o});var n=r(3685),a="file provider is not addable";function o(e){return n.a.indexOf(e)>-1}},4145:function(e,t,r){"use strict";var n=r(41),a=r(15);function o(e,t,r){if(!e||!t||!r)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+r:e+"?"+t+"="+r}r.d(t,"a",function(){return i}),r.d(t,"b",function(){return c}),r.d(t,"c",function(){return u}),r.d(t,"d",function(){return s});var i=Object(a.y)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){var t=e?encodeURIComponent("?provider="+e):"",r=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(n.n)()+"/mail/"+r+t}function u(e){var t=Object(n.n)()+"/mail/AddFileProvider.html",r=encodeURIComponent("provider="+e+"&url="+t);return i+"/ADPRedirect.aspx?"+r}function s(e,t,r,n,a,i){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,r=[],n=0;n<16;n++)r.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+r.join("")}(),c=o(t,"client_id",n);if(c=o(c,"redirect_uri",r),c=o(c,"response_type",a),i){var u=i(e);c=Object.keys(u).reduce(function(e,t){return o(e,t,u[t])},c)}return{authUrl:c,redirectUrl:r,csrfToken:e}}}},4159:function(e){e.exports={a:"Ada"}},4198:function(e){e.exports={b:"uda",a:"vda",e:"wda",d:"xda",f:"yda",c:"zda"}},4199:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(59),a=r(3878);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),n.makeServiceRequest("GetNewAttachmentDataProviderCreationInfo",e,t)}},4200:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(59),a=r(3879);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),n.makeServiceRequest("GetAttachmentDataProviderCreator",e,t)}},494:function(e,t,r){"use strict";function n(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function a(e){var t=n(e);return t?t.replace(".",""):null}var o=r(1315),i=r(4);function c(e){var t;return e>=1073741824?(e/=1073741824,t=Object(i.a)(o.b)):e>=1048576?(e/=1048576,t=Object(i.a)(o.d)):e>=1024?(e/=1024,t=Object(i.a)(o.c)):t=Object(i.a)(o.a),Object(i.b)(t,Math.round(e))}function u(e){return e&&(t=e,(r=d.exec(t))&&r.length>1&&s[r[1].toLowerCase()]);var t,r}var s={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},d=/^\s*([^;\s]*)(?:;|\s|$)/;var l=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"];function f(e,t){var r=n(e)||u(t);return!!r&&l.indexOf(r.toLowerCase())>=0}var h=r(5),m=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function p(e){if(!Object(h.d)("doc-attachment-documentThumbnail"))return!1;var t=n(e);return!!t&&m.indexOf(t.toLowerCase())>=0}r.d(t,"a",function(){return n}),r.d(t,"b",function(){return a}),r.d(t,"e",function(){return c}),r.d(t,"c",function(){return f}),r.d(t,"d",function(){return p})},934:function(e,t,r){"use strict";var n;r.d(t,"a",function(){return n}),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown"}(n||(n={}))}},0,[0,1,30,474,155,2,6,200,463,87,464,98]]);
//# sourceMappingURL=owa.AttachmentSuggestions.js.map
self.scriptsLoaded['owa.AttachmentSuggestions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentSuggestions.js'] = (new Date()).getTime();