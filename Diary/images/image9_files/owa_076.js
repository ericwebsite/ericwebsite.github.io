self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AccCheckerPlugin.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[83],{1452:function(t,e,r){"use strict";var o=r(0),n=r(2),i=r(338),a=r(131),c=r(801),l=r(14),s=r(333),u=r(339),d=r(435),p=r(881),h=Object(s.b)(function(t,e,r){var o=Object(u.a)(t),n=Object(d.a)(t),i={root:{minWidth:"80px",height:"32px"},label:{fontWeight:l.FontWeights.semibold}};return Object(l.concatStyleSets)(o,i,r?Object(p.a)(t):Object(p.b)(t),n,e)});r.d(e,"a",function(){return f});var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._skipComponentRefResolution=!0,e}return o.__extends(e,t),e.prototype.render=function(){var t=this.props,e=t.primary,r=void 0!==e&&e,c=t.styles,l=t.theme;return n.createElement(i.a,o.__assign({},this.props,{variantClassName:r?"ms-Button--primary":"ms-Button--default",styles:h(l,c,r),onRenderDescription:a.b}))},e=o.__decorate([Object(c.a)("DefaultButton",["theme","styles"],!0)],e)}(a.a)},186:function(t,e,r){"use strict";var o=r(8),n=(r(2),r(70)),i=r(450),a=r(3),c=new a.c(function(){return r.e(772).then(r.t.bind(null,11591,7))}),l=new a.b(c,function(t){return t.default}),s=r(27);function u(t){if("string"==typeof t||Array.isArray(t))return t;var e=Object(s.f)().UserOptions,r=(void 0===e?{}:e).KeyboardShortcutsMode;switch(void 0===r?"":r){case 0:return t.hotmail;case 2:return t.yahoo;case 3:return t.gmail;case 4:return t.owa;default:return}}function d(t,e){if(t.ctrlKey||t.altKey||t.metaKey||e)return!1;var r=t.target;return"INPUT"==r.tagName||"SELECT"==r.tagName||"TEXTAREA"==r.tagName||r.contentEditable&&"true"==r.contentEditable}var p="__keydownHandlerMap",h="__keydownHandlerHooksAdded";function f(t,e,r,a){return void 0===e&&(e=!0),void 0===r&&(r=!0),void 0===a&&(a=!1),function(c,s,f){if("object"==typeof window&&(c[p]=c[p]||{},c[p][s]={command:Object(i.a)(t),stopPropagation:e,preventDefault:r,allowHotkeyOnTextFields:a},!c[h])){var g=c.componentDidMount;c.componentDidMount=function(){var t=this;g&&g.call(this);var e,r=l.import(),i=function(){t.__mousetrap&&t.__mousetrap.reset(),e&&e()},a=r.then(function(r){t.__mousetrap=new r(n.findDOMNode(t)),e=Object(o.autorun)(function(t){var e=this;this.__mousetrap.reset();for(var r=t[p],o=Object.keys(r),n=function(n){var a=o[n],c=u(r[a].command);c&&i.__mousetrap.bind(c,function(o){d(o,r[a].allowHotkeyOnTextFields)||(r[a].stopPropagation&&o.stopPropagation(),r[a].preventDefault&&o.preventDefault(),t[a].call(e,o))})},i=this,a=0;a<o.length;a++)n(a)}.bind(t,c))}).catch(i);this.__cleanupMousetrap=a.then(function(){return i})};var b=c.componentWillUnmount;c.componentWillUnmount=function(){b&&b.call(this),this.__cleanupMousetrap&&this.__cleanupMousetrap.then(function(t){return t()})},c[h]=!0}}}var g=r(0);function b(t,e,r){var n=void 0===r?{}:r,a=n.allowHotkeyOnTextFields,c=void 0!==a&&a,s=n.isEnabled,d=n.stopPropagation,p=void 0===d||d,h=n.preventDefault,f=void 0===h||h;return g.__awaiter(this,void 0,void 0,function(){var r,n,a,d;return g.__generator(this,function(h){switch(h.label){case 0:return[4,l.import()];case 1:return r=h.sent(),n=new r(document.body),a=function(t){return u(t=Object(i.a)(t))}(t),d=Object(o.autorun)(function(){!function(t,e,r){t.reset(),e&&t.bind(e,r)}(n,a,m(c,s,p,f,e))}),[2,function(){n.reset(),d()}]}})})}function m(t,e,r,o,n){return function(i){d(i,t)||e&&!e()||(r&&i.stopPropagation(),o&&i.preventDefault(),n())}}r.d(e,"c",function(){return f}),r.d(e,"a",function(){return b}),r.d(e,"b",function(){return i.a})},4077:function(t,e,r){"use strict";r.d(e,"b",function(){return i}),r.d(e,"a",function(){return a});var o=r(3),n=new o.c(function(){return Promise.all([r.e(483),r.e(206)]).then(r.bind(null,4906))}),i=new o.a(n,function(t){return t.mountAndShowFlexPane}),a=new o.a(n,function(t){return t.hideFlexPane})},435:function(t,e,r){"use strict";r.d(e,"a",function(){return i});var o=r(14),n=r(333),i=Object(n.b)(function(t,e){var r={position:"absolute",width:1,right:31,top:8,bottom:8},n={splitButtonContainer:[Object(o.getFocusStyle)(t,{highContrastStyle:{left:-2,top:-2,bottom:-2,right:-2,border:"none"}}),{display:"inline-flex"}],splitButtonContainerFocused:{outline:"none!important"},splitButtonMenuButton:{padding:6,height:"auto",boxSizing:"border-box",border:0,borderRadius:0,outline:"transparent",userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",width:32,marginLeft:-1,marginTop:0,marginRight:0,marginBottom:0},splitButtonDivider:r,splitButtonDividerDisabled:r,splitButtonMenuButtonDisabled:{pointerEvents:"none",selectors:{":hover":{cursor:"default"}}},splitButtonFlexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},splitButtonContainerDisabled:{outline:"none",border:"none"}};return Object(o.concatStyleSets)(n,e)})},450:function(t,e,r){"use strict";var o=r(136);function n(t,e){return t?e(t):t}function i(t){return t.replace(/\bctrl\b/,"command")}var a=[function(t){if(Array.isArray(t)){if(t.includes("del"))return t.concat("backspace")}else if("del"===t)return["del","backspace"];return t},function(t){return Array.isArray(t)?t.map(i):i(t)}];function c(t){return Object(o.i)()?function(t,e){return Array.isArray(t)||"string"==typeof t?e.reduce(function(t,e){return e(t)},t):{hotmail:e.reduce(function(t,e){return n(t,e)},t.hotmail),owa:e.reduce(function(t,e){return n(t,e)},t.owa),gmail:e.reduce(function(t,e){return n(t,e)},t.gmail),yahoo:e.reduce(function(t,e){return n(t,e)},t.yahoo)}}(t,a):t}r.d(e,"a",function(){return c})},5453:function(t,e,r){"use strict";r.r(e);var o=r(0),n=r(4),i=r(7),a=Object(i.action)("addOrRemoveAccCheckerError")(function(t,e,r){var o=t.errors.indexOf(e);r?o<0&&t.errors.push(e):o>=0&&t.errors.splice(o,1)}),c=r(9960),l=Object(i.action)("resetAccCheckerViewState")(function(t){t.isOpen=!1,t.errors=[]}),s=Object(i.action)("setAccCheckerPaneIsOpen")(function(t,e){t.isOpen=e}),u=r(20),d=r(1452),p=r(4077),h=r(186),f=r(2),g=r(9961),b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.setScrollRegionRef=function(t){t&&t.parentElement&&(e.scrollRegion=t.parentElement,e.scrollRegion.style.marginTop="10px",e.scrollRegion.style.paddingTop="0px")},e}return o.__extends(e,t),e.prototype.render=function(){return this.props.viewState?f.createElement("div",{ref:this.setScrollRegionRef},this.renderNoIssuesFoundSection(),this.renderImageAltSection(),this.renderTableHeaderRowSection(),this.renderIssuesFoundSection(),this.renderButtonSection()):null},e.prototype.componentWillUpdate=function(){this.scrollRegion&&(this.scrollRegion.scrollTop=0)},e.prototype.componentWillUnmount=function(){l(this.props.viewState)},e.prototype.onClose=function(t){this.props.viewState.isOpen&&(t.stopPropagation(),p.a.importAndExecute())},e.prototype.renderNoIssuesFoundSection=function(){return 0==this.props.viewState.errors.length&&f.createElement("div",null,f.createElement("div",{className:g.sectionHeader},Object(n.a)(c.g)),f.createElement("div",{className:g.sectionMessage},Object(n.a)(c.h)))},e.prototype.renderImageAltSection=function(){var t=this.props,e=t.viewState,r=t.fixImageAltText;return e.errors.indexOf(0)>=0&&f.createElement("div",null,f.createElement("div",{className:g.sectionHeader},Object(n.a)(c.c)),f.createElement("div",{className:g.sectionMessage},Object(n.a)(c.d)),f.createElement(d.a,{onClick:r,className:g.accCheckerButton},Object(n.a)(c.b)))},e.prototype.renderTableHeaderRowSection=function(){var t=this.props,e=t.viewState,r=t.fixTableHeaderRow;return e.errors.indexOf(1)>=0&&f.createElement("div",null,f.createElement("div",{className:g.sectionHeader},Object(n.a)(c.j)),f.createElement("div",{className:g.sectionMessage},Object(n.a)(c.k)),f.createElement(d.a,{onClick:r,className:g.accCheckerButton},Object(n.a)(c.b)))},e.prototype.renderIssuesFoundSection=function(){return this.props.viewState.errors.length>0&&f.createElement("div",null,f.createElement("div",{className:g.sectionHeader},Object(n.a)(c.e)),f.createElement("div",{className:g.sectionMessage},Object(n.a)(c.f)))},e.prototype.renderButtonSection=function(){var t=this.props.runChecker;return f.createElement(d.a,{onClick:t,className:g.accCheckerButton},Object(n.a)(c.a))},o.__decorate([Object(h.c)("escape")],e.prototype,"onClose",null),e=o.__decorate([u.observer],e)}(f.Component),m=b;function v(t,e,r,i,a){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(o){return s(t,!0),a&&p.b.importAndExecute(f.createElement(b,{viewState:t,runChecker:e,fixImageAltText:r,fixTableHeaderRow:i}),{headerText:function(){return Object(n.a)(c.i)},overlayOnSmallWidth:!1}),[2]})})}var C=r(3856),k=r(3795),w=new RegExp("\\w*\\.\\w+","g"),x="alt",y=function(){function t(t,e){var r=this;void 0===e&&(e=!0),this.viewState=t,this.useFlexPane=e,this.closeChecker=function(){p.a.importAndExecute()},this.openChecker=function(){return o.__awaiter(r,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return this.runChecker(),[4,v(this.viewState,this.runChecker,this.fixImageAltText,this.fixTableHeaderRow,this.useFlexPane)];case 1:return t.sent(),[2]}})})},this.runChecker=function(){r.editor&&(a(r.viewState,0,r.hasImageAltTextErrors()),a(r.viewState,1,r.hasTableHeaderRowErrors()))},this.fixImageAltText=function(){return o.__awaiter(r,void 0,void 0,function(){var t,e,r=this;return o.__generator(this,function(o){switch(o.label){case 0:return t=this.imagesWithAltTextErrors.pop(),[4,k.f.import()];case 1:e=o.sent(),o.label=2;case 2:return t?[4,e(t,function(e){t.setAttribute(x,e)},function(){r.imagesWithAltTextErrors=[]})]:[3,4];case 3:return o.sent(),t=this.imagesWithAltTextErrors.pop(),[3,2];case 4:return this.runChecker(),[2]}})})},this.fixTableHeaderRow=function(){return o.__awaiter(r,void 0,void 0,function(){var t;return o.__generator(this,function(e){switch(e.label){case 0:t=this.tablesWithoutHeaderRows.pop(),e.label=1;case 1:return t?[4,C.d.import()]:[3,3];case 2:return e.sent()(this.editor,t,!1),t=this.tablesWithoutHeaderRows.pop(),[3,1];case 3:return this.runChecker(),[2]}})})},this.imagesWithAltTextErrors=[],this.tablesWithoutHeaderRows=[]}return t.prototype.getName=function(){return"AccChecker"},t.prototype.initialize=function(t){this.editor=t},t.prototype.dispose=function(){this.viewState&&this.viewState.isOpen&&p.a.importAndExecute(),this.imagesWithAltTextErrors=null,this.tablesWithoutHeaderRows=null},t.prototype.hasImageAltTextErrors=function(){var t=this,e=!1;return this.imagesWithAltTextErrors=[],this.editor.queryElements("img",function(r){var o=r.getAttribute(x);t.hasPresentationRole(r)||(Object(n.g)(o)||null!=o.match(w))&&(e=!0,t.imagesWithAltTextErrors.push(r))}),e},t.prototype.hasTableHeaderRowErrors=function(){var t=this,e=!1;return this.editor.queryElements("table",function(r){var o=r.querySelectorAll("th");t.hasPresentationRole(r)||0==o.length&&(e=!0,t.tablesWithoutHeaderRows.push(r))}),e},t.prototype.hasPresentationRole=function(t){var e=t.getAttribute("role");return e&&"presentation"==e},t}();r.d(e,"AccCheckerPlugin",function(){return y}),r.d(e,"AccCheckerPane",function(){return m})},881:function(t,e,r){"use strict";r.d(e,"b",function(){return n}),r.d(e,"a",function(){return i});var o=r(14);function n(t){var e,r,n,i=t.semanticColors,a=i.buttonBackground,c=i.buttonBackgroundChecked,l=i.buttonBackgroundHovered,s=i.buttonText,u=i.buttonTextHovered,d=i.buttonTextChecked,p=i.buttonTextCheckedHovered;return{root:{backgroundColor:a,color:s},rootHovered:{backgroundColor:l,color:u,selectors:(e={},e[o.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},e)},rootPressed:{backgroundColor:c,color:d},rootExpanded:{backgroundColor:c,color:d},rootChecked:{backgroundColor:c,color:d},rootCheckedHovered:{backgroundColor:t.palette.neutralLight,color:p},splitButtonContainer:{selectors:(r={},r[o.HighContrastSelector]={border:"none"},r)},splitButtonMenuButton:{color:t.palette.white,backgroundColor:t.palette.neutralLighter,selectors:{":hover":{backgroundColor:t.palette.neutralLight,selectors:(n={},n[o.HighContrastSelector]={color:"Highlight"},n)}}},splitButtonMenuButtonDisabled:{backgroundColor:t.palette.neutralLighter,selectors:{":hover":{backgroundColor:t.palette.neutralLighter}}},splitButtonDivider:{backgroundColor:t.palette.neutralTertiaryAlt},splitButtonDividerDisabled:{backgroundColor:t.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:t.palette.themePrimary},splitButtonMenuButtonExpanded:{backgroundColor:t.palette.neutralLight},splitButtonMenuIcon:{color:t.palette.neutralPrimary},splitButtonMenuIconDisabled:{color:t.palette.neutralTertiary}}}function i(t){return{root:{backgroundColor:t.palette.themePrimary,color:t.palette.white,selectors:(e={},e[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},e)},rootHovered:{backgroundColor:t.palette.themeDarkAlt,color:t.palette.white,selectors:(r={},r[o.HighContrastSelector]={color:"Window",backgroundColor:"Highlight"},r)},rootPressed:{backgroundColor:t.palette.themeDark,color:t.palette.white,selectors:(n={},n[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},n)},rootExpanded:{backgroundColor:t.palette.themeDark,color:t.palette.white},rootChecked:{backgroundColor:t.palette.themeDark,color:t.palette.white},rootCheckedHovered:{backgroundColor:t.palette.themePrimary,color:t.palette.white},rootDisabled:{selectors:(i={},i[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},i)},splitButtonContainer:{selectors:(a={},a[o.HighContrastSelector]={border:"none"},a)},splitButtonDivider:{backgroundColor:t.palette.white},splitButtonDividerDisabled:{backgroundColor:t.palette.neutralTertiaryAlt},splitButtonMenuButton:{backgroundColor:t.palette.themePrimary,color:t.palette.white,selectors:{":hover":{backgroundColor:t.palette.themeDark,selectors:(c={},c[o.HighContrastSelector]={color:"Highlight"},c)}}},splitButtonMenuButtonDisabled:{backgroundColor:t.palette.neutralLighter,selectors:{":hover":{backgroundColor:t.palette.neutralLighter}}},splitButtonMenuButtonChecked:{backgroundColor:t.palette.themeDark},splitButtonMenuButtonExpanded:{backgroundColor:t.palette.themeDark},splitButtonMenuIcon:{color:t.palette.white},splitButtonMenuIconDisabled:{color:t.palette.neutralTertiary}};var e,r,n,i,a,c}},9960:function(t){t.exports={g:"EEa",h:"FEa",c:"GEa",d:"HEa",b:"IEa",j:"JEa",k:"KEa",e:"LEa",f:"MEa",a:"NEa",i:"OEa"}},9961:function(t,e,r){var o=r(9962),n=r(44);"string"==typeof o&&(o=[[t.i,o]]);for(var i=0;i<o.length;i++)n.loadStyles(o[i][1],!1);o.locals&&(t.exports=o.locals)},9962:function(t,e,r){(e=t.exports=r(43)(!1)).push([t.i,".WMdljJqO5VpCedHG6rPcu{font-size:17px;font-weight:300}html[dir] .WMdljJqO5VpCedHG6rPcu{padding-bottom:10px}._2xKfDR2FzdtzIJWrlTI6dc{font-size:12px;font-weight:400}html[dir] ._2xKfDR2FzdtzIJWrlTI6dc{padding-bottom:10px}._2QjYMmxcldgsfy0slqk828{height:32px}html[dir] ._2QjYMmxcldgsfy0slqk828{margin:10px 0 20px 0;border-radius:2px}",""]),e.locals={sectionHeader:"WMdljJqO5VpCedHG6rPcu",sectionMessage:"_2xKfDR2FzdtzIJWrlTI6dc",accCheckerButton:"_2QjYMmxcldgsfy0slqk828"}}},0,[4,8,10,11,242,38,189,483,206]]);
//# sourceMappingURL=owa.AccCheckerPlugin.js.map
self.scriptsLoaded['owa.AccCheckerPlugin.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AccCheckerPlugin.js'] = (new Date()).getTime();