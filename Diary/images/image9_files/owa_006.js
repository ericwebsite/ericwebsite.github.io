self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.LoadMailVotingProviders.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[268],{11728:function(e,t,n){"use strict";n.r(t);var r=n(1),o=Object(r.action)("setVotingOptions",function(e){return{votingOptions:e}}),i=Object(r.action)("setReferenceItemId",function(e){return{referenceItemId:e}}),a=Object(r.action)("resetVotingStore"),c=Object(r.action)("castVoteForProvider",function(e){return{infoBarOption:e}}),s=n(2611),u=(Object(r.mutator)(o,function(e){var t=Object(s.a)();t&&(t.options=e.votingOptions)}),Object(r.mutator)(i,function(e){var t=Object(s.a)();t&&(t.referenceItemId=e.referenceItemId)}),n(2167)),d=(Object(r.mutator)(a,function(e){var t=Object(s.a)();t&&(t.options=void 0,t.activeProviders=[u.a],t.referenceItemId=void 0)}),Object(r.action)("loadVotingOptions",function(e){return{messageId:e}})),f=(Object(r.action)("getConversationVotingAndModerationData",function(e,t){return{conversationNodes:e,conversationSortOrder:t}}),Object(r.action)("castVote",function(e){return{votingResponse:e}})),v=n(2683),p=n(31),O=(Object(r.orchestrator)(d,function(e){var t=!1,n=Object(s.a)(),r=e.messageId,c=Object(p.t)().items.get(r);n.referenceItemId&&n.referenceItemId.Id!=r&&a();for(var d=Object(v.a)(),f=0;f<d.length;f++)if(d[f].provider==u.a){t=!0;break}if((void 0===n.options||!t)&&c){var O=c.VotingInformation;O&&O.UserOptions&&O.UserOptions.forEach(function(e){var t={displayName:e.DisplayName,provider:u.a};d.push(t)}),o(d),i(c.ItemId)}}),n(0)),m=n(9496),I=n.n(m),b=n(4245),j=n.n(b),l=n(2552),g=n.n(l),_=n(29),h=n(9);function y(e,t){var n=I()({Response:e,ReferenceItemId:t}),r=Object(h.a)().UserOptions.TimeFormat,o=g()({ClientSupportsIrm:!0,ComposeOperation:null,MessageDisposition:"SendAndSaveCopy",OutboundCharset:"AutoDetect",Items:[n],TimeFormat:r});return j()({Header:Object(_.getJsonRequestHeader)(),Body:o}).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}var V=n(12),P=(Object(r.orchestrator)(f,function(e){return O.__awaiter(void 0,void 0,void 0,function(){var t,n,r;return O.__generator(this,function(o){switch(o.label){case 0:t=e.votingResponse,n=Object(s.a)().referenceItemId,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,y(t,n)];case 2:return o.sent(),[3,4];case 3:return r=o.sent(),V.c.error("Cannot create voting response item. "+r.message),[3,4];case 4:return[2]}})})}),{name:u.a,loadOptions:function(e){return d(e)},castVote:function(e){return f(e)}});function w(e){switch(e){case u.a:default:return P}}Object(r.orchestrator)(c,function(e){var t=e.infoBarOption.value,n=w(t.provider),r=t.displayName,o=Object(s.a)().referenceItemId;o&&n.castVote(r,o.Id)});function R(e){Object(s.a)().activeProviders.forEach(function(t){w(t).loadOptions(e)})}n.d(t,"loadActiveVotingProviders",function(){return R}),n.d(t,"castVoteForProvider",function(){return c})},2552:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CreateItemRequest:#Exchange"},e)}},3022:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CreateItemJsonRequest:#Exchange"},e)}},4245:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(3022);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("CreateItem",e,t)}},9496:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"VotingResponseItem:#Exchange"},e)}}},0,[0,1,30,474,155,463,87,464,98]]);
//# sourceMappingURL=owa.LoadMailVotingProviders.js.map
self.scriptsLoaded['owa.LoadMailVotingProviders.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.LoadMailVotingProviders.js'] = (new Date()).getTime();