<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <title>Skype</title>

    <script type="text/javascript" nonce="HhObwgDvNtCWE0SZ">
        var message = "";

        window.hashFragment = (function () {
            "use strict";

            return {
                hashParams: {},

                parseHashParams: function (windowObj) {
                    var hash,
                        hashPairs,
                        hashPair,
                        delimiterIndex,
                        key,
                        value,
                        ind;

                    windowObj = windowObj ? windowObj : window;
                    hash = windowObj.location.hash.replace("#", "");
                    this.hashParams = {};
                    hashPairs = hash.split("&");
                    for (ind in hashPairs) {
                        hashPair = hashPairs[ind];
                        delimiterIndex = hashPair.indexOf("=");
                        if (delimiterIndex >= 0) {
                            key = decodeURIComponent(hashPair.substring(0, delimiterIndex)).toLowerCase();
                            value = decodeURIComponent(hashPair.substring(delimiterIndex + 1));
                            this.hashParams[key] = value;
                        }
                    }
                },
                getHashParam: function (key) {
                    return this.hashParams[key.toLowerCase()];
                }
            };
        })();

        (function () {
            var target = "https://outlook.live.com/mail/inbox/id/AQQkADAwATY3ZmYAZS0wNDQAMC1jYjk3LTAwAi0wMAoAEADIGSYO8nuoTIWAxQFMc548",
                messageObject = {"skypetoken":"eyJhbGciOiJSUzI1NiIsImtpZCI6IjEwMSIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1NjI0NjY4NzMsImV4cCI6MTU2MjU1MzI3Miwic2t5cGVpZCI6ImxpdmU6ZXJpYy53YW5nLnVzIiwic2NwIjo5NTgsImNzaSI6IjE1NjI0NjY4NzIiLCJjaWQiOiJjZjFkZjQ3ODJmYjY0MTRhIiwiYWF0IjoxNTYxNzYyMTY0fQ.WSJtOhKSpGbVp5av33wMRwNJqM8K73-Ef6SRsTut4zlctsarK4wEhcS9WM2DBcfr6eGqtTBQh9Iil1pzbNcdSISlReXUXUpPPlIsQJbruI0xsOHbud7mETJs-_utZbnBp9jgd88uFDpb1oBezFnn8Zz0NfYUMgv6SmxD7GsV3i9eJLeXXa38n5QFbo2PZWhRPyL3txp0C8-881vpFjOYo3XFC5jPUEy9QiNE09Cn26XjT9tdkYpHjEKgNsVHRgT-vRb2NGd2nQ4eBS4qkyV78S8yLUZa5lNbt-lBlG8dRKC3-EFE7kukB8i-0EIibnL4kcrs53dFKfgrTxq66gSWZw","expires_in":"86398","skypeid":"live:eric.wang.us","signinname":"eric.wang.us@hotmail.com","state":"silentloginsdk_1562466870884"};

            window.hashFragment.parseHashParams();
            var error = window.hashFragment.getHashParam("error");
            var errorDescription = window.hashFragment.getHashParam("error_description");

            if (!!error && error.length) {
                messageObject.error = error;
                messageObject.error_description = errorDescription;
            }
            
            var message = JSON.stringify(messageObject);

            if (!!window.opener) {                              // Send postMessage from a Popup and close window
                window.opener.postMessage(message, target);
                window.close();
            } else if (!!window.parent) {                       // Send postMessage from an Iframe
                window.parent.postMessage(message, target);
            }
        }());
    </script>
</head>
<body>

</body></html>