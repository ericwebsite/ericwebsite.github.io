self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.LinkData.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[263],{1003:function(e,t,n){"use strict";var r=n(0),i=n(7),a=function(){function e(e){this.maxSize=e,this.references=[],this.mruList=[]}return e.prototype.initialize=function(e,t){var n,i;if(this.store)throw new Error("MruCache cannot be initialized twice.");this.store=e,this.deleteCallback=t;try{for(var a=r.__values(e.keys()),o=a.next();!o.done;o=a.next()){var c=o.value;this.mruList.push(c)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}},e.prototype.add=function(e,t){var n=this;Object(i.action)("MruCache_add")(function(){n.store.set(e,t),n.mruList.indexOf(e)>=0?n.touch(e):(n.mruList.push(e),n.purgeIfNecessary())})()},e.prototype.get=function(e){return this.store.get(e)},e.prototype.getAndTouch=function(e){var t=this.store.get(e);return t&&this.touch(e),t},e.prototype.has=function(e){return this.store.has(e)},e.prototype.remove=function(e){var t=this;Object(i.action)("MruCache_remove")(function(){if(t.store.has(e)&&!t.isReferenced(e))return t.removeItemAtIndex(t.mruList.indexOf(e))})()},e.prototype.registerReference=function(e){this.references.push(e)},e.prototype.clear=function(){var e=this;Object(i.action)("MruCache_clear")(function(){e.purgeTillSize(0)})()},e.prototype.getItemIds=function(){return new(Array.bind.apply(Array,r.__spread([void 0],this.mruList)))},e.prototype.touch=function(e){var t=this.mruList.indexOf(e);if(t<0)throw new Error("Item with key '"+e+"' does not exist in the cache.");this.mruList.splice(t,1),this.mruList.push(e)},e.prototype.purgeIfNecessary=function(){this.purgeTillSize(this.maxSize)},e.prototype.purgeTillSize=function(e){for(var t=0;this.mruList.length>e&&t<this.mruList.length;){var n=this.mruList[t];this.isReferenced(n)?t++:this.removeItemAtIndex(t)}},e.prototype.removeItemAtIndex=function(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);var t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)},e.prototype.isReferenced=function(e){for(var t=0;t<this.references.length;t++)if(this.references[t]()==e)return!0;return!1},e}();n.d(t,"a",function(){return a})},1074:function(e,t,n){var r=n(1317),i=36e5,a=6e4,o=2,c=/[T ]/,s=/:/,u=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],f=/^(\d{4})/,d=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],h=/^-(\d{2})$/,p=/^-?(\d{3})$/,v=/^-?(\d{2})-?(\d{2})$/,m=/^-?W(\d{2})$/,b=/^-?W(\d{2})-?(\d{1})$/,g=/^(\d{2}([.,]\d*)?)$/,I=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,y=/([Z+-].*)$/,j=/^(Z)$/,x=/^([+-])(\d{2})$/,_=/^([+-])(\d{2}):?(\d{2})$/;function k(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var E=function(e){var t,n={},r=e.split(c);if(s.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]),t){var i=y.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e),C=function(e,t){var n,r=l[t],i=d[t];if(n=f.exec(e)||i.exec(e)){var a=n[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(n=u.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(E.date,n),S=C.year,T=function(e,t){if(null===t)return null;var n,r,i,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=h.exec(e))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(t,i),r;if(n=p.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=v.exec(e)){r=new Date(0),i=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,i,c),r}if(n=m.exec(e))return a=parseInt(n[1],10)-1,k(t,a);if(n=b.exec(e)){a=parseInt(n[1],10)-1;var s=parseInt(n[2],10)-1;return k(t,a,s)}return null}(C.restDateString,S);if(T){var w,M=T.getTime(),R=0;return E.time&&(R=function(e){var t,n,r;if(t=g.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*i;if(t=I.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*i+r*a;if(t=O.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*i+r*a+1e3*o}return null}(E.time)),E.timezone?(L=E.timezone,w=(A=j.exec(L))?0:(A=x.exec(L))?(D=60*parseInt(A[2],10),"+"===A[1]?-D:D):(A=_.exec(L))?(D=60*parseInt(A[2],10)+parseInt(A[3],10),"+"===A[1]?-D:D):0):(w=new Date(M+R).getTimezoneOffset(),w=new Date(M+R+w*a).getTimezoneOffset()),new Date(M+R+w*a)}var L,A,D;return new Date(e)}},11687:function(e,t,n){"use strict";n.r(t);var r=n(3578),i=n(1),a=Object(i.action)("ADD_RECIPIENTS_INTO_LINK",function(e,t){return{linkId:e,recipients:t}}),o=Object(i.action)("UPDATE_RECIPIENT_PERMISSION_INFO",function(e,t){return{linkId:e,results:t}}),c=Object(i.action)("REMOVE_RECIPIENTS_FROM_LINK",function(e,t){return{linkId:e,recipients:t}}),s=Object(i.action)("SET_GET_PERMISSION_INFO_FAILURE",function(e,t){return{linkId:e,recipients:t}}),u=Object(i.action)("RESET_SHARING_RECIPIENTS_INFO",function(e){return{linkId:e}}),l=Object(i.action)("SET_ACTION_STATUS",function(e,t){return{linkId:e,linkActionStatus:t}}),f=Object(i.action)("IGNORE_SHARING_TIP",function(e,t){return{linkId:e,sharingTipId:t}}),d=n(3634);Object(i.mutator)(r.c,function(e){var t=Object(d.a)(e.linkId);t&&(t.linkActionStatus=e.actionStatus)}),Object(i.mutator)(l,function(e){var t=Object(d.a)(e.linkId);t&&(t.linkActionStatus=e.linkActionStatus)}),Object(i.mutator)(r.g,function(e){Object(d.a)(e.linkId).sharingInfo.blocksDownload=e.sharingDialogResponse.blocksDownload});var h=n(189);Object(i.mutator)(r.g,function(e){var t=Object(d.a)(e.linkId);t&&(t.sharingInfo.expirationDate=e.sharingDialogResponse.expirationDate)}),Object(i.mutator)(r.f,function(e){var t=Object(d.a)(e.linkId);t&&(t.sharingInfo.expirationDate=e.expirationDate?Object(h.c)(e.expirationDate):null)}),Object(i.mutator)(r.g,function(e){Object(d.a)(e.linkId).url=e.sharingDialogResponse.url}),Object(i.mutator)(r.f,function(e){Object(d.a)(e.linkId).url=e.newLinkUrl}),Object(i.mutator)(r.g,function(e){Object(d.a)(e.linkId).permissionLevel=e.sharingDialogResponse.permissionLevel}),Object(i.mutator)(r.e,function(e){Object(d.a)(e.linkId).permissionLevel=e.newPermission});var p=n(3693);Object(i.mutator)(a,function(e){var t=Object(d.a)(e.linkId);t&&e.recipients.forEach(function(e){t.sharingRecipientsInfo.recipientPermissionInfos.some(function(t){return t.emailAddress===e.emailAddress})||t.sharingRecipientsInfo.recipientPermissionInfos.push(e)})}),Object(i.mutator)(o,function(e){var t=Object(d.a)(e.linkId);t&&e.results.forEach(function(e){for(var n=0;n<t.sharingRecipientsInfo.recipientPermissionInfos.length;n++){var r=t.sharingRecipientsInfo.recipientPermissionInfos[n];if(r.emailAddress===e.recipient.alias){r.hasAccess=e.hasAccess,r.canHaveAccess=e.canBeInvited,r.getPermissionInfoStatus=p.a.Succeeded;break}}})}),Object(i.mutator)(s,function(e){var t=Object(d.a)(e.linkId);t&&e.recipients.forEach(function(e){for(var n=0;n<t.sharingRecipientsInfo.recipientPermissionInfos.length;n++){var r=t.sharingRecipientsInfo.recipientPermissionInfos[n];if(r.emailAddress===e.emailAddress){r.getPermissionInfoStatus=p.a.Failed;break}}})}),Object(i.mutator)(c,function(e){var t=Object(d.a)(e.linkId);t&&(t.sharingRecipientsInfo.recipientPermissionInfos=t.sharingRecipientsInfo.recipientPermissionInfos.filter(function(t){return n=t.emailAddress,!e.recipients.some(function(e){return e.emailAddress===n});var n}))}),Object(i.mutator)(u,function(e){var t=Object(d.a)(e.linkId);t&&(t.sharingRecipientsInfo.recipientPermissionInfos=[])}),Object(i.mutator)(r.g,function(e){Object(d.a)(e.linkId).sharingInfo.shareId=e.sharingDialogResponse.shareId});var v=n(3618),m=n(3935);Object(i.mutator)(r.a,function(e){Object(m.a)().sharingLinks.set(e.linkId,e.linkModel)}),Object(i.mutator)(v.d,function(e){Object(m.a)().sharingLinks.delete(e.linkId)}),Object(i.mutator)(v.c,function(e){Object(m.a)().sharingLinks.delete(e.linkId)}),Object(i.mutator)(f,function(e){Object(d.a)(e.linkId).sharingTipsIgnored.push(e.sharingTipId)}),Object(i.mutator)(r.g,function(e){var t=Object(d.a)(e.linkId);t&&(t.unwrappedUrl=null)}),Object(i.mutator)(r.f,function(e){var t=Object(d.a)(e.linkId);t&&(t.unwrappedUrl=null)}),Object(i.mutator)(r.d,function(e){var t=Object(d.a)(e.linkId);t&&(t.accessTokenAvailable=!1)});var b=n(0),g=n(7818),I=n.n(g),O=n(9963),y=n.n(O);function j(e,t,n){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(r){switch(r.label){case 0:return[4,y()(x(e,t,n))];case 1:return[2,r.sent()]}})})}function x(e,t,n){return I()({PermissionLevel:t,ResourceLocation:e,DataProviderType:n||0})}var _=n(3911),k=n(18),E=n(74);Object(i.orchestrator)(p.n,function(e){return b.__awaiter(void 0,void 0,void 0,function(){var t,n;return b.__generator(this,function(i){switch(i.label){case 0:return"string"!=typeof e.id?[3,2]:(t=Object(d.a)(e.id))?(Object(r.c)(e.id,_.a.refreshing),[4,j(t.sharingInfo.canonicalUrl,t.permissionLevel)]):[3,2];case 1:if(n=i.sent(),Object(E.b)(n.Link))return Object(r.c)(e.id,_.a.refreshFailed),Object(k.o)("LinkRefreshLinkFailed"),[2];Object(r.c)(e.id,_.a.refreshSucceeded),Object(r.f)(t.linkId,n.Link,t.url,n.ExpirationDate),i.label=2;case 2:return[2]}})})});function C(e){return{anonymousViewLink:e.AnonymousViewLink,anonymousEditLink:e.AnonymousEditLink,organizationViewLink:e.OrganizationViewLink,organizationEditLink:e.OrganizationEditLink}}Object(i.orchestrator)(r.b,function(e){return b.__awaiter(void 0,void 0,void 0,function(){var t;return b.__generator(this,function(n){switch(n.label){case 0:return[4,j(e.canonicalUrl,e.newPermissionLevel)];case 1:return t=n.sent(),Object(r.f)(e.linkId,t.Link,e.currentUrl,t.ExpirationDate),[2]}})})});var S=n(4018);function T(e){var t=Object(S.b)(e)||[];return-1===t.indexOf(0)&&t.push(0),t}var w=n(2517);Object(i.orchestrator)(v.a,function(e){var t,n,i,a=(t=e.linkId,n=e.url,(i=e.response)&&0===i.ResultCode?{linkId:t,fileName:i.FileName,mimeType:i.MimeType,url:n,unwrappedUrl:i.OriginalUrl,accessTokenAvailable:!0,permissionLevel:Object(S.c)(i.SharingLinkKind),sharingInfo:{getSharingInfoSucceeded:!0,blocksDownload:i.BlocksDownload,canonicalUrl:i.CanonicalUrl,canShareInternally:i.CanShareInternally,canShareExternally:i.CanShareExternally,expirationDate:i.ExpirationDate?Object(h.c)(i.ExpirationDate):null,canRefresh:i.CanCreateAnonymousEditLink||i.CanCreateAnonymousViewLink,shareId:i.ShareId,siteUrl:i.SiteUrl},supportedPermissionLevels:T(i),sharingUrls:C(i),sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:_.a.none}:{linkId:t,fileName:null,mimeType:null,url:n,unwrappedUrl:null,accessTokenAvailable:!1,permissionLevel:0,sharingInfo:{getSharingInfoSucceeded:!1,blocksDownload:!1,canonicalUrl:"",canShareInternally:!1,canShareExternally:!1,expirationDate:null,canRefresh:!1,shareId:null,siteUrl:null},supportedPermissionLevels:null,sharingUrls:null,sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:_.a.none});Object(r.a)(e.linkId,a),a.sharingInfo.siteUrl&&function(e,t){b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Object(w.k)(0,!1,e)];case 1:return n.sent(),[3,3];case 2:return n.sent(),Object(r.d)(t),[3,3];case 3:return[2]}})})}(a.sharingInfo.siteUrl,e.linkId)}),Object(i.orchestrator)(r.g,function(e){!function(e,t){return e.url!==t.url||e.permissionLevel!==t.permissionLevel||e.sharingInfo.blocksDownload!==t.blocksDownload||e.sharingInfo.expirationDate!==t.expirationDate}(Object(d.a)(e.linkId),e.sharingDialogResponse)?Object(k.o)("LinkUnchangedFromSharingDialog"):Object(k.o)("LinkChangedFromSharingDialog")});var M=n(3740);var R=n(1300),L=n(3936);function A(e,t){var n=function(e){if(!e||0===e.length)return[];var t=[];return e.filter(function(e){return!!e}).map(function(e){var n=function(e){if(Object(L.b)(e))return e.recipients.slice();if(Object(L.a)(e)){var t=e;return function(e){return e?e.map(function(e){var t=e.persona?e.persona:{EmailAddress:e.Mailbox,PersonaId:{Id:null}},n=t.EmailAddress;return{persona:t,isValid:Object(R.a)(n.EmailAddress),isSelected:!1,isEditing:!1,isFadedOut:!1,isExpanding:!1,isContextMenuOpen:!1,displayText:n.Name?n.Name:n.EmailAddress}}):[]}(t)}return[]}(e);t=t.concat(n)}),t}(e),r=[];return n.forEach(function(e){var n=e.persona,i=function(e,t){var n=Object(M.a)().get(e,t);return n?{TotalMemberCount:n.value.TotalMemberCount,ExternalMemberCount:n.value.ExternalMemberCount}:null}(t,n.EmailAddress.EmailAddress);null!==i&&r.push({recipient:e,totalMemberCount:i.TotalMemberCount,externalMemberCount:i.ExternalMemberCount})}),r}function D(){}n.d(t,"linkBootStrap",function(){return D}),n.d(t,"ignoreSharingTip",function(){return f}),n.d(t,"addRecipientsIntoLink",function(){return a}),n.d(t,"updateRecipientPermissionInfos",function(){return o}),n.d(t,"removeRecipientsFromLink",function(){return c}),n.d(t,"setGetPermissionInfoFailure",function(){return s}),n.d(t,"resetSharingRecipientsInfo",function(){return u}),n.d(t,"setLinkActionStatus",function(){return l}),n.d(t,"getSharingTipRecipientInfo",function(){return A}),n.d(t,"getSharingLink",function(){return d.a})},1174:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindItemRequest:#Exchange"},e)}},1175:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),i=n(1702);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("FindItem",e,t)}},1300:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;function i(e){return r.test(e)}},1317:function(e,t){e.exports=function(e){return e instanceof Date}},1702:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindItemJsonRequest:#Exchange"},e)}},2303:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}},2307:function(e,t,n){var r=n(3014),i=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*i)}},2539:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),i=n(2303);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetAccessTokenforDataProvider",e,t)}},3014:function(e,t,n){var r=n(1074);e.exports=function(e,t){var n=r(e).getTime(),i=Number(t);return new Date(n+i)}},3636:function(e,t,n){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i}),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},3693:function(e,t,n){"use strict";n.d(t,"g",function(){return l}),n.d(t,"h",function(){return f}),n.d(t,"f",function(){return d}),n.d(t,"k",function(){return h}),n.d(t,"l",function(){return p}),n.d(t,"i",function(){return v}),n.d(t,"j",function(){return m}),n.d(t,"m",function(){return b});var r=n(3636);n.d(t,"d",function(){return r.a}),n.d(t,"e",function(){return r.b});var i=n(3857);n.d(t,"c",function(){return i.a});var a=n(3),o=n(3858);n.d(t,"n",function(){return o.a});var c=n(3726);n.d(t,"b",function(){return c.a});var s=n(3825);n.d(t,"a",function(){return s.a});var u=new a.c(function(){return n.e(367).then(n.bind(null,4897))}),l=new a.b(u,function(e){return e.getSharingInformation}),f=new a.b(u,function(e){return e.getSharingIssuesForSharingData}),d=new a.b(u,function(e){return e.getInfoBarCreator}),h=new a.b(u,function(e){return e.hasLargeDLRecipient}),p=new a.b(u,function(e){return e.hasSmallDLExpansionFailure}),v=new a.b(u,function(e){return e.getSmallDLs}),m=new a.b(u,function(e){return e.hasGetRecipientPermissionFailed}),b=new a.b(u,function(e){return e.logSharingTipChangesForLinkRemoval})},3726:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var r=100,i=1},3740:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(3941);function i(){return Object(r.b)().mailTips}},3793:function(e,t,n){"use strict";var r=n(0),i=function(e){function t(t,n,r){var i=e.call(this,n,r)||this;return i.value=t,i}return r.__extends(t,e),t}(n(3942).a);t.a=i},3825:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},385:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ItemResponseShape:#Exchange"},e)}},3857:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},3858:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1),i=Object(r.action)("REFRESH_EXPIRATION_DATE",function(e){return{id:e}})},3941:function(e,t,n){"use strict";var r,i=n(1),a=n(3793),o=n(3942),c=n(0),s=n(4108),u=n(3995),l=n(3740),f=n(29),d=n(4408),h=n.n(d),p=n(4410),v=n.n(p);function m(e,t){return h()({Header:Object(f.getJsonRequestHeader)(),Body:v()({MailTipsRequested:1,SendingAs:{EmailAddress:e},Recipients:t.map(function(e){return{EmailAddress:e}})})}).then(function(e){return e&&e.Body&&"Success"==e.Body.ResponseClass?e.Body:null}).catch(function(e){return Promise.resolve(null)})}!function(e){e.CustomMailTip="CustomMailTip",e.DeliveryRestricted="DeliveryRestricted",e.ExternalMemberCount="ExternalMemberCount",e.GuestMailTipStatus="GuestMailTipStatus",e.IsModerated="IsModerated",e.MailboxFull="MailboxFull",e.MaxMessageSize="MaxMessageSize",e.OutOfOffice="OutOfOffice",e.PreferAccessibleContent="PreferAccessibleContent",e.RecipientAddress="RecipientAddress",e.TotalMemberCount="TotalMemberCount"}(r||(r={}));var b=r,g=n(4109),I=/<!--((.|\n)*?)-->/gi,O=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t};var y=function(e){return e.childNodes?_(O(e.childNodes).filter(function(e){return"ReplyBody"===e.localName})[0]):""},j=function(e){return e.replace(I,"")},x=function(e){var t=e.split(" "),n=g.a.None;return t.map(function(e){n|=g.a[e]}),n};function _(e){if(e){var t=j(e.textContent).replace(/<\/a>/gi,"</a> "),n=(new DOMParser).parseFromString(t,"text/html");if(n&&n.childNodes&&n.childNodes.length&&n.childNodes[0].textContent)return n.childNodes[0].textContent.replace(/\s\s+/g," ").trim()}return""}var k=n(18);Object(i.orchestrator)(u.a,function(e){return c.__awaiter(void 0,void 0,void 0,function(){var t,n,r,i,o,u,f;return c.__generator(this,function(c){switch(c.label){case 0:return t=e.composeId,n=e.fromEmailAddress,r=e.recipients,n&&r&&r.length?(i=Object(l.a)(),(o=r.filter(function(e){return e&&!i.containsValueForKey(n,e)})).length?[4,m(n,o)]:[3,2]):[3,3];case 1:(u=c.sent())&&(f=u.ResponseMessages.map(function(e){return function(e){if(!e)return null;var t=(new DOMParser).parseFromString(e,"text/xml").firstChild.childNodes;return O(t).reduce(function(e,t){switch(t.localName){case b.RecipientAddress:t.childNodes.length>1&&(e.RecipientAddress=t.childNodes[1].textContent);break;case b.MailboxFull:e.MailboxFull="true"===t.textContent;break;case b.IsModerated:e.IsModerated="true"===t.textContent;break;case b.TotalMemberCount:e.TotalMemberCount=parseInt(t.textContent)||0;break;case b.ExternalMemberCount:e.ExternalMemberCount=parseInt(t.textContent)||0;break;case b.MaxMessageSize:e.MaxMessageSize=parseInt(t.textContent)||0;break;case b.DeliveryRestricted:e.DeliveryRestricted="true"===t.textContent;break;case b.PreferAccessibleContent:e.PreferAccessibleContent="true"===t.textContent;break;case b.OutOfOffice:e.OutOfOffice=y(t);break;case b.CustomMailTip:e.CustomMailTip=_(t);break;case b.GuestMailTipStatus:e.GuestStatus=x(t.textContent)}return e},{})}(e.MessageText)}).filter(function(e){return!!e}))&&f.length>0&&(!function(e,t){if(e&&e.length>0&&t){var n=Object(l.a)();e.map(function(e){n.add(t,new a.a(e,t,e.RecipientAddress))})}}(f,n),Object(s.a)(t,n)),c.label=2;case 2:r.map(function(e){var t=!1;-1==o.indexOf(e)&&(t=!0),Object(k.o)("UpdateMailtipsDatapoint",[t])}),c.label=3;case 3:return[2]}})})});n.d(t,"b",function(){return C});var E={mailTips:new o.b(a.a.compareEntryCacheTime)},C=Object(i.createStore)("mailTipsCacheStore",E),S=C();t.a=S},3942:function(e,t,n){"use strict";var r=n(0),i=n(8),a=n(1003),o=300,c=function(){function e(e,t){this.parentCacheKey=e,this.childMruCacheKey=t,this.cacheTime=Date.now()}return e.isExpired=function(e){return Date.now()-e.cacheTime>=72e5},e.compareEntryCacheTime=function(e,t){return e.cacheTime-t.cacheTime},e}(),s=n(7),u=function(){function e(e,t,n){void 0===t&&(t=o),void 0===n&&(n=Date.now()),this.comparer=e,this.cacheLimit=t,this.lastExpiredEntryClearedTime=n,this.cache=new i.ObservableMap}return e.prototype.initialize=function(e){this.cache=e.cache},e.prototype.add=function(e,t){var n=this;Object(s.action)("NestedMruCache_add")(function(){n.clearOldEntriesIfNeeded();var r=null;n.cache.has(e)?r=n.cache.get(e):((r=new a.a(n.cacheLimit)).initialize(new i.ObservableMap),n.cache.set(e,r)),r.add(t.childMruCacheKey,t)})()},e.prototype.containsValueForKey=function(e,t){if(!this.cache.has(e))return!1;var n=this.cache.get(e).get(t);return!(!n||c.isExpired(n))},e.prototype.get=function(e,t){var n=null;return this.containsValueForKey(e,t)&&(n=this.cache.get(e).get(t)),n},e.prototype.clearUpExpiredEntries=function(){var e,t;if(!(Date.now()-this.lastExpiredEntryClearedTime<12e5)){var n=function(e){e.getItemIds().forEach(function(t){c.isExpired(e.get(t))&&e.remove(t)})};try{for(var i=r.__values(this.cache.values()),a=i.next();!a.done;a=i.next()){n(a.value)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this.lastExpiredEntryClearedTime=Date.now()}},e.prototype.remove=function(e){var t=this;Object(s.action)("NestedMruCache_remove")(function(){if(t.cache.has(e)){var n=t.cache.get(e);n.getItemIds().map(function(e){n.remove(e)})}})()},e.prototype.clear=function(){var e=this;Object(s.action)("NestedMruCache_clear")(function(){var t,n,i=e.cache.keys();try{for(var a=r.__values(i),o=a.next();!o.done;o=a.next()){var c=o.value;e.remove(c)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}})()},e.prototype.countTotalNumberOfEntries=function(){var e,t,n=0;if(this.cache)try{for(var i=r.__values(this.cache.values()),a=i.next();!a.done;a=i.next()){n+=a.value.getItemIds().length}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return n},e.prototype.returnAllMailTipsCacheEntries=function(){var e,t,n=[];if(this.cache){var i=function(e){e&&e.getItemIds().map(function(t){var r=e.get(t);n.push(r)})};try{for(var a=r.__values(this.cache.values()),o=a.next();!o.done;o=a.next()){i(o.value)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}}return n},e.prototype.clearOldEntriesIfNeeded=function(){var e,t;if(this.countTotalNumberOfEntries()>=o&&this.clearUpExpiredEntries(),this.countTotalNumberOfEntries()>=o){var n=[],i=function(e){e.getItemIds().forEach(function(t){n.push(e.get(t))})};try{for(var a=r.__values(this.cache.values()),c=a.next();!c.done;c=a.next()){i(c.value)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}n.sort(this.comparer);for(var s=0;s<50;s++){var u=n[s].parentCacheKey,l=n[s].childMruCacheKey;this.cache.get(u).remove(l)}}},e}();n.d(t,"b",function(){return u}),n.d(t,"a",function(){return c})},3995:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("updateMailtips",function(e,t,n){return{composeId:e,fromEmailAddress:t,recipients:n}})},4018:function(e,t,n){"use strict";function r(e){if(null===e)return null;var t=[];return e.CanShareInternally&&(t.push(2),t.push(1)),e.CanCreateOrganizationEditLink&&t.push(6),e.CanCreateOrganizationViewLink&&t.push(5),e.CanCreateAnonymousEditLink&&t.push(4),e.CanCreateAnonymousViewLink&&t.push(3),t.length>0?t:null}function i(e){switch(e){case 5:return 4;case 4:return 3;case 3:return 6;case 2:return 5;default:return 0}}function a(e,t,n){var r=i(e);if(0===r)switch(t){case 2:return n?4:3;case 1:return n?6:5;case 5:return n?2:1;default:return 0}return r}var o=n(4433),c=n(4),s="OneDrivePro",u=n(98),l=n(5),f=n(9);function d(e,t){switch(e){case 3:return Object(c.a)(o.b);case 4:return Object(c.a)(o.a);case 6:return Object(c.a)(o.d);case 5:return Object(c.a)(o.e);case 1:return t===s?Object(c.a)(o.g):Object(c.a)(o.b);case 2:return t===s?Object(c.a)(o.f):Object(c.a)(o.a);case 0:return Object(c.a)(o.c);default:return Object(u.a)(e)}}function h(e,t){return t===s&&Object(l.d)("doc-attachment-contextualSharingTips")?function(e){var t=Object(f.a)().SessionSettings.CompanyName;switch(e){case 3:return Object(c.a)(o.i);case 4:return Object(c.a)(o.h);case 6:return Object(c.b)(Object(c.a)(o.j),t);case 5:return Object(c.b)(Object(c.a)(o.k),t);case 1:return Object(c.a)(o.g);case 2:return Object(c.a)(o.f);case 0:return Object(c.a)(o.c);default:return Object(u.a)(e)}}(e):d(e,t)}function p(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}n.d(t,"b",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return a}),n.d(t,"e",function(){return d}),n.d(t,"f",function(){return h}),n.d(t,"a",function(){return s}),n.d(t,"g",function(){return p})},4108:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("onMailTipRetrieved",function(e,t){return{composeId:e,fromAddress:t}})},4109:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.None=0]="None",e[e.IsCalculated=1]="IsCalculated",e[e.GuestsEnabled=2]="GuestsEnabled",e[e.GroupHasGuests=4]="GroupHasGuests"}(r||(r={}))},418:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"IndexedPageView:#Exchange"},e)}},4408:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),i=n(4409);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetMailTips",e,t)}},4409:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetMailTipsJsonRequest:#Exchange"},e)}},4410:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetMailTipsRequest:#Exchange"},e)}},4433:function(e){e.exports={b:"Jca",a:"Kca",d:"Lca",e:"Mca",g:"Nca",f:"Oca",c:"Pca",i:"Qca",h:"Rca",j:"Sca",k:"Tca"}},7818:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CreateAttachmentSharingLinkRequest:#Exchange"},e)}},9963:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),i=n(7818);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("CreateAttachmentSharingLink",e,t)}}},0,[463,87,464,98,367]]);
//# sourceMappingURL=owa.LinkData.js.map
self.scriptsLoaded['owa.LinkData.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.LinkData.js'] = (new Date()).getTime();