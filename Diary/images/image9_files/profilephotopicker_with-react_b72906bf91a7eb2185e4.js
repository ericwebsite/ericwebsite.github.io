/*! Version: 1.0.0; Third Party Notices: https://lpcres.delve.office.com/lpc/versionless/tpn-7368ac18932fb4c9dc4722a3cf38e3d9421b09ee92ed1bc53c86c49b9ec24111f98b02315b8dd75c2842b055ef9f67d5bc29c364e719399627c0cee8097a862c.txt */
(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[25],{1064:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(804);e.ProfilePhotoPickerStore=r.ProfilePhotoPickerStore;var o=n(850);e.ProfilePhotoPicker=o.ProfilePhotoPicker;var i=n(962);e.StandaloneProfilePhotoPicker=i.StandaloneProfilePhotoPicker,e.initIcons=i.initIcons},274:function(t,e,n){"use strict";var r=n(933),o=n(949),i=n(1092),a=n(950),u=n(895),s=n(866),c=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()},l=function(){function t(){}return t.measure=function(e,n){t._timeoutId&&t.setPeriodicReset();var r=c();n();var o=c(),i=t.summary[e]||{totalDuration:0,count:0,all:[]},a=o-r;i.totalDuration+=a,i.count++,i.all.push({duration:a,timeStamp:o}),t.summary[e]=i},t.reset=function(){t.summary={},clearTimeout(t._timeoutId),t._timeoutId=NaN},t.setPeriodicReset=function(){t._timeoutId=setTimeout(function(){return t.reset()},18e4)},t.summary={},t}(),d=n(478),p=n(151),h=n(1039),f=n(940),m=n(1051),g=n(1049),v=n(38),y=n(4),b="undefined"!=typeof WeakMap?new WeakMap:void 0;function S(t){var e=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={Component:b?b.get(t.load):void 0},n}return v.c(n,e),n.prototype.render=function(){var t=this.props,e=t.forwardedRef,n=t.asyncPlaceholder,r=v.d(t,["forwardedRef","asyncPlaceholder"]),o=this.state.Component;return o?y.createElement(o,v.a({ref:e},r)):n?y.createElement(n,null):null},n.prototype.componentDidMount=function(){var e=this;this.state.Component||t.load().then(function(n){n&&(b&&b.set(t.load,n),e.setState({Component:n},t.onLoad))}).catch(t.onError)},n}(y.Component);return y.forwardRef(function(t,n){return y.createElement(e,v.a({},t,{forwardedRef:n}))})}var w=n(951),C=n(952),E=n(740),P=n(1040),I=n(1038),x=n(138),_=n(612),U=n(209),O=n(613),k=n(479),D=n(394),W=n(931),R=n(932),M=n(888),N=n(865);function A(t,e){void 0===e&&(e=!0);var n=[];if(t){for(var r=0;r<t.children.length;r++)n.push(t.children.item(r));e&&Object(N.a)(t)&&n.push.apply(n,t._virtual.children)}return n}var B=n(391),L=n(864),T=n(871),j=n(929),F=n(158),z=n(935),H=n(1036),G=n(1047),Y=n(930),K=n(1041),q=n(817),V=n(1037),X=n(1045),Z=n(481),J=n(1046),Q=n(737),$=n(891),tt=n(480),et=n(743),nt=n(953),rt=n(732),ot=n(739),it=n(1044),at=n(846),ut=n(1043),st=n(887),ct=n(934),lt="";function dt(t){return lt+t}function pt(t){lt=t}var ht=n(1091),ft=n(896),mt=function(t){var e;return function(n,r){e||(e=new Set,Object(q.a)(t,{componentWillUnmount:function(){e.forEach(function(t){return clearTimeout(t)})}}));var o=setTimeout(function(){e.delete(o),n()},r);e.add(o)}},gt=n(889),vt=n(954),yt=n(741),bt=n(731),St=n(939),wt=n(937),Ct=n(938),Et="ms-Fabric--isFocusVisible";function Pt(t,e){var n=e?Object(F.a)(e):Object(F.a)();if(n){var r=n.document.body.classList;t?r.add(Et):r.remove(Et)}}var It=n(325),xt=n(750);Object(xt.a)("@uifabric/utilities","6.39.0"),n.d(e,"a",function(){return r.a}),n.d(e,"b",function(){return o.a}),n.d(e,"c",function(){return i.a}),n.d(e,"Wb",function(){return i.b}),n.d(e,"ac",function(){return a.a}),n.d(e,"i",function(){return u.a}),n.d(e,"j",function(){return s.a}),n.d(e,"k",function(){return l}),n.d(e,"l",function(){return d.a}),n.d(e,"n",function(){return p.a}),n.d(e,"o",function(){return h.a}),n.d(e,"t",function(){return f.a}),n.d(e,"Sb",function(){return m.a}),n.d(e,"S",function(){return g.e}),n.d(e,"Q",function(){return g.d}),n.d(e,"E",function(){return g.c}),n.d(e,"vc",function(){return g.i}),n.d(e,"cc",function(){return g.g}),n.d(e,"dc",function(){return g.h}),n.d(e,"q",function(){return g.a}),n.d(e,"V",function(){return g.f}),n.d(e,"u",function(){return g.b}),n.d(e,"v",function(){return S}),n.d(e,"w",function(){return w.a}),n.d(e,"y",function(){return C.a}),n.d(e,"D",function(){return E.a}),n.d(e,"F",function(){return P.a}),n.d(e,"G",function(){return I.a}),n.d(e,"d",function(){return x.a}),n.d(e,"e",function(){return _.a}),n.d(e,"f",function(){return U.a}),n.d(e,"H",function(){return O.a}),n.d(e,"Tb",function(){return k.a}),n.d(e,"Vb",function(){return D.b}),n.d(e,"Ub",function(){return D.a}),n.d(e,"L",function(){return W.a}),n.d(e,"M",function(){return R.a}),n.d(e,"R",function(){return M.a}),n.d(e,"Z",function(){return A}),n.d(e,"bb",function(){return B.a}),n.d(e,"nb",function(){return L.a}),n.d(e,"rb",function(){return T.a}),n.d(e,"ub",function(){return j.a}),n.d(e,"vb",function(){return F.a}),n.d(e,"Nb",function(){return N.a}),n.d(e,"Xb",function(){return z.a}),n.d(e,"Yb",function(){return H.a}),n.d(e,"bc",function(){return G.a}),n.d(e,"h",function(){return Y.a}),n.d(e,"mc",function(){return Y.b}),n.d(e,"pc",function(){return K.a}),n.d(e,"O",function(){return q.a}),n.d(e,"db",function(){return V.e}),n.d(e,"jb",function(){return V.h}),n.d(e,"eb",function(){return V.f}),n.d(e,"kb",function(){return V.i}),n.d(e,"X",function(){return V.c}),n.d(e,"ob",function(){return V.k}),n.d(e,"mb",function(){return V.j}),n.d(e,"Kb",function(){return V.o}),n.d(e,"Jb",function(){return V.n}),n.d(e,"Ib",function(){return V.m}),n.d(e,"Hb",function(){return V.l}),n.d(e,"K",function(){return V.a}),n.d(e,"sc",function(){return V.p}),n.d(e,"W",function(){return V.b}),n.d(e,"fb",function(){return V.g}),n.d(e,"cb",function(){return V.d}),n.d(e,"zb",function(){return X.a}),n.d(e,"wc",function(){return X.b}),n.d(e,"Ab",function(){return Z.a}),n.d(e,"Db",function(){return J.a}),n.d(e,"m",function(){return Q.a}),n.d(e,"Eb",function(){return Q.b}),n.d(e,"hb",function(){return $.a}),n.d(e,"Gb",function(){return tt.b}),n.d(e,"p",function(){return tt.a}),n.d(e,"ib",function(){return et.a}),n.d(e,"kc",function(){return et.b}),n.d(e,"ab",function(){return nt.c}),n.d(e,"U",function(){return nt.b}),n.d(e,"C",function(){return nt.a}),n.d(e,"Zb",function(){return nt.d}),n.d(e,"lc",function(){return rt.d}),n.d(e,"fc",function(){return rt.c}),n.d(e,"Pb",function(){return rt.a}),n.d(e,"Qb",function(){return rt.b}),n.d(e,"Rb",function(){return ot.a}),n.d(e,"Lb",function(){return it.a}),n.d(e,"rc",function(){return at.f}),n.d(e,"x",function(){return at.a}),n.d(e,"P",function(){return at.b}),n.d(e,"gb",function(){return at.c}),n.d(e,"ec",function(){return at.e}),n.d(e,"Ob",function(){return at.d}),n.d(e,"xc",function(){return at.g}),n.d(e,"Mb",function(){return ut.a}),n.d(e,"wb",function(){return st.a}),n.d(e,"yb",function(){return st.c}),n.d(e,"xb",function(){return st.b}),n.d(e,"z",function(){return ct.b}),n.d(e,"A",function(){return ct.c}),n.d(e,"Bb",function(){return ct.g}),n.d(e,"s",function(){return ct.a}),n.d(e,"B",function(){return ct.d}),n.d(e,"J",function(){return ct.e}),n.d(e,"Fb",function(){return ct.i}),n.d(e,"uc",function(){return ct.j}),n.d(e,"Cb",function(){return ct.h}),n.d(e,"lb",function(){return ct.f}),n.d(e,"sb",function(){return dt}),n.d(e,"ic",function(){return pt}),n.d(e,"pb",function(){return ht.a}),n.d(e,"nc",function(){return ht.c}),n.d(e,"qb",function(){return ht.b}),n.d(e,"gc",function(){return ft.a}),n.d(e,"hc",function(){return mt}),n.d(e,"g",function(){return gt.a}),n.d(e,"r",function(){return gt.b}),n.d(e,"I",function(){return gt.c}),n.d(e,"N",function(){return gt.d}),n.d(e,"tb",function(){return gt.f}),n.d(e,"T",function(){return gt.e}),n.d(e,"Y",function(){return vt.a}),n.d(e,"tc",function(){return yt.a}),n.d(e,"yc",function(){return bt.b}),n.d(e,"qc",function(){return bt.a}),n.d(e,"zc",function(){return St.a}),n.d(e,"Ac",function(){return wt.a}),n.d(e,"Bc",function(){return Ct.a}),n.d(e,"jc",function(){return Pt}),n.d(e,"oc",function(){return It.b})},7:function(t,e,n){"use strict";n.r(e);var r=n(463),o=n(272),i=n(145),a=n(1054),u=function(t,e,n){var r={};return Object(i.keys)(n).forEach(function(o){var i=n[o],u=n[o].length>1?Object(a.a)(i)(t):function(t){return 1===t.length}(i)?function(){return i(t)}:n[o];r[o]=function(){return e(u.apply(void 0,arguments))}}),r};var s=n(39),c=n(388),l=n(387),d=n(605);function p(t){var e=Object(l.a)(t);return e&&e.exceptionHandler||c.a}var h=n(604),f=n(3),m=n(468),g=n(148),v=n(733),y=n(1),b=n(309),S=n(36),w=n(456),C=n(450),E=n(178),P=n(734),I=n(439),x=n(735),_=n(258),U=n(317),O=n.n(U),k=n(25),D=n(62),W=n(63),R=n(221),M=n(64),N=n(22),A=n.n(N),B=n(2),L=n.n(B);function T(t,e){return e.contextTypes=L()({},t.contextTypes||{},o.b),e.defaultProps=t.defaultProps,e.displayName=t.displayName,e}var j=function(t){return function(e){var n=A()(t);return T(e,function(e){function r(e,o){var i;return Object(k.a)(this,r),i=Object(D.a)(this,Object(W.a)(r).call(this,e,o)),n.forEach(function(e){O()(Object(R.a)(i),e,{get:function(){return t[e](Object(R.a)(i))}})}),i}return Object(M.a)(r,e),r}(e))}},F=j({appContext:function(t){return Object(l.a)(t)||Object(_.throwError)("AppContext not found.")}}),z=n(26),H=n(494);var G=function(t){var e=t;return T(e,function(t){function n(){var t;return Object(k.a)(this,n),(t=Object(D.a)(this,Object(W.a)(n).apply(this,arguments))).exportStyles=[],t}return Object(M.a)(n,t),Object(z.a)(n,[{key:"componentWillMount",value:function(){var t=e.prototype.componentWillMount;t&&t.call(this),this.exportCssStyles()}},{key:"exportCssStyles",value:function(){if(this.exportStyles){var t=(e=this,(n=Object(l.a)(e))&&n.cssExtractor||H.a);this.exportStyles.forEach(function(e){var n=e&&e._getContent&&"function"==typeof e._getContent&&e._getContent();n&&n.length>0&&n.forEach(function(e){t.exportCss(e[1])})})}var e,n}}]),n}(e))},Y=function(t){return function(e){return T(e,function(e){function n(e,r){var o;return Object(k.a)(this,n),(o=Object(D.a)(this,Object(W.a)(n).call(this,e,r))).constructor.displayName=t(o.constructor.displayName),o}return Object(M.a)(n,e),n}(e))}},K=function(t){var e=t;return T(e,function(t){function n(){var t;return Object(k.a)(this,n),(t=Object(D.a)(this,Object(W.a)(n).apply(this,arguments)))._maySetState=!1,t}return Object(M.a)(n,t),Object(z.a)(n,[{key:"componentWillMount",value:function(){var t=e.prototype.componentWillMount;t&&t.call(this),this._maySetState=!0}},{key:"componentWillUnmount",value:function(){var t=e.prototype.componentWillUnmount;t&&t.call(this),this._maySetState=!1}},{key:"setStateWithCallback",value:function(t,e){var n=this;if(this._maySetState){return this.setState(function(e,r){try{return t(e,r)}catch(t){return p(n).handleException("".concat(Object(d.a)(n),".setStateWithCallback"),t),e}})}}},{key:"setStateIfMounted",value:function(t){this._maySetState&&this.setState(function(){return t})}},{key:"updateStateIfMounted",value:function(t){this._maySetState&&this.setState(function(e){return L()({},e,t)})}}]),n}(e))},q=function(t){return function(e){var n=A()(t);return T(e,function(e){function r(e,o){var i;return Object(k.a)(this,r),i=Object(D.a)(this,Object(W.a)(r).call(this,e,o)),n.forEach(function(e){O()(Object(R.a)(i),e,{get:function(){return Object(h.a)(Object(R.a)(i),t[e])}})}),i}return Object(M.a)(r,e),r}(e))}};n.d(e,"App",function(){return r.a}),n.d(e,"AppContext",function(){return o.a}),n.d(e,"appContextReactContextTypes",function(){return o.b}),n.d(e,"bindActionCreators",function(){return u}),n.d(e,"buildReducer",function(){return s.a}),n.d(e,"makeSafeExceptionHandler",function(){return c.b}),n.d(e,"getAppContext",function(){return l.a}),n.d(e,"getAppContextOrThrowError",function(){return l.b}),n.d(e,"getComponentName",function(){return d.a}),n.d(e,"getExceptionHandler",function(){return p}),n.d(e,"getSingleton",function(){return h.a}),n.d(e,"ImmutableMap",function(){return f.a}),n.d(e,"immutableMapReducer",function(){return m.a}),n.d(e,"isEqual",function(){return g.a}),n.d(e,"isShallowEqual",function(){return v.a}),n.d(e,"makeActionCreator",function(){return y.a}),n.d(e,"makeActionCreatorWithMeta",function(){return y.b}),n.d(e,"getLogPayloadPostProcessor",function(){return b.a}),n.d(e,"makeActionLogger",function(){return b.b}),n.d(e,"setLogPayloadPostProcessor",function(){return b.c}),n.d(e,"makeFunctionalStore",function(){return S.a}),n.d(e,"makeReducer",function(){return w.a}),n.d(e,"makeSelectorFactory",function(){return C.a}),n.d(e,"loadStoreStateAction",function(){return E.a}),n.d(e,"selectorsKey",function(){return E.b}),n.d(e,"storesKey",function(){return E.c}),n.d(e,"SnapshotBuilder",function(){return P.a}),n.d(e,"asmTransition",function(){return I.a}),n.d(e,"stateMachineReducer",function(){return I.b}),n.d(e,"transition",function(){return I.c}),n.d(e,"StoreCollection",function(){return x.a}),n.d(e,"withAppContext",function(){return F}),n.d(e,"withCssExtraction",function(){return G}),n.d(e,"withNewDisplayName",function(){return Y}),n.d(e,"withProperties",function(){return j}),n.d(e,"withSafeSetState",function(){return K}),n.d(e,"withSingletons",function(){return q})},804:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(12),o=n(7),i=n(805),a={dataUrl:void 0,currentImageDataUrl:void 0,status:"READY",warning:void 0,show:!1,isUpdated:!1,uploadStart:0,uploadDuration:0},u=o.buildReducer().handleAction(i.ImageEditCancelled,function(t){return r.updateWith(t,{dataUrl:"",currentImageDataUrl:"",status:"READY",warning:void 0,isUpdated:!1})}).handleAction(i.WarningDismissed,function(t){return r.updateWith(t,{status:"READY",warning:void 0})}).handleAction(i.LoadedCurrentImage,function(t,e){var n=e.payload.dataUrl;return r.updateWith(t,{dataUrl:t.dataUrl||n,currentImageDataUrl:t.currentImageDataUrl||n})}).handleAction(i.LoadedNewImage,function(t,e){return r.updateWith(t,{dataUrl:e.payload.dataUrl,status:"READY",warning:void 0,isUpdated:e.payload.dataUrl!==t.currentImageDataUrl})}).handleAction(i.LoadedEmptyImage,function(t){return r.updateWith(t,{dataUrl:"",status:"READY",warning:void 0,isUpdated:!!t.currentImageDataUrl})}).handleAction(i.UploadStarted,function(t,e){return r.updateWith(t,{status:"IN_PROGRESS",warning:void 0,uploadStart:e.payload.now,uploadDuration:0})}).handleAction(i.UploadProgress,function(t,e){return"IN_PROGRESS"===t.status?r.updateWith(t,{uploadDuration:e.payload.now-t.uploadStart}):t}).handleAction(i.UploadSucceeded,function(t,e){return r.updateWith(t,{currentImageDataUrl:e.payload.dataUrl,status:"SUCCESS",warning:void 0})}).handleAction(i.SomethingWentWrong,function(t,e){return r.updateWith(t,{status:"SOMETHING_WENT_WRONG",warning:e.payload.warning})}).handleAction(i.ImageUpdated,function(t){return r.updateWith(t,{isUpdated:!0})}).done(a);e.ProfilePhotoPickerStore=o.makeFunctionalStore("ProfilePhotoPickerStore",u,function(t){return t})},805:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(7),o="ProfilePhotoPicker";function i(t){var e=""+o+t+"Action";return r.makeActionCreator(e,{featureName:o})}e.SomethingWentWrong=i("SomethingWentWrong"),e.ImageEditCancelled=i("ImageEditCancelled"),e.ImageUpdated=i("ImageUpdated"),e.LoadedCurrentImage=i("LoadedCurrentImage"),e.LoadedEmptyImage=i("LoadedEmptyImage"),e.LoadedNewImage=i("LoadedNewImage"),e.UploadStarted=i("UploadStarted"),e.UploadProgress=i("UploadProgress"),e.UploadSucceeded=i("UploadSucceeded"),e.WarningDismissed=i("WarningDismissed")},850:function(t,e,n){"use strict";var r,o=n(223),i=o(n(306)),a=o(n(222)),u=(r=function(t,e){return(r=a.default||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?(0,i.default)(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(12),c=n(435),l=n(760),d=n(892),p=n(806),h=n(882),f=n(601),m=n(4),g=n(219),v=n(957),y=n(805),b=n(804),S=n(851),w=n(958),C=n(961),E=n(852),P=S.sigmoidFactory(5),I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.editCanvas=null,e.fileInput=null,e.focusTrap=null,e.primaryButton=null,e.handleOnRemoveButtonClicked=function(){e.props.onLoadedEmptyImage()},e.handleOnSaveButtonClicked=function(){switch(e.props.status){case"SUCCESS":return e.props.onDismiss();default:if(!e.editCanvas)return;var t=e.editCanvas.getImageDataUrlFromCanvas();e.props.onStartUpload(performance.now(),t,e.props.onUpload)}},e.handleUploadAnimation=function(){"IN_PROGRESS"===e.props.status&&e.props.onUploadProgress(performance.now())},e.handleOnCancelButtonClicked=function(){e.props.onImageEditCancelled(),e.props.onDismiss()},e}return u(e,t),e.prototype.render=function(){var t=this,e=E.getStyles(this.props.theme),n=this.getSaveButtonText(this.props.status),r=this.getWarningText(this.props.warning),o=d.initialsColorPropToColorCode({text:this.props.personDisplayName}),i=f.getInitials(this.props.personDisplayName,f.getRTL());return m.createElement(h.Modal,{className:"lpc_nested_popup",containerClassName:e.modal,isOpen:!0,onDismiss:this.props.onDismiss,titleAriaId:this.props.strings.uploadHeader},m.createElement(p.FocusTrapZone,{id:"lpc-photo-picker",className:e.picker,componentRef:function(e){return t.focusTrap=e},firstFocusableSelector:e.fileInputButton},m.createElement(l.IconButton,{className:e.closeButton,iconProps:{iconName:"Cancel"},onClick:this.props.onDismiss,ariaLabel:this.props.strings.cancel}),m.createElement("div",{className:e.header},m.createElement("div",{className:e.uploadHeader},this.props.strings.uploadHeader)),r&&m.createElement(C.default,{theme:this.props.theme,warning:this.props.warning,status:this.props.status,warningText:r,onDismiss:this.props.onDismissInfoBar}),m.createElement("input",{role:"button",className:e.fileInput,type:"file",ref:function(e){return t.fileInput=e},onClick:function(t){return t.currentTarget.value=""},onChange:function(e){return e.currentTarget.files&&t.props.onFileSelected(e.currentTarget.files[0])},"data-log-name":"PhotoPickerFileInput",accept:"image/*"}),m.createElement(l.ActionButton,{className:e.fileInputButton,iconProps:{iconName:"Add"},onClick:function(){return t.fileInput&&t.fileInput.click()}},this.props.strings.upload),m.createElement(w.EditCanvas,{theme:this.props.theme,ref:function(e){return t.editCanvas=e},dataUrl:this.props.dataUrl,initials:i,textboyColor:o,progress:this.props.progress,warning:r,strings:this.props.strings,onError:this.props.onError,onFileSelected:this.props.onFileSelected,onRefocus:function(){return t.focusTrap&&t.focusTrap.focus()},onUpdate:this.props.onImageUpdated}),m.createElement("div",{className:e.endActions},m.createElement(l.PrimaryButton,{disabled:!this.props.isUpdated||"IN_PROGRESS"===this.props.status,onClick:this.handleOnSaveButtonClicked,"data-log-name":"PhotoPickerOkay",componentRef:function(e){return t.primaryButton=e}},n),this.props.progress>0?null:m.createElement(l.DefaultButton,{onClick:this.handleOnCancelButtonClicked,"data-log-name":"PhotoPickerCancel"},this.props.strings.cancel),this.props.isImageRemovable&&m.createElement(l.ActionButton,{className:e.removeButton,iconProps:{iconName:"Delete"},onClick:this.handleOnRemoveButtonClicked,"data-log-name":"PhotoPickerDelete"},this.props.strings.remove))))},e.prototype.componentDidMount=function(){var t=this;this.loadCurrentImage(),requestAnimationFrame(function(){return t.focusTrap&&t.focusTrap.focus()})},e.prototype.componentWillUnmount=function(){this.props.onImageEditCancelled()},e.prototype.componentDidUpdate=function(t){"IN_PROGRESS"===this.props.status&&requestAnimationFrame(this.handleUploadAnimation),"IN_PROGRESS"===t.status&&"SUCCESS"===this.props.status&&this.primaryButton&&this.primaryButton.focus()},e.prototype.getSaveButtonText=function(t){switch(t){case"IN_PROGRESS":return this.props.strings.inProgress;case"SUCCESS":return this.props.strings.close;case"READY":case"SOMETHING_WENT_WRONG":return this.props.strings.apply;default:return s.neverGuard(t)}},e.prototype.getWarningText=function(t){switch(t){case"IMAGE_TOO_SMALL":return this.props.strings.imageTooSmall;case"NOT_AN_IMAGE":return this.props.strings.notAnImage;case"UNKNOWN":return this.props.strings.somethingWentWrong;case"UNSUPPORTED_BROWSER":return this.props.strings.unsupportedBrowser;default:return""}},e.prototype.loadCurrentImage=function(){var t=this,e=new Image;e.crossOrigin="Anonymous",e.onload=function(){return t.profileImageLoaded(e)},e.onerror=function(){return t.profileImageLoadFailed()},e.src=this.props.personImageUrl},e.prototype.profileImageLoaded=function(t){var e=document.createElement("canvas");e.width=t.naturalWidth,e.height=t.naturalHeight;var n=e.getContext("2d");n?(n.drawImage(t,0,0),this.props.onLoadedCurrentImage(S.safeToDataURL(e))):this.props.onError("UNSUPPORTED_BROWSER")},e.prototype.profileImageLoadFailed=function(){this.props.onLoadedEmptyImage()},e}(m.Component);e.ProfilePhotoPicker=c.withTheme(g.connect(function(t,e){var n=b.ProfilePhotoPickerStore.getSelectors(t),r=0;switch(n.status){case"IN_PROGRESS":var o=n.uploadDuration/2e3;r=.999999*P(o);break;case"SUCCESS":r=1;break;case"READY":case"SOMETHING_WENT_WRONG":r=0;break;default:s.neverGuard(n.status)}return{dataUrl:n.dataUrl,initialImage:n.currentImageDataUrl,warning:n.warning,status:n.status,isUpdated:n.isUpdated,progress:r}},function(t){return{onDismissInfoBar:function(){return t(y.WarningDismissed())},onError:function(e){return t(y.SomethingWentWrong({warning:e}))},onFileSelected:function(e){return v.fileSelected(t,e)},onImageEditCancelled:function(){return t(y.ImageEditCancelled())},onImageUpdated:function(){return t(y.ImageUpdated())},onLoadedCurrentImage:function(e){return t(y.LoadedCurrentImage({dataUrl:e}))},onLoadedEmptyImage:function(){return t(y.LoadedEmptyImage())},onStartUpload:function(e,n,r){return v.startUpload(t,e,n,r)},onUploadProgress:function(e){return t(y.UploadProgress({now:e}))}}})(I))},851:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sigmoidFactory=function(t){function e(e){return 1/(1+Math.exp(-t*e))-.5}var n=.5/e(1);return function(t){return t<=0?0:t>1?1:n*e(2*t-1)+.5}},e.neverGuard=function(t){return t},e.safeToDataURL=function(t){try{return t.toDataURL("image/jpeg")}catch(t){return console.error(t),""}}},852:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(434),o=n(601);e.getStyles=o.memoizeFunction(function(t){var e=t.palette;return r.mergeStyleSets({picker:t.fonts.medium,uploadHeader:t.fonts.xLarge,messageBarText:t.fonts.medium},{modal:{width:512,maxWidth:512,margin:0,selectors:{"#lpc-photo-picker .ms-Button-icon":{display:"inline-block",minWidth:16,padding:"0px 4px",backgroundColor:"transparent"},"#lpc-photo-picker .ms-Slider-slideBox:focus":{outline:"transparent"},"#lpc-photo-picker .ms-Button":{height:32,border:"none"},"#lpc-photo-picker .ms-Button--default":{marginLeft:0,backgroundColor:e.neutralLighter},"#lpc-photo-picker .ms-Button--icon &hover":{color:e.themePrimary},"#lpc-photo-picker .ms-Button--icon &active":{color:e.themeDarker},"#lpc-photo-picker .ms-Button--primary &:not([disabled])":{backgroundColor:e.themePrimary},"#lpc-photo-picker .ms-Button--primary &:hover":{backgroundColor:e.themeDarkAlt},"#lpc-photo-picker .ms-Button--primary &:active":{backgroundColor:e.themeDark},"#lpc-photo-picker .ms-Button--default .ms-Button-label":{color:e.neutralDark},"#lpc-photo-picker .ms-Button--default &:hover":{backgroundColor:e.neutralLight},"#lpc-photo-picker .ms-Button--default &:active":{backgroundColor:e.neutralTertiaryAlt}}},picker:{padding:32,overflow:"hidden"},header:{display:"flex",alignContent:"space-between"},uploadHeader:{color:e.neutralPrimary,fontWeight:300,marginBottom:7,flexGrow:1},messageBar:{margin:"7px 0"},messageBarText:{color:e.neutralPrimary},fileInput:{display:"none"},fileInputButton:{color:e.themePrimary,padding:0,margin:"0 0 12px -4px"},closeButton:{float:"right",marginTop:-20,marginRight:-20},removeButton:{marginLeft:"auto"},endActions:{alignItems:"center",display:"flex",selectors:{button:{marginRight:12,minWidth:90,padding:"0px 16px"}}}})})},871:function(t,e,n){"use strict";function r(t){var e;return t&&(t===window?e={left:0,top:0,width:window.innerWidth,height:window.innerHeight,right:window.innerWidth,bottom:window.innerHeight}:t.getBoundingClientRect&&(e=t.getBoundingClientRect())),e}n.d(e,"a",function(){return r})},887:function(t,e,n){"use strict";function r(t){return t.clientWidth<t.scrollWidth}function o(t){return t.clientHeight<t.scrollHeight}function i(t){return r(t)||o(t)}n.d(e,"a",function(){return r}),n.d(e,"c",function(){return o}),n.d(e,"b",function(){return i})},891:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=/\([^)]*\)|[\0-\u001F\!-\/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,o=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,i=/\s+/g,a=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function u(t,e,n){return t?(t=function(t){return t=(t=(t=t.replace(r,"")).replace(i," ")).trim()}(t),a.test(t)||!n&&o.test(t)?"":function(t,e){var n="",r=t.split(" ");return 2===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[1].charAt(0).toUpperCase()):3===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[2].charAt(0).toUpperCase()):0!==r.length&&(n+=r[0].charAt(0).toUpperCase()),e&&n.length>1?n.charAt(1)+n.charAt(0):n}(t,e)):""}},895:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(38),o=n(4),i=function(t){function e(e){var n=t.call(this,e)||this;return n.state={isRendered:!1},n}return r.c(e,t),e.prototype.componentDidMount=function(){var t=this,e=this.props.delay;this._timeoutId=setTimeout(function(){t.setState({isRendered:!0})},e)},e.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},e.prototype.render=function(){return this.state.isRendered?o.Children.only(this.props.children):null},e.defaultProps={delay:0},e}(o.Component)},896:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(817),o=function(t){var e;return function(n){e||(e=new Set,Object(r.a)(t,{componentWillUnmount:function(){e.forEach(function(t){return cancelAnimationFrame(t)})}}));var o=requestAnimationFrame(function(){e.delete(o),n()});e.add(o)}}},949:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(866),o=n(889),i=n(871),a=function(){function t(t){this._events=new r.a(this),this._scrollableParent=Object(o.e)(t),this._incrementScroll=this._incrementScroll.bind(this),this._scrollRect=Object(i.a)(this._scrollableParent),this._scrollableParent===window&&(this._scrollableParent=document.body),this._scrollableParent&&(this._events.on(window,"mousemove",this._onMouseMove,!0),this._events.on(window,"touchmove",this._onTouchMove,!0))}return t.prototype.dispose=function(){this._events.dispose(),this._stopScroll()},t.prototype._onMouseMove=function(t){this._computeScrollVelocity(t.clientY)},t.prototype._onTouchMove=function(t){t.touches.length>0&&this._computeScrollVelocity(t.touches[0].clientY)},t.prototype._computeScrollVelocity=function(t){if(this._scrollRect){var e=this._scrollRect.top,n=e+this._scrollRect.height-100;this._scrollVelocity=t<e+100?Math.max(-15,(100-(t-e))/100*-15):t>n?Math.min(15,(t-n)/100*15):0,this._scrollVelocity?this._startScroll():this._stopScroll()}},t.prototype._startScroll=function(){this._timeoutId||this._incrementScroll()},t.prototype._incrementScroll=function(){this._scrollableParent&&(this._scrollableParent.scrollTop+=Math.round(this._scrollVelocity)),this._timeoutId=setTimeout(this._incrementScroll,16)},t.prototype._stopScroll=function(){this._timeoutId&&(clearTimeout(this._timeoutId),delete this._timeoutId)},t}()},950:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(38),o=n(4);function i(t,e){return function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return r.c(i,n),i.prototype.getChildContext=function(){return e(this.props)},i.prototype.render=function(){return o.Children.only(this.props.children)},i.childContextTypes=t,i}(o.Component)}},951:function(t,e,n){"use strict";function r(t){throw new Error("Unexpected object: "+t)}n.d(e,"a",function(){return r})},952:function(t,e,n){"use strict";function r(t,e,n){var r=n.value,o=!1;return{configurable:!0,get:function(){if(o||r&&this===r.prototype||this.hasOwnProperty(e))return r;var t=r&&r.bind(this);return o=!0,Object.defineProperty(this,e,{configurable:!0,writable:!0,enumerable:!0,value:t}),o=!1,t},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,enumerable:!0,value:t})}}}n.d(e,"a",function(){return r})},953:function(t,e,n){"use strict";function r(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function o(t){var e,n=t.contentSize,r=t.boundsSize,o=t.mode,i=void 0===o?"contain":o,a=t.maxScale,u=void 0===a?1:a,s=n.width/n.height,c=r.width/r.height;e=("contain"===i?s>c:s<c)?r.width/n.width:r.height/n.height;var l=Math.min(u,e);return{width:n.width*l,height:n.height*l}}function i(t){var e=/[1-9]([0]+$)|\.([0-9]*)/.exec(String(t));return e?e[1]?-e[1].length:e[2]?e[2].length:0:0}function a(t,e,n){void 0===n&&(n=10);var r=Math.pow(n,e);return Math.round(t*r)/r}n.d(e,"c",function(){return r}),n.d(e,"b",function(){return o}),n.d(e,"a",function(){return i}),n.d(e,"d",function(){return a})},954:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=/[\{\}]/g,o=/\{\d+\}/g;function i(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=e;return t.replace(o,function(t){var e=i[t.replace(r,"")];return null==e&&(e=""),e})}},957:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(805);e.fileSelected=function(t,e){var n=new FileReader,o=function(){return t(r.SomethingWentWrong({warning:"NOT_AN_IMAGE"}))};n.onerror=o,n.onloadend=function(){var e=document.createElement("img");e.onerror=o,e.onload=function(){return t(r.LoadedNewImage({dataUrl:e.src}))},e.src=String(n.result)},n.readAsDataURL(e)},e.startUpload=function(t,e,n,o){t(r.UploadStarted({now:e})),o(n,function(){return t(r.UploadSucceeded({dataUrl:n}))},function(){return t(r.SomethingWentWrong({warning:"UNKNOWN"}))})}},958:function(t,e,n){"use strict";var r,o=n(223),i=o(n(2)),a=o(n(306)),u=o(n(222)),s=(r=function(t,e){return(r=u.default||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?(0,a.default)(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var c=n(12),l=n(7),d=n(760),p=n(756),h=n(1026),f=n(601),m=n(4),g=n(959),v=n(851),y=n(960),b={1:[1,0,0,1,0,0],2:[-1,0,0,1,0,0],3:[-1,0,0,-1,0,0],4:[1,0,0,-1,0,0],5:[0,1,1,0,0,0],6:[0,1,-1,0,0,0],7:[0,-1,-1,0,0,0],8:[0,-1,1,0,0,0]},S=function(t,e,n){return Math.min(n,Math.max(t,e))},w=function(t){function e(e){var n=t.call(this,e)||this;return n.hasUnmounted=!1,n.editorCanvas=null,n.textBoy=null,n.initialState={xpos:0,ypos:0,absoluteScale:1,relativeScale:0,stepSize:.1,orientation:1,maximumScale:1,naturalMin:0,naturalWidth:0,naturalHeight:0,moving:!1,lastMouseX:0,lastMouseY:0,zoomInDisabled:!0,zoomOutDisabled:!0,image:void 0,initialRender:!0},n.state=(0,i.default)({},n.initialState),n}return s(e,t),e.prototype.render=function(){var t=this,e=!this.state.image||this.state.maximumScale<=1||this.props.progress>0,n=!e||this.state.naturalHeight!==this.state.naturalWidth,r=y.getStyles(this.props.theme,n),o=1===this.props.progress?m.createElement("div",{className:r.textboy},m.createElement("span",{className:r.invisible,"aria-live":"assertive"},this.props.strings.success),m.createElement(p.Icon,{className:r.initials,iconName:"CheckMark"})):null,i=S(2*this.state.stepSize,.1,.2),a=e?m.createElement("div",{className:r.editControls}):m.createElement("div",{className:r.editControls},m.createElement(d.IconButton,{className:r.zoomButton,iconProps:{iconName:"CalculatorSubtract"},title:this.props.strings.zoomOut,ariaLabel:this.props.strings.zoomOut,onClick:function(){return t.zoom(-i,128,128)},disabled:this.state.zoomOutDisabled,tabIndex:-1}),m.createElement(h.Slider,{ariaLabel:this.props.strings.zoom,className:r.slider,min:0,max:1,step:S(this.state.stepSize,.05,.1),value:this.state.relativeScale,showValue:!1,onChange:function(e){return t.handleZoomSlider(e)}}),m.createElement(d.IconButton,{className:r.zoomButton,iconProps:{iconName:"CalculatorAddition"},title:this.props.strings.zoomIn,ariaLabel:this.props.strings.zoomIn,onClick:function(){return t.zoom(i,128,128)},disabled:this.state.zoomInDisabled,tabIndex:-1}));return m.createElement("div",{className:r.canvasContainer},m.createElement("canvas",{className:r.editCanvas,role:"img",tabIndex:this.state.image?0:void 0,ref:function(e){return t.editorCanvas=e},width:256,height:256,onKeyDown:function(e){return t.onKeyboardHandler(e)},"aria-label":this.props.strings.dropZone}),m.createElement("div",{className:r.textboy,ref:function(e){return t.textBoy=e}},m.createElement("div",{className:r.initials},this.props.initials),m.createElement("div",null,this.props.strings.dropZone)),o,a)},e.prototype.componentWillUnmount=function(){this.hasUnmounted=!0},e.prototype.componentDidMount=function(){var t=this;this.props.dataUrl&&setTimeout(function(){return t.props.dataUrl&&t.loadImage(t.props.dataUrl)},0),this.attachEventListeners(),this.renderCanvasContent()},e.prototype.shouldComponentUpdate=function(t,e){return!l.isEqual(t,this.props)||!l.isEqual(e,this.state)},e.prototype.componentWillReceiveProps=function(t){t.dataUrl&&t.dataUrl!==this.props.dataUrl?this.loadImage(t.dataUrl):t.dataUrl!==this.props.dataUrl&&(this.state=(0,i.default)({},this.initialState))},e.prototype.componentDidUpdate=function(t){this.renderCanvasContent(),1===this.props.progress&&t.progress!==this.props.progress&&this.props.onRefocus()},e.prototype.getImageDataUrlFromCanvas=function(t){var e=this;if(void 0===t&&(t=648),!this.state.image)return"";var n=document.createElement("canvas"),r=this.state.naturalMin/this.state.absoluteScale;n.width=r,n.height=r;var o=n.getContext("2d");if(!o)return this.props.onError("UNSUPPORTED_BROWSER"),"";o.fillStyle="white",o.fillRect(0,0,n.width,n.height),this.state.image&&this.withCenterRotated(o,n.width,this.state.orientation,this.state.image,function(t,r){return o.drawImage(r,e.state.xpos*n.width/256,e.state.ypos*n.height/256,e.state.naturalWidth,e.state.naturalHeight)});for(var i=1;n.width*i/4>=t;)i/=2,o.drawImage(n,0,0,n.width*i,n.height*i);var a=document.createElement("canvas"),u=Math.min(this.state.naturalMin/this.state.absoluteScale,t);a.width=u,a.height=u;var s=a.getContext("2d");return s?(s.drawImage(n,0,0,n.width*i,n.width*i,0,0,u,u),v.safeToDataURL(a)):(this.props.onError("UNSUPPORTED_BROWSER"),"")},e.prototype.loadImage=function(t){var e=this;if(t){var n=new Image;n.onload=function(){return e.imageLoaded(n)},n.src=t}else this.setState(this.initialState)},e.prototype.imageLoaded=function(t){var e=this,n=Math.min(t.naturalWidth,t.naturalHeight),r=n/256,o=function(t){return-.5*(t/r-256)},i=Math.min(1,Math.max(.01,256/(2*Math.max(t.naturalWidth,t.naturalHeight)))),a=c.updateWith(this.initialState,{naturalMin:n,naturalWidth:t.naturalWidth,naturalHeight:t.naturalHeight,stepSize:i,maximumScale:r,orientation:g.exifOrientation(t.src),image:t,zoomInDisabled:!1,initialRender:!1,xpos:o(t.naturalWidth),ypos:o(t.naturalHeight)});!this.state.initialRender&&a.maximumScale<1&&setTimeout(function(){return e.props.onError("IMAGE_TOO_SMALL")},0),this.hasUnmounted||this.setState(a)},e.prototype.renderCanvasContent=function(){var t=this,e=this.editorCanvas;if(e&&this.textBoy){var n=e.getContext("2d");if(n){var r=window.getComputedStyle(e);n.fillStyle=r.backgroundColor||"#ffffff",n.fillRect(0,0,1,1);var o=n.getImageData(0,0,1,1).data,i="rgba("+o[0]+", "+o[1]+", "+o[2]+", 0.6)",a="rgba("+o[0]+", "+o[1]+", "+o[2]+", 1)";""===this.props.dataUrl?(n.fillStyle=this.props.textboyColor,this.textBoy.style.display="flex"):(n.fillStyle="white",this.textBoy.style.display="none"),n.fillRect(0,0,256,256),this.state.image&&this.withCenterRotated(n,256,this.state.orientation,this.state.image,function(e,n){return e.drawImage(n,t.state.xpos,t.state.ypos,t.state.naturalWidth*t.state.absoluteScale/t.state.maximumScale,t.state.naturalHeight*t.state.absoluteScale/t.state.maximumScale)}),n.save(),n.beginPath(),n.rect(0,0,256,256),n.arc(128,128,125,0,2*Math.PI,!0),n.clip(),n.fillStyle=i,n.fillRect(0,0,256,256),n.restore(),n.save(),n.beginPath(),n.arc(128,128,126,0,2*Math.PI,!0),n.lineWidth=2,n.strokeStyle=a,n.stroke(),n.restore(),n.save(),n.beginPath(),n.lineWidth=4,n.fillStyle="rgba(0, 120, 215, 0.5)",n.strokeStyle="rgba(0, 120, 215, 0.5)",n.arc(128,128,125,-Math.PI/2,2*this.props.progress*Math.PI-Math.PI/2,!1),1===this.props.progress&&n.fill(),n.stroke(),n.restore()}else this.props.onError("UNSUPPORTED_BROWSER")}},e.prototype.withCenterRotated=function(t,e,n,r,o){t.save(),t.translate(e/2,e/2),t.transform.apply(t,b[n]),t.translate(-e/2,-e/2),o(t,r),t.restore()},e.prototype.rotate=function(t,e,n){var r=b[n],o=r[0],i=r[2];return{x:(t-=128)*o+(e-=128)*r[1]+128,y:t*i+e*r[3]+128}},e.prototype.attachEventListeners=function(){var t=this;this.editorCanvas&&this.textBoy&&(this.editorCanvas.addEventListener("dragenter",this.handleDragEnter.bind(this),!1),this.editorCanvas.addEventListener("dragleave",this.handleDragLeave.bind(this),!1),this.editorCanvas.addEventListener("dragover",this.stopEventDefaults.bind(this),!1),this.editorCanvas.addEventListener("drop",this.handleFileDrop.bind(this),!1),this.textBoy.addEventListener("dragenter",this.handleDragEnter.bind(this),!1),this.textBoy.addEventListener("dragleave",this.handleDragLeave.bind(this),!1),this.textBoy.addEventListener("dragover",this.stopEventDefaults.bind(this),!1),this.textBoy.addEventListener("drop",this.handleFileDrop.bind(this),!1),this.editorCanvas.addEventListener("mousedown",this.handleDragStart.bind(this),!1),this.editorCanvas.addEventListener("mousemove",function(e){return t.handleDrag(e,!0)},!1),this.editorCanvas.addEventListener("mouseup",function(e){return t.handleDrag(e,!1)},!1),this.editorCanvas.addEventListener("mouseleave",function(e){return t.handleDrag(e,!1)},!1),this.editorCanvas.addEventListener("wheel",this.handleWheel.bind(this),!1))},e.prototype.stopEventDefaults=function(t){t.stopPropagation(),t.preventDefault()},e.prototype.keepInside=function(t,e){return t>0?0:t+e<256?256-e:t},e.prototype.handleZoomSlider=function(t){!this.state.image||this.state.maximumScale<1||this.zoom(t-this.state.relativeScale,128,128,!1)},e.prototype.newScaledPosition=function(t,e,n,r){var o=t+(e-t)*r/this.state.absoluteScale,i=r*n/this.state.maximumScale;return this.keepInside(o,i)},e.prototype.zoom=function(t,e,n,r){var o=this;if(void 0===r&&(r=!0),this.state.image&&!(this.state.maximumScale<1)){var i=Math.min(1,Math.max(0,this.state.relativeScale+t));if(i!==this.state.relativeScale){var a=Math.exp(i*Math.log(this.state.maximumScale));this.setState(function(t,u){var s=a<=1,l=a>=t.maximumScale;return r&&(s||l)&&o.props.onRefocus(),c.updateWith(t,{absoluteScale:a,relativeScale:i,zoomOutDisabled:s,zoomInDisabled:l,xpos:o.newScaledPosition(e,o.state.xpos,o.state.naturalWidth,a),ypos:o.newScaledPosition(n,o.state.ypos,o.state.naturalHeight,a)})}),this.props.onUpdate()}}},e.prototype.handleWheel=function(t){if(this.state.image){this.stopEventDefaults(t);var e=t.deltaY>0?-1:1,n=this.rotate(t.offsetX,t.offsetY,this.state.orientation),r=n.x,o=n.y;this.zoom(S(this.state.stepSize,.05,.1)*e,r,o)}},e.prototype.handleDragStart=function(t){var e=this.rotate(t.clientX,t.clientY,this.state.orientation),n=e.x,r=e.y;this.state.image&&(this.stopEventDefaults(t),this.setState(function(t,e){return c.updateWith(t,{moving:!0,lastMouseX:n,lastMouseY:r})}))},e.prototype.handleDrag=function(t,e){this.stopEventDefaults(t);var n=this.rotate(t.clientX,t.clientY,this.state.orientation),r=n.x,o=n.y;if(this.state.image&&this.state.moving){var i=this.keepInside(this.state.xpos+(r-this.state.lastMouseX),this.state.naturalWidth*this.state.absoluteScale/this.state.maximumScale),a=this.keepInside(this.state.ypos+(o-this.state.lastMouseY),this.state.naturalHeight*this.state.absoluteScale/this.state.maximumScale);(this.state.xpos!==i||this.state.ypos!==a)&&this.props.onUpdate(),this.setState(function(t,n){return c.updateWith(t,{moving:e,xpos:i,ypos:a,lastMouseX:r,lastMouseY:o})})}},e.prototype.handleDragEnter=function(t){this.stopEventDefaults(t),this.editorCanvas&&(this.editorCanvas.style.outline="1px solid purple")},e.prototype.handleDragLeave=function(t){this.stopEventDefaults(t),this.editorCanvas&&(this.editorCanvas.style.outline="none")},e.prototype.handleFileDrop=function(t){this.handleDragLeave(t),t.dataTransfer&&this.props.onFileSelected(t.dataTransfer.files[0])},e.prototype.onKeyboardHandler=function(t){var e=this;switch(t.key){case"+":return this.zoom(this.state.stepSize,128,128,!1);case"-":return this.zoom(-this.state.stepSize,128,128,!1)}var n=(t.which===f.KeyCodes.left?1:t.which===f.KeyCodes.right&&-1)||0,r=(t.which===f.KeyCodes.up?1:t.which===f.KeyCodes.down&&-1)||0,o=this.rotate(n,r,this.state.orientation),i=o.x,a=o.y;this.state.image&&this.setState(function(t,n){var r=i*t.naturalWidth/100,o=a*t.naturalHeight/100;return c.updateWith(t,{xpos:e.keepInside(t.xpos+r,t.naturalWidth*t.absoluteScale/t.maximumScale),ypos:e.keepInside(t.ypos+o,t.naturalHeight*t.absoluteScale/t.maximumScale)})})},e}(m.Component);e.EditCanvas=w},959:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.exifOrientation=function(t){var e=new DataView(function(t){for(var e=t.replace(/^data\:([^\;]+)\;base64,/i,""),n=atob(e),r=n.length,o=new ArrayBuffer(r),i=new Uint8Array(o),a=0;a<r;a++)i[a]=n.charCodeAt(a);return o}(t));if(65496!==e.getUint16(0,!1))return 1;for(var n,r=e.byteLength,o=2;o<r;){var i=e.getUint16(o,!1);if(o+=2,65505===i){if(1165519206!==e.getUint32(o+=2,!1))break;var a=18761===e.getUint16(o+=6,!1);o+=e.getUint32(o+4,a);var u=e.getUint16(o,a);o+=2;for(var s=0;s<u;s++)if(274===e.getUint16(o+12*s,a))return(n=e.getUint16(o+12*s+8,a))<1||n>8?1:n}else{if(65280!=(65280&i))break;o+=e.getUint16(o,!1)}}return 1}},960:function(t,e,n){"use strict";var r=n(223)(n(2)),o=function(){return(o=r.default||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(434),a=n(601);e.getStyles=a.memoizeFunction(function(t,e){var n=t.palette;return i.mergeStyleSets({editControls:{display:"flex",flexDirection:"row",width:"100%",height:54},zoomButton:{selectors:{"&:disabled":{background:n.white}}},editCanvas:{backgroundColor:n.white,cursor:e?"move":"inherit"},invisible:o({clip:"rect(1px, 1px, 1px, 1px)"},{height:1,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:1}),slider:{flexGrow:1,marginTop:2,marginBottom:24,selectors:{".ms-Slider-thumb":{border:"2px solid "+n.themePrimary},".ms-Slider-active":{backgroundColor:n.themePrimary},".ms-Slider-inactive":{backgroundColor:n.themeLight}}},canvasContainer:{margin:"0 auto",display:"flex",alignItems:"center",flexDirection:"column",width:256,position:"relative"},textboy:{color:n.white,position:"absolute",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",top:0,left:0,width:256,height:256},initials:{fontSize:128,lineHeight:128}})})},961:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(800),o=n(4),i=n(852);e.default=function(t){var e=i.getStyles(t.theme),n="UNKNOWN"===t.warning,a=n?r.MessageBarType.error:r.MessageBarType.warning,u=n?void 0:t.onDismiss;return o.createElement(r.MessageBar,{className:e.messageBar,messageBarType:a,onDismiss:u,isMultiline:!0,"aria-live":"polite",role:"region"},o.createElement("div",{className:e.messageBarText},t.warningText))}},962:function(t,e,n){"use strict";var r,o=n(223),i=o(n(2)),a=o(n(306)),u=o(n(222)),s=(r=function(t,e){return(r=u.default||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?(0,a.default)(e):(n.prototype=e.prototype,new n)}),c=function(){return(c=i.default||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var l=n(7),d=n(736),p=n(4),h=n(46),f=n(804),m=n(850),g=!1;function v(){g||(g=!0,d.initializeIcons(void 0,{disableWarnings:!0}))}e.initIcons=v;var y=null,b=0,S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.componentWillMount=function(){if(b>=1)throw new Error("Can only mount one StandaloneProfilePhotoPicker at a time.");if(b+=1,v(),null===y){var t=h.createStore(l.makeReducer([f.ProfilePhotoPickerStore]));y=new l.AppContext({reduxStore:t})}},e.prototype.componentWillUnmount=function(){b-=1},e.prototype.render=function(){return y?p.createElement(l.App,{context:y},p.createElement(m.ProfilePhotoPicker,c({},this.props))):null},e}(p.Component);e.StandaloneProfilePhotoPicker=S}}]);