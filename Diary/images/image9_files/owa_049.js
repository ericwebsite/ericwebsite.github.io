self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ServiceWorkerCache.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[362],{3221:function(e,a,n){"use strict";n.r(a);var r=n(41);var c,t=n(208),o=n(23),l=n(12);!function(e){e[e.Normal=0]="Normal",e[e.CacheCorrupt=1]="CacheCorrupt",e[e.TooManyInstallError=2]="TooManyInstallError"}(c||(c={}));var s,i=c;!function(e){e[e.Install=0]="Install",e[e.UnInstall=1]="UnInstall"}(s||(s={}));var u,h=s;!function(e){e[e.CacheProgress=0]="CacheProgress",e[e.Error=1]="Error"}(u||(u={}));var d,C=u;!function(e){e[e.Checking=0]="Checking",e[e.Downloading=1]="Downloading",e[e.Progress=2]="Progress",e[e.Error=3]="Error",e[e.Cached=4]="Cached",e[e.NoUpdate=5]="NoUpdate",e[e.Obsolete=6]="Obsolete",e[e.UpdateReady=7]="UpdateReady",e[e.Idle=8]="Idle",e[e.UnCached=9]="UnCached",e[e.CleanupError=10]="CleanupError",e[e.CleanupSuceeded=11]="CleanupSuceeded"}(d||(d={}));var p,f=d;!function(e){e[e.CacheInstalled=0]="CacheInstalled",e[e.CacheFailed=1]="CacheFailed",e[e.CacheCleared=2]="CacheCleared"}(p||(p={}));var v=p,g=n(18),b="SWCache";function k(e,a,n,r,c,t,o){var l={};l.ev=a,l.cv=n,l.e=r,l.rc=e.resourcesCached,l.ccs=e.cacheCleanupStatus,l.ncc=e.numberOfCachesCleaned,l.r=c,l.st=t,l.stk=o,l.ch=e.cacheHealth,l.app=e.appName,e.resourcesCached=0,e.cacheCleanupStatus=0,e.numberOfCachesCleaned=0,Object(g.o)(b,l)}var m=n(84);function w(e,a){return e+"_"+a}var S="SWCacheErrorCount";function W(e,a,n){var r=w(a.appName,S);0==n?Object(m.b)(e,r):Object(m.c)(e,r,""+n)}function N(e,a){var n=parseInt(Object(m.a)(e,w(a.appName,S)));return isNaN(n)?0:n}var O="CacheVersion",j="AttemptedCacheVersion";function I(e,a,n,r){switch(n){case v.CacheInstalled:Object(m.c)(e,w(a.appName,O),r),W(e,a,0);break;case v.CacheFailed:Object(m.c)(e,w(a.appName,j),r),W(e,a,N(e,a)+1);break;case v.CacheCleared:Object(m.c)(e,w(a.appName,O),null),Object(m.c)(e,w(a.appName,j),null),W(e,a,0)}}function E(e,a,n){if(null!=n.cacheMessage&&(n.targetClient==a.appName||"global"==n.targetClient)){var r=n.cacheMessage;switch(r.cacheEvent){case f.Checking:l.c.info("[SW Client] Checking");break;case f.Downloading:l.c.info("[SW Client] Downloading");break;case f.Progress:!function(e,a){l.c.info("[SW Client] Progress"),e.resourcesCached++}(a);break;case f.Error:!function(e,a,n){l.c.warn("[SW Client] Error: "+n.error),I(e,a,v.CacheFailed,n.cacheVersion),k(a,"ER",n.cacheVersion,n.error,n.resource,n.status,n.stack)}(e,a,r);break;case f.Cached:!function(e,a,n){l.c.info("[SW Client] Cached"),I(e,a,v.CacheInstalled,n.cacheVersion),k(a,"C",n.cacheVersion)}(e,a,r);break;case f.NoUpdate:!function(e,a,n){l.c.info("[SW Client] NoUpdate"),I(e,a,v.CacheInstalled,n.cacheVersion),k(a,"NU",n.cacheVersion)}(e,a,r);break;case f.Obsolete:!function(e,a,n){l.c.info("[SW Client] Obsolete"),I(e,a,v.CacheCleared,null),k(a,"OB"),a.cacheHealth>i.Normal&&(a.cacheHealth=i.Normal,P())}(e,a);break;case f.UpdateReady:!function(e,a,n){l.c.info("[SW Client] UpdateReady"),I(e,a,v.CacheInstalled,n.cacheVersion),k(a,"UR",n.cacheVersion)}(e,a,r);break;case f.Idle:l.c.info("[SW Client] Idle");break;case f.UnCached:l.c.info("[SW Client] Uncached");break;case f.CleanupError:!function(e,a){l.c.warn("[SW Client] Cleanup Error"),e.cacheCleanupStatus=1}(a);break;case f.CleanupSuceeded:!function(e,a){var n=null!=a.cachesCleaned?a.cachesCleaned.join(","):null;l.c.info("[SW Client] Cleanup Suceeded, "+n),e.cacheCleanupStatus=2,e.numberOfCachesCleaned=null!=a.cachesCleaned?a.cachesCleaned.length:0}(a,r)}}}var U=n(5),y=15,V=null,M=null;function P(){var e=(null!=V.serviceWorkerPath?V.serviceWorkerPath+"/"+V.appName+"cache.manifest":"/"+V.appName+"cache.manifest")+"?manifestVersion=2",a=h.Install;V.cacheHealth>i.Normal&&(a=h.UnInstall);var n={source:V.appName,action:a,bootResourcesOnly:!0,language:V.userLanguage,darkMode:void 0!==V.darkMode&&V.darkMode,manifestUrl:e,proxyFetchAlways:Object(U.d)("fwk-sw-proxyFetchAlways")};V.serviceWorkerRegistration.active.postMessage(n)}function R(e){if(null!=e.data){var a=e.data;a.messageType==C.CacheProgress?E(M,V,a):a.messageType==C.Error&&function(e){null!=e.error&&l.c.error({message:"[SW Client] ServiceWorker Unhandled Exception",error:e.error})}(a)}}var F=n(136),A="sw.js",H="activated",T=null,x=null,D=null,L=null,$=null,B=null,_=!1;function q(e,a,n,c){x=(D=e).navigator.serviceWorker;var s,i,u,h=Object(t.a)(D.location);s=h,i=D.location,u=s,null!=s&&(u=Object(r.r)("/"+s,i.pathname)),$=a,B=n,_=c;var d,C,p,f=null!=(L=u)?L+"/"+A:"/"+A,v=null!=h?{scope:"/"+h+"/"}:null,g=[];["branch","ring","version"].some(function(a){return!!Object(o.d)(a,e.location)&&(g.push(a+"="+Object(o.a)(a,e.location)),!0)}),Object(U.d)("fwk-sw-proxyFetchAlways")&&(d=Object(F.a)(),C=d.browser,p=d.browserVersion,("Chrome"==C||"Edge Anaheim"==C)&&p&&p.length>0)&&g.push("fa=1"),g.length>0&&(f=f+"?"+g.join("&")),x.register(f,v).then(function(e){l.c.info("[SW Client] service worker registration succeeded")}).catch(function(e){l.c.warn("[SW Client] service worker registraiton failed, error: "+e.message)}),x.ready.then(function(e){!function(e){l.c.info("[SW Client] ready fired, state: "+e.active.state),T=e,x.oncontrollerchange=J,z()}(e)})}function z(){T.active.state==H?K():T.active.onstatechange=G}function G(e){T.active.state==H&&(T.active.onstatechange=null,K())}function J(){null!=T.active&&z()}function K(){var e,a;e={serviceWorkerContainer:x,serviceWorkerRegistration:T,serviceWorkerPath:L,appName:$,userLanguage:B,darkMode:_},a=D,null==V&&((V=e).serviceWorkerContainer.onmessage=R,N(window,V)>y&&(V.cacheHealth=i.TooManyInstallError)),M=a,P()}n.d(a,"registerServiceworker",function(){return q})}},0,[463,87,464,98]]);
//# sourceMappingURL=owa.ServiceWorkerCache.js.map
self.scriptsLoaded['owa.ServiceWorkerCache.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ServiceWorkerCache.js'] = (new Date()).getTime();