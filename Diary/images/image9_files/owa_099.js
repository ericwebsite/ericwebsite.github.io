self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.InlineTranslation.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[253],{10942:function(t){t.exports={h:"s2b",i:"t2b",g:"u2b",f:"v2b",e:"w2b",d:"x2b",c:"y2b",a:"z2b",b:"A2b"}},10943:function(t,n,a){var e=a(10944),r=a(44);"string"==typeof e&&(e=[[t.i,e]]);for(var o=0;o<e.length;o++)r.loadStyles(e[o][1],!1);e.locals&&(t.exports=e.locals)},10944:function(t,n,a){(n=t.exports=a(43)(!1)).push([t.i,"html[dir] ._1eN94FfatbCko5uUefAU47{padding-top:10px}html[dir=ltr] ._1eN94FfatbCko5uUefAU47{margin-left:52px}html[dir=rtl] ._1eN94FfatbCko5uUefAU47{margin-right:52px}",""]),n.locals={translationFeedback:"_1eN94FfatbCko5uUefAU47"}},11556:function(t,n,a){"use strict";a.r(n);var e=a(0);var r=a(226),o=a.n(r);function i(t,n){if(!t)return null;var a=t.ExtendedProperty;if(a)for(var e=a.length,r=0;r<e;r++){var o=a[r];if(o.ExtendedFieldURI.PropertyName===n)return o}return null}var s=a(385),l=a.n(s),u=a(31),c=a(5),d=a(12),T=40,f="EntityExtraction/ExtractLanguage1.0",g="Language",b="Locale",m="BestGuessLanguage",D=o()({PropertyName:f,DistinguishedPropertySetId:"Common",PropertyType:"String"});function w(t){return e.__awaiter(this,void 0,void 0,function(){var n,a,r,o,s,w,h,p;return e.__generator(this,function(e){switch(e.label){case 0:return t.RightsManagementLicenseData?[2,""]:(n=l()({BaseShape:"IdOnly",AdditionalProperties:[D]}),[4,Object(u.r)([t.ItemId.Id],n,null,null,t.MailboxInfo&&t.MailboxInfo.requestOptions)]);case 1:if(a=e.sent(),Object(u.g)(a[0]))if((r=a[0])&&r.Items&&r.Items[0])if(o=r.Items[0],s=i(o,f)){if(w=JSON.parse(s.Value)[0],h=w[g])return p="",!function(t){return t.Preview.length<T}(t)?p=h.hasOwnProperty(m)?h[m]:h[b]:Object(c.d)("tra-EnableShortMessage")&&h.hasOwnProperty(m)&&(p=h[m]),[2,p||""]}else d.c.info("getDetectedLanguageForEmailProperty: No language property found for item.");else d.c.info("getDetectedLanguageForEmailProperty: Unable to parse GetItem response properly.");return[2,""]}})})}var h=a(660),p={name:"InlineTranslationMessageTranslated",cosmosOnlyData:function(t,n){return t}},v={name:"InlineTranslationMessageUntranslated",cosmosOnlyData:function(t){return t}},O={name:"InlineTranslationStoreData",cosmosOnlyData:function(t,n){return t}},I={name:"InlineTranslationStoreStatus",cosmosOnlyData:function(t,n){return t}},j={name:"InlineTranslationLoadDataAndStatus",cosmosOnlyData:function(t){return t.ItemId.Id}},x=a(661),y=a(26),S=a(18),C=Object(y.b)("storeTranslationData",j)(function(t){return e.__awaiter(this,void 0,void 0,function(){var n,a,r,s,u,c,d,T,f,g;return e.__generator(this,function(e){switch(e.label){case 0:n=o()({PropertyName:"TranslationData",DistinguishedPropertySetId:"Common",PropertyType:"String"}),a=o()({PropertyName:"TranslationStatus",DistinguishedPropertySetId:"Common",PropertyType:"String"}),r=l()({BaseShape:"IdOnly",AdditionalProperties:[n,a]}),s=null,u=t.MailboxInfo&&t.MailboxInfo.requestOptions,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Object(x.a)([t.ItemId.Id],r,null,null,u)];case 2:return(s=e.sent())&&Object(h.a)(s[0])?(c=s[0],d=c.Items[0],T=i(d,"TranslationData"),f=i(d,"TranslationStatus"),[2,[T?T.Value:null,f?f.Value:null]]):[3,4];case 3:return g=e.sent(),Object(S.q)().endWithError("ServerError",new Error(g.responseMessage)),[3,4];case 4:return[2,[null,null]]}})})}),L=a(7762),F=a(7760),_=a(4834),E=a(1513),M=a.n(E),P=a(1906),N=a.n(P),k=a(230),U=a.n(k),q=a(2540),A=a.n(q);function R(t,n,a){var e=o()({PropertyName:n,DistinguishedPropertySetId:"Common",PropertyType:"String"}),r=M()({ExtendedFieldURI:e,Value:a}),i=Object(_.a)(r),s=N()({Updates:[i],ItemId:U()({Id:t})});return A()({ItemChanges:[s],ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly"})}var H=a(2538),B=a.n(H),W=a(29),J=Object(y.b)("storeTranslationData",O)(function(t,n){return e.__awaiter(this,void 0,void 0,function(){var a,r;return e.__generator(this,function(e){return a=R(t,"TranslationData",JSON.stringify(n)),r=Object(S.q)(),[2,B()({Header:Object(W.getJsonRequestHeader)(),Body:a}).then(function(t){var n=Object(u.g)(t.Body.ResponseMessages.Items[0]);return n||r.endWithError("ServerError"),n}).catch(function(t){return r.endWithError("ServerError"),!1})]})})}),V=Object(y.b)("storeTranslationData",I)(function(t,n){return e.__awaiter(this,void 0,void 0,function(){var a,r;return e.__generator(this,function(e){return a=R(t,"TranslationStatus",""+n),r=Object(S.q)(),[2,B()({Header:Object(W.getJsonRequestHeader)(),Body:a}).then(function(t){var n=Object(u.g)(t.Body.ResponseMessages.Items[0]);return n||r.endWithError("ServerError"),n}).catch(function(t){return r.endWithError("ServerError"),!1})]})})}),G=a(94),$=a(5410),z=a(2556),Q=Object(y.b)("translateItem",p)(function(t,n,a){return void 0===a&&(a=!1),e.__awaiter(this,void 0,void 0,function(){var r,o,i,s,l,d,T,f,g,b,m,D,w,h,p,v,O,I,j;return e.__generator(this,function(e){switch(e.label){case 0:if(r=7e3,o=Object(S.q)(),i=u.H.items.get(t),s=Object(G.a)(),l=!1,d=u.H.conversations.get(i.ConversationId.Id),i.TranslationData.isTranslating=!0,i.TranslationData.translationFailed=!1,T=!1,f=!1,g=!1,b=[],n&&null==d.subjectTranslationData.translationText&&(b.push(n),T=!0),(null==i.TranslationData.translationText&&i.TranslationData.isTranslatable&&!Object(F.a)(i.TranslationData.itemOgmaLocale)||a)&&(b.push(i.UniqueBody.Value),f=!0),Object(c.d)("rp-inlineTranslationForwardContent")&&(m=function(t){var n=t.ConversationId.Id,a=u.H.conversations.get(n);if(a&&a.conversationNodeIds){var e=t,r=u.H.conversationNodes.get(e.InternetMessageId);if(r&&r.quotedTextList)return r.quotedTextList}return}(i))&&(null===i.TranslationData.forwardContentTranslationText&&i.TranslationData.isForwardContentTranslatable&&!Object(F.a)(i.TranslationData.forwardContentLocale)||a)&&(m.forEach(function(t){b.push(t)}),g=!0),!(T||f||g))return[3,6];D=void 0,e.label=1;case 1:return e.trys.push([1,4,,5]),[4,$.k.import()];case 2:return[4,e.sent()(b,s)];case 3:return D=e.sent(),l=!0,[3,5];case 4:return w=e.sent(),function(t,n,a,e){if(t.TranslationData.isTranslating=!1,t.TranslationData.translationFailed=!0,a){var r=new Error("[InlineTranslation] TranslateText failed. Error:"+n+" | cid:"+e);a.endWithError("ServerError",r)}}(i,w,o,s),[2];case 5:i.TranslationData.shouldGetFeedback=!0,T&&(h=D.shift(),d.subjectTranslationData.translationText=h),f&&(p=D.shift(),i.TranslationData.translationText=p),g&&(i.TranslationData.forwardContentTranslationText=D),e.label=6;case 6:return i.TranslationData.isTranslating=!1,v=!1,null===i.TranslationData.translationText&&null===i.TranslationData.forwardContentTranslationText||null===d.subjectTranslationData.translationText&&n||(!Object(c.d)("tra-cacheTranslation")||i.TranslationData.isShowingTranslation||i.TranslationData.isShowingForwardContentTranslation||(v=!0),null!==i.TranslationData.translationText&&(i.TranslationData.isShowingTranslation=!0),null!==i.TranslationData.forwardContentTranslationText&&(i.TranslationData.isShowingForwardContentTranslation=!0),null!==n&&(d.subjectTranslationData.isShowingTranslation=!0),(i.TranslationData.manuallyTranslated||a&&!function(t){return t.TranslationData.isTranslatable&&!Object(F.a)(t.TranslationData.itemOgmaLocale)||t.TranslationData.isForwardContentTranslatable&&!Object(F.a)(t.TranslationData.forwardContentLocale)}(i))&&(o&&o.addCustomData({manual:!0}),i.TranslationData.manuallyTranslated=!0)),Object(c.d)("rp-inlineTranslation-floodgateSurvey")&&setTimeout(function(){z.a.import().then(function(t){t("TranslationCompleted")})},r),Object(c.d)("tra-cacheTranslation")&&l?[4,$.h.import()]:[3,9];case 7:return O=e.sent(),I=O(),j={language:I,subject:d.subjectTranslationData.translationText,body:i.TranslationData.translationText,forward:i.TranslationData.forwardContentTranslationText,dateTime:Date.now()},[4,J(i.ItemId.Id,j)];case 8:e.sent(),e.label=9;case 9:return v?[4,V(i.ItemId.Id,!0)]:[3,11];case 10:e.sent(),e.label=11;case 11:return[2]}})})});var Y=a(7),K=Object(Y.action)("setItemLocale")(function(t,n){return e.__awaiter(this,void 0,void 0,function(){var a,r,o,i,s,l,d,T,f,g,b,m,D,h,p,v,O,I,j,x,y,S,F,_,E,M;return e.__generator(this,function(e){switch(e.label){case 0:return[4,$.j.import()];case 1:return a=e.sent(),[4,$.d.import()];case 2:return r=e.sent(),[4,$.e.import()];case 3:return o=e.sent(),[4,$.f.import()];case 4:return i=e.sent(),[4,$.g.import()];case 5:return s=e.sent(),[4,$.h.import()];case 6:return l=e.sent(),[4,$.c.import()];case 7:return d=e.sent(),[4,$.a.import()];case 8:return T=e.sent(),f=!t.TranslationData.userLanguage,null!=(g=t.TranslationData.itemLocale)?[3,10]:[4,w(t)];case 9:g=e.sent(),e.label=10;case 10:return b=o(g),[4,a()];case 11:return m=e.sent(),D=!f&&(m||s()!=t.TranslationData.userLanguage),f||D?(h=u.H.conversations.get(t.ConversationId.Id),d()?(t.TranslationData.userLanguage=s(),t.TranslationData.itemOgmaLocale=b,t.TranslationData.itemLocaleName=i(b),Object(c.d)("rp-inlineTranslationForwardContent")?(p=function(t){var n=t.ConversationId.Id,a=u.H.conversations.get(n);if(a&&a.conversationNodeIds){var e=t,r=u.H.conversationNodes.get(e.InternetMessageId);if(r&&r.hasQuotedText&&r.quotedTextList){var o=[];return r.quotedTextList.forEach(function(t){o.push(function(t){try{var n=(new DOMParser).parseFromString(t,"text/html");n.querySelector('[id$="divRplyFwdMsg"]').remove();var a=n.querySelectorAll("style");if(a&&a.length>0)for(var e=0;e<a.length;e++)a[e]&&(a[e].innerHTML="");return n.body.textContent||""}catch(t){return""}}(t))}),o}}return}(t),v=null,p?[4,$.b.import()]:[3,17]):[3,18]):(t.TranslationData.isTranslatable=!1,t.TranslationData.isShowingTranslation=!1,t.TranslationData.translationText=null,t.TranslationData.isForwardContentTranslatable=!1,t.TranslationData.isShowingForwardContentTranslation=!1,t.TranslationData.forwardContentTranslationText=null,h.subjectTranslationData.isShowingTranslation=!1,h.subjectTranslationData.translationText=null,[2])):[3,24];case 12:return O=e.sent(),0===t.Preview.length?[3,14]:[4,O(p)];case 13:return(v=e.sent())?(t.TranslationData.forwardContentLocale=v,t.TranslationData.forwardContentLocaleName=i(v),t.TranslationData.isForwardContentTranslatable=T(r(),v)):(t.TranslationData.isForwardContentTranslatable=!1,t.TranslationData.forwardContentTranslationText=null),[3,17];case 14:return b?[3,16]:[4,O(p)];case 15:v=e.sent(),t.TranslationData.itemOgmaLocale=v,t.TranslationData.itemLocaleName=i(v),e.label=16;case 16:t.TranslationData.forwardContentLocale=t.TranslationData.itemOgmaLocale,t.TranslationData.forwardContentLocaleName=t.TranslationData.itemLocaleName,t.TranslationData.isForwardContentTranslatable=T(r(),t.TranslationData.forwardContentLocale),e.label=17;case 17:return[3,19];case 18:t.TranslationData.isForwardContentTranslatable=!1,e.label=19;case 19:return null==t.TranslationData.itemLocale&&(t.TranslationData.itemLocale=g),I=T(r(),g),j=!0,f?Object(c.d)("tra-cacheTranslation")?[4,C(t)]:[3,21]:[3,23];case 20:return y=e.sent(),[3,22];case 21:y=[null,null],e.label=22;case 22:S="true"===(x=y)[1],null!==x[1]&&(j=!1),F=JSON.parse(x[0]),_=l(),F&&F.language==_?(h.subjectTranslationData.translationText||(h.subjectTranslationData.translationText=F.subject),t.TranslationData.translationText=F.body,F.forward&&F.forward.length>0?t.TranslationData.forwardContentTranslationText=F.forward:t.TranslationData.forwardContentTranslationText=null):(S&&(j=!0,S=!1),t.TranslationData.translationText=null,t.TranslationData.forwardContentTranslationText=null),S&&(t.TranslationData.translationText&&(t.TranslationData.isShowingTranslation=!0),h.subjectTranslationData.translationText&&(h.subjectTranslationData.isShowingTranslation=!0),Object(c.d)("rp-inlineTranslationForwardContent")&&t.TranslationData.forwardContentTranslationText&&(t.TranslationData.isShowingForwardContentTranslation=!0),I||t.TranslationData.isForwardContentTranslatable||(t.TranslationData.manuallyTranslated=!0)),e.label=23;case 23:t.TranslationData.isTranslatable=I,D&&(t.TranslationData.isShowingTranslation=!1,t.TranslationData.translationText=null,t.TranslationData.isShowingForwardContentTranslation=!1,t.TranslationData.forwardContentTranslationText=null,h.subjectTranslationData.isShowingTranslation=!1,h.subjectTranslationData.translationText=null),Object(c.d)("rp-inlineTranslationAutomatic")&&j&&(E=t.TranslationData.isTranslatable&&Object(L.a)(t.TranslationData.itemOgmaLocale),M=!1,Object(c.d)("rp-inlineTranslationForwardContent")&&(M=t.TranslationData.isForwardContentTranslatable&&Object(L.a)(t.TranslationData.forwardContentLocale)),(E||M)&&Q(t.ItemId.Id,n)),e.label=24;case 24:return[2]}})})});var X=Object(y.b)("untranslateItem",v)(function(t){return e.__awaiter(this,void 0,void 0,function(){var n,a;return e.__generator(this,function(e){switch(e.label){case 0:return n=u.H.items.get(t),a=n.ConversationId.Id,u.H.conversations.get(a).subjectTranslationData.isShowingTranslation=!1,n.TranslationData.isShowingTranslation=!1,n.TranslationData.isShowingForwardContentTranslation=!1,Object(c.d)("tra-cacheTranslation")?[4,V(n.ItemId.Id,!1)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}),Z=a(5279),tt=a(1),nt=Object(tt.mutatorAction)("addExcludedLanguage",function(t){var n=Object(Z.a)(),a={feature:n.feature,translationMode:n.translationMode,excludedLanguages:e.__spread(n.excludedLanguages)};n.excludedLanguages.push(t),$.l.import().then(function(t){t(a,n)})}),at=Object(tt.mutatorAction)("setTranslationMode",function(t){var n=Object(Z.a)(),a={feature:n.feature,translationMode:n.translationMode,excludedLanguages:e.__spread(n.excludedLanguages)};n.translationMode=t,$.l.import().then(function(t){t(a,n)})}),et=a(2),rt=a(1372),ot=a(10942),it=a(4),st=a(10943);function lt(){}function ut(){}function ct(t){var n=[{logString:"Readability",uiString:Object(it.a)(ot.c)},{logString:"Formatting",uiString:Object(it.a)(ot.a)},{logString:"Other",uiString:Object(it.a)(ot.b)}],a={title:Object(it.a)(ot.f),subTitle:Object(it.a)(ot.e),ghostText:Object(it.a)(ot.d),categories:n};return et.createElement("div",{className:st.translationFeedback},et.createElement(rt.b,{ribbonMessage:Object(it.a)(ot.h),feature:"inlineTranslation",thankYouMessage:Object(it.a)(ot.i),moreFeedbackRibbonMessage:Object(it.a)(ot.g),noFeedbackDialogParams:a,yesCallBack:lt,noCallBack:ut}))}a.d(n,"setItemLocale",function(){return K}),a.d(n,"translateItem",function(){return Q}),a.d(n,"untranslateItem",function(){return X}),a.d(n,"addExcludedLanguage",function(){return nt}),a.d(n,"setTranslationMode",function(){return at}),a.d(n,"TranslationFeedbackRibbon",function(){return ct})},1372:function(t,n,a){"use strict";a.d(n,"a",function(){return o}),a.d(n,"b",function(){return i}),a.d(n,"c",function(){return s});var e=a(3),r=new e.c(function(){return Promise.all([a.e(3),a.e(5),a.e(62),a.e(196)]).then(a.bind(null,2352))}),o=Object(e.d)(r,function(t){return t.FeedbackForm}),i=Object(e.d)(r,function(t){return t.FeedbackRibbon}),s=Object(e.d)(r,function(t){return t.NewConsumerRecruitmentForm})},1513:function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=a(0);n.default=function(t){return e.__assign({__type:"ExtendedPropertyType:#Exchange"},t)}},2556:function(t,n,a){"use strict";a.d(n,"a",function(){return o});var e=a(3),r=(a(48),new e.c(function(){return a.e(207).then(a.bind(null,3500))})),o=new e.b(r,function(t){return t.logFloodgateActivity})},4834:function(t,n,a){"use strict";a.d(n,"a",function(){return d});var e=a(1513),r=a.n(e),o=a(226),i=a.n(o),s=a(2532),l=a.n(s),u=a(1913),c=a.n(u);function d(t){return c()({Path:i()(t.ExtendedFieldURI),Item:l()({ExtendedProperty:[r()(t)]})})}},5410:function(t,n,a){"use strict";a.d(n,"a",function(){return o}),a.d(n,"j",function(){return i}),a.d(n,"i",function(){return s}),a.d(n,"d",function(){return l}),a.d(n,"e",function(){return u}),a.d(n,"b",function(){return c}),a.d(n,"f",function(){return d}),a.d(n,"g",function(){return T}),a.d(n,"h",function(){return f}),a.d(n,"c",function(){return g}),a.d(n,"k",function(){return b}),a.d(n,"l",function(){return m});var e=a(3),r=new e.c(function(){return a.e(396).then(a.bind(null,8128))}),o=new e.b(r,function(t){return t.checkCanTranslate}),i=new e.b(r,function(t){return t.initSupportedLanguages}),s=new e.b(r,function(t){return t.initAndGetSupportedLanguageMap}),l=new e.b(r,function(t){return t.getLocaleOfSupportedLanguageMap}),u=new e.b(r,function(t){return t.getOgmaSupportedLanguageTag}),c=new e.b(r,function(t){return t.getDetectedLanguage}),d=new e.b(r,function(t){return t.getSupportedLanguageMap}),T=new e.b(r,function(t){return t.getUserLanguageName}),f=new e.b(r,function(t){return t.getUserLanguageTag}),g=new e.b(r,function(t){return t.getIsUserLocaleSupported}),b=new e.b(r,function(t){return t.translateText}),m=new e.b(r,function(t){return t.updateTranslationOptions})}},0,[0,1,30,474,155,4,7,11,513,354,3,5,62,196,463,87,464,98,207,396]]);
//# sourceMappingURL=owa.InlineTranslation.js.map
self.scriptsLoaded['owa.InlineTranslation.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.InlineTranslation.js'] = (new Date()).getTime();