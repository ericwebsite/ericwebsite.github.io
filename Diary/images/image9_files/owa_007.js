self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Addins.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[91,13,17,24,28,65,66,474,477,478,483,486,494,495,500,506,512,526],{1000:function(e){e.exports={a:"hmb"}},1001:function(e){e.exports={a:"raa"}},1004:function(e,t,n){"use strict";var r=n(637),o=n(940),i=n(14),a={root:"ms-TooltipHost"};n.d(t,"a",function(){return s});var s=Object(r.a)(o.a,function(e){var t=e.className,n=e.theme;return{root:[Object(i.getGlobalClassNames)(a,n).root,{display:"inline"},t]}},void 0,{scope:"TooltipHost"})},1007:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(276);function o(e,t,n){var o=Object(r.e)(t,e);Object(r.c)("mail",o,n,{resizable:!0})}},1012:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r,o=n(317);n.d(t,"b",function(){return o.ResponsiveMode}),function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"}(r||(r={}))},1015:function(e,t,n){"use strict";n.d(t,"m",function(){return i}),n.d(t,"l",function(){return a}),n.d(t,"o",function(){return s}),n.d(t,"q",function(){return c}),n.d(t,"p",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"e",function(){return d}),n.d(t,"g",function(){return f}),n.d(t,"h",function(){return p}),n.d(t,"k",function(){return m}),n.d(t,"n",function(){return g}),n.d(t,"r",function(){return v}),n.d(t,"c",function(){return h}),n.d(t,"d",function(){return y}),n.d(t,"j",function(){return b}),n.d(t,"f",function(){return _}),n.d(t,"i",function(){return S}),n.d(t,"a",function(){return C});var r=n(3),o=(n(1319),new r.c(function(){return Promise.all([n.e(532),n.e(12),n.e(37),n.e(57),n.e(457)]).then(n.bind(null,2337))})),i=new r.a(o,function(e){return e.onSmimeItemAttachmentOpened}),a=new r.a(o,function(e){return e.mergeSmimeDecodedMessageProperties}),s=(new r.b(o,function(e){return e.fetchAndDecodeSmimeMessage}),new r.b(o,function(e){return e.setSmimePropertiesInDraftMessage})),c=new r.b(o,function(e){return e.trySetSmimeProperties}),u=new r.b(o,function(e){return e.tryAddSmimeProperties}),l=new r.b(o,function(e){return e.createMailResponseBodyContent}),d=new r.b(o,function(e){return e.downloadSmimeAttachment}),f=new r.b(o,function(e){return e.getMergedSmimeViewState}),p=new r.b(o,function(e){return e.getMergedSmimeViewStateForDraft}),m=new r.b(o,function(e){return e.isSmimeItemDecoding}),g=new r.b(o,function(e){return e.previewSmimeAttachment}),v=new r.b(o,function(e){return e.updateSmimeAttachmentIds}),h=new r.b(o,function(e){return e.createSmimeAttachmentsFromFiles}),y=new r.b(o,function(e){return e.createSmimeAttachmentsViaSmimeQueueManager}),b=new r.b(o,function(e){return e.initializeAttachmentStateForSmimeAttachments}),_=new r.b(o,function(e){return e.getAttachmentsForSmimeResponse}),S=new r.b(o,function(e){return e.getSmimeAttachmentsForRequest}),C=Object(r.d)(o,function(e){return e.SignatureDetails})},1017:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(266),o=n(5),i=n(27);function a(){var e=!0;if(Object(i.n)()){var t=Object(r.c)(r.a.ExternalImages);e=!Object(o.d)("rp-externalImagesProxyOption")||null===t.externalImagesSelectedOption||0===t.externalImagesSelectedOption}else{var n=Object(i.f)().PolicySettings;e=void 0===n.ExternalImageProxyEnabled||n.ExternalImageProxyEnabled}return e}},1019:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetConversationItemsJsonRequest:#Exchange"},e)}},1020:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"e",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s});var r="X-OWA-SmimeInstalled",o="1",i="SmimeWithoutActiveX",a="message/rfc822",s="ErrorSmimeSendCancelled"},1025:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n(0),o=n(566),i=n(1365),a=n.n(i),s=n(272),c=n.n(s),u=n(1366),l=n.n(u),d=n(29);function f(e,t,n,i,s,u,f,p,m,g,v,h,y){if(p&&"UserCategory"!=n)throw new Error("CategoryName should be set only for UserCategory view filter");var b=r.__assign({},f);b.returnFullResponseOnSuccess=!0;var _=function(e,t,n,r,i,s,u,l,d,f,p,m){var g=e,v={ParentFolderId:c()({BaseFolderId:e}),ConversationShape:o.b(g.Id),ShapeName:l,Paging:t,ViewFilter:n,SortOrder:r,FocusedViewFilter:i,CategoryFilter:s,Traversal:u};return p&&(v.SearchFolderId=p),d&&d.length>0&&(v.HashtagsToInclude=d),f&&f.length>0&&(v.HashtagsToExclude=f),m&&(v.Restriction=m),a()(v)}(e,t,n,i,s,p,m,u,g,v,h,y);return l()({Header:Object(d.getJsonRequestHeader)(),Body:_},b)}},1026:function(e,t,n){"use strict";function r(e){switch(e){case"Hashtag":case"UserCategory":return"Deep";default:return}}n.d(t,"a",function(){return r})},1027:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o});var r={};function o(e,t){return r[e]&&r[e][t]}},1028:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(886),o=n(1174),i=n.n(o),a=n(1175),s=n.n(a),c=n(29);function u(e,t,n,o,a,u,l,d,f,p,m,g){if(d&&"UserCategory"!=n)throw new Error("CategoryName should be set only for UserCategory view filter");var v=function(e,t,n,o,a,s,c,u,l,d,f){var p=e,m={ParentFolderIds:[e],ItemShape:r.a(p.Id),ShapeName:s,Traversal:u,Paging:t,FocusedViewFilter:a,ViewFilter:n,SortOrder:o,CategoryFilter:c};return f&&(m.SearchFolderId=f),l&&l.length>0&&(m.HashtagsToInclude=l),d&&d.length>0&&(m.HashtagsToExclude=d),i()(m)}(e,t,n,o,a,u,d,f,p,m,g);return s()({Header:Object(c.getJsonRequestHeader)(),Body:v},l).then(function(e){return e.Body.ResponseMessages.Items[0]})}},1029:function(e,t,n){"use strict";function r(e){switch(e){case"Hashtag":case"UserCategory":return"SoftDeleted";default:return"Shallow"}}n.d(t,"a",function(){return r})},1033:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConversationResponseShape:#Exchange"},e)}},107:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(132);function o(){return Object(r.a)().folderTable}},1071:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(0),o=n(2),i=n(338),a=n(131),s=n(801),c=n(1072),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._skipComponentRefResolution=!0,t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return o.createElement(i.a,r.__assign({},this.props,{variantClassName:"ms-Button--action ms-Button--command",styles:Object(c.a)(n,t),onRenderDescription:a.b}))},t=r.__decorate([Object(s.a)("ActionButton",["theme","styles"],!0)],t)}(a.a)},1072:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(14),o=n(333),i=n(339),a=Object(o.b)(function(e,t){var n,o=Object(i.a)(e),a={root:{padding:"0 4px",height:"40px",color:e.palette.neutralPrimary,backgroundColor:"transparent",border:"1px solid transparent"},rootHovered:{color:e.palette.themePrimary,selectors:(n={},n[r.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},n)},iconHovered:{color:e.palette.themePrimary},rootPressed:{color:e.palette.black},rootExpanded:{color:e.palette.themePrimary},iconPressed:{color:e.palette.themeDarker},rootDisabled:{color:e.palette.neutralTertiary,backgroundColor:"transparent"},rootChecked:{color:e.palette.black},iconChecked:{color:e.palette.themeDarker},flexContainer:{justifyContent:"flex-start"},icon:{color:e.palette.themeDarkAlt},iconDisabled:{color:"inherit"},menuIcon:{color:e.palette.neutralSecondary},textContainer:{flexGrow:0}};return Object(r.concatStyleSets)(o,a,t)})},1073:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.ok=0]="ok",e[e.cancel=1]="cancel",e[e.dismiss=2]="dismiss",e[e.continue=3]="continue"}(r||(r={}))},1075:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(688);function o(e){return Object(r.a)().options[e]}},1079:function(e,t,n){"use strict";var r=n(51),o=n(209),i=n(453),a=n(184),s=n(2),c=n(211),u=n(1506),l=n(126).bind(u),d=Object(r.a)(function(e){var t={color:(e.categoryName?Object(i.a)(e.categoryName,e.categoryList?e.categoryList:Object(c.l)()):e.categoryColorId?a.a.colorCodeColorValueMap[e.categoryColorId]:Object(i.b)()).iconColor},n=l(u.categoryIcon,e.iconClassName);return s.createElement(o.a,{className:n,iconName:"TagSolid",style:t})});t.a=d},1081:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(1),o=Object(r.action)("REFRESH_SHARING_TIPS_ATTACHMENT_WELL",function(e,t,n,r,o,i){return{attachmentWellViewState:e,parentItemId:t,recipientInfo:n,infoBarIds:r,infoBarAddHandler:o,infoBarRemoveHandler:i}}),i=Object(r.action)("REMOVE_LINKS_THEN_REFRESH_SHARING_TIPS",function(e){return{linkIds:e}})},1082:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(0),o=n(156),i=n(885),a=n.n(i),s=n(1111),c=n.n(s);function u(e,t,n,i){return r.__awaiter(this,void 0,void 0,function(){var s,u,l;return r.__generator(this,function(r){switch(r.label){case 0:return s=a()({AddCategoryList:e,RemoveCategoryList:t,ChangeCategoryColorList:n}),u=c.a,l=[{request:s}],[4,Object(o.b)(i)];case 1:return[2,u.apply(void 0,l.concat([r.sent()]))]}})})}},1083:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(0);function o(e,t){var n,o,i=[],a=!1,s=e.trim().toLocaleLowerCase();try{for(var c=r.__values(t),u=c.next();!u.done;u=c.next()){var l=u.value,d=l.Name.trim().toLocaleLowerCase();""!=d&&d.indexOf(s)>=0&&(i.push(l),d==s&&(a=!0))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}var f=e.toLocaleLowerCase().trim();return i.sort(function(e,t){var n=e.Name.toLocaleLowerCase().trim(),r=t.Name.toLocaleLowerCase().trim(),o=n.indexOf(f),i=r.indexOf(f);return o==i?n.localeCompare(r):o-i}),{suggestions:i,hasExactMatch:a}}},10842:function(e){e.exports={b:"MGa",a:"NGa"}},1087:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(72);function o(e){return r.a.conversationItems.get(e)}},1088:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("ON_ATTACHMENT_CREATED",function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}})},1089:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("ON_ATTACHMENT_DELETED",function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}})},1090:function(e,t,n){"use strict";function r(e){return!e.ItemClass||-1!==e.ItemClass.indexOf("IPM.Note")||-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.GroupMailbox.JoinRequest")||-1!==e.ItemClass.indexOf("IPM.Post")}n.d(t,"a",function(){return r})},1094:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SetFolderField:#Exchange"},e)}},1096:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateFolderRequest:#Exchange"},e)}},1097:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(1494);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("UpdateFolder",e,t)}},1098:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.OptionsNotLoaded=0]="OptionsNotLoaded",e[e.OptionsLoading=1]="OptionsLoading",e[e.OptionsLoaded=2]="OptionsLoaded"}(r||(r={}))},1099:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1),o=n(680),i=Object(r.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",function(e){return void 0===e&&(e=Object(o.a)()),{defaultOptions:e}})},110:function(e,t,n){"use strict";n.d(t,"b",function(){return a});var r=n(8),o=n(1),i={favoritesFolderNodes:new r.ObservableMap,favoritesPersonaNodes:new r.ObservableMap,favoriteSearches:new r.ObservableMap,favoriteCategories:new r.ObservableMap,orderedFavoritesNodeIds:[],orderedOutlookFavoritesIds:[],outlookFavorites:new r.ObservableMap,favoriteSecondaryKeyMap:new r.ObservableMap,favoritingInProgressMap:new r.ObservableMap,favoritesLoaded:!1},a=Object(o.createStore)("favorites",i);t.a=a()},1100:function(e,t,n){"use strict";t.a={TabViewAddTab:{name:"TabViewAddTab",customData:function(e,t,n,r){return[e,t,n]}},TabViewCloseTab:{name:"TabViewCloseTab",customData:function(e,t){return[e.type,e.isShown,e.isActive,t,e.startTime?(new Date).getTime()-e.startTime:0]}},TabViewActivateTab:{name:"TabViewActivateTab",customData:function(e,t){return[e.type,t]},options:{isVerbose:!0}}}},1101:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1),o=n(8),i=Object(r.createStore)("optionsViewState",{isFullOptionsShown:!1,isSaving:!1,currentCategoryKey:null,currentSubCategoryKey:null,subCategoryLoadState:new o.ObservableMap,currentOptionKey:null,allowedOptions:[]})},1102:function(e,t,n){"use strict";var r=n(184),o=n(7);t.a=Object(o.action)("NewCategoryViewState")(function(){r.a.categoryMenuViewState.newCategoryViewState=null,r.a.categoryColorPickerViewState={shouldShowColorPicker:!1,colorPickerTarget:null}})},1103:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59);t.default=function(e,t){return r.makeServiceRequest("GetOtherMailboxConfiguration",e,t)}},1104:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59);t.default=function(e,t){return r.makeServiceRequest("AddSharedFolders",e,t)}},1107:function(e,t,n){"use strict";var r=n(7),o=n(184);t.a=Object(r.action)("setCategoryMenuFindText")(function(e){o.a.categoryMenuViewState.findText=e})},1108:function(e,t,n){"use strict";var r=n(7),o=n(184);t.a=Object(r.action)("setShouldShowAllCategories")(function(e){o.a.categoryMenuViewState.shouldShowAllCategories=e})},1111:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(885);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=o.default(e.request)),r.makeServiceRequest("UpdateMasterCategoryList",e,t)}},1116:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(604),o=n.n(r),i=n(605),a=n.n(i),s=n(648),c=n.n(s),u=n(57),l=n.n(u),d=n(29),f=n(346);function p(e){var t=e,n=function(e){return a()({FolderShape:c()({BaseShape:"IdOnly",AdditionalProperties:[l()({FieldURI:"DistinguishedFolderId"}),l()({FieldURI:"FolderClass"}),l()({FieldURI:"FolderDisplayName"}),l()({FieldURI:"ParentFolderId"}),l()({FieldURI:"TotalCount"}),l()({FieldURI:"UnreadCount"})]}),Paging:null,ParentFolderIds:[e],ReturnParentFolder:!0,ShapeName:"Folder",Traversal:"Deep"})}(t);return o()({Header:Object(d.getJsonRequestHeader)(),Body:n},Object(f.a)(t.Id)).then(function(e){return e.Body.ResponseMessages.Items[0]})}},1117:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(242),o=n(9);function i(){var e=Object(r.getDefaultAnchorMailboxCookie)();return e||Object(o.a)().SessionSettings.UserEmailAddress}},1125:function(e,t,n){"use strict";var r=n(0),o=n(7),i=n(388),a=0;t.a=Object(o.action)("addNotification")(function(e){var t=r.__assign({id:a++},e);i.a.notificationViewStates.push(t)})},1126:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var r=n(570),o=n(694),i={};function a(e,t){var n=r.a[e];i[n]||(i[n]=t)}function s(e){var t=i[r.a[e.actionType]];t&&t(e),Object(o.a)(e)}},1129:function(e){e.exports={a:"Dqb"}},1130:function(e,t,n){"use strict";var r=n(306),o=n(7);t.a=Object(o.select)({loadedConversationState:function(){return r.a.conversationReadingPaneViewState}})(Object(o.action)("expandItemPartOnIsReadChanged")(function(e,t,n){var r=n.loadedConversationState?n.loadedConversationState.conversationId:null;r&&r.Id==e&&t.forEach(function(e){var t=n.loadedConversationState.itemPartsMap.get(e);t&&t.isLocal&&(t.isExpanded=!0)})}))},1132:function(e,t,n){"use strict";function r(e){return e&&e.recipients?e.recipients.length:0}n.d(t,"a",function(){return r})},1134:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1),o=Object(r.createStore)("allowedOptions",{allowedOptions:[]})},1136:function(e,t,n){"use strict";var r=n(3),o=n(5),i=n(1134);function a(e){return!Object(o.d)("fwk-getAllowedOptions")||e.every(function(e){return Object(i.a)().allowedOptions.includes(e)})}n.d(t,"b",function(){return c}),n.d(t,"a",function(){return a});var s=new r.c(function(){return n.e(97).then(n.bind(null,11863))}),c=new r.a(s,function(e){return e.loadAllowedOptions})},114:function(e,t,n){"use strict";var r={alert:"alert",alertdialog:"alertdialog",application:"application",article:"article",banner:"banner",button:"button",cell:"cell",checkbox:"checkbox",columnheader:"columnheader",combobox:"combobox",complementary:"complementary",contentinfo:"contentinfo",definition:"definition",dialog:"dialog",directory:"directory",document:"document",feed:"feed",figure:"figure",form:"form",grid:"grid",gridcell:"gridcell",group:"group",heading:"heading",img:"img",link:"link",list:"list",listbox:"listbox",listitem:"listitem",log:"log",main:"main",marquee:"marquee",math:"math",menu:"menu",menubar:"menubar",menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio",navigation:"navigation",note:"note",option:"option",presentation:"presentation",progressbar:"progressbar",radio:"radio",radiogroup:"radiogroup",region:"region",row:"row",rowgroup:"rowgroup",rowheader:"rowheader",scrollbar:"scrollbar",search:"search",searchbox:"searchbox",separator:"separator",slider:"slider",spinbutton:"spinbutton",status:"status",switch:"switch",tab:"tab",table:"table",tablist:"tablist",tabpanel:"tabpanel",term:"term",textbox:"textbox",timer:"timer",toolbar:"toolbar",tooltip:"tooltip",tree:"tree",treegrid:"treegrid",treeitem:"treeitem"},o=0;function i(e){return void 0===e&&(e="id"),""+e+o++}function a(e){return Array.isArray(e)?e.join(" "):e}function s(e){if(!e)return null;for(var t={},n=Object.keys(e),r=0;r<n.length;r++){switch(n[r]){case"role":t.role=e.role;break;case"id":t.id=e.id;break;case"activeDescendant":t["aria-activedescendant"]=e.activeDescendant;break;case"atomic":t["aria-atomic"]=e.atomic;break;case"autocomplete":t["aria-autocomplete"]=e.autocomplete;break;case"busy":t["aria-busy"]=e.busy;break;case"checked":t["aria-checked"]=e.checked;break;case"controls":t["aria-controls"]=a(e.controls);break;case"describedBy":t["aria-describedby"]=a(e.describedBy);break;case"disabled":t["aria-disabled"]=e.disabled;break;case"dropEffect":t["aria-dropeffect"]=a(e.dropEffect);break;case"expanded":t["aria-expanded"]=e.expanded;break;case"flowTo":t["aria-flowto"]=a(e.flowTo);break;case"grabbed":t["aria-grabbed"]=e.grabbed;break;case"hasPopup":t["aria-haspopup"]=e.hasPopup;break;case"hidden":t["aria-hidden"]=e.hidden;break;case"invalid":t["aria-invalid"]=e.invalid;break;case"label":t["aria-label"]=e.label;break;case"labelledBy":t["aria-labelledby"]=a(e.labelledBy);break;case"level":t["aria-level"]=e.level;break;case"live":t["aria-live"]=e.live;break;case"multiline":t["aria-multiline"]=e.multiline;break;case"multiselectable":t["aria-multiselectable"]=e.multiselectable;break;case"orientation":t["aria-orientation"]=e.orientation;break;case"owns":t["aria-owns"]=a(e.owns);break;case"positionInSet":t["aria-posinset"]=e.positionInSet;break;case"pressed":t["aria-pressed"]=e.pressed;break;case"readonly":t["aria-readonly"]=e.readonly;break;case"relevant":t["aria-relevant"]=a(e.relevant);break;case"required":t["aria-required"]=e.required;break;case"selected":t["aria-selected"]=e.selected;break;case"setSize":t["aria-setsize"]=e.setSize;break;case"sort":t["aria-sort"]=e.sort;break;case"valueMax":t["aria-valuemax"]=e.valueMax;break;case"valueMin":t["aria-valuemin"]=e.valueMin;break;case"valueNow":t["aria-valuenow"]=e.valueNow;break;case"valueText":t["aria-valuetext"]=e.valueText}}return t}n.d(t,"a",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return s})},1140:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(1),o=Object(r.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),i=Object(r.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},1160:function(e,t,n){"use strict";var r=n(384),o=n(340),i="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(o.a)(e)&&Object(r.a)(e)==i}},1162:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(500),o=n(501),i=n(502),a=n(226);t.getJsonRequestHeader=function(e){return r.default({RequestServerVersion:"Exchange2015",TimeZoneContext:o.default({TimeZoneDefinition:i.default({Id:null!=e?e:"Pacific Standard Time"})})})},t.getExtendedPropertyUri=function(e,t,n){return a.default({PropertySetId:e,PropertyName:t,PropertyType:n})}},1166:function(e,t,n){"use strict";var r=n(0),o=n(2),i=n(338),a=n(131),s=n(801),c=n(14),u=n(333),l=n(339),d=n(435),f=Object(u.b)(function(e,t){var n,r=Object(l.a)(e),o=Object(d.a)(e),i=e.palette,a=e.semanticColors,s={root:{padding:"0 4px",width:"32px",height:"32px",backgroundColor:"transparent",border:"none",color:a.actionLink},rootHovered:{color:a.actionLinkHovered,selectors:(n={},n[c.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},n)},rootPressed:{color:i.themePrimary},rootExpanded:{color:i.themePrimary},rootChecked:{backgroundColor:a.buttonBackgroundChecked},rootCheckedHovered:{backgroundColor:a.buttonBackgroundHovered},rootDisabled:{color:a.disabledText}};return Object(c.concatStyleSets)(r,s,o,t)});n.d(t,"a",function(){return p});var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._skipComponentRefResolution=!0,t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return o.createElement(i.a,r.__assign({},this.props,{variantClassName:"ms-Button--icon",styles:f(n,t),onRenderText:a.b,onRenderDescription:a.b}))},t=r.__decorate([Object(s.a)("IconButton",["theme","styles"],!0)],t)}(a.a)},1167:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("ADD_PUBLIC_FOLDER_TO_STORE",function(e,t){return{state:e,item:t}})},11672:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1586),i=n(562),a=n(787),s=n(6899),c=n(6900),u=n(3671),l=n(4234),d=n(3731),f=n(494);var p=n(238),m=n(1998);function g(e,t){var n=S(e.docViewAttachments,t);if(n||(n=S(e.imageViewAttachments,t)),n||(n=S(e.inlineAttachments,t)),!n)throw new i.a(i.b.GenericResponseError);return m.b.importAndExecute(n,t)}var v=function(e){return function(t,n,r){return Object(c.a)(e,t,n,r).catch(h)}};function h(e){throw e.messageId?function(e){switch(e){case"ErrorTooLargeForLocalAttachmentSingle":case"ErrorTooLargeForLocalAttachmentMultiple":return i.b.AttachmentSizeExceeded;default:return i.b.AttachmentUploadGeneralFailure}}(e.messageId):i.b.AttachmentUploadGeneralFailure}var y=function(e){return function(t,n,r){return Object(s.a)(e,t,n,r).catch(h)}},b=function(e){return function(){return m.a.importAndExecute(e.attachmentWell)}},_=function(e){return function(t,n,r){return function(e,t,n,r){return new Promise(function(a,s){var c=!1,p=Object(d.a)(e);try{for(var m=atob(t),g=m.length,v=new Uint8Array(new ArrayBuffer(g)),h=0;h<g;h++)v[h]=m.charCodeAt(h);var y=Object(f.c)(n)?new Blob([v],{type:"image/png"}):new Blob([v]);y.name=n;var b=Object(o.e)([y]),_=Object(u.b)(e).inlineImagePlugin,S="HTML"!=e.bodyType?null:_.processInlineImageBeforeUpload.bind(_);Object(l.a)(b,e,{isInline:r,isHiddenInline:!0,shouldShare:!1},S,function(e,t){p(e,t),c||(c=!0,s({errorType:"UploadError",id:e}))},Object(d.c)(e),function(e){c||(c=!0,a(e.Id))})}catch(e){s({errorType:i.b.AttachmentUploadGeneralFailure})}})}(e,t,n,r).catch(h)}};function S(e,t){var n=e.filter(function(e){return e.attachmentId.Id===t});return n.length>0?n[0]:null}var C=function(e){return function(t){return new Promise(function(n,o){a.h.import().then(function(a){try{var s=S(e.attachmentWell.docViewAttachments,t);if(s||(s=S(e.attachmentWell.imageViewAttachments,t)),s||(s=S(e.attachmentWell.inlineAttachments,t)),!s)return void o(new i.a(i.b.AttachmentToDeleteDoesNotExist));var c=r.__assign({},e.itemId,{mailboxInfo:Object(p.a)()});a(e.attachmentWell,s,c,Object(d.a)(e),Object(d.c)(e)),n()}catch(e){o(new i.a(i.b.AttachmentDeleteGeneralFailure))}})})}},O=function(e){return function(t){return g(e.attachmentWell,t)}},I=function(e){return!(!e||0==e.length)&&e.some(function(e){return e.file.fileType==o.a.Uri&&e.isInline})},A=n(10842),T=n(5577),E=n(4),x=n(271),P=n(197),M=function(e){return function(){Object(x.b)(Object(E.a)(A.b),Object(E.a)(A.a),!Object(P.h)(e),{okText:Object(E.a)(T.a),hideCancelButton:!1}).then(function(t){t==x.a.ok&&P.i.importAndExecute(e)})}},w=function(e){return function(){return e.conversationId}},R=n(4170),k=function(e){return function(){return e.fromViewState&&e.fromViewState.from?e.fromViewState.from.email:Object(R.a)()}},D=n(6892),j=n(4989),N=n(4637),F=n(1593),L=n(3588),U=n(7),B=Object(U.action)("clearRecipientWell")(function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){return e.recipients=[],e.isDirty=!0,[2]})})}),H=n(3561),V=function(e){return function(t){var n=q(e,t);return Object(F.a)(n)}},W=function(e){return function(t,n){z(e,t);var r=q(e,t);B(r);var o=n.map(function(e){return{isValid:!0,newPersona:{EmailAddress:e}}});Object(L.a)(r,o),Object(H.a)(r,!1)}},G=function(e){return function(t,n){z(e,t);var r=q(e,t),o=n.map(function(e){return{isValid:!0,newPersona:{EmailAddress:e}}});Object(L.a)(r,o),Object(H.a)(r,!1)}};function z(e,t){switch(e.showCompactRecipientWell&&Object(N.a)(e),t){case i.g.To:return;case i.g.Cc:return void Object(j.a)(e);case i.g.Bcc:return void Object(D.a)(e)}}var q=function(e,t){var n;switch(t){case i.g.To:n=e.toRecipientWell;break;case i.g.Cc:n=e.ccRecipientWell;break;case i.g.Bcc:n=e.bccRecipientWell}return n},K=n(3703),X=n(3910),J=function(e){return function(){var t=Object(u.b)(e);return Object(X.a)(e,t.addinPlugin.getContent()),Object(K.b)(e,!1,!0).then(function(){return Promise.resolve(e.itemId.Id)}).catch(function(){return Promise.resolve(null)})}},Q=n(1),Y=Object(Q.mutatorAction)("appendOnSend",function(e,t){var n=e.appendOnSend;if(n){for(var r=!1,o=0;o<n.length;o++)if(n[o].id===t.id){e.appendOnSend[o]=t,r=!0;break}r||e.appendOnSend.push(t)}}),Z=function(e){return function(){var t=Object(u.b)(e);return Object(X.a)(e,t.addinPlugin.getContent()),e.content}},$=function(e){return function(t,n){(Object(X.a)(e,t),"HTML"==e.bodyType)&&Object(u.b)(e).addinPlugin.updateContent(t,n)}},ee=function(e){return function(){return e.bodyType}},te=function(e){return function(t){var n=Object(u.b)(e).addinPlugin;n.prependContent(t),Object(X.a)(e,n.getContent())}},ne=function(e){return function(t){var n=Object(u.b)(e).addinPlugin;n.setSelectedData(t),Object(X.a)(e,n.getContent())}},re=function(e){return function(t){Y(e,t)}};var oe=n(6893),ie=n(6894),ae=function(e){return function(){return e.subject}},se=function(e){return function(t){Object(oe.a)(e,t)}};function ce(e){return 5===e.lastFocusedControl}var ue=function(e){return function(){return 7===e.lastFocusedControl?function(e){return function(){return function(e){return 7===e.lastFocusedControl}(e)?Object(u.b)(e).addinPlugin.getSelectedData():null}}(e)():5===e.lastFocusedControl?function(e){return function(){if(!ce(e))return null;var t=e.subjectViewState,n=t.selectionStart,r=t.selectionEnd,o=e.subject;return{data:o=o.slice(n,r),sourceProperty:"subject",startPosition:n,endPosition:r}}}(e)():null}},le=function(e){return function(t){7===e.lastFocusedControl?ne(e)(t):5===e.lastFocusedControl&&function(e){return function(t){if(ce(e)){var n=e.subject,r=e.subjectViewState,o=r.selectionStart,i=r.selectionEnd;n=n.slice(0,o)+t+n.slice(i),Object(oe.a)(e,n);var a=o+t.length;Object(ie.a)(e,a,a)}}}(e)(t)}},de=n(215),fe=n(211),pe=n(13),me=n(73),ge=n(4242);function ve(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,fe.t.import()];case 1:return e=t.sent(),[2,e()]}})})}function he(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,fe.r.import()];case 1:return[2,t.sent()(e,"Addin")]}})})}function ye(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,fe.u.import()];case 1:return[2,t.sent()(e,"Addin")]}})})}var be=function(e){return function(){return function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,o,i,a,s,c,u,l,d,f;return r.__generator(this,function(p){switch(p.label){case 0:return t=Object(me.c)().items.get(e.itemId),n=t.Categories,[4,fe.t.import()];case 1:if(o=p.sent(),i=o(),null==n)return[2,[]];a=[],s=function(e){var t=i.filter(function(t){return t.Name===e}),n={Name:e,Color:t.length>0?t[0].Color:ge.a.None};a.push(n)};try{for(c=r.__values(n),u=c.next();!u.done;u=c.next())l=u.value,s(l)}catch(e){d={error:e}}finally{try{u&&!u.done&&(f=c.return)&&f.call(c)}finally{if(d)throw d.error}}return[2,a]}})})}(e)}};function _e(e){var t=Object(pe.C)(),n=r.__spread(t.selectedRowKeys.keys());return de.b.importAndExecute(n,t,e,"Addin"),Promise.resolve()}function Se(e){var t=Object(pe.C)(),n=r.__spread(t.selectedRowKeys.keys());return de.B.importAndExecute(n,t,e,"Addin"),Promise.resolve()}var Ce=n(5532);function Oe(e){Object(Ce.a)(e,"Mail_Addins",null,2)}function Ie(e){return me.a.items.get(e)}var Ae=n(246),Te=n(1007);function Ee(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return(t=Ie(e))&&t.NormalizedBody?[3,2]:(n={Id:e,mailboxInfo:Object(p.b)(Object(pe.C)())},[4,Object(Ae.j)(n,"LoadItemReadingPane")]);case 1:t=r.sent(),r.label=2;case 2:return t.IsDraft?[4,xe(e)]:[3,4];case 3:return r.sent(),[3,5];case 4:Object(Te.a)(e),r.label=5;case 5:return[2]}})})}function xe(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,P.r.importAndExecute(e,P.a.Popout)];case 1:return t.sent(),[2]}})})}var Pe=n(661),Me=n(660),we=n(1162),Re=n(385),ke=n.n(Re),De=n(4828),je=Object(Q.mutatorAction)("setInternetHeaders",function(e,t){e.internetHeaders=e.internetHeaders.merge(t),Object(De.a)(e)}),Ne="00020386-0000-0000-C000-000000000046";function Fe(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,o;return r.__generator(this,function(r){switch(r.label){case 0:return o=[],t.forEach(function(t){e.internetHeaders.get(t)||e.keysOfInternetHeadersToBeRemoved&&-1!=e.keysOfInternetHeadersToBeRemoved.indexOf(t)||o.push(t)}),o.length>0?[4,Le(o,e.itemId.Id)]:[3,2];case 1:n=r.sent(),je(e,n),r.label=2;case 2:return[2]}})})}function Le(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,o,i,a,s;return r.__generator(this,function(r){switch(r.label){case 0:n=ke()({BaseShape:"IdOnly",AdditionalProperties:Ue(e)}),o={},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(Pe.a)([t],n,null)];case 2:return i=r.sent(),Object(Me.a)(i[0])&&(a=i[0],(s=a.Items[0]).ExtendedProperty&&(c=s.ExtendedProperty,o=c.reduce(function(e,t){return e[t.ExtendedFieldURI.PropertyName]=t.Value,e},{}))),[3,4];case 3:throw r.sent();case 4:return[2,o]}var c})})}function Ue(e){var t=[];return e.forEach(function(e){t.push(Object(we.getExtendedPropertyUri)(Ne,e,"String"))}),t}var Be=function(e){return function(t){return r.__awaiter(void 0,void 0,void 0,function(){return r.__generator(this,function(n){switch(n.label){case 0:return 4!==e.operation?[3,2]:[4,Fe(e,t)];case 1:n.sent(),n.label=2;case 2:return[2,r.__spread(e.internetHeaders.keys()).filter(function(e){return t.includes(e)}).reduce(function(t,n){return t[n]=e.internetHeaders.get(n),t},{})]}})})}},He=function(e){return function(t){return r.__awaiter(void 0,void 0,void 0,function(){return r.__generator(this,function(n){switch(n.label){case 0:return[4,Le(t,e.ItemId.Id)];case 1:return[2,n.sent()]}})})}},Ve=n(266),We=function(e){return!!~Object(Ve.c)(Ve.a.SurfaceActions).composeSurfaceAddins.indexOf(e)},Ge=function(e){return!!~Object(Ve.c)(Ve.a.SurfaceActions).readSurfaceAddins.indexOf(e)},ze=function(e){return function(){return e.itemId?e.itemId.Id:null}},qe=function(e){return function(){return e.ItemId.Id}},Ke=n(21),Xe=function(e){return function(){return function(e){if(!e||!e.ParentFolderId)return!1;var t=e.ParentFolderId.Id;return Object(Ke.I)(t,Ke.j)}(e)}},Je=function(e){return function(){var t=e;return void 0!==t.isInSharedFolder&&t.isInSharedFolder}};function Qe(){return!0}var Ye=n(31),Ze=n(27),$e=function(e){return function(){var t=e;return{owner:t.folderOwnerEmailAddress,delegatePermissions:tt(t.folderPermission)}}},et=function(e){return function(){var t=e.ParentFolderId.Id,n=Object(Ze.i)(),r=Object(Ye.u)(t,n);return{owner:Object(Ke.y)().get(t).principalSMTPAddress,delegatePermissions:tt(r)}}};function tt(e){return e?{Read:"FullDetails"==e.ReadItems,Create:e.CanCreateItems,EditOwn:"All"==e.EditItems||"Owned"==e.EditItems,EditAll:"All"==e.EditItems,DeleteOwn:"All"==e.DeleteItems||"Owned"==e.DeleteItems,DeleteAll:"All"==e.DeleteItems}:{Read:!0,Create:!0,EditOwn:!0,EditAll:!0,DeleteOwn:!0,DeleteAll:!0}}var nt=n(3548),rt=n(5784),ot=n(520);function it(e,t,n){return function(){var r=Object(i.n)(t);if(!r)return null;var o=function(e,t,n,r){return{text:Object(E.a)(rt.a),action:function(){var o=n.ExtensionId,a=n.Persistent;i.E.import().then(function(n){n(t),a&&i.M.import().then(function(t){t(e,o)})}),r(t)}}}(e,t,r,n);return{key:r.Key,source:ot.c.Extensibility,rank:at(r.Type),messageParts:[r.Message,"|",o],color:ot.a.Grey}}}function at(e){switch(e){case 0:case 1:return ot.b.Info;case 2:return ot.b.Error}return ot.b.Safety}var st=function(e){return function(t){d.a(e)(t,it(Object(i.m)(e.composeId),t,ct(e)))}},ct=function(e){return function(t){d.c(e)([t])}},ut=function(e){return function(){return d.b(e)()}},lt=Object(Q.mutatorAction)("removeInternetHeaders",function(e,t){t.forEach(function(t){e.internetHeaders.get(t)&&(e.keysOfInternetHeadersToBeRemoved.push(t),e.internetHeaders.delete(t))}),Object(De.a)(e)}),dt=function(e){return function(t){je(e,t)}},ft=function(e){return function(t){return r.__awaiter(void 0,void 0,void 0,function(){return r.__generator(this,function(n){switch(n.label){case 0:return 4!==e.operation?[3,2]:[4,Fe(e,t)];case 1:n.sent(),n.label=2;case 2:return lt(e,t),[2]}})})}};function pt(e){return{getRecipients:V(e),setRecipients:W(e),addRecipients:G(e),getSubject:ae(e),setSubject:se(e),getItemId:ze(e),getConversationId:w(e),getBody:Z(e),setBody:$(e),getBodyType:ee(e),prependBody:te(e),getSelectedData:ue(e),setSelectedData:le(e),setBodySelectedData:ne(e),mode:nt.a.MessageCompose,saveItem:J(e),addNotificationMessage:st(e),removeNotificationMessage:ct(e),getNotificationMessageIds:ut(e),close:M(e),displayMessageForm:Ee,displayAppointmentForm:Oe,addItemAttachment:v(e),addFileAttachment:y(e),addFileAttachmentFromBase64:_(e),removeAttachment:C(e),getAttachments:b(e),getAttachmentContent:O(e),isAddinPinned:We,isSharedItem:Je(e),getSharedProperties:$e(e),isRemoteItem:Qe,getFrom:k(e),getInternetHeaders:Be(e),setInternetHeaders:dt(e),removeInternetHeaders:ft(e),appendOnSend:re(e),getCategoriesMailbox:ve,addCategoriesMailbox:he,removeCategoriesMailbox:ye}}function mt(e){var t=[];return e&&(t=e.map(function(e){return{Mailbox:e}})),t}var gt=n(1301),vt=n(4826),ht=function(e,t,n,r,o,i,a,s){var c,u=mt(e),l=mt(t),d=new Date(null==n?Date.now():n),f=null==r?void 0:new Date(r);if(o){var p=Object(gt.l)(o);c=Object(gt.i)(p)[0]}var m={RequiredAttendees:u||[],OptionalAttendees:l||[],Locations:c?[c]:[],Resources:(i?i.map(function(e){return{Mailbox:{EmailAddress:e}}}):null)||[],Subject:a,Body:{Value:s,BodyType:"HTML"},Start:d,End:f};Object(vt.b)(m,"Mail_AddIns",2)},yt=n(5270),bt=n(4990),_t=n(45);function St(e,t,n,r){var o=Ie(e),i=o?o.ConversationId.Id:null,a=Object(bt.a)(r);P.y.importAndExecute({referenceItemId:{Id:e,mailboxInfo:Object(_t.e)()},isReplyAll:t,useFullCompose:!0,actionSource:"AddIns",instrumentationContexts:[],conversationId:i,body:n,fullComposeTarget:P.a.Popout,attachmentFiles:a})}var Ct=n(1979),Ot=n.n(Ct),It=n(57),At=n.n(It),Tt=n(1980),Et=n.n(Tt),xt=n(29);function Pt(e){return function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Et()({Header:Object(xt.getJsonRequestHeader)(),Body:Ot()({EventIds:[e],ItemShape:ke()({BaseShape:"IdOnly",AdditionalProperties:[At()({FieldURI:"calendar:Recurrence"}),At()({FieldURI:"calendar:SeriesMasterItemId"})]})})},null)];case 1:return[2,t.sent().Body.ResponseMessages.Items]}})})}(e).then(function(e){if(Object(Ye.g)(e[0])){var t=e[0].Items[0];return{SeriesMasterItemId:t.SeriesMasterItemId,Recurrence:t.Recurrence}}return null})}function Mt(e){var t=this;return e&&e.IsRecurring?function(){return r.__awaiter(t,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,Pt(e.AssociatedCalendarItemId)];case 1:return(t=n.sent())&&t.SeriesMasterItemId?[2,t.SeriesMasterItemId.Id]:[2,null]}})})}:function(){return Promise.resolve(void 0)}}var wt=n(306),Rt=n(2605),kt=n(7622),Dt=function(e){return function(t){kt.a(e)(t,it(Object(i.o)(e.itemId),t,jt(e)))}},jt=function(e){return function(t){kt.c(e)(t)}},Nt=function(e){return function(){return kt.b(e)()}},Ft=function(e){return function(t){return g(e.attachmentWell,t)}},Lt=function(e){return function(){return e}},Ut=function(e,t){return function(){return!e.isConversationItemPart||Object(Rt.b)({conversationReadingPaneState:t.store.conversationReadingPaneViewState})==e}},Bt=function(e,t){return function(){var n=e.isConversationItemPart&&t.ConversationId?t.ConversationId.Id:null;return!!Object(P.d)(n)}},Ht=Object(U.select)({store:function(){return wt.a}})(function(e,t,n){return{getItem:Lt(e),getItemId:qe(e),addNotificationMessage:Dt(t),removeNotificationMessage:jt(t),getNotificationMessageIds:Nt(t),mode:nt.a.MessageRead,displayMessageForm:Ee,displayNewMessageForm:yt.a,displayNewAppointmentForm:ht,displayReplyForm:St,displayAppointmentForm:Oe,isAddinPinned:Ge,isItemSelected:Ut(t,n),isInlineComposeOpen:Bt(t,e),isSharedItem:Xe(e),isRemoteItem:Qe,getSharedProperties:et(e),getRecurrence:(o=e,function(){return r.__awaiter(void 0,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return o.AssociatedCalendarItemId?o.Recurrence?[2,o.Recurrence]:[3,1]:[2,null];case 1:return[4,Pt(o.AssociatedCalendarItemId)];case 2:return(e=n.sent())?e.Recurrence?[2,e.Recurrence]:e.SeriesMasterItemId?[4,Pt(e.SeriesMasterItemId)]:[3,4]:[2,null];case 3:return(t=n.sent())?[2,t.Recurrence]:[2,null];case 4:return[2,null]}})})}),getSeriesId:Mt(e),getInternetHeaders:He(e),getAttachmentContent:Ft(t),getCategoriesMailbox:ve,addCategoriesMailbox:he,removeCategoriesMailbox:ye,getCategoriesItem:be(t),addCategoriesItemRead:_e,removeCategoriesItemRead:Se};var o});n.d(t,"hasInlineImage",function(){return I}),n.d(t,"createMailComposeAdapter",function(){return pt}),n.d(t,"createMailReadAdapter",function(){return Ht})},1168:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},1170:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(110),o=n(888);function i(e){if(!e)return!1;var t=r.a.favoritingInProgressMap;return"string"==typeof e?t.has(e):t.has(Object(o.a)(e))}},1171:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CreateFolderJsonRequest:#Exchange"},e)}},1172:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(954),o=n(75),i=n(955);function a(e){return Object(i.a)(function(){return Object(o.d)(r.a,e,void 0,!0,null,!0)})}},1173:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a});var r=n(286),o=n(12);function i(e){var t;try{t=JSON.parse(e)}catch(t){return void o.c.warn("Cannot parse folderForestNode: "+e)}if(void 0!==t.id)switch(t.type){case 0:return{id:t.id,type:t.type,treeType:"favorites"};case 3:case 4:return{id:t.id,type:t.type,treeType:"favorites",dropViewState:Object(r.a)()};case 1:var n={id:t.id,type:t.type,treeType:"favorites",displayName:t.displayName,mainEmailAddress:t.personaEmail,allEmailAddresses:t.personaAllEmails||[],searchFolderId:t.personaSearchFolderId,isJustAdded:!1,isSearchFolderPopulated:!0,isSyncUpdateDone:!1,dropViewState:Object(r.a)()};return t.personaId&&(n.personaId=t.personaId),n;default:return void o.c.warn("Non supported FolderForestNodeType: "+t.type)}}function a(e,t,n,r,i){return e.map(function(e){var a;return t.has(e)?a=t.get(e):n.has(e)?a=n.get(e):r.has(e)?a=r.get(e):i.has(e)?a=i.get(e):o.c.warn("Favorites not found. favoriteType: "+a.type),function(e){var t={id:e.id,type:e.type};if(1===e.type){var n=e;t.displayName=n.displayName,t.personaSearchFolderId=n.searchFolderId,t.personaEmail=n.mainEmailAddress,t.personaAllEmails=n.allEmailAddresses,t.personaId=n.personaId}return JSON.stringify(t)}(a)})}},1174:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindItemRequest:#Exchange"},e)}},1175:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(1702);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("FindItem",e,t)}},1176:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete"}(r||(r={}))},1177:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(2305);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetFolder",e,t)}},1178:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetFolderRequest:#Exchange"},e)}},1179:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("SET_FAVORITES_LOADED")},1180:function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s});var r=n(511);function o(e){return e&&0===e.indexOf(r.f)}function i(e){return e&&0===e.indexOf(r.e)&&!o(e)}function a(e){return e&&0===e.indexOf(r.e)}function s(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},1184:function(e,t,n){"use strict";var r=n(1335);n.d(t,"a",function(){return r.a})},1220:function(e,t,n){"use strict";var r;!function(e){e[e.All=0]="All",e[e.AllCurrentAndFuture=1]="AllCurrentAndFuture",e[e.AllButOne=2]="AllButOne",e[e.AllOlderThan=3]="AllOlderThan"}(r||(r={})),t.a=r},1256:function(e,t,n){"use strict";var r=n(372),o=n(1),i=Object(o.action)("setAppPaneUnderlayVisibility",function(e,t,n){return{key:e,isShown:t,shrinkable:n}});Object(o.mutator)(i,function(e){var t=Object(r.a)();e.isShown?t.shrinkable.set(e.key,e.shrinkable):t.shrinkable.delete(e.key),t.isShown.set(e.key,e.isShown)}),t.a=i},1259:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),o=n(110),i=n(888);function a(e){var t=o.a.favoriteSecondaryKeyMap,n=o.a.orderedOutlookFavoritesIds,a=o.a.outlookFavorites;n.some(function(t){return t===e.favoriteId})||(n.push(e.favoriteId),a.set(e.favoriteId,r.__assign({treeType:"favorites"},e)),t.set(Object(i.a)(e),e.favoriteId))}},1271:function(e,t,n){"use strict";var r=n(98),o=n(1818),i=n(193);function a(e,t,n,i){void 0===i&&(i=!0);var a=e,s=a.AttachmentId,c=a.Name,l=a.OriginalPermissionType,d=a.PermissionType,f=u(e);switch(t){case 0:case 3:return o.b(s,f,t,n,d,l,i,c);case 1:return e.AttachmentPreviewUrl?e.AttachmentPreviewUrl:o.b(s,f,1,n,d,l,i,c);case 2:return e.AttachmentThumbnailUrl;default:return Object(r.a)(t)}}function s(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),o.a(e.mailboxInfo.routingKey,e,t,n,r)}function c(e,t,n,r,c){void 0===c&&(c=!1);var u=n?a(t,1,r,!1):s(e,1,c,!1);if(n)return{url:u,init:{credentials:"include"}};var l=Object(o.c)(),d=new Headers;return d.set("X-Token",l),d.set("X-OWA-CANARY",Object(i.getOwaCanaryCookie)()),{url:u,init:{headers:d}}}function u(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}function l(e,t,n,r,o,i){return void 0===i&&(i=!1),r?a(t,n,o):s(e,n,i)}n.d(t,"a",function(){return l}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return u})},1274:function(e,t,n){"use strict";n.r(t),n.d(t,"DESCENDING_SORT_DIR",function(){return o}),n.d(t,"ASCENDING_SORT_DIR",function(){return i}),n.d(t,"DEFAULT_SORT_COLUMN",function(){return a}),n.d(t,"getSortBySupportingPin",function(){return s}),n.d(t,"getSupportedSortColumns",function(){return c}),n.d(t,"getDefaulSortDirectionForSortColumn",function(){return u}),n.d(t,"getDefaultSortBy",function(){return l}),n.d(t,"isTableMultiValueSort",function(){return d});var r=n(33),o="Descending",i="Ascending",a=1;function s(){return{sortColumn:1,sortDirection:o}}function c(e){return Object(r.a)("sentitems")==e||Object(r.a)("drafts")==e?[1,7]:[1,3,7,5,8]}function u(e){switch(e){case 1:case 7:case 5:return o;case 3:case 8:return i;default:throw new Error("getDefaulSortDirectionForSortColumn: sortColumn not supported")}}function l(){return{sortColumn:a,sortDirection:u(a)}}function d(e){var t=0==e.type&&e.sortBy.sortColumn;return t&&0==e.listViewType&&3==t}},1279:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("MARK_CONVERSATIONS_AS_READ_STORE_UPDATE",function(e,t,n,r){return{conversationIds:e,tableViewId:t,isReadValue:n,isExplicit:r}})},1280:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("MARK_ITEMS_AS_READ_STORE_UPDATE",function(e,t,n,r){return{itemIds:e,isReadValue:t,isExplicit:n,tableViewId:r}})},1284:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unspecified=0]="Unspecified",e[e.String=1]="String",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Boolean=4]="Boolean",e[e.Date=5]="Date"}(t.AWTPropertyType||(t.AWTPropertyType={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.AWTPiiKind||(t.AWTPiiKind={})),function(e){e[e.NotSet=0]="NotSet",e[e.GenericContent=1]="GenericContent"}(t.AWTCustomerContentKind||(t.AWTCustomerContentKind={})),function(e){e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Immediate_sync=5]="Immediate_sync"}(t.AWTEventPriority||(t.AWTEventPriority={})),function(e){e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.QueueFull=3]="QueueFull"}(t.AWTEventsDroppedReason||(t.AWTEventsDroppedReason={})),function(e){e[e.InvalidEvent=1]="InvalidEvent",e[e.SizeLimitExceeded=2]="SizeLimitExceeded",e[e.KillSwitch=3]="KillSwitch"}(t.AWTEventsRejectedReason||(t.AWTEventsRejectedReason={}))},13:function(e,t,n){"use strict";var r=n(509),o=n(1274),i=n(72),a=n(7),s=n(286),c=Object(a.action)("createFocusedOtherDropViewState")(function(){i.a.focusedOtherDropViewState=Object(s.a)()});function u(){return i.a.focusedOtherDropViewState||c(),i.a.focusedOtherDropViewState}var l,d=n(1609);n(1464);!function(e){e[e.None=0]="None",e[e.Previous=1]="Previous",e[e.Next=2]="Next"}(l||(l={}));var f=l;function p(e){switch(e.tableQuery.type){case 0:case 2:return e.tableQuery.focusedViewFilter;case 1:return-1;default:throw new Error("Table Query should be either of type search, mail folder or group")}}function m(e){var t=Object(i.b)().tableViews.get(e);switch(t.tableQuery.type){case 0:return t.tableQuery.inboxClassificationFilter;case 2:case 1:return 0;default:throw new Error("Table Query should be either of type search, mail folder or group")}}function g(e){return!!e.isInVirtualSelectAllMode||(e.rowKeys.length==e.totalRowsInView||1==e.tableQuery.type)&&(e.isInCheckedMode&&e.selectedRowKeys.size==e.rowKeys.length)}var v=n(1313);function h(e){var t=i.a.tableViews.get(e);switch(t.tableQuery.type){case 2:return t.serverFolderId;case 0:return t.tableQuery.folderId;case 1:return null}}var y=n(383);function b(){var e=Object(y.a)();return!!e&&1===e.tableQuery.type}function _(e){switch(e.tableQuery.type){case 0:case 2:return e.tableQuery.sortBy;default:throw new Error("getSortByForTable: Table Query type should be either of type group or mail folder")}}function S(e){switch(e.tableQuery.type){case 0:case 2:return e.tableQuery.viewFilter;case 1:return"All";default:throw new Error("Table Query should be either of type search, mail folder or group")}}function C(e){return e&&"Unread"==S(e)}var O=n(9),I=n(21),A=n(95),T=["drafts","junkemail","recoverableitemsdeletions"];function E(e){if(e){var t=Object(I.y)().get(e);if(t&&(-1!=T.indexOf(Object(A.a)(e))||t.treeType===I.c||t.treeType===I.j))return 1}return Object(O.a)().UserOptions.GlobalListViewTypeReact||0}var x=n(1613),P=n(6);function M(e,t){var n=Object(D.a)(e,t),r=null;return pe(i.a.tableViews.get(t).tableQuery.folderId)?r=Object(P.jb)(i.a.inboxPausedDateTime):n&&new Date(n.lastModifiedTimeStamp).toISOString(),{conversationId:n.id,conversationLastSyncTimeStamp:r}}var w=n(12);function R(e,t){switch(t){case 0:case 1:return e.InstanceKey;default:return w.c.warn("listViewType:"+t+" not supported"),null}}var k=n(510),D=n(298),j=n(810),N=n(1614);function F(e,t){for(var n=[],r=0;r<e.length;r++){var o=t.rowIdToRowKeyMap.get(e[r]);o&&Array.prototype.push.apply(n,o)}return n}var L=n(1638),U=n(969),B=n(4),H=n(194),V=n(665),W=n(250),G=n(33);function z(e){var t=p(e),n=m(e.id),r=Object(H.c)();if(Object(W.a)()&&Object(G.a)("inbox")===e.tableQuery.folderId){var o=Object(V.a)(n);return Object(B.b)(Object(B.a)(U.d),o.displayText)}return-1!==t?0===t?Object(B.a)(U.a):Object(B.a)(U.c):1===e.tableQuery.type||5===r.type||4===r.type||1===r.type?Object(B.a)(U.b):Object(B.a)(L.a)}var q=n(1090),K=n(1615);function X(e){var t;switch(e){case 0:t="Conversation";break;case 1:t="Message";break;default:t="Unknown"}return t}function J(e){return e.folderId===Object(G.a)(I.b)||e.folderId===Object(G.a)(I.g)}var Q=n(508),Y=n(0);function Z(e,t,n){var o=[];return t.forEach(function(t){var i=r.getItemIds(t,n);"Flagged"==e.FlagStatus?o.push(i[0]):o.push.apply(o,Y.__spread(i))}),o}function $(e,t,n){return!ne(e)&&(t&&n)}var ee=n(5),te=n(303);function ne(e){return"Unread"!==S(e)||Object(ee.d)("tri-autoMarkReadInUnreadSetting")&&Object(te.a)(64)}function re(e){return"Unread"==S(e)&&ne(e)}n(644);var oe,ie=n(1087),ae=n(1373),se=n(1640),ce=n(1641),ue=n(1642),le=n(1370);function de(){return!Object(y.a)().isInCheckedMode&&i.a.expandedConversationViewState.selectedNodeIds.length>0}function fe(e){var t=i.a.tableViews.get(e),n=p(t),r=m(e);if(g(t)){if(t.virutalSelectAllExclusionList.length>0)return Object(B.b)(Object(B.a)(le.a),t.totalRowsInView-t.virutalSelectAllExclusionList.length);if(Object(W.a)()&&Object(G.a)("inbox")===t.tableQuery.folderId){var o=Object(V.a)(r);return Object(B.b)(Object(B.a)(ae.a),o.displayText)}return-1!==n?0===n?Object(B.a)(ue.a):Object(B.a)(ce.a):Object(B.a)(se.a)}var a=1==t.tableQuery.listViewType||de()?Object(B.a)(le.a):Object(B.a)(ae.b);return Object(B.b)(a,de()?i.a.expandedConversationViewState.selectedNodeIds.length:t.selectedRowKeys.size)}function pe(e){return i.a.inboxPausedDateTime&&e&&"inbox"===Object(A.a)(e)}!function(e){e[e.None=0]="None",e[e.BusStart=1]="BusStart",e[e.BusEnd=2]="BusEnd",e[e.BusStop=3]="BusStop",e[e.NoStop=4]="NoStop",e[e.CheckMark=5]="CheckMark"}(oe||(oe={}));var me=oe;n(997);function ge(e){return"persona"===e||"privatedistributionlist"===e||"category"===e}n.d(t,"n",function(){return u}),n.d(t,"p",function(){return d.a}),n.d(t,"E",function(){return i.b}),n.d(t,"O",function(){return i.a}),n.d(t,"d",function(){return f}),n.d(t,"m",function(){return p}),n.d(t,"q",function(){return m}),n.d(t,"r",function(){return g}),n.d(t,"i",function(){return v.a}),n.d(t,"j",function(){return v.b}),n.d(t,"o",function(){return h}),n.d(t,"t",function(){return b}),n.d(t,"C",function(){return y.a}),n.d(t,"D",function(){return _}),n.d(t,"I",function(){return S}),n.d(t,"R",function(){return C}),n.d(t,"x",function(){return E}),n.d(t,"k",function(){return x.a}),n.d(t,"h",function(){return M}),n.d(t,"A",function(){return R}),n.d(t,"H",function(){return k.a}),n.d(t,"F",function(){return D.a}),n.d(t,"G",function(){return j.a}),n.d(t,"z",function(){return N.a}),n.d(t,"B",function(){return F}),n.d(t,"l",function(){return z}),n.d(t,"M",function(){return q.a}),n.d(t,"g",function(){return K.a}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"y",function(){return X}),n.d(t,"J",function(){return J}),n.d(t,"u",function(){return Q.b}),n.d(t,"s",function(){return Q.a}),n.d(t,"v",function(){return Z}),n.d(t,"Q",function(){return $}),n.d(t,"f",function(){return ne}),n.d(t,"e",function(){return re}),n.d(t,"P",function(){return ie.a}),n.d(t,"w",function(){return fe}),n.d(t,"N",function(){return de}),n.d(t,"L",function(){return pe}),n.d(t,"a",function(){return me}),n.d(t,"K",function(){return ge})},1300:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;function o(e){return r.test(e)}},1301:function(e,t,n){"use strict";var r=n(948);n(1935);function o(e){var t=[];return e&&"string"!=typeof e&&t.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress}),t}var i=n(9),a=n(74),s="en-us",c={"am-et":"a_c_pc_pr_ctry","ar-dz":"a_pc_c_pr_ctry","ar-bh":"a_pc_c_pr_ctry","ar-eg":"a_ctry_c_pr_pc","ar-iq":"a_pc_c_pr_ctry","ar-jo":"a_c_pc_pr_ctry","ar-kw":"a_pc_c_pr_ctry","ar-lb":"a_c_pc_pr_ctry","ar-ly":"a_pc_c_pr_ctry","ar-ma":"a_pc_c_pr_ctry","ar-om":"a_c_pr_ctry_pc","ar-qa":"a_pc_c_pr_ctry","ar-sa":"a_c_pc_pr_ctry","ar-sy":"a_pc_c_pr_ctry","ar-tn":"a_pc_c_pr_ctry","ar-ae":"a_pc_c_pr_ctry","ar-ye":"a_pc_c_pr_ctry","eu-es":"a_pc_c_pr_ctry","bn-in":"a_c_pc_pr_ctry","bg-bg":"a_pc_c_pr_ctry","ca-es":"a_pc_c_pr_ctry","zh-cn":"pc_ctry_pr_c_a","zh-sg":"a_c_pc_pr_ctry","zh-hk":"ctry_pc_pr_c_a","zh-mo":"ctry_pr_c_pc_a","zh-tw":"pc_ctry_pr_c_a","hr-hr":"a_pc_c_pr_ctry","cs-cz":"a_pc_c_pr_ctry","da-dk":"a_pc_c_pr_ctry","nl-be":"a_pc_c_pr_ctry","nl-nl":"a_pc_c_pr_ctry","en-au":"a_c_pc_pr_ctry","en-bz":"a_pc_c_pr_ctry","en-ca":"a_c_pc_pr_ctry","en-ie":"a_c_pc_pr_ctry","en-jm":"a_pc_c_pr_ctry","en-nz":"a_c_pc_pr_ctry","en-ph":"a_pc_pr_c_ctry","en-za":"a_c_pc_pr_ctry","en-tt":"a_pc_c_pr_ctry","en-gb":"a_c_pc_pr_ctry","en-us":"a_c_pr_pc_ctry","en-zw":"a_pc_c_pr_ctry","et-ee":"a_pc_c_pr_ctry","fil-ph":"a_pc_pr_c_ctry","fi-fi":"a_pc_c_pr_ctry","fr-be":"a_pc_c_pr_ctry","fr-ca":"a_c_pc_pr_ctry","fr-fr":"a_pc_c_pr_ctry","fr-lu":"a_pc_c_pr_ctry","fr-mc":"a_pc_c_pr_ctry","fr-ch":"a_pc_c_pr_ctry","gl-es":"a_pc_c_pr_ctry","de-at":"a_pc_c_pr_ctry","de-de":"a_pc_c_pr_ctry","de-li":"a_pc_c_pr_ctry","de-lu":"a_pc_c_pr_ctry","de-ch":"a_pc_c_pr_ctry","el-gr":"a_pc_c_pr_ctry","gu-in":"a_c_pc_pr_ctry","he-il":"a_pc_c_pr_ctry","hi-in":"a_c_pc_pr_ctry","hu-hu":"c_a_pc_pr_ctry","is-is":"a_pc_c_pr_ctry","id-id":"a_c_pc_pr_ctry","it-it":"a_pc_c_pr_ctry","it-ch":"a_pc_c_pr_ctry","ja-jp":"pc_pr_c_a_ctry","kn-in":"a_c_pc_pr_ctry","kk-kz":"ctry_pr_c_pc_a","sw-ke":"a_c_pc_pr_ctry","ko-kr":"pc_pr_c_a_ctry","lv-lv":"a_c_pc_pr_ctry","lt-lt":"a_c_pc_pr_ctry","ms-bn":"a_c_pc_pr_ctry","ms-my":"a_pc_c_pr_ctry","ml-in":"a_c_pc_pr_ctry","mr-in":"a_c_pc_pr_ctry","nb-no":"a_pc_c_pr_ctry","or-in":"a_c_pc_pr_ctry","fa-ir":"a_c_pc_pr_ctry","pl-pl":"a_pc_c_pr_ctry","pt-br":"a_pc_c_pr_ctry","pt-pt":"a_pc_c_pr_ctry","ro-ro":"a_pc_c_pr_ctry","ru-ru":"ctry_pc_pr_c_a","sr-cyrl-cs":"a_pc_c_pr_ctry","sk-sk":"a_pc_c_pr_ctry","sl-si":"a_pc_c_pr_ctry","es-ar":"a_pc_c_pr_ctry","es-bo":"a_pc_c_pr_ctry","es-cl":"a_pc_c_pr_ctry","es-co":"a_pc_c_pr_ctry","es-cr":"a_pc_c_pr_ctry","es-do":"a_pc_c_pr_ctry","es-ec":"a_pc_c_pr_ctry","es-sv":"a_c_pc_pr_ctry","es-gt":"a_pc_c_pr_ctry","es-hn":"a_pc_c_pr_ctry","es-mx":"a_pc_c_pr_ctry","es-ni":"a_c_pc_pr_ctry","es-pa":"a_pc_c_pr_ctry","es-py":"a_pc_c_pr_ctry","es-pe":"a_pc_c_pr_ctry","es-pr":"a_c_pc_pr_ctry","es-es":"a_pc_c_pr_ctry","es-us":"a_c_pc_pr_ctry","es-uy":"a_pc_c_pr_ctry","es-ve":"a_pc_c_pr_ctry","sv-fi":"a_pc_c_pr_ctry","sv-se":"a_pc_c_pr_ctry","ta-in":"a_c_pc_pr_ctry","te-in":"a_c_pc_pr_ctry","th-th":"a_c_pc_pr_ctry","tr-tr":"a_pc_pr_c_ctry","uk-ua":"ctry_pc_pr_c_a","ur-pk":"a_c_pc_pr_ctry","cy-gb":"a_c_pc_pr_ctry"};var u=", ";function l(e,t,n,r,o,i){var s=[];Object(a.b)(e)||(s[s.length]=e);var c="";return Object(a.b)(t)||(c=t),Object(a.b)(n)||(c=Object(a.b)(c)?n:c+i+n),Object(a.b)(r)||(c=Object(a.b)(c)?r:c+i+r),Object(a.b)(c)||(s[s.length]=c),Object(a.b)(o)||(s[s.length]=o),s}function d(e,t,n,r,o){var d=function(){var e=Object(i.a)(),t="";e&&e.SessionSettings&&!Object(a.b)(e.SessionSettings.UserCulture)&&(t=e.SessionSettings.UserCulture.toLowerCase());var n=c[t];return null==n&&(n=c[s]),n}(),f=[],p=u;switch(d){case"a_c_pc_pr_ctry":f=l(e,t,n,r,o,p);break;case"a_c_pr_ctry_pc":f=l(e,t,r,o,n,p);break;case"a_c_pr_pc_ctry":f=l(e,t,r,n,o,p);break;case"a_ctry_c_pr_pc":f=l(e,o,t,r,n,p);break;case"a_pc_c_pr_ctry":f=l(e,n,t,r,o,p);break;case"a_pc_pr_c_ctry":f=l(e,n,r,t,o,p);break;case"c_a_pc_pr_ctry":f=l(t,e,n,r,o,p);break;case"ctry_pc_pr_c_a":f=l(o,n,r,t,e,p);break;case"ctry_pr_c_pc_a":f=l(o,r,t,n,e,p);break;case"pc_ctry_pr_c_a":f=l(n,o,r,t,e,p);break;case"pc_pr_c_a_ctry":f=l(n,r,t,e,o,p)}return f.join(p)}function f(e){return e?d(e.Street,e.City,e.PostalCode,e.State,e.Country):""}function p(e,t){return Object(a.b)(e)?f(t):e}var m=n(4);function g(e,t){var n=f(t);return Object(a.b)(e)?n:""==n?e:Object(m.b)("{0} ({1})",e,f(t))}var v=/\(([^)]*)\)/gi,h=/\([^)]*\)|[\0-\u001F\!-\/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,y=/\s+/gi;function b(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(v,"")).replace(h,"")).replace(y," ")).trim()).split(" ");return n.length>=2?(t+=n[0].charAt(0).toUpperCase(),t+=n[n.length-1].charAt(0).toUpperCase()):0!=n.length&&(t+=n[0].charAt(0).toUpperCase()),t}var _=n(17),S=Object.keys(_.a).length/2;function C(e){if(!e)return null;for(var t=0,n=e.length-1;n>=0;n--){var r=e.charCodeAt(n),o=n%8;t^=(r<<o)+(r>>8-o)}return t%S}function O(e){return{personaId:e,displayName:e,postalAddress:{Type:"Business",LocationSource:"None"},displayAddress:"",initials:b(e),textBoyColor:C(e),selectionSource:"ExplicitTyping",personaType:"Unknown",personaControlId:e}}function I(e){if(e){var t=function(e){return e?null!=e.HomeAddressesArray&&e.HomeAddressesArray.length>0?e.HomeAddressesArray[0].Value:null!=e.BusinessAddressesArray&&e.BusinessAddressesArray.length>0?e.BusinessAddressesArray[0].Value:null!=e.OtherAddressesArray&&e.OtherAddressesArray.length>0?e.OtherAddressesArray[0].Value:null:null}(e),n=p(e.DisplayName,t);return"Room"==e.PersonaTypeString&&(t.LocationUri=e.EmailAddress.EmailAddress),{personaId:e.PersonaId&&e.PersonaId.Id,feedbackId:e.FeedbackId,displayName:n,postalAddress:t,emailAddress:e.EmailAddress,displayAddress:f(t),initials:b(n),textBoyColor:C(n),selectionSource:"LocationWell",personaType:Object(a.b)(e.PersonaTypeString)?"Unknown":e.PersonaTypeString,personaControlId:null==e.PersonaId?e.FeedbackId:e.PersonaId.Id,availability:e.Availability,numberOfAvailableTimeSlots:e.NumberOfAvailableTimeSlots,totalNumberOfTimeSlots:e.TotalNumberOfTimeSlots,isPartialAvailability:e.IsPartialAvailability,capacity:e.Capacity}}return null}var A=n(793);function T(e){if(e&&e.DisplayName&&e.PostalAddress){var t=p(e.DisplayName,e.PostalAddress),n=Object(A.a)(e.PostalAddress)&&!Object(a.b)(e.PostalAddress.LocationUri)?{EmailAddress:e.PostalAddress.LocationUri}:null;return{personaId:e.Id,displayName:e.DisplayName,postalAddress:e.PostalAddress,emailAddress:n,displayAddress:f(e.PostalAddress),initials:b(t),textBoyColor:C(t),personaType:Object(A.a)(e.PostalAddress)?"Room":"Unknown",personaControlId:e.DisplayName}}return null}var E=n(0),x=n(2);function P(e,t,n,r){var o=Object(i.a)(),s="",c="",u="";return null!=o&&null!=o.ApplicationSettings&&null!=o.SessionSettings&&null!=o.PolicySettings&&o.PolicySettings.PlacesEnabled&&(s=o.ApplicationSettings.StaticMapUrl,c=o.ApplicationSettings.MapControlKey,u=o.SessionSettings.UserCulture),Object(a.b)(s)||Object(a.b)(c)||Object(a.b)(u)||!e||!t?"":Object(m.b)(s+"?centerPoint={0},{1}&pp={0},{1};51&ms={2},{3}&fmt=png&key={4}&c={5}",e,t,n,r,c,u)}var M=100,w=64,R=64;var k=n(20),D=n(2190),j=n(12),N=n(210),F=function(e){function t(t){var n=e.call(this,t)||this;return n.onCompleteDownload=function(e){n.setState({blobUrl:e}),e?n.requestStatus="success":(n.requestStatus="failed",j.c.warn("getLocationPhoto.downloadLocationPhoto failed"))},n.state={blobUrl:null},n}return E.__extends(t,e),t.prototype.componentDidMount=function(){this.fetchPersonaPhoto(this.props)},t.prototype.componentWillReceiveProps=function(e){this.fetchPersonaPhoto(e)},t.prototype.fetchPersonaPhoto=function(e){e.locationPersona.postalAddress&&e.locationPersona.postalAddress.Latitude&&e.locationPersona.postalAddress.Longitude&&!Object(a.b)(e.locationPersona.displayName)&&!this.state.blobUrl&&"pending"!=this.requestStatus&&"failed"!=this.requestStatus&&(this.requestStatus="pending",function(e,t){var n="";e.postalAddress&&e.postalAddress.Latitude&&e.postalAddress.Longitude&&(n=P(e.postalAddress.Latitude,e.postalAddress.Longitude,w,R));var r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType="blob",r.onreadystatechange=function(){if(4===r.readyState){var e=null,n=!1;if(200===r.status){e=r.response;var o=r.getResponseHeader("Content-Type");n=o&&0==o.toLowerCase().indexOf("image")&&e instanceof Blob}var i=void 0;n&&e&&e.size>M&&(i=URL.createObjectURL(e)),t(i)}},r.send()}(e.locationPersona,this.onCompleteDownload))},t.prototype.render=function(){var e=this.props,t=e.locationPersona,n=e.className,r=e.size,o=e.showPersonaDetails;if(t){var i={};return Object(a.b)(this.state.blobUrl)?N(i,{imageInitials:t.initials,initialsColor:t.textBoyColor}):N(i,{imageUrl:this.state.blobUrl,imageShouldFadeIn:!1}),x.createElement(D.a,E.__assign({className:n,presence:_.b.none,hidePersonaDetails:!o,size:r,text:t.displayName,secondaryText:t.displayAddress},i))}return null},t=E.__decorate([k.observer],t)}(x.Component),L="https://www.bing.com/maps?v=2&rtp=~pos.{0}_{1}_{2}_{3}",U="https://www.bing.com/maps?v=2&rtp=~adr.{0}_{1}";function B(e,t,n,r){return e&&t?Object(m.b)(L,e.toString(),t.toString(),n,r):n?Object(m.b)(U,n,r):null}var H=n(1514),V=n(109),W=n(505);function G(e){var t=e&&e.accessibleText&&e.accessibleText.msColorWhiteBackground||Object(V.g)().themePrimary,n=e?e.calDarker:Object(V.g)().themeDarker;return Object(W.a)({color:t,cursor:"pointer",selectors:{"&:hover":{color:n},"&:focus":{color:n}}})}var z=n(3);function q(e,t){return{Id:t,DisplayName:e,PostalAddress:{LocationSource:"Resource",LocationUri:t,Type:"Business"}}}function K(e){return{EmailAddress:e.PostalAddress.LocationUri,Name:e.DisplayName}}function X(e){return{Id:e,DisplayName:e,PostalAddress:{Type:"Business",LocationSource:"None"}}}function J(e,t,n,r){return e?{PostalAddress:{LocationUri:n,LocationSource:r,Type:t,Street:e.streetAddress,City:e.addressLocality,State:e.addressRegion,Country:e.addressCountry,PostalCode:e.postalCode,PostOfficeBox:e.postOfficeBoxNumber,Longitude:e.longitude,Latitude:e.latitude}}:null}function Q(e){return!Object(H.a)(e.PostalAddress)&&/^((http[s]?:\/\/)|(www\.)?){1}[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}\b([-a-zA-Z0-9@:*%_\+.~#?&\/\/=]*)/i.test(e.DisplayName)}function Y(e){return function(){var t=/^http*/i.test(e)?e:"//"+e;window.open(t,"_blank")}}n.d(t,"v",function(){return $}),n.d(t,"p",function(){return g}),n.d(t,"n",function(){return f}),n.d(t,"o",function(){return d}),n.d(t,"l",function(){return O}),n.d(t,"k",function(){return I}),n.d(t,"j",function(){return T}),n.d(t,"a",function(){return F}),n.d(t,"m",function(){return B}),n.d(t,"b",function(){return P}),n.d(t,"s",function(){return H.a}),n.d(t,"t",function(){return A.a}),n.d(t,"q",function(){return G}),n.d(t,"f",function(){return q}),n.d(t,"c",function(){return r.a}),n.d(t,"d",function(){return r.b}),n.d(t,"e",function(){return r.c}),n.d(t,"r",function(){return K}),n.d(t,"g",function(){return X}),n.d(t,"i",function(){return o}),n.d(t,"h",function(){return J}),n.d(t,"w",function(){return Y}),n.d(t,"u",function(){return Q});var Z=new z.c(function(){return n.e(775).then(n.bind(null,11917))}),$=new z.b(Z,function(e){return e.createTxpPostalAddressFromLocationPersona})},1303:function(e,t,n){"use strict";var r=n(882),o=n(1330),i=n(1326);t.a=function(e,t){return Object(i.a)(Object(o.a)(e,t,r.a),e+"")}},1304:function(e,t,n){"use strict";var r=n(0),o=n(2),i=n(146),a=n(506),s=n(53),c=n(115),u=n(131),l=n(2296),d=n(880),f=n(2300),p=n(1868),m=n(2093),g=n(317),v=n(67),h=n(209),y=n(333),b=n(14),_=Object(y.b)(function(e,t){return{root:Object(b.mergeStyles)(e,t&&{touchAction:"none",selectors:{"& *":{userSelect:"none"}}})}}),S=n(289),C={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},O=function(e){function t(t){var n=e.call(this,t)||this;return n._currentEventType=C.mouse,n._events=[],n._onMouseDown=function(e){var t=o.Children.only(n.props.children).props.onMouseDown;return t&&t(e),n._currentEventType=C.mouse,n._onDragStart(e)},n._onMouseUp=function(e){var t=o.Children.only(n.props.children).props.onMouseUp;return t&&t(e),n._currentEventType=C.mouse,n._onDragStop(e)},n._onTouchStart=function(e){var t=o.Children.only(n.props.children).props.onTouchStart;return t&&t(e),n._currentEventType=C.touch,n._onDragStart(e)},n._onTouchEnd=function(e){var t=o.Children.only(n.props.children).props.onTouchEnd;t&&t(e),n._currentEventType=C.touch,n._onDragStop(e)},n._onDragStart=function(e){if("number"==typeof e.button&&0!==e.button)return!1;if(!(n.props.handleSelector&&!n._matchesSelector(e.target,n.props.handleSelector)||n.props.preventDragSelector&&n._matchesSelector(e.target,n.props.preventDragSelector))){n._touchId=n._getTouchId(e);var t=n._getControlPosition(e);if(void 0!==t){var r=n._createDragDataFromPosition(t);n.props.onStart&&n.props.onStart(e,r),n.setState({isDragging:!0,lastPosition:t}),n._events=[Object(S.a)(document.body,n._currentEventType.move,n._onDrag),Object(S.a)(document.body,n._currentEventType.stop,n._onDragStop)]}}},n._onDrag=function(e){"touchmove"===e.type&&e.preventDefault();var t=n._getControlPosition(e);if(t){var r=n._createUpdatedDragData(n._createDragDataFromPosition(t)),o=r.position;n.props.onDragChange&&n.props.onDragChange(e,r),n.setState({position:o,lastPosition:t})}},n._onDragStop=function(e){if(n.state.isDragging){var t=n._getControlPosition(e);if(t){var r=n._createDragDataFromPosition(t);n.setState({isDragging:!1,lastPosition:void 0}),n.props.onStop&&n.props.onStop(e,r),n.props.position&&n.setState({position:n.props.position}),n._events.forEach(function(e){return e()})}}},n.state={isDragging:!1,position:n.props.position||{x:0,y:0},lastPosition:void 0},n}return r.__extends(t,e),t.prototype.componentDidUpdate=function(e){!this.props.position||e.position&&this.props.position===e.position||this.setState({position:this.props.position})},t.prototype.componentWillUnmount=function(){this._events.forEach(function(e){return e()})},t.prototype.render=function(){var e=o.Children.only(this.props.children),t=e.props,n=this.props.position,i=this.state,a=i.position,s=i.isDragging,c=a.x,u=a.y;return n&&!s&&(c=n.x,u=n.y),o.cloneElement(e,{style:r.__assign({},t.style,{transform:"translate("+c+"px, "+u+"px)"}),className:_(t.className,this.state.isDragging).root,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onTouchStart:this._onTouchStart,onTouchEnd:this._onTouchEnd})},t.prototype._getControlPosition=function(e){var t=this._getActiveTouch(e);if(void 0===this._touchId||t){var n=t||e;return{x:n.clientX,y:n.clientY}}},t.prototype._getActiveTouch=function(e){return e.targetTouches&&this._findTouchInTouchList(e.targetTouches)||e.changedTouches&&this._findTouchInTouchList(e.changedTouches)},t.prototype._getTouchId=function(e){var t=e.targetTouches&&e.targetTouches[0]||e.changedTouches&&e.changedTouches[0];if(t)return t.identifier},t.prototype._matchesSelector=function(e,t){if(!e||e===document.body)return!1;var n=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return!!n&&(n.call(e,t)||this._matchesSelector(e.parentElement,t))},t.prototype._findTouchInTouchList=function(e){if(void 0!==this._touchId)for(var t=0;t<e.length;t++)if(e[t].identifier===this._touchId)return e[t]},t.prototype._createDragDataFromPosition=function(e){var t=this.state.lastPosition;return void 0===t?{delta:{x:0,y:0},lastPosition:e,position:e}:{delta:{x:e.x-t.x,y:e.y-t.y},lastPosition:t,position:e}},t.prototype._createUpdatedDragData=function(e){var t=this.state.position;return{position:{x:t.x+e.delta.x,y:t.y+e.delta.y},delta:e.delta,lastPosition:t}},t}(o.Component);n.d(t,"a",function(){return T});var I={eventBubblingEnabled:!1},A=Object(i.a)(),T=function(e){function t(t){var n=e.call(this,t)||this;return n._focusTrapZone=o.createRef(),n._allowScrollOnModal=function(e){e?Object(a.b)(e,n._events):n._events.off(n._scrollableContent),n._scrollableContent=e},n._onModalContextMenuClose=function(){n.setState({isModalMenuOpen:!1})},n._onModalClose=function(){n._lastSetX=0,n._lastSetY=0,n.setState({isModalMenuOpen:!1,isInKeyboardMoveMode:!1,isOpen:!1,x:0,y:0}),n.props.onDismissed&&n.props.onDismissed()},n._onDragStart=function(){n.setState({isModalMenuOpen:!1,isInKeyboardMoveMode:!1})},n._onDrag=function(e,t){var r=n.state,o=r.x,i=r.y;n.setState({x:o+t.delta.x,y:i+t.delta.y})},n._onDragStop=function(){n.focus()},n._onDialogKeyUp=function(e){e.altKey&&e.ctrlKey&&e.keyCode===s.a.space&&(n.setState({isModalMenuOpen:!n.state.isModalMenuOpen}),e.preventDefault(),e.stopPropagation())},n._onDialogKeyDown=function(e){if(e.altKey&&e.ctrlKey&&e.keyCode===s.a.space)return e.preventDefault(),void e.stopPropagation();if(n.state.isModalMenuOpen&&(e.altKey||e.keyCode===s.a.escape)&&n.setState({isModalMenuOpen:!1}),!n.state.isInKeyboardMoveMode||e.keyCode!==s.a.escape&&e.keyCode!==s.a.enter||(n.setState({isInKeyboardMoveMode:!1}),e.preventDefault(),e.stopPropagation()),n.state.isInKeyboardMoveMode){var t=!0,r=n._getMoveDelta(e);switch(e.keyCode){case s.a.escape:n.setState({x:n._lastSetX,y:n._lastSetY});case s.a.enter:n._lastSetX=0,n._lastSetY=0,n.setState({isInKeyboardMoveMode:!1});break;case s.a.up:n.setState({y:n.state.y-r});break;case s.a.down:n.setState({y:n.state.y+r});break;case s.a.left:n.setState({x:n.state.x-r});break;case s.a.right:n.setState({x:n.state.x+r});break;default:t=!1}t&&(e.preventDefault(),e.stopPropagation())}},n._onEnterKeyboardMoveMode=function(){n._lastSetX=n.state.x,n._lastSetY=n.state.y,n.setState({isInKeyboardMoveMode:!0,isModalMenuOpen:!1})},n._onExitKeyboardMoveMode=function(){n._lastSetX=0,n._lastSetY=0,n.setState({isInKeyboardMoveMode:!1})},n.state={id:Object(c.c)("Modal"),isOpen:t.isOpen,isVisible:t.isOpen,hasBeenOpened:t.isOpen,x:0,y:0},n._lastSetX=0,n._lastSetY=0,n._warnDeprecations({onLayerDidMount:"layerProps.onLayerDidMount"}),n}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){if(clearTimeout(this._onModalCloseTimer),e.isOpen)if(this.state.isOpen){if(this.setState({hasBeenOpened:!0,isVisible:!0}),e.topOffsetFixed){var t=document.getElementsByClassName("ms-Dialog-main"),n=void 0;t.length>0&&(n=t[0].getBoundingClientRect(),this.setState({modalRectangleTop:n.top}))}}else this.setState({isOpen:!0});!e.isOpen&&this.state.isOpen&&(this._onModalCloseTimer=this._async.setTimeout(this._onModalClose,1e3*parseFloat(d.a)),this.setState({isVisible:!1}))},t.prototype.componentDidUpdate=function(e,t){e.isOpen||t.isVisible||this.setState({isVisible:!0})},t.prototype.render=function(){var e=this.props,t=e.className,n=e.containerClassName,i=e.scrollableContentClassName,a=e.elementToFocusOnDismiss,s=e.firstFocusableSelector,c=e.forceFocusInsideTrap,u=e.ignoreExternalFocusing,d=e.isBlocking,y=e.isClickableOutsideFocusTrap,b=e.isDarkOverlay,_=e.onDismiss,S=e.layerProps,C=e.responsiveMode,T=e.titleAriaId,E=e.styles,x=e.subtitleAriaId,P=e.theme,M=e.topOffsetFixed,w=e.onLayerDidMount,R=e.isModeless,k=e.dragOptions,D=this.state,j=D.isOpen,N=D.isVisible,F=D.hasBeenOpened,L=D.modalRectangleTop,U=D.x,B=D.y,H=D.isInKeyboardMoveMode;if(!j)return null;var V=void 0===S?"":S.className,W=A(E,{theme:P,className:t,containerClassName:n,scrollableContentClassName:i,isOpen:j,isVisible:N,hasBeenOpened:F,modalRectangleTop:L,topOffsetFixed:M,isModeless:R,layerClassName:V,isDefaultDragHandle:k&&!k.dragHandleSelector}),G=r.__assign({},I,this.props.layerProps,{onLayerDidMount:S&&S.onLayerDidMount?S.onLayerDidMount:w,insertFirst:R,className:W.layer}),z=o.createElement(l.a,{componentRef:this._focusTrapZone,className:W.main,elementToFocusOnDismiss:a,isClickableOutsideFocusTrap:R||y||!d,ignoreExternalFocusing:u,forceFocusInsideTrap:R?!R:c,firstFocusableSelector:s,focusPreviouslyFocusedInnerElement:!0,onKeyDown:k?this._onDialogKeyDown:void 0,onKeyUp:k?this._onDialogKeyUp:void 0,onBlur:H?this._onExitKeyboardMoveMode:void 0},k&&H&&o.createElement("div",{className:W.keyboardMoveIconContainer},k.keyboardMoveIconProps?o.createElement(h.a,r.__assign({},k.keyboardMoveIconProps)):o.createElement(h.a,{iconName:"move",className:W.keyboardMoveIcon})),o.createElement("div",{ref:this._allowScrollOnModal,className:W.scrollableContent,"data-is-scrollable":!0},k&&this.state.isModalMenuOpen&&o.createElement(k.menu,{items:[{key:"move",text:k.moveMenuItemText,onClick:this._onEnterKeyboardMoveMode},{key:"close",text:k.closeMenuItemText,onClick:this._onModalClose}],onDismiss:this._onModalContextMenuClose,alignTargetEdge:!0,coverTarget:!0,directionalHint:v.DirectionalHint.topLeftEdge,directionalHintFixed:!0,shouldFocusOnMount:!0,target:this._scrollableContent}),this.props.children));return C>=g.ResponsiveMode.small?o.createElement(p.a,r.__assign({},G),o.createElement(m.a,{role:R||!d?"dialog":"alertdialog","aria-modal":!R,ariaLabelledBy:T,ariaDescribedBy:x,onDismiss:_},o.createElement("div",{className:W.root},!R&&o.createElement(f.a,{isDarkThemed:b,onClick:d?void 0:_}),k?o.createElement(O,{handleSelector:k.dragHandleSelector||"."+W.main.split(" ")[0],preventDragSelector:"button",onStart:this._onDragStart,onDragChange:this._onDrag,onStop:this._onDragStop,position:{x:U,y:B}},z):z))):null},t.prototype.focus=function(){this._focusTrapZone.current&&this._focusTrapZone.current.focus()},t.prototype._getMoveDelta=function(e){var t=10;return e.shiftKey?e.ctrlKey||(t=50):e.ctrlKey&&(t=1),t},t.defaultProps={isOpen:!1,isDarkOverlay:!0,isBlocking:!1,className:"",containerClassName:""},t=r.__decorate([g.withResponsiveMode],t)}(u.a)},1305:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(0),o=n(2),i=n(146),a=n(506),s=n(58),c=n(131),u=Object(i.a)(),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){Object(a.c)()},t.prototype.componentWillUnmount=function(){Object(a.d)()},t.prototype.render=function(){var e=this.props,t=e.isDarkThemed,n=e.className,i=e.theme,a=e.styles,c=Object(s.f)(this.props,s.e),l=u(a,{theme:i,className:n,isDark:t});return o.createElement("div",r.__assign({},c,{className:l.root}))},t}(c.a)},1310:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(5);function o(e){return Object(r.d)("rp-smime")&&e&&e.AttachmentId&&i(e.AttachmentId.Id)}function i(e){return e&&-1!==e.indexOf("smime-")}},1311:function(e,t,n){"use strict";var r=n(740),o=n(340);t.a=function(e){return Object(o.a)(e)&&Object(r.a)(e)}},1312:function(e,t,n){"use strict";t.a=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},1313:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return u});var r=n(120),o=n.n(r),i=n(108),a=n.n(i),s=n(5);function c(e,t){return e.serverFolderId?e.serverFolderId==e.tableQuery.folderId?t?null:u(e.tableQuery):l(e.serverFolderId):null}function u(e){return 2==e.type?(t=e.folderId,o()({Id:Object(s.d)("grp-junkemailitems")?"junkemail":"inbox",Mailbox:{MailboxType:"GroupMailbox",EmailAddress:t}})):l(e.folderId);var t}function l(e){return a()({Id:e})}},1314:function(e,t,n){"use strict";var r=n(1),o=n(45),i=n(21),a=n(8),s=Object(r.createStore)("mailboxInfoStore",new a.ObservableMap),c=n(9);function u(e){if(!e)return Object(o.e)();if(!s().has(e)){var t=function(e){var t,n,r,a=Object(i.y)(),s=a&&a.get(e);s&&s.treeType===i.j?(t=s.principalSMTPAddress,n=s.principalSMTPAddress,r=Object(o.c)()+s.principalSMTPAddress):(t=Object(o.d)(),n=Object(c.a)().SessionSettings.UserEmailAddress,r=Object(o.b)());return{type:o.a.UserMailbox,deprecatedMailboxId:t,primarySmtpAddress:n,routingKey:r,returnModernConversationItems:!1,requestOptions:Object(i.t)(e)}}(e);l(e,t)}return s().get(e)}var l=Object(r.mutatorAction)("addMailboxInfoToStore",function(e,t){s().set(e,t)}),d=n(427),f=n(165),p=n(1520);function m(e){return e?g(e.tableQuery):Object(o.e)()}function g(e){var t=Object(f.b)(e),n=e&&e.folderId;return null!=t?Object(d.l)(t):v(n)}function v(e){return Object(i.M)(e)?Object(p.a)(e):u(e)}n.d(t,"a",function(){return m}),n.d(t,"c",function(){return g}),n.d(t,"b",function(){return v})},1315:function(e){e.exports={b:"Caa",d:"Daa",c:"Eaa",a:"Faa"}},1316:function(e,t,n){"use strict";var r=Function.prototype.toString;t.a=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},1319:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("saveSigningCertificate",function(e,t){return{smimeViewState:e,signingCertRawData:t}})},132:function(e,t,n){"use strict";n.d(t,"b",function(){return u});var r,o=n(1),i=n(8),a=n(150),s=n(61),c=Object(o.createStore)("folderStore",{folderTable:new i.ObservableMap,mailboxTable:new i.ObservableMap((r={},r[s.h]={id:s.h,rootFolder:null,loadingState:a.a.Uninitialized},r)),sharedFolderUserEmails:[]}),u=c();t.a=c},1320:function(e,t,n){"use strict";t.a=function(e){return function(){return e}}},1321:function(e,t,n){"use strict";var r,o=n(656),i=n(887),a=(r=/[^.]+$/.exec(i.a&&i.a.keys&&i.a.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";var s=function(e){return!!a&&a in e},c=n(216),u=n(1316),l=/^\[object .+?Constructor\]$/,d=Function.prototype,f=Object.prototype,p=d.toString,m=f.hasOwnProperty,g=RegExp("^"+p.call(m).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.a=function(e){return!(!Object(c.a)(e)||s(e))&&(Object(o.a)(e)?g:l).test(Object(u.a)(e))}},1322:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(305),o=n(21);function i(e){return e&&(Object(r.a)(e,o.f)||Object(r.a)(e,o.a))}},1323:function(e,t,n){"use strict";function r(e){return e.clientWidth<e.scrollWidth}function o(e){return e.clientHeight<e.scrollHeight}function i(e){return r(e)||o(e)}n.d(t,"a",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return i})},1326:function(e,t,n){"use strict";var r=n(1320),o=n(699),i=n(882),a=o.a?function(e,t){return Object(o.a)(e,"toString",{configurable:!0,enumerable:!1,value:Object(r.a)(t),writable:!0})}:i.a,s=n(1331),c=Object(s.a)(a);t.a=c},1328:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var r=n(0),o=n(2),i=n(932),a=n(127),s=n(146),c=n(58),u=n(77),l=n(222),d=n(131),f=n(657),p=Object(s.a)(),m=function(e){function t(t){var n=e.call(this,t)||this;return n._focusZone=o.createRef(),n._persistedKeytips={},n._keytipManager=f.a.getInstance(),n._divContainer=o.createRef(),n._onRenderItems=function(e){return e.map(function(e,t){var i={className:n._classNames.item};return o.createElement("div",r.__assign({key:e.key},i),n.props.onRenderItem(e))})},n._onRenderOverflowButtonWrapper=function(e){var t={className:n._classNames.overflowButton},i=n.props.keytipSequences,a=[];return i?e.forEach(function(e){var t=e.keytipProps;if(t){var o={content:t.content,keySequences:t.keySequences,disabled:t.disabled||!(!e.disabled&&!e.isDisabled),hasDynamicChildren:t.hasDynamicChildren,hasMenu:t.hasMenu};t.hasDynamicChildren||n._getSubMenuForItem(e)?o.onExecute=n._keytipManager.menuExecute.bind(n._keytipManager,i,e.keytipProps.keySequences):o.onExecute=t.onExecute,n._persistedKeytips[o.content]=o;var s=r.__assign({},e,{keytipProps:r.__assign({},t,{overflowSetSequence:i})});a.push(s)}else a.push(e)}):a=e,o.createElement("div",r.__assign({},t),n.props.onRenderOverflowButton(a))},t.doNotContainWithinFocusZone&&n._warnMutuallyExclusive({doNotContainWithinFocusZone:"focusZoneProps"}),n}return r.__extends(t,e),t.prototype.render=function(){var e,t,n=this.props,s=n.items,u=n.overflowItems,l=n.className,d=n.focusZoneProps,f=n.styles,m=n.vertical,g=n.role,v=n.doNotContainWithinFocusZone;return this._classNames=p(f,{className:l,vertical:m}),v?(e="div",t=r.__assign({},Object(c.f)(this.props,c.e),{ref:this._divContainer})):(e=i.a,t=r.__assign({},Object(c.f)(this.props,c.e),d,{componentRef:this._focusZone,direction:m?a.a.vertical:a.a.horizontal})),o.createElement(e,r.__assign({},t,{className:this._classNames.root,role:g}),s&&this._onRenderItems(s),u&&u.length>0&&this._onRenderOverflowButtonWrapper(u))},t.prototype.focus=function(e){var t=!1;return this.props.doNotContainWithinFocusZone?this._divContainer.current&&(t=Object(u.c)(this._divContainer.current)):this._focusZone.current&&(t=this._focusZone.current.focus(e)),t},t.prototype.focusElement=function(e){var t=!1;return!!e&&(this.props.doNotContainWithinFocusZone?this._divContainer.current&&Object(l.a)(this._divContainer.current,e)&&(e.focus(),t=document.activeElement===e):this._focusZone.current&&(t=this._focusZone.current.focusElement(e)),t)},t.prototype.componentDidMount=function(){this._registerPersistedKeytips()},t.prototype.componentWillUnmount=function(){this._unregisterPersistedKeytips()},t.prototype.componentWillUpdate=function(){this._unregisterPersistedKeytips()},t.prototype.componentDidUpdate=function(){this._registerPersistedKeytips()},t.prototype._registerPersistedKeytips=function(){var e=this;Object.keys(this._persistedKeytips).forEach(function(t){var n=e._persistedKeytips[t],r=e._keytipManager.register(n,!0);e._persistedKeytips[r]=n,delete e._persistedKeytips[t]})},t.prototype._unregisterPersistedKeytips=function(){var e=this;Object.keys(this._persistedKeytips).forEach(function(t){e._keytipManager.unregister(e._persistedKeytips[t],t,!0)}),this._persistedKeytips={}},t.prototype._getSubMenuForItem=function(e){return this.props.itemSubMenuProvider?this.props.itemSubMenuProvider(e):e.subMenuProps?e.subMenuProps.items:void 0},t.defaultProps={vertical:!1,role:"menubar"},t}(d.a)},133:function(e,t,n){"use strict";n.d(t,"f",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"e",function(){return a}),n.d(t,"g",function(){return s}),n.d(t,"h",function(){return c}),n.d(t,"b",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"d",function(){return d});var r=n(1),o=Object(r.action)("SET_MAILBOX_DATA",function(e,t,n){return{mailboxId:e,folderValue:t,loadingState:n}}),i=Object(r.action)("REMOVE_MAILBOX_DATA",function(e){return{mailboxId:e}}),a=Object(r.action)("SET_LOADING_STATE_FOR_MAILBOX",function(e,t){return{mailboxId:e,loadingState:t}}),s=Object(r.action)("SET_ROOT_FOLDER_DISPLAY_NAME_FOR_MAILBOX",function(e,t){return{mailboxId:e,displayName:t}}),c=Object(r.action)("UPDATE_FOLDER_TABLE",function(e,t,n){return{folder:e,treeType:t,principalSMTPAddress:n}}),u=Object(r.action)("FETCH_ARCHIVE_DUMPSTER_FOLDER"),l=Object(r.action)("ADD_SHARED_FOLDER_USER_EMAIL",function(e){return{principalSMTPAddress:e}}),d=Object(r.action)("REMOVE_SHARED_FOLDER_USER_EMAIL",function(e){return{principalSMTPAddress:e}})},1330:function(e,t,n){"use strict";var r=n(1312),o=Math.max;t.a=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,s=o(i.length-t,0),c=Array(s);++a<s;)c[a]=i[t+a];a=-1;for(var u=Array(t+1);++a<t;)u[a]=i[a];return u[t]=n(c),Object(r.a)(e,this,u)}}},1331:function(e,t,n){"use strict";var r=800,o=16,i=Date.now;t.a=function(e){var t=0,n=0;return function(){var a=i(),s=o-(a-n);if(n=a,s>0){if(++t>=r)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},1335:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(2),o=n(70),i=n(389),a=0;function s(e){var t=document.createElement("div");t.id="owa-modal-"+a++,document.body.appendChild(t);var n,s=!1,c=function(){s||(s=!0,o.unmountComponentAtNode(t),document.body.removeChild(t))};return[new Promise(function(a,s){n=s,o.render(r.createElement(i.a,{child:r.createElement(e,{onDismiss:function(e){c(),a(e)}}),type:i.b.None,onError:function(){c(),s()}}),t)}),function(){c(),n()}]}},1336:function(e,t,n){var r=n(1337),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1337:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,"._3k2DZQclSrOtYR-5XBK9RP{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={view:"_3k2DZQclSrOtYR-5XBK9RP"}},1338:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},1339:function(e,t,n){"use strict";var r=n(0),o=n(1),i=n(9),a=n(66),s=n(564),c=n(5),u=Object(o.action)("POPULATE_PUBLIC_FOLDER_OUTLOOK_FAVORITE_STORE"),l=n(29),d=n(1177),f=n.n(d),p=n(108),m=n.n(p),g=n(1178),v=n.n(g),h=n(648),y=n.n(h),b=n(57),_=n.n(b),S=n(156);function C(e){return{headers:Object(S.e)(e)}}function O(e){var t=[];e.forEach(function(e){t.push(m()({Id:e}))});var n=Object(i.a)().SessionSettings.DefaultPublicFolderMailbox;return 0!==t.length&&n?f()({Header:Object(l.getJsonRequestHeader)(),Body:v()({FolderShape:y()({BaseShape:"AllProperties",AdditionalProperties:[_()({FieldURI:"ReplicaList"})]}),FolderIds:t})},C(n)).then(function(e){return e.Body.ResponseMessages}).catch(function(){return null}):null}var I=n(1167),A=n(659);Object(o.orchestrator)(a.loadFavorites,function(){return r.__awaiter(void 0,void 0,void 0,function(){var e,t,n;return r.__generator(this,function(r){switch(r.label){case 0:return Object(c.d)("tri-favorites-roaming")&&Object(c.d)("pf-favorite")?(e=[],(t=Object(i.a)().Favorites?Object(i.a)().Favorites.value:null)?(t.forEach(function(t){var n=Object(s.b)(t,"IsPublicFolder");n&&"true"===n.toLowerCase()&&e.push(Object(s.b)(t,"FolderId"))}),[4,O(e)]):[2]):[2];case 1:return(n=r.sent())&&(n.Items.forEach(function(e){e.Folders.forEach(function(e){null!=e&&Object(I.a)(A.a,e)})}),u()),[2]}})})}),Object(o.orchestrator)(u,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var e;return r.__generator(this,function(t){return(e=Object(i.a)().Favorites?Object(i.a)().Favorites.value:null)?(e.forEach(function(e){var t=Object(a.getSingleValueSettingValueForKey)(e,"IsPublicFolder");"folder"===e.Type.toLowerCase()&&t&&"true"===t.toLowerCase()&&function(e){(function(e){if(0===A.a.folderTable.size)return!1;return!a.favoritesStore.outlookFavorites.has(e.favoriteId)&&A.a.folderTable.has(e.publicFolderId)})(e)&&Object(a.addFavoriteToStoreInitial)(e)}({treeType:"favorites",favoriteId:e.Id,type:"publicFolder",displayName:e.DisplayName,publicFolderId:Object(a.getSingleValueSettingValueForKey)(e,"FolderId"),client:e.Client,lastModifiedTime:e.LastModifiedTime})}),[2]):[2]})})});var T=n(1722),E=(Object(o.mutator)(I.a,function(e){var t=e.state,n=e.item,o=n.FolderId.Id;if(!t.folderTable.has(o)){var i=n.DistinguishedFolderId?n.DistinguishedFolderId:void 0,a=r.__assign({childFolderIds:[],distinguishedFolderId:i,UnreadCount:n.UnreadCount,TotalCount:n.TotalCount,isHidden:Object(T.b)(n),sourceWellKnownFolderType:Object(T.c)(n),ReplicaList:n.ReplicaList},n);t.folderTable.set(o,a)}}),n(1488));Object(o.mutator)(E.a,function(e){var t=e.folderId;A.a.folderTable.has(t)&&A.a.folderTable.delete(t)});n.d(t,"a",function(){return C}),n.d(t,"b",function(){return A.a})},1357:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(1714);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetItem",e,t)}},1358:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetItemRequest:#Exchange"},e)}},1365:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindConversationRequest:#Exchange"},e)}},1366:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(1713);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("FindConversation",e,t)}},1367:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConversationRequestType:#Exchange"},e)}},1368:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetConversationItemsRequest:#Exchange"},e)}},1369:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(1019);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetConversationItems",e,t)}},1370:function(e){e.exports={a:"jaa"}},1373:function(e){e.exports={b:"haa",a:"iaa"}},1401:function(e,t,n){"use strict";var r=n(637),o=n(1328),i={flexShrink:0,display:"inherit"};n.d(t,"a",function(){return a});var a=Object(r.a)(o.a,function(e){var t=e.className;return{root:["ms-OverflowSet",{position:"relative",display:"flex",flexWrap:"nowrap"},e.vertical&&{flexDirection:"column"},t],item:["ms-OverflowSet-item",i],overflowButton:["ms-OverflowSet-overflowButton",i]}},void 0,{scope:"OverflowSet"})},1452:function(e,t,n){"use strict";var r=n(0),o=n(2),i=n(338),a=n(131),s=n(801),c=n(14),u=n(333),l=n(339),d=n(435),f=n(881),p=Object(u.b)(function(e,t,n){var r=Object(l.a)(e),o=Object(d.a)(e),i={root:{minWidth:"80px",height:"32px"},label:{fontWeight:c.FontWeights.semibold}};return Object(c.concatStyleSets)(r,i,n?Object(f.a)(e):Object(f.b)(e),o,t)});n.d(t,"a",function(){return m});var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._skipComponentRefResolution=!0,t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.primary,n=void 0!==t&&t,s=e.styles,c=e.theme;return o.createElement(i.a,r.__assign({},this.props,{variantClassName:n?"ms-Button--primary":"ms-Button--default",styles:p(c,s,n),onRenderDescription:a.b}))},t=r.__decorate([Object(s.a)("DefaultButton",["theme","styles"],!0)],t)}(a.a)},1456:function(e,t,n){"use strict";var r;!function(e){e[e.PrimaryReadingPane=0]="PrimaryReadingPane",e[e.SecondaryTab=1]="SecondaryTab",e[e.Popout=2]="Popout",e[e.SxS=3]="SxS"}(r||(r={})),t.a=r},1462:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s});var r=n(3),o=new r.c(function(){return n.e(343).then(n.bind(null,3034))}),i=new r.a(o,function(e){return e.subscribe}),a=new r.a(o,function(e){return e.unsubscribe}),s=new r.a(o,function(e){return e.trigger});new r.a(o,function(e){return e.removeResizeEventEmitter})},1463:function(e,t,n){"use strict";var r=n(306),o=n(7);t.a=Object(o.action)("setItemReadingPaneViewState")(function(e){r.a.itemReadingPaneViewState=e})},1464:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(27),o=n(33);function i(e){var t=Object(r.f)(),n=1==t.PolicySettings.MessagePreviewsDisabled;return t.UserOptions.ShowReadingPaneOnFirstLoad&&!n&&e.tableQuery.folderId!==Object(o.a)("junkemail")}},1465:function(e,t,n){"use strict";var r=n(306),o=n(7);t.a=Object(o.action)("setItemPrintPaneViewState")(function(e){r.a.itemPrintPaneViewState=e})},147:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.CommandBarArrows=1]="CommandBarArrows",e[e.KeyboardUpDown=2]="KeyboardUpDown",e[e.KeyboardEnter=3]="KeyboardEnter",e[e.KeyboardShiftEnter=4]="KeyboardShiftEnter",e[e.MailListItemBody=5]="MailListItemBody",e[e.MailListItemBodyDoubleClick=6]="MailListItemBodyDoubleClick",e[e.MailListItemCheckbox=7]="MailListItemCheckbox",e[e.MailListItemContextMenu=8]="MailListItemContextMenu",e[e.MailListItemExpansion=9]="MailListItemExpansion",e[e.MailListItemRichPreview=10]="MailListItemRichPreview",e[e.MailListItemTwisty=11]="MailListItemTwisty",e[e.NewConversation=12]="NewConversation",e[e.Reset=13]="Reset",e[e.RowRemoval=14]="RowRemoval",e[e.ImmersiveReadingPaneDelete=15]="ImmersiveReadingPaneDelete",e[e.RouteHandler=16]="RouteHandler",e[e.ToggleCheckAll=17]="ToggleCheckAll",e[e.MessageAd=18]="MessageAd",e[e.SearchSuggestionClick=19]="SearchSuggestionClick",e[e.SingleLineClearSelection=20]="SingleLineClearSelection",e[e.KeyboardHome=21]="KeyboardHome"}(r||(r={})),t.a=r},148:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"f",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"g",function(){return r});var r,o="ktp",i="-",a="data-ktp-target",s="data-ktp-execute-target",c="ktp-layer-id",u=", ";!function(e){e.KEYTIP_ADDED="keytipAdded",e.KEYTIP_REMOVED="keytipRemoved",e.KEYTIP_UPDATED="keytipUpdated",e.PERSISTED_KEYTIP_ADDED="persistedKeytipAdded",e.PERSISTED_KEYTIP_REMOVED="persistedKeytipRemoved",e.PERSISTED_KEYTIP_EXECUTE="persistedKeytipExecute",e.ENTER_KEYTIP_MODE="enterKeytipMode",e.EXIT_KEYTIP_MODE="exitKeytipMode"}(r||(r={}))},1482:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(993);function o(e){return Object(r.a)().attachments.get(e.Id)}},1484:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(135);function o(e,t,n){var o={pathname:e+t,search:n};return r.format(o)}},1488:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("REMOVE_FAVORITE_FROM_PUBLIC_FOLDER_STORE",function(e){return{folderId:e}})},1489:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=/\([^)]*\)|[\0-\u001F\!-\/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,o=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,i=/\s+/g,a=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function s(e,t,n){return e?(e=function(e){return e=(e=(e=e.replace(r,"")).replace(i," ")).trim()}(e),a.test(e)||!n&&o.test(e)?"":function(e,t){var n="",r=e.split(" ");return 2===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[1].charAt(0).toUpperCase()):3===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[2].charAt(0).toUpperCase()):0!==r.length&&(n+=r[0].charAt(0).toUpperCase()),t&&n.length>1?n.charAt(1)+n.charAt(0):n}(e,t)):""}},149:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"g",function(){return i}),n.d(t,"f",function(){return a}),n.d(t,"i",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"k",function(){return u}),n.d(t,"h",function(){return l}),n.d(t,"j",function(){return d}),n.d(t,"c",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"d",function(){return m}),n.d(t,"l",function(){return g}),n.d(t,"n",function(){return v}),n.d(t,"o",function(){return h}),n.d(t,"m",function(){return y});var r=n(1),o=Object(r.action)("GET_ARCHIVE_FOLDERS",function(e){return{source:e}}),i=Object(r.action)("GET_SHARED_FOLDERS",function(e,t){return{principalSMTPAddress:e,actionSource:t}}),a=Object(r.action)("GET_PRIMARY_MAIL_FOLDERS"),s=Object(r.action)("INITIALIZE_SHARED_FOLDER_ROOTS"),c=Object(r.action)("ADD_SHARED_FOLDER_USER",function(e,t,n){return{displayName:e,principalSMTPAddress:t,skipServerValidation:n}}),u=Object(r.action)("REMOVE_SHARED_FOLDER_USER",function(e){return{principalSMTPAddress:e}}),l=Object(r.action)("INITIALIZE_ARCHIVE_MAILBOX_FROM_SESSIONDATA"),d=Object(r.action)("ON_SHARED_FOLDER_FETCH_FAILED",function(e,t){return{principalSMTPAddress:e,actionSource:t}}),f=Object(r.action)("GET_FOLDER_PERMISSIONS",function(e){return{folderId:e}}),p=Object(r.action)("GET_FOLDER_PERMISSIONS_SUCCESS"),m=Object(r.action)("GET_FOLDER_PERMISSIONS_FAILED"),g=Object(r.action)("UPDATE_FOLDER_PERMISSIONS",function(e,t){return{folderId:e,permissions:t}}),v=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_IN_STORE",function(e,t){return{folderId:e,permissions:t}}),h=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_SUCCESS"),y=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_FAILED")},1493:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindFolderJsonRequest:#Exchange"},e)}},1494:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateFolderJsonRequest:#Exchange"},e)}},1498:function(e,t,n){var r=n(1505),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1499:function(e,t,n){"use strict";t.a={MigrateOutlookFavorites:{name:"MigrateOutlookFavorites",options:{isCore:!0}},UpdateFavoriteNode:{name:"UpdateFavoriteNode"}}},150:function(e,t,n){"use strict";var r;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.ErrorLoading=3]="ErrorLoading"}(r||(r={})),t.a=r},1500:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(66);function o(e){return Object(r.getStore)().favoriteSecondaryKeyMap.get(e.toLowerCase())}},1501:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(66);function o(e){return Object(r.getStore)().favoriteSecondaryKeyMap.get(e)}},1502:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(66);function o(e){return Object(r.getStore)().favoriteSecondaryKeyMap.get(e)}},1503:function(e,t,n){var r=n(1504),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1504:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,"._2xN9TZyXtoJZK5Lfq0Po_e,._2v87oa5v-Mz3PJsIueKiP6,._3Syrcsld5EhJ0NsexwVKCW{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;height:18px;max-width:120px;white-space:nowrap}html[dir] ._2xN9TZyXtoJZK5Lfq0Po_e,html[dir] ._2v87oa5v-Mz3PJsIueKiP6,html[dir] ._3Syrcsld5EhJ0NsexwVKCW{border-radius:2px;border-style:solid;border-width:1px}html[dir=ltr] ._2xN9TZyXtoJZK5Lfq0Po_e{margin-right:4px}html[dir=rtl] ._2xN9TZyXtoJZK5Lfq0Po_e{margin-left:4px}html[dir=ltr] ._3Syrcsld5EhJ0NsexwVKCW{margin-right:0}html[dir=rtl] ._3Syrcsld5EhJ0NsexwVKCW{margin-left:0}.GW-PnOYWKlba0TwtiRFoK{font-size:12px;font-weight:400;max-width:120px;overflow:hidden;text-overflow:ellipsis}html[dir] .GW-PnOYWKlba0TwtiRFoK{padding-bottom:2px}html[dir=ltr] .GW-PnOYWKlba0TwtiRFoK,html[dir=rtl] .GW-PnOYWKlba0TwtiRFoK{padding-right:4px;padding-left:4px}",""]),t.locals={categoryContainer:"_2xN9TZyXtoJZK5Lfq0Po_e",categoryContainerCommon:"_2v87oa5v-Mz3PJsIueKiP6",lastCategoryContainer:"_3Syrcsld5EhJ0NsexwVKCW",categoryName:"GW-PnOYWKlba0TwtiRFoK"}},1505:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'._2kCQT6MB5_ciDBfmlahChZ,.U7Gk9De8iKmHbkm7yRKUi,._1R8RsMhw4NgarPrp9w-LuY,._27QPbqxlZl9xhwFG2o1f9j{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}html[dir] ._2kCQT6MB5_ciDBfmlahChZ,html[dir] .U7Gk9De8iKmHbkm7yRKUi{text-shadow:0 0 "[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir] ._2ZONbTJ1vjt_e8X3T-FfOq{background:"[theme:neutralLighter, default:#f4f4f4]";border-radius:2px}._2CP3CWoR2T-whUwrloRp36{max-height:436px}._27I6XJWqHRNBnDYFfaOdqE{height:1px}html[dir] ._27I6XJWqHRNBnDYFfaOdqE{background:"[theme:neutralLight, default:#eaeaea]"}._1JKSMSnciWpk_DdBL9ABA0,._38BrVm9yk4hktk5ds-KGK-,._2N_5vz72xINnOToaVxpmYf{-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;display:-webkit-box;display:-ms-flexbox;display:flex;height:36px;line-height:36px}html[dir=ltr] ._1JKSMSnciWpk_DdBL9ABA0,html[dir=ltr] ._2N_5vz72xINnOToaVxpmYf{padding-right:12px}html[dir=rtl] ._1JKSMSnciWpk_DdBL9ABA0,html[dir=rtl] ._2N_5vz72xINnOToaVxpmYf{padding-left:12px}html[dir] ._1JKSMSnciWpk_DdBL9ABA0:focus,html[dir] ._1JKSMSnciWpk_DdBL9ABA0:hover,html[dir] ._3hgYQspFd3X6KJpcIgElcM{background-color:"[theme:neutralLight, default:#eaeaea]"}._1PzxITqqigmAxO-1txMTm{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.y_h1EbemT9wxf3AbfREF8,.aUpBmswsgPIK5dQcq9pTk{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;white-space:pre}.y_h1EbemT9wxf3AbfREF8{font-weight:600;color:"[theme:black, default:#000000]"}html[dir] .U7Gk9De8iKmHbkm7yRKUi{margin:0 8px}._3qsCA5lyQ5jizrrRWlU7Qo{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:100%}html[dir=ltr] ._3qsCA5lyQ5jizrrRWlU7Qo{padding-left:30px}html[dir=rtl] ._3qsCA5lyQ5jizrrRWlU7Qo{padding-right:30px}.DHS7kW8zBvT3x35m4_WRg{color:"[theme:neutralTertiary, default:#a6a6a6]";cursor:default}',""]),t.locals={categoryIcon:"_2kCQT6MB5_ciDBfmlahChZ",categoryIconInMenu:"U7Gk9De8iKmHbkm7yRKUi",checkMarkIcon:"_1R8RsMhw4NgarPrp9w-LuY",iconCommon:"_27QPbqxlZl9xhwFG2o1f9j",colorPickerContainerDiscoverable:"_2ZONbTJ1vjt_e8X3T-FfOq",categoryMenu:"_2CP3CWoR2T-whUwrloRp36",categoryMenuDivider:"_27I6XJWqHRNBnDYFfaOdqE",categoryMenuItemContainer:"_1JKSMSnciWpk_DdBL9ABA0",categoryMenuItemContainerCommon:"_38BrVm9yk4hktk5ds-KGK-",categoryMenuItemContainerCommonWithRightPadding:"_2N_5vz72xINnOToaVxpmYf",highlightItem:"_3hgYQspFd3X6KJpcIgElcM",categoryName:"_1PzxITqqigmAxO-1txMTm",categoryMatchSuggestion:"y_h1EbemT9wxf3AbfREF8",categorySuggestion:"aUpBmswsgPIK5dQcq9pTk",extendedMenuItems:"_3qsCA5lyQ5jizrrRWlU7Qo",disabled:"DHS7kW8zBvT3x35m4_WRg"}},1506:function(e,t,n){var r=n(1507),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1507:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'._2M8TVBbslPgWkh2hGNLO1M,._302xqwk9__qzbNjPveq62u{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}html[dir] ._2M8TVBbslPgWkh2hGNLO1M{text-shadow:0 0 "[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir] ._3pU5O3vlMDNrqZI28FuKu2{background:"[theme:neutralLighter, default:#f4f4f4]";border-radius:2px}',""]),t.locals={categoryIcon:"_2M8TVBbslPgWkh2hGNLO1M",iconCommon:"_302xqwk9__qzbNjPveq62u",colorPickerContainerDiscoverable:"_3pU5O3vlMDNrqZI28FuKu2"}},1513:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ExtendedPropertyType:#Exchange"},e)}},1514:function(e,t,n){"use strict";function r(e){return!!e&&(!!e.LocationUri||!(!e.Latitude||!e.Longitude))}n.d(t,"a",function(){return r})},1516:function(e,t,n){"use strict";function r(e,t){if(e.length!==t.length)return!1;var n=e.map(function(e){return e.emailAddress.toLocaleLowerCase()}),r=t.map(function(e){return e.emailAddress.toLocaleLowerCase()});return n.filter(function(e){return r.includes(e)}).length===n.length}n.d(t,"a",function(){return r})},152:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.Compose=3]="Compose",e[e.FloatingChat=4]="FloatingChat"}(r||(r={}))},1520:function(e,t,n){"use strict";var r=n(13),o=n(21);function i(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(o.M)(e.tableQuery.folderId)}function a(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(o.M)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var s=n(1),c=n(1339),u=n(9),l=n(8),d=Object(s.createStore)("publicFolderUtilsStore",new l.ObservableMap);function f(e){if(!d().has(e)){var t=c.b.folderTable.get(e),n={type:null,deprecatedMailboxId:e,primarySmtpAddress:t.principalSMTPAddress,routingKey:"AAD-SMTP:"+t.principalSMTPAddress,returnModernConversationItems:null,requestOptions:Object(c.a)(null!=t.ReplicaList?t.ReplicaList[0]:Object(u.a)().SessionSettings.DefaultPublicFolderMailbox)};p(e,n)}return d().get(e)}var p=Object(s.mutatorAction)("addPublicFolderMailboxInfoToStore",function(e,t){d().set(e,t)});n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return f})},1539:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(888),o=n(110);function i(e){var t=o.a.favoriteSecondaryKeyMap,n=o.a.orderedOutlookFavoritesIds,i=o.a.outlookFavorites;o.a.orderedOutlookFavoritesIds=n.filter(function(t){return t!==e.favoriteId}),i.delete(e.favoriteId),t.delete(Object(r.a)(e))}},1540:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a});var r=n(110),o=n(888);function i(e){r.a.favoritingInProgressMap.set(Object(o.a)(e),!0)}function a(e){r.a.favoritingInProgressMap.delete(Object(o.a)(e))}},1552:function(e){e.exports={a:"wHa"}},1553:function(e){e.exports={a:"CHa"}},1572:function(e){e.exports={b:"FHa",a:"GHa",c:"HHa"}},1583:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(9),o=n(5);function i(){var e=Object(r.a)(),t=e&&e.SessionSettings&&e.SessionSettings.IsExplicitLogon;return(Object(o.d)("rp-3SPeopleSuggestions")||Object(o.d)("rp-linkedInPeopleSuggestions"))&&!t&&e.SessionSettings.IsSubstrateSearchServiceAvailable}},1584:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),o=n(2),i=n(58),a=n(146),s=Object(a.a)(),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.as,n=void 0===t?"label":t,a=e.children,c=e.className,u=e.disabled,l=e.styles,d=e.required,f=e.theme,p=s(l,{className:c,disabled:u,required:d,theme:f});return o.createElement(n,r.__assign({},Object(i.f)(this.props,i.e),{className:p.root}),a)},t}(o.Component)},1586:function(e,t,n){"use strict";var r=n(934),o={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function i(e){switch(e?e.toLowerCase():null){case o.ONE_DRIVE_PRO.toLowerCase():return 0;case o.GDRIVE.toLowerCase():return 5;case o.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case o.DROPBOX.toLowerCase():return 2;case o.BOX.toLowerCase():return 3;case o.WOPI_BOX.toLowerCase():return 7;case o.WOPI_EGNYTE.toLowerCase():return 8;case o.MAILBOX.toLowerCase():return 4;case o.FACEBOOK.toLowerCase():return 6;default:return null}}function a(e){return null==e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}function s(e){return null==e?null:{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:e.Thumbnail?e.Thumbnail.Url:"",previewUrl:e.Preview?e.Preview.Url:"",type:e.MimeType}}function c(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var o=e[n],i={fileType:r.a.Local,name:o.name,size:o.size,type:o.type,fileObject:o};t.push(i)}return t}function u(e,t,n){var o=[],i={fileType:r.a.MailItem,name:e,size:n||0,mimeContent:t};return o.push(i),o}var l=n(12);function d(e,t,n){if(e.length!=t.length)return l.c.error("The sizes of subjects and latestItemIds are different"),null;for(var o=[],i=0;i<e.length;i++){var a={fileType:r.a.MailItem,name:e[i],size:n&&n[i]||0,itemId:t[i]};o.push(a)}return o}var f=n(494);function p(e){return e.map(function(e){return{fileType:r.a.Uri,name:e.name,type:Object(f.a)(e.url),size:0,uri:e.url}})}n.d(t,"b",function(){return i}),n.d(t,"e",function(){return c}),n.d(t,"g",function(){return d}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return s}),n.d(t,"h",function(){return p}),n.d(t,"f",function(){return u}),n.d(t,"a",function(){return r.a})},1589:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a});var r=n(1132);function o(e){return e.isDirty||e.toRecipientWell&&e.toRecipientWell.isDirty||e.ccRecipientWell&&e.ccRecipientWell.isDirty||e.bccRecipientWell&&e.bccRecipientWell.isDirty}function i(e){return Object(r.a)(e.toRecipientWell)+Object(r.a)(e.ccRecipientWell)+Object(r.a)(e.bccRecipientWell)}function a(e){return function(e){return!!e.groupId}(e)&&(2==(t=e).operation||t.toRecipientWell.recipients.some(function(e){return e.persona.EmailAddress.EmailAddress.toLowerCase()===t.groupId.toLowerCase()}));var t}},1591:function(e,t,n){"use strict";var r=n(3),o=n(0),i=n(1592),a=n(7),s=Object(a.action)("addSessionMaskedRecipient")(function(e){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(t){return i.a.sessionMaskedRecipients[e]=!0,[2]})})});n.d(t,"b",function(){return u}),n.d(t,"a",function(){return s});var c=new r.c(function(){return n.e(379).then(n.bind(null,11908))}),u=new r.a(c,function(e){return e.execute3SPrimeCall})},1592:function(e,t,n){"use strict";n.d(t,"b",function(){return o});var r=n(1),o=Object(r.createStore)("substratepeoplesuggestions",{sessionMaskedRecipients:[]}),i=o();t.a=i},1593:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(0);function o(e){var t,n,o=[];if(e&&e.recipients)try{for(var i=r.__values(e.recipients),a=i.next();!a.done;a=i.next()){var s=a.value,c=s.persona.EmailAddress;c&&c.ItemId&&"PrivateDL"==c.MailboxType?o.push({Name:c.Name,RoutingType:c.RoutingType,MailboxType:c.MailboxType,ItemId:{Id:c.ItemId.Id,ChangeKey:null},EmailAddressIndex:c.EmailAddressIndex,RelevanceScore:c.RelevanceScore||0}):o.push(s.persona.EmailAddress)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o}},1594:function(e,t,n){"use strict";var r=n(643),o=n(740),i=n(1092),a=n(216);t.a=function(e,t,n){if(!Object(a.a)(n))return!1;var s=typeof t;return!!("number"==s?Object(o.a)(n)&&Object(i.a)(t,n.length):"string"==s&&t in n)&&Object(r.a)(n[t],e)}},1596:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1),o=Object(r.action)("REFRESH_SHARING_TIPS_FOR_ATTACHMENT",function(e){return{attachmentId:e}})},1597:function(e,t,n){"use strict";var r=n(230),o=n.n(r),i=n(7);function a(e){e&&(e.isDirty=!1)}t.a=Object(i.action)("updateComposeItemId")(function(e,t,n,r){e&&(e.itemId?e.itemId.ChangeKey=n:e.itemId=o()({Id:t,ChangeKey:n}),r&&(e.lastSaveTimeStamp=r,e.isDirty=!1,a(e.toRecipientWell),a(e.ccRecipientWell),a(e.bccRecipientWell)))})},1598:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),o=n(1623);function i(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,o.c.import()];case 1:return t=n.sent(),e&&t(e.referenceItemId&&e.referenceItemId.Id),[2]}})})}},1599:function(e,t,n){"use strict";var r=n(637),o=n(1584),i=n(14);n.d(t,"a",function(){return a});var a=Object(r.a)(o.a,function(e){var t,n=e.theme,r=e.className,o=e.disabled,a=e.required;return{root:["ms-Label",n.fonts.medium,{color:n.semanticColors.bodyText,boxSizing:"border-box",boxShadow:"none",margin:0,display:"block",padding:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},o&&{color:n.semanticColors.disabledBodyText,selectors:(t={},t[i.HighContrastSelector]={color:"GrayText"},t)},a&&{selectors:{"::after":{content:"' *'",color:n.semanticColors.errorText,paddingRight:12}}},r]}},void 0,{scope:"Label"})},1600:function(e,t,n){"use strict";var r=n(1),o=Object(r.createStore)("MRUAttachmentStore",{attachments:[]});t.a=o},1602:function(e,t,n){"use strict";var r=n(1303),o=n(1594);t.a=function(e){return Object(r.a)(function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,s&&Object(o.a)(n[0],n[1],s)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var c=n[r];c&&e(t,c,r,a)}return t})}},1603:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1),o=Object(r.action)("messageBeingSent")},1604:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),o=n(805),i=n(321),a=n(318);function s(e,t){var n,s,c=Object(o.b)();try{for(var u=r.__values(Object(a.a)().tabs),l=u.next();!l.done;l=u.next()){var d=l.value;if(d.type==i.a.Compose&&!d.isShown){var f=c.viewStates.get(d.data);if(f&&f.isInlineCompose&&f.conversationId==e&&(0==f.asyncSendState||t&&6==f.asyncSendState))return f}}}catch(e){n={error:e}}finally{try{l&&!l.done&&(s=u.return)&&s.call(u)}finally{if(n)throw n.error}}return null}},1605:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("onInlineComposeSendStateChange",function(e,t){return{viewState:e,isSendPending:t}})},1606:function(e,t,n){"use strict";var r=n(384),o=n(1137),i=n(340),a="[object Object]",s=Function.prototype,c=Object.prototype,u=s.toString,l=c.hasOwnProperty,d=u.call(Object);t.a=function(e){if(!Object(i.a)(e)||Object(r.a)(e)!=a)return!1;var t=Object(o.a)(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&u.call(n)==d}},1608:function(e,t,n){"use strict";var r=n(1601),o=n(1077);t.a=function(e){return Object(r.a)(e,Object(o.a)(e))}},1609:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(1e3),o=n(1001),i=n(1639),a=n(4),s=n(665),c=n(250);function u(e,t,n,u){if(1===n)return Object(a.a)(i.a);if(Object(c.a)()&&0!==t)return Object(s.a)(t).displayText;switch(e){case 0:return Object(a.a)(o.a);case 1:return Object(a.a)(r.a)}return u}},1613:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(5);function o(e,t){switch(e.tableQuery.type){case 0:return Object(r.d)("tri-triageFolderScope")&&t?e.tableQuery.folderId:e.serverFolderId;case 1:case 2:default:return null}}},1614:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(72),o=n(509);function i(e,t){var n=r.a.tableViews.get(t),i=[];return e.forEach(function(e){var t=Object(o.getRowIdString)(e,n);-1==i.indexOf(t)&&i.push(t)}),i}},1615:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(298);function o(e,t,n,o){for(var i=[],a=new Map,s=0;s<e.length;s++){var c=e[s],u=Object(r.a)(c,t),l=u.id;!a.get(l)&&n(u,o)&&(i.push(c),a.set(l,!0))}return i}},1623:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s});var r=n(3),o=n(1600);n.d(t,"a",function(){return o.a});var i=new r.c(function(){return n.e(106).then(n.bind(null,2569))}),a=new r.b(i,function(e){return e.getAttachmentSuggestionsAction}),s=new r.b(i,function(e){return e.createCloudFileFromAttachmentData})},1624:function(e,t,n){"use strict";var r=n(1629),o=Object(r.a)();t.a=o},1626:function(e,t,n){"use strict";var r=n(1616),o=n(814),i=n(643);var a=function(e,t,n){(void 0===n||Object(i.a)(e[t],n))&&(void 0!==n||t in e)||Object(o.a)(e,t,n)},s=n(1624),c=n(1645),u=n(1646),l=n(1610),d=n(1647),f=n(952),p=n(879),m=n(1311),g=n(1085),v=n(656),h=n(216),y=n(1606),b=n(1091),_=n(1608);var S=function(e,t,n,r,o,i,s){var S=e[n],C=t[n],O=s.get(C);if(O)a(e,n,O);else{var I=i?i(S,C,n+"",e,t,s):void 0,A=void 0===I;if(A){var T=Object(p.a)(C),E=!T&&Object(g.a)(C),x=!T&&!E&&Object(b.a)(C);I=C,T||E||x?Object(p.a)(S)?I=S:Object(m.a)(S)?I=Object(l.a)(S):E?(A=!1,I=Object(c.a)(C,!0)):x?(A=!1,I=Object(u.a)(C,!0)):I=[]:Object(y.a)(C)||Object(f.a)(C)?(I=S,Object(f.a)(S)?I=Object(_.a)(S):(!Object(h.a)(S)||r&&Object(v.a)(S))&&(I=Object(d.a)(C))):A=!1}A&&(s.set(C,I),o(I,C,r,i,s),s.delete(C)),a(e,n,I)}},C=n(1077);t.a=function e(t,n,o,i,c){t!==n&&Object(s.a)(n,function(s,u){if(Object(h.a)(s))c||(c=new r.a),S(t,n,u,o,e,i,c);else{var l=i?i(t[u],s,u+"",t,n,c):void 0;void 0===l&&(l=s),a(t,u,l)}},C.a)}},1629:function(e,t,n){"use strict";t.a=function(e){return function(t,n,r){for(var o=-1,i=Object(t),a=r(t),s=a.length;s--;){var c=a[e?s:++o];if(!1===n(i[c],c,i))break}return t}}},1633:function(e,t,n){"use strict";var r=n(0),o=n(1300);function i(e){return Object(o.a)(e.EmailAddress)||e.ItemId&&"PrivateDL"==e.MailboxType}var a=n(286),s=n(2291),c=n(2142);function u(e,t){var n,o,u={queryString:"",recipients:[],isDirty:!1,shouldShowFindResult:!1,shouldShowContactPicker:!1,findResultSet:[],findResultType:s.b.None,findResultHightlightIndex:-1,isSearching:!1,directorySearchType:s.a.None,dropViewState:Object(a.a)(),findPeopleFeedbackManager:e};if(t)try{for(var l=r.__values(t),d=l.next();!d.done;d=l.next()){var f=d.value,p={displayText:f.Name,persona:{EmailAddress:f,PersonaId:f.ItemId},isContextMenuOpen:!1,isValid:i(f),isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1,expansionStatus:c.a.None,members:[]};u.recipients.push(p)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}return u}n.d(t,"a",function(){return u})},1634:function(e,t,n){"use strict";var r=n(812),o=n(7),i=n(318);t.a=Object(o.action)("setTabIsShown")(function(e,t){if(e.isShown!=t&&(e.isShown=t,e.blink=t,e.isActive&&!t)){var n=Object(i.a)(),o=n.tabs.indexOf(e),a=n.tabs.filter(function(t){return t.id==e.parentTabId&&t.isShown})[0]||function(e,t){t<0&&(t=0);for(var n=t;n<e.length;n++)if(e[n].isShown)return e[n];for(n=t-1;n>=0;n--)if(e[n].isShown)return e[n];return null}(n.tabs,o);a&&Object(r.a)(a)}})},1635:function(e,t,n){"use strict";var r=n(815),o=n(812),i=n(1100),a=n(808),s=n(152),c=n(26),u=n(318),l=1;t.a=Object(c.b)("addTab",i.a.TabViewAddTab)(function(e,t,n,i){var c=Object(a.a)(),d=Object(u.a)(),f={id:s.a[e]+(l++).toString(),isShown:t,isActive:!1,startTime:(new Date).getTime(),parentTabId:c?c.id:null,blink:t,data:i},p=null;switch(e){case s.a.Primary:p=Object(r.a)(f,{type:s.a.Primary});break;case s.a.OverflowMenu:p=Object(r.a)(f,{type:s.a.OverflowMenu,data:i});break;case s.a.SecondaryReadingPane:p=Object(r.a)(f,{type:s.a.SecondaryReadingPane,data:i});break;case s.a.Compose:p=Object(r.a)(f,{type:s.a.Compose,data:i});break;case s.a.FloatingChat:p=Object(r.a)(f,{type:s.a.FloatingChat,data:i,isChatActive:!1})}d.tabs.push(p),n&&Object(o.a)(d.tabs[d.tabs.length-1])})},1637:function(e,t,n){"use strict";var r=n(7);t.a=Object(r.action)("toggleChatTab")(function(e){e.isChatActive=!e.isChatActive,e.isActive=e.isChatActive,e.blink=!1})},1638:function(e){e.exports={a:"rqb"}},1639:function(e){e.exports={a:"imb"}},1640:function(e){e.exports={a:"maa"}},1641:function(e){e.exports={a:"laa"}},1642:function(e){e.exports={a:"kaa"}},165:function(e,t,n){"use strict";var r=n(3),o=n(13);function i(){return a(Object(o.C)())}function a(e){return e&&2==e.tableQuery.type?e.tableQuery.folderId:null}function s(){var e=Object(o.C)();return e&&2==e.tableQuery.type}function c(e){return!!e&&(2==e.type||u(e))}function u(e){return!(!e||1!=e.type)&&"Group"==e.searchScope.kind}function l(e){return 2==e.type?e.folderId:u(e)?e.searchScope.groupId:null}function d(){var e=Object(o.C)();return e&&c(e.tableQuery)}n.d(t,"g",function(){return p}),n.d(t,"h",function(){return m}),n.d(t,"m",function(){return g}),n.d(t,"l",function(){return v}),n.d(t,"j",function(){return h}),n.d(t,"i",function(){return y}),n.d(t,"k",function(){return b}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"d",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"b",function(){return l}),n.d(t,"f",function(){return d});var f=new r.c(function(){return Promise.all([n.e(0),n.e(1),n.e(502),n.e(26),n.e(310)]).then(n.bind(null,11844))}),p=new r.b(f,function(e){return e.getGroupDisplayName}),m=new r.b(f,function(e){return e.getGroupDisplayNameFromTableView}),g=new r.b(f,function(e){return e.isPrivateUnjoinedGroup}),v=new r.b(f,function(e){return e.isJoinedGroup}),h=new r.b(f,function(e){return e.getRetentionPolicyTagsForGroup}),y=new r.b(f,function(e){return e.getRetentionPolicyTagListForGroupTableQuery}),b=new r.b(f,function(e){return e.isGroupOwner})},1650:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1),o=Object(r.action)("loadFullBody",function(e){return{viewState:e}})},1651:function(e,t,n){"use strict";var r=n(0),o=n(1130),i=n(306),a=n(73),s=n(7);t.a=Object(s.action)("markConversationsReadInReadingPane")(Object(s.select)({conversations:function(){return a.a.conversations},conversationNodes:function(){return a.a.conversationNodes},items:function(){return a.a.items},loadedConversationId:function(){return i.a.conversationReadingPaneViewState&&i.a.conversationReadingPaneViewState.conversationId}})(function(e,t,n,i){var a=[];e.forEach(function(e){var o,s,c,u;if(i.conversations.has(e)){var l=i.conversations.get(e);try{for(var d=r.__values(l.conversationNodeIds),f=d.next();!f.done;f=d.next()){var p=f.value,m=i.conversationNodes.get(p);if(m){var g=!1;try{for(var v=(c=void 0,r.__values(m.itemIds)),h=v.next();!h.done;h=v.next()){var y=h.value,b=i.items.get(y);!b||b.ConversationId.Id!=e||null!=n&&b.ParentFolderId.Id!=n||(i.loadedConversationId&&i.loadedConversationId.Id==e&&(g=g||b.IsRead&&!t),b.IsRead=t)}}catch(e){c={error:e}}finally{try{h&&!h.done&&(u=v.return)&&u.call(v)}finally{if(c)throw c.error}}g&&a.push(p)}}}catch(e){o={error:e}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(o)throw o.error}}}}),a.length>0&&Object(o.a)(e[0],a)}))},1652:function(e,t,n){"use strict";var r=n(1130),o=n(73),i=n(7);t.a=Object(i.action)("markItemReadInReadingPane")(Object(i.select)({message:function(e){return o.a.items.get(e)}})(function(e,t,n){n.message.IsRead&&!t&&n.message.ConversationId&&Object(r.a)(n.message.ConversationId.Id,[n.message.InternetMessageId]),n.message.IsRead=t}))},1669:function(e){e.exports={a:"z4a"}},1702:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindItemJsonRequest:#Exchange"},e)}},1706:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(1),o=Object(r.action)("ON_CATEGORY_FAVORITED",function(e){return{categoryId:e}}),i=Object(r.action)("ON_CATEGORY_UNFAVORITED",function(e){return{categoryId:e}})},1707:function(e,t,n){"use strict";n.d(t,"b",function(){return p}),n.d(t,"a",function(){return m});var r=n(0),o=n(1),i=n(1959),a=n(275),s=n(739),c=n(1172),u=n(211),l=n(94),d=n(564),f=n(1170);Object(o.orchestrator)(i.a,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,o,i,g,v,h,y;return r.__generator(this,function(r){switch(r.label){case 0:if(t=e.categoryId,n=Object(u.l)().filter(function(e){return e.Id===t})[0],o=Object(l.a)(),i=m(o,n,!1),Object(f.a)(t))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),Object(s.b)(t)?[2]:(Object(a.c)(i),g=p(n,!1),[4,Object(c.a)(g)]);case 2:return v=r.sent(),h=Object(d.a)(v,"category"),Object(a.a)(i,h),[3,4];case 3:return y=r.sent(),Object(a.b)(y,i),[3,4];case 4:return[2]}})})});function p(e,t){return{Type:"category",DisplayName:e.Name,SingleValueSettings:[{Key:"CategoryId",Value:e.Id}],Client:t?"Migration":"OWA"}}function m(e,t,n){return{treeType:"favorites",type:"category",favoriteId:e,displayName:t.Name,categoryId:t.Id,client:n?"Migration":"OWA"}}},1708:function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"b",function(){return l});var r=n(3),o=n(24),i=new r.c(function(){return Promise.all([n.e(0),n.e(1),n.e(3),n.e(469),n.e(120)]).then(n.bind(null,2583))}),a=new r.a(i,function(e){return e.loadCLPUserLabels}),s=new r.b(i,function(e){return e.showJustificationModal}),c=new r.a(i,function(e){return e.loadItemCLPInfo}),u=new r.b(i,function(e){return e.updateItemCLPInfo}),l=new r.b(i,function(e){return e.logReadCLPLabel});Object(o.d)(function(){a.importAndExecute()})},1709:function(e,t,n){"use strict";var r=n(637),o=n(939),i=n(227),a=n(14),s={root:"ms-Spinner",circle:"ms-Spinner-circle",label:"ms-Spinner-label"},c=Object(a.keyframes)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}});n.d(t,"a",function(){return u});var u=Object(r.a)(o.a,function(e){var t,n=e.theme,r=e.size,o=e.className,u=e.labelPosition,l=n.palette,d=Object(a.getGlobalClassNames)(s,n);return{root:[d.root,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},"top"===u&&{flexDirection:"column-reverse"},"right"===u&&{flexDirection:"row"},"left"===u&&{flexDirection:"row-reverse"},o],circle:[d.circle,{boxSizing:"border-box",borderRadius:"50%",border:"1.5px solid "+l.themeLight,borderTopColor:l.themePrimary,animationName:c,animationDuration:"1.3s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.53,.21,.29,.67)",selectors:(t={},t[a.HighContrastSelector]={borderTopColor:"Highlight"},t)},r===i.a.xSmall&&["ms-Spinner--xSmall",{width:12,height:12}],r===i.a.small&&["ms-Spinner--small",{width:16,height:16}],r===i.a.medium&&["ms-Spinner--medium",{width:20,height:20}],r===i.a.large&&["ms-Spinner--large",{width:28,height:28}]],label:[d.label,{color:l.themePrimary,margin:"10px 0 0",textAlign:"center"},"top"===u&&{margin:"0 0 10px"},"right"===u&&{margin:"0 0 0 10px"},"left"===u&&{margin:"0 10px 0 0"}],screenReaderText:a.hiddenContentStyle}},void 0,{scope:"Spinner"})},1710:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3),o=n(24),i=new r.c(function(){return n.e(295).then(n.bind(null,2571))}),a=new r.a(i,function(e){return e.loadSignatureInUserOptions});Object(o.d)(function(){a.importAndExecute()})},1713:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindConversationJsonRequest:#Exchange"},e)}},1714:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetItemJsonRequest:#Exchange"},e)}},1722:function(e,t,n){"use strict";var r=function(e,t){if(e.ExtendedProperty)for(var n=0;n<e.ExtendedProperty.length;n++){var r=e.ExtendedProperty[n];if(r.ExtendedFieldURI.PropertyTag===t||r.ExtendedFieldURI.PropertyName===t)return JSON.parse(r.Value)}},o=function(e){return r(e,"0x10f4")},i=function(e){return parseInt(r(e,"SourceWellKnownFolderType"),10)};n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return i})},1723:function(e){e.exports={a:"c5a"}},1725:function(e,t,n){"use strict";var r=n(1027),o=n(7),i=Object(o.action)("removeInfoBarMessageInReadingPane")(function(e,t,n){void 0===n&&(n="0");for(var o=0;o<e.infoBarIds.length;o++)if(e.infoBarIds[o]==t){e.infoBarIds.splice(o,1);break}r.b[n]&&(delete r.b[n][t],0===Object.keys(r.b[n]).length&&delete r.b[n])});t.a=i},1726:function(e){e.exports={a:"m5a"}},1728:function(e){e.exports={a:"uFa"}},1732:function(e){e.exports={a:"tFa"}},1733:function(e){e.exports={a:"$4a"}},1734:function(e){e.exports={a:"_4a"}},1751:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAccountInformationRequest:#Exchange"},e)}},1815:function(e,t,n){"use strict";var r=n(345),o=n(1886),i=n(879),a=n(1160),s=1/0,c=r.a?r.a.prototype:void 0,u=c?c.toString:void 0;t.a=function e(t){if("string"==typeof t)return t;if(Object(i.a)(t))return Object(o.a)(t,e)+"";if(Object(a.a)(t))return u?u.call(t):"";var n=t+"";return"0"==n&&1/t==-s?"-0":n}},1817:function(e,t,n){"use strict";n.d(t,"a",function(){return p}),n.d(t,"c",function(){return m}),n.d(t,"b",function(){return g});var r=n(0),o=n(4),i=n(2520),a=n(2529),s=n.n(a),c=n(9),u=n(18),l=n(12),d=Object(i.b)({timeBetweenRetryInMS:function(){return 3e4}}),f=function(){function e(e,t,n){var i=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return r.__awaiter(i,void 0,void 0,function(){function e(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,s()()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),l.c.warn("Unable to get the download token "+e),e;case 3:return[2]}})})}var t,n,o,i,a=this;return r.__generator(this,function(s){switch(s.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,t=0,n=d(function(){return r.__awaiter(a,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return t++,n=this,[4,e()];case 1:return n.downloadToken=r.sent(),this.isRefreshingDownloadToken=!1,[2]}})})}).retriableFunc,o=new u.b("AttachmentRefreshDownloadToken"),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,n()];case 2:return s.sent(),o.addCustomData([t]),o.end(),[3,4];case 3:return i=s.sent(),l.c.warn("Retry to refresh token failed: "+i),o.addCustomData([t]),o.endWithError("ServerError",i),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}})})},this.useDownloadUrlBase=!Object(o.g)(this.downloadUrlBase),this.downloadToken=n,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(c.a)().ApplicationSettings;e.instance=new e(t.DownloadTokenRefreshMinutes,t.DownloadUrlBase,t.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function p(){return f.getInstance().getDownloadToken()}function m(){return f.getInstance().getUseDownloadUrlBase()}function g(){return f.getInstance().getDownloadUrlBase()}},1818:function(e,t,n){"use strict";var r=n(2519);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b});var o=n(1817);n.d(t,"c",function(){return o.a})},1819:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"BodyContentType:#Exchange"},e)}},1821:function(e,t,n){"use strict";var r=n(2528);n(806),n(22),n(1484);n(2135),n(2294);n.d(t,"a",function(){return r.a})},184:function(e,t,n){"use strict";var r=n(85);var o=n(1);n.d(t,"b",function(){return s});var i,a={categoryIdToNameMap:{},categoryMenuViewState:{findText:"",isFocusInSearchBox:!1,newCategoryViewState:null,shouldShowAllCategories:!1},categoryColorPickerViewState:{colorPickerTarget:null,shouldShowColorPicker:!1},colorCodeColorValueMap:((i={})[r.a.None]={primaryColor:"#CCCCCC",secondaryColor:"#A6A6A6",iconColor:"#000000",textColor:"#000000"},i[r.a.Red]={primaryColor:"#fce9ea",secondaryColor:"#F1919A",iconColor:"#E74856",textColor:"#D01B2A"},i[r.a.Orange]={primaryColor:"#fff1e0",secondaryColor:"#ffba66",iconColor:"#FF8C00",textColor:"#A35A00"},i[r.a.Peach]={primaryColor:"#fff5e8",secondaryColor:"#ffcd8f",iconColor:"#FFAB45",textColor:"#A35A00"},i[r.a.YellowLight]={primaryColor:"#fffde0",secondaryColor:"#fff766",iconColor:"#FFF100",textColor:"#7A7400"},i[r.a.GreenLight]={primaryColor:"#e9f9e8",secondaryColor:"#91e38d",iconColor:"#47D041",textColor:"#257E20"},i[r.a.TealLight]={primaryColor:"#e6f8f9",secondaryColor:"#83dde0",iconColor:"#30C6CC",textColor:"#1D797C"},i[r.a.Olive]={primaryColor:"#EEF5E4",secondaryColor:"#abcc7c",iconColor:"#73AA24",textColor:"#527A1A"},i[r.a.BlueSky]={primaryColor:"#e0f7fd",secondaryColor:"#66d7f7",iconColor:"#00BCF2",textColor:"#007899"},i[r.a.PurpleLight]={primaryColor:"#f0ecf6",secondaryColor:"#b7a2d4",iconColor:"#8764B8",textColor:"#7D57B2"},i[r.a.Pink]={primaryColor:"#fef2f7",secondaryColor:"#f8bfd9",iconColor:"#F495BF",textColor:"#D8186E"},i[r.a.SteelLight]={primaryColor:"#f3f5f6",secondaryColor:"#c6ced1",iconColor:"#A0AEB2",textColor:"#5E7373"},i[r.a.SteelGrey]={primaryColor:"#D0E0E2",secondaryColor:"#6693a0",iconColor:"#004B60",textColor:"#004B60"},i[r.a.GreyLight]={primaryColor:"#f6f5f5",secondaryColor:"#d0cecd",iconColor:"#B1ADAB",textColor:"#776E6E"},i[r.a.GreyDark]={primaryColor:"#D4D4D4",secondaryColor:"#9e9c9b",iconColor:"#5D5A58",textColor:"#5D5A58"},i[r.a.Black]={primaryColor:"#969696",secondaryColor:"#666666",iconColor:"#000000",textColor:"#000000"},i[r.a.RedDark]={primaryColor:"#C09BA4",secondaryColor:"#ac6d77",iconColor:"#750B1C",textColor:"#750B1C"},i[r.a.OrangeDark]={primaryColor:"#f9eae2",secondaryColor:"#df9670",iconColor:"#CA5010",textColor:"#B3480F"},i[r.a.BrownMedium]={primaryColor:"#f5ece2",secondaryColor:"#cda16e",iconColor:"#AB620D",textColor:"#9D590B"},i[r.a.YellowDark]={primaryColor:"#f7f3e0",secondaryColor:"#dac466",iconColor:"#C19C00",textColor:"#856A00"},i[r.a.GreenDark]={primaryColor:"#C8DACC",secondaryColor:"#669377",iconColor:"#004B1C",textColor:"#004B1C"},i[r.a.TealDark]={primaryColor:"#CEDCDE",secondaryColor:"#669396",iconColor:"#004B50",textColor:"#004B50"},i[r.a.OliveDark]={primaryColor:"#C3DAC3",secondaryColor:"#6da66d",iconColor:"#0B6A0B",textColor:"#0b6a0b"},i[r.a.BlueDark]={primaryColor:"#A6ACC4",secondaryColor:"#667996",iconColor:"#002050",textColor:"#002050"},i[r.a.PurpleDark]={primaryColor:"#B5ACC8",secondaryColor:"#84729c",iconColor:"#32145A",textColor:"#32145A"},i[r.a.MagentaDark]={primaryColor:"#D1B8D1",secondaryColor:"#9d669d",iconColor:"#5C005C",textColor:"#5C005C"},i),pendingCategoryNamesMap:{}},s=Object(o.createStore)("category",a);t.a=s()},1886:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},1888:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),o=n(2),i=n(146),a=n(131),s=Object(i.a)(),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,r=e.theme;return this._classNames=s(n,{theme:r,className:t}),o.createElement("div",{className:this._classNames.actions},o.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},t.prototype._renderChildrenAsActions=function(){var e=this;return o.Children.map(this.props.children,function(t){return t?o.createElement("span",{className:e._classNames.action},t):null})},t}(a.a)},1891:function(e,t,n){"use strict";var r=n(637),o=n(1888),i=n(14),a={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"};n.d(t,"a",function(){return s});var s=Object(r.a)(o.a,function(e){var t=e.className,n=e.theme,r=Object(i.getGlobalClassNames)(a,n);return{actions:[r.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"20px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},t],action:[r.action],actionsRight:[r.actionsRight,{textAlign:"right",marginRight:"-4px",fontSize:"0",selectors:{$action:{margin:"0 4px"}}}]}},void 0,{scope:"DialogFooter"})},1892:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var r=n(0),o=n(2),i=n(146),a=n(115),s=n(1012),c=n(1897),u=n(317),l=n(1894),d=Object(i.a)(),f={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1},p={type:s.a.normal,className:"",topButtonsProps:[]},m=function(e){function t(t){var n=e.call(this,t)||this;return n._getSubTextId=function(){var e=n.props,t=e.ariaDescribedById,r=e.modalProps,o=e.dialogContentProps,i=e.subText,a=t||r&&r.subtitleAriaId;return a||(a=(i||o&&o.subText)&&n._defaultSubTextId),a},n._getTitleTextId=function(){var e=n.props,t=e.ariaLabelledById,r=e.modalProps,o=e.dialogContentProps,i=e.title,a=t||r&&r.titleAriaId;return a||(a=(i||o&&o.title)&&n._defaultTitleTextId),a},n._id=Object(a.c)("Dialog"),n._defaultTitleTextId=n._id+"-title",n._defaultSubTextId=n._id+"-subText",n}return r.__extends(t,e),t.prototype.render=function(){var e,t,n=this.props,i=n.className,a=n.containerClassName,s=n.contentClassName,u=n.elementToFocusOnDismiss,m=n.firstFocusableSelector,g=n.forceFocusInsideTrap,v=n.styles,h=n.hidden,y=n.ignoreExternalFocusing,b=n.isBlocking,_=n.isClickableOutsideFocusTrap,S=n.isDarkOverlay,C=n.isOpen,O=n.onDismiss,I=n.onDismissed,A=n.onLayerDidMount,T=n.responsiveMode,E=n.subText,x=n.theme,P=n.title,M=n.topButtonsProps,w=n.type,R=n.minWidth,k=n.maxWidth,D=n.modalProps,j=r.__assign({},D?D.layerProps:{onLayerDidMount:A});A&&!j.onLayerDidMount&&(j.onLayerDidMount=A),D&&D.dragOptions&&!D.dragOptions.dragHandleSelector?(e="ms-Dialog-draggable-header",t=r.__assign({},D.dragOptions,{dragHandleSelector:"."+e})):t=D&&D.dragOptions;var N=r.__assign({},f,D,{layerProps:j,dragOptions:t}),F=r.__assign({},p,this.props.dialogContentProps,{draggableHeaderClassName:e}),L=d(v,{theme:x,className:i||N.className,containerClassName:a||N.containerClassName,hidden:h,dialogDefaultMinWidth:R,dialogDefaultMaxWidth:k});return o.createElement(c.a,r.__assign({elementToFocusOnDismiss:u,firstFocusableSelector:m,forceFocusInsideTrap:g,ignoreExternalFocusing:y,isClickableOutsideFocusTrap:_,onDismissed:I,responsiveMode:T},N,{isDarkOverlay:void 0!==S?S:N.isDarkOverlay,isBlocking:void 0!==b?b:N.isBlocking,isOpen:void 0!==C?C:!h,className:L.root,containerClassName:L.main,onDismiss:O||N.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),o.createElement(l.a,r.__assign({titleId:this._defaultTitleTextId,subTextId:this._defaultSubTextId,title:P,subText:E,showCloseButton:void 0!==b?!b:!N.isBlocking,topButtonsProps:M||F.topButtonsProps,type:void 0!==w?w:F.type,onDismiss:O||F.onDismiss,className:s||F.className},F),this.props.children))},t.defaultProps={hidden:!0},t=r.__decorate([u.withResponsiveMode],t)}(o.Component)},1893:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(0),o=n(2),i=n(146),a=n(131),s=n(1012),c=n(1166),u=n(1891),l=n(317),d=Object(i.a)(),f=o.createElement(u.a,null).type,p=function(e){function t(t){return e.call(this,t)||this}return r.__extends(t,e),t.prototype.render=function(){var e,t=this.props,n=t.showCloseButton,i=t.className,a=t.closeButtonAriaLabel,u=t.onDismiss,l=t.subTextId,f=t.subText,p=t.titleId,m=t.title,g=t.type,v=t.styles,h=t.theme,y=t.draggableHeaderClassName,b=d(v,{theme:h,className:i,isLargeHeader:g===s.a.largeHeader,isClose:g===s.a.close,draggableHeaderClassName:y}),_=this._groupChildren();return f&&(e=o.createElement("p",{className:b.subText,id:l},f)),o.createElement("div",{className:b.content},o.createElement("div",{className:b.header},o.createElement("p",{className:b.title,id:p,role:"heading","aria-level":2},m),o.createElement("div",{className:b.topButton},this.props.topButtonsProps.map(function(e,t){return o.createElement(c.a,r.__assign({key:e.uniqueId||t},e))}),(g===s.a.close||n&&g!==s.a.largeHeader)&&o.createElement(c.a,{className:b.button,iconProps:{iconName:"Cancel"},ariaLabel:a,onClick:u}))),o.createElement("div",{className:b.inner},o.createElement("div",{className:b.innerContent},e,_.contents),_.footers))},t.prototype._groupChildren=function(){var e={footers:[],contents:[]};return o.Children.map(this.props.children,function(t){"object"==typeof t&&null!==t&&t.type===f?e.footers.push(t):e.contents.push(t)}),e},t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},t=r.__decorate([l.withResponsiveMode],t)}(a.a)},1894:function(e,t,n){"use strict";var r=n(637),o=n(1893),i=n(14),a={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"};n.d(t,"a",function(){return s});var s=Object(r.a)(o.a,function(e){var t=e.className,n=e.theme,r=e.isLargeHeader,o=e.isClose,s=e.hidden,c=e.isMultiline,u=e.draggableHeaderClassName,l=n.palette,d=n.fonts,f=Object(i.getGlobalClassNames)(a,n);return{content:[r&&f.contentLgHeader,o&&f.close,{flexGrow:1,overflowY:"hidden"},t],subText:[f.subText,r?d.medium:d.small,{margin:"0 0 20px 0",paddingTop:"8px",color:l.neutralPrimary,lineHeight:"1.5",wordWrap:"break-word",fontWeight:i.FontWeights.semilight}],header:[f.header,{position:"relative",width:"100%",boxSizing:"border-box"},r&&[f.headerLg,{backgroundColor:l.themePrimary}],o&&f.close,u&&[u,{cursor:"move"}]],button:[f.button,s&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:l.neutralSecondary,fontSize:"16px"}}}],inner:[f.inner,{padding:c?"0 20px 20px":"0 28px 20px"}],innerContent:[f.content,{position:"relative",width:"100%",selectors:{".ms-Button.ms-Button--compount":{marginBottom:"20px",selectors:{"&:last-child":{marginBottom:"0"}}}}},t],title:[f.title,{color:l.neutralPrimary,margin:"0",padding:"20px 36px 20px 28px"},d.xLarge,r&&[{color:l.white,marginBottom:"8px",padding:"26px 28px 28px"},d.xxLarge],c&&d.xxLarge],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"12px 12px 0 0",selectors:{"> *":{flex:"0 0 auto"}}}]}},void 0,{scope:"DialogContent"})},1897:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(637),o=n(1304),i=n(880),a=Object(r.a)(o.a,i.b,void 0,{scope:"Modal"})},1904:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return s});var r=n(1),o=n(26),i=Object(r.action)("removeFavoriteCompleted",function(e){return Object(o.a)({name:"RemoveFavoriteCompleted",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})}),a=Object(r.action)("removeFavoriteFailed",function(e,t){return Object(o.a)({name:"RemoveFavoriteFailed",customData:{errorMessage:e?e.message:"Undefined error",cV:e?e.correlationVector:"Undefined error",favoriteId:t.favoriteId,favoriteKind:t.type}},{error:e,favoriteData:t,favoriteKind:t.type})}),s=Object(r.action)("removeFavoriteFromStore",function(e){return Object(o.a)({name:"RemoveFavoriteFromStore",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})})},1906:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ItemChange:#Exchange"},e)}},1909:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(75),o=n(954),i=n(955);function a(e){return Object(i.a)(function(){return Object(r.a)(o.a+"/"+e,null,null,!0,null,!0)})}},1912:function(e,t,n){"use strict";var r=n(1173),o=n(139),i=n.n(o),a=n(91),s=n.n(a),c=n(155);var u=n(110),l=n(9),d=n(7);t.a=Object(d.action)("updateFavoritesUserOption")(Object(d.select)({favoritesFolderNodes:function(){return u.a.favoritesFolderNodes},favoritesPersonaNodes:function(){return u.a.favoritesPersonaNodes},favoriteSearches:function(){return u.a.favoriteSearches},favoriteCategories:function(){return u.a.favoriteCategories},orderedFavoritesNodeIds:function(){return u.a.orderedFavoritesNodeIds}})(function(e){var t,n=r.b(e.orderedFavoritesNodeIds,e.favoritesFolderNodes,e.favoritesPersonaNodes,e.favoriteSearches,e.favoriteCategories);return Object(l.a)().UserOptions.FavoriteNodes=n,t=n,Object(c.a)("OWA.UserOptions",[i()({DictionaryKey:s()({Type:"String",Value:["FavoriteNodes"]}),DictionaryValue:s()({Type:"StringArray",Value:t})})]).then(function(e){var t=e.Body.ResponseMessages.Items[0];return"Success"==t.ResponseClass?Promise.resolve():Promise.reject("updateUserConfiguration failed: "+t.ResponseClass)})}))},1913:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SetItemField:#Exchange"},e)}},1916:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"e",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"d",function(){return c});var r=n(663);function o(e){return{id:e.favoriteId,treeType:"favorites",type:5,data:e}}function i(e,t,n,r,o){return{treeType:"favorites",type:"privatedistributionlist",favoriteId:e,displayName:t,members:n,pdlId:r,searchFolderId:void 0,client:"OWA",isSearchFolderPopulated:!1,owsPersonaId:o}}function a(e,t){return{Type:"privatedistributionlist",DisplayName:e,MultiValueSettings:[{Key:"EmailAddresses",Values:t.map(function(e){return e.emailAddress})},{Key:"MemberNames",Values:t.map(function(e){return e.name})}],Client:"OWA"}}function s(e,t,n){return{Type:"privatedistributionlist",DisplayName:e,SingleValueSettings:[{Key:"PdlId",Value:Object(r.a)(t)},{Key:"PersonaId",Value:n}],Client:"OWA"}}function c(e,t){var n={Type:"privatedistributionlist",Client:"OWA"};if(e&&(n.DisplayName=e),t){var r=[{Key:"EmailAddresses",Values:t.map(function(e){return e.emailAddress})},{Key:"MemberNames",Values:t.map(function(e){return e.name})}];n.MultiValueSettings=r}return n}},1917:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(954),o=n(75),i=n(955);function a(e,t){return Object(i.a)(function(){return Object(o.c)(r.a+"/"+e,t,void 0,!0,null,!0)})}},1918:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(0),o=n(1951),i=n(21),a=n(94),s=n(1),c=n(1172),u=n(663),l=n(564),d=n(275),f=n(1170);Object(s.orchestrator)(o.a,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,o,s,u;return r.__generator(this,function(r){return t=e.folderIdToAdd,n=i.n.folderTable.get(t),o=Object(a.a)(),s=function(e,t,n){return{treeType:"favorites",type:"folder",favoriteId:e,displayName:t.DisplayName,folderId:t.FolderId.Id,client:n?"Migration":"OWA"}}(o,n,!1),Object(f.a)(t)?[2]:(Object(d.c)(s),u=p(n,!1),Object(c.a)(u).then(function(e){var t=Object(l.a)(e,"folder");Object(d.a)(s,t)}).catch(function(e){Object(d.b)(e,s)}),[2])})})});function p(e,t){return{Type:"folder",DisplayName:e.DisplayName,SingleValueSettings:[{Key:"FolderId",Value:Object(u.a)(e.FolderId.Id)},{Key:"ChangeKey",Value:e.FolderId.ChangeKey}],Client:t?"Migration":"OWA"}}},1919:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return i});n(66);function r(e){return{id:e.favoriteId,treeType:"favorites",type:1,allEmailAddresses:e.allEmailAddresses,displayName:e.displayName,mainEmailAddress:e.mainEmailAddress,searchFolderId:e.searchFolderId,isSyncUpdateDone:!0,isJustAdded:!1,isSearchFolderPopulated:e.isSearchFolderPopulated,markedForDeletion:!1,dropViewState:null,personaId:e.personaId}}function o(e,t,n){return{treeType:"favorites",type:"persona",favoriteId:e,displayName:t,searchFolderId:void 0,client:"OWA",allEmailAddresses:[n],personaId:void 0,mainEmailAddress:n,isSearchFolderPopulated:!1,isSyncUpdateDone:!0}}function i(e,t){return{Type:"persona",DisplayName:e,SingleValueSettings:[{Key:"MainEmailAddress",Value:t}],Client:"OWA"}}},1935:function(e,t,n){"use strict";function r(e){var t=[];return e&&e.forEach(function(e){t.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress})}),t}n.d(t,"a",function(){return r})},194:function(e,t,n){"use strict";var r=n(1),o=Object(r.createStore)("folderForestStore",{selectedNode:{id:null,treeType:"primaryFolderTree",type:0}}),i=o();function a(){return i.selectedNode}function s(){var e=a();switch(e.type){case 1:return e.searchFolderId;case 5:return e.data.searchFolderId;case 3:return null;default:return e.id}}n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"d",function(){return o}),n.d(t,"a",function(){return i})},1945:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"DeleteItemField:#Exchange"},e)}},1948:function(e,t,n){"use strict";var r=n(0),o=n(20),i=n(114),a=n(2),s=n(1071),c=n(1709),u=n(227),l=n(2323),d=n(126).bind(l),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onDoubleClick=function(e){e.stopPropagation(),e.preventDefault()},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.isStarred?"FavoriteStarFill":"FavoriteStar",n=d(this.props.iconStyles,l.starIconBase,this.props.animate&&this.props.isStarred?l.saved:void 0,this.props.animate&&l.noTextAnimation),o=this.props.isStarred?this.props.tooltip.starred:this.props.tooltip.unstarred,f={role:void 0,label:this.props.ariaLabelText},p=d(l.container,this.props.buttonStyles,this.props.isClickDisabled&&l.clickDisabled);return this.props.isClickDisabled?a.createElement("div",{className:this.props.spinnerStyles},a.createElement(c.a,{size:u.a.small})):a.createElement(s.a,r.__assign({className:p,checked:this.props.isStarred,toggle:!0,onClick:function(t){return e.props.onClick(t)},onDoubleClick:this.onDoubleClick,iconProps:{iconName:t,styles:{root:n}},title:o},Object(i.b)(f)))},t.defaultProps={tooltip:{starred:"",unstarred:""},iconStyles:l.starIcon},t=r.__decorate([o.observer],t)}(a.Component);t.a=f},1951:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("ADD_FAVORITE_FOLDER_V2",function(e){return{folderIdToAdd:e}})},1955:function(e){e.exports={a:"a5a"}},1958:function(e,t,n){"use strict";n.d(t,"c",function(){return v}),n.d(t,"b",function(){return y});var r=n(0),o=n(1173),i=n(949),a=n(110),s=n(18),c=n(211),u=n(66),l=n(21),d=n(9),f=n(12),p=n(7),m=n(1179),g=Object(p.select)({favoritesStore:function(){return a.a},folderTable:function(){return l.n.folderTable}})(function(e,t){return!(t.folderTable.size>0)||!t.favoritesStore.favoritesFolderNodes.has(e)&&t.folderTable.has(e)});function v(e){g(e.id)&&(a.a.orderedFavoritesNodeIds.push(e.id),a.a.favoritesFolderNodes.set(e.id,e))}function h(e){var t;t=e.id,Object(c.n)(t)&&!a.a.favoriteCategories.get(t)&&(a.a.orderedFavoritesNodeIds.push(e.id),a.a.favoriteCategories.set(e.id,e))}var y=Object(p.action)("loadFavoriteNodesToStore")(function(e,t){var n=Object(d.a)().UserOptions;if(n.FavoriteNodes){n.FavoriteNodes.forEach(function(t){var n,r,i=o.a(t);if(i)switch(i.type){case 0:v(i);break;case 3:r=i,a.a.orderedFavoritesNodeIds.push(r.id),a.a.favoriteSearches.set(r.id,r);break;case 1:n=i.id,a.a.favoritesPersonaNodes.has(n)||(e.orderedFavoritesNodeIds.push(i.id),e.favoritesPersonaNodes.set(i.id,i));break;case 4:h(i);break;default:f.c.warn("Non supported FolderForestNodeType: "+i.id)}});var i=r.__spread(e.favoritesPersonaNodes.values()).filter(function(e){return e.personaId});Object(s.o)("LoadFavorites",[e.favoritesFolderNodes.size,e.favoritesPersonaNodes.size,e.favoriteSearches.size,e.favoriteCategories.size,i.length])}});t.a=Object(p.action)("loadFavoritesV1")(Object(p.select)({favoritesStore:function(){return a.a}})(function(e){a.a.favoritesLoaded||(0===l.n.folderTable.size&&Object(l.B)(),Object(i.a)(2)?y(e.favoritesStore):u.lazyMigrateFavorites.importAndExecute(),Object(m.a)())}))},1959:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("ADD_FAVORITE_CATEGORY_V2",function(e){return{categoryId:e}})},1960:function(e){e.exports={a:"p5a"}},1967:function(e){e.exports={a:"h5a"}},197:function(e,t,n){"use strict";var r=n(1603),o=n(1456),i=n(3),a=(n(1710),n(1708),n(24)),s=n(1591),c=n(1583),u=new i.c(function(){return n.e(337).then(n.bind(null,11822))}),l=new i.a(u,function(e){return e.initializeCache});Object(a.c)(function(){l.importAndExecute(),Object(c.a)()&&s.b.importAndExecute(!0)});var d=n(805),f=n(991),p=n(1589),m=(n(1597),n(1593)),g=n(1604),v=n(1598),h=n(1),y=Object(h.action)("onComposeAddinsInitialized",function(e){return{hostItemIndex:e}}),b=n(1605),_=n(321);function S(){var e=Object(_.c)(),t=Object(d.b)(),n=e?function(e,t){switch(e.type){case _.a.Primary:return t.primaryComposeId;case _.a.Compose:return e.data;default:return null}}(e,t):t.primaryComposeId,r=n?t.viewStates.get(n):null;return r&&!r.isInlineCompose?r:null}n.d(t,"y",function(){return O}),n.d(t,"o",function(){return I}),n.d(t,"i",function(){return A}),n.d(t,"l",function(){return T}),n.d(t,"r",function(){return E}),n.d(t,"u",function(){return x}),n.d(t,"C",function(){return P}),n.d(t,"s",function(){return M}),n.d(t,"w",function(){return w}),n.d(t,"B",function(){return R}),n.d(t,"x",function(){return k}),n.d(t,"v",function(){return D}),n.d(t,"t",function(){return j}),n.d(t,"A",function(){return N}),n.d(t,"k",function(){return F}),n.d(t,"q",function(){return L}),n.d(t,"n",function(){return U}),n.d(t,"z",function(){return B}),n.d(t,"p",function(){return H}),n.d(t,"j",function(){return V}),n.d(t,"m",function(){return W}),n.d(t,"c",function(){return d.a}),n.d(t,"e",function(){return f.c}),n.d(t,"b",function(){return f.b}),n.d(t,"h",function(){return p.c}),n.d(t,"g",function(){return m.a}),n.d(t,"d",function(){return g.a}),n.d(t,"D",function(){return v.a}),n.d(t,"F",function(){return y}),n.d(t,"G",function(){return b.a}),n.d(t,"f",function(){return S}),n.d(t,"a",function(){return o.a}),n.d(t,"E",function(){return r.a});var C=new i.c(function(){return Promise.all([n.e(0),n.e(1),n.e(3),n.e(2),n.e(271)]).then(n.bind(null,11549))}),O=new i.a(C,function(e){return e.replyToMessage}),I=new i.a(C,function(e){return e.forwardMessage}),A=new i.a(C,function(e){return e.closeCompose}),T=new i.a(C,function(e){return e.discardCompose}),E=new i.a(C,function(e){return e.loadDraftToCompose}),x=new i.a(C,function(e){return e.openCompose}),P=new i.a(C,function(e){return e.trySaveAndCloseCompose}),M=new i.a(C,function(e){return e.moveComposeToTab}),w=new i.a(C,function(e){return e.recreateComposeFromViewState}),R=new i.a(C,function(e){return e.tryCreateResendDraft}),k=new i.a(C,function(e){return e.replyToApprovalMessage}),D=new i.a(C,function(e){return e.preloadComposePlugins}),j=new i.a(C,function(e){return e.onEditDraftButtonClicked}),N=new i.a(C,function(e){return e.showSubjectPickerButton}),F=(new i.b(C,function(e){return e.createComposeViewState}),new i.b(C,function(e){return e.createReply})),L=new i.b(C,function(e){return e.getToCcRecipientsForReply}),U=new i.b(C,function(e){return e.findComposePlugins}),B=new i.b(C,function(e){return e.replyToMessageAndCreateViewState}),H=(new i.b(C,function(e){return e.infoBarAddHandler}),new i.b(C,function(e){return e.infoBarRemoveHandler}),new i.b(C,function(e){return e.getNextComposeId})),V=new i.b(C,function(e){return e.createAttachments}),W=new i.b(C,function(e){return e.findComposeFromRecipientWell})},1974:function(e,t,n){"use strict";var r=n(964),o=n(1220),i=n(7),a=Object(i.action)("setSweepOptionType")(Object(i.select)({sweepStore:function(){return r.a}})(function(e,t){t.sweepStore.sweepOptionType=e})),s=n(4),c=n(12);var u=Object(i.action)("setSweepRequestStatus")(Object(i.select)({sweepStore:function(){return r.a}})(function(e,t){var n,r,o,i=t.sweepStore;i.isSweepDialogShown&&(n=i.sweepRequestStatus,o="Invalid state transition {0} to {1}",1==(r=e)&&0!=n&&c.c.error(Object(s.b)(o,n,r)),2!=r&&3!=r||1==n||c.c.error(Object(s.b)(o,n,r)),i.sweepRequestStatus=e)})),l=Object(i.action)("showHideSweepDialog")(Object(i.select)({sweepStore:function(){return r.a}})(function(e,t){t.sweepStore.isSweepDialogShown=e,e||(t.sweepStore.sweepOptionType=o.a.All,t.sweepStore.sweepRequestStatus=0)})),d=n(3);n.d(t,"b",function(){return p}),n.d(t,"c",function(){return m}),n.d(t,"g",function(){return r.a}),n.d(t,"a",function(){return o.a}),n.d(t,"d",function(){return a}),n.d(t,"e",function(){return u}),n.d(t,"f",function(){return l});var f=new d.c(function(){return n.e(383).then(n.bind(null,11871))}),p=new d.b(f,function(e){return e.onSweepMoveToFolderClicked}),m=new d.b(f,function(e){return e.setSweepDestinationFolderId})},1979:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetCalendarEventRequest:#Exchange"},e)}},1980:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(2328);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetCalendarEvent",e,t)}},1989:function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"b",function(){return d});var r=n(2061),o=n(4),i=n(271),a=n(13),s=n(73),c=n(2037);function u(e){for(var t={},n=[],a=0;a<e.length;a++){var s=e[a].EmailAddress;if(s){if(Object(c.a)(s))return Object(i.b)(Object(o.b)(Object(o.a)(r.a),s),null,!1,{hideCancelButton:!0}),null;var u=s.toLowerCase();t[u]||(t[u]=!0,n.push(e[a]))}}return n.length>0?n:null}function l(e,t){var n=[];return e.forEach(function(e){var r=a.b.getLastSenderMailbox(e,t);r&&n.push(r)}),u(n)}function d(e){var t=[];return e.forEach(function(e){var n=s.a.items.get(e);n&&Object(a.M)(n)&&t.push(n.From.Mailbox)}),u(t)}},1998:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var r=n(3),o=new r.c(function(){return n.e(92).then(n.bind(null,3118))}),i=new r.a(o,function(e){return e.getTypeOfAttachment}),a=new r.a(o,function(e){return e.getAllAttachments}),s=new r.a(o,function(e){return e.getAttachmentContentHelper})},2037:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(12),o=n(9);function i(e){var t=Object(o.a)().SessionSettings,n=t.UserEmailAddress;return n?!e||(e.toLowerCase()==n.toLowerCase()||t.UserProxyAddresses&&t.UserProxyAddresses.some(function(t){return t.toLowerCase()==e})):(r.c.error("User email address from session data is null."),!1)}},2050:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(1751);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetAccountInformation",e,t)}},2061:function(e){e.exports={a:"Pmb"}},21:function(e,t,n){"use strict";var r=n(3),o=n(132),i=n(1),a=n(133),s=n(347),c=(Object(i.mutator)(a.f,function(e){var t={id:e.mailboxId,rootFolder:e.folderValue,loadingState:e.loadingState};Object(s.a)().set(e.mailboxId,t)}),Object(i.mutator)(a.e,function(e){var t=e.loadingState;Object(s.a)().get(e.mailboxId).loadingState=t}),n(348)),u=(Object(i.mutator)(a.g,function(e){Object(c.a)(e.mailboxId).DisplayName=e.displayName}),n(0)),l=n(61);var d=n(107);var f=function(e,t){if(e.ExtendedProperty)for(var n=0;n<e.ExtendedProperty.length;n++){var r=e.ExtendedProperty[n];if(r.ExtendedFieldURI.PropertyTag===t||r.ExtendedFieldURI.PropertyName===t)return JSON.parse(r.Value)}},p=function(e){return f(e,"0x10f4")},m=function(e){return parseInt(f(e,"SourceWellKnownFolderType"),10)},g=n(9);Object(i.mutator)(a.h,function(e){var t=Object(d.a)(),n=e.folder,r=n.ParentFolder,o=r.FolderId.Id,i=function(e,t){return t===l.i?null:e.DistinguishedFolderId}(r,e.treeType),a=u.__assign({childFolderIds:[],distinguishedFolderId:i,UnreadCount:r.UnreadCount,TotalCount:r.TotalCount,isHidden:p(r),sourceWellKnownFolderType:m(r),treeType:e.treeType,principalSMTPAddress:e.principalSMTPAddress},r);t.set(o,a);for(var s=[],c=0;c<n.Folders.length;c++){var f=n.Folders[c],g=f.FolderId.Id,h=f.DistinguishedFolderId;if(v(h)){var y=u.__assign({childFolderIds:[],distinguishedFolderId:h,UnreadCount:f.UnreadCount,TotalCount:f.TotalCount,isHidden:p(f),sourceWellKnownFolderType:m(f),treeType:e.treeType,principalSMTPAddress:e.principalSMTPAddress},f);t.set(g,y),s.push(g)}}s.forEach(function(e){var n=t.get(e),r=t.get(n.ParentFolderId.Id);r&&!n.isHidden&&r.childFolderIds.push(e)})});function v(e){var t=!!Object(g.a)().SegmentationSettings.JunkEMail;if("junkemail"===e&&!t)return!1;var n=!!Object(g.a)().SegmentationSettings.StickyNotes;return!("notes"===e&&!n)}var h=n(683),y=(Object(i.mutator)(a.a,function(e){var t=Object(h.a)();-1==t.indexOf(e.principalSMTPAddress)&&t.push(e.principalSMTPAddress)}),Object(i.action)("PERSONA_SEARCH_FOLDERS_LOADED",function(e,t){return{existingFolders:e,personaOrPdlFavorites:t}})),b=(Object(i.mutator)(y,function(e){e.existingFolders.forEach(function(t){if(t){var n=t.FolderId.Id,r=e.personaOrPdlFavorites.filter(function(e){return e.searchFolderId===n});if(1===r.length){var o=r[0].displayName,i=u.__assign({},t,{DisplayName:o});Object(d.a)().set(t.FolderId.Id,i)}}})}),n(120)),_=n.n(b),S=n(1116),C=n(33),O=n(682),I=n(149),A=n(18),T=n(300),E=n(150),x=n(1117);Object(i.orchestrator)(I.f,function(){return u.__awaiter(void 0,void 0,void 0,function(){var e,t,n,r;return u.__generator(this,function(o){switch(o.label){case 0:return(e=Object(O.a)(l.h))==E.a.Loading||e==E.a.Loaded?[2]:(Object(a.e)(l.h,E.a.Loading),t=Object(T.d)(),n=null,t?(n=t.Body.ResponseMessages.Items[0],[3,3]):[3,1]);case 1:return[4,Object(S.a)(_()({Id:l.h}))];case 2:n=o.sent(),o.label=3;case 3:return n&&n.RootFolder&&n.RootFolder.Folders&&n.RootFolder.ParentFolder?(r=n.RootFolder.ParentFolder.FolderId.Id,Object(a.h)(n.RootFolder,l.g,Object(x.a)()),Object(a.f)(l.h,Object(d.a)().get(r),E.a.Loaded),Object(a.g)(l.h,Object(g.a)().SessionSettings.UserDisplayName),i=Object(d.a)().get(Object(C.a)("inbox")).childFolderIds.length,s=Object(d.a)().get(Object(C.a)("msgfolderroot")).TotalCount,Object(A.o)("TnS_LoadFolders",[i,s]),[2]):(Object(a.e)(l.h,E.a.ErrorLoading),[2])}var i,s})})});Object(i.orchestrator)(I.h,function(){var e=Object(g.a)().SessionSettings;if(e.HasArchive){var t={distinguishedFolderId:l.d,isHidden:!1,DisplayName:e.ArchiveDisplayName};Object(a.f)(l.d,t,E.a.Uninitialized)}});var P=n(1103),M=n.n(P);var w=n(12),R=n(26);Object(i.orchestrator)(I.i,function(){return u.__awaiter(void 0,void 0,void 0,function(){var e,t;return u.__generator(this,function(n){switch(n.label){case 0:return[4,M()({})];case 1:return e=n.sent(),(t=e&&e.OtherMailboxEntries)?t.length>0&&(t.forEach(function(e){Object(I.a)(e.DisplayName,e.PrincipalSMTPAddress,!0)}),r=t.length,Object(A.o)("Triage_SharedFolders_LoadList",[Object(R.c)({value:r})])):w.c.error("initializeSharedFolderRoots failed with getOtherMailboxConfiguration response as : "+e),[2]}var r})})});var k=n(1129),D=n(999),j=n(4),N=n(1104),F=n.n(N);function L(e,t){return F()({displayName:e,primarySMTPAddress:t})}var U=n(271),B=(Object(i.orchestrator)(I.a,function(e){return u.__awaiter(void 0,void 0,void 0,function(){var t,n,r,o,i,s;return u.__generator(this,function(c){switch(c.label){case 0:t=e.displayName,n=e.principalSMTPAddress,r=e.skipServerValidation,o=void 0!==r&&r,c.label=1;case 1:return c.trys.push([1,4,,5]),o?[3,3]:[4,L(t,n)];case 2:if(!c.sent())return[2];c.label=3;case 3:return[3,5];case 4:return i=c.sent(),Object(U.b)(Object(j.a)(D.a),Object(j.a)(k.a),!1,{hideCancelButton:!0}),w.c.error("Add shared folder API returned error "+i),[2];case 5:return s={FolderId:{Id:n},isHidden:!1,DisplayName:t,treeType:l.i,principalSMTPAddress:n},Object(a.f)(n,s,E.a.Uninitialized),Object(a.a)(n),o||Object(A.o)("Triage_SharedFolders_AddFolder"),[2]}})})}),n(7)),H=n(108),V=n.n(H),W=n(95);function G(){return Object(c.a)(l.h)}function z(){return Object(c.a)(l.d)}var q=n(5),K=n(684),X=["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"],J=["journal","outbox","syncissues"];function Q(e){if(!function(e){return e&&"Folder:#Exchange"==e.__type}(e))return!1;if(e.isHidden||J.indexOf(Object(W.a)(e.FolderId.Id))>=0)return!1;var t=Object(g.a)();return"notes"==Object(W.a)(e.FolderId.Id)?t.SegmentationSettings.StickyNotes&&Object(q.d)("cal-stickyNotesFolder"):!("junkemail"==Object(W.a)(e.FolderId.Id)&&!t.SegmentationSettings.JunkEMail)}function Y(e){var t=Object(d.a)(),n=Object(C.a)(e);return t.get(n)}function Z(e,t){if("sharedFolder"===e&&!t)throw new Error("To get all the shared folders you must pass principalSMTPAddress");var n,r=[];switch(e){case"archive":n=z();break;case"sharedFolder":n=Object(K.a)(t);break;default:n=G()}"primary"==e&&n.DistinguishedFolderId==G().DistinguishedFolderId&&X.forEach(function(e){var t=Y(e);t&&Q(t)&&t.ParentFolderId.Id===n.FolderId.Id&&r.push(t.FolderId.Id)});for(var i=function(e){var t=[];e&&e.childFolderIds&&e.childFolderIds.map(function(e){var n=o.b.folderTable.get(e);n&&Q(n)&&t.push(n.FolderId.Id)});return t}(n),a=0;a<i.length;a++)-1==X.indexOf(Object(W.a)(i[a]))&&r.push(i[a]);return r}function $(e,t){var n=Object(d.a)().get(e);return!(!n||n.treeType!==t)}function ee(e,t){t.forEach(function(t){e.folderTable.delete(t)})}var te=Object(B.action)("removeFolderFromParentFolder")(function(e,t){if(t.ParentFolderId){var n=e.folderTable.get(t.ParentFolderId.Id).childFolderIds;n.splice(n.indexOf(t.FolderId.Id),1)}}),ne=Object(B.action)("addFolderInSortedOrderUnderParentFolder")(function(e,t,n){for(var r=t.folderTable.get(n).childFolderIds,o=!1,i=e.DisplayName.toLowerCase(),a=0;a<r.length&&!o;a++){t.folderTable.get(r[a]).DisplayName.toLowerCase()>i&&(r.splice(a,0,e.FolderId.Id),o=!0)}o||r.push(e.FolderId.Id)}),re=Object(B.action)("moveFolderToParentFolder")(function(e,t,n){var r,o,i;ne(t,e,n),t.ParentFolderId=V()({Id:n}),t.treeType=(r=n,o=null,(i=Object(d.a)().get(r))&&(o=i.treeType),o)}),oe=n(455),ie=Object(B.action)("addNewFolderToStore")(function(e,t,n,r){var o=Object(oe.a)(n),i=t.Folders[0],a=Object(d.a)().get(n).treeType,s=u.__assign({DisplayName:r,ParentFolderId:o,childFolderIds:[],FolderClass:"IPF.Note",distinguishedFolderId:void 0,UnreadCount:0,TotalCount:0,treeType:a},i);return e.folderTable.set(i.FolderId.Id,s),ne(s,e,o.Id),Promise.resolve(i.FolderId.Id)}),ae=n(778),se=n.n(ae),ce=n(603),ue=n.n(ce),le=n(272),de=n.n(le),fe=n(779),pe=n.n(fe),me=n(29),ge=n(346);function ve(e,t,n){return void 0===n&&(n="IPF.Note"),pe()({Header:Object(me.getJsonRequestHeader)(),Body:se()({ParentFolderId:de()({BaseFolderId:he(e)}),Folders:[ue()({DisplayName:t,FolderClass:n})]})},Object(ge.a)(e)).then(function(e){return e.Body.ResponseMessages.Items[0]})}function he(e){return"string"==typeof e?V()({Id:e}):_()({Id:e})}var ye=n(685);function be(e,t,n){for(var r=("string"==typeof n?e.folderTable.get(n):e.folderTable.get(Object(C.a)(n))).childFolderIds,o=t.toLowerCase(),i=0;i<r.length;i++){var a=r[i],s=e.folderTable.get(a);if(s&&s.DisplayName.toLowerCase()==o)return!0}return!1}function _e(e){var t=[e];return Object(d.a)().get(e).childFolderIds.forEach(function(e){Array.prototype.push.apply(t,_e(e))}),t}function Se(e){var t=Object(d.a)().get(e);return!!t.childFolderIds&&t.childFolderIds.filter(function(e){return Q(Object(d.a)().get(e))}).length>0}function Ce(e,t){return function e(t,n,r){var o=[];if(0===n){var i=e(t,n+1,r);o.push.apply(o,u.__spread(i))}else t.forEach(function(t){var i=Object(d.a)().get(t);if(Q(i)&&(o.push(u.__assign({},i,{depth:n})),Se(t)&&r(t))){var a=e(i.childFolderIds,n+1,r);o.push.apply(o,u.__spread(a))}});return o}(e,0,t)}n(8);var Oe,Ie=null;var Ae=function(e,t){Ie.folderTable.set(e.FolderId.Id,e),e.ParentFolderId&&Ie.folderTable.get(e.ParentFolderId.Id).childFolderIds.push(e.FolderId.Id),e.distinguishedFolderId&&(Oe[e.distinguishedFolderId]=e.FolderId.Id)};Ae=Object(B.action)("addFolderToStore-TestMethod")(Ae);var Te=n(1094),Ee=n.n(Te),xe=n(57),Pe=n.n(xe),Me=function(e,t){return Object(ye.a)(e,[Ee()({Path:Pe()({FieldURI:"FolderDisplayName"}),Folder:ue()({DisplayName:t})})])};var we=Object(B.select)({folderTable:function(){return o.b.folderTable}})(function(e,t,n){var r=!!e&&e.ParentFolderId;if(!r)return!1;for(var o=n.folderTable.get(r.Id);o;){if(o.distinguishedFolderId==t)return!0;if(!o.ParentFolderId)return!1;o=n.folderTable.get(o.ParentFolderId.Id)}return!1}),Re=Object(B.select)({folderTable:function(){return o.b.folderTable}})(function(e,t,n){return function(e,t){return!!e&&e.distinguishedFolderId==t}(e,t)||we(e,t,n)}),ke=Object(B.select)({folderTable:function(){return o.b.folderTable}})(function(e,t){return we(e,"msgfolderroot",t)});function De(e){return Re(o.b.folderTable.get(e),"msgfolderroot")}n(454);var je=n(686);function Ne(){var e=Object(o.a)();return e.sharedFolderUserEmails.map(function(t){return e.mailboxTable.get(t)})}n.d(t,"P",function(){return Le}),n.d(t,"R",function(){return Ue}),n.d(t,"S",function(){return Be}),n.d(t,"Q",function(){return He}),n.d(t,"T",function(){return Ve}),n.d(t,"U",function(){return We}),n.d(t,"O",function(){return Ge}),n.d(t,"k",function(){return ie}),n.d(t,"m",function(){return ve}),n.d(t,"bb",function(){return ye.a}),n.d(t,"p",function(){return be}),n.d(t,"r",function(){return _e}),n.d(t,"u",function(){return Ce}),n.d(t,"F",function(){return Se}),n.d(t,"e",function(){return E.a}),n.d(t,"X",function(){return y}),n.d(t,"o",function(){return ee}),n.d(t,"Y",function(){return te}),n.d(t,"V",function(){return re}),n.d(t,"B",function(){return I.f}),n.d(t,"G",function(){return I.h}),n.d(t,"H",function(){return I.i}),n.d(t,"l",function(){return I.a}),n.d(t,"W",function(){return I.j}),n.d(t,"x",function(){return I.e}),n.d(t,"w",function(){return I.d}),n.d(t,"db",function(){return I.o}),n.d(t,"cb",function(){return I.m}),n.d(t,"Z",function(){return Me}),n.d(t,"t",function(){return ge.a}),n.d(t,"i",function(){return l.h}),n.d(t,"d",function(){return l.d}),n.d(t,"f",function(){return l.e}),n.d(t,"a",function(){return l.a}),n.d(t,"g",function(){return l.f}),n.d(t,"b",function(){return l.b}),n.d(t,"j",function(){return l.i}),n.d(t,"h",function(){return l.g}),n.d(t,"c",function(){return l.c}),n.d(t,"s",function(){return z}),n.d(t,"C",function(){return G}),n.d(t,"y",function(){return d.a}),n.d(t,"A",function(){return O.a}),n.d(t,"E",function(){return h.a}),n.d(t,"D",function(){return K.a}),n.d(t,"L",function(){return ke}),n.d(t,"K",function(){return De}),n.d(t,"N",function(){return we}),n.d(t,"J",function(){return Re}),n.d(t,"ab",function(){return Q}),n.d(t,"v",function(){return Y}),n.d(t,"z",function(){return Z}),n.d(t,"I",function(){return $}),n.d(t,"M",function(){return je.b}),n.d(t,"q",function(){return Ne});t.n=o.b;var Fe=new r.c(function(){return n.e(100).then(n.bind(null,11715))}),Le=new r.b(Fe,function(e){return e.getArchiveFolders}),Ue=new r.b(Fe,function(e){return e.getSharedFolders}),Be=new r.b(Fe,function(e){return e.removeSharedFolderUser}),He=new r.b(Fe,function(e){return e.getFolderPermissions}),Ve=new r.b(Fe,function(e){return e.updateFolderPermissions}),We=new r.b(Fe,function(e){return e.updateFolderPermissionsInStore}),Ge=new r.b(Fe,function(e){return e.arePermissionArraysEqual});new r.b(Fe,function(e){return e.arePermissionsEqual})},211:function(e,t,n){"use strict";var r=n(3),o=n(184),i=n(0),a=n(2),s=n(18),c=n(20),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.componentDidMount=function(){this.logNumberOfCategories(this.props.categories)},t.prototype.componentWillReceiveProps=function(e){this.props.categories.length!=e.categories.length&&this.logNumberOfCategories(e.categories)},t.prototype.logNumberOfCategories=function(e){Object(s.o)("Category_Well_TotalCategories",[e.length])},t.prototype.render=function(){return a.createElement("div",{className:this.props.categoryWellContainerClass},this.renderCategories(this.props.categories,this.props.categoryContainerClass))},t.prototype.renderCategories=function(e,t){for(var n=[],r=e.length-1;r>=0;r--){var o=e[r];n.push(a.createElement(p,{key:o,actionSource:"CategoryWell",category:o,containerClassName:t,isLastInWell:0==r,onCategoryClicked:this.props.onCategoryClicked,categoryList:this.props.categoryList}))}return n},t=i.__decorate([c.observer],t)}(a.Component),l=n(8),d=n(1503),f=n(126).bind(d),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCategoryClicked=function(e){t.props.onCategoryClicked&&(Object(s.o)("Category_Well_Click",[t.props.actionSource]),t.props.onCategoryClicked(e,t.props.category,t.props.actionSource))},t.onMouseEnterCategory=function(){t.props.onCategoryClicked&&(t.categoryContainerElement.style.borderColor=t.categoryColor.textColor)},t.onMouseLeaveCategory=function(){t.props.onCategoryClicked&&(t.categoryContainerElement.style.borderColor=t.categoryColor.secondaryColor)},t}return i.__extends(t,e),Object.defineProperty(t.prototype,"categoryColor",{get:function(){return Object(m.a)(this.props.category,this.props.categoryList?this.props.categoryList:Object(I.a)())},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this,t={backgroundColor:this.categoryColor.primaryColor,borderColor:this.categoryColor.secondaryColor,color:this.categoryColor.textColor,cursor:this.props.onCategoryClicked?"pointer":"initial"},n=this.props.category,r=f(this.props.containerClassName,this.props.isLastInWell?d.lastCategoryContainer:d.categoryContainer);return a.createElement("div",{ref:function(t){return e.categoryContainerElement=t},key:n,className:r,style:t,title:n,onMouseEnter:this.onMouseEnterCategory,onMouseLeave:this.onMouseLeaveCategory,onClick:this.onCategoryClicked},a.createElement("span",{className:d.categoryName},n))},i.__decorate([l.computed],t.prototype,"categoryColor",null),t=i.__decorate([c.observer],t)}(a.Component),m=n(453),g=n(679),v=(n(85),n(1082),n(67)),h=n(1107),y=n(1108),b=n(1102),_=n(1498);function S(e){var t=[];return t.push({key:"CategoryMenuItemDiv",onRender:function(){return a.createElement(j,{mailboxInfo:e.mailboxInfo,onAfterCreateNewCategory:e.onAfterCreateNewCategory,onCheckedCategoryClicked:e.onCheckedCategoryClicked,onUncheckedCategoryClicked:e.onUncheckedCategoryClicked,actionSource:e.actionSource,categoryList:e.categoryList,categoriesToCheck:e.getCategoriesToCheck(),dismissMenu:e.dismissMenu,shouldShowSearchBox:e.shouldShowSearchBox,shouldShowManageCategories:e.shouldShowManageCategories,shouldShowClearCategories:e.getShouldShowClearCategories(),manageCategoriesDisabled:e.manageCategoriesDisabled,createNewCategoryDisabled:e.createNewCategoryDisabled,onManageCategoryClicked:e.onManageCategoryClicked,onClearCategoriesClicked:e.onClearCategoriesClicked})}}),{className:_.categoryMenu,styles:{title:{},container:{},root:{width:e.width?e.width+"px":null},header:{},list:{}},directionalHintFixed:!0,items:t,onMenuDismissed:C,shouldFocusOnMount:!e.shouldShowSearchBox,useTargetWidth:e.useTargetWidth,coverTarget:e.coverTarget,directionalHint:e.directionalHint?e.directionalHint:v.DirectionalHint.bottomLeftEdge,focusZoneProps:{shouldInputLoseFocusOnArrowKey:function(e){return!0}},calloutProps:{className:"customScrollBar"}}}function C(){Object(h.a)(""),Object(y.a)(!1),Object(b.a)()}var O=n(1083),I=n(452),A=n(451);function T(e){return 1===Object(I.a)().filter(function(t){return t.Id===e}).length}function E(e,t){var n=t.filter(function(t){return t.Name===e});return n.length>0?n[0].Id:null}function x(e,t){var n=t.filter(function(t){return t.Id===e});return n.length>0?n[0].Name:null}var P=n(1079);n.d(t,"r",function(){return w}),n.d(t,"u",function(){return R}),n.d(t,"s",function(){return k}),n.d(t,"t",function(){return D}),n.d(t,"d",function(){return j}),n.d(t,"b",function(){return N}),n.d(t,"m",function(){return o.b}),n.d(t,"e",function(){return u}),n.d(t,"a",function(){return p}),n.d(t,"g",function(){return m.a}),n.d(t,"q",function(){return g.a}),n.d(t,"p",function(){return g.c}),n.d(t,"o",function(){return g.b}),n.d(t,"i",function(){return S}),n.d(t,"k",function(){return O.a}),n.d(t,"l",function(){return I.a}),n.d(t,"f",function(){return A.b}),n.d(t,"n",function(){return T}),n.d(t,"h",function(){return E}),n.d(t,"j",function(){return x}),n.d(t,"c",function(){return P.a});var M=new r.c(function(){return Promise.all([n.e(3),n.e(43),n.e(147)]).then(n.bind(null,11706))}),w=new r.b(M,function(e){return e.addMasterCategories}),R=new r.a(M,function(e){return e.removeMasterCategories}),k=new r.a(M,function(e){return e.changeMasterCategories}),D=new r.a(M,function(e){return e.getMasterCategoryList}),j=Object(r.d)(M,function(e){return e.CategoryMenu}),N=Object(r.d)(M,function(e){return e.CategoryColorPickerHost})},2133:function(e,t,n){"use strict";var r=n(1815);t.a=function(e){return null==e?"":Object(r.a)(e)}},2135:function(e,t,n){"use strict";var r=n(806),o=n(22),i=n(1484),a=n(82);function s(e,t){if(t){var n=t.displayName?t.displayName+"<"+t.smtpAddress+">":t.smtpAddress;return e?"&"+e+"="+n:n}return""}function c(e,t){return t?"&"+e+"="+t:""}function u(e){if(!e.to||!e.to.smtpAddress)return"";var t=a.parse(Object(o.a)().search.substr(1));return t.mailtouri=function(e){if(!e.to||!e.to.smtpAddress)return"";var t="mailto:"+s(null,e.to),n="";return n+=s("cc",e.cc),n+=s("bcc",e.bcc),n+=c("subject",e.subject),(n+=c("body",e.body))?t+"?"+n.slice(1):t}(e),Object(i.a)(r.e,r.b,"?"+a.stringify(t))}n.d(t,"a",function(){return u})},2139:function(e,t,n){"use strict";var r=n(1),o=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{}})();t.a=o},2142:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLMembers=3]="SucceededWithDLMembers",e[e.SucceededWithoutDLMembers=4]="SucceededWithoutDLMembers"}(r||(r={}))},215:function(e,t,n){"use strict";n(2384),n(2385);var r=n(3),o=(n(1974),n(1989)),i=n(1572),a=n(4),s=n(571),c=n(350),u=n(1751),l=n.n(u),d=n(2050),f=n.n(d),p=n(29);var m=95,g=98;function v(){var e;(e=l()({Header:Object(p.getJsonRequestHeader)()}),f()(e)).then(function(e){var t,n=e.AccountInfo.Statistics.TotalItemSize.Value/(t=e.AccountInfo.Mailbox.UseDatabaseQuotaDefaults?e.AccountInfo.Statistics.DatabaseProhibitSendReceiveQuota:e.AccountInfo.Mailbox.ProhibitSendReceiveQuota).Value*100;if(!(n<m||t.IsUnlimited)){var r=Object(a.b)(Object(a.a)(i.b),n.toFixed(2));r+=n>=g?Object(a.a)(i.a):Object(a.a)(i.c),s.d.importAndExecute("mailboxQuotaWarningNotification",r,{primaryActionText:"View Storage",allowAutoDismiss:!1,shouldShowDismissIcon:!0,notificationCallback:function(e){e===s.a.PrimaryActionClicked&&c.e.importAndExecute("general","storage")}})}})}n.d(t,"c",function(){return y}),n.d(t,"d",function(){return b}),n.d(t,"y",function(){return _}),n.d(t,"l",function(){return S}),n.d(t,"j",function(){return C}),n.d(t,"k",function(){return O}),n.d(t,"p",function(){return I}),n.d(t,"K",function(){return A}),n.d(t,"G",function(){return T}),n.d(t,"F",function(){return E}),n.d(t,"E",function(){return x}),n.d(t,"w",function(){return P}),n.d(t,"x",function(){return M}),n.d(t,"i",function(){return w}),n.d(t,"e",function(){return R}),n.d(t,"D",function(){return k}),n.d(t,"J",function(){return D}),n.d(t,"v",function(){return j}),n.d(t,"u",function(){return N}),n.d(t,"s",function(){return F}),n.d(t,"r",function(){return L}),n.d(t,"t",function(){return U}),n.d(t,"q",function(){return B}),n.d(t,"C",function(){return H}),n.d(t,"M",function(){return V}),n.d(t,"N",function(){return W}),n.d(t,"g",function(){return G}),n.d(t,"f",function(){return z}),n.d(t,"b",function(){return q}),n.d(t,"B",function(){return K}),n.d(t,"h",function(){return X}),n.d(t,"H",function(){return J}),n.d(t,"m",function(){return Q}),n.d(t,"o",function(){return Y}),n.d(t,"n",function(){return Z}),n.d(t,"I",function(){return $}),n.d(t,"A",function(){return ee}),n.d(t,"z",function(){return te}),n.d(t,"L",function(){return ne}),n.d(t,"a",function(){return o.a}),n.d(t,"O",function(){return v});var h=new r.c(function(){return Promise.all([n.e(3),n.e(523),n.e(21),n.e(20),n.e(397)]).then(n.bind(null,11652))}),y=new r.b(h,function(e){return e.addMailboxToSafeSenders}),b=new r.a(h,function(e){return e.alwaysMoveRowToFocusedOrOther}),_=new r.a(h,function(e){return e.moveMailListRowsToFocusedOrOther}),S=new r.a(h,function(e){return e.deleteMailListRows}),C=new r.a(h,function(e){return e.deleteItems}),O=new r.b(h,function(e){return e.deleteItemsBasedOnNodeIds}),I=new r.b(h,function(e){return e.likeItem}),A=new r.a(h,function(e){return e.toggleRowsFlagState}),T=new r.a(h,function(e){return e.setMailListRowsFlagState}),E=new r.a(h,function(e){return e.setItemsFlagStateFromItemIds}),x=new r.b(h,function(e){return e.setItemsFlagStateBasedOnNodeIds}),P=(new r.a(h,function(e){return e.moveItemsFromItemIds}),new r.b(h,function(e){return e.moveItemsBasedOnNodeIds})),M=new r.a(h,function(e){return e.moveMailListRows}),w=new r.a(h,function(e){return e.copyMailListRows}),R=new r.a(h,function(e){return e.archiveMailListRowsFromTable}),k=new r.b(h,function(e){return e.scheduleRows}),D=new r.a(h,function(e){return e.toggleRowPinnedState}),j=new r.a(h,function(e){return e.markRowsPinnedUnpinned}),N=new r.a(h,function(e){return e.markRowsJunkNotJunkFromTable}),F=new r.b(h,function(e){return e.markItemsJunkNotJunkBasedOnNodeIds}),L=new r.a(h,function(e){return e.markItemJunkNotJunkFromReadingPane}),U=new r.a(h,function(e){return e.markRowsAsPhishingFromTable}),B=new r.a(h,function(e){return e.markItemAsPhishingFromReadingPane}),H=new r.a(h,function(e){return e.restoreMailListRows}),V=new r.a(h,function(e){return e.unsubscribeEmail}),W=new r.b(h,function(e){return e.unsubscribeEmailV2}),G=new r.a(h,function(e){return e.blockLastSendersFromTable}),z=new r.a(h,function(e){return e.blockLastSenderFromReadingPane}),q=new r.a(h,function(e){return e.addCategoriesFromTable}),K=new r.a(h,function(e){return e.removeCategoriesFromTable}),X=new r.a(h,function(e){return e.clearCategoriesFromTable}),J=new r.a(h,function(e){return e.sweepConversations}),Q=new r.a(h,function(e){return e.emptyFolder}),Y=new r.a(h,function(e){return e.emptyTableView}),Z=new r.a(h,function(e){return e.emptySearchTableView}),$=new r.b(h,function(e){return e.toggleIgnoreConversations}),ee=new r.b(h,function(e){return e.moveSharedFolderItems}),te=new r.b(h,function(e){return e.moveSharedFolderConversations}),ne=new r.a(h,function(e){return e.translateFromTable})},2152:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r="ReferenceAttachment:#Exchange",o=1024,i=1048576},2160:function(e){e.exports={a:"e5a"}},2164:function(e){e.exports={a:"n5a"}},224:function(e,t,n){"use strict";var r;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(r||(r={})),t.a=r},227:function(e,t,n){"use strict";var r,o;n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),function(e){e[e.xSmall=0]="xSmall",e[e.small=1]="small",e[e.medium=2]="medium",e[e.large=3]="large"}(r||(r={})),function(e){e[e.normal=0]="normal",e[e.large=1]="large"}(o||(o={}))},2291:function(e,t,n){"use strict";var r,o;n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o}),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual"}(o||(o={}))},2294:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(806),o=n(22),i=n(1484);function a(e){return e?Object(i.a)(r.e,r.f+"/"+encodeURIComponent(e),Object(o.a)().search):""}},2296:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(0),o=n(2),i=n(222),a=n(77),s=n(986),c=n(58),u=n(289),l=function(e){function t(n){var r=e.call(this,n)||this;return r._root=o.createRef(),r._firstBumper=o.createRef(),r._lastBumper=o.createRef(),r._hasFocus=!1,r._onRootFocus=function(e){r.props.onFocus&&r.props.onFocus(e),r._hasFocus=!0},r._onRootBlur=function(e){r.props.onBlur&&r.props.onBlur(e);var t=e.relatedTarget;null===e.relatedTarget&&(t=document.activeElement),Object(i.a)(r._root.current,t)||(r._hasFocus=!1)},r._onFirstBumperFocus=function(){r._onBumperFocus(!0)},r._onLastBumperFocus=function(){r._onBumperFocus(!1)},r._onBumperFocus=function(e){if(!r.props.disabled){var t=e===r._hasFocus?r._lastBumper.current:r._firstBumper.current;if(r._root.current){var n=e===r._hasFocus?Object(a.i)(r._root.current,t,!0,!1):Object(a.f)(r._root.current,t,!0,!1);n&&(r._isBumper(n)?r.focus():n.focus())}}},r._onFocusCapture=function(e){r.props.onFocusCapture&&r.props.onFocusCapture(e),e.target===e.currentTarget||r._isBumper(e.target)||(r._previouslyFocusedElementInTrapZone=e.target)},r._forceFocusInTrap=function(e){if(!r.props.disabled&&t._focusStack.length&&r===t._focusStack[t._focusStack.length-1]){var n=document.activeElement;Object(i.a)(r._root.current,n)||(r.focus(),r._hasFocus=!0,e.preventDefault(),e.stopPropagation())}},r._forceClickInTrap=function(e){if(!r.props.disabled&&t._focusStack.length&&r===t._focusStack[t._focusStack.length-1]){var n=e.target;n&&!Object(i.a)(r._root.current,n)&&(r.focus(),r._hasFocus=!0,e.preventDefault(),e.stopPropagation())}},Object(s.a)(r),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this._bringFocusIntoZone(),this._updateEventHandlers(this.props)},t.prototype.componentWillReceiveProps=function(e){var t=e.elementToFocusOnDismiss;t&&this._previouslyFocusedElementOutsideTrapZone!==t&&(this._previouslyFocusedElementOutsideTrapZone=t),this._updateEventHandlers(e)},t.prototype.componentDidUpdate=function(e){var t=void 0===e.forceFocusInsideTrap||e.forceFocusInsideTrap,n=void 0===this.props.forceFocusInsideTrap||this.props.forceFocusInsideTrap,r=void 0!==e.disabled&&e.disabled,o=void 0!==this.props.disabled&&this.props.disabled;!t&&n||r&&!o?this._bringFocusIntoZone():(t&&!n||!r&&o)&&this._returnFocusToInitiator()},t.prototype.componentWillUnmount=function(){this.props.disabled&&!this.props.forceFocusInsideTrap&&Object(i.a)(this._root.current,document.activeElement)||this._returnFocusToInitiator()},t.prototype.render=function(){var e=this.props,t=e.className,n=e.disabled,i=void 0!==n&&n,a=e.ariaLabelledBy,s=Object(c.f)(this.props,c.e),u={style:{pointerEvents:"none",position:"fixed"},tabIndex:i?-1:0,"data-is-visible":!0};return o.createElement("div",r.__assign({},s,{className:t,ref:this._root,"aria-labelledby":a,onFocusCapture:this._onFocusCapture,onFocus:this._onRootFocus,onBlur:this._onRootBlur}),o.createElement("div",r.__assign({},u,{ref:this._firstBumper,onFocus:this._onFirstBumperFocus})),this.props.children,o.createElement("div",r.__assign({},u,{ref:this._lastBumper,onFocus:this._onLastBumperFocus})))},t.prototype.focus=function(){var e=this.props,t=e.focusPreviouslyFocusedInnerElement,n=e.firstFocusableSelector;if(t&&this._previouslyFocusedElementInTrapZone&&Object(i.a)(this._root.current,this._previouslyFocusedElementInTrapZone))this._focusAsync(this._previouslyFocusedElementInTrapZone);else{var r,o="string"==typeof n?n:n&&n();this._root.current&&(o&&(r=this._root.current.querySelector("."+o)),r||(r=Object(a.j)(this._root.current,this._root.current.firstChild,!1,!1,!1,!0))),r&&this._focusAsync(r)}},t.prototype._focusAsync=function(e){this._isBumper(e)||Object(a.b)(e)},t.prototype._bringFocusIntoZone=function(){var e=this.props,n=e.elementToFocusOnDismiss,r=e.disabled,o=void 0!==r&&r,a=e.disableFirstFocus,s=void 0!==a&&a;o||(t._focusStack.push(this),this._previouslyFocusedElementOutsideTrapZone=n||document.activeElement,s||Object(i.a)(this._root.current,this._previouslyFocusedElementOutsideTrapZone)||this.focus())},t.prototype._returnFocusToInitiator=function(){var e=this,n=this.props.ignoreExternalFocusing;t._focusStack=t._focusStack.filter(function(t){return e!==t});var r=document.activeElement;n||!this._previouslyFocusedElementOutsideTrapZone||"function"!=typeof this._previouslyFocusedElementOutsideTrapZone.focus||!Object(i.a)(this._root.current,r)&&r!==document.body||this._focusAsync(this._previouslyFocusedElementOutsideTrapZone)},t.prototype._updateEventHandlers=function(e){var t=e.isClickableOutsideFocusTrap,n=void 0!==t&&t,r=e.forceFocusInsideTrap,o=void 0===r||r;o&&!this._disposeFocusHandler?this._disposeFocusHandler=Object(u.a)(window,"focus",this._forceFocusInTrap,!0):!o&&this._disposeFocusHandler&&(this._disposeFocusHandler(),this._disposeFocusHandler=void 0),n||this._disposeClickHandler?n&&this._disposeClickHandler&&(this._disposeClickHandler(),this._disposeClickHandler=void 0):this._disposeClickHandler=Object(u.a)(window,"click",this._forceClickInTrap,!0)},t.prototype._isBumper=function(e){return e===this._firstBumper.current||e===this._lastBumper.current},t._focusStack=[],t}(o.Component)},2300:function(e,t,n){"use strict";var r=n(637),o=n(1305),i=n(14),a={root:"ms-Overlay",rootDark:"ms-Overlay--dark"};n.d(t,"a",function(){return s});var s=Object(r.a)(o.a,function(e){var t,n=e.className,r=e.theme,o=e.isNone,s=e.isDark,c=r.palette,u=Object(i.getGlobalClassNames)(a,r);return{root:[u.root,r.fonts.medium,{backgroundColor:c.whiteTranslucent40,top:0,right:0,bottom:0,left:0,position:"absolute",selectors:(t={},t[i.HighContrastSelector]={border:"1px solid WindowText",opacity:0},t)},o&&{visibility:"hidden"},s&&[u.rootDark,{backgroundColor:c.blackTranslucent40}],n]}},void 0,{scope:"Overlay"})},2305:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetFolderJsonRequest:#Exchange"},e)}},2323:function(e,t,n){var r=n(2324),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},2324:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'.v6OeChsw1fRp7ZlOydywa{cursor:pointer}html[dir] .v6OeChsw1fRp7ZlOydywa{background:none}._3IMbv42KJXC0ZBDg7aYP4h{font-size:15px}._285bepOllAHfDZ4SHe6T2Z{cursor:default}._285bepOllAHfDZ4SHe6T2Z,._285bepOllAHfDZ4SHe6T2Z:hover:before,._19TKX4tBlljz2PUG1z7tpG:before{color:"[theme:themeDark, default:#0D62AA]"}._19TKX4tBlljz2PUG1z7tpG:hover:before{color:"[theme:themeDarker, default:#004578]"}._19TKX4tBlljz2PUG1z7tpG:active:before{color:"[theme:themeDark, default:#0D62AA]"}._19TKX4tBlljz2PUG1z7tpG:after{content:"";position:absolute;z-index:0;top:6px;bottom:0;opacity:1;overflow:visible;width:15px;height:15px}html[dir] ._19TKX4tBlljz2PUG1z7tpG:after{background:"[theme:themeDarker, default:#004578]";border-radius:50%;-webkit-transform:scale(0);transform:scale(0)}html[dir=ltr] ._19TKX4tBlljz2PUG1z7tpG:after{left:0;right:0;margin-left:4px}html[dir=rtl] ._19TKX4tBlljz2PUG1z7tpG:after{right:0;left:0;margin-right:4px}._19TKX4tBlljz2PUG1z7tpG.aibtO7MMTenHOCpx_q8q2:after{top:3px}html[dir=ltr] ._19TKX4tBlljz2PUG1z7tpG.aibtO7MMTenHOCpx_q8q2:after{margin-left:8px}html[dir=rtl] ._19TKX4tBlljz2PUG1z7tpG.aibtO7MMTenHOCpx_q8q2:after{margin-right:8px}._19TKX4tBlljz2PUG1z7tpG.GEc-XzGV9AbqSjPaXKCXF:after{opacity:0}html[dir] ._19TKX4tBlljz2PUG1z7tpG.GEc-XzGV9AbqSjPaXKCXF:after{-webkit-transform:scale(1.4);transform:scale(1.4);-webkit-transition:opacity .6s ease-out,-webkit-transform .6s ease-out;transition:opacity .6s ease-out,-webkit-transform .6s ease-out;transition:transform .6s ease-out,opacity .6s ease-out;transition:transform .6s ease-out,opacity .6s ease-out,-webkit-transform .6s ease-out}',""]),t.locals={container:"v6OeChsw1fRp7ZlOydywa",starIcon:"_3IMbv42KJXC0ZBDg7aYP4h",clickDisabled:"_285bepOllAHfDZ4SHe6T2Z",starIconBase:"_19TKX4tBlljz2PUG1z7tpG",noTextAnimation:"aibtO7MMTenHOCpx_q8q2",saved:"GEc-XzGV9AbqSjPaXKCXF"}},2328:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetCalendarEventJsonRequest:#Exchange"},e)}},238:function(e,t,n){"use strict";var r=n(1314),o=n(13);function i(){return Object(r.a)(Object(o.C)())}n.d(t,"b",function(){return r.a}),n.d(t,"c",function(){return r.c}),n.d(t,"a",function(){return i})},2384:function(e,t,n){"use strict";var r=n(1552),o=n(1553),i=n(4),a=n(271),s=n(1),c=n(744);Object(s.mutator)(c.e,function(e){"ReadingPaneInfoBar"===e.unsubscribeSourceType&&(e.responseType===c.a.Success?e.completedCallback&&e.completedCallback():Object(a.b)(Object(i.a)(o.a),Object(i.a)(r.a),!1,{hideCancelButton:!0}))})},2385:function(e,t,n){"use strict";var r=n(1552),o=n(1553),i=n(4),a=n(271),s=n(1725),c=n(13),u=n(263),l=n(1),d=n(744);Object(l.mutator)(d.e,function(e){"BrandCard"===e.unsubscribeSourceType&&(e.responseType===d.a.Success?0===Object(c.C)().tableQuery.listViewType?u.p.conversationReadingPaneViewState.itemPartsMap.forEach(function(e){Object(s.a)(e,"unsubscribeInfoBar")}):Object(s.a)(u.p.itemReadingPaneViewState.itemViewState,"unsubscribeInfoBar"):Object(a.b)(Object(i.a)(o.a),Object(i.a)(r.a),!1,{hideCancelButton:!0}))})},2387:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"MAX_REGEX_MATCHES",function(){return y}),n.d(r,"MAX_BODY_REGEX_ACTIVATION_LENGTH",function(){return b}),n.d(r,"MAX_REGEX_MATCH_LENGTH",function(){return _});var o=n(1329),i=n(4915),a=n(4773),s=n(0),c=n(5047),u=n(3538),l=n(3620),d=function(){function e(e){this.collectionRule=e}return e.prototype.Evaluate=function(e,t){var n,r,o=this.GetInitialEvaluationResult();try{for(var i=s.__values(this.collectionRule.Rules),a=i.next();!a.done;a=i.next()){var c=T(a.value).Evaluate(e,t);o=this.UpdateEvaluationResult(o,c)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o},e.prototype.ItemIsReadyForEvaluation=function(e){var t,n;try{for(var r=s.__values(this.collectionRule.Rules),o=r.next();!o.done;o=r.next()){if(!T(o.value).ItemIsReadyForEvaluation(e))return!1}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!0},e.prototype.GetInitialEvaluationResult=function(){if("AND"==this.collectionRule.Mode.toUpperCase())return!0;if("OR"==this.collectionRule.Mode.toUpperCase())return!1;throw new Error("Invalid mode for a Collection rule: "+this.collectionRule.Mode)},e.prototype.UpdateEvaluationResult=function(e,t){return!("AND"==this.collectionRule.Mode.toUpperCase()&&!t)&&(!("OR"!=this.collectionRule.Mode.toUpperCase()||!t)||e)},e}(),f=function(){function e(){}return e.prototype.Evaluate=function(e,t){return!!e.HasAttachments},e.prototype.ItemIsReadyForEvaluation=function(e){return!0},e}();function p(e){return function(e){return e.replace(/\n[\s]*/g,"[\n]+")}(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"))}var m=n(210),g="MeetingString",v=function(){function e(e){this.itemHasKnownEntityRule=e}return e.prototype.Evaluate=function(e,t){if(!e.EntityExtractionResult)return!1;switch(this.itemHasKnownEntityRule.EntityType){case 3:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Addresses,"Address");case 7:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Contacts,"ContactString");case 6:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.EmailAddresses,"EmailAddress");case 1:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.MeetingSuggestions,g);case 5:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.PhoneNumbers,"OriginalPhoneString");case 2:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.TaskSuggestions,"TaskString");case 4:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Urls,"Url");default:throw new Error("Unexpected known entity: "+this.itemHasKnownEntityRule.EntityType)}},e.prototype.EvaluateForEntityType=function(e,t,n,r){var o,i;if(!n)return!1;var a=[],c=!1,u=0;try{for(var l=s.__values(n),d=l.next();!d.done;d=l.next()){var f=d.value;if(this.EvaluateRegExForTerm(f[r])){c=!0,-1===t.evaluationResult.matchedKnownEntityTypes.indexOf(this.itemHasKnownEntityRule.EntityType)&&t.evaluationResult.matchedKnownEntityTypes.push(this.itemHasKnownEntityRule.EntityType),2!==this.itemHasKnownEntityRule.Highlight&&"Subject"!==f.Position&&(t.terms.push(h(f,r)),u++);var p=m({},f);a.push(p)}}}catch(e){o={error:e}}finally{try{d&&!d.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}if(this.itemHasKnownEntityRule.FilterName&&this.itemHasKnownEntityRule.RegExFilter&&this.SaveRegexMatches(a,t.evaluationResult),u>0){var g=t.highlightableEntities[this.itemHasKnownEntityRule.EntityType];(!g||u>g)&&(t.highlightableEntities[this.itemHasKnownEntityRule.EntityType]=u)}return c},e.prototype.EvaluateRegExForTerm=function(e){var t=this.itemHasKnownEntityRule.IgnoreCase,n=this.itemHasKnownEntityRule.RegExFilter;if(!n)return!0;var r=Object(l.l)(e,n,t);return r&&r.length>0},e.prototype.ItemIsReadyForEvaluation=function(e){return!!e.EntityExtractionResult||!this.ItemHasEntityOnServer(e)},e.prototype.ItemHasEntityOnServer=function(e){if(!e.PropertyExistence)return!1;switch(this.itemHasKnownEntityRule.EntityType){case 3:return e.PropertyExistence.ExtractedAddresses;case 7:return e.PropertyExistence.ExtractedContacts;case 6:return e.PropertyExistence.ExtractedEmails;case 1:return e.PropertyExistence.ExtractedMeetings;case 5:return e.PropertyExistence.ExtractedPhones;case 2:return e.PropertyExistence.ExtractedTasks;case 4:return e.PropertyExistence.ExtractedUrls;default:return!1}},e.prototype.SaveRegexMatches=function(e,t){switch(this.itemHasKnownEntityRule.EntityType){case 3:t.filteredEntityMatches.Addresses||(t.filteredEntityMatches.Addresses={}),t.filteredEntityMatches.Addresses[this.itemHasKnownEntityRule.FilterName]=e;break;case 7:t.filteredEntityMatches.Contacts||(t.filteredEntityMatches.Contacts={}),t.filteredEntityMatches.Contacts[this.itemHasKnownEntityRule.FilterName]=e;break;case 6:t.filteredEntityMatches.EmailAddresses||(t.filteredEntityMatches.EmailAddresses={}),t.filteredEntityMatches.EmailAddresses[this.itemHasKnownEntityRule.FilterName]=e;break;case 1:t.filteredEntityMatches.MeetingSuggestions||(t.filteredEntityMatches.MeetingSuggestions={}),t.filteredEntityMatches.MeetingSuggestions[this.itemHasKnownEntityRule.FilterName]=e;break;case 5:t.filteredEntityMatches.PhoneNumbers||(t.filteredEntityMatches.PhoneNumbers={}),t.filteredEntityMatches.PhoneNumbers[this.itemHasKnownEntityRule.FilterName]=e;break;case 2:t.filteredEntityMatches.TaskSuggestions||(t.filteredEntityMatches.TaskSuggestions={}),t.filteredEntityMatches.TaskSuggestions[this.itemHasKnownEntityRule.FilterName]=e;break;case 4:t.filteredEntityMatches.Urls||(t.filteredEntityMatches.Urls={}),t.filteredEntityMatches.Urls[this.itemHasKnownEntityRule.FilterName]=e}},e}();function h(e,t){return t===g?function(e,t){var n=e[t];if(!e.TimeStringLength)return p(n);var r=n.slice(e.TimeStringBeginIndex,e.TimeStringBeginIndex+e.TimeStringLength),o=n.slice(e.TimeStringBeginIndex+e.TimeStringLength,n.length);if(0==o.length)return p(r);return p(r)+"(?="+p(o)+")"}(e,t):p(e[t])}var y=50,b=5e5,_=10240,S=n(98);function C(e){return 0===e.indexOf("ipm.note")||0===e.indexOf("ipm.schedule")||0===e.indexOf("ipm.sharing")}function O(e){return 0===e.indexOf("ipm.appointment")||"ipm.ole.class.{00061055-0000-0000-c000-000000000046}"==e}var I=function(){function e(e){this.itemIsRule=e}return e.prototype.Evaluate=function(e,t){return this.EvaluateItemType(e)&&this.EvaluateItemClass(e)},e.prototype.EvaluateItemType=function(e){var t=e.ItemClass;return!(1!=this.itemIsRule.ItemType||!t||!C(t.toLowerCase()))||(!(2!=this.itemIsRule.ItemType||!t||!O(t.toLowerCase()))||!this.itemIsRule.ItemType)},e.prototype.EvaluateItemClass=function(e){var t=e.ItemClass;return!this.itemIsRule.ItemClass||(this.itemIsRule.IncludeSubClasses?t&&0===t.toLowerCase().indexOf(this.itemIsRule.ItemClass.toLowerCase()):t&&this.itemIsRule.ItemClass.toLowerCase()===t.toLowerCase())},e.prototype.ItemIsReadyForEvaluation=function(e){return!0},e}(),A=function(){function e(e,t){this.itemHasRegularExpressionMatchRule=e,this.limits=t||r}return e.prototype.Evaluate=function(e,t){var n,r,o=this.GetPropertyForEvaluation(e,t),i=this.itemHasRegularExpressionMatchRule.RegExValue,a=this.itemHasRegularExpressionMatchRule.IgnoreCase,c=null;if(null!=o&&(c=Object(l.l)(o,i,a)),null==c)return t.evaluationResult.regExMatches[this.itemHasRegularExpressionMatchRule.RegExName]=[],!1;var u=this.removeDuplicatesAndApplyMatchLimits(c);if(t.evaluationResult.regExMatches[this.itemHasRegularExpressionMatchRule.RegExName]=u,2===this.itemHasRegularExpressionMatchRule.Highlight)return!0;if(2==this.itemHasRegularExpressionMatchRule.PropertyName)try{for(var d=s.__values(u),f=d.next();!f.done;f=d.next()){var m=f.value;t.terms.push(p(m))}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}return!0},e.prototype.ItemIsReadyForEvaluation=function(e){return!0},e.prototype.removeDuplicatesAndApplyMatchLimits=function(e){var t,n,r={},o=0;try{for(var i=s.__values(e),a=i.next();!a.done;a=i.next()){var c=a.value;if(o>=this.limits.MAX_REGEX_MATCHES)break;c.length<=this.limits.MAX_REGEX_MATCH_LENGTH&&(r[c]=1,o++)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return Object.keys(r)},e.prototype.GetPropertyForEvaluation=function(e,t){switch(this.itemHasRegularExpressionMatchRule.PropertyName){case 1:return e.Subject;case 4:return this.GetSenderSMTPAddress(e);case 3:return this.GetBodyWithLimits(e);case 2:if(t.plainTextBody)return t.plainTextBody;var n=this.GetBodyWithLimits(e);return t.plainTextBody=Object(l.g)(n),t.plainTextBody;default:return Object(S.a)(this.itemHasRegularExpressionMatchRule.PropertyName),""}},e.prototype.GetSenderSMTPAddress=function(e){if(C(e.ItemClass)){var t=e;if(t.Sender&&t.Sender.Mailbox)return t.Sender.Mailbox.EmailAddress}if(O(e.ItemClass)){var n=e;if(n.Organizer&&n.Organizer.Mailbox)return n.Organizer.Mailbox.EmailAddress}return null},e.prototype.GetBodyWithLimits=function(e){var t=this.GetBody(e);return null!=t&&t.length>this.limits.MAX_BODY_REGEX_ACTIVATION_LENGTH?null:t},e.prototype.GetBody=function(e){var t;e.NormalizedBody?t=e.NormalizedBody:e.UniqueBody?t=e.UniqueBody:e.Body&&(t=e.Body);var n=this.itemHasRegularExpressionMatchRule.PropertyName;return!t||"Text"===t.BodyType&&3===n?null:t.Value},e}();function T(e){if("ItemIs"==e.Type)return new I(e);if("ItemHasAttachment"==e.Type)return new f;if("ItemHasKnownEntity"==e.Type)return new v(e);if("ItemHasRegularExpressionMatch"==e.Type)return new A(e);if("Collection"==e.Type)return new d(e);throw new Error("Rule type not supported: "+e.Type)}var E=n(8);function x(e,t,n){var r,o={};e.length>0&&e.forEach(function(e){var i,a,c,l;c=r,l={evaluationResult:Object(u.i)(),highlightableEntities:{},terms:[]},c&&(l.plainTextBody=c.plainTextBody,l.highlightableEntities=c.highlightableEntities);var d=function(e,t,n){try{return function(e,t,n){if(T(e).Evaluate(t,n))return n.terms;return[]}(e.detectedEntity.Rule,t,n)}catch(e){return[]}}(e,t,r=l);try{for(var f=s.__values(d),p=f.next();!p.done;p=f.next()){var m=p.value;o[m]?o[m].push(e):o[m]=[e]}}catch(e){i={error:e}}finally{try{p&&!p.done&&(a=f.return)&&a.call(f)}finally{if(i)throw i.error}}d.length>0&&(n[e.extension.Id]=r.evaluationResult)});return new E.ObservableMap(o)}function P(e,t){try{return function(e,t){return T(e).ItemIsReadyForEvaluation(t)}(e.detectedEntity.Rule,t)}catch(e){return!0}}function M(e,t){return s.__awaiter(this,void 0,void 0,function(){var n;return s.__generator(this,function(r){switch(r.label){case 0:return function(e,t){var n,r;try{for(var o=s.__values(e),i=o.next();!i.done;i=o.next())if(!P(i.value,t))return!1}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!0}(t,e)?[3,2]:[4,Object(l.o)(e)];case 1:n=r.sent(),Object(u.ib)(e,n.EntityExtractionResult),r.label=2;case 2:return[2]}})})}var w=n(3548),R=n(5);function k(e,t){return s.__awaiter(this,void 0,void 0,function(){var n,r,o,i,a,c;return s.__generator(this,function(d){switch(d.label){case 0:return(n=Object(l.n)(t))?(r=!1,n.isSharedItem&&(r=n.isSharedItem()),o=function(e){var t=u.k.EnabledAddinCommands;if(!t)return[];var n=t.getExtensionPoint(w.a.DetectedEntity);if(0==n.length)return[];if(e){if(!Object(R.d)("addin-delegateAccess"))return[];n=Object(u.m)(n)}return n.map(function(e){return s.__spread(e.AddinCommands.values())[0]})}(r),i={},[4,M(e,o)]):[2];case 1:return d.sent(),a=x(o,e,i),c=new E.ObservableMap(i),Object(u.hb)(t,a,c),[2]}})})}var D=n(4141),j=n(4377),N=n(5045);function F(e,t,n){return void 0===n&&(n=!0),s.__awaiter(this,void 0,void 0,function(){var r;return s.__generator(this,function(o){switch(o.label){case 0:return Object(l.d)(e,t),Object(u.H)(e),((i=t.mode)==w.a.MessageRead||i==w.a.MeetingRequest||i==w.a.AppointmentAttendee)&&(r=t,Object(u.nb)(function(e,t){return function(){return k(e.getItem(),t)}}(r,e))),Object(l.r)(e),Object(N.e)(n),[4,Object(j.f)(t.mode)];case 1:return o.sent(),[4,Object(c.a)()];case 2:return o.sent(),Object(D.c)()&&Object(N.f)(N.a.Single,e),[2]}var i})})}function L(e){Object(l.j)(e),Object(N.b)(e),Object(u.j)(e),Object(u.h)(e),function(e,t){Object(u.J)(e)?Object(E.when)(function(){return!Object(u.J)(e)},function(){return t(e)}):t(e)}(e,U)}function U(e){Object(u.N)(e)||Object(l.i)(e)}var B=n(1356);function H(e,t){t==B.a.Deselected&&Object(N.b)(e)}function V(e){return!!Object(u.w)(e)&&null!=Object(u.w)(e).contextualTerms}function W(e,t){return Object(E.when)(function(){return V(e)},function(){return t(V(n=e)?s.__spread(Object(u.w)(n).contextualTerms.keys()):null);var n})}var G=n(4070),z=n(1352),q=n(1405),K=function(e){function t(){var t=e.call(this,{},{},{},{})||this;return t.extension={AppDomains:[q.e,q.d],Id:q.k,Version:q.i,Type:"Default",TypeString:"Default",Origin:"Default",OriginString:"Default",IconUrl:q.h,DisplayName:q.c,ConsentState:0,Description:q.b,ProviderName:q.j,HighResolutionIconUrl:q.g,AppStatus:"",LicenseType:0,Settings:"{}",RequestedCapabilities:1,DisableEntityHighlighting:!1,Enabled:!0,LicenseStatus:0,IsMandatory:!1,ExtensionPointCollection:t.get_ExtensionPointCollection()},t.addinId=q.k,t.commandId=q.a,t.endpoint=q.d,t}return s.__extends(t,e),t.prototype.get_EntryPoint=function(){return this.endpoint.toString()},t.prototype.get_Label=function(){return this.extension.DisplayName},t.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},t.prototype.get_Id=function(){return this.extension.Id},t.prototype.get_Size16Icon=function(){return this.extension.IconUrl},t.prototype.get_Version=function(){return this.extension.Version},t.prototype.get_ExtensionPointCollection=function(){return{FunctionFile:q.f,MessageReadCommandSurface:this.get_ExtensionPoint(),MessageComposeCommandSurface:null,AppointmentOrganizerCommandSurface:null,AppointmentAttendeeCommandSurface:null,Events:null,DetectedEntity:null,CustomPane:null,__type:"MessageReadCommandSurface"}},t.prototype.get_ExtensionPoint=function(){return{Tabs:[this.get_Tab()],__type:""}},t.prototype.get_Tab=function(){return{Type:0,Id:"TabDefault",Groups:[this.get_Group()],Label:q.c,__type:null}},t.prototype.get_Group=function(){return{Id:"ScreamGroup",Label:q.c,Controls:[this.get_TaskPaneControl()],__type:null}},t.prototype.get_IconUrls=function(){return{Size16Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon16x16.png",Size32Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon32x32.png",Size80Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon80x80.png",Size20Url:null,Size24Url:null,Size40Url:null,Size48Url:null,Size64Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon64x64.png",__type:null}},t.prototype.get_TaskPaneControl=function(){var e=this.get_Control();return e.Action={SourceLocation:q.f,__type:"TaskPaneButton"},e},t.prototype.get_Control=function(){return{Label:q.c,Supertip:{Title:"Translate Item",Description:q.b},Icon:this.get_IconUrls(),Id:q.a,__type:"ShowTaskpane"}},t}(u.a),X=n(4933);function J(e){return s.__awaiter(this,void 0,void 0,function(){var t;return s.__generator(this,function(n){switch(n.label){case 0:return[4,Object(X.a)()];case 1:return n.sent(),null==(t=new K)?[3,3]:[4,Object(N.g)(e,t,w.a.MessageRead)];case 2:return n.sent(),[2];case 3:return[2,null]}})})}var Q=n(4775),Y=n(5481),Z=n(9);function $(){var e=Object(u.t)().Context,t=Object(u.L)(),n=Object(Z.a)().SegmentationSettings.OnSendAddinsEnabled;return e&&t?n&&Object(Y.a)(1).length>0:n}var ee=n(2),te=n(1353),ne=n(8424),re=n(4),oe=n(6186);var ie=n(5482),ae=n(8425),se=n(4564),ce=n(5483),ue=n(271),le=n(18);function de(){return s.__awaiter(this,void 0,void 0,function(){var e;return s.__generator(this,function(t){switch(t.label){case 0:return[4,Object(ue.b)(Object(re.a)(ae.b),Object(re.a)(se.b),!1,{okText:Object(re.a)(ae.a),cancelText:Object(re.a)(se.a)})];case 1:return e=t.sent(),Object(le.o)("ExtGDPRMinorDialogResponse",[e]),e===ue.a.cancel&&Object(D.b)()&&Object(ce.a)(),[2]}})})}var fe=n(4563);function pe(e,t,n){return s.__awaiter(this,void 0,void 0,function(){var r,o,i;return s.__generator(this,function(a){switch(a.label){case 0:return Object(fe.f)(t)?[4,de()]:[3,2];case 1:return a.sent(),[2];case 2:return r=Object(l.n)(e),o=!0,r.mode!==w.a.MessageRead&&r.mode!==w.a.AppointmentAttendee||(i=r.getItem(),o=Object(u.Z)(i)),[4,Object(ue.b)(Object(re.a)(ne.a),"",o,{bodyElement:ee.createElement("p",null,Object(re.a)(ne.b)),hideCancelButton:!0})];case 3:return a.sent(),o?(oe.c(t.control)?Object(ie.a)(e,t,r.mode,n):oe.a(t.control)&&function(e,t){var n=Object(u.y)();Object(u.Y)(n,e,t)}(t,e),[2]):[2]}})})}var me=n(6188),ge=n(171),ve=function(){function e(e,t){this.key=e,this.name=t}return e.prototype.generateData=function(){return{key:this.key,name:this.name,title:this.description,ariaLabel:this.accessibilityText,iconProps:Object(me.a)(this.iconUrl),itemType:ge.a.Normal,getClickHandler:this.getClickHandler,subMenuProps:this.subMenuData?{items:[this.subMenuData.generateData()]}:null}},e}(),he=function(){function e(e,t){this.key=e,this.header=t,this.menuItemDataList=[]}return e.prototype.addItem=function(e){this.menuItemDataList.push(e)},e.prototype.generateItemsData=function(){var e,t;try{for(var n=s.__values(this.menuItemDataList),r=n.next();!r.done;r=n.next()){var o=r.value;this.data.push(o.generateData())}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.generateData=function(){return this.data=[],this.generateItemsData(),{key:this.key,itemType:ge.a.Section,sectionProps:{title:this.header,items:this.data}}},e}();function ye(e){var t=e.control,n=t.Id,r=t.Label,o=new ve(n,r);return e.isMenu?o.subMenuData=be(n,r,e.subCommands):e.isActionable&&(o.getClickHandler=Oe(e)),o.iconUrl=e.control.Icon.Size16Url,o.accessibilityText=e.control.Label,o.description=e.control.Supertip.Title,o}function be(e,t,n){var r,o,i=new he(e,t);try{for(var a=s.__values(n),c=a.next();!c.done;c=a.next()){var u=c.value;i.addItem(ye(u))}}catch(e){r={error:e}}finally{try{c&&!c.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return i}function _e(e){var t=new ve(e.Id,e.DisplayName);if(Object(fe.h)(e))if(Object(fe.g)(e))t.subMenuData=be(e.Id,e.DisplayName,Object(fe.d)(e).subCommands);else{var n=s.__spread(e.AddinCommands.values());t.subMenuData=be(e.Id,e.DisplayName,n)}else Object(fe.a)(e)&&(t.getClickHandler=Oe(Object(fe.d)(e)));return t.description=Object(fe.e)(e),t.accessibilityText=Object(fe.b)(e),t.iconUrl=e.IconUrl,t}var Se=n(8426);var Ce=n(6189);function Oe(e){return function(t){return function(n){n.stopPropagation(),pe(t,e)}}}function Ie(e){var t=function(e){var t,n,r=new he("AddinsHeader",Object(re.a)(Se.a));try{for(var o=s.__values(e),i=o.next();!i.done;i=o.next()){var a=i.value;r.addItem(_e(a))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}(e).generateData();return Object(R.d)("addin-inClientStoreEnabled")&&(t.sectionProps.items.push(Object(Ce.b)()),t.sectionProps.items.push(Object(Ce.a)())),t}var Ae=n(1166),Te=n(629),Ee=n(63),xe=n(20),Pe=n(8427),Me=function(e){function t(t){var n=e.call(this,t,{hasLoadFailed:!1})||this;return n.handleAddinButtonLeftClick=function(e){e.stopPropagation(),Object(fe.a)(n.props.addin)&&pe(n.props.hostItemIndex,Object(fe.d)(n.props.addin))},n.state={hasLoadFailed:!1},n}return s.__extends(t,e),t.prototype.onLoadingStateChanged=function(e){e==Ee.c.error?this.setState({hasLoadFailed:!0}):this.setState({hasLoadFailed:!1})},t.prototype.render=function(){var e={iconType:Te.a.Image,imageProps:{src:this.props.addin.IconUrl,width:16,height:16,imageFit:Ee.b.contain,onLoadingStateChange:this.onLoadingStateChanged.bind(this)}},t={iconType:Te.a.Default,iconName:"Photo2"},n=Object(fe.b)(this.props.addin),r={className:Pe.addinEntryButton,iconProps:this.state.hasLoadFailed?t:e,title:n,ariaLabel:n};if(Object(fe.a)(this.props.addin))return ee.createElement(Ae.a,s.__assign({onClick:this.handleAddinButtonLeftClick},r));if(Object(fe.h)(this.props.addin)){var o=_e(this.props.addin).generateData();return Object(te.a)(this.props.hostItemIndex,o),ee.createElement(Ae.a,s.__assign({onMenuClick:this.handleAddinButtonLeftClick,menuProps:o.subMenuProps,menuIconProps:null},r))}return null},t=s.__decorate([xe.observer],t)}(ee.Component),we=n(8429);var Re=function(e){var t,n,r=[];try{for(var o=s.__values(e.addins),i=o.next();!i.done;i=o.next()){var a=i.value;r.push(ee.createElement(Me,{hostItemIndex:e.hostItemIndex,addin:a,key:a.Id}))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return ee.createElement("div",{className:we.listViewContainer},r)},ke=n(8431),De=n(203),je=n.n(De),Ne=n(8432),Fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleChevronLeftClick=function(e){e.stopPropagation()},t}return s.__extends(t,e),t.prototype.render=function(){var e={iconType:Te.a.Default,iconName:"ChevronDownMed",className:je()([Ne.overflowChevron])},t={className:je()([Ne.overflowChevronContainer]),iconProps:e,title:Object(re.a)(ke.a),ariaLabel:Object(re.a)(se.c)},n=Ie(this.props.addins);return Object(te.a)(this.props.hostItemIndex,n),ee.createElement("div",{className:je()([Ne.overflowContainer])},ee.createElement("div",{className:je()([Ne.overflowDivider])}),ee.createElement(Ae.a,s.__assign({onMenuClick:this.handleChevronLeftClick,menuProps:{items:[n]},menuIconProps:null},t)))},t=s.__decorate([xe.observer],t)}(ee.Component),Le=n(8434),Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s.__extends(t,e),t.prototype.getMaxVisibleAddinsCount=function(e){switch(e){case w.a.MessageRead:return 3;case w.a.MessageCompose:default:return 5}},t.prototype.render=function(){var e=u.k.HostItems.get(this.props.Index),t=u.k.EnabledAddinCommands;if(!e||!t)return ee.createElement("div",null);var n=Object(l.n)(this.props.Index),r=this.getMaxVisibleAddinsCount(n.mode),o=t.getExtensionPoint(n.mode),i=null;return(r=Math.min(r,o.length))<o.length&&(i=ee.createElement(Fe,{hostItemIndex:this.props.Index,addins:o.slice(r,o.length)})),ee.createElement("div",{className:Le.divContainer},ee.createElement(Re,{hostItemIndex:this.props.Index,addins:o.slice(0,r)}),i)},t=s.__decorate([xe.observer],t)}(ee.Component),Be=n(6131),He=n(6141),Ve=n(6187);function We(e,t,n){Object(u.G)(e,t,n);var r=Object(u.t)();Object(Ve.a)(t,r.contextualCalloutState.activeContextualAddinCommands[0])}function Ge(e,t,n,r,o){return s.__awaiter(this,void 0,void 0,function(){var i;return s.__generator(this,function(a){switch(a.label){case 0:return null==(i=Object(fe.c)(t,n,r))?[3,2]:[4,pe(e,i,o)];case 1:return a.sent(),[2];case 2:return[2,null]}})})}var ze={};function qe(e,t){var n=function(e,t){return e+"_"+t}(e,t=!!t);return ze[n]||(ze[n]=Object(E.computed)(function(){var n=Object(u.t)().Context,r=Object(u.t)().EnabledAddinCommands;return r?function(e,t,n,r){if(n&&t.isInitialized){var o=t.getExtensionPoint(e,r);return Ie(o)}return null}(e,r,n,t):null})),ze[n]}var Ke=n(5452),Xe=n(6671),Je=n(8436),Qe=n(5049);function Ye(e){return s.__awaiter(this,void 0,void 0,function(){var t,n,r,o;return s.__generator(this,function(i){switch(i.label){case 0:if(!Object(R.d)("addin-itemSendEvent"))return[2,!0];if(t=Object(Qe.b)(),function(){var e=Object(u.t)().Context,t=Object(u.L)();if(Object(Z.a)().SegmentationSettings.OnSendAddinsEnabled&&(!e||!t))return Object(ue.b)(Object(re.a)(Xe.a),Object(re.a)(Je.b),!1,{hideCancelButton:!0}),!0;return!1}())return Object(Qe.d)(t,1),[2,!1];if(n=Object(u.u)(1),(r=Object(l.n)(e))&&r.isSharedItem&&r.isSharedItem()){if(!Object(R.d)("addin-delegateAccess"))return[2,!0];n=Object(u.l)(n)}!function(e,t){e.forEach(function(e){return Object(l.s)(t,e.extension.Id,e.extension.Id+"ItemSend")})}(n,e),o=0,i.label=1;case 1:return o<n.length?[4,Ze(e,n[o],t)]:[3,4];case 2:if(!i.sent())return[2,!1];t.addCheckmark("ItemSend"+o),i.label=3;case 3:return o++,[3,1];case 4:return n.length>0?Object(Qe.d)(t,4):t.invalidate(),[2,!0]}})})}function Ze(e,t,n){return s.__awaiter(this,void 0,void 0,function(){var r,o;return s.__generator(this,function(i){switch(i.label){case 0:return r=Object(u.y)(),[4,Object(u.Y)(r,t,e)];case 1:return(o=i.sent()).status!==u.d.Success||!1===o.allowEvent?(Object(l.e)(e,t.extension.Id,!1,t.extension.Id+"ItemSend",0,Object(re.b)(Object(re.a)(Je.a),t.extension.DisplayName)),Object(Qe.c)(n,o,t),[2,!1]):[2,!0]}})})}var $e=n(1),et=function(e,t){Object(R.d)("addin-autoRunAddins")&&Object(N.d)(e,t)},tt=Object($e.action)("onCompose",function(e){return{hostItemIndex:e}});Object($e.orchestrator)(tt,function(e){et(e.hostItemIndex,0)});var nt=tt;n.d(t,"removeExtensibilityNotification",function(){return o.h}),n.d(t,"updatePersistentNotifications",function(){return i.a}),n.d(t,"closeTaskPaneAddinCommand",function(){return a.a}),n.d(t,"initializeAddinsForItem",function(){return F}),n.d(t,"deinitializeAddinsForItem",function(){return L}),n.d(t,"onHostItemChanged",function(){return H}),n.d(t,"initializeExtensibilityContext",function(){return c.a}),n.d(t,"whenItemHasContextualAddinKeywords",function(){return W}),n.d(t,"triggerAppointmentTimeChangedEvent",function(){return G.e}),n.d(t,"triggerAttachmentsChangedEvent",function(){return G.f}),n.d(t,"triggerRecipientsChangedEvent",function(){return G.h}),n.d(t,"triggerRecurrenceChangedEvent",function(){return G.i}),n.d(t,"triggerLocationsChangedEvent",function(){return G.g}),n.d(t,"isTranslatorEnabled",function(){return z.a}),n.d(t,"launchTranslateCommand",function(){return J}),n.d(t,"setPersistedAddin",function(){return Q.a}),n.d(t,"shouldForceFullCompose",function(){return $}),n.d(t,"AddinBarView",function(){return Ue}),n.d(t,"TaskPaneCollection",function(){return Be.a}),n.d(t,"onComposeClose",function(){return He.a}),n.d(t,"openContextualCallout",function(){return We}),n.d(t,"launchAddinCommand",function(){return Ge}),n.d(t,"observeAddinCommandSurfaceItems",function(){return qe}),n.d(t,"onItemNavigation",function(){return Ke.a}),n.d(t,"allowItemSendEvent",function(){return Ye}),n.d(t,"onCompose",function(){return nt})},246:function(e,t,n){"use strict";var r=n(0),o=n(31),i=n(617),a=n(7),s=n(1140),c=Object(a.action)("deleteConversationItemParts")(Object(a.select)({conversations:function(){return o.H.conversations},conversationNodes:function(){return o.H.conversationNodes},items:function(){return o.H.items}})(function(e,t){var n,o,a,c;if(t.conversations.has(e)){var u=t.conversations.get(e);try{for(var l=r.__values(u.conversationNodeIds),d=l.next();!d.done;d=l.next()){var f=d.value,p=t.conversationNodes.get(f);try{for(var m=(a=void 0,r.__values(p.itemIds)),g=m.next();!g.done;g=m.next()){var v=g.value;Object(i.a)(v,1)}}catch(e){a={error:e}}finally{try{g&&!g.done&&(c=m.return)&&c.call(m)}finally{if(a)throw a.error}}t.conversationNodes.delete(f)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}t.conversations.delete(e)}Object(s.a)()})),u=n(24),l=function(e,t){var n=e,r=t;n.ToRecipients=r.ToRecipients,n.CcRecipients=r.CcRecipients,n.BccRecipients=r.BccRecipients};function d(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,i;return r.__generator(this,function(r){switch(r.label){case 0:return(t=Object(o.k)()).MaximumRecipientsToReturn=0,[4,Object(o.r)([e.ItemId.Id],t,"ItemPart")];case 1:return n=r.sent(),Object(o.g)(n[0])&&(i=n[0],l(e,i.Items[0])),[2]}})})}l=Object(a.action)("updateItemRecipients")(l);var f=Object(a.action)("setIsPendingDeleteConversationItemParts")(Object(a.select)({conversationItemParts:function(e){return o.H.conversations.get(e)}})(function(e,t,n){var r=n.conversationItemParts;r&&(r.isPendingDelete=t)})),p=n(18),m=n(813),g=Object(a.action)("getItemTailoredXpData")(Object(a.select)({items:function(){return o.H.items}})(function(e,t){var n=e.ItemId.Id,r=e.TailoredXpEntitiesChangeNumber;if(r&&r>0){var i=t.items.get(n),s=i&&i.TailoredXpEntitiesChangeNumber?i.TailoredXpEntitiesChangeNumber:0;if((!i||s<r)&&!e.TailoredXpEntities){var c=new p.a("RPPerfGetTailoredXpData"),u=Object(m.a)("TXPLoadMail");Object(o.G)(n).then(Object(a.action)("updateTailoredXpEntities")(function(e){var r=t.items.get(n);r&&(r.TailoredXpEntities=e.TailoredXpEntities,r.TailoredXpCalendarEventIds=e.TailoredXpCalendarEventIds,r.TailoredXpEntitiesStatus=e.TailoredXpEntitiesStatus,r.EntityNamesMap=e.EntityNamesMap),c.end(),u.end()})).catch(function(e){c.endWithError("ServerError",e),u.endWithError("ServerError",e)})}}})),v=Object(a.action)("getConversationTailoredXpData")(Object(a.select)({items:function(){return o.H.items}})(function(e,t,n){Object(o.m)(e,t).Items.forEach(function(e){g(e,n)})}));function h(e,t){return{conversationId:e,conversationNodeIds:[],conversationSortOrder:t,canLoadMore:!1,isLoadMoreInProgress:!1,maxItemsToReturn:B,loadingState:{isLoading:!1},syncState:"",isPendingDelete:!1,pendingRequestState:null,canDelete:null,subjectTranslationData:{isShowingTranslation:!1}}}var y=function(e,t){Object.keys(t).forEach(function(n){e[n]||(e[n]=t[n])})},b=[{name:"ItemClass",shouldInitializeUndefinedToNull:!1},{name:"LastModifiedTime",shouldInitializeUndefinedToNull:!1},{name:"DateTimeReceived",shouldInitializeUndefinedToNull:!1},{name:"ParentFolderId",shouldInitializeUndefinedToNull:!1},{name:"SystemCategories",shouldInitializeUndefinedToNull:!1},{name:"Hashtags",shouldInitializeUndefinedToNull:!1},{name:"PredictedActionReasons",shouldInitializeUndefinedToNull:!1},{name:"Flag",shouldInitializeUndefinedToNull:!1},{name:"IsRead",shouldInitializeUndefinedToNull:!1},{name:"Size",shouldInitializeUndefinedToNull:!1},{name:"IsClutter",shouldInitializeUndefinedToNull:!1},{name:"IconIndex",shouldInitializeUndefinedToNull:!1},{name:"Categories",shouldInitializeUndefinedToNull:!0},{name:"Likers",shouldInitializeUndefinedToNull:!0},{name:"LikeCount",shouldInitializeUndefinedToNull:!0},{name:"AdjacentMeetings",shouldInitializeUndefinedToNull:!0},{name:"ConflictingMeetings",shouldInitializeUndefinedToNull:!0}],_=function(e){b.forEach(function(t){t.shouldInitializeUndefinedToNull&&void 0===e[t.name]&&(e[t.name]=null)})},S=n(12),C=n(106),O="ChronologicalNewestOnBottom",I="PLACEHOLDER_NODE_INTERNET_MESSAGE_ID",A=function(e){return e.InternetMessageId},T=function(e){return e.ItemId.Id};function E(e,t,n){var o=function(e,t){var n=[];return e.forEach(function(e){n.push(t(e))}),n}(t,n);if(function(e,t){if(e.length!=t.length)return!0;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!0;return!1}(e,o)){var i=function(e,t){var n=[];return e.forEach(function(e){t.indexOf(e)<0&&n.push(e)}),n}(e,o),a=e.length;return e.splice.apply(e,r.__spread([0,a],o)),[!0,i]}return[!1,[]]}function x(e,t){Object(i.a)(e,1)}function P(e,t,n,i,a,s){!function(e,t,n,i,a){if(e.length>0){var s=a==O,c=s?e.length-1:0,u=n.get(e[c]);if(u.localLieState==o.e.Pending){var l=!0,d=function(e,t){return t.internetMessageId==I?t.itemIds&&t.itemIds.length>0?function(e,t){var n,o,i,a;try{for(var s=r.__values(e),c=s.next();!c.done;c=s.next()){var u=c.value;try{for(var l=(i=void 0,r.__values(u.Items)),d=l.next();!d.done;d=l.next()){var f=d.value;if(f.ItemId.Id==t)return u}}catch(e){i={error:e}}finally{try{d&&!d.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}return null}(e,t.itemIds[0]):null:function(e,t){var n,o;try{for(var i=r.__values(e),a=i.next();!a.done;a=i.next()){var s=a.value;if(A(s)==t)return s}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return null}(e,t.internetMessageId)}(t,u);d&&(d.Items[0].IsDraft?t.splice(t.indexOf(d),1):(l=!1,function(e,t){e.localLieState=o.e.Complete,e.hasQuotedText=t.HasQuotedText,e.isQuotedTextChanged=t.IsQuotedTextChanged,e.quotedTextList=t.QuotedTextList}(u,d),function(e,t){var n=t.get(e.itemIds[0]);n&&delete n.localLieSentTime}(u,i))),l&&(d={InternetMessageId:u.internetMessageId,Items:[i.get(u.itemIds[0])]},s?t.push(d):t.unshift(d))}}}(e,t,n,i,a);var c=E(e,t,A)[1],u={added:[],removed:[],modified:[]},l={isReadChangedToUnread:[]};return t.forEach(function(e){var t,a=A(e),c=n.get(a);c?(e.ParentInternetMessageId&&(c.parentInternetMessageId=e.ParentInternetMessageId),e.QuotedTextList&&(c.quotedTextList=e.QuotedTextList),e.QuotedTextState&&(c.quotedTextState=e.QuotedTextState),e.HasQuotedText&&(c.hasQuotedText=!0),e.IsQuotedTextChanged&&(c.isQuotedTextChanged=!0),t=c):(n.set(a,{conversationId:s.Id,internetMessageId:a,itemIds:[],quotedTextList:e.QuotedTextList,hasQuotedText:e.HasQuotedText,isQuotedTextChanged:e.IsQuotedTextChanged,quotedTextState:e.QuotedTextState,localLieState:o.e.None,parentInternetMessageId:e.ParentInternetMessageId}),t=n.get(a),u.added.push(a));var d=t.itemIds,f=r.__read(E(d,e.Items,T),2),p=f[0],m=f[1];c&&p&&u.modified.push(a),c&&!p&&function(e,t,n,o){var i,a;try{for(var s=r.__values(t),c=s.next();!c.done;c=s.next()){var u=c.value,l=n.get(u.ItemId.Id);l&&l.IsRead&&!u.IsRead&&o.isReadChangedToUnread.push(e)}}catch(e){i={error:e}}finally{try{c&&!c.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}}(a,e.Items,i,l),function(e,t,n,o,i){t.forEach(function(t){var n=t.ItemId.Id,a=o.get(n);_(t),t.ContainsOnlyMandatoryProperties?a?b.forEach(function(e){void 0!==t[e.name]&&(a[e.name]=t[e.name])}):e.splice(e.indexOf(n),1):(a&&y(t,a),o.set(n,r.__assign({TranslationData:{isShowingTranslation:!1,isTranslatable:!1,isTranslating:!1,shouldGetFeedback:!1,isShowingForwardContentTranslation:!1,isForwardContentTranslatable:!1,manuallyTranslated:!1,userLanguage:null}},t,{MailboxInfo:i,SmartReplyData:null,SmartTimeData:null,SmartTaskData:null,SmartTimeExtendedProperty:null,AttachmentSuggestions:null,ContextualAttachmentSuggestions:null,smartPillFeedbackSubmitted:!1,adaptiveCardDetails:null,YammerThreadId:null,itemCLPInfo:null})))}),n.forEach(function(e){x(e)})}(d,e.Items,m,i,s.mailboxInfo)}),c.forEach(function(e){!function(e,t,n){t.get(e).itemIds.forEach(function(e){x(e)}),t.delete(e)}(e,n),u.removed.push(e)}),[u,l]}var M=Object(a.action)("parseConversationResponse")(Object(a.select)({conversations:function(){return o.h},conversationNodes:function(){return o.H.conversationNodes},items:function(){return o.H.items}})(function(e,t,n,o){var i=n.Id,a=o.conversations.get(i);a||(a=h(n,t)),o.conversations.add(i,a),a=o.conversations.get(i);var s,c=!(e&&"Success"==e.ResponseClass);if(void 0===a.loadingState.hasLoadFailed&&(a.loadingState.hasLoadFailed=c),a.loadingState.hasLoadFailed&&Object(C.raiseAction)("conversationReadyToLoadStitch")(i),!c){var u=e.Conversation;if(!u.ConversationNodes)return S.c.warn("GCI response has no ConversationNodes, but TotalConversationNodesCount is "+u.TotalConversationNodesCount),a.loadingState.hasLoadFailed=!0,void Object(C.raiseAction)("conversationReadyToLoadStitch")(i);if(u.ConversationNodes.length==u.TotalConversationNodesCount)a.syncState=u.SyncState;else{var l=u.ConversationNodes.length,d=u.TotalConversationNodesCount;S.c.warn("Count of conversationNodes ("+l+") returned from GetConversationItems doesn't match TotalConversationNodesCount ("+d+")")}a.canLoadMore=u.RemainingConversationNodesCount>0||a.maxItemsToReturn<H&&u.ConversationNodes&&!(u.ConversationNodes.length<a.maxItemsToReturn),a.isLoadMoreInProgress=!1,a.canDelete=u.CanDelete||null,function(e,t,n,r){for(var o={},i=t.length,a=n==O,s=a?0:i-1,c=a?1:-1,u=function(){var n=t[s],i=e.get(n.InternetMessageId);i&&i.conversationId!=r.Id||o[n.InternetMessageId]?(n.InternetMessageId+=n.Items[0].ItemId.Id,n.Items.forEach(function(e){return e.InternetMessageId=n.InternetMessageId})):o[n.InternetMessageId]=!0,s+=c};s>=0&&s<i;)u()}(o.conversationNodes,u.ConversationNodes,t,n),v(u.ConversationNodes,t);var f=r.__read(P(a.conversationNodeIds,u.ConversationNodes,o.conversationNodes,o.items,t,n),2),p=f[0],m=f[1];((s=p).added.length>0||s.removed.length>0||s.modified.length>0)&&Object(C.raiseAction)("conversationReadyToLoadStitch")(i,p),function(e){return e.isReadChangedToUnread.length>0}(m)&&Object(C.raiseAction)("updateItemMandatoryPropertiesStitchAction")(i,m)}})),w=n(57),R=n.n(w);var k=n(56),D=n(5);function j(e){Object(k.a)()&&Object(D.d)("rp-amp")&&function(e,t){var n;e&&t&&(e.AdditionalProperties||(e.AdditionalProperties=[]),(n=e.AdditionalProperties).push.apply(n,r.__spread(t)))}(e,[R()({FieldURI:"AmpHtmlBody"})])}function N(e){return e&&"Success"!=e.ResponseClass?[e.ResponseCode,e.StackTrace]:[null,null]}function F(e){return["PrefetchFirstN","PrefetchSingleRow","PrefetchRowInCache","PrefetchAdjacentRowsOnDelay"].includes(e)}var L=n(9),U=n(210),B=20,H=100,V={};var W=Object(a.action)("processGetConversationItemsResponse")(function(e,t,n,r){M(n,e,t);var o=r.get(t.Id);o.loadingState.isLoading=!1,delete V[t.Id],o.pendingRequestState&&G(t,o.pendingRequestState.actionSource)}),G=Object(a.action)("loadConversation")(Object(a.select)({conversations:function(){return o.h}})(function(e,t,n,i){var a,s=Promise.resolve(),u=Object(L.a)().UserOptions.ConversationSortOrderReact,l=e.Id,d=i.conversations.get(l);if(d&&d.conversationSortOrder!=u&&(c(l),d=null),d&&!d.loadingState.hasLoadFailed||(d=h(e,u)),i.conversations.add(l,d),function(e,t){e.pendingRequestState?e.pendingRequestState.shouldUseEmptySyncState=e.pendingRequestState.shouldUseEmptySyncState||!e.syncState:e.pendingRequestState={shouldUseEmptySyncState:!e.syncState},e.pendingRequestState.actionSource=t}(d=i.conversations.get(l),t),n&&(a=n.addCheckmark("request_start")),d.loadingState.isLoading&&(F(t)||V[l]))V[l]&&(s=V[l],n&&n.addCustomData({pendingRequest:!0}));else{var f=d.pendingRequestState.shouldUseEmptySyncState;d.loadingState.isLoading=!0,d.pendingRequestState=null;var p=d.conversationId.mailboxInfo,m=p.returnModernConversationItems,g={};if(U(g,p&&p.requestOptions),g&&g.headers){var v=new Headers(g.headers);v.set("X-OWA-ActionSource",t),g.headers=v}var y=Object(o.n)();j(y),s=Object(o.o)(d.conversationId,y,d.syncState,d.maxItemsToReturn,u,f,m,Object(D.d)("rp-collapsedItemsRollUp")?"ReturnRootNode":"Default",g).then(function(t){if(n){var o=n.addCheckmark("request_end");n.addCustomData({requestTime:o-a})}W(u,e,t,i.conversations);var s=r.__read(N(t),2),c=s[0],l=s[1];return c?Promise.reject(new Error("ErrorResponseCode="+c+", StackTrace="+l)):Promise.resolve()}).catch(function(n){return W(u,e,null,i.conversations),n.message+=", ActionSource="+t,F(t)?Promise.resolve():Promise.reject(n)}),F(t)||(V[l]=s)}return s})),z={DeleteConversationStoreUpdate:"deleteConversationStoreUpdate",EmptyFolderStoreUpdate:"emptyFolderStoreUpdate",DeleteFolderAction:"deleteFolderAction",ForwardMessageAction:"forwardMessageAction",LoadDraftToComposeAction:"loadDraftToComposeAction",MarkAllAsReadStoreUpdate:"markAllAsReadStoreUpdate",ReloadMailListTableAction:"reloadMailListTableAction",SingleMailItemSelectedAction:"singleMailItemSelectedAction",SendFeedbackActionName:"SendFeedbackAction"},q=n(1015),K=n(889),X=n(1020),J=n(210),Q="X-OWA-ActionSource";var Y=Object(a.action)("parseItemResponse")(function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,i,a;return r.__generator(this,function(s){switch(s.label){case 0:return(n=o.H.items.get(t.Id))&&y(e,n),_(e),i=r.__assign({Smime:null},e,{MailboxInfo:t.mailboxInfo,SmartReplyData:null,SmartTimeData:null,SmartTaskData:null,SmartTimeExtendedProperty:null,AttachmentSuggestions:null,ContextualAttachmentSuggestions:null,smartPillFeedbackSubmitted:!1,adaptiveCardDetails:null,YammerThreadId:null,itemCLPInfo:null}),o.H.items.set(t.Id,i),a=o.H.items.get(t.Id),g(a),Object(K.a)(n)?[4,q.l.importAndExecute(a,n)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}})})});function Z(e,t,n,i){var a;n&&(a=n.addCheckmark("request_start"));var s={};J(s,e.mailboxInfo&&e.mailboxInfo.requestOptions);var c=s.headers?new Headers(s.headers):new Headers;i&&c.set(X.c,X.d),s&&s.headers&&c.set(Q,t),s.headers=c;var u=Object(o.k)();return j(u),Object(o.r)([e.Id],u,"ItemNormalizedBody","V2017_08_18",s).then(function(i){if(n){var s=n.addCheckmark("request_end");n.addCustomData({requestTime:s-a})}if(Object(o.g)(i[0])){var c=i[0];return Y(c.Items[0],e).then(function(){return o.H.items.get(e.Id)})}switch(t){case"PrefetchFirstN":case"PrefetchSingleRow":case"PrefetchRowInCache":case"PrefetchAdjacentRowsOnDelay":break;case"LoadItemReadingPane":case"LoadItemPreviewPane":default:S.c.warn(t+": "+i[0].MessageText)}var u=r.__read(N(i[0]),2),l=u[0],d=u[1];return l?Promise.reject(new Error("ErrorResponseCode="+l+", StackTrace="+d)):Promise.resolve(null)}).catch(function(e){return e.message+=", ActionSource="+t,F(t)?Promise.resolve():Promise.reject(e)})}function $(){return window.innerWidth||document.body.clientWidth}n.d(t,"h",function(){return d}),n.d(t,"f",function(){return c}),n.d(t,"k",function(){return f}),n.d(t,"i",function(){return G}),n.d(t,"c",function(){return 10}),n.d(t,"e",function(){return z}),n.d(t,"a",function(){return"applyConverstionFlagStateStoreUpdate"}),n.d(t,"b",function(){return"conversationReadyToLoadStitch"}),n.d(t,"d",function(){return"updateItemMandatoryPropertiesStitchAction"}),n.d(t,"j",function(){return Z}),n.d(t,"g",function(){return $}),Object(u.b)(function(){o.h.initialize(o.H.conversations,function(e){c(e)})})},250:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(27),o=n(5);function i(){return Object(o.d)("tri-inbox-plus-v1")&&null!==Object(r.f)().UserOptions.InboxPlusTabs}},2515:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),o=n(2),i=n(131),a=n(801),s=n(1452),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._skipComponentRefResolution=!0,t}return r.__extends(t,e),t.prototype.render=function(){return o.createElement(s.a,r.__assign({},this.props,{primary:!0,onRenderDescription:i.b}))},t=r.__decorate([Object(a.a)("PrimaryButton",["theme","styles"],!0)],t)}(i.a)},2519:function(e,t,n){"use strict";var r=n(4),o=n(1817),i=n(56),a=n(193),s="/owa/",c="service.svc/s/GetFileAttachment?id={0}",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",l="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",f="service.svc/s/GetAttachmentThumbnail?id={0}",p="pdfprint.aspx?id={0}",m="pdfprint.aspx?id={0}&location={1}",g=n(136),v=n(15);var h=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var y=n(98);function b(e,t,n,o,i,c,l,f){var p;switch(void 0===i&&(i=0),void 0===c&&(c=0),void 0===l&&(l=!0),void 0===f&&(f=null),n){case 0:p=u;break;case 3:p=m;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&h.indexOf(t.toLowerCase())>=0}(f))return null;p=d;break;default:Object(y.a)(n)}var g=o?c:i;!g&&i&&(g=i);var v=Object(r.b)("{0}{1}&permissionLevel={2}",s,Object(r.b)(p,encodeURIComponent(e.Id),encodeURIComponent(t)),g);l&&(v=v+"&X-OWA-CANARY="+Object(a.getOwaCanaryCookie)());return v}function _(e,t,n,u,d){var m;switch(void 0===u&&(u=!1),void 0===d&&(d=!0),n){case 0:m=c;break;case 1:m=l;break;case 2:m=f;break;case 3:m=p;break;default:return Object(y.a)(n)}return Object(r.g)(m)?null:Object(r.b)("{0}{1}{2}",function(e,t,n,c,u){if(void 0===u&&(u=!1),!t||!t.Id)return null;var l=Object(r.b)(n,encodeURIComponent(t.Id));if(!Object(o.c)()||u&&"Firefox"===Object(g.a)().browser)return s+l+"&X-OWA-CANARY="+Object(a.getOwaCanaryCookie)();var d="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(i.a)()&&(d+="&isc=1");var f=Object(r.b)(d,Object(o.b)(),e,l,window.location.hostname,Object(v.i)()||"unofficial");return c&&(f+="&X-OWA-CANARY="+Object(a.getOwaCanaryCookie)(),f+="&token="+Object(o.a)()),f}(e,t,m,d,3===n),u?"&isDownload=true":"","&animation=true")}n.d(t,"b",function(){return b}),n.d(t,"a",function(){return _})},2520:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,o=!1,i=function(a,s){o?s(new Error("The function retry was cancelled")):(r++,e().then(function(e){return a(e)}).catch(function(e){t&&r>=t?s(e):setTimeout(function(){return i(a,s)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return i(e,t)})},cancel:function(){return o=!0}}}}function o(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o})},2523:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"b",function(){return u});var r=n(4),o=n(2139),i=n(18);function a(e,t,n,o){return c(u(e),t,n,o,function(t,n){Object(i.o)("RecipientCacheHitIndex",[Math.ceil(n/50),!Object(r.g)(e),t.sessionAdd])})}function s(e,t,n,r){return c(e,t,n,r)}function c(e,t,n,r,i){for(var a=[],s=0;a.length<t&&o.a.recipientCache&&s<o.a.recipientCache.length;){var c=o.a.recipientCache[s];if(e(c)){var u=!1,d=c.EmailAddress;n&&l(d,n)&&(u=!0),r&&r.indexOf(d.MailboxType)>=0&&(u=!0),u||(a.push(c),i&&i(c,s))}s++}return a}var u=function(e){return function(t){var n=t.EmailAddress;if(n.EmailAddress&&0==n.EmailAddress.toLowerCase().indexOf(e))return!0;if(n.Name){if(0==n.Name.toLowerCase().indexOf(e))return!0;for(var r=n.Name.toLowerCase().split(" "),o=0;o<r.length;o++)if(0==r[o].indexOf(e))return!0}return!1}};function l(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}},2528:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(806);function o(){return(location?location.pathname:"").split("/").indexOf(r.c)>=0}},2529:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59);t.default=function(e){return r.makeServiceRequest("GetAttachmentDownloadToken",{},e)}},253:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(283),o=n(1),i=n(375),a=n(23),s={state:r.a.NotStarted,isPopoutV2:Object(a.a)(i.a)==i.b},c=Object(o.createStore)("popoutChild",s);c()},2531:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[o++]=a)}return i}},2532:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"Message:#Exchange"},e)}},2536:function(e,t,n){"use strict";function r(e){throw new Error("Unexpected object: "+e)}n.d(t,"a",function(){return r})},2538:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(3024);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("UpdateItem",e,t)}},2540:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateItemRequest:#Exchange"},e)}},2549:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Item=0]="Item",e[e.Oof=1]="Oof",e[e.FossilizedText=2]="FossilizedText",e[e.GlobalReply=3]="GlobalReply",e[e.SeeMore=4]="SeeMore"}(r||(r={}))},2552:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CreateItemRequest:#Exchange"},e)}},2553:function(e,t,n){"use strict";var r=n(0),o=n(1027),i=n(7),a=Object(i.action)("addInfoBarMessage")(function(e,t,n,i){void 0===n&&(n="0"),-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=r.__spread(e.infoBarIds),i&&(o.b[n]||(o.b[n]={}),o.b[n][t]=i)});t.a=a},2555:function(e,t,n){"use strict";t.a=function(e){return function(t){return null==t?void 0:t[e]}}},2576:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(2152),o=n(8),i=n(9),a=25*r.b;function s(){return c.get()}var c=Object(o.computed)(function(){var e=Object(i.a)();return e&&e.SessionSettings&&e.ApplicationSettings?(e.SessionSettings.MaxMessageSizeInKb-2048)*r.a:a})},2599:function(e){e.exports={a:"o5a"}},2600:function(e){e.exports={a:"k5a"}},2601:function(e){e.exports={a:"j5a"}},2605:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return u});var r=n(2549),o=n(306),i=n(7),a=Object(i.select)({conversationReadingPaneState:function(){return o.a.conversationReadingPaneViewState}})(function(e){return e.conversationReadingPaneState&&e.conversationReadingPaneState.focusedItemPart?e.conversationReadingPaneState.focusedItemPart.itemPart:null}),s=Object(i.select)({conversationReadingPaneState:function(){return o.a.conversationReadingPaneViewState}})(function(e){return e.conversationReadingPaneState&&e.conversationReadingPaneState.focusedItemPart?e.conversationReadingPaneState.focusedItemPart.focusedItemArea:null}),c=Object(i.select)({conversationReadingPaneState:function(){return o.a.conversationReadingPaneViewState}})(function(e){return e.conversationReadingPaneState&&e.conversationReadingPaneState.initiallySelectedItemPart?e.conversationReadingPaneState.initiallySelectedItemPart.itemPart:null}),u=Object(i.select)({conversationReadingPaneState:function(){return o.a.conversationReadingPaneViewState}})(function(e,t){var n=a(t),o=s(t);return n==e&&o==r.a.Item})},2618:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(9);function o(e){var t=Object(r.a)().UserOptions;return"HTML"==e?t.SignatureHtml:t.SignatureText}},2626:function(e,t,n){"use strict";var r=n(7),o=n(2553),i=Object(r.action)("addInfoBarMessageInReadingPane")(function(e,t,n){Object(o.a)(e,t,e.itemId,n)});t.a=i},263:function(e,t,n){"use strict";var r=n(0),o=n(923),i=n(1),a=(Object(i.orchestrator)(o.a,function(e){var t,n,o=e.itemContexts;try{for(var i=r.__values(o),a=i.next();!a.done;a=i.next()){var s=a.value;T.importAndExecute({Id:s.itemId},s.itemConversationId)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}),n(1650)),s=Object(i.mutatorAction)("updateIsLoadingFullBody",function(e,t){e.isLoadingFullBody=t}),c=Object(i.mutatorAction)("updateCachedItemBodies",function(e,t){t.UniqueBody&&(e.UniqueBody=t.UniqueBody),t.NormalizedBody&&(e.NormalizedBody=t.NormalizedBody)}),u=n(661),l=n(660),d=n(73),f=n(658),p=n(57),m=n.n(p),g=(Object(i.orchestrator)(a.a,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,o,i,a,p,g;return r.__generator(this,function(r){switch(r.label){case 0:return t=e.viewState,n=t.itemId,s(t,!0),o=d.a.items.get(n),i=Object(f.a)(),a="ItemPart",o.UniqueBody?o.NormalizedBody&&i.AdditionalProperties.push(m()({FieldURI:"NormalizedBody"})):a="ItemNormalizedBody",i.MaximumBodySize=0,[4,Object(u.a)([n],i,a)];case 1:return p=r.sent(),d.a.items.get(n)&&Object(l.a)(p[0])&&(g=p[0],c(o,g.Items[0]),s(t,!1)),[2]}})})}),n(1651)),v=n(1279),h=n(13),y=(Object(i.orchestrator)(v.a,function(e){var t=e.conversationIds,n=e.tableViewId,r=e.isReadValue;Object(g.a)(t,r,Object(h.o)(n))}),n(1652)),b=n(1280),_=(Object(i.orchestrator)(b.a,function(e){var t=e.itemIds,n=e.isReadValue;t.forEach(function(e){return Object(y.a)(e,n)})}),n(3)),S=(n(1463),n(1465),n(306));n.d(t,"f",function(){return O}),n.d(t,"a",function(){return I}),n.d(t,"n",function(){return A}),n.d(t,"b",function(){return T}),n.d(t,"o",function(){return E}),n.d(t,"j",function(){return x}),n.d(t,"g",function(){return P}),n.d(t,"k",function(){return M}),n.d(t,"m",function(){return w}),n.d(t,"h",function(){return R}),n.d(t,"i",function(){return k}),n.d(t,"d",function(){return j}),n.d(t,"e",function(){return N}),n.d(t,"l",function(){return F}),n.d(t,"c",function(){return L}),n.d(t,"p",function(){return S.a});var C=new _.c(function(){return Promise.all([n.e(4),n.e(7),n.e(8),n.e(19),n.e(336)]).then(n.bind(null,11676))}),O=new _.a(C,function(e){return e.loadConversationReadingPane}),I=(new _.a(C,function(e){return e.reloadReadingPane}),new _.a(C,function(e){return e.applyConversationFlagInReadingPane})),A=new _.a(C,function(e){return e.updateLoadedConversation}),T=new _.a(C,function(e){return e.cleanUpItemClientSide}),E=new _.a(C,function(e){return e.updateOnItemMandatoryPropertiesChange}),x=new _.a(C,function(e){return e.moveReadingPaneToTab}),P=new _.a(C,function(e){return e.loadConversationReadingPaneForSingleMailItemSelected}),M=new _.a(C,function(e){return e.print}),w=new _.a(C,function(e){return e.setItemIdToScrollTo}),R=new _.a(C,function(e){return e.loadItemReadingPane}),k=new _.a(C,function(e){return e.loadItemReadingPaneForSingleMailItemSelected}),D=new _.a(C,function(e){return e.initializeStitches}),j=new _.b(C,function(e){return e.getLastestNonDraftItemId}),N=new _.b(C,function(e){return e.isUnsupportedItem}),F=(new _.a(C,function(e){return e.setCalendarInlineComposeViewState}),new _.a(C,function(e){return e.replyByMeeting})),L=new _.a(C,function(e){return e.clearReadingPaneStore});D.importAndExecute()},266:function(e,t,n){"use strict";var r=n(47),o=(function(){}(),n(3)),i=n(24),a=n(1099),s=n(688),c=n(8),u=n(1),l=[r.a.SurfaceActions];Object(u.mutator)(a.a,function(e){var t=e.defaultOptions;l.forEach(function(e){t[e]&&Object(c.extendObservable)(Object(s.a)().options[e],t[e])})});var d=n(1075),f=n(680);n.d(t,"d",function(){return m}),n.d(t,"g",function(){return g}),n.d(t,"e",function(){return v}),n.d(t,"f",function(){return h}),n.d(t,"c",function(){return d.a}),n.d(t,"b",function(){return f.a}),n.d(t,"a",function(){return r.a});var p=new o.c(function(){return n.e(308).then(n.bind(null,11810))}),m=new o.a(p,function(e){return e.createOrUpdateOptionsForFeature}),g=new o.a(p,function(e){return e.updateAddinPinStatus}),v=new o.b(p,function(e){return e.getServerOptionsForFeature}),h=new o.a(p,function(e){return e.loadOptions});Object(i.c)(function(){h.importAndExecute()})},2674:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(9);function o(e){var t=Object(r.a)().UserOptions,n=!1;switch(e){case 0:n=t.AutoAddSignature;break;case 1:case 2:case 3:n=t.AutoAddSignatureOnReply}return n}},271:function(e,t,n){"use strict";n.d(t,"b",function(){return s});var r=n(3),o=n(1073);n.d(t,"a",function(){return o.a});var i=new r.c(function(){return Promise.all([n.e(0),n.e(1),n.e(30),n.e(474),n.e(155)]).then(n.bind(null,2150))}),a=new r.b(i,function(e){return e.confirmAction});function s(e,t,n,r){return a.import().then(function(o){return o(e,t,n,r)})}},275:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"e",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"f",function(){return l});var r=n(1),o=n(26),i=Object(r.action)("addFavoriteCompleted",function(e,t){return Object(o.a)({name:"AddFavoriteCompleted",customData:{temporaryFavoriteId:e.favoriteId,favoriteId:t.favoriteId,favoriteKind:t.type}},{temporaryData:e,favoriteData:t})}),a=Object(r.action)("addMultipleFavoritesCompleted",function(e,t){return Object(o.a)({name:"AddMultipleFavoritesCompleted"},{temporaryFavorites:e,favoritesData:t})}),s=Object(r.action)("addFavoriteFailed",function(e,t){return Object(o.a)({name:"AddFavoriteFailed",customData:{errorMessage:e?e.message:"Undefined error",cV:e?e.correlationVector:"Undefined error",favoriteId:t.favoriteId,favoriteKind:t.type}},{error:e,favoriteData:t,favoriteKind:t.type})}),c=Object(r.action)("addFavoriteToStore",function(e){return Object(o.a)({name:"AddFavoriteToStore",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})}),u=Object(r.action)("addFavoriteToStoreInitial",function(e){return Object(o.a)({name:"AddFavoriteToStoreInitial",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})}),l=Object(r.action)("addMultipleFavoritesToStore",function(e){return Object(o.a)({name:"AddMultipleFavoritesToStore"},{favoritesData:e})})},276:function(e,t,n){"use strict";var r=n(373),o=n(1),i=n(253);Object(o.mutator)(r.a,function(e){Object(i.a)().state=e.state});var a=n(951),s=n(0),c=n(2),u=n(523),l=n(5),d=n(20),f=n(283),p=n(1709),m=n(1336),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.loadData=function(){Object(u.a)()},t}return s.__extends(t,e),t.prototype.componentDidMount=function(){Object(l.d)("rp-popoutsDebug")||this.loadData()},t.prototype.render=function(){return c.createElement("div",{className:m.view},Object(i.a)().state==f.a.Loading?this.renderSpinner():this.renderDebugButton())},t.prototype.renderDebugButton=function(){return c.createElement("button",{onClick:this.loadData},"Get Data")},t.prototype.renderSpinner=function(){return c.createElement("span",null,c.createElement(p.a,null),this.props.loadingString)},t=s.__decorate([d.observer],t)}(c.Component),v=n(45);function h(e,t,n){var r=n?"readconv/":"read/";if(e&&e.type==v.a.GroupMailbox){r+="group/";var o=e.deprecatedMailboxId.split("@");r+=o[1]+"/"+o[0]+"/"}return r+=encodeURIComponent(n||t)}n.d(t,"c",function(){return a.a}),n.d(t,"g",function(){return r.a}),n.d(t,"b",function(){return g}),n.d(t,"a",function(){return f.a}),n.d(t,"f",function(){return i.a}),n.d(t,"d",function(){return u.b}),n.d(t,"e",function(){return h})},283:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"}(r||(r={}))},297:function(e,t,n){"use strict";n.d(t,"f",function(){return l}),n.d(t,"n",function(){return d}),n.d(t,"j",function(){return f}),n.d(t,"h",function(){return p}),n.d(t,"m",function(){return m}),n.d(t,"l",function(){return g}),n.d(t,"k",function(){return v}),n.d(t,"i",function(){return h}),n.d(t,"g",function(){return y}),n.d(t,"o",function(){return b});var r=n(320);n.d(t,"a",function(){return r.a});var o=n(1310);n.d(t,"e",function(){return o.a}),n.d(t,"d",function(){return o.b});var i=n(994);n.d(t,"c",function(){return i.a});var a=n(3),s=n(1596);n.d(t,"p",function(){return s.a});var c=n(993);n.d(t,"b",function(){return c.a});var u=new a.c(function(){return Promise.all([n.e(12),n.e(37),n.e(103)]).then(n.bind(null,2567))}),l=new a.a(u,function(e){return e.addAndInitializeAttachments}),d=new a.a(u,function(e){return e.setPreviewImageUrl}),f=new a.a(u,function(e){return e.refreshDownloadUrl}),p=new a.a(u,function(e){return e.createAttachmentInfo}),m=new a.a(u,function(e){return e.setAttachmentInfo}),g=new a.a(u,function(e){return e.refreshThumbnailImageUrl}),v=new a.a(u,function(e){return e.refreshPreviewImageUrl}),h=new a.b(u,function(e){return e.getAttachment}),y=new a.b(u,function(e){return e.checkPendingAttachmentOperation}),b=new a.b(u,function(e){return e.shouldShowImageView})},298:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(510),o=n(72);function i(e,t){var n=Object(r.a)(e,t);return o.a.tableViewConversationRelations.get(n)}},3013:function(e,t,n){"use strict";var r=n(637),o=n(1892),i=n(14),a={root:"ms-Dialog"};n.d(t,"a",function(){return s});var s=Object(r.a)(o.a,function(e){var t,n=e.className,r=e.containerClassName,o=e.dialogDefaultMinWidth,s=void 0===o?"288px":o,c=e.dialogDefaultMaxWidth,u=void 0===c?"340px":c,l=e.hidden,d=e.theme;return{root:[Object(i.getGlobalClassNames)(a,d).root,d.fonts.medium,n],main:[{width:s,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: "+i.ScreenWidthMinMedium+"px)"]={width:"auto",maxWidth:u,minWidth:s},t)},!l&&{display:"flex"},r]}},void 0,{scope:"Dialog"})},3017:function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},3022:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CreateItemJsonRequest:#Exchange"},e)}},3024:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateItemJsonRequest:#Exchange"},e)}},303:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a});var r=n(9),o=n(7);function i(e){return!!(e&Object(r.a)().ViewStateConfiguration.ListViewBitFlags)}var a=Object(o.action)("setBit")(function(e,t){i(t)!==e&&(e?Object(r.a)().ViewStateConfiguration.ListViewBitFlags|=t:Object(r.a)().ViewStateConfiguration.ListViewBitFlags&=~t)})},306:function(e,t,n){"use strict";n.d(t,"b",function(){return i});var r=n(664),o=n(1),i=Object(o.createStore)("readingpane",{conversationReadingPaneViewState:null,floatingActionBarViewState:{isVisible:!1,itemId:""},itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null}),a=i();r.a.registerReference(function(){return a.conversationReadingPaneViewState&&a.conversationReadingPaneViewState.conversationId.Id}),t.a=a},31:function(e,t,n){"use strict";var r=n(3),o=n(73),i=n(1176),a=n(147),s=n(566),c=n(886),u=n(745),l=n(1028),d=n(418),f=n.n(d),p=n(300),m=n(1029);function g(e,t,n,r,o,i,a,s,c,u,d,g,v){if(s){var h=Object(p.e)(e.Id,0);if(h)return Promise.resolve(h.Body.ResponseMessages.Items[0])}var y=f()({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:n});return Object(l.a)(e,y,r,o,i,a,c,u,Object(m.a)(r),d,g,v)}var v=n(661),h="ChronologicalNewestOnBottom";function y(e,t){return e[t==h?0:e.length-1]}var b=n(45),_=n(1367),S=n.n(_),C=n(108),O=n.n(C),I=n(1019),A=n.n(I),T=n(1368),E=n.n(T),x=n(230),P=n.n(x),M=n(1369),w=n.n(M),R=n(29),k=n(33);function D(e){return"ChronologicalNewestOnBottom"==e?"DateOrderAscending":"DateOrderDescending"}function j(e){var t=Object(k.a)("outbox");return!e&&t?[O()({Id:t})]:[]}function N(e,t,n,r,o,i,a,s,c){void 0===s&&(s="Default");var u=S()({ConversationId:P()(e)});u.SyncState=i?"":n;var l=function(e,t,n,r,o,i,a){return E()({Conversations:[e],ItemShape:t,ShapeName:"ItemPart",SortOrder:D(n),MaxItemsToReturn:r,ReturnModernConversationItems:o,Action:i,FoldersToIgnore:j(a)})}(u,t,o,r,a,s,function(e){var t=e.mailboxInfo;return t&&t.type==b.a.GroupMailbox}(e)),d=Object(R.getJsonRequestHeader)();return d.RequestServerVersion="V2017_08_18",w()(A()({Header:d,Body:l}),c).then(function(e){return e.Body.ResponseMessages.Items[0]})}var F=n(660),L=n(385),U=n.n(L),B=n(57),H=n.n(B);function V(e){return Object(v.a)([e],U()({BaseShape:"IdOnly",AdditionalProperties:[H()({FieldURI:"TailoredXpEntities"}),H()({FieldURI:"TailoredXpCalendarEventIds"}),H()({FieldURI:"TailoredXpEntitiesStatus"}),H()({FieldURI:"EntityNamesMap"})]}),"ItemTailoredXpData","Exchange2013").then(function(e){return function(e){if(Object(F.a)(e[0])){var t=e[0].Items[0];return{TailoredXpEntities:t.TailoredXpEntities,TailoredXpCalendarEventIds:t.TailoredXpCalendarEventIds,TailoredXpEntitiesStatus:t.TailoredXpEntitiesStatus,EntityNamesMap:t.EntityNamesMap}}return{}}(e)})}function W(e){return o.a.items.get(e)}var G=n(664),z=n(658),q=n(21),K=n(7),X=Object(K.select)({folderTable:function(){return q.n.folderTable}})(function(e,t){var n=t.folderTable.get(e);return!!n&&Object(q.ab)(n)}),J=n(668);function Q(e,t){var n=q.n.folderTable.get(e);return!!n&&(Object(q.N)(n,q.d,t)||n.DistinguishedFolderId===q.b)}function Y(e){return Q(e)||function(e){var t=q.n.folderTable.get(e);return t&&t.distinguishedFolderId===q.d}(e)}var Z=Object(K.select)({folderTable:function(){return q.n.folderTable}})(function(e,t,n){return Object(q.N)(e,t,n)}),$=n(1322),ee=n(305);function te(e){return e&&(Object(ee.a)(e,q.g)||Object(ee.a)(e,q.b))}function ne(e){return e&&(Z(e,q.f)||Z(e,q.a))}var re=n(437);function oe(e,t){try{return ie(e,t)}catch(e){return null}}function ie(e,t){if(!e||!t)return null;var n=Object(q.y)().get(e).PermissionSet.Permissions.filter(function(e){return e.UserId.PrimarySmtpAddress===t});return n&&n[0]}var ae=n(56),se="OneOff",ce="Unknown";function ue(e,t,n){return!Object(ae.a)()&&(n==se||n==ce)&&e.indexOf(t)<0}var le=n(1),de=Object(le.mutatorAction)("setIsDraftQueuedForSubmission",function(e,t){var n=Object(o.c)().items.get(e.Id);n&&(n.isDraftQueuedForSubmission=t)});n.d(t,"F",function(){return pe}),n.d(t,"E",function(){return me}),n.d(t,"H",function(){return o.a}),n.d(t,"t",function(){return o.c}),n.d(t,"e",function(){return i.a}),n.d(t,"f",function(){return a.a}),n.d(t,"c",function(){return s.a}),n.d(t,"p",function(){return s.c}),n.d(t,"q",function(){return c.b}),n.d(t,"i",function(){return u.c}),n.d(t,"a",function(){return u.a}),n.d(t,"b",function(){return u.b}),n.d(t,"j",function(){return g}),n.d(t,"r",function(){return v.a}),n.d(t,"m",function(){return y}),n.d(t,"o",function(){return N}),n.d(t,"G",function(){return V}),n.d(t,"I",function(){return W}),n.d(t,"h",function(){return G.a}),n.d(t,"g",function(){return F.a}),n.d(t,"l",function(){return z.b}),n.d(t,"k",function(){return z.a}),n.d(t,"n",function(){return z.c}),n.d(t,"D",function(){return X}),n.d(t,"d",function(){return J.a}),n.d(t,"z",function(){return Q}),n.d(t,"y",function(){return Y}),n.d(t,"A",function(){return Z}),n.d(t,"w",function(){return $.a}),n.d(t,"x",function(){return te}),n.d(t,"C",function(){return ne}),n.d(t,"s",function(){return re.a}),n.d(t,"u",function(){return oe}),n.d(t,"v",function(){return ie}),n.d(t,"B",function(){return ue}),n.d(t,"J",function(){return de});var fe=new r.c(function(){return n.e(441).then(n.bind(null,11879))}),pe=new r.a(fe,function(e){return e.findConversationWithSeekToDateTimeCondition}),me=new r.a(fe,function(e){return e.findConversationEqualToConversationId})},318:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var r=n(152),o=n(1),i={tabs:[{id:"primaryTab",type:r.a.Primary,isShown:!0,isActive:!0,blink:!1}],tabBarWidth:0,isOverflowMenuShown:!1},a=Object(o.createStore)("tab",i),s=(a(),a().tabs[0])},319:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.zero=0]="zero",e[e.medium=1]="medium",e[e.long=2]="long"}(r||(r={}))},320:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"g",function(){return o}),n.d(t,"h",function(){return i}),n.d(t,"n",function(){return a}),n.d(t,"i",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return l}),n.d(t,"f",function(){return d}),n.d(t,"j",function(){return f}),n.d(t,"k",function(){return p}),n.d(t,"l",function(){return m}),n.d(t,"m",function(){return g}),n.d(t,"o",function(){return v}),n.d(t,"p",function(){return h}),n.d(t,"q",function(){return y}),n.d(t,"a",function(){return b});var r="FileAttachment:#Exchange",o="ItemAttachment:#Exchange",i="ItemIdAttachment:#Exchange",a="ReferenceAttachment:#Exchange",s="LinkAttachment:#Exchange",c="Box",u="Dropbox",l="Facebook",d="GDrive",f="Mailbox",p="MailMessage",m="OneDriveConsumer",g="OneDrivePro",v="WopiBox",h="WopiDropbox",y="WopiEgnyte",b={providers:{BOX:c,DROPBOX:u,FACEBOOK:l,GDRIVE:d,MAILBOX:f,ONE_DRIVE_CONSUMER:m,ONE_DRIVE_PRO:g,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:v,WOPI_EGNYTE:y},attachmentTypes:{FILE_ATTACHMENT_TYPE:r,ITEM_ATTACHMENT_TYPE:o,ITEM_ID_ATTACHMENT_TYPE:i,REFERENCE_ATTACHMENT_TYPE:a,LINK_ATTACHMENT_TYPE:s}}},321:function(e,t,n){"use strict";var r=n(950),o=n(152),i=n(0),a=n(318);function s(e){var t,n,r=Object(a.a)();try{for(var s=i.__values(r.tabs),c=s.next();!c.done;c=s.next()){var u=c.value;if(u.type!==o.a.Primary&&u.data==e)return u}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return null}var c=n(808),u=n(3),l=n(812),d=n(1635),f=n(924),p=n(1);Object(p.mutator)(f.a,function(e){var t,n;try{for(var r=i.__values(Object(a.a)().tabs),s=r.next();!s.done;s=r.next()){var c=s.value;if(c.type==o.a.FloatingChat&&c.data==e.chatConversationId)return void Object(l.a)(c,!0)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}Object(d.a)(o.a.FloatingChat,!0,!0,e.chatConversationId)}),n.d(t,"e",function(){return g}),n.d(t,"f",function(){return v}),n.d(t,"g",function(){return h}),n.d(t,"h",function(){return y}),n.d(t,"a",function(){return o.a}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return c.a}),n.d(t,"d",function(){return a.a}),n.d(t,"i",function(){return a.b}),n.d(t,"j",function(){return r.b});var m=new u.c(function(){return Promise.all([n.e(0),n.e(1),n.e(518),n.e(13),n.e(388)]).then(n.bind(null,11593))}),g=new u.a(m,function(e){return e.activateTab}),v=new u.a(m,function(e){return e.addTab}),h=new u.a(m,function(e){return e.closeTab}),y=new u.a(m,function(e){return e.setTabIsShown})},346:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(454),o=n(12),i="X-AnchorMailbox";function a(e,t){try{var n={headers:new Headers},a=null;return e?a=Object(r.a)(e):t&&(a=Object(r.b)(t)),a&&n.headers.append(i,a),n}catch(n){return o.c.error(" getDefaultRequestOptions failed for folderId "+e+" and itemId "+t+" with error "+n),{}}}},347:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(132);function o(){return Object(r.a)().mailboxTable}},348:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(347);function o(e){var t=Object(r.a)(),n=t&&t.get(e);return n&&n.rootFolder}},3489:function(e,t,n){"use strict";var r,o,i,a,s,c,u=n(637),l=n(0),d=n(2),f=n(1166),p=n(1868),m=n(2300),g=n(2093),v=n(14),h=n(146),y=n(506),b=n(115),_=n(249),S=n(58),C=n(222),O=n(131),I=n(2296),A=n(922),T=Object(h.a)(),E=function(e){function t(t){var n=e.call(this,t)||this;return n._panel=d.createRef(),n.dismiss=function(e){n._isOpen&&(n._isOpen=!1,n.props.onDismiss&&n.props.onDismiss(e),(!e||e&&!e.defaultPrevented)&&n.setState({isAnimating:!0},function(){n._async.setTimeout(n._onTransitionComplete,200)}))},n._allowScrollOnPanel=function(e){e?Object(y.b)(e,n._events):n._events.off(n._scrollableContent),n._scrollableContent=e},n._onRenderNavigation=function(e){if(!n.props.onRenderNavigationContent&&!n.props.onRenderNavigation&&!n.props.hasCloseButton)return null;var t=n.props.onRenderNavigationContent,r=void 0===t?n._onRenderNavigationContent:t;return d.createElement("div",{className:n._classNames.navigation},r(e,n._onRenderNavigationContent))},n._onRenderNavigationContent=function(e){var t=e.closeButtonAriaLabel,r=e.hasCloseButton,o=Object(v.getTheme)();return r?d.createElement(f.a,{styles:{root:{height:"auto",width:"44px",color:o.palette.neutralSecondary,fontSize:v.IconFontSizes.large},rootHovered:{color:o.palette.neutralPrimary}},className:n._classNames.closeButton,onClick:n._onPanelClick,ariaLabel:t,title:t,"data-is-visible":!0,iconProps:{iconName:"Cancel"}}):null},n._onRenderHeader=function(e,t,r){var o=e.headerText;return o?d.createElement("div",{className:n._classNames.header},d.createElement("p",{className:n._classNames.headerText,id:r,role:"heading","aria-level":2},o)):null},n._onRenderBody=function(e){return d.createElement("div",{className:n._classNames.content},e.children)},n._onRenderFooter=function(e){var t=n.props.onRenderFooterContent,r=void 0===t?null:t;return r?d.createElement("div",{className:n._classNames.footer},d.createElement("div",{className:n._classNames.footerInner},r())):null},n._onPanelClick=function(e){n.dismiss(e)},n._onTransitionComplete=function(){n._updateFooterPosition(),n.setState({isAnimating:!1}),n._isOpen&&n.props.onOpened&&n.props.onOpened(),!n._isOpen&&n.props.onDismissed&&n.props.onDismissed()},n._warnDeprecations({ignoreExternalFocusing:"focusTrapZoneProps",forceFocusInsideTrap:"focusTrapZoneProps",firstFocusableSelector:"focusTrapZoneProps"}),n._isOpen=!!t.isOpen,n.state={isFooterSticky:!1,isAnimating:!1,id:Object(b.c)("Panel")},n}return l.__extends(t,e),t.prototype.componentDidMount=function(){this._events.on(window,"resize",this._updateFooterPosition),this._shouldListenForOuterClick(this.props)&&this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0),this.props.isOpen&&this.open()},t.prototype.componentDidUpdate=function(e){var t=this._shouldListenForOuterClick(this.props),n=this._shouldListenForOuterClick(e);t&&!n?this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0):!t&&n&&this._events.off(document.body,"mousedown",this._dismissOnOuterClick,!0)},t.prototype.componentWillReceiveProps=function(e){e.isOpen!==this._isOpen&&(e.isOpen?this.open():this.dismiss())},t.prototype.render=function(){var e=this.props,t=e.className,n=void 0===t?"":t,r=e.elementToFocusOnDismiss,o=e.firstFocusableSelector,i=e.focusTrapZoneProps,a=e.forceFocusInsideTrap,s=e.hasCloseButton,c=e.headerText,u=e.headerClassName,f=void 0===u?"":u,v=e.ignoreExternalFocusing,h=e.isBlocking,y=e.isFooterAtBottom,b=e.isLightDismiss,C=e.isHiddenOnDismiss,O=e.layerProps,E=e.type,x=e.styles,P=e.theme,M=e.customWidth,w=e.onLightDismissClick,R=void 0===w?this._onPanelClick:w,k=e.onRenderNavigation,D=void 0===k?this._onRenderNavigation:k,j=e.onRenderHeader,N=void 0===j?this._onRenderHeader:j,F=e.onRenderBody,L=void 0===F?this._onRenderBody:F,U=e.onRenderFooter,B=void 0===U?this._onRenderFooter:U,H=this.state,V=H.isFooterSticky,W=H.isAnimating,G=H.id,z=E===A.a.smallFixedNear||E===A.a.customNear,q=Object(_.a)()?z:!z,K=c&&G+"-headerText",X=E===A.a.custom||E===A.a.customNear?{width:M}:{},J=Object(S.f)(this.props,S.e),Q=this._isOpen;if(!Q&&!W&&!C)return null;this._classNames=T(x,{theme:P,className:n,focusTrapZoneClassName:i?i.className:void 0,hasCloseButton:s,headerClassName:f,isAnimating:W,isFooterAtBottom:y,isFooterSticky:V,isOnRightSide:q,isOpen:Q,isHiddenOnDismiss:C,type:E});var Y,Z=this._classNames;h&&Q&&(Y=d.createElement(m.a,{className:Z.overlay,isDarkThemed:!1,onClick:b?R:void 0}));var $=N(this.props,this._onRenderHeader,K);return d.createElement(p.a,l.__assign({},O),d.createElement(g.a,{role:"dialog","aria-modal":"true",ariaLabelledBy:$?K:void 0,onDismiss:this.dismiss,className:Z.hiddenPanel},d.createElement("div",l.__assign({"aria-hidden":!Q&&W},J,{ref:this._panel,className:Z.root}),Y,d.createElement(I.a,l.__assign({ignoreExternalFocusing:v,forceFocusInsideTrap:!(!h||C&&!Q)&&a,firstFocusableSelector:o,isClickableOutsideFocusTrap:!0},i,{className:Z.main,style:X,elementToFocusOnDismiss:r}),d.createElement("div",{className:Z.commands,"data-is-visible":!0},D(this.props,this._onRenderNavigation)),d.createElement("div",{className:Z.contentInner},$,d.createElement("div",{ref:this._allowScrollOnPanel,className:Z.scrollableContent,"data-is-scrollable":!0},L(this.props,this._onRenderBody)),B(this.props,this._onRenderFooter))))))},t.prototype.open=function(){var e=this;this._isOpen||(this._isOpen=!0,this.setState({isAnimating:!0},function(){e._async.setTimeout(e._onTransitionComplete,200)}),this.props.onOpen&&this.props.onOpen())},t.prototype._shouldListenForOuterClick=function(e){return!!e.isBlocking&&!!e.isOpen},t.prototype._updateFooterPosition=function(){var e=this._scrollableContent;if(e){var t=e.clientHeight,n=e.scrollHeight;this.setState({isFooterSticky:t<n})}},t.prototype._dismissOnOuterClick=function(e){var t=this._panel.current;this._isOpen&&t&&(Object(C.a)(t,e.target)||(this.props.onOuterClick?(this.props.onOuterClick(),e.preventDefault()):this.dismiss()))},t.defaultProps={isHiddenOnDismiss:!1,isOpen:!1,isBlocking:!0,hasCloseButton:!0,type:A.a.smallFixedFar},t}(O.a),x=n(101),P={root:"ms-Panel",main:"ms-Panel-main",commands:"ms-Panel-commands",contentInner:"ms-Panel-contentInner",scrollableContent:"ms-Panel-scrollableContent",navigation:"ms-Panel-navigation",closeButton:"ms-Panel-closeButton ms-PanelAction-close",header:"ms-Panel-header",headerText:"ms-Panel-headerText",content:"ms-Panel-content",footer:"ms-Panel-footer",footerInner:"ms-Panel-footerInner",isOpen:"is-open",hasCloseButton:"ms-Panel--hasCloseButton",smallFluid:"ms-Panel--smFluid",smallFixedNear:"ms-Panel--smLeft",smallFixedFar:"ms-Panel--sm",medium:"ms-Panel--md",large:"ms-Panel--lg",largeFixed:"ms-Panel--fixed",extraLarge:"ms-Panel--xl",custom:"ms-Panel--custom",customNear:"ms-Panel--customLeft"},M="100%",w="auto",R=272,k=340,D=592,j=644,N=940,F="auto",L=0,U=48,B=428,H=176,V=((r={})["@media (min-width: "+v.ScreenWidthMinMedium+"px)"]={width:k},r),W=((o={})["@media (min-width: "+v.ScreenWidthMinLarge+"px)"]={width:D},o["@media (min-width: "+v.ScreenWidthMinXLarge+"px)"]={width:j},o),G=((i={})["@media (min-width: "+v.ScreenWidthMinUhfMobile+"px)"]={left:U,width:w},i["@media (min-width: "+v.ScreenWidthMinXXLarge+"px)"]={left:B},i),z=((a={})["@media (min-width: "+v.ScreenWidthMinXXLarge+"px)"]={left:F,width:N},a),q=((s={})["@media (min-width: "+v.ScreenWidthMinXXLarge+"px)"]={left:H},s),K=function(e){var t;switch(e){case A.a.smallFixedFar:t=l.__assign({},V);break;case A.a.medium:t=l.__assign({},V,W);break;case A.a.large:t=l.__assign({},V,W,G);break;case A.a.largeFixed:t=l.__assign({},V,W,G,z);break;case A.a.extraLarge:t=l.__assign({},V,W,G,q)}return t},X={paddingLeft:"16px",paddingRight:"16px",selectors:(c={},c["@media screen and (min-width: "+v.ScreenWidthMinLarge+"px)"]={paddingLeft:"32px",paddingRight:"32px"},c["@media screen and (min-width: "+v.ScreenWidthMinXXLarge+"px)"]={paddingLeft:"40px",paddingRight:"40px"},c)};n.d(t,"a",function(){return J});var J=Object(u.a)(E,function(e){var t,n,r=e.className,o=e.focusTrapZoneClassName,i=e.hasCloseButton,a=e.headerClassName,s=e.isAnimating,c=e.isFooterAtBottom,u=e.isFooterSticky,d=e.isOnRightSide,f=e.isOpen,p=e.isHiddenOnDismiss,m=e.theme,g=e.type,h=void 0===g?A.a.smallFixedFar:g,y=m.palette,b=Object(v.getGlobalClassNames)(P,m),_=h===A.a.custom||h===A.a.customNear,S=Object(x.a)(),C=void 0!==S?S.innerHeight:"100%";return{root:[b.root,m.fonts.medium,f&&b.isOpen,i&&b.hasCloseButton,{pointerEvents:"none",position:"absolute",top:0,left:0,right:0,bottom:0},_&&d&&b.custom,_&&!d&&b.customNear,r],overlay:[{pointerEvents:"auto",cursor:"pointer"},f&&s&&v.AnimationClassNames.fadeIn100,!f&&s&&v.AnimationClassNames.fadeOut100],hiddenPanel:[!f&&!s&&p&&{visibility:"hidden"}],main:[b.main,{backgroundColor:y.white,boxShadow:"0px 0px 30px 0px rgba(0,0,0,0.2)",pointerEvents:"auto",position:"absolute",display:"flex",flexDirection:"column",overflowX:"hidden",overflowY:"auto",WebkitOverflowScrolling:"touch",maxHeight:C,bottom:0,top:0,left:F,right:L,width:M,selectors:l.__assign((t={},t[v.HighContrastSelector]={borderLeft:"3px solid "+y.neutralLight,borderRight:"3px solid "+y.neutralLight},t),K(h))},h===A.a.smallFluid&&{left:L},h===A.a.smallFixedNear&&{left:L,right:F,width:R},h===A.a.customNear&&{right:"auto",left:0},_&&{maxWidth:"100vw"},c&&{height:C},f&&s&&!d&&v.AnimationClassNames.slideRightIn40,f&&s&&d&&v.AnimationClassNames.slideLeftIn40,!f&&s&&!d&&v.AnimationClassNames.slideLeftOut40,!f&&s&&d&&v.AnimationClassNames.slideRightOut40,o],commands:[b.commands],navigation:[b.navigation,{padding:"0 5px",height:"44px",display:"flex",justifyContent:"flex-end"}],closeButton:[b.closeButton],contentInner:[b.contentInner,{display:"flex",flexDirection:"column",flexGrow:1,maxHeight:C,overflowY:"hidden"},c&&{height:C}],header:[b.header,X,{margin:"14px 0",flexGrow:0,selectors:(n={},n["@media (min-width: "+v.ScreenWidthMinXLarge+"px)"]={marginTop:"30px"},n)}],headerText:[b.headerText,v.DefaultFontStyles.xLarge,{color:y.neutralPrimary,lineHeight:"32px",margin:0},a],scrollableContent:[b.scrollableContent,{overflowY:"auto",height:C}],content:[b.content,X,{marginBottom:0,paddingBottom:20}],footer:[b.footer,{flexGrow:0,borderTop:"1px solid transparent",transition:"opacity "+v.AnimationVariables.durationValue3+" "+v.AnimationVariables.easeFunction2},u&&{background:y.white,borderTopColor:y.neutralLight}],footerInner:[b.footerInner,X,{paddingBottom:"20px",paddingTop:"20px"}]}},void 0,{scope:"Panel"})},350:function(e,t,n){"use strict";var r=n(3),o=n(1136),i=n(24),a=n(1101);function s(){var e=Object(a.a)();return{isFullOptionsShown:e.isFullOptionsShown,currentCategoryKey:e.currentCategoryKey,currentSubCategoryKey:e.currentSubCategoryKey,currentOptionKey:e.currentOptionKey}}n.d(t,"e",function(){return u}),n.d(t,"d",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"a",function(){return f}),n.d(t,"b",function(){return s});var c=new r.c(function(){return Promise.all([n.e(3),n.e(19),n.e(29),n.e(67),n.e(307)]).then(n.bind(null,11649))}),u=new r.a(c,function(e){return e.mountAndShowFullOptions}),l=new r.b(c,function(e){return e.hideFullOptions}),d=new r.b(c,function(e){return e.confirmDirtyOptionsAndPerformAction}),f=Object(r.d)(c,function(e){return e.QuickOptions});Object(i.c)(function(){o.b.importAndExecute()})},3538:function(e,t,n){"use strict";var r,o=function(){return function(e,t){if(this.AddinCommands=t,!this.AddinCommands)throw new Error("AddinCommands cannot be null while constructing an addin");this.DisplayName=e.DisplayName,this.IconUrl=e.IconUrl,this.HighResolutionIconUrl=e.HighResolutionIconUrl,this.Id=e.Id}}(),i=n(0),a=n(6186),s=n(98),c=function(){function e(t,n,r,o){var s,c;if(this.control=t,this.tabInfo=n,this.groupInfo=r,this.extension=o,a.b(t)){var u=t;this.subCommands=[];try{for(var l=i.__values(u.MenuItems),d=l.next();!d.done;d=l.next()){var f=d.value;this.subCommands.push(new e(f,n,r,o))}}catch(e){s={error:e}}finally{try{d&&!d.done&&(c=l.return)&&c.call(l)}finally{if(s)throw s.error}}}}return Object.defineProperty(e.prototype,"isActionable",{get:function(){return!!this.control.Action},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMenu",{get:function(){return!!this.control.MenuItems},enumerable:!0,configurable:!0}),e.prototype.get_EntryPoint=function(){return a.c(this.control)?this.control.Action.SourceLocation:a.a(this.control)?this.extension.ExtensionPointCollection.FunctionFile:(Object(s.a)(this.control),"")},e.prototype.get_Id=function(){return this.extension.Id+this.control.Id},e.prototype.get_Label=function(){return this.control.Label},e.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},e.prototype.get_Size16Icon=function(){return this.control&&this.control.Icon?this.control.Icon.Size16Url:null},e.prototype.getControl=function(){return this.control},e}(),u=function(){function e(e,t){this.detectedEntity=e,this.extension=t}return e.prototype.get_EntryPoint=function(){return this.detectedEntity.SourceLocation},e.prototype.get_Id=function(){return this.extension.Id},e.prototype.get_Label=function(){return this.detectedEntity.Label},e.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},e.prototype.get_ActivationRule=function(){return this.detectedEntity.Rule},e.prototype.get_Size16Icon=function(){return this.extension.IconUrl},e.prototype.getControl=function(){return null},e}();!function(e){e[e.TimedOut=-1]="TimedOut",e[e.Success=0]="Success",e[e.FunctionNotFound=11101]="FunctionNotFound",e[e.NavigatedBeforeCompleted=13001]="NavigatedBeforeCompleted",e[e.PreinstalledConsented=13002]="PreinstalledConsented",e[e.Unknown=13003]="Unknown"}(r||(r={}));var l=r,d=n(1043),f=n(94);function p(){return Object(f.a)()}var m=n(1),g=n(746),v=Object(m.mutatorAction)("setAutoRunAddinCommandWaitingQueue",function(e,t){var n=Object(g.a)().autoRunAddinCommandWaitingQueue;n.has(t)||n.set(t,new Array),n.get(t).push(e)}),h=Object(m.mutatorAction)("destroyAutoRunAddinCommandFromWaitingQueue",function(e,t){var n=Object(g.a)().autoRunAddinCommandWaitingQueue;if(n.has(t)){for(var r=n.get(t),o=0;o<r.length;o++)if(r[o].get_Id()===e){r.splice(o,1);break}0===r.length&&n.delete(t)}}),y=n(7),b=n(8),_="DeferrablePromise timed out",S=function(){function e(e){var t=this;this.internalPromise=new Promise(function(n,r){t.internalResolve=n,t.internalReject=r,t.timeout=setTimeout(function(){r(new Error(_)),t.isRejected=!0},e)})}return e.prototype.then=function(e,t){return this.internalPromise.then(e,t)},e.prototype.catch=function(e){return this.internalPromise.catch(e)},e.prototype.resolve=function(e){this.isFullfilled&&this.isRejected||(this.internalResolve(e),this.isFullfilled=!0,clearTimeout(this.timeout))},e.prototype.reject=function(e){this.isFullfilled&&this.isRejected||(this.internalReject(e),this.isRejected=!0,clearTimeout(this.timeout))},e}(),C=33e4,O={};var I=Object(y.action)("setUilessAddinCommand")(function(e,t,n){var r=function(e){var t=new S(C);return O[e]=t,t.catch(function(e){return e.message===_?{status:l.TimedOut}:{status:l.Unknown}})}(e),o=Object(g.a)().runningUILessAddinCommands;return o.has(n)||o.set(n,new b.ObservableMap),o.get(n).set(e,t),r}),A=n(3548),T=function(){function e(e,t,n,r){this.event=e,this.control=t,this.extension=n,this.mode=r}return e.prototype.getTriggeringEvent=function(){return this.event},e.prototype.getControl=function(){return this.control},e.prototype.get_EntryPoint=function(){switch(this.mode){case A.a.AutoRunOnMessageCompose:return this.extension.ExtensionPointCollection.AutoRunOnMessageCompose.PageSourceLocation;case A.a.AutoRunOnAppointmentOrganizer:return this.extension.ExtensionPointCollection.AutoRunOnAppointmentOrganizer.PageSourceLocation;default:return null}},e.prototype.get_Label=function(){return this.control.Label},e.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},e.prototype.get_Id=function(){return this.extension.Id},e.prototype.get_Size16Icon=function(){return this.extension.IconUrl},e}(),E=function(e,t){e.forEach(function(e){k(e,t)&&v(e,t)})},x=function(e){P(e).forEach(function(t){var n=p(),r=t.get_Id();M(r,e)&&(I(n,t,e),h(r,e))})},P=function(e){var t=Object(g.a)().autoRunAddinCommandWaitingQueue;return t.has(e)?t.get(e):[]},M=function(e,t){return!w(e,t)&&!R(t)},w=function(e,t){var n=Object(g.a)().runningUILessAddinCommands,r=!1;return!!n.has(t)&&(n.get(t).forEach(function(t){D(t)&&t.get_Id()===e&&(r=!0)}),r)},R=function(e){var t=Object(g.a)().runningUILessAddinCommands,n=0;return t.has(e)&&t.get(e).forEach(function(e){D(e)&&(n+=1)}),n>=10},k=function(e,t){for(var n=P(t),r=0;r<n.length;r++){var o=e.getTriggeringEvent()===n[r].getTriggeringEvent(),i=e.get_Id()===n[r].get_Id();if(o&&i)return!1}return!0},D=function(e){return e instanceof T},j=n(5481),N=function(){function e(){}return e.prototype.CreateAddinCommand=function(e,t,n,r){return new c(e,t,n,r)},e.prototype.CreateContextualAddinCommand=function(e,t){return new u(e,t)},e.prototype.CreateEventAddinCommand=function(e,t){switch(e.Type){case 1:return new c({Id:"ItemSend",Action:e},null,null,t)}return null},e.prototype.CreateAutoRunAddinCommand=function(e,t,n){switch(e.Type){case 0:var r={Id:"onCompose",Action:e};return new T(e.Type,r,t,n)}return null},e}();function F(e,t){switch(t){case A.a.MeetingRequest:return e.MessageReadCommandSurface;case A.a.AppointmentAttendee:return e.AppointmentAttendeeCommandSurface;case A.a.AppointmentOrganizer:return e.AppointmentOrganizerCommandSurface;case A.a.DetectedEntity:return e.DetectedEntity;case A.a.MessageCompose:return e.MessageComposeCommandSurface;case A.a.MessageRead:return e.MessageReadCommandSurface;case A.a.TrapOnSendEvent:default:return null}}function L(e,t){switch(t){case A.a.AutoRunOnMessageCompose:return e.AutoRunOnMessageCompose;case A.a.AutoRunOnAppointmentOrganizer:return e.AutoRunOnAppointmentOrganizer;default:return null}}var U=function(){function e(e){var t=this;this.addinCommandFactory=e,this.GetAutoRunAddinCommands=function(e,n,r){if(!e)return null;var o={};return e.AutoRunEvents.forEach(function(e){o[e.Type.toString()]=t.addinCommandFactory.CreateAutoRunAddinCommand(e,n,r)}),new b.ObservableMap(o)}}return e.prototype.CreateAddinIfEntryPointSupported=function(e,t){var n;return(n=t==A.a.TrapOnSendEvent?this.GetEventsAddinCommands(e.ExtensionPointCollection.Events,e):t==A.a.DetectedEntity?this.GetContextualAddinCommand(F(e.ExtensionPointCollection,t),e):t==A.a.AutoRunOnMessageCompose?this.GetAutoRunAddinCommands(L(e.ExtensionPointCollection,t),e,t):t==A.a.AutoRunOnAppointmentOrganizer?this.GetAutoRunAddinCommands(L(e.ExtensionPointCollection,t),e,t):this.GetAddinCommands(F(e.ExtensionPointCollection,t),e))?new o(e,n):null},e.prototype.GetAddinCommands=function(e,t){var n=this;if(!e)return null;var r={};return e.Tabs.forEach(function(e){e.Groups.forEach(function(o){o.Controls.forEach(function(i){r[i.Id]=n.addinCommandFactory.CreateAddinCommand(i,e,o,t)})})}),new b.ObservableMap(r)},e.prototype.GetContextualAddinCommand=function(e,t){if(!e)return null;var n={};return n[t.Id]=this.addinCommandFactory.CreateContextualAddinCommand(e,t),new b.ObservableMap(n)},e.prototype.GetEventsAddinCommands=function(e,t){var n=this;if(!e)return null;var r={};return e.forEach(function(e){r[e.Type]=n.addinCommandFactory.CreateEventAddinCommand(e,t)}),new b.ObservableMap(r)},e}(),B=Object(m.mutatorAction)("closeAllAutoRunCommandsforHostItemIndex",function(e){Object(g.a)().autoRunAddinCommandWaitingQueue.delete(e)});var H=n(1325);function V(){return{regExMatches:{},matchedKnownEntityTypes:[],filteredEntityMatches:{}}}var W=Object(y.action)("destroyExtensibilityHostItem")(function(e){H.a.HostItems.delete(e)});function G(e){return!!e&&!!e.SupportsSharedFolders}function z(e){return e.filter(function(e){return G(function(e){var t=i.__spread(e.AddinCommands.values());if(0==t.length)return null;return t[0].extension.ExtensionPointCollection}(e))})}function q(e){return e.filter(function(e){return G(e.extension.ExtensionPointCollection)})}function K(e){return G(e.extension.ExtensionPointCollection)}function X(e){var t=Object(g.a)();return t.runningContextualAddinCommand&&t.runningContextualAddinCommand.controlId===e?t.runningContextualAddinCommand:null}var J=n(4034),Q=n(1333);function Y(e){var t=Object(J.c)(e);if(t)return t.addinCommand;var n=X(e);return n?n.addinCommand:Object(Q.a)(e)}var Z=function(e){switch(e){case A.a.MessageCompose:return A.a.AutoRunOnMessageCompose;case A.a.AppointmentOrganizer:return A.a.AutoRunOnAppointmentOrganizer;default:return null}},$=function(e,t){var n=Object(g.a)().EnabledAddinCommands;return n?n.getAutoRunAddinsByEvent(e,Z(t)).map(function(t){return t.AddinCommands.get(e.toString())}):[]};function ee(e){var t=Object(g.a)().activeDialog;return t&&e===t.controlId?5:Object(J.c)(e)?2:X(e)?1:Object(Q.a)(e)?3:4}function te(e){var t=Object(g.a)(),n=function(e,t){return i.__spread(t.taskPanes.values()).filter(function(t){return t.hostItemIndex===e}).map(function(e){return e.controlId})}(e,t),r=function(e,t){var n=t.runningUILessAddinCommands;if(n.has(e))return i.__spread(n.get(e).keys());return[]}(e,t),o=function(e,t){var n=t.runningContextualAddinCommand;if(n&&n.hostItemIndex===e)return[t.runningContextualAddinCommand.controlId];return[]}(e,t);return i.__spread(n,r,o)}var ne=n(1018);function re(){return H.a.Context}function oe(e){var t=Y(e);return t&&t.extension.Id}function ie(e){return H.a.HostItems.get(e)}function ae(e){var t=Object(J.c)(e);if(t)return t.hostItemIndex;var n=X(e);return n?n.hostItemIndex:Object(Q.b)(e)}function se(){return H.a.activeSsoDialog}function ce(e){return Y(e).extension.WebApplicationResource}var ue=n(1395),le=Object(m.mutatorAction)("hideSsoDialog",function(e){var t=se();(!e||t.isOpen&&t.controlId===e)&&(H.a.activeSsoDialog=Object(ue.a)())});function de(){var e=Object(g.a)().EnabledAddinCommands;return!!e&&e.isInitialized}function fe(e){de()?e():Object(b.when)(de,e)}function pe(){return H.a.ExtensibilityStateIsDirty}var me=Object(y.action)("terminateContextualCallout")(function(){var e=Object(g.a)();e.runningContextualAddinCommand=null,e.contextualCalloutState.contextualAnchor=null,e.contextualCalloutState.activeContextualAddinCommands=[],e.contextualCalloutState.selectedTerms=[]}),ge=Object(y.action)("initializeContextualCallout")(function(e,t,n){var r=Object(g.a)();r.runningContextualAddinCommand&&me();var o=ie(t),a=new b.ObservableMap,s=r.contextualCalloutState;s.selectedTerms=[],e.forEach(function(e){var t=o.contextualTerms.get(e).slice();t&&t.length>0&&(s.selectedTerms.push(e),t.forEach(function(e){a.set(e.get_Id(),e)}))}),s.contextualAnchor=n,s.activeContextualAddinCommands=i.__spread(a.values()),s.hostItemIndex=t}),ve=Object(y.action)("initializeExtensibilityHostItem")(function(e){H.a.HostItems.has(e)||H.a.HostItems.set(e,{contextualTerms:null,contextualEvaluationResults:null})}),he=n(5067);function ye(){return!!H.a.activeDialog||se().isOpen}function be(e){return Object(g.a)().HostItems.has(e)}var _e=Object(m.mutatorAction)("setActiveDialog",function(e){Object(g.a)().activeDialog=e}),Se=Object(y.action)("setEnabledAddinCommands")(function(e){H.a.EnabledAddinCommands=e}),Ce=n(5),Oe=n(27),Ie=Object(y.action)("setExtensibilityContext")(function(e){if(e&&e.Extensions){for(var t=Object(Oe.f)(),n=t&&t.UserOptions&&t.UserOptions.WebSuggestedRepliesEnabledForUser,r=-1,o=0;o<e.Extensions.length;o++){var i=e.Extensions[o];"599e5de2-d41c-442a-bdb4-92eafa18a0dc"===i.Id&&null==i.ExtensionPointCollection.DetectedEntity&&(i.ExtensionPointCollection.DetectedEntity=i.ExtensionPointCollection.CustomPane,i.ExtensionPointCollection.DetectedEntity.Label=i.DisplayName),n&&"bc13b9d0-5ba2-446a-956b-c583bdc94d5e"===i.Id&&(Object(Ce.d)("rp-smartTime")||Object(Ce.d)("mc-smartReplyWithCustomMeeting"))&&(r=o)}r>=0&&e.Extensions.splice(r,1)}H.a.Context=e}),Ae=Object(y.action)("setExtensibilityStateIsDirty")(function(e){H.a.ExtensibilityStateIsDirty=e}),Te=Object(y.action)("setContextualAddinCommand")(function(e,t,n){Object(g.a)().runningContextualAddinCommand=function(e,t,n){return{controlId:e,addinCommand:t,hostItemIndex:n}}(e,n,t)}),Ee=Object(m.mutatorAction)("setTaskPaneAddinCommand",function(e,t,n,r,o,i){var a=Object(g.a)().taskPanes,s=function(e,t,n,r,o,i){return{controlId:e,addinCommand:t,hostItemIndex:n,mode:r,errorType:o||0,initializationContext:i}}(e,n,t,o,null,i);a.set(r,s)}),xe=n(1350),Pe=Object(m.mutatorAction)("showSsoDialog",function(e,t,n){H.a.activeSsoDialog=Object(ue.b)(e,t,n)}),Me=Object(m.mutatorAction)("terminateTaskPaneAddin",function(e){Object(g.a)().taskPanes.delete(e)}),we=Object(m.mutatorAction)("terminatePersistantTaskPaneAddinWithAppId",function(e){var t=Object(g.a)().taskPanes.get("Persistent");t&&t.addinCommand.extension.Id===e&&Object(g.a)().taskPanes.delete("Persistent")}),Re=Object(y.action)("terminateUilessAddinCommand")(function(e,t,n,r){!function(e,t){O[e]&&(O[e].resolve(t),delete O[e])}(e,{status:n,allowEvent:r&&r.allowEvent});var o=Object(g.a)().runningUILessAddinCommands;o.has(t)&&(o.get(t).delete(e),0===o.get(t).size&&o.delete(t))}),ke=Object(m.mutatorAction)("toggleTaskPaneType",function(e){var t=Object(J.b)(e);if(t){var n=Object(g.a)().taskPanes;n.delete(e),n.set(Object(J.a)(e),t)}}),De=Object(y.action)("updateConsentState")(function(e,t,n){Y(t).extension.ConsentState=Number(n)}),je=Object(y.select)({hostItem:function(e,t,n){return H.a.HostItems.get(e)}})(Object(y.action)("updateContextualEvaluation")(function(e,t,n,r){var o=r.hostItem;o&&(o.contextualTerms=t,o.contextualEvaluationResults=n)})),Ne=Object(y.action)("updateEntityExtractionResult")(function(e,t){e.EntityExtractionResult=t}),Fe=Object(y.action)("updateExtensionSettings")(function(e,t,n){Y(t).extension.Settings=n}),Le=n(5068),Ue=Object(m.mutatorAction)("updatePersistentTaskPaneHostItem",function(e){Object(J.b)("Persistent").hostItemIndex=e}),Be=Object(m.mutatorAction)("updateSsoDialogVisibility",function(e){se().isVisible=e}),He=Object(y.action)("setCompliance")(function(e){var t=JSON.parse(e);t&&t.hasOwnProperty("IsMinor")&&(H.a.compliance.isMinor=t.IsMinor)});n.d(t,"b",function(){return N}),n.d(t,"c",function(){return U}),n.d(t,"h",function(){return B}),n.d(t,"k",function(){return H.a}),n.d(t,"i",function(){return V}),n.d(t,"j",function(){return W}),n.d(t,"m",function(){return z}),n.d(t,"g",function(){return K}),n.d(t,"l",function(){return q}),n.d(t,"n",function(){return Y}),n.d(t,"p",function(){return $}),n.d(t,"r",function(){return ee}),n.d(t,"o",function(){return te}),n.d(t,"B",function(){return J.b}),n.d(t,"C",function(){return J.c}),n.d(t,"D",function(){return J.d}),n.d(t,"z",function(){return ne.c}),n.d(t,"q",function(){return ne.a}),n.d(t,"s",function(){return re}),n.d(t,"t",function(){return g.a}),n.d(t,"v",function(){return oe}),n.d(t,"w",function(){return ie}),n.d(t,"x",function(){return ae}),n.d(t,"A",function(){return se}),n.d(t,"E",function(){return ce}),n.d(t,"F",function(){return le}),n.d(t,"L",function(){return de}),n.d(t,"nb",function(){return fe}),n.d(t,"M",function(){return pe}),n.d(t,"y",function(){return p}),n.d(t,"G",function(){return ge}),n.d(t,"H",function(){return ve}),n.d(t,"J",function(){return Q.c}),n.d(t,"P",function(){return Q.d}),n.d(t,"O",function(){return he.a}),n.d(t,"I",function(){return ye}),n.d(t,"N",function(){return be}),n.d(t,"R",function(){return _e}),n.d(t,"U",function(){return Se}),n.d(t,"V",function(){return Ie}),n.d(t,"W",function(){return Ae}),n.d(t,"T",function(){return Te}),n.d(t,"X",function(){return Ee}),n.d(t,"Y",function(){return I}),n.d(t,"Z",function(){return xe.a}),n.d(t,"ab",function(){return Pe}),n.d(t,"bb",function(){return me}),n.d(t,"db",function(){return Me}),n.d(t,"cb",function(){return we}),n.d(t,"eb",function(){return Re}),n.d(t,"fb",function(){return ke}),n.d(t,"gb",function(){return De}),n.d(t,"hb",function(){return je}),n.d(t,"ib",function(){return Ne}),n.d(t,"jb",function(){return Fe}),n.d(t,"kb",function(){return Le.a}),n.d(t,"lb",function(){return Ue}),n.d(t,"mb",function(){return Be}),n.d(t,"S",function(){return He}),n.d(t,"a",function(){return c}),n.d(t,"f",function(){return E}),n.d(t,"d",function(){return l}),n.d(t,"K",function(){return D}),n.d(t,"Q",function(){return x}),n.d(t,"e",function(){return d.a}),n.d(t,"u",function(){return j.a})},3543:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return s});var r={};function o(e,t){s(e)&&i(e),r[e]=t}function i(e){delete r[e]}function a(e){return r[e]}function s(e){return!!r[e]}},3547:function(e,t,n){"use strict";var r=n(4411),o=n(4412),i=n(882),a=n(879),s=n(4072);t.a=function(e){return"function"==typeof e?e:null==e?i.a:"object"==typeof e?Object(a.a)(e)?Object(o.a)(e[0],e[1]):Object(r.a)(e):Object(s.a)(e)}},3548:function(e,t,n){"use strict";var r;!function(e){e[e.Unknown=0]="Unknown",e[e.AppointmentOrganizer=1]="AppointmentOrganizer",e[e.AppointmentAttendee=2]="AppointmentAttendee",e[e.MessageCompose=3]="MessageCompose",e[e.MessageRead=4]="MessageRead",e[e.MeetingRequest=5]="MeetingRequest",e[e.DetectedEntity=7]="DetectedEntity",e[e.Events=8]="Events",e[e.AutoRunOnMessageCompose=9]="AutoRunOnMessageCompose",e[e.AutoRunOnAppointmentOrganizer=10]="AutoRunOnAppointmentOrganizer",e[e.TrapOnSendEvent=6]="TrapOnSendEvent"}(r||(r={}));var o=r;n.d(t,"a",function(){return o})},3549:function(e,t,n){"use strict";var r=n(1583),o=n(7);t.a=Object(o.action)("updateFindResultTransactionId")(function(e,t){var n,o="";t&&(Object(r.a)()?(n=t).Groups&&n.Instrumentation&&(o=n.Instrumentation.TraceId):"Success"==(n=t).ResponseClass&&n.ResultSet&&(o=n.TransactionId));e.findResultTransactionId=o})},3550:function(e,t,n){"use strict";var r=n(4),o=n(7),i=n(3677),a=n.n(i),s=n(3678),c=n.n(s),u=n(29),l=n(12);function d(e){var t=c()({EntityFeedbackEntries:e});return a()({Header:Object(u.getJsonRequestHeader)(),Body:t}).then(function(e){!function(e){if(e&&e.Body){var t=e.Body;l.c.info(Object(r.b)("addEntityFeedback Error count: {0}",t.ErrorCount)),l.c.info(Object(r.b)("addEntityFeedback error details: {0}",t.ErrorDetails))}}(e)})}t.a=Object(o.action)("attemptToSubmitAddEntityFeedback")(function(e,t,n){e&&t&&(e.entityFeedbackEntries.push(t),(n||e.entityFeedbackEntries.length>=e.maxActionBatchSize)&&(d(e.entityFeedbackEntries),l.c.info(Object(r.b)("{0} Submitted {1} entities.",e.entityScenarioName,e.entityFeedbackEntries.length)),e.entityFeedbackEntries=[]))})},3561:function(e,t,n){"use strict";var r=n(3549),o=n(3681),i=n(3664),a=n(3665),s=n(3652),c=n(3599),u=n(3580),l=n(7);t.a=Object(l.action)("showHideFindResult")(function(e,t,n,l){var d=e.findResultSet?e.findResultSet.length:0;if(e.findResultHightlightIndex=-1,n&&d&&e.findResultSet.splice(0,d),t)if(Object(a.a)(e.findPeopleFeedbackManager),0!=e.queryString.length||e.inForceResolve)e.findResultHightlightIndex=0;else{var f=Object(o.a)(e,l);Object(s.a)(e.findResultSet,Object(u.a)(f)),Object(r.a)(e),Object(c.a)(e)}else Object(i.a)(e.findPeopleFeedbackManager);e.shouldShowFindResult=t})},3566:function(e,t,n){"use strict";var r=n(1660),o=n(3929),i=n(740);t.a=function(e){return Object(i.a)(e)?Object(r.a)(e):Object(o.a)(e)}},3567:function(e,t,n){"use strict";var r=n(4),o=n(7),i=Object(o.action)("increaseEntrySequenceNumber")(function(e){e&&e.entrySequenceNumber++}),a=n(74),s=n(12),c=n(6);function u(e,t,n,o,u,l,d,f){if(void 0===f&&(f=Object(c.Db)()),!e)return s.c.warn("Attempting to create entity feedback entry with invalid feedbackManager"),null;if(Object(a.b)(e.clientSessionId))return s.c.warn(Object(r.b)("{0} - Attempting to create entity feedback entry with empty client session id",e.entityScenarioName)),null;var p={ClientEventTimeUtc:Object(c.jb)(f),ClientEventTimeLocal:Object(c.hb)(f),ClientSessionId:e.clientSessionId,ClientVersion:e.clientVersion,ClientId:e.clientId,EntityType:e.entityType,EntrySequenceNumber:e.entrySequenceNumber,TransactionId:t,EventType:n,TargetEntityList:o,EntityAddSource:u,JsonPropertyBag:l,ScenarioName:d||e.entityScenarioName};return i(e),p}n.d(t,"a",function(){return u})},3568:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),o=n(3);function i(e,t,n,i,a){return function(){function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.onImportedCallbacks=[],this.args=e,this.pluginName=n}return s.prototype.initialize=function(e){this.editor=e,this.pluginInstance?this.initializeAndCallback():i||this.internalImport()},s.prototype.dispose=function(){this.pluginInstance&&(this.pluginInstance.dispose(),a||(this.pluginInstance=null)),this.editor=null,this.importPluginPromise=null,this.onImportedCallbacks=[]},s.prototype.getName=function(){return this.isImported()?this.pluginInstance.getName():this.pluginName},s.prototype.setPluginUtils=function(e){if(this.pluginUtils=e,this.pluginInstance){var t=this.pluginInstance;t.setPluginUtils&&t.setPluginUtils(this.pluginUtils)}},s.prototype.onPluginEvent=function(e){this.pluginInstance?this.pluginInstance.onPluginEvent&&this.pluginInstance.onPluginEvent(e):i&&i(e,this.editor)&&this.internalImport(e)},s.prototype.willHandleEventExclusively=function(e){return!(!this.pluginInstance||!this.pluginInstance.willHandleEventExclusively)&&this.pluginInstance.willHandleEventExclusively(e)},s.prototype.getPlugin=function(){return this.pluginInstance?Promise.resolve(this.pluginInstance):this.internalImport()},s.prototype.isImported=function(){return!!this.pluginInstance},s.prototype.addOnImportedCallback=function(e){this.isImported()&&this.editor?e(this.pluginInstance):this.onImportedCallbacks&&this.onImportedCallbacks.push(e)},s.prototype.initializeAndCallback=function(){var e=this;this.pluginInstance.initialize(this.editor),this.onImportedCallbacks.forEach(function(t){return t(e.pluginInstance)})},s.prototype.internalImport=function(n){var i=this;return this.importPluginPromise||(this.importPluginPromise=new o.b(e,t).import().then(function(e){i.pluginInstance=new(e.bind.apply(e,r.__spread([void 0],i.args)));var t=i.pluginInstance;return t.setPluginUtils&&t.setPluginUtils(i.pluginUtils),i.editor&&(i.initializeAndCallback(),n&&i.pluginInstance.onPluginEvent(n)),i.pluginInstance})),this.importPluginPromise},s}()}},3578:function(e,t,n){"use strict";n.d(t,"g",function(){return o}),n.d(t,"e",function(){return i}),n.d(t,"f",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return u}),n.d(t,"d",function(){return l});var r=n(1),o=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",function(e,t){return{linkId:e,sharingDialogResponse:t}}),i=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",function(e,t){return{linkId:e,newPermission:t}}),a=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",function(e,t,n,r){return{linkId:e,newLinkUrl:t,oldLinkUrl:n,expirationDate:r}}),s=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",function(e,t){return{linkId:e,actionStatus:t}}),c=Object(r.action)("CREATE_SHARING_LINK",function(e,t,n,r){return{linkId:e,currentUrl:t,canonicalUrl:n,newPermissionLevel:r}}),u=Object(r.action)("ADD_SHARING_LINK",function(e,t){return{linkId:e,linkModel:t}}),l=Object(r.action)("TOKEN_UNAVAILABLE",function(e){return{linkId:e}})},3580:function(e,t,n){"use strict";function r(e){var t=[];return e&&(t=e.map(function(e){return e.persona})),t}n.d(t,"a",function(){return r})},3588:function(e,t,n){"use strict";var r=n(1),o=Object(r.action)("addReadWriteRecipients",function(e,t,n){return void 0===n&&(n=!0),{recipientWell:e,recipientData:t,resetFindResult:n}});t.a=o},3597:function(e,t,n){"use strict";var r=n(3935);function o(){return Object(r.a)().sharingLinks.size}var i=n(3634);function a(e){var t=Object(i.a)(e);return t?{id:t.linkId,name:t.fileName,supportsDownsell:!1,currentPermissionLevel:t.permissionLevel,sharingInfo:t.sharingInfo,sharingTipsIgnored:t.sharingTipsIgnored,sharingRecipientsInfo:t.sharingRecipientsInfo}:null}var s=n(3911),c=n(3),u=n(3618),l=n(3578),d=n(3936);n.d(t,"i",function(){return p}),n.d(t,"m",function(){return m}),n.d(t,"q",function(){return g}),n.d(t,"o",function(){return v}),n.d(t,"n",function(){return h}),n.d(t,"k",function(){return y}),n.d(t,"p",function(){return b}),n.d(t,"j",function(){return _}),n.d(t,"l",function(){return S}),n.d(t,"b",function(){return u.a}),n.d(t,"c",function(){return u.b}),n.d(t,"e",function(){return u.c}),n.d(t,"t",function(){return u.d}),n.d(t,"w",function(){return l.g}),n.d(t,"u",function(){return l.e}),n.d(t,"v",function(){return l.f}),n.d(t,"s",function(){return l.c}),n.d(t,"d",function(){return l.b}),n.d(t,"a",function(){return s.a}),n.d(t,"r",function(){return d.b}),n.d(t,"f",function(){return o}),n.d(t,"g",function(){return a}),n.d(t,"h",function(){return i.a});var f=new c.c(function(){return Promise.all([n.e(12),n.e(263)]).then(n.bind(null,11687))}),p=new c.b(f,function(e){return e.addRecipientsIntoLink}),m=new c.b(f,function(e){return e.removeRecipientsFromLink}),g=new c.b(f,function(e){return e.updateRecipientPermissionInfos}),v=new c.b(f,function(e){return e.setGetPermissionInfoFailure}),h=new c.b(f,function(e){return e.resetSharingRecipientsInfo}),y=new c.b(f,function(e){return e.ignoreSharingTip}),b=new c.b(f,function(e){return e.setLinkActionStatus}),_=new c.b(f,function(e){return e.getSharingTipRecipientInfo}),S=new c.b(f,function(e){return e.linkBootStrap})},3599:function(e,t,n){"use strict";var r=n(4),o=n(3550),i=n(3567),a=n(6),s=n(74),c=n(12),u=n(7),l=n(94),d=Object(u.action)("localCacheTransactionCompleted")(function(e,t,n,u,d,f){if(void 0===f&&(f=Object(a.Db)()),e&&e.hasSessionStarted){var p={TransactionRequestTime:Object(a.hb)(f),TransactionRequestDuration:Object(a.r)(Object(a.Db)(),f),QueryString:Object(r.g)(t)?"":t,QueryStringLength:Object(s.b)(t)?0:t.length,FeatureData:null!=u?u:void 0,personaTypeList:d,ImpressionId:Object(l.a)()},m=JSON.stringify(p),g=JSON.stringify(n),v=Object(i.a)(e,"","LocalCacheTransactionCompleted",g,0,m);Object(o.a)(e,v,!1),c.c.info(Object(r.b)("{0} LocalCacheTransactionCompleted. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}),f=n(3682);function p(e){if(e.findResultSet&&e.findResultSet.length>0){var t=[];e.findResultSet.forEach(function(e){t.push(f.a[e.PersonaTypeString])}),d(e.findPeopleFeedbackManager,e.queryString,(n=e.findResultSet,r=[],n&&n.forEach(function(e,t){r[t]=e.EmailAddress.EmailAddress}),r),null,t)}var n,r}n.d(t,"a",function(){return p})},3617:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(4),o=n(3567),i=n(12);function a(e,t){if(Object(r.g)(e.clientSessionId))return i.c.warn(Object(r.b)("{0} - Attempting to create session feedback entry with empty client session id",e.entityScenarioName)),null;var n="";t&&(n=null==t.recipientEmailAddresses?"":JSON.stringify(t.recipientEmailAddresses));var a="";if(!Object(r.g)(t.endSessionAction)){var s={EndSessionAction:t.endSessionAction};a=JSON.stringify(s)}return Object(o.a)(e,"",t.eventType,n,0,a)}},3618:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"d",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s});var r=n(1),o=Object(r.action)("ADD_SHAREPOINT_LINK",function(e,t,n,r){return{linkId:e,url:t,sharingLinkIds:n,response:r}}),i=Object(r.action)("SHARING_LINK_REMOVED",function(e,t){return{linkId:e,sharingLinkIds:t}}),a=Object(r.action)("DELETE_LINK",function(e){return{linkId:e}}),s=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",function(e,t,n){return{linkId:e,providerId:t,isTryAgain:n}})},3620:function(e,t,n){"use strict";var r,o=n(1334),i=n(0);!function(e){e[e.Message=1]="Message",e[e.Appointment=2]="Appointment",e[e.MeetingRequest=3]="MeetingRequest",e[e.MessageCompose=4]="MessageCompose",e[e.AppointmentCompose=5]="AppointmentCompose"}(r||(r={}));var a=r;function s(e,t){return i.__awaiter(this,void 0,void 0,function(){var n;return i.__generator(this,function(r){switch(r.label){case 0:return t.itemType=a.AppointmentCompose,n=t,[4,e.getSeriesId()];case 1:return n.seriesId=r.sent(),[2,t]}})})}function c(e,t,n){return e&&e.match(function(e,t){var n,r="g";t&&(r="ig");try{n=new RegExp(e,r)}catch(e){return null}return n}(t,n))}var u=n(8),l=n(210);function d(e,t,n){if(!e)return{};var r={Addresses:e.Addresses?e.Addresses.map(function(e){return e.Address}):[],Urls:e.Urls?e.Urls.map(function(e){return e.Url}):[],PhoneNumbers:e.PhoneNumbers?e.PhoneNumbers:[]};return r.IsLegacyExtraction=function(e){return!(e.EntityDocument||e.PropertyExistence&&e.PropertyExistence.TextEntityExtractions)}(t),0!=n.extension.RequestedCapabilities&&(r.Contacts=e.Contacts?e.Contacts:[],r.EmailAddresses=e.EmailAddresses?e.EmailAddresses.map(function(e){return e.EmailAddress}):[],r.MeetingSuggestions=e.MeetingSuggestions?e.MeetingSuggestions.map(function(e){var t=this.IsLegacyExtraction,n=Object(u.toJS)(l({},e));return n.EndTime=t?p(n.EndTime):new Date(n.EndTime).getTime(),n.StartTime=t?p(n.StartTime):new Date(n.StartTime).getTime(),n}.bind(r)):[],r.TaskSuggestions=e.TaskSuggestions?e.TaskSuggestions:[]),r}function f(e,t){var n,r;try{for(var o=i.__values(t),a=o.next();!a.done;a=o.next()){var s=c(e,a.value,!0);if(s&&s.length>0)return!0}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1}function p(e){var t=new Date(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),n.getTime()}var m=n(3538);function g(e){var t={};return e&&Object.keys(e).forEach(function(n){var r;e[n]&&(t[n]=(r=e[n],Object(m.t)().contextualCalloutState.selectedTerms.filter(function(e){return r.indexOf(e)>=0})))}),t}var v=n(1357),h=n.n(v),y=n(1358),b=n.n(y),_=n(230),S=n.n(_),C=n(29),O="Success";function I(e,t,n){var r=e.map(function(e){return S()({Id:e})});return h()({Header:Object(C.getJsonRequestHeader)(),Body:b()({ItemShape:t,ItemIds:r,ShapeName:n})}).then(function(e){return function(e){if(e.ResponseClass==O){var t=e;return t.Items[0]}return{}}(e.Body.ResponseMessages.Items[0])})}var A=n(385),T=n.n(A),E=n(57),x=n.n(E);function P(e){return I([e.ItemId.Id],T()({BaseShape:"IdOnly",AdditionalProperties:[x()({FieldURI:"EntityExtractionResult"})]}),null)}function M(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var o,a,s;return i.__generator(this,function(i){switch(i.label){case 0:if(t.EntityExtractionResult||!function(e){return e.PropertyExistence&&(e.PropertyExistence.ExtractedAddresses||e.PropertyExistence.ExtractedContacts||e.PropertyExistence.ExtractedEmails||e.PropertyExistence.ExtractedMeetings||e.PropertyExistence.ExtractedPhones||e.PropertyExistence.ExtractedTasks||e.PropertyExistence.ExtractedUrls)}(t))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,P(t)];case 2:return o=i.sent(),Object(m.ib)(t,o.EntityExtractionResult),[3,4];case 3:return i.sent(),[3,4];case 4:return t.EntityExtractionResult&&(r.entities=d(t.EntityExtractionResult,t,n),r.entities&&(a=JSON.parse(JSON.stringify(r.entities)),r.selectedEntities=function(e,t){var n={};return e&&t&&(e.Addresses&&(n.Addresses=e.Addresses.filter(function(e){return f(e,t)})),e.MeetingSuggestions&&(n.MeetingSuggestions=e.MeetingSuggestions.filter(function(e){return f(e.MeetingString,t)})),e.TaskSuggestions&&(n.TaskSuggestions=e.TaskSuggestions.filter(function(e){return f(e.TaskString,t)})),e.PhoneNumbers&&(n.PhoneNumbers=e.PhoneNumbers.filter(function(e){return f(e.OriginalPhoneString,t)})),e.Urls&&(n.Urls=e.Urls.filter(function(e){return f(e,t)})),e.Contacts&&(n.Contacts=e.Contacts.filter(function(e){return f(e.ContactString,t)})),e.EmailAddresses&&(n.EmailAddresses=e.EmailAddresses.filter(function(e){return f(e,t)}))),n}(a,Object(m.t)().contextualCalloutState.selectedTerms))),(s=function(e,t){var n=Object(m.w)(e);return n&&n.contextualEvaluationResults&&n.contextualEvaluationResults.has(t)?n.contextualEvaluationResults.get(t):null}(e,n.extension.Id))&&(r.filteredEntities=s.filteredEntityMatches,r.regExMatches=s.regExMatches,r.selectedRegExMatches=g(r.regExMatches)),[2,r]}})})}var w,R,k=n(4686);!function(e){e[e.Other=0]="Other",e[e.DistributionList=1]="DistributionList",e[e.User=2]="User",e[e.ExternalUser=3]="ExternalUser"}(w||(w={})),function(e){e[e.Unknown=0]="Unknown",e[e.Organizer=1]="Organizer",e[e.Tentative=2]="Tentative",e[e.Accept=3]="Accept",e[e.Decline=4]="Decline",e[e.NoResponseReceived=5]="NoResponseReceived"}(R||(R={}));var D=function(e){return{address:e.EmailAddress,name:e.Name,recipientType:F(e.MailboxType)}},j=function(e){var t=D(e.Mailbox);return t.appointmentResponse=function(e){switch(e){case"Organizer":return R.Organizer;case"Tentative":return R.Tentative;case"Accept":return R.Accept;case"Decline":return R.Decline;case"NoResponseReceived":return R.NoResponseReceived;default:return R.Unknown}}(e.ResponseType),t},N=function(e){return e?e.map(function(e){return j(e)}):[]};function F(e){switch(e){case"PublicDL":case"PrivateDL":case"PublicFolder":return w.DistributionList;case"Mailbox":case"Contact":return w.User;case"OneOff":return w.ExternalUser;default:return w.Other}}function L(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var s,c,u,l;return i.__generator(this,function(i){switch(i.label){case 0:return r.itemType=a.Appointment,s=e.getItem(),r.id=s.ItemId.Id,r.end=s.End,r.start=s.Start,r.location=s.Location.DisplayName,r.dateTimeCreated=s.DateTimeCreated?new Date(s.DateTimeCreated):null,r.dateTimeModified=s.LastModifiedTime?new Date(s.LastModifiedTime):null,r.itemClass=s.ItemClass,r.subject=s.Subject,r.normalizedSubject=s.Subject,r.organizer=j(s.Organizer),c=N(s.RequiredAttendees),r.to=function(e,t){if(t){var n=e.some(function(e){return e.address.toLowerCase()===t.address.toLowerCase()});if(!n)return e.concat(t)}return e}(c,r.organizer),r.cc=N(s.OptionalAttendees),r.attachments=s.Attachments?Object(o.b)(s.Attachments):[],[4,e.getRecurrence()];case 1:return u=i.sent(),r.recurrence=Object(k.a)({recurrenceType:u,timeZone:s.StartTimeZoneId,startTime:new Date(s.Start),endTime:new Date(s.End)}),r.resources=N(s.Resources),l=r,[4,e.getSeriesId()];case 2:return l.seriesId=i.sent(),[4,M(n,s,t,r)];case 3:return[2,r=i.sent()]}})})}var U=n(9);function B(){return function(){var e=Object(U.a)().SessionSettings.WebSessionType;if(1===e)return"outlookCom";if(2===e)return"gmail";if(0==e)return"office365";return"unknown"}()}var H=n(88),V=n(5),W=n(27),G=n(15);function z(e,t,n,r){return r=function(e,t){return t.hostVersion=Object(G.i)()||"debug",t.owaView="mouse",t.timeZoneOffsets=Object(H.d)(),t}(0,r=function(e,t){var n=e.extension;return t.extensionId=n.Id,t.marketplaceContentMarket=n.MarketplaceContentMarket,t.permissionLevel=n.RequestedCapabilities,t.marketplaceAssetId=n.MarketplaceAssetID,t.entryPointUrl=e.get_EntryPoint(),t.consentMetadata=n.ConsentMetadata,t.endNodeUrl=n.EndNodeUrl,t}(t,r)),0!=t.extension.RequestedCapabilities&&(r=function(e,t){return t.userDisplayName=Object(W.h)(),t.userEmailAddress=Object(W.i)(),t.userTimeZone=Object(W.l)(),t.userProfileType=B(),t.ewsUrl=Object(m.s)().EwsUrl,t.restUrl=Object(m.s)().RestUrl,t}(0,r)),Object(V.d)("addin-delegateAccess")&&e.isSharedItem&&e.getSharedProperties&&(r.isFromSharedFolder=e.isSharedItem()),Object(V.d)("addin-delegateAccess")&&(r.shouldRunNewCodeForFlags|=1),r}var q="0xe1d";function K(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var s;return i.__generator(this,function(i){switch(i.label){case 0:return r.id=e.getItemId(),r.isRead=!0,r.itemType=a.Message,s=e.getItem(),r.itemClass=s.ItemClass,r.subject=s.Subject,r.normalizedSubject=function(e,t){if(!e.ExtendedProperty)return null;for(var n=0;n<e.ExtendedProperty.length;n++){var r=e.ExtendedProperty[n];if(r&&r.ExtendedFieldURI&&r.ExtendedFieldURI.PropertyTag===t)return r.Value}return null}(s,q),r.conversationId=s.ConversationId.Id,r.internetMessageId=s.InternetMessageId,r.dateTimeCreated=s.DateTimeCreated?new Date(s.DateTimeCreated).getTime():null,r.dateTimeModified=s.LastModifiedTime?new Date(s.LastModifiedTime).getTime():null,r.dateTimeSent=s.DateTimeSent?new Date(s.DateTimeSent).getTime():null,r.attachments=s.Attachments?Object(o.b)(s.Attachments):[],[4,M(n,s,t,r)];case 1:return r=i.sent(),0==t.extension.RequestedCapabilities?[3,3]:(r.from=s.From?D(s.From.Mailbox):null,r.sender=s.Sender?D(s.Sender.Mailbox):null,r.to=s.ToRecipients?s.ToRecipients.map(D):[],r.cc=s.CcRecipients?s.CcRecipients.map(D):[],r.bcc=s.BccRecipients?s.BccRecipients.map(D):[],function(e){return 0==e.ItemClass.indexOf("IPM.Schedule.Meeting.Request")||0==e.ItemClass.indexOf("IPM.Schedule.Meeting.Canceled")}(s)?[4,X(e,r)]:[3,3]);case 2:r=i.sent(),i.label=3;case 3:return[2,r]}})})}function X(e,t){return i.__awaiter(this,void 0,void 0,function(){var n,r,o;return i.__generator(this,function(i){switch(i.label){case 0:return n=e.getItem(),t.itemType=a.MeetingRequest,t.location=n.Location.DisplayName,t.start=n.Start,t.end=n.End,t.to=n.RequiredAttendees?n.RequiredAttendees.map(j):[],t.cc=n.OptionalAttendees?n.OptionalAttendees.map(j):[],t.resources=n.Resources?n.Resources.map(j):[],r=t,[4,e.getSeriesId()];case 1:return r.seriesId=i.sent(),[4,e.getRecurrence()];case 2:return o=i.sent(),t.recurrence=Object(k.a)({recurrenceType:o,timeZone:n.StartTimeZoneId,startTime:new Date(n.Start),endTime:new Date(n.End)}),[2,t]}})})}var J=n(3548),Q=n(3543);function Y(e,t){return i.__awaiter(this,void 0,void 0,function(){var n,r,o;return i.__generator(this,function(i){switch(i.label){case 0:switch(n={},r=Object(Q.c)(t),Object(m.w)(t),o=Object(m.n)(e),n=z(r,o,0,n),r.mode){case J.a.MeetingRequest:case J.a.MessageRead:return[3,1];case J.a.MessageCompose:return[3,3];case J.a.AppointmentAttendee:return[3,4];case J.a.AppointmentOrganizer:return[3,6]}return[3,8];case 1:return[4,K(r,o,t,n)];case 2:return n=i.sent(),[3,8];case 3:return n=function(e,t){return t.itemType=a.MessageCompose,t.conversationId=e.getConversationId(),t.isRead=!1,t}(r,n),[3,8];case 4:return[4,L(r,o,t,n)];case 5:return n=i.sent(),[3,8];case 6:return[4,s(r,n)];case 7:return n=i.sent(),[3,8];case 8:return[2,n]}})})}var Z=n(1349),$=n(1348),ee=n(1324),te=n(1355),ne=function(e){var t={locationIdentifier:{}};return t.displayName=e.DisplayName,e.PostalAddress&&"Resource"===e.PostalAddress.LocationSource?(t.emailAddress=e.PostalAddress.LocationUri,t.locationIdentifier.id=t.emailAddress,t.locationIdentifier.type=te.a.Room):(t.emailAddress="",t.locationIdentifier.id=t.displayName,t.locationIdentifier.type=te.a.Custom),t};function re(e){var t,n;if(!e||e.length<=0)return!1;try{for(var r=i.__values(e),o=r.next();!o.done;o=r.next()){if(o.value.id.trim().length<=0)return!1}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!0}function oe(e,t,n){return"Addin_"+e+"_"+t+"_"+n}var ie,ae=n(4915),se=n(1342),ce=n(1308);function ue(e){return void 0===e&&(e=null),{error:ie.Success,data:e}}function le(e){return{error:ie.Failed,errorCode:e}}function de(e,t){return!fe(e)&&(t(le(ce.a.InsufficientItemPermissions)),!0)}function fe(e){return!e.isSharedItem||!e.getSharedProperties||(!e.isSharedItem()||e.getSharedProperties().delegatePermissions.EditOwn)}!function(e){e[e.Success=0]="Success",e[e.Failed=1]="Failed"}(ie||(ie={}));var pe=n(1329);function me(e,t,n){return i.__awaiter(this,void 0,void 0,function(){var r,o,a,s,c,u;return i.__generator(this,function(i){switch(i.label){case 0:if(r=Object(Q.c)(e),o=Object(m.v)(t),a=oe(e,o,n),!Object(pe.f)(a))return[2,le(ce.b.NotificationKeyNotFound)];if(s=Object(pe.e)(a),(c=s.Persistent)&&!fe(r))return[2,le(ce.b.InsufficientItemPermissions)];r.removeNotificationMessage(a),Object(pe.h)(a),i.label=1;case 1:return i.trys.push([1,4,,5]),c?[4,Object(ae.a)(e,o)]:[3,3];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:return(u=i.sent())instanceof se.a?[2,le(u.errorCode)]:[3,5];case 5:return[2,ue()]}})})}function ge(e){switch(e){case 0:return"informationalMessage";case 2:return"errorMessage";case 1:return"progressIndicator"}return""}function ve(e,t,n,r,o,a,s,c){return void 0===s&&(s=null),void 0===c&&(c=!1),i.__awaiter(this,void 0,void 0,function(){var u,l,d,f,p,g,v;return i.__generator(this,function(i){switch(i.label){case 0:if(u=Object(Q.c)(e),l=Object(m.v)(t),d=oe(e,l,r),function(e,t,n){var r=Object(m.n)(t);if(r){var o=r.get_Id(),i=oe(e,n,o);Object(pe.f)(i)&&me(e,t,o)}}(e,t,l),f=!1,Object(pe.f)(d)){if(c)return[2,le(ce.b.DuplicateNotificationKey)];p=Object(pe.e)(d),f=p.Persistent}else if(Object(pe.g)(e,l))return[2,le(ce.b.NumberOfNotificationsExceeded)];if(g=function(e,t,n,r,o,i){return{ExtensionId:e,Persistent:!!t||2===r,Key:n,Type:r,Message:o,Icon:i}}(l,n,r,o,a,s),!fe(u)&&g.Persistent)return[2,le(ce.b.InsufficientItemPermissions)];Object(pe.a)(e,l,d,g),u.addNotificationMessage(d),i.label=1;case 1:return i.trys.push([1,4,,5]),f||g.Persistent?[4,Object(ae.a)(e,l)]:[3,3];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:return(v=i.sent())instanceof se.a?[2,le(v.errorCode)]:[3,5];case 5:return[2,ue()]}})})}function he(e){try{var t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("style");if(n&&n.length>0)for(var r=0;r<n.length;r++)n[r]&&(n[r].innerHTML="");return t.body.textContent||""}catch(e){return""}}function ye(e){var t=Object(m.C)(e);if(t){var n=t.hostItemIndex,r=Object(m.D)(e);Object(m.db)(r);var o=Object(Q.c)(n);o.closeTaskPane&&o.closeTaskPane()}}function be(e){return Object(Q.d)(e)}var _e=n(211),Se=255;function Ce(e){var t,n;try{for(var r=i.__values(e),o=r.next();!o.done;o=r.next()){var a=o.value.length;if(a<=0||a>Se)return!0}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!1}var Oe=n(4480),Ie=n(2536);var Ae=n(4242),Te=n(94);var Ee=/^[a-zA-Z0-9.!#$%&’*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;function xe(e){return Ee.test(e)}function Pe(e){var t=[];return e.forEach(function(e){xe(e.address)&&t.push({Name:e.name,EmailAddress:e.address})}),t}var Me={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},we=/[&<>"'\/]/g;var Re=n(6620),ke=n.n(Re);function De(){return null}var je="<div>",Ne="</div>";function Fe(e){var t=e.trim();return t.substr(0,je.length).toLowerCase()==je&&t.substr(t.length-Ne.length,Ne.length).toLowerCase()==Ne&&(t=t.substring(je.length,t.length-Ne.length)),t}function Le(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(n){switch(n.label){case 0:return[4,(r=e,ke()({input:r}).catch(De))];case 1:return null==(t=n.sent())?[2,null]:[2,Fe(t)]}var r})})}var Ue=n(136),Be=1e6;function He(e,t,n,r,o,a){return i.__awaiter(this,void 0,void 0,function(){var t,s,c,u,l;return i.__generator(this,function(i){switch(i.label){case 0:return(t=n.appendTxt||""===n.appendTxt?n.appendTxt:n.data).length>Be?(r(le(ce.a.OoeInvalidDataFormat)),[2]):(s=a&&a(),c=null,n.coercionType!==ee.a.Html?[3,2]:[4,Le(t)]);case 1:return null==(c=i.sent())?(r(le(ce.a.HtmlSanitizationFailure)),[2]):[3,3];case 2:u=Object(Q.c)(e),c="HTML"!==u.getBodyType()||n.appendOnSend?t:t.replace(we,function(e){return Me[e]}),i.label=3;case 3:if(n.appendOnSend)n.appendOnSend.txt=c,o(n.appendOnSend);else{if(a&&(l=a(),f=l,!(null==(d=s)&&null==f||null!=d&&null!=f&&d.data===f.data&&d.sourceProperty===f.sourceProperty&&d.startPosition===f.startPosition&&d.endPosition===f.endPosition)))return r(le(ce.a.CursorPositionChanged)),[2];o(c),"Firefox"===Object(Ue.a)().browser&&document.activeElement.blur()}return r(ue()),[2]}var d,f})})}var Ve=n(5067),We=5e3;var Ge,ze=n(6141);function qe(e,t,n,r){!function(e){return i.__spread(Object(m.t)().taskPanes.values()).some(function(t){return t.controlId===e})}(t)?function(e){return Object(m.t)().runningContextualAddinCommand&&Object(m.t)().runningContextualAddinCommand.controlId===e}(t)&&Object(m.bb)():ye(t),r(ue())}!function(e){e[e.MaxRecipientsOnDisplayNewAppointment=100]="MaxRecipientsOnDisplayNewAppointment",e[e.MaxSubjectLength=255]="MaxSubjectLength",e[e.MaxBodyLengthOnDisplayApis=32768]="MaxBodyLengthOnDisplayApis",e[e.MaxLocationLengthOnDisplayNewAppointment=255]="MaxLocationLengthOnDisplayNewAppointment",e[e.MaxAttachmentNumberOnDisplayApis=100]="MaxAttachmentNumberOnDisplayApis",e[e.MaxRecipientsPerCall=100]="MaxRecipientsPerCall"}(Ge||(Ge={}));var Ke=Ge,Xe=function(e){return"string"==typeof e?{Name:e,EmailAddress:e}:{Name:e.name,EmailAddress:e.address}},Je=function(e){return e?e.map(Xe):[]};function Qe(e,t){return e&&e.length>t}function Ye(e){switch(e[0]){case"file":return function(e){return{id:e[2],name:e[1],attachmentType:o.a.File,isInline:e[3]}}(e);case"item":return function(e){return{id:e[2],name:e[1],attachmentType:o.a.Item,isInline:!1}}(e);default:return null}}function Ze(e,t,n,r,o){return i.__awaiter(this,void 0,void 0,function(){var t,a,s;return i.__generator(this,function(i){switch(i.label){case 0:return t="",a=[],n.htmlBody?n.htmlBody.length>Ke.MaxBodyLengthOnDisplayApis?(r(le()),[2]):[4,Le(n.htmlBody)]:[3,2];case 1:if(null==(t=i.sent()))return r(le()),[2];i.label=2;case 2:if(n.attachments){if(n.attachments.length>Ke.MaxAttachmentNumberOnDisplayApis)return r(le()),[2];a=n.attachments.map(Ye)}return[4,(s=Object(Q.c)(e)).displayReplyForm(s.getItemId(),o,t,a)];case 3:return i.sent(),r(ue()),[2]}})})}function $e(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return[4,Ze(e,0,n,r,!0)];case 1:return t.sent(),[2]}})})}function et(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return[4,Ze(e,0,n,r,!1)];case 1:return t.sent(),[2]}})})}n(3792);var tt=n(6623),nt=n.n(tt);function rt(e,t,n){var r={Body:e,Token:t,ExtensionId:n};return nt()(r)}var ot=n(4),it="Token type is not supported for caching: {0}",at=n(3769),st=n.n(at),ct=n(3770),ut=n.n(ct),lt="CallerIdentity",dt="ScopedToken",ft="ExtensionRestApiCallback",pt="ExtensionCallback";function mt(e,t,n){var r=new Array(t.length);t.forEach(function(t,o){return r[o]={TokenType:t,Id:e,Scope:n}});var o=ut()({TokenRequests:r});return st()({Header:Object(C.getJsonRequestHeader)(),Body:o})}var gt=15,vt={},ht={};function yt(e,t){St(t.TokenType)[e]=function(e){return{cacheTime:Date.now(),token:e}}(t)}function bt(e,t){var n=St(t);return function(e,t){var n=St(t);n[e]&&(r=n[e],o=Date.now()-r.cacheTime,i=1e3*(r.token.TTL-gt)*60,o>=i)&&delete n[e];var r,o,i;return!!n[e]}(e,t)?n[e].token:null}function _t(e){return e==lt||e==pt}function St(e){switch(e){case lt:return vt;case pt:return ht;default:throw Object(ot.b)(it,e)}}var Ct="Success";function Ot(e,t,n){return i.__awaiter(this,void 0,void 0,function(){var r,o,a,s;return i.__generator(this,function(i){switch(i.label){case 0:if(_t(t)&&(r=bt(e.extension.Id,t)))return[2,r];o=[],bt(e.extension.Id,lt)||o.push(lt),2!=e.extension.RequestedCapabilities||bt(e.extension.Id,pt)||o.push(pt),!n||t!=ft&&t!=dt||o.push(t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,mt(e.extension.Id,o,n)];case 2:return a=i.sent(),[3,4];case 3:return i.sent(),[2,null];case 4:return s=function(e){return e.Body.ResponseMessages.Items.forEach(It),e.Body.ResponseMessages.Items}(a),[2,At(t)(s)]}})})}function It(e){"NoError"==e.ResponseCode&&e.ResponseClass==Ct&&_t(e.Token.TokenType)&&yt(e.Token.Id,e.Token)}var At=function(e){return function(t){var n=t.filter(Tt(e))[0];return n?n.Token:null}},Tt=function(e){return function(t){return"NoError"==t.ResponseCode&&t.ResponseClass==Ct&&t.Token.TokenType==e}};var Et=1e6;var xt,Pt="Error",Mt="accessToken";!function(e){e.Base64="base64",e.Eml="eml",e.Url="url",e.Ical="iCalendar"}(xt||(xt={}));var wt=n(98);function Rt(e,t,n){return i.__awaiter(this,void 0,void 0,function(){var r,o,a,s,c,u,l,d,f,p,m,g;return i.__generator(this,function(v){switch(v.label){case 0:if(r=null,o=t.getItem(),a=!1,!(o.Attachments.length>0))return[3,13];v.label=1;case 1:v.trys.push([1,10,11,12]),s=i.__values(o.Attachments),c=s.next(),v.label=2;case 2:return c.done?[3,9]:(u=c.value,l=u.AttachmentOriginalUrl,d=u.AttachmentId.Id,"ReferenceAttachment:#Exchange"!==u.__type||n!==l?[3,3]:(f=u,r={format:xt.Url,content:f.AttachLongPathName},a=!0,[2,r]));case 3:return n!==d?[3,8]:!0!==e?[3,5]:[4,t.getAttachmentContent(n)];case 4:return r=v.sent(),[3,7];case 5:return[4,t.getAttachmentContent(n)];case 6:r=v.sent(),v.label=7;case 7:return a=!0,[2,r];case 8:return c=s.next(),[3,2];case 9:return[3,12];case 10:return p=v.sent(),m={error:p},[3,12];case 11:try{c&&!c.done&&(g=s.return)&&g.call(s)}finally{if(m)throw m.error}return[7];case 12:if(!a)return[2,r];v.label=13;case 13:return[2,r]}})})}function kt(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(n){switch(n.label){case 0:return e.NormalizedBody?[3,2]:[4,I([e.ItemId.Id],T()({BaseShape:"IdOnly",AdditionalProperties:[x()({FieldURI:"NormalizedBody"})]}),"ItemNormalizedBody")];case 1:t=n.sent(),e.NormalizedBody=t.NormalizedBody,n.label=2;case 2:return[2,e.NormalizedBody.Value]}})})}function Dt(e,t){return{wasSuccessful:e,token:t}}var jt="ParentItemId:";var Nt=n(5049);var Ft=32,Lt=126;function Ut(e){var t,n;if(!e)return!1;try{for(var r=i.__values(e),o=r.next();!o.done;o=r.next()){var a=o.value;if(null==a||0===a.trim().length)return!1;for(var s=a.length;s--;)if(a.charCodeAt(s)>Lt||a.charCodeAt(s)<Ft)return!1}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!0}var Bt,Ht=500;!function(e){e[e.Read=1]="Read",e[e.Create=2]="Create",e[e.DeleteOwn=4]="DeleteOwn",e[e.DeleteAll=8]="DeleteAll",e[e.EditOwn=16]="EditOwn",e[e.EditAll=32]="EditAll"}(Bt||(Bt={}));var Vt,Wt=n(22);!function(e){e[e.Start=1]="Start",e[e.End=2]="End"}(Vt||(Vt={}));var Gt=Vt;var zt=n(156),qt=n(6625),Kt=n.n(qt);function Xt(e,t,n){var r={ExtensionId:e,ItemId:t};return Kt()({request:r},n?{headers:Object(zt.c)(n)}:{})}function Jt(e,t,n){return{errorMessage:e,wasSuccessful:t,customProperties:n}}var Qt=n(4070);var Yt=n(6627),Zt=n.n(Yt),$t=n(6629),en=n.n($t);function tn(e,t){var n=en()({Id:e,ConsentState:t});return Zt()({Header:Object(C.getJsonRequestHeader)(),Body:n})}var nn=n(6630),rn=n.n(nn);function on(e,t,n,r){var o={ExtensionId:e,ItemId:t,CustomProperties:r};return rn()({request:o},n?{headers:Object(zt.c)(n)}:{})}var an=n(6632),sn=n.n(an);var cn=32768;var un=255;var ln,dn,fn=n(18);!function(e){e[e.GetInitialData=1]="GetInitialData",e[e.GetUserIdentityToken=2]="GetUserIdentityToken",e[e.EwsRequest=5]="EwsRequest",e[e.LoadCustomProperties=3]="LoadCustomProperties",e[e.SaveCustomProperties=4]="SaveCustomProperties",e[e.DisplayNewAppointmentForm=7]="DisplayNewAppointmentForm",e[e.DisplayMessageForm=8]="DisplayMessageForm",e[e.DisplayAppointmentForm=9]="DisplayAppointmentForm",e[e.DisplayReplyForm=10]="DisplayReplyForm",e[e.DisplayReplyAllForm=11]="DisplayReplyAllForm",e[e.GetCallbackToken=12]="GetCallbackToken",e[e.SetBodySelectedDataAsync=13]="SetBodySelectedDataAsync",e[e.GetBodyTypeAsync=14]="GetBodyTypeAsync",e[e.GetRecipientsAsync=15]="GetRecipientsAsync",e[e.AddFileAttachmentAsync=16]="AddFileAttachmentAsync",e[e.SetSubjectAsync=17]="SetSubjectAsync",e[e.GetSubjectAsync=18]="GetSubjectAsync",e[e.AddItemAttachmentAsync=19]="AddItemAttachmentAsync",e[e.RemoveAttachmentAsync=20]="RemoveAttachmentAsync",e[e.SetRecipientsAsync=21]="SetRecipientsAsync",e[e.AddRecipientsAsync=22]="AddRecipientsAsync",e[e.BodyPrependAsync=23]="BodyPrependAsync",e[e.GetTimeAsync=24]="GetTimeAsync",e[e.SetTimeAsync=25]="SetTimeAsync",e[e.GetLocationAsync=26]="GetLocationAsync",e[e.SetLocationAsync=27]="SetLocationAsync",e[e.GetSelectedDataAsync=28]="GetSelectedDataAsync",e[e.SetSelectedDataAsync=29]="SetSelectedDataAsync",e[e.DisplayReplyFormWithAttachments=30]="DisplayReplyFormWithAttachments",e[e.DisplayReplyAllFormWithAttachments=31]="DisplayReplyAllFormWithAttachments",e[e.SaveAsync=32]="SaveAsync",e[e.AddNotificationMessageAsync=33]="AddNotificationMessageAsync",e[e.GetAllNotificationMessagesAsync=34]="GetAllNotificationMessagesAsync",e[e.ReplaceNotificationMessageAsync=35]="ReplaceNotificationMessageAsync",e[e.RemoveNotificationMessageAsync=36]="RemoveNotificationMessageAsync",e[e.GetBodyAsync=37]="GetBodyAsync",e[e.SetBodyAsync=38]="SetBodyAsync",e[e.RegisterConsentAsync=40]="RegisterConsentAsync",e[e.Close=41]="Close",e[e.CloseApp=42]="CloseApp",e[e.DisplayNewMessageForm=44]="DisplayNewMessageForm",e[e.EventCompleted=94]="EventCompleted",e[e.CloseContainer=97]="CloseContainer",e[e.GetAccessTokenAsync=98]="GetAccessTokenAsync",e[e.GetInitializationContextAsync=99]="GetInitializationContextAsync",e[e.AppendOnSendAsync=100]="AppendOnSendAsync",e[e.GetRecurrenceAsync=103]="GetRecurrenceAsync",e[e.SetRecurrenceAsync=104]="SetRecurrenceAsync",e[e.GetFromAsync=107]="GetFromAsync",e[e.GetSharedPropertiesAsync=108]="GetSharedPropertiesAsync",e[e.MESSAGE_PARENT_DISPID=144]="MESSAGE_PARENT_DISPID",e[e.GetAttachmentsAsync=149]="GetAttachmentsAsync",e[e.AddBase64FileAttachmentAsync=148]="AddBase64FileAttachmentAsync",e[e.GetAttachmentContentAsync=150]="GetAttachmentContentAsync",e[e.GetInternetHeadersAsync=151]="GetInternetHeadersAsync",e[e.SetInternetHeadersAsync=152]="SetInternetHeadersAsync",e[e.RemoveInternetHeadersAsync=153]="RemoveInternetHeadersAsync",e[e.GetEnhancedLocationsAsync=154]="GetEnhancedLocationsAsync",e[e.AddEnhancedLocationsAsync=155]="AddEnhancedLocationsAsync",e[e.RemoveEnhancedLocationsAsync=156]="RemoveEnhancedLocationsAsync",e[e.GetCategoriesAsync=157]="GetCategoriesAsync",e[e.AddCategoriesAsync=158]="AddCategoriesAsync",e[e.RemoveCategoriesAsync=159]="RemoveCategoriesAsync",e[e.GetMasterCategoriesAsync=160]="GetMasterCategoriesAsync",e[e.AddMasterCategoriesAsync=161]="AddMasterCategoriesAsync",e[e.RemoveMasterCategoriesAsync=162]="RemoveMasterCategoriesAsync",e[e.GetItemIdAsync=164]="GetItemIdAsync",e[e.SaveSettingsRequest=404]="SaveSettingsRequest"}(ln||(ln={}));var pn=((dn={})[ln.GetInitialData]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var n;return i.__generator(this,function(o){switch(o.label){case 0:return[4,Y(t,e)];case 1:return n=o.sent(),Object(Nt.e)(!0,Object(m.n)(t),e,Object(m.r)(t)),r(n),[2]}})})},dn[ln.EwsRequest]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var e,o,a,s,c;return i.__generator(this,function(i){switch(i.label){case 0:return!(e=n.body)||e.length>Et?(r(le(ce.b.GenericResponseError)),[2]):[4,Ot(o=Object(m.n)(t),pt)];case 1:if(!(a=i.sent()))return r(le(ce.b.GenericTokenError)),[2];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,rt(e,a.TokenValue,o.extension.Id)];case 3:return s=i.sent(),c=function(e){return{wasProxySuccessful:e.WasProxySuccessful,errorMessage:e.ErrorMessage,statusCode:e.StatusCode,statusDescription:e.StatusDescription,body:e.Body}}(s),r(c),[3,5];case 4:return i.sent(),r(le(ce.b.GenericResponseError)),[3,5];case 5:return[2]}})})},dn[ln.GetRecipientsAsync]=function(e,t,n,r){r(ue(Object(Q.c)(e).getRecipients(n.recipientField).slice(0,Ht).map(function(e){return{name:e.Name,address:e.EmailAddress,recipientType:F(e.MailboxType)}})))},dn[ln.GetSubjectAsync]=function(e,t,n,r){r(ue(Object(Q.c)(e).getSubject()||""))},dn[ln.SetSubjectAsync]=function(e,t,n,r){if(n.subject.length>un)r(le(null));else{var o=Object(Q.c)(e);de(o,r)||(o.setSubject(n.subject),r(ue()))}},dn[ln.SetRecipientsAsync]=function(e,t,n,r){var o=Object(Q.c)(e);if(!de(o,r)){var i=Pe(n.recipientArray);try{o.setRecipients(n.recipientField,i),r(ue())}catch(e){r(le(e.errorCode))}}},dn[ln.AddRecipientsAsync]=function(e,t,n,r){var o=Object(Q.c)(e);if(!de(o,r)){var i=Pe(n.recipientArray);try{o.addRecipients(n.recipientField,i),r(ue())}catch(e){r(le(e.errorCode))}}},dn[ln.SaveSettingsRequest]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var o,a,s;return i.__generator(this,function(i){switch(i.label){case 0:if(o=n[0],(a=JSON.stringify(o)).length>cn)return r(le(ce.b.GenericSettingsError)),[2];i.label=1;case 1:return i.trys.push([1,3,,4]),s=Object(m.n)(t),[4,(c=s.extension.Id,u=s.extension.Version,l=a,d={ExtensionId:c,ExtensionVersion:u,Settings:l},sn()({request:d}))];case 2:return i.sent(),Object(m.jb)(e,t,a),r(ue()),[3,4];case 3:return i.sent(),r(le(ce.b.GenericSettingsError)),[3,4];case 4:return[2]}var c,u,l,d})})},dn[ln.GetAccessTokenAsync]=function(e,t,n,r){Object(V.d)("addin-getAccessTokenAsync-api")?!function(e){return!!Object(m.E)(e)}(t)?r(le(Oe.b.NotSsoAgave)):Object(m.I)()?r(le(Oe.b.InternalError)):(Object(Oe.d)(function(e,t){var n,o;r(e?function(e){var t;return(t={})[Pt]=e,t}(e):(n=t,(o={})[Pt]=ie.Success,o[Mt]=n,o))}),n.forceConsent?Object(m.ab)(t,m.e.OmexConsent,n.authChallenge):n.authChallenge?Object(m.ab)(t,m.e.MFASignIn,n.authChallenge):Object(Oe.c)(t,n.authChallenge)):r(le(Oe.b.OperationNotSupported))},dn[ln.GetCallbackToken]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var o,a,s,c;return i.__generator(this,function(i){switch(i.label){case 0:return o=Object(m.n)(t),a=function(e){var t=Q.c(e).getItemId();return t?jt+t:null}(e),s=n.isRest?ft:dt,a?[4,Ot(o,s,a)]:(r(le(ce.b.CallSaveAsyncBeforeToken)),[2]);case 1:return c=i.sent(),r(c?Dt(!0,c.TokenValue):le(ce.b.GenericTokenError)),[2]}})})},dn[ln.GetUserIdentityToken]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(n){switch(n.label){case 0:return[4,Ot(Object(m.n)(t),lt)];case 1:return e=n.sent(),r(e?Dt(!0,e.TokenValue):le(ce.b.GenericTokenError)),[2]}})})},dn[ln.MESSAGE_PARENT_DISPID]=function(e,t,n,r){Object(Qt.d)(Qt.a.DISPLAY_DIALOG_DISPID,t,n,function(){r(ue())})},dn[ln.SetBodyAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,o;return i.__generator(this,function(i){switch(i.label){case 0:return function(e){var t=document.createElement("div");t.innerHTML=e;for(var n=t.querySelectorAll("img"),r=0;r<n.length;r++){var o=n[r].getAttribute("src");if(o=decodeURIComponent(o)){var i=o.lastIndexOf(".");if(-1!==i&&"svg"===o.substring(i+1).toLowerCase())return!0}}return!1}(n.data)?(r(le(Oe.b.OperationNotSupported)),[2]):de(t=Object(Q.c)(e),r)?[2]:(o=n.coercionType==ee.a.Html?"HTML":"Text",[4,He(e,0,n,r,function(e){return t.setBody(e,o)})]);case 1:return i.sent(),[2]}})})},dn[ln.GetBodyAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,o,a;return i.__generator(this,function(i){switch(i.label){case 0:if(t=Object(Q.c)(e),o=t.mode,a=null,o!=J.a.MessageRead&&o!=J.a.AppointmentAttendee)return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,kt(t.getItem())];case 2:return a=i.sent(),[3,4];case 3:return i.sent(),r(le(ce.a.GenericResponseError)),[2];case 4:return[3,6];case 5:o!=J.a.MessageCompose&&o!=J.a.AppointmentOrganizer||(a=t.getBody()),i.label=6;case 6:return n.coercionType==ee.a.Text&&(a=he(a)),r(ue(a)),[2]}})})},dn[ln.GetBodyTypeAsync]=function(e,t,n,r){var o=Object(Q.c)(e).getBodyType();r(ue(o&&o.toLowerCase()||null))},dn[ln.BodyPrependAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(o){switch(o.label){case 0:return de(t=Object(Q.c)(e),r)?[2]:n.coercionType===ee.a.Html&&"Text"===t.getBodyType()?(r(le(ce.a.OoeInvalidDataFormat)),[2]):[4,He(e,0,n,r,t.prependBody)];case 1:return o.sent(),[2]}})})},dn[ln.Close]=function(e,t){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return[4,Object(Q.c)(e).close()];case 1:return t.sent(),Object(ze.a)(e),[2]}})})},dn[ln.CloseApp]=qe,dn[ln.CloseContainer]=qe,dn[ln.DisplayMessageForm]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return[4,Object(Q.c)(e).displayMessageForm(n.itemId)];case 1:return t.sent(),r(ue()),[2]}})})},dn[ln.DisplayReplyAllForm]=$e,dn[ln.DisplayReplyAllFormWithAttachments]=$e,dn[ln.DisplayReplyForm]=et,dn[ln.DisplayReplyFormWithAttachments]=et,dn[ln.DisplayAppointmentForm]=function(e,t,n,r){n.itemId?(Object(Q.c)(e).displayAppointmentForm(n.itemId),r(ue())):r(le())},dn[ln.DisplayNewAppointmentForm]=function(e,t,n,r){var o;!n||Qe((o=n).requiredAttendees,Ke.MaxRecipientsOnDisplayNewAppointment)||Qe(o.optionalAttendees,Ke.MaxRecipientsOnDisplayNewAppointment)||Qe(o.subject,Ke.MaxSubjectLength)||Qe(o.body,Ke.MaxBodyLengthOnDisplayApis)||Qe(o.location,Ke.MaxLocationLengthOnDisplayNewAppointment)?r(le()):(Object(Q.c)(e).displayNewAppointmentForm(Je(n.requiredAttendees),Je(n.optionalAttendees),n.start,n.end,n.location,n.resources,n.subject,n.body),r(ue()))},dn[ln.DisplayNewMessageForm]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,o,a,s,c,u,l,d;return i.__generator(this,function(f){switch(f.label){case 0:if(t=!1,o=i.__read([n.toRecipients,n.ccRecipients,n.bccRecipients].map(function(e){return e?e.length>Ke.MaxRecipientsPerCall?(t=!0,null):function(e){var t=[];return e.forEach(function(e){xe(e)&&t.push({Name:e,EmailAddress:e,MailboxType:"OneOff",RoutingType:"SMTP"})}),t}(e):[]}),3),a=o[0],s=o[1],c=o[2],t)return r(le()),[2];if(u="",n.subject){if(n.subject.length>Ke.MaxSubjectLength)return r(le()),[2];u=n.subject}return l="",n.htmlBody?n.htmlBody.length>Ke.MaxBodyLengthOnDisplayApis?(r(le()),[2]):[4,Le(n.htmlBody)]:[3,2];case 1:if(null==(l=f.sent()))return r(le()),[2];f.label=2;case 2:if(d=[],n.attachments){if(n.attachments.length>Ke.MaxAttachmentNumberOnDisplayApis)return r(le()),[2];d=n.attachments.map(Ye)}return[4,Object(Q.c)(e).displayNewMessageForm(a,s,c,u,l,d)];case 3:return f.sent(),r(ue()),[2]}})})},dn[ln.EventCompleted]=function(e,t,n,r){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(t,n)},dn[ln.GetSelectedDataAsync]=function(e,t,n,r){var o=Object(Q.c)(e).getSelectedData();o?(n.coercionType==ee.a.Text&&(o.data=he(o.data)),r(ue(o))):r(le(ce.a.InvalidSelection))},dn[ln.SetSelectedDataAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,o;return i.__generator(this,function(i){switch(i.label){case 0:return de(t=Object(Q.c)(e),r)?[2]:null==(o=t.getSelectedData())?(r(le(ce.a.InvalidSelection)),[2]):n.coercionType===ee.a.Html&&("subject"===o.sourceProperty||"body"===o.sourceProperty&&"Text"===t.getBodyType())?(r(le(ce.a.OoeInvalidDataFormat)),[2]):[4,He(e,0,n,r,t.setSelectedData,t.getSelectedData)];case 1:return i.sent(),[2]}})})},dn[ln.SetBodySelectedDataAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(o){switch(o.label){case 0:return de(t=Object(Q.c)(e),r)?[2]:[4,He(e,0,n,r,t.setBodySelectedData,t.getSelectedData)];case 1:return o.sent(),[2]}})})},dn[ln.SaveAsync]=function(e,t,n,r){var o=Object(Q.c)(e);de(o,r)||o.saveItem().then(function(e){r(e?ue(e):le(ce.a.SaveError))})},dn[ln.LoadCustomProperties]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var n,o,a,s,c,u;return i.__generator(this,function(i){switch(i.label){case 0:if(n=Object(Q.c)(e),!(o=n.getItemId()))return r(Jt("",!0,"{}")),[2];a=Object(m.v)(t),i.label=1;case 1:return i.trys.push([1,3,,4]),n.isSharedItem&&n.getSharedProperties&&n.isSharedItem()&&n.isRemoteItem()&&(c=n.getSharedProperties(),s=c.owner),[4,Xt(a,o,s)];case 2:return u=i.sent(),r(Jt(u.ErrorMessage,u.WasSuccessful,u.CustomProperties)),[3,4];case 3:return i.sent(),r(le(ce.b.GenericResponseError)),[3,4];case 4:return[2]}})})},dn[ln.SaveCustomProperties]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var o,a,s,c,u,l,d;return i.__generator(this,function(i){switch(i.label){case 0:o=Object(Q.c)(e),a=Object(m.v)(t),s=JSON.stringify(n.customProperties),c=o.getItemId(),i.label=1;case 1:return i.trys.push([1,5,,6]),de(o,r)?[2]:c?[3,3]:[4,o.saveItem()];case 2:c=i.sent(),i.label=3;case 3:return o.isSharedItem&&o.getSharedProperties&&o.isSharedItem()&&o.isRemoteItem()&&(l=o.getSharedProperties(),u=l.owner),[4,on(a,c,u,s)];case 4:return d=i.sent(),Object(V.d)("addin-delegateAccess")?r(ue()):r(Jt(d.ErrorMessage,d.WasSuccessful)),[3,6];case 5:return i.sent(),r(le(ce.b.GenericResponseError)),[3,6];case 6:return[2]}})})},dn[ln.AddNotificationMessageAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var o;return i.__generator(this,function(i){switch(i.label){case 0:return[4,ve(e,t,n.persistent,n.key,n.type,n.message,n.icon,!0)];case 1:return o=i.sent(),r(o),[2]}})})},dn[ln.GetAllNotificationMessagesAsync]=function(e,t,n,r){r(ue(Object(Q.c)(e).getNotificationMessageIds().reduce(function(e,t){var n=Object(pe.e)(t);return n&&e.push(function(e){return i.__assign({key:e.Key,type:ge(e.Type),message:e.Message,icon:e.Icon},e.Persistent&&{persistent:!0})}(n)),e},[])))},dn[ln.RemoveNotificationMessageAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var o;return i.__generator(this,function(i){switch(i.label){case 0:return[4,me(e,t,n.key)];case 1:return o=i.sent(),r(o),[2]}})})},dn[ln.ReplaceNotificationMessageAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var o;return i.__generator(this,function(i){switch(i.label){case 0:return[4,ve(e,t,n.persistent,n.key,n.type,n.message,n.icon,!1)];case 1:return o=i.sent(),r(o),[2]}})})},dn[ln.AddItemAttachmentAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,o,a;return i.__generator(this,function(i){switch(i.label){case 0:t=Object(Q.c)(e),i.label=1;case 1:return i.trys.push([1,3,,4]),de(t,r)?[2]:[4,t.addItemAttachment(n.name,n.itemId,n.isInline)];case 2:return o=i.sent(),r(o?ue(o):le(ce.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return a=i.sent(),r(le(a)),[3,4];case 4:return[2]}})})},dn[ln.AddFileAttachmentAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,o,a;return i.__generator(this,function(i){switch(i.label){case 0:t=Object(Q.c)(e),i.label=1;case 1:return i.trys.push([1,3,,4]),de(t,r)?[2]:[4,t.addFileAttachment(n.name,n.uri,n.isInline)];case 2:return o=i.sent(),r(o?ue(o):le(ce.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return a=i.sent(),r(le(a.errorCode)),[3,4];case 4:return[2]}})})},dn[ln.AddBase64FileAttachmentAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,o,a;return i.__generator(this,function(i){switch(i.label){case 0:t=Object(Q.c)(e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t.addFileAttachmentFromBase64(n.base64String,n.name,n.isInline)];case 2:return o=i.sent(),r(o?ue(o):le(ce.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return a=i.sent(),r(le(a.errorCode)),[3,4];case 4:return[2]}})})},dn[ln.RemoveAttachmentAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,o;return i.__generator(this,function(i){switch(i.label){case 0:if(!n||!n.attachmentIndex)return r(le(ce.a.InvalidAttachmentId)),[2];i.label=1;case 1:return i.trys.push([1,3,,4]),de(t=Object(Q.c)(e),r)?[2]:[4,t.removeAttachment(n.attachmentIndex)];case 2:return i.sent(),r(ue()),[3,4];case 3:return o=i.sent(),r(le(o.errorCode)),[3,4];case 4:return[2]}})})},dn[ln.GetCategoriesAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,n,o,a,s;return i.__generator(this,function(c){switch(c.label){case 0:t=Object(Q.c)(e),n=t.mode,o=null,a=null,c.label=1;case 1:switch(c.trys.push([1,11,,12]),n){case J.a.MessageRead:return[3,2];case J.a.MessageCompose:return[3,4];case J.a.AppointmentAttendee:return[3,5];case J.a.AppointmentOrganizer:return[3,7]}return[3,9];case 2:return[4,t.getCategoriesItem()];case 3:return o=c.sent(),[3,10];case 4:return r(le(Oe.b.OperationNotSupported)),[2];case 5:return[4,t.getCategoriesItem()];case 6:return o=c.sent(),[3,10];case 7:return[4,t.getCategoriesItem()];case 8:return o=c.sent(),[3,10];case 9:Object(Ie.a)(n),c.label=10;case 10:return null==o?(r(le(ce.b.GenericResponseError)),[2]):(a=function(e){var t,n,r=[];try{for(var o=i.__values(e),a=o.next();!a.done;a=o.next()){var s=a.value,c={displayName:s.Name,color:Ae.a[s.Color]};r.push(c)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}(o),r(ue(a)),[3,12]);case 11:return s=c.sent(),r(le(s.errorCode)),[3,12];case 12:return[2]}})})},dn[ln.AddCategoriesAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,o,a,s,c,u;return i.__generator(this,function(l){switch(l.label){case 0:return t=Object(Q.c)(e),o=t.mode,t.isSharedItem()?(r(le(ce.a.InsufficientItemPermissions)),[2]):[4,_e.t.import()];case 1:if(a=l.sent(),s=a(),function(e,t){var n,r,o=function(e){var n=t.filter(function(t){return t.Name===e});if(0===n.length)return{value:!0}};try{for(var a=i.__values(e),s=a.next();!s.done;s=a.next()){var c=s.value,u=o(c);if("object"==typeof u)return u.value}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!1}(n.categories,s)||Ce(n.categories))return r(le(ce.a.InvalidCategoryError)),[2];d=n.categories,f=[],d.forEach(function(e){var t,n,r=!1;try{for(var o=i.__values(f),a=o.next();!a.done;a=o.next())a.value===e&&(r=!0)}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}r||f.push(e)}),c=f,l.label=2;case 2:switch(l.trys.push([2,12,,13]),o){case J.a.MessageRead:return[3,3];case J.a.MessageCompose:return[3,5];case J.a.AppointmentAttendee:return[3,6];case J.a.AppointmentOrganizer:return[3,8]}return[3,10];case 3:return[4,t.addCategoriesItemRead(c)];case 4:return l.sent(),[3,11];case 5:return r(le(Oe.b.OperationNotSupported)),[2];case 6:return[4,t.addCategoriesItemRead(c)];case 7:return l.sent(),[3,11];case 8:return[4,t.addCategoriesItemCompose(c)];case 9:return l.sent(),[3,11];case 10:Object(Ie.a)(o),l.label=11;case 11:return r(ue()),[3,13];case 12:return u=l.sent(),r(le(u.errorCode)),[3,13];case 13:return[2]}var d,f})})},dn[ln.RemoveCategoriesAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,o,a;return i.__generator(this,function(i){switch(i.label){case 0:if(t=Object(Q.c)(e),o=t.mode,t.isSharedItem())return r(le(ce.a.InsufficientItemPermissions)),[2];if(Ce(n.categories))return r(le(ce.a.InvalidCategoryError)),[2];i.label=1;case 1:switch(i.trys.push([1,11,,12]),o){case J.a.MessageRead:return[3,2];case J.a.MessageCompose:return[3,4];case J.a.AppointmentAttendee:return[3,5];case J.a.AppointmentOrganizer:return[3,7]}return[3,9];case 2:return[4,t.removeCategoriesItemRead(n.categories)];case 3:return i.sent(),[3,10];case 4:return r(le(Oe.b.OperationNotSupported)),[2];case 5:return[4,t.removeCategoriesItemRead(n.categories)];case 6:return i.sent(),[3,10];case 7:return[4,t.removeCategoriesItemCompose(n.categories)];case 8:return i.sent(),[3,10];case 9:Object(Ie.a)(o),i.label=10;case 10:return r(ue()),[3,12];case 11:return a=i.sent(),r(le(a.errorCode)),[3,12];case 12:return[2]}})})},dn[ln.GetAttachmentContentAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,o,a;return i.__generator(this,function(i){switch(i.label){case 0:if(!n||!n.id)return r(le(ce.a.InvalidAttachmentId)),[2];switch(t=null,o=Object(Q.c)(e),a=o.mode){case J.a.MessageRead:return[3,1];case J.a.MessageCompose:return[3,3];case J.a.AppointmentAttendee:return[3,5];case J.a.AppointmentOrganizer:return[3,7]}return[3,9];case 1:return[4,Rt(!0,o,n.id)];case 2:return t=i.sent(),[3,10];case 3:return[4,o.getAttachmentContent(n.id)];case 4:return t=i.sent(),[3,10];case 5:return[4,Rt(!1,o,n.id)];case 6:return t=i.sent(),[3,10];case 7:return[4,o.getAttachmentContent(n.id)];case 8:return t=i.sent(),[3,10];case 9:Object(wt.a)(a),i.label=10;case 10:if(null==t)return r(le(ce.a.InvalidAttachmentId)),[2];try{r(ue(t))}catch(e){r(le(ce.a.InvalidAttachmentId))}return[2]}})})},dn[ln.GetAttachmentsAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,n,o;return i.__generator(this,function(i){switch(i.label){case 0:switch(t=Object(Q.c)(e),n=null,o=[],t.mode){case J.a.MessageCompose:return[3,1];case J.a.AppointmentOrganizer:return[3,3]}return[3,5];case 1:return[4,t.getAttachments()];case 2:return n=i.sent(),[3,5];case 3:return[4,t.getAttachments()];case 4:return n=i.sent(),[3,5];case 5:if(null==n)return r(le(ce.a.GenericResponseError)),[2];o=n.map(function(e){return{id:e.id,name:e.name,contentType:e.contentType,size:e.size,attachmentType:e.attachmentType,isInline:e.isInline,url:e.url?e.url:void 0}});try{r(ue(o))}catch(e){r(le(e.errorCode))}return[2]}})})},dn[ln.RegisterConsentAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var o,a,s;return i.__generator(this,function(i){switch(i.label){case 0:if(o=n.consentState,!(a=Object(m.v)(t))||!o)return r(le(ce.b.GenericResponseError)),[2];i.label=1;case 1:return i.trys.push([1,3,,4]),Object(m.gb)(e,t,o),[4,tn(a,o)];case 2:return"NoError"===(s=i.sent()).Body.ResponseCode&&"Success"===s.Body.ResponseClass?(r(ue()),[2]):(r(le(ce.b.GenericResponseError)),[3,4]);case 3:return i.sent(),r(le(ce.b.GenericResponseError)),[3,4];case 4:return[2]}})})},dn[ln.GetLocationAsync]=function(e,t,n,r){r(ue(Object(Q.c)(e).getLocation()||""))},dn[ln.SetLocationAsync]=function(e,t,n,r){if(null!=n.location){var o=Object(Q.c)(e);de(o,r)||(o.setLocation(n.location),r(ue()))}else r(le(null))},dn[ln.GetTimeAsync]=function(e,t,n,r){var o=Object(Q.c)(e),i=null;n.TimeProperty===Gt.Start?i=o.getStartTime():n.TimeProperty===Gt.End&&(i=o.getEndTime()),r(ue(i))},dn[ln.SetTimeAsync]=function(e,t,n,r){var o=Object(Q.c)(e);if(!de(o,r)){var i=new Date(n.time);if(n.TimeProperty===Gt.Start)o.setStartTime(i);else if(n.TimeProperty===Gt.End&&!o.setEndTime(i))return void r(le(ce.a.InvalidEndTime));r(ue())}},dn[ln.GetInitializationContextAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,n;return i.__generator(this,function(o){return t=Object(m.t)().taskPanes,i.__spread(t.values()).forEach(function(t){t.hostItemIndex===e&&t.initializationContext&&(n=t.initializationContext)}),r(n?ue(n):le()),[2]})})},dn[ln.GetFromAsync]=function(e,t,n,r){var o=Object(Q.c)(e).getFrom();r(o?ue({name:o.Name,address:o.EmailAddress}):le())},dn[ln.GetSharedPropertiesAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,n,o,a,s;return i.__generator(this,function(i){switch(i.label){case 0:if(t=Object(Q.c)(e),n=t.getSharedProperties(),!t.isRemoteItem())return[3,5];a=n.owner,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,(l=n.owner,new Promise(function(e,t){if(l){var n=Object(Wt.a)().origin+"/autodiscover/autodiscover.json/v1.0/"+l+"?Protocol=REST",r=new XMLHttpRequest;r.open("GET",n),r.onload=function(){if(200===r.status){var n=JSON.parse(this.response).Url;e(n)}else t(new Error("Request failed with status "+r.status+". Message: "+r.responseText))},r.send()}else t(new Error("smtpAddress is null or empty"))}))];case 2:return o=i.sent(),[3,4];case 3:return i.sent(),o=void 0,[3,4];case 4:return[3,6];case 5:a=Object(W.i)(),o=Object(m.s)().RestUrl,i.label=6;case 6:return c=n.delegatePermissions,u=0,c.Read&&(u+=Bt.Read),c.Create&&(u+=Bt.Create),c.DeleteOwn&&(u+=Bt.DeleteOwn),c.DeleteAll&&(u+=Bt.DeleteAll),c.EditOwn&&(u+=Bt.EditOwn),c.EditAll&&(u+=Bt.EditAll),s={delegatePermissions:u,owner:n.owner,restUrl:o,targetMailbox:a},r(ue(s)),[2]}var c,u,l})})},dn[ln.GetRecurrenceAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,n,o;return i.__generator(this,function(i){switch(i.label){case 0:return[4,(t=Object(Q.c)(e)).getRecurrence()];case 1:return n=i.sent(),o=Object(k.a)({recurrenceType:n,timeZone:t.getTimeZone(),endTime:t.getEndTime(),startTime:t.getStartTime()}),r(ue(o)),[2]}})})},dn[ln.SetRecurrenceAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,o;return i.__generator(this,function(i){switch(i.label){case 0:return Object(k.c)(n.recurrenceData)?de(t=Object(Q.c)(e),r)?[2]:[4,t.getSeriesId()]:(r(le(ce.a.InvalidRecurrence)),[2]);case 1:return null!=i.sent()?(r(le(ce.a.SetRecurrenceOnInstance)),[2]):(null==(o=Object(k.b)(n.recurrenceData))?t.setRecurrence(null):(t.setStartTime(o.startTime),t.setEndTime(o.endTime),t.setRecurrence(o.recurrenceType)),r(ue()),[2])}})})},dn[ln.GetInternetHeadersAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(o){switch(o.label){case 0:return n&&Ut(n.internetHeaderKeys)?[4,Object(Q.c)(e).getInternetHeaders(n.internetHeaderKeys)]:(r(le()),[2]);case 1:return t=o.sent(),r(ue(t)),[2]}})})},dn[ln.SetInternetHeadersAsync]=function(e,t,n,r){if(n&&(o=n.internetHeaderNameValuePairs)&&Ut(Object.keys(o))){var o,i=Object(Q.c)(e);de(i,r)||(i.setInternetHeaders(n.internetHeaderNameValuePairs),r(ue()))}else r(le())},dn[ln.RemoveInternetHeadersAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(o){switch(o.label){case 0:return n&&Ut(n.internetHeaderKeys)?de(t=Object(Q.c)(e),r)?[2]:[4,t.removeInternetHeaders(n.internetHeaderKeys)]:(r(le()),[2]);case 1:return o.sent(),r(ue()),[2]}})})},dn[ln.AppendOnSendAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var o,a,s,c;return i.__generator(this,function(i){switch(i.label){case 0:return(o=n.appendTxt)&&o.length>We?(r(le(ce.a.OoeInvalidDataFormat)),[2]):de(a=Object(Q.c)(e),r)?[2]:n.coercionType===ee.a.Html&&"Text"===a.getBodyType()?(r(le(ce.a.OoeInvalidDataFormat)),[2]):null==(s=Object(m.v)(t))||Object(Ve.a)(s,t)?(r(le(ce.a.GenericResponseError)),[2]):(c={id:s,typ:n.coercionType,txt:o},n.appendOnSend=c,[4,He(e,0,n,r,a.appendOnSend)]);case 1:return i.sent(),[2]}})})},dn[ln.GetEnhancedLocationsAsync]=function(e,t,n,r){var o=Object(Q.c)(e).getEnhancedLocations();!o||o.length<=0?r(ue([])):r(ue(o.map(ne)))},dn[ln.AddEnhancedLocationsAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(o){switch(o.label){case 0:if(de(t=Object(Q.c)(e),r))return[2];if(!n||!re(n.enhancedLocations))return r(le()),[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,t.addEnhancedLocations(n.enhancedLocations)];case 2:return o.sent(),r(ue()),[3,4];case 3:return o.sent(),r(le()),[3,4];case 4:return[2]}})})},dn[ln.RemoveEnhancedLocationsAsync]=function(e,t,n,r){var o=Object(Q.c)(e);n&&re(n.enhancedLocations)?(o.removeEnhancedLocations(n.enhancedLocations),r(ue())):r(le())},dn[ln.GetMasterCategoriesAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,n,o,a,s;return i.__generator(this,function(i){switch(i.label){case 0:t=Object(Q.c)(e),n=t.mode,o=[],a=null,i.label=1;case 1:switch(i.trys.push([1,8,,9]),n){case J.a.MessageRead:case J.a.MessageCompose:return[3,2];case J.a.AppointmentAttendee:case J.a.AppointmentOrganizer:return[3,4]}return[3,6];case 2:return[4,t.getCategoriesMailbox()];case 3:return o=i.sent(),[3,7];case 4:return[4,t.getCategoriesMailbox()];case 5:return o=i.sent(),[3,7];case 6:Object(Ie.a)(n),i.label=7;case 7:return null==o||null==o?(r(le(ce.b.GenericResponseError)),[2]):(a=o.map(function(e){return{displayName:e.Name,color:Ae.a[e.Color]}}),r(ue(a)),[3,9]);case 8:return s=i.sent(),r(le(s.errorCode)),[3,9];case 9:return[2]}})})},dn[ln.AddMasterCategoriesAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,o,a,s,c;return i.__generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),(t=Object(Q.c)(e)).isSharedItem()?(r(le(ce.b.InsufficientItemPermissions)),[2]):(o=n.categoryDetails.map(function(e){return{Name:e.displayName,Id:Object(Te.a)(),Color:Ae.a[e.color]}}),(a=function(e,t){var n=[];return e.forEach(function(e){var t=e.Name.length;if(0===t||t>255)return null;for(var r=!1,o=0;o<n.length;o++)n[o].Name==e.Name&&(n[o].Color=e.Color,r=!0);r||n.push(e)}),n}(o))?function(e){for(var t=Object(_e.l)(),n=function(n){var r=t.filter(function(t){return t.Name===e[n].Name});if(r.length>0)return{value:!0}},r=0;r<e.length;r++){var o=n(r);if("object"==typeof o)return o.value}return!1}(a)?(r(le(ce.b.DuplicateCategoryError)),[2]):[4,t.addCategoriesMailbox(a)]:(r(le(ce.b.InvalidCategoryError)),[2]));case 1:return s=i.sent(),r(s?ue():le(ce.b.GenericResponseError)),[3,3];case 2:return c=i.sent(),r(le(c.errorCode)),[3,3];case 3:return[2]}})})},dn[ln.RemoveMasterCategoriesAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,o,a,s;return i.__generator(this,function(i){switch(i.label){case 0:if(i.trys.push([0,2,,3]),(t=Object(Q.c)(e)).isSharedItem())return r(le(ce.b.InsufficientItemPermissions)),[2];for(o=0;o<n.categories.length;o++)if(0===(a=n.categories[o].length)||a>255)return r(le(ce.b.InvalidCategoryError)),[2];return[4,t.removeCategoriesMailbox(n.categories)];case 1:return s=i.sent(),r(s?ue():le(ce.b.GenericResponseError)),[3,3];case 2:return i.sent(),r(le()),[3,3];case 3:return[2]}})})},dn[ln.GetItemIdAsync]=function(e,t,n,r){var o=Object(Q.c)(e).getItemId();r(o?ue(o):le(ce.a.ItemNotSavedError))},dn);function mn(e,t,n,r,o){var i=pn[t];if(i){var a=Object(m.n)(n),s="ExecuteApiMethod";if(!be(e))return Object(fn.o)("ExtExecuteApiMethodNoItemFailure",[t]),void o(le(ce.b.GenericResponseError));try{i(e,n,r,function(r){var i=null;r&&r.errorCode&&(i=r.errorCode),Object(fn.o)(s,{dispId:t,Id:a.extension.Id,DisplayName:a.extension.DisplayName,owa_1:Object(G.b)(),owa_2:Object(m.z)(e),extPoint:Object(m.r)(n),owa_4:a.extension.Type,errorCode:i}),o(r)})}catch(r){Object(fn.o)(s,{dispId:t,Id:a.extension.Id,DisplayName:a.extension.DisplayName,owa_1:Object(G.b)(),owa_2:Object(m.z)(e),extPoint:Object(m.r)(n),owa_4:a.extension.Type,error:JSON.stringify(r)}),o(le(ce.b.InternalServerError))}}}var gn=n(6634),vn=n.n(gn);function hn(e,t,n,r,o){var i={FormFactor:e,ClientLanguage:t,IncludeDisabledExtensions:n,ApiVersionSupported:r,ClientOverrideVersion:o};return vn()({request:i})}var yn=n(6636),bn=n.n(yn),_n=n(6638),Sn=n.n(_n);function Cn(e){var t=Sn()({ItemId:e});return bn()({Header:Object(C.getJsonRequestHeader)(),Body:t})}function On(e){return i.__awaiter(this,void 0,void 0,function(){var t,n,r;return i.__generator(this,function(o){switch(o.label){case 0:return t=Object(Q.c)(e),n={Id:t.getItemId()},t.addNotificationMessage?(Object(pe.c)(e).map(t.addNotificationMessage),[4,Cn(n).catch(In)]):[2];case 1:return(r=o.sent())&&(r.Body.Apps||[]).forEach(function(n){var r=!1;n.Notifications.forEach(function(o){var i={ExtensionId:n.Id,Persistent:!0,Key:o.Key,Type:o.Type,Message:o.Message,Icon:o.Icon};2===o.Type&&(i.Persistent=!1,r=!0);var a=oe(e,n.Id,o.Key);Object(pe.a)(e,n.Id,a,i),t.addNotificationMessage(a)}),r&&Object(ae.a)(e,n.Id)}),[2]}})})}function In(){return null}n.d(t,"d",function(){return Q.a}),n.d(t,"i",function(){return Q.b}),n.d(t,"n",function(){return Q.c}),n.d(t,"h",function(){return ne}),n.d(t,"e",function(){return ve}),n.d(t,"g",function(){return he}),n.d(t,"f",function(){return ye}),n.d(t,"j",function(){return pe.b}),n.d(t,"k",function(){return be}),n.d(t,"l",function(){return c}),n.d(t,"m",function(){return mn}),n.d(t,"o",function(){return P}),n.d(t,"p",function(){return hn}),n.d(t,"q",function(){return B}),n.d(t,"r",function(){return On}),n.d(t,"s",function(){return me}),n.d(t,"a",function(){return $.a}),n.d(t,"b",function(){return Y}),n.d(t,"c",function(){return Z.a})},3633:function(e,t,n){"use strict";var r=n(1160),o=1/0;t.a=function(e){if("string"==typeof e||Object(r.a)(e))return e;var t=e+"";return"0"==t&&1/e==-o?"-0":t}},3634:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(3935);function o(e){return Object(r.a)().sharingLinks.get(e)}},3637:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3859);t.HtmlSanitizer=r.default;var o=n(3669);t.htmlToDom=o.default,t.splitWithFragment=o.splitWithFragment;var i=n(3668);t.getInheritableStyles=i.default},3652:function(e,t,n){"use strict";var r=n(0),o=n(2523),i=n(7);t.a=Object(i.action)("getAndPopulateSuggestedContacts")(function(e,t){var n=Object(o.a)("",5,t).map(function(e){return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId}});e.splice.apply(e,r.__spread([0,e.length],n))})},3661:function(e,t,n){"use strict";var r=n(1),o=Object(r.createStore)("inlineimages",{inlineImages:{}})();t.a=o},3664:function(e,t,n){"use strict";var r=n(4),o=n(3550),i=n(3617),a=n(12),s=n(7);t.a=Object(s.action)("pauseSession")(function(e){if(e&&e.hasSessionStarted&&!e.isSessionPaused){var t=Object(i.a)(e,{eventType:"SessionPaused",recipientEmailAddresses:null,endSessionAction:null});Object(o.a)(e,t,!1),e.isSessionPaused=!0,a.c.info(Object(r.b)("{0} pauseSession : Session paused. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})},3665:function(e,t,n){"use strict";var r=n(4),o=n(3550),i=n(3617),a=n(12),s=n(7);t.a=Object(s.action)("resumeSession")(function(e){if(e&&e.isSessionPaused){var t=Object(i.a)(e,{eventType:"SessionResumed",recipientEmailAddresses:null,endSessionAction:null});Object(o.a)(e,t,!1),e.isSessionPaused=!1,a.c.info(Object(r.b)("{0} FeedbackManagerBase.ResumeSession: Session resumed. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})},3667:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign?function(e,t){return Object.assign(t||{},e)}:function(e,t){var n=t||{};if(e)for(var r=0,o=Object.keys(e);r<o.length;r++){var i=o[r];n[i]=e[i]}return n};t.default=r},3668:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="border-spacing,caption-side,color,cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,widows,word-spacing".split(",");t.default=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView,n=t&&t.getComputedStyle(e),o={};return r.forEach(function(e){return o[e]=n&&n.getPropertyValue(e)||""}),o}},3669:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="\x3c!--StartFragment--\x3e",o="\x3c!--EndFragment--\x3e";function i(e){var t=e.indexOf(r),n=e.lastIndexOf(o);if(t>=0&&n>=0&&n>=t+r.length){var i=e.substr(0,t),a=e.substr(n+o.length);return[e=e.substring(t+r.length,n),i,a]}return[e,null,null]}t.default=function(e,t,n){var r=(new DOMParser).parseFromString(e||"","text/html");return r&&r.body&&r.body.firstChild?(t&&(n||function(e,t){var n=i(t)[0];e.body.innerHTML=n})(r,e),r):null},t.splitWithFragment=i},3670:function(e,t,n){"use strict";var r=n(2553),o=n(7),i=Object(o.action)("addInfoBarMessageInCompose")(function(e,t,n){Object(r.a)(e,t,e.composeId,n)});t.a=i},3671:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"d",function(){return a}),n.d(t,"c",function(){return s});var r={};function o(e,t){r[e.composeId]=t}function i(e){return r[e.composeId]}function a(e){var t=i(e);t&&t.contentOperationPlugin&&t.contentOperationPlugin.stopSaveOnDispose(),delete r[e.composeId]}function s(e){return[e.dockingPlugin,e.dictationPlugin,e.ribbonPlugin,e.inlineImagePlugin,e.inlineImageResizePlugin,e.contentOperationPlugin,e.tableEdit,e.smartSuggestionsPlugin,e.linkPreviewPlugin,e.addinPlugin,e.accCheckerPlugin,e.pasteOptionPlugin,e.linkPlugin,e.mentionsPickerPlugin,e.cortanaComposePlugin,e.emojiPickerPlugin,e.smartComposePlugin,e.praguePlugin]}},3677:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(3711);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("AddEntityFeedback",e,t)}},3678:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"AddEntityFeedbackRequest:#Exchange"},e)}},3680:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients}n.d(t,"a",function(){return r})},3681:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(3680);function o(e,t){return Object(r.a)(e)?e.recipients:t||[]}},3682:function(e,t,n){"use strict";t.a={Unknown:0,Person:1,DistributionList:2,ModernGroup:5,ImplicitGroup:10,ExplicitGroup:11,LinkedIn:12}},3702:function(e,t,n){"use strict";var r=n(1),o=n(266),i={expressionPickerViewState:null,selectedSkinTone:Object(o.c)(o.a.DiverseEmojis).diverseEmojisSelectedSkinTone,useFlexPane:null},a=Object(r.createStore)("expression",i)();t.a=a},3703:function(e,t,n){"use strict";n.d(t,"c",function(){return b}),n.d(t,"e",function(){return S}),n.d(t,"f",function(){return C}),n.d(t,"d",function(){return O}),n.d(t,"a",function(){return I});var r=n(0),o=n(3670),i=n(3716),a=n(4164),s=n(4169),c=n(4829),u=n(4634),l=n(4299),d=n(4977),f=n(5042),p=n(1589),m=n(4171),g=n(9),v=n(26),h={};function y(e){var t=h[e.composeId];return t||(t={activeSaveAction:null,hasPendingSaveAction:!1},h[e.composeId]=t),t}function b(e){var t=h[e.composeId];return t&&!!t.activeSaveAction}function _(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return(t=y(e)).activeSaveAction?[3,1]:[2,Promise.resolve(!0)];case 1:return t.hasPendingSaveAction?[4,t.activeSaveAction]:[3,3];case 2:return n.sent(),[2,Promise.resolve(!1)];case 3:return t.hasPendingSaveAction=!0,[4,t.activeSaveAction];case 4:return n.sent(),t.hasPendingSaveAction=!1,[2,Promise.resolve(!0)]}})})}function S(e,t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return(n=y(e)).activeSaveAction=t,[4,t.then(function(e){return n.activeSaveAction=null,Promise.resolve(e)}).catch(function(e){return n.activeSaveAction=null,Promise.reject(e)})];case 1:return r.sent(),[2]}})})}function C(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return(t=h[e.composeId])&&t.activeSaveAction?[4,t.activeSaveAction]:[3,2];case 1:return n.sent(),[2,Promise.resolve(!0)];case 2:return[2,Promise.resolve(!1)]}})})}function O(e){var t=h[e.composeId];return t&&!!t.activeSaveAction}function I(e){h[e.composeId]&&delete h[e.composeId]}t.b=Object(v.b)("trySaveMessage",s.b.MailComposeSave)(function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return e?e.isSending?[2,Promise.resolve()]:(t||(Object(i.a)(e,c.a),e.isManuallySaved=!0),function(e){return Object(p.a)(e)<=Object(g.a)().MaxRecipientsPerMessage}(e)?[4,_(e)]:(t||Object(o.a)(e,"warningMessageMaxRecipientsExceed"),[2,Promise.resolve()])):[2,Promise.reject("could not save message if view state does not exist")];case 1:return r.sent()?[2,S(e,Object(f.b)(e).then(function(n){return Object(f.a)(n,e),Object(m.a)()&&Object(a.a)(e,t?2:4),Object(u.a)(1,Object(l.a)(e)),Promise.resolve()}).catch(function(r){if(!t){var i=Object(d.a)(r?r.message:null,!1);Object(o.a)(e,i)}return n?Promise.reject(r):Promise.resolve()}))]:[2,Promise.resolve()]}})})})},3711:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"AddEntityFeedbackJsonRequest:#Exchange"},e)}},3716:function(e,t,n){"use strict";var r=n(1725),o=n(7),i=Object(o.action)("removeInfoBarMessageInCompose")(function(e,t){e.infoBarIds&&e.infoBarIds.length&&(t?(t=Array.isArray(t)?t:[t]).forEach(function(t){Object(r.a)(e,t,e.composeId)}):e.infoBarIds.forEach(function(t){Object(r.a)(e,t,e.composeId)}))});t.a=i},3723:function(e,t,n){"use strict";t.a=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}},3725:function(e,t,n){"use strict";var r=n(0),o=n(4041),i=n(3795),a=n(4022),s=n(4081),c=n(3702),u=n(4023),l=n(136),d=n(87),f=27,p=75,m=Object(d.h)()?function(e){return e.metaKey}:function(e){return e.ctrlKey},g=function(){function e(e,t){var n=this;this.ribbonViewState=e,this.getSelectedImageCallback=t,this.workaroundFocusIssueForFirefox=Object(l.f)()?function(){if(n.editor){var e=n.editor.getCustomData("WORKAROUND_TEXTBOX_FOR_FIREFOX",function(){var e=n.editor.getDocument().createElement("input");return e.type="textbox",e.style.width="0",e.style.height="0",n.editor.insertNode(e,{position:3,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),e},function(e){return e.parentNode&&e.parentNode.removeChild(e)});e.style.display="",e.focus(),e.style.display="none"}}:function(){},this.insertNodeFromExpressionPicker=function(e){if(n.editor&&!n.editor.isDisposed()){n.editor.focus();var t=c.a.expressionPickerViewState.wordToReplace;n.editor.performAutoComplete(function(){t?n.pluginUtils.replaceWithNode(n.editor,t,e,!0):n.editor.insertNode(e,{position:2,updateCursor:!0,replaceSelection:!0,insertOnNewLine:!1}),Object(s.a)(c.a.expressionPickerViewState,"")},"Ribbon")}},this.insertLinkFeature={keys:[p],allowFunctionKeys:!0,shouldHandleEvent:function(e){var t=e.rawEvent;return!t.altKey&&!t.shiftKey&&m(t)},handleEvent:function(e){var t=e.rawEvent;t.preventDefault(),t.stopPropagation(),n.workaroundFocusIssueForFirefox(),i.g.import().then(function(e){return e(n)})}},this.closeContextualFormatBarFeature={keys:[f],shouldHandleEvent:function(){return n.ribbonViewState.isContextualFormatBarShown},handleEvent:function(e){var t=e.rawEvent;t.preventDefault(),t.stopPropagation(),Object(o.a)(n.ribbonViewState,!1)}}}return e.prototype.getName=function(){return"Ribbon"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.editor.addContentEditFeature(this.insertLinkFeature),this.editor.addContentEditFeature(this.closeContextualFormatBarFeature),i.h.import().then(function(e){return t.updateRibbonState=e})},e.prototype.onPluginEvent=function(e){var t=this;if(this.updateRibbonState&&(2==e.eventType&&e.rawEvent.keyCode!=f||5==e.eventType||6==e.eventType)){var n=6!=e.eventType;this.updateRibbonState(this,this.ribbonViewState,n,!0)}this.ribbonViewState.formatViewState.formatPainterFormat&&5==e.eventType&&i.e.import().then(function(e){return e(t)})},e.prototype.dispose=function(){this.editor=null,a.a.importAndExecute()},e.prototype.getEditor=function(){return this.editor},e.prototype.getFormatState=function(){return this.ribbonViewState.formatViewState},e.prototype.getImageSelectedByPlugin=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return this.getSelectedImageCallback?[4,this.getSelectedImageCallback]:[3,2];case 1:return e=t.sent()(),[3,3];case 2:e=null,t.label=3;case 3:return[2,e]}})})},e.prototype.setPluginUtils=function(e){this.pluginUtils=e},e.prototype.toggleExpressionPicker=function(e,t){e?u.b.importAndExecute(this.insertNodeFromExpressionPicker,t,"","ribbon"):a.a.importAndExecute()},e}();t.a=g},373:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("setPopoutChildState",function(e){return{state:e}})},3731:function(e,t,n){"use strict";var r=n(3670),o=n(3716);n.d(t,"a",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s});var i=function(e){return function(t,n){Object(r.a)(e,t,n)}},a=function(e){return function(t){Object(o.a)(e,t)}},s=function(e){return function(){return function(e){return e.infoBarIds}(e)}}},3739:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},375:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});var r="popoutv2",o="1"},3751:function(e,t,n){"use strict";var r=n(741),o=n(274),i=Object(r.a)(o.a,"DataView"),a=n(1131),s=Object(r.a)(o.a,"Promise"),c=n(3932),u=n(4107),l=n(384),d=n(1316),f=Object(d.a)(i),p=Object(d.a)(a.a),m=Object(d.a)(s),g=Object(d.a)(c.a),v=Object(d.a)(u.a),h=l.a;(i&&"[object DataView]"!=h(new i(new ArrayBuffer(1)))||a.a&&"[object Map]"!=h(new a.a)||s&&"[object Promise]"!=h(s.resolve())||c.a&&"[object Set]"!=h(new c.a)||u.a&&"[object WeakMap]"!=h(new u.a))&&(h=function(e){var t=Object(l.a)(e),n="[object Object]"==t?e.constructor:void 0,r=n?Object(d.a)(n):"";if(r)switch(r){case f:return"[object DataView]";case p:return"[object Map]";case m:return"[object Promise]";case g:return"[object Set]";case v:return"[object WeakMap]"}return t});t.a=h},3755:function(e,t,n){"use strict";var r=n(879),o=n(3909),i=n(4320),a=n(2133);t.a=function(e,t){return Object(r.a)(e)?e:Object(o.a)(e,t)?[e]:Object(i.a)(Object(a.a)(e))}},3769:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(4551);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetClientAccessToken",e,t)}},3770:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetClientAccessTokenRequest:#Exchange"},e)}},3777:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(9),o=n(56),i=n(5);function a(){return Object(o.a)()?Object(i.d)("cmp-encryption")&&Object(r.a)().SessionSettings.IsPremiumConsumerMailbox:Object(i.d)("cmp-manageIRM")&&Object(r.a)().SegmentationSettings.Irm}},3778:function(e,t,n){"use strict";t.a=function(){return[]}},3782:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a});var r=n(3),o=new r.c(function(){return n.e(264).then(n.bind(null,4875))}),i=new r.b(o,function(e){return e.createLinkPreview}),a=new r.b(o,function(e){return e.rehydrateLinkPreview})},3792:function(e,t,n){"use strict";var r=n(15),o=n(9),i=n(5);n(6621);var a=n(6622);OSF.getLocalizedStringsFilePath=function(){var e=Object(r.q)()+"resources/locale/osfruntime/",t=Object(o.a)().SessionSettings?Object(o.a)().SessionSettings.UserLanguage:"en";return e+(a[t]||"en-us")+"/jscript/"},OSF.getManifestHostType=function(){},OSF.AppTelemetry={enableTelemetry:Object(i.d)("addin-oteljs")}},3795:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"h",function(){return u}),n.d(t,"e",function(){return l}),n.d(t,"g",function(){return d}),n.d(t,"d",function(){return f}),n.d(t,"f",function(){return p});var r=n(3725);n.d(t,"c",function(){return r.a});var o=n(3),i=new o.c(function(){return Promise.all([n.e(4),n.e(8),n.e(10),n.e(11),n.e(242)]).then(n.bind(null,4753))}),a=Object(o.d)(i,function(e){return e.Ribbon}),s=Object(o.d)(i,function(e){return e.ContextualFormatBar}),c=new o.a(i,function(e){return e.updateRibbonWidth}),u=new o.b(i,function(e){return e.updateRibbonState}),l=new o.b(i,function(e){return e.formatPainterFinish}),d=new o.b(i,function(e){return e.showInsertLinkDialog}),f=new o.b(i,function(e){return e.displayInsertLinkDialog}),p=new o.b(i,function(e){return e.showImageAltTextDialog})},3799:function(e,t,n){"use strict";var r=n(1616),o=n(3833),i=n(4038),a=n(3821),s=1,c=2;var u=function(e,t,n,r,u,l){var d=n&s,f=e.length,p=t.length;if(f!=p&&!(d&&p>f))return!1;var m=l.get(e);if(m&&l.get(t))return m==t;var g=-1,v=!0,h=n&c?new o.a:void 0;for(l.set(e,t),l.set(t,e);++g<f;){var y=e[g],b=t[g];if(r)var _=d?r(b,y,g,t,e,l):r(y,b,g,e,t,l);if(void 0!==_){if(_)continue;v=!1;break}if(h){if(!Object(i.a)(t,function(e,t){if(!Object(a.a)(h,t)&&(y===e||u(y,e,n,r,l)))return h.push(t)})){v=!1;break}}else if(y!==b&&!u(y,b,n,r,l)){v=!1;break}}return l.delete(e),l.delete(t),v},l=n(345),d=n(1400),f=n(643),p=n(3907),m=n(3723),g=1,v=2,h="[object Boolean]",y="[object Date]",b="[object Error]",_="[object Map]",S="[object Number]",C="[object RegExp]",O="[object Set]",I="[object String]",A="[object Symbol]",T="[object ArrayBuffer]",E="[object DataView]",x=l.a?l.a.prototype:void 0,P=x?x.valueOf:void 0;var M=function(e,t,n,r,o,i,a){switch(n){case E:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case T:return!(e.byteLength!=t.byteLength||!i(new d.a(e),new d.a(t)));case h:case y:case S:return Object(f.a)(+e,+t);case b:return e.name==t.name&&e.message==t.message;case C:case I:return e==t+"";case _:var s=p.a;case O:var c=r&g;if(s||(s=m.a),e.size!=t.size&&!c)return!1;var l=a.get(e);if(l)return l==t;r|=v,a.set(e,t);var x=u(s(e),s(t),r,o,i,a);return a.delete(e),x;case A:if(P)return P.call(e)==P.call(t)}return!1},w=n(4039),R=1,k=Object.prototype.hasOwnProperty;var D=function(e,t,n,r,o,i){var a=n&R,s=Object(w.a)(e),c=s.length;if(c!=Object(w.a)(t).length&&!a)return!1;for(var u=c;u--;){var l=s[u];if(!(a?l in t:k.call(t,l)))return!1}var d=i.get(e);if(d&&i.get(t))return d==t;var f=!0;i.set(e,t),i.set(t,e);for(var p=a;++u<c;){var m=e[l=s[u]],g=t[l];if(r)var v=a?r(g,m,l,t,e,i):r(m,g,l,e,t,i);if(!(void 0===v?m===g||o(m,g,n,r,i):v)){f=!1;break}p||(p="constructor"==l)}if(f&&!p){var h=e.constructor,y=t.constructor;h!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof h&&h instanceof h&&"function"==typeof y&&y instanceof y)&&(f=!1)}return i.delete(e),i.delete(t),f},j=n(3751),N=n(879),F=n(1085),L=n(1091),U=1,B="[object Arguments]",H="[object Array]",V="[object Object]",W=Object.prototype.hasOwnProperty;var G=function(e,t,n,o,i,a){var s=Object(N.a)(e),c=Object(N.a)(t),l=s?H:Object(j.a)(e),d=c?H:Object(j.a)(t),f=(l=l==B?V:l)==V,p=(d=d==B?V:d)==V,m=l==d;if(m&&Object(F.a)(e)){if(!Object(F.a)(t))return!1;s=!0,f=!1}if(m&&!f)return a||(a=new r.a),s||Object(L.a)(e)?u(e,t,n,o,i,a):M(e,t,l,n,o,i,a);if(!(n&U)){var g=f&&W.call(e,"__wrapped__"),v=p&&W.call(t,"__wrapped__");if(g||v){var h=g?e.value():e,y=v?t.value():t;return a||(a=new r.a),i(h,y,n,o,a)}}return!!m&&(a||(a=new r.a),D(e,t,n,o,i,a))},z=n(340);t.a=function e(t,n,r,o,i){return t===n||(null==t||null==n||!Object(z.a)(t)&&!Object(z.a)(n)?t!=t&&n!=n:G(t,n,r,o,e,i))}},3820:function(e,t,n){"use strict";n.d(t,"a",function(){return m}),n.d(t,"c",function(){return g}),n.d(t,"b",function(){return v});var r=n(15),o=n(135),i=n(134),a="resources/images/surfaceActions",s=a+"/attach.svg",c=a+"/attachDark.svg",u=a+"/inlineimage.svg",l=a+"/inlineimageDark.svg",d=a+"/emoji.svg",f=a+"/showribbon.svg",p=a+"/showribbonDark.svg";function m(e){var t,n,a=!1;switch(e){case"AddAttachment":t=Object(o.resolve)(Object(r.q)(),Object(i.c)()?c:s),n=Object(o.resolve)(Object(r.q)(),s),a=!0;break;case"AddInlineImage":t=Object(o.resolve)(Object(r.q)(),Object(i.c)()?l:u),n=Object(o.resolve)(Object(r.q)(),u),a=!0;break;case"AddEmoji":t=Object(o.resolve)(Object(r.q)(),d),a=!0;break;case"ToggleDarkCompose":t="Sunny";break;case"ToggleRibbon":t=Object(o.resolve)(Object(r.q)(),Object(i.c)()?p:f),n=Object(o.resolve)(Object(r.q)(),f),a=!0;break;case"SensitivityMenu":t="MarkAsProtected";break;case"ProtectMessage":t="Encryption";break;case"SaveDraft":t="Save";break;case"InsertSignature":t="InsertSignatureLine";break;case"ShowFrom":t="ArrangeByFrom";break;case"SetImportance":t="Important";break;case"ShowMessageOptions":t="MailOptions";break;case"SwitchBodyType":case"AccChecker":t="OutlookLogo";break;default:t=""}return{iconName:t,fallbackIconName:n||t,isImage:a}}function g(e){var t;switch(e){case"-":t="-";break;case"Reply":t="Reply";break;case"ReplyAll":t="ReplyAll";break;case"Forward":t="Forward";break;case"ReplyByMeeting":t="Calendar";break;case"ReportAbuse":t="ReportHacked";break;case"Delete":t="Delete";break;case"MarkReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"AssignPolicy":t="Assign";break;case"AddToSafeSenders":t="AddFriend";break;case"MarkJunkNotJunk":t="MailAlert";break;case"MarkAsPhishing":t="Phishing";break;case"Block":t="BlockContact";break;case"CreateRule":t="CreateMailRule";break;case"Print":t="Print";break;case"Translate":t="LocaleLanguage";break;case"ShowInImmersiveReader":t="ReadOutLoud";break;case"ViewMessageSource":t="OpenSource";break;case"Popout":t="OpenInNewWindow";break;case"LikeUnlike":t="Like";break;case"ToggleDarkMode":t="Sunny";break;case"ReplyByIM":case"ReplyAllByIM":t="ChatInviteFriend";break;case"ToggleAmp":t="LightningBolt";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}function v(e){var t;switch(e){case"-":t="-";break;case"Delete":t="Delete";break;case"Archive":t="Archive";break;case"PinUnpin":t="Pinned";break;case"ReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"Move":t="FabricFolder";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}},3821:function(e,t,n){"use strict";t.a=function(e,t){return e.has(t)}},3829:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a});var r=n(4633),o=function(e){return[e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell]},i=function(e){var t=o(e);return Object(r.a)(t).map(function(e){return e.persona.EmailAddress.EmailAddress})},a=function(e){var t=o(e);return Object(r.a)(t).map(function(e){return e.persona.EmailAddress})}},383:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(644),o=n(72);function i(){return o.a.tableViews.get(Object(r.a)())}},3833:function(e,t,n){"use strict";var r=n(1632),o="__lodash_hash_undefined__";var i=function(e){return this.__data__.set(e,o),this};var a=function(e){return this.__data__.has(e)};function s(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r.a;++t<n;)this.add(e[t])}s.prototype.add=s.prototype.push=i,s.prototype.has=a;t.a=s},385:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ItemResponseShape:#Exchange"},e)}},3853:function(e,t,n){"use strict";var r=n(3755),o=n(3633);t.a=function(e,t){for(var n=0,i=(t=Object(r.a)(t,e)).length;null!=e&&n<i;)e=e[Object(o.a)(t[n++])];return n&&n==i?e:void 0}},3856:function(e,t,n){"use strict";n.d(t,"b",function(){return ReactEditor}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return s});var r=n(3),o=new r.c(function(){return Promise.all([n.e(4),n.e(8),n.e(10),n.e(11),n.e(242)]).then(n.bind(null,4905))}),ReactEditor=Object(r.d)(o,function(e){return e.ReactEditor}),i=Object(r.d)(o,function(e){return e.BareContentEditableDivEditor}),a=new r.b(o,function(e){return e.createUndo}),s=new r.b(o,function(e){return e.setTableHeaderRow})},3859:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3667),o=n(3668),i=n(3669),a=n(3860),s=function(){function e(e){e=e||{},this.elementCallbacks=r.default(e.elementCallbacks),this.styleCallbacks=a.getStyleCallbacks(e.styleCallbacks),this.attributeCallbacks=r.default(e.attributeCallbacks),this.allowedTags=a.getAllowedTags(e.additionalAllowedTags),this.allowedAttributes=a.getAllowedAttributes(e.additionalAllowAttributes),this.defaultStyleValues=a.getDefaultStyleValues(e.additionalDefaultStyleValues),this.additionalGlobalStyleNodes=e.additionalGlobalStyleNodes||[],this.allowPreserveWhiteSpace=e.allowPreserveWhiteSpace}return e.convertInlineCss=function(t,n){return new e({additionalGlobalStyleNodes:n}).exec(t,!0)},e.sanitizeHtml=function(t,n){var r=new e(n=n||{}),i=n.currentElementOrStyle instanceof HTMLElement?o.default(n.currentElementOrStyle):n.currentElementOrStyle;return r.exec(t,n.convertCssOnly,n.preserveFragmentOnly,i)},e.prototype.exec=function(e,t,n,r){var o=i.default(e,n);return o&&(this.convertGlobalCssToInlineCss(o),t||this.sanitize(o.body,r)),o&&o.body&&o.body.innerHTML||""},e.prototype.sanitize=function(e,t){if(!e)return"";t=r.default(t,o.default(null)),this.processNode(e,t,{})},e.prototype.convertGlobalCssToInlineCss=function(e){for(var t=c(e.querySelectorAll("style")),n=0,r=this.additionalGlobalStyleNodes.reverse().map(function(e){return e.sheet}).concat(t.map(function(e){return e.sheet}).reverse()).filter(function(e){return e});n<r.length;n++)for(var o=r[n],i=function(t){var n=o.cssRules[t],r=n&&n.style?n.style.cssText:null;if(n.type!=CSSRule.STYLE_RULE||!r||!n.selectorText)return"continue";for(var i=0,a=n.selectorText.split(",");i<a.length;i++){var s=a[i];if(s&&s.trim()&&!(s.indexOf(":")>=0))c(e.querySelectorAll(s)).forEach(function(e){return e.setAttribute("style",r+(e.getAttribute("style")||""))})}},a=o.cssRules.length-1;a>=0;a--)i(a);t.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})},e.prototype.processNode=function(e,t,n){var o=e.nodeType,i=o==Node.ELEMENT_NODE,a=o==Node.TEXT_NODE,s=e,c=i?s.tagName.toUpperCase():"";if(i&&!this.allowElement(s,c,n)||a&&/^[\r\n]*$/g.test(e.nodeValue)&&!t.insidePRE||!i&&!a)e.parentNode.removeChild(e);else if(a&&!this.allowPreserveWhiteSpace&&"pre"==t["white-space"])e.nodeValue=e.nodeValue.replace(/^ /gm," ").replace(/ {2}/g,"  ");else if(i){var u=r.default(t);this.processAttributes(s,n),this.processCss(s,c,u,n),"PRE"==c&&(u.insidePRE="true");for(var l=s.firstChild,d=void 0;l;l=d)d=l.nextSibling,this.processNode(l,u,n)}},e.prototype.processCss=function(e,t,n,r){var o=this,i=e.getAttributeNode("style");if(i){var a=i.value.split(";"),s=a.filter(function(t){var i;if(!t||""==t.trim()||2!=(i=t.split(":")).length)return!1;var a=i[0].trim().toLowerCase(),s=i[1].trim().toLowerCase(),c=o.styleCallbacks[a],u=null!=n[a],l=(!c||c(s,e,r))&&"inherit"!=s&&s.indexOf("expression")<0&&"-"!=a.substr(0,1)&&o.defaultStyleValues[a]!=s&&(u&&s!=n[a]||!u&&"initial"!=s&&"normal"!=s);return l&&u&&(n[a]=s),l&&(o.allowPreserveWhiteSpace||"white-space"!=a)});a.length!=s.length&&(s.length>0?e.setAttribute("style",s.map(function(e){return e.trim()}).join("; ")):e.removeAttribute("style"))}},e.prototype.processAttributes=function(e,t){for(var n=e.attributes.length-1;n>=0;n--){var r=e.attributes[n],o=r.name.toLowerCase().trim(),i=r.value,a=this.attributeCallbacks[o];a?i=a(i,e,t):this.allowedAttributes.indexOf(o)<0&&(i=null),null==i||i.toLowerCase().indexOf("script:")>=0?e.removeAttribute(o):r.value=i}},e.prototype.allowElement=function(e,t,n){var r=this.elementCallbacks[t];return r?r(e,n):this.allowedTags.indexOf(t)>=0||t.indexOf(":")>0},e}();function c(e){return[].slice.call(e)}t.default=s},3860:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3667),o="BODY,H1,H2,H3,H4,H5,H6,FORM,P,BR,NOBR,HR,ACRONYM,ABBR,ADDRESS,B,BDI,BDO,BIG,BLOCKQUOTE,CENTER,CITE,CODE,DEL,DFN,EM,FONT,I,INS,KBD,MARK,METER,PRE,PROGRESS,Q,RP,RT,RUBY,S,SAMP,SMALL,STRIKE,STRONG,SUB,SUP,TEMPLATE,TIME,TT,U,VAR,WBR,XMP,INPUT,TEXTAREA,BUTTON,SELECT,OPTGROUP,OPTION,LABEL,FIELDSET,LEGEND,DATALIST,OUTPUT,IMG,MAP,AREA,CANVAS,FIGCAPTION,FIGURE,PICTURE,A,NAV,UL,OL,LI,DIR,UL,DL,DT,DD,MENU,MENUITEM,TABLE,CAPTION,TH,TR,TD,THEAD,TBODY,TFOOT,COL,COLGROUP,DIV,SPAN,HEADER,FOOTER,MAIN,SECTION,ARTICLE,ASIDE,DETAILS,DIALOG,SUMMARY,DATA".split(","),i="accept,align,alt,checked,cite,color,cols,colspan,contextmenu,coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,value,width,wrap".split(","),a={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","text-decoration":"none","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none"};function s(){return null}function c(e,t){var n=t.tagName;return!("LI"==n||"DIV"==n)}function u(e){return e.filter(function(e,t,n){return n.indexOf(e)==t})}t.getAllowedTags=function(e){return u(o.concat(e||[])).map(function(e){return e.toUpperCase()})},t.getAllowedAttributes=function(e){return u(i.concat(e||[])).map(function(e){return e.toLocaleLowerCase()})},t.getDefaultStyleValues=function(e){var t=r.default(a);return e&&Object.keys(e).forEach(function(n){var r=e[n];null!=r?t[n]=r:delete t[n]}),t},t.getStyleCallbacks=function(e){var t=r.default(e);return t.position=t.position||s,t.width=t.width||c,t}},3863:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(5),o=/^http(s)?:\/\/\w{3}prodprv\.www\.office\.com/,i=/^(http(s)?:\/\/)?www\..{3,9}\.prague\.office-int\.com\/loader\/.*/;function a(e){return Object(r.d)("cmp-pragueAnyLink")||o.test(e)||i.test(e)}},3866:function(e,t,n){"use strict";n.d(t,"b",function(){return o});var r=n(1),o=Object(r.createStore)("CLPUserLabels",{userLabels:[],learnMoreUrl:""});t.a=o()},388:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.createStore)("headerToastNotificationViewState",{notificationViewStates:[]})()},3880:function(e,t,n){"use strict";var r=n(5);t.a=function(e){if(e){var t=e.shouldEncryptMessageAsSmime,n=e.shouldSignMessageAsSmime;return Object(r.d)("cmp-smime")&&(t||n)}return!1}},3905:function(e,t,n){"use strict";n.d(t,"d",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"c",function(){return m}),n.d(t,"b",function(){return g}),n.d(t,"e",function(){return v}),n.d(t,"f",function(){return h});var r,o,i=n(4076),a=n(292),s=n.n(a),c=n(3538),u=n(4141),l=n(27),d=n(5);n(3792);function f(){return r}function p(){void 0===r&&(r="Store"+OSF.OUtil.generateConversationId());var e=Object(c.s)(),t=r+"|"+window.location.href.split("?")[0],n=OSF.OUtil.addXdmInfoAsHash(e.InClientStoreUrl,t);n=i.a(n,"client","WAC_Outlook");var a=Date.now();return n=i.a(n,"cv","16.2130.0.9999"),n=i.a(n,"ui",Object(l.g)()),n=i.a(n,"rs",Object(l.g)()),n=i.a(n,"timestamp",a.toString()),n=i.a(n,"ep",function(){if(o)return"il";return"ma"}()),n=i.a(n,"exchver",i.c()),n=i.a(n,"privateenabled",e.CustomExtensionsEnabled.toString()),n=i.a(n,"cb",i.d()),n=i.a(n,"ClientSessionId",i.e()),n=i.a(n,"userPuid","0"),Object(u.d)()&&(n=Object(d.d)("cal-addins")?i.a(n,"gates","Marketplace.Outlook.Pin.Addin.Options,Marketplace.Outlook.Pin.Addin.Calendar.Options"):i.a(n,"gates","Marketplace.Outlook.Pin.Addin.Options")),n}function m(){var e=OSF.OUtil.getUniqueId();return Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(e)}function g(){var e=s()();return e.headers.append("X-EWS-TargetVersion","2.80"),delete e.credentials,e}function v(e){return"string"==typeof e?e:["notresponded","notconsented","consented"][e]}var h=function(e){o=e}},3907:function(e,t,n){"use strict";t.a=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}},3908:function(e,t,n){"use strict";var r=n(2531),o=n(3778),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),Object(r.a)(a(e),function(t){return i.call(e,t)}))}:o.a;t.a=s},3909:function(e,t,n){"use strict";var r=n(879),o=n(1160),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.a=function(e,t){if(Object(r.a)(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Object(o.a)(e))||a.test(e)||!i.test(e)||null!=t&&e in Object(t)}},3910:function(e,t,n){"use strict";var r=n(7),o=n(4e3);t.a=Object(r.action)("updateContent")(function(e,t,n){e.content!=t&&(e.content=t,n||Object(o.a)(e,!0)),n&&(e.initialContent=t)})},3911:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.none=0]="none",e[e.refreshing=1]="refreshing",e[e.refreshFailed=2]="refreshFailed",e[e.refreshSucceeded=3]="refreshSucceeded",e[e.attachingAsACopy=4]="attachingAsACopy"}(r||(r={}))},3922:function(e,t,n){"use strict";function r(e){return e.localizedName?e.localizedName:e.name}var o=[{name:"Arial",family:"Arial,Helvetica,sans-serif"},{name:"Arial Black",family:"'Arial Black',Arial,sans-serif"},{name:"Calibri",family:"Calibri,Helvetica,sans-serif"},{name:"Calibri Light",family:"'Calibri Light','Helvetica Light',sans-serif"},{name:"Cambria",family:"Cambria,Georgia,serif"},{name:"Candara",family:"Candara,Optima,sans-serif"},{name:"Century Gothic",family:"'Century Gothic',sans-serif"},{name:"Comic Sans MS",family:"'Comic Sans MS',Chalkboard,cursive"},{name:"Consolas",family:"Consolas,Courier,monospace"},{name:"Constantia",family:"Constantia,'Hoefler Text',serif"},{name:"Corbel",family:"Corbel,Skia,sans-serif"},{name:"Courier New",family:"'Courier New',monospace"},{name:"Franklin Gothic Book",family:"'Franklin Gothic Book','Avenir Next Condensed',sans-serif"},{name:"Franklin Gothic Demi",family:"'Franklin Gothic Demi','Avenir Next Condensed Demi Bold',sans-serif"},{name:"Franklin Gothic Medium",family:"'Franklin Gothic Medium','Avenir Next Condensed Medium',sans-serif"},{name:"Garamond",family:"Garamond,Georgia,serif"},{name:"Georgia",family:"Georgia,serif"},{name:"Impact",family:"Impact,Charcoal,sans-serif"},{name:"Lucida Console",family:"'Lucida Console',Monaco,monospace"},{name:"Lucida Handwriting",family:"'Lucida Handwriting','Apple Chancery',cursive"},{name:"Lucida Sans Unicode",family:"'Lucida Sans Unicode','Lucida Grande',sans-serif"},{name:"Palatino Linotype",family:"'Palatino Linotype','Book Antiqua',Palatino,serif"},{name:"Segoe UI",family:"'Segoe UI','Helvetica Neue',sans-serif"},{name:"Sitka Heading",family:"'Sitka Heading',Cochin,serif"},{name:"Sitka Text",family:"'Sitka Text',Cochin,serif"},{name:"Tahoma",family:"Tahoma,Geneva,sans-serif"},{name:"Times",family:"Times,'Times New Roman',serif"},{name:"Times New Roman",family:"'Times New Roman',Times,serif"},{name:"Trebuchet MS",family:"'Trebuchet MS',Trebuchet,sans-serif"},{name:"TW Cen MT",family:"'TW Cen MT','Century Gothic',sans-serif"},{name:"Verdana",family:"Verdana,Geneva,sans-serif"},{name:"-",family:"-"},{name:"Microsoft YaHei",family:"'Microsoft YaHei','微软雅黑',STHeiti,sans-serif",localizedName:"微软雅黑"},{name:"SimHei",family:"SimHei,'黑体',STHeiti,sans-serif",localizedName:"黑体"},{name:"NSimSun",family:"NSimSun,'新宋体',SimSun,'宋体',SimSun-ExtB,'宋体-ExtB',STSong,serif",localizedName:"新宋体"},{name:"FangSong",family:"FangSong,'仿宋',STFangsong,serif",localizedName:"仿宋"},{name:"SimLi",family:"SimLi,'隶书','Baoli SC',serif",localizedName:"隶书"},{name:"KaiTi",family:"KaiTi,'楷体',STKaiti,serif",localizedName:"楷体"},{name:"-",family:"-"},{name:"Microsoft JhengHei",family:"'Microsoft JhengHei','微軟正黑體','Apple LiGothic',sans-serif",localizedName:"微軟正黑體"},{name:"PMingLiU",family:"PMingLiU,'新細明體',PMingLiU-ExtB,'新細明體-ExtB','Apple LiSung',serif",localizedName:"新細明體"},{name:"DFKai-SB",family:"DFKai-SB,'標楷體','BiauKai',serif",localizedName:"標楷體"},{name:"-",family:"-"},{name:"Meiryo",family:"Meiryo,'メイリオ','Hiragino Sans',sans-serif",localizedName:"メイリオ"},{name:"MS PGothic",family:"'MS PGothic','ＭＳ Ｐゴシック','MS Gothic','ＭＳ ゴシック','Hiragino Kaku Gothic ProN',sans-serif",localizedName:"ＭＳ Ｐゴシック"},{name:"MS PMincho",family:"'MS PMincho','ＭＳ Ｐ明朝','MS Mincho','ＭＳ 明朝','Hiragino Mincho ProN',serif",localizedName:"ＭＳ Ｐ明朝"},{name:"Yu Gothic",family:"'Yu Gothic','游ゴシック','YuGothic',sans-serif",localizedName:"游ゴシック"},{name:"Yu Mincho",family:"'Yu Mincho','游明朝','YuMincho',serif",localizedName:"游明朝"},{name:"-",family:"-"},{name:"Malgun Gothic",family:"'Malgun Gothic','맑은 고딕',AppleGothic,sans-serif",localizedName:"맑은 고딕"},{name:"Gulim",family:"Gulim,'굴림','Nanum Gothic',sans-serif",localizedName:"굴림"},{name:"Dotum",family:"Dotum,'돋움',AppleGothic,sans-serif",localizedName:"돋움"},{name:"Batang",family:"Batang,'바탕',AppleMyungjo,serif",localizedName:"바탕"},{name:"BatangChe",family:"BatangChe,'바탕체',AppleMyungjo,serif",localizedName:"바탕체"},{name:"Gungsuh",family:"Gungsuh,'궁서',GungSeo,serif",localizedName:"궁서"},{name:"-",family:"-"},{name:"Leelawadee UI",family:"'Leelawadee UI',Thonburi,sans-serif"},{name:"Angsana New",family:"'Angsana New','Leelawadee UI',Sathu,serif"},{name:"Cordia New",family:"'Cordia New','Leelawadee UI',Silom,sans-serif"},{name:"DaunPenh",family:"DaunPenh,'Leelawadee UI','Khmer MN',sans-serif"},{name:"-",family:"-"},{name:"Nirmala UI",family:"'Nirmala UI',sans-serif"},{name:"Gautami",family:"Gautami,'Nirmala UI','Telugu MN',sans-serif"},{name:"Iskoola Pota",family:"'Iskoola Pota','Nirmala UI','Sinhala MN',sans-serif"},{name:"Kalinga",family:"Kalinga,'Nirmala UI','Oriya MN',sans-serif"},{name:"Kartika",family:"Kartika,'Nirmala UI','Malayalam MN',sans-serif"},{name:"Latha",family:"Latha,'Nirmala UI','Tamil MN',sans-serif"},{name:"Mangal",family:"Mangal,'Nirmala UI','Devanagari Sangam MN',sans-serif"},{name:"Raavi",family:"Raavi,'Nirmala UI','Gurmukhi MN',sans-serif"},{name:"Shruti",family:"Shruti,'Nirmala UI','Gujarati Sangam MN',sans-serif"},{name:"Tunga",family:"Tunga,'Nirmala UI','Kannada MN',sans-serif"},{name:"Vrinda",family:"Vrinda,'Nirmala UI','Bangla MN',sans-serif"},{name:"-",family:"-"},{name:"Nyala",family:"Nyala,Kefa,sans-serif"},{name:"Sylfaen",family:"Sylfaen,Mshtakan,Menlo,serif"}];function i(e){for(var t=e.toUpperCase(),n=0;n<o.length;n++){var r=o[n];if(r.name.toUpperCase()==t||r.localizedName&&r.localizedName.toUpperCase()==t)return r.family}return null}var a="pt",s=[8,10,12,14,18,24,36],c=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],u=c.map(function(e){return e.toString()});function l(e){return"number"==typeof e&&e<=7?s[e-1]:e}function d(e){var t=l(e).toString();return t?t+a:t}n.d(t,"g",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"d",function(){return i}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"e",function(){return l}),n.d(t,"f",function(){return d})},3928:function(e,t,n){"use strict";var r=function(e,t){return null!=e&&t in Object(e)},o=n(4269);t.a=function(e,t){return null!=e&&Object(o.a)(e,t,r)}},3929:function(e,t,n){"use strict";var r=n(1133),o=n(1659),i=Object(o.a)(Object.keys,Object),a=Object.prototype.hasOwnProperty;t.a=function(e){if(!Object(r.a)(e))return i(e);var t=[];for(var n in Object(e))a.call(e,n)&&"constructor"!=n&&t.push(n);return t}},3932:function(e,t,n){"use strict";var r=n(741),o=n(274),i=Object(r.a)(o.a,"Set");t.a=i},3935:function(e,t,n){"use strict";var r=n(8),o=n(1),i={sharingLinks:new r.ObservableMap({})},a=Object(o.createStore)("sharingLinkStore",i);t.a=a},3936:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients}function o(e){return void 0!==e.length}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o})},397:function(e,t,n){"use strict";var r;!function(e){e[e.ChangePermissions=0]="ChangePermissions",e[e.CopyLink=1]="CopyLink",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.Preview=4]="Preview",e[e.SaveToCloud=5]="SaveToCloud",e[e.ViewInProvider=6]="ViewInProvider",e[e.ConvertClassicToCloudy=7]="ConvertClassicToCloudy",e[e.ConvertCloudyToClassic=8]="ConvertCloudyToClassic",e[e.ImportCalendarEventAttachment=9]="ImportCalendarEventAttachment",e[e.MoveAttachmentToInline=10]="MoveAttachmentToInline",e[e.RefreshLink=11]="RefreshLink",e[e.IgnoreExpiration=12]="IgnoreExpiration"}(r||(r={})),t.a=r},3996:function(e,t,n){"use strict";var r=n(3853);t.a=function(e,t,n){var o=null==e?void 0:Object(r.a)(e,t);return void 0===o?n:o}},3997:function(e,t,n){"use strict";var r=n(1632),o="Expected a function";function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(o);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=e.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(i.Cache||r.a),n}i.Cache=r.a,t.a=i},4000:function(e,t,n){"use strict";var r=n(7);t.a=Object(r.action)("setIsDirty")(function(e,t){e.isDirty=t})},4011:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var r=n(0),o=n(4138),i=n(4321);function a(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,Object(o.b)(e)];case 1:return t=r.sent(),(n=t).fromViewState=Object(i.a)(e.from,e.meetingRequestItem,e.referenceItemId,!0),n.publicFolderId=e.publicFolderId,[2,n]}})})}function s(e){return void 0!==e.publicFolderId}},4022:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(3),o=new r.c(function(){return Promise.all([n.e(38),n.e(189)]).then(n.bind(null,4755))}),i=new r.a(o,function(e){return e.closeExpressionPane})},4023:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a});var r=n(3),o=new r.c(function(){return Promise.all([n.e(481),n.e(38),n.e(188)]).then(n.bind(null,4752))}),i=new r.a(o,function(e){return e.showExpressionPane}),a=Object(r.d)(o,function(e){return e.ExpressionPane})},4026:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"j",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"i",function(){return u}),n.d(t,"h",function(){return l}),n.d(t,"e",function(){return d}),n.d(t,"d",function(){return f}),n.d(t,"g",function(){return p}),n.d(t,"f",function(){return m});var r=n(3),o=(n(3661),n(1017));n.d(t,"a",function(){return o.a});var i=new r.c(function(){return n.e(251).then(n.bind(null,4754))}),a=new r.a(i,function(e){return e.clearInlineImageStore}),s=new r.b(i,function(e){return e.tryCreateDataURIFromImage}),c=new r.b(i,function(e){return e.cacheInlineImage}),u=new r.b(i,function(e){return e.logImageUpload}),l=new r.b(i,function(e){return e.logImageLoadError}),d=new r.b(i,function(e){return e.loadFromAttachmentServiceUrl}),f=new r.b(i,function(e){return e.loadFromAttachment}),p=new r.b(i,function(e){return e.loadFromProxy}),m=new r.b(i,function(e){return e.loadFromImageTag})},4030:function(e,t,n){"use strict";function r(){return{visibleItemCount:0,formatViewState:{fontName:"",fontSize:"",isBold:!1,isItalic:!1,isUnderline:!1,backgroundColor:"",textColor:"",isBullet:!1,isNumbering:!1,isStrikeThrough:!1,isSubscript:!1,isSuperscript:!1,isBlockQuote:!1,canUnlink:!1,canAddImageAltText:!1,canUndo:!1,canRedo:!1,formatPainterFormat:null},isContextualFormatBarShown:!1,contextualFormatBarLeft:0,contextualFormatBarTop:0}}n.d(t,"a",function(){return r})},4034:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return s}),n.d(t,"a",function(){return c});var r=n(0),o=n(746);function i(e){return Object(o.a)().taskPanes.get(e)}function a(e){return function(e){var t,n,i=Object(o.a)();try{for(var a=r.__values(i.taskPanes.values()),s=a.next();!s.done;s=a.next()){var c=s.value;if(e(c))return c}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return null}(function(t){return t.controlId===e})}function s(e){var t,n;try{for(var o=r.__values(["Persistent","NonPersistent"]),a=o.next();!a.done;a=o.next()){var s=a.value,c=i(s);if(c&&c.controlId===e)return s}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return null}function c(e){return"Persistent"===e?"NonPersistent":"Persistent"}},4038:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},4039:function(e,t,n){"use strict";var r=n(4040),o=n(3908),i=n(3566);t.a=function(e){return Object(r.a)(e,i.a,o.a)}},4040:function(e,t,n){"use strict";var r=n(3739),o=n(879);t.a=function(e,t,n){var i=t(e);return Object(o.a)(e)?i:Object(r.a)(i,n(e))}},4041:function(e,t,n){"use strict";var r=n(7);t.a=Object(r.action)("setIsContextualFormatBarShown")(function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=0),e.isContextualFormatBarShown=t,e.contextualFormatBarLeft=n,e.contextualFormatBarTop=r})},4045:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return a});var r="onCloseInlineCompose",o="UpdateInternetMessageId",i="closeCompose",a="openCompose"},4064:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(4520),o=n(4518);function i(e){var t=Object(r.a)(e);return t&&t.fromViewState&&t.fromViewState.from&&t.fromViewState.from.email?t.fromViewState.from.email.EmailAddress:Object(o.a)().email.EmailAddress}},4070:function(e,t,n){"use strict";var r,o;function i(e,t){var n,r;e&&e((n=t.EventResponseCode,(r={}).Error=n,r))}function a(e,t){(function(e){return void 0!==e.invokeHandlerIfPreviousOnTriggerFailed})(e)&&e.invokeHandlerIfPreviousOnTriggerFailed(t)}!function(e){e[e.DISPLAY_DIALOG_DISPID=10]="DISPLAY_DIALOG_DISPID",e[e.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID=11]="DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID",e[e.ITEM_CHANGED_EVENT_DISPID=46]="ITEM_CHANGED_EVENT_DISPID",e[e.RECIPIENTS_CHANGED_EVENT_DISPID=47]="RECIPIENTS_CHANGED_EVENT_DISPID",e[e.APPOINTMENT_TIME_CHANGED_EVENT_DISPID=48]="APPOINTMENT_TIME_CHANGED_EVENT_DISPID",e[e.RECURRENCE_CHANGED_EVENT=49]="RECURRENCE_CHANGED_EVENT",e[e.ATTACHMENTS_CHANGED_EVENT_DISPID=50]="ATTACHMENTS_CHANGED_EVENT_DISPID",e[e.LOCATIONS_CHANGED_EVENT=51]="LOCATIONS_CHANGED_EVENT"}(r||(r={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.INTERNAL_ERROR=5001]="INTERNAL_ERROR",e[e.URL_NOT_IN_APP_DOMAINS=12004]="URL_NOT_IN_APP_DOMAINS",e[e.WEB_DIALOG_CLOSED=12006]="WEB_DIALOG_CLOSED",e[e.DIALOG_ALREADY_OPEN=12007]="DIALOG_ALREADY_OPEN"}(o||(o={}));var s=o,c="DialogApiEventError",u="ApiEventError";function l(e,t,n){return{EventResponseCode:e,ErrorClassification:t,ErrorDetails:n}}function d(){return l(s.SUCCESS)}function f(e){return e.EventResponseCode===s.SUCCESS}function p(e,t){return d()}function m(e){return d()}function g(e,t){return d()}function v(e){return e}function h(e){return[JSON.stringify(e)]}var y={};function b(e,t){return y[e]&&y[e][t]?y[e][t]:null}function _(e){delete y[e]}function S(e,t){return!!b(e,t)}var C=n(18),O=n(3538),I=n(15);function A(e,t,n,r,o){var a=U(e),c=a.onTrigger(n,t);f(c)&&(c=function(e,t,n,r){var o=b(e,t);if(!o)return l(s.INTERNAL_ERROR,u,"HandlerNotRegistered");var i=n.formatArgsForHandler(r);return o(i),d()}(t,e,a,n)),i(r,c);var p=Object(O.n)(t),m=c.EventResponseCode;Object(C.o)("ExecuteEvent",{dispId:e,Id:p.extension.Id,DisplayName:p.extension.DisplayName,owa_1:Object(I.b)(),owa_2:Object(O.z)(o),extPoint:Object(O.r)(t),owa_4:p.extension.Type,EventResponseCode:m})}var T=n(94);function E(e,t){if(Object(O.I)())return l(s.DIALOG_ALREADY_OPEN,c,s[s.DIALOG_ALREADY_OPEN]);if(!function(e,t){if(t&&1==t.displayInIframe){var n=Object(O.n)(e).extension.AppDomains;return function(e,t){return Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(e,t)}(n,t.url)}return!0}(e,t))return l(s.URL_NOT_IN_APP_DOMAINS,c,s[s.URL_NOT_IN_APP_DOMAINS]);var n=function(e,t,n){var r=Object(O.x)(e);return t&&1==t.displayInIframe?{controlId:Object(T.a)(),dialogType:1,url:t.url,heightInPercentage:t.height,widthInPercentage:t.width,parentControlId:e,isOpen:n,hostItemIndex:r}:Object(O.P)(e)?{controlId:Object(T.a)(),dialogType:2,parentControlId:e,isOpen:n,hostItemIndex:r}:null}(e,t,!0);return Object(O.R)(n),d()}function x(e){return Object(O.R)(null),A(r.DISPLAY_DIALOG_DISPID,e,null),d()}function P(e,t){return d()}function M(e){return function(e){return null!=e&&void 0!==e.messageToParent}(e)?function(e){var t=e.messageToParent;return{messageType:"0",messageContent:t}}(e):{messageType:s.WEB_DIALOG_CLOSED}}var w=!1,R=null;function k(e,t){return function(e,t){S(t,r.ITEM_CHANGED_EVENT_DISPID)||(w=!0,R={controlId:t,args:e},Object(C.o)("ExtTriggerUnregisteredItemChangedEvent"))}(e,t),d()}function D(e){w&&R.controlId===e&&A(r.ITEM_CHANGED_EVENT_DISPID,e,R.args),w=!1,R=null}function j(e){return[JSON.stringify(e)]}function N(e){return[JSON.stringify(e)]}function F(e){var t={recurrence:JSON.stringify(e.recurrence)};return[JSON.stringify(t)]}function L(e){return[JSON.stringify(e)]}function U(e){switch(e){case r.DISPLAY_DIALOG_DISPID:case r.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID:return{register:E,unregister:x,onTrigger:P,formatArgsForHandler:M};case r.ITEM_CHANGED_EVENT_DISPID:return{register:p,unregister:m,onTrigger:k,formatArgsForHandler:v,invokeHandlerIfPreviousOnTriggerFailed:D};case r.APPOINTMENT_TIME_CHANGED_EVENT_DISPID:return{register:p,unregister:m,onTrigger:g,formatArgsForHandler:h};case r.RECIPIENTS_CHANGED_EVENT_DISPID:return{register:p,unregister:m,onTrigger:g,formatArgsForHandler:N};case r.RECURRENCE_CHANGED_EVENT:return{register:p,unregister:m,onTrigger:g,formatArgsForHandler:F};case r.LOCATIONS_CHANGED_EVENT:return{register:p,unregister:m,onTrigger:g,formatArgsForHandler:j};case r.ATTACHMENTS_CHANGED_EVENT_DISPID:return{register:p,unregister:m,onTrigger:g,formatArgsForHandler:L};default:throw new Error("ApiEvent not implemented")}}function B(e,t,n){if(Object(O.P)(t.controlId)&&function(e){switch(e){case r.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID:case r.DISPLAY_DIALOG_DISPID:return!1;case r.APPOINTMENT_TIME_CHANGED_EVENT_DISPID:case r.ITEM_CHANGED_EVENT_DISPID:case r.RECIPIENTS_CHANGED_EVENT_DISPID:case r.RECURRENCE_CHANGED_EVENT:case r.LOCATIONS_CHANGED_EVENT:case r.ATTACHMENTS_CHANGED_EVENT_DISPID:return!0}}(t.eventDispId))i(n,d());else{var o=function(e){return e.targetId?JSON.parse(e.targetId):null}(t),c=U(t.eventDispId),p=c.register(t.controlId,o);f(p)&&(p=function(e,t,n){if(S(e,t))return l(s.INTERNAL_ERROR,u,"ControlAlreadyRegistered");return function(e,t,n){y[e]||(y[e]={}),y[e][t]=n}(e,t,n),d()}(t.controlId,t.eventDispId,e)),i(n,p),a(c,t.controlId)}}function H(e,t){var n=U(e.eventDispId).unregister(e.controlId);f(n)&&(n=function(e,t){if(!S(e,t))return l(s.INTERNAL_ERROR,u,"ControlNotRegistered");return function(e,t){y[e]&&y[e][t]&&delete y[e][t]}(e,t),d()}(e.controlId,e.eventDispId)),i(t,n)}function V(e,t,n){var r=Object(O.o)(e),o=!1,i=null;r.forEach(function(r){S(r,t)&&(o||(o=!0,i=n()),A(t,r,i,null,e))})}var W=n(3620),G=n(3548);function z(e){var t=Object(O.q)(e),n=Object(W.n)(t);if(null!=n&&n.mode===G.a.AppointmentOrganizer){var o=n;V(t,r.APPOINTMENT_TIME_CHANGED_EVENT_DISPID,function(){return{start:o.getStartTime(),end:o.getEndTime()}})}}var q=n(98);function K(e,t,n){var o=Object(O.q)(e),i=Object(W.n)(o);if(null!=i&&(i.mode===G.a.AppointmentOrganizer||i.mode===G.a.MessageCompose)){var a=null;switch(t){case W.a.Added:a="added";break;case W.a.Deleted:a="removed";break;default:Object(q.a)(t)}var s={attachmentStatus:a,attachmentDetails:n};V(o,r.ATTACHMENTS_CHANGED_EVENT_DISPID,function(){return s})}}function X(e,t){var n=Object(O.q)(e),o=Object(W.n)(n);if(null!=o&&(o.mode===G.a.AppointmentOrganizer||o.mode===G.a.MessageCompose)){var i=null;if(o.mode==G.a.MessageCompose)switch(i={to:!1,cc:!1,bcc:!1},t){case W.c.To:i.to=!0;break;case W.c.Cc:i.cc=!0;break;case W.c.Bcc:i.bcc=!0}else if(o.mode===G.a.AppointmentOrganizer)switch(i={requiredAttendees:!1,optionalAttendees:!1,resources:!1},t){case W.c.RequiredAttendees:i.requiredAttendees=!0;break;case W.c.OptionalAttendees:i.optionalAttendees=!0;break;case W.c.Resources:i.resources=!0}V(n,r.RECIPIENTS_CHANGED_EVENT_DISPID,function(){return i})}}var J=n(4686);function Q(e,t){var n=Object(O.q)(e),o=Object(W.n)(n);if(null!=o&&o.mode===G.a.AppointmentOrganizer){var i=Object(J.a)({recurrenceType:t,startTime:o.getStartTime(),endTime:o.getEndTime(),timeZone:o.getTimeZone()});V(n,r.RECURRENCE_CHANGED_EVENT,function(){return{recurrence:i}})}}function Y(e,t){var n=Object(O.q)(e),o=Object(W.n)(n);if(null!=o&&o.mode===G.a.AppointmentOrganizer){var i=t.map(W.h);V(n,r.LOCATIONS_CHANGED_EVENT,function(){return{enhancedLocations:i}})}}n.d(t,"c",function(){return B}),n.d(t,"j",function(){return H}),n.d(t,"d",function(){return A}),n.d(t,"b",function(){return _}),n.d(t,"e",function(){return z}),n.d(t,"f",function(){return K}),n.d(t,"h",function(){return X}),n.d(t,"i",function(){return Q}),n.d(t,"g",function(){return Y}),n.d(t,"a",function(){return r})},4071:function(e,t,n){"use strict";var r=2;var o=function(){function e(){var e=this;this.scrollListeners=[],this.scrollContainerChangedListeners=[],this.cachedElementPosition=NaN,this.onScroll=function(){e.scrollListeners.forEach(function(e){return e()})}}return e.prototype.setScrollContainer=function(e){var t=this;this.scrollContainer&&this.scrollContainer.removeEventListener("scroll",this.onScroll),this.scrollContainer=e,this.scrollContainerChangedListeners.forEach(function(e){return e(t.scrollContainer)}),this.scrollContainer&&this.scrollContainer.addEventListener("scroll",this.onScroll)},e.prototype.addScrollEventListener=function(e){this.scrollListeners.indexOf(e)<0&&this.scrollListeners.push(e)},e.prototype.removeScrollEventListener=function(e){var t=this.scrollListeners.indexOf(e);t>=0&&this.scrollListeners.splice(t,1)},e.prototype.addScrollContainerChangedListener=function(e){this.scrollContainerChangedListeners.indexOf(e)<0&&this.scrollContainerChangedListeners.push(e)},e.prototype.removeScrollContainerChangedListener=function(e){var t=this.scrollContainerChangedListeners.indexOf(e);t>=0&&this.scrollContainerChangedListeners.splice(t,1)},e.prototype.getScrollContainer=function(){return this.scrollContainer},e.prototype.saveElementPosition=function(e){e&&this.scrollContainer?this.cachedElementPosition=e.offsetTop-this.scrollContainer.scrollTop:this.cachedElementPosition=NaN},e.prototype.restoreElementPosition=function(e){e&&this.scrollContainer&&!isNaN(this.cachedElementPosition)&&"number"==typeof this.cachedElementPosition&&(this.scrollContainer.scrollTop=e.offsetTop-this.cachedElementPosition,this.cachedElementPosition=NaN)},e}(),i=function(){function e(e){this.viewState=e,this.scrollAdapter=new o}return e.prototype.initialize=function(e){this.editor=e,this.scrollAdapter.addScrollContainerChangedListener(this.onScrollContainerChanged)},e.prototype.onPluginEvent=function(e){(2==e.eventType||1==e.eventType||6==e.eventType&&"SetContent"!=e.source)&&this.viewState.isBottomDocking&&this.scrollCursorIntoView()},e.prototype.scrollCursorIntoView=function(){var e=this;this.scrollThrottlingJob||(this.scrollThrottlingJob=window.setTimeout(function(){e.scrollThrottlingJob=0;var t=e.scrollAdapter.getScrollContainer();if(t&&e.editor){var n=t.getBoundingClientRect(),o=e.editor.getCursorRect();n&&o&&(t.scrollTop=function(e,t,n,o,i,a,s){void 0===s&&(s=r);var c=a-(o-e.bottomDockingHeight-e.scrollBarHeight)+s;return e.isBottomDocking&&c>0&&(t+=c),t}(e.viewState,t.scrollTop,n.top,n.bottom,o.top,o.bottom))}},100))},e.prototype.setDockingTriggerPart=function(e){this.dockingTriggerPart=e},e.prototype.setInitialVisiblePart=function(e){this.initialVisiblePart=e,this.tryScrollIntoView()},e.prototype.getScrollAdapter=function(){return this.scrollAdapter},e.prototype.dispose=function(){this.scrollAdapter.removeScrollContainerChangedListener(this.onScrollContainerChanged),this.editor=null},e.prototype.onContentSizeChanged=function(e,t){void 0===t&&(t=null);var n=this.scrollAdapter.getScrollContainer();if(n&&0!=e){var r=0,o=n.scrollHeight-n.clientHeight,i=n.scrollTop+e;if(i=Math.max(r,i),i=Math.min(i,o),t&&(r=Math.max(r,t.offsetTop+t.clientHeight-n.clientHeight),o=Math.min(o,t.offsetTop)),i!=n.scrollTop&&i>=r&&i<=o)n.scrollTop=i;else{var a=n.scrollTop;a<r?n.scrollTop=r:a>o&&(n.scrollTop=o)}}},e.prototype.getVisibleAreaInfo=function(){var e,t=this.scrollAdapter.getScrollContainer(),n=0;if(t&&t.scrollHeight!==t.clientHeight&&this.dockingTriggerPart){var r=t.scrollTop,o=t.clientHeight,i=this.dockingTriggerPart.offsetTop,a=this.dockingTriggerPart.offsetHeight;n=this.viewState.isBottomDocking?i+a-r-o+this.viewState.bottomDockingHeight:0}return this.dockingTriggerPart&&(e=this.dockingTriggerPart.offsetHeight-n),{top:0,bottom:n,visibleBodyHeight:e,visibleBodyWidth:this.viewState.dockingWidth||(this.dockingTriggerPart?this.dockingTriggerPart.offsetWidth:0)}},e.prototype.tryScrollIntoView=function(){var e=this.scrollAdapter.getScrollContainer();if(this.editor&&e&&this.initialVisiblePart){var t=e.getBoundingClientRect(),n=this.initialVisiblePart.getBoundingClientRect();n.bottom>t.bottom&&(e.scrollTop+=n.bottom-t.bottom),n.top<t.top&&(e.scrollTop+=n.top-t.top)}},e}(),a=n(7),s=Object(a.action)("updateDocking")(function(e,t,n,r,o,i){e.isBottomDocking=t,e.dockingWidth=o,e.scrollLeft=n,e.scrollBarHeight=r,e.bottomDockingBottom=i}),c=Object(a.action)("updateStickyDocking")(function(e,t){e.isBottomDocking=t});var u=Object(a.action)("updateDockingHeight")(function(e,t){e.bottomDockingHeight=t}),l=n(0),d=n(1462),f=function(e){function t(t){var n=e.call(this,t)||this;return n.onScrollContainerChanged=function(e){e?n.tryStartObserver():n.tryStopObserver()},n.calculateDockingWithThrottling=function(){n.dockingThrottlingJob||(n.dockingThrottlingJob=window.requestAnimationFrame(function(){n.dockingThrottlingJob=0,n.editor&&n.onCalculateDocking()}))},n.onCalculateDocking=function(){var e,t,r,o,i,a,c,u,l,d,f,p=n.scrollAdapter.getScrollContainer();if(n.viewState&&p&&n.dockingTriggerPart){var m=n.dockingTriggerPart.offsetWidth;e=n.viewState,t=p.scrollTop,r=p.scrollLeft,o=p.clientHeight,i=p.offsetHeight,a=n.dockingTriggerPart.offsetTop,c=n.dockingTriggerPart.offsetHeight,u=m,l=a+c>=t+o-e.bottomDockingHeight,d=Math.min(t+o-a-e.bottomDockingHeight-e.minBodyHeight,0),f=i-o,l==e.isBottomDocking&&u==e.dockingWidth&&r==e.scrollLeft&&f==e.scrollBarHeight&&d==e.bottomDockingBottom||s(e,l,r,f,u,d)}},"function"==typeof MutationObserver&&(n.observer=new MutationObserver(n.calculateDockingWithThrottling)),n}return l.__extends(t,e),t.prototype.getName=function(){return"Docking"},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.scrollAdapter.addScrollEventListener(this.calculateDockingWithThrottling),this.tryStartObserver(),d.a.importAndExecute(this.calculateDockingWithThrottling)},t.prototype.dispose=function(){d.c.importAndExecute(this.calculateDockingWithThrottling),this.tryStopObserver(),this.scrollAdapter.removeScrollEventListener(this.calculateDockingWithThrottling),this.dockingThrottlingJob&&(window.cancelAnimationFrame(this.dockingThrottlingJob),this.dockingThrottlingJob=0),e.prototype.dispose.call(this)},t.prototype.tryStartObserver=function(){var e=this.scrollAdapter.getScrollContainer();this.observer&&!this.observerConnected&&this.editor&&e&&(this.observer.observe(e,{childList:!0,attributes:!0,subtree:!0}),this.tryScrollIntoView(),this.calculateDockingWithThrottling(),this.observerConnected=!0)},t.prototype.tryStopObserver=function(){this.observer&&this.observerConnected&&(this.observer.disconnect(),this.observerConnected=!1)},t}(i),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onScrollContainerChanged=function(e){t.updateIntersectionObserver()},t}return l.__extends(t,e),t.prototype.getName=function(){return"StickyDocking"},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.scrolledIntoView=!1,this.updateIntersectionObserver()},t.prototype.dispose=function(){this.updateIntersectionObserver(),e.prototype.dispose.call(this)},t.prototype.setStickyBottomBorder=function(e){this.stickyBottomBorder=e,this.updateIntersectionObserver()},t.prototype.setInitialVisiblePart=function(t){e.prototype.setInitialVisiblePart.call(this,t),this.updateIntersectionObserver()},t.prototype.updateIntersectionObserver=function(){var e=this,t=this.scrollAdapter.getScrollContainer();this.stickyBottomBorder&&this.editor&&t?this.intersectionObserver||(this.intersectionObserver=new IntersectionObserver(function(t){if(t[0]){var n=1!=t[0].intersectionRatio;c(e.viewState,n),n&&!e.scrolledIntoView&&e.tryScrollIntoView(),e.scrolledIntoView=!0}},{rootMargin:"0px",threshold:[1],root:t}),this.intersectionObserver.observe(this.stickyBottomBorder)):this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null)},t}(i);function m(e){return e.useStickyDocking?new p(e):new f(e)}var g=48,v=49,h=56;function y(e,t){return(t?v:h)+(e?g:0)}var b=100;function _(e,t){return{isBottomDocking:!1,bottomDockingHeight:y(e,t),minBodyHeight:b,scrollLeft:0,scrollBarHeight:0,dockingWidth:0,bottomDockingBottom:0,useStickyDocking:C()}}var S=null;function C(){return S||(S={value:O("position","sticky")&&"function"==typeof IntersectionObserver}),S.value}function O(e,t){var n=document.createElement("div");return n.style[e]=t,n.style[e]===t}n.d(t,"d",function(){return u}),n.d(t,"a",function(){return m}),n.d(t,"b",function(){return _}),n.d(t,"c",function(){return y})},4072:function(e,t,n){"use strict";var r=n(2555),o=n(3853);var i=function(e){return function(t){return Object(o.a)(t,e)}},a=n(3909),s=n(3633);t.a=function(e){return Object(a.a)(e)?Object(r.a)(Object(s.a)(e)):i(e)}},4076:function(e,t,n){"use strict";n.d(t,"d",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"e",function(){return f}),n.d(t,"f",function(){return p}),n.d(t,"b",function(){return m}),n.d(t,"g",function(){return g});var r,o=n(94),i=n(9),a=n(3538),s=n(4933),c=n(15);function u(){return"x"}function l(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");var r=e.split("#"),o=1==r.length?"":e.substr(e.indexOf("#"));return e=e.indexOf("?")>0?r[0]+"&"+t+"="+n+o:r[0]+"?"+t+"="+n+o}function d(){return Object(c.v)()}function f(){return null==r&&(r=Object(o.a)()),r}function p(){return Object(i.a)().UserOptions.TimeZone}function m(e){var t=encodeURIComponent(e),n=unescape(t);return btoa(n)}function g(){Object(a.W)(!0),Object(s.a)()}n(135)},4077:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a});var r=n(3),o=new r.c(function(){return Promise.all([n.e(483),n.e(206)]).then(n.bind(null,4906))}),i=new r.a(o,function(e){return e.mountAndShowFlexPane}),a=new r.a(o,function(e){return e.hideFlexPane})},4081:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.mutatorAction)("setWordToReplace",function(e,t){e.wordToReplace=t})},4084:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(2532),o=n.n(r),i=n(57),a=n.n(i),s=n(1913),c=n.n(s);function u(e,t){var n;return c()({Path:a()({FieldURI:e}),Item:o()((n={},n[e]=t,n))})}},4106:function(e){e.exports={a:"B4a"}},4107:function(e,t,n){"use strict";var r=n(741),o=n(274),i=Object(r.a)(o.a,"WeakMap");t.a=i},4113:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var r=n(0),o=n(9),i=/emoji_([0-9a-z]+(_[0-9a-z]+)?)-png/i,a=49;function s(e){var t,n;void 0===e&&(e=a);var s=Object(o.a)().UserOptions.MruEmojis,c=[];if(s&&s.length>0)try{for(var u=r.__values(s),l=u.next();!l.done;l=u.next()){var d=l.value.match(i);if(d&&d.length>=2&&(c.push(d[1].toLowerCase()),c.length>=e))break}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return c}},4115:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return c});var r=n(0),o=n(9),i=n(3922),a={fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000",bold:!1,italic:!1,underline:!1};function s(){var e=Object(o.a)().UserOptions;return e?c(e.ComposeFontName,e.ComposeFontSize,e.ComposeFontColor,e.ComposeFontFlags):a}function c(e,t,n,o){var s=r.__assign({},a),c=e?Object(i.d)(e):null;c&&(s.fontFamily=c);var u=t?Object(i.f)(t):null;return u&&(s.fontSize=u),n&&(s.textColor=n),o&&(s.bold=1==(1&o),s.italic=2==(2&o),s.underline=4==(4&o)),s}},4138:function(e,t,n){"use strict";var r=n(0),o=n(4246),i=n(4635);function a(e,t,n,r){return{selectionStart:-1,selectionEnd:-1,inputId:"subjectLine"+e}}var s=n(4321),c=n(2618),u=n(3731),l=n(4981),d=n(9);function f(){return Object(d.a)().UserOptions.AlwaysShowBcc}var p=n(2674),m=n(4898),g=n(8),v=n(787),h=n(4203),y=n(4913),b=n(45),_=n(4822),S=n(286),C=n(3856),O=n(4425),I=n(4071),A=n(4426),T=n(2291);function E(e){var t={queryString:"",wordBeforeCursor:"",isSuggesting:!1,isPopupShown:!1,findResultSet:[],selectedRecipientIndex:0,isSearching:!1,directorySearchType:T.a.None,atMentionTuples:{},mentionsAddedRecipients:[]};return e&&e.length>0&&e.forEach(function(e){var n=JSON.parse(e);if(n&&n.a&&n.b){var r=JSON.parse(n.a);r&&("MentionAddedRecipients"==n.b&&r instanceof Array?t.mentionsAddedRecipients=r:r.Mentioned&&(t.atMentionTuples[n.b]={EmailAddress:r.Mentioned}))}}),t}var x=n(4542),P=n(4030),M=n(4180),w=n(798),R=n(4639),k=n(4516);function D(e,t){var n=null;return n=Object(R.a)(e),(e&&!n.selectedLabel||!e&&!t)&&(n.selectedLabel=Object(k.a)()),{justificationSent:!1,originalCLPLabel:n&&n.selectedLabel?n.selectedLabel:null,selectedCLPLabel:n&&n.selectedLabel?n.selectedLabel:null,nonTenantLabelString:n&&n.nonTenantLabelString?n.nonTenantLabelString:""}}var j=n(4690),N=n(5248),F=n(4);var L=n(1633),U=n(56),B=n(4360);n.d(t,"c",function(){return V}),n.d(t,"a",function(){return W}),n.d(t,"b",function(){return G});var H=0;function V(){return(H++).toString()}function W(e){var t=e.operation,n=e.bodyType,r=e.itemId,u=e.subject,d=e.newContent,m=e.quotedBody,v=e.to,b=e.cc,C=e.bcc,T=e.referenceItemId,R=e.referenceItemDocumentId,k=e.conversationId,H=e.importance,W=e.alternateSignature,G=e.preferAsyncSend,z=e.from,q=e.pendingSocialActivityTags,K=e.IRMData,X=e.useSmartResponse,J=e.logTraceId,Q=e.isPopout,Y=e.explicitTextDirection,Z=e.isReadReceiptRequested,$=e.isDeliveryReceiptRequested,ee=e.meetingRequestItem,te=e.sensitivity,ne=e.smimeViewState,re=e.existingLabelString,oe=e.mailboxInfo,ie=void 0===e.isInlineCompose?!!k:e.isInlineCompose,ae=b&&b.length>0||(Object(U.a)()?f():!ie),se=C&&C.length>0||f(),ce="HTML"==n,ue=m||"",le=e.appendOnSend?e.appendOnSend:[],de=Object(p.a)(t)?Object(c.a)(n):W;de&&(ue=Object(i.a)(n,de,!0)+Object(o.a)(ue,n)),ue=(Object(o.a)(d,n)||"")+Object(o.a)(ue,n);var fe,pe=Object(_.a)(),me=Object(L.a)(pe,v),ge=V(),ve=Object(s.a)(z,ee,T),he=g.observable.object({content:ue,isDirty:!1,operation:t,itemId:r||null,bodyType:n,subject:u||"",attachmentWell:Object(h.a)(!1,!0,ge),referenceItemId:T,referenceItemDocumentId:R,importance:H||"Normal",fromViewState:ve,subjectViewState:a(ge),subjectPickerViewState:(fe={supportsSubjectPicker:0===t&&!u&&!d},{supportsSubjectPicker:fe.supportsSubjectPicker,isPickerOpened:fe.isPickerOpened,isLoadingConversation:fe.isLoadingConversation,showBackButton:fe.showBackButton,showSubjectPickerButton:fe.showSubjectPickerButton,isBackButtonHovered:fe.isBackButtonHovered,initialToRecipient:fe.initialToRecipient,nextFocusControl:fe.nextFocusControl,initialContent:fe.initialContent}),IRMData:K,policyTipsViewState:{inProgressPolicyMatch:{itemId:null,scanResultData:null,scanResultMetaData:null,subjectChecksum:0,contentChecksum:0,eventTrigger:null,policyMatchDetails:[],attachmentIds:[]},succeededPolicyMatch:{itemId:null,scanResultData:null,scanResultMetaData:null,subjectChecksum:0,contentChecksum:0,eventTrigger:null,policyMatchDetails:[],attachmentIds:[]},pendingPolicyMatch:{itemId:null,scanResultData:null,scanResultMetaData:null,subjectChecksum:0,contentChecksum:0,eventTrigger:null,policyMatchDetails:[],attachmentIds:[]},isRequestInProgress:!1,pendingRequests:!1,handlerDisabled:!1,isOverridden:!1,overrideJustification:null,isReportedFalsePositive:!1,complianceUrl:"",blockString:Object(F.a)(N.a),notifyString:Object(F.a)(N.b),overrideString:Object(F.a)(N.a)},meetingRequestItem:ee,internetHeaders:new g.ObservableMap,keysOfInternetHeadersToBeRemoved:[],appendOnSend:le,findPeopleFeedbackManager:pe,toRecipientWell:me,ccRecipientWell:ae?Object(L.a)(pe,b):null,bccRecipientWell:se?Object(L.a)(pe,C):null,isInlineCompose:ie,conversationId:k,lastSaveTimeStamp:null,isRibbonShown:ce,isSending:!1,isSavingSpinnerShown:!1,infoBarIds:[],showCompactRecipientWell:ie&&!ve.isFromShown,dropViewState:Object(S.a)(),isFocusWorkaroundDivShown:!0,showSendDiscardAsIcon:!1,lastFocusedControl:null,isPopout:Q,sendDisabled:!1,smimeViewState:ne||Object(B.b)(),composeFeedbackViewState:Object(y.b)(),quotedBody:null,useSmartResponse:ie||X,upgradeTimer:null,numberOfWaitingAttachments:0,emojiPicker:Object(A.a)(),docking:Object(I.b)(ce,ie),ribbon:Object(P.a)(),atMentions:E(q),pasteOption:Object(x.c)(),tableEdit:Object(M.c)(),accChecker:Object(O.a)(),isReadReceiptRequested:"boolean"==typeof Z&&Z,isDeliveryReceiptRequested:"boolean"==typeof $&&$,preferAsyncSend:G,asyncSendState:0,composeId:ge,logTraceId:J,explicitTextDirection:Y||null,sensitivity:te,preferredEditors:Object(j.c)(),isDarkMode:Object(l.a)(),clpViewState:D(re,T),isManuallySaved:!1,mailboxInfo:oe});return G&&w.i.import(),he}function G(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,o;return r.__generator(this,function(r){switch(r.label){case 0:return t=W(e),n=t,[4,v.j.import()];case 1:return n.attachmentWell=r.sent()(t.composeId,{attachments:e.attachments,mailboxInfo:Object(b.e)(),parentItemId:e.itemId,infoBarAddHandler:Object(u.a)(t),infoBarRemoveHandler:Object(u.c)(t)}),[4,C.c.import()];case 2:return o=r.sent()(!0),Object(m.a)(t,o),[2,t]}})})}},4139:function(e,t,n){"use strict";var r=n(3),o=n(4331);function i(e){return o.a.addinOptionSurfaceItems[e]}var a=n(1669),s=n(1960),c=n(2599),u=n(2164),l=n(1726),d=n(4332),f=n(2600),p=n(2601),m=n(4240),g=n(1967),v=n(4333),h=n(4334),y=n(2160),b=n(4335),_=n(1723),S=n(4155),C=n(4241),O=n(1955),I=n(1733),A=n(1734),T=n(4336),E=n(4263),x=n(4264),P=n(4337),M=n(4338),w=n(4265),R=n(4339),k=n(4340),D=n(4341),j=n(4401),N=n(4342),F=n(4106),L=n(4266),U=n(4),B=n(56);function H(e){switch(e){case"AddAttachment":return Object(U.a)(N.a);case"AddInlineImage":return Object(U.a)(L.a);case"AddEmoji":return Object(U.a)(j.a);case"ToggleRibbon":return Object(U.a)(D.a);case"SaveDraft":return Object(U.a)(k.a);case"InsertSignature":return Object(U.a)(R.a);case"ShowFrom":return Object(U.a)(w.a);case"SetImportance":return Object(U.a)(M.a);case"ShowMessageOptions":return Object(U.a)(P.a);case"SwitchBodyType":return Object(U.a)(x.a);case"SensitivityMenu":return Object(U.a)(E.a);case"ProtectMessage":return Object(U.a)(T.a);case"AccChecker":return Object(U.a)(F.a);case"ToggleDarkCompose":return Object(U.a)(j.n);default:return""}}function V(e){switch(e){case"LikeUnlike":return Object(U.a)(j.d);case"Reply":return Object(U.a)(A.a);case"ReplyAll":return Object(U.a)(I.a);case"Forward":return Object(U.a)(O.a);case"ReplyByMeeting":return Object(U.a)(j.f);case"ReportAbuse":return Object(U.a)(C.a);case"Popout":return Object(U.a)(S.a);case"Delete":return Object(U.a)(j.c);case"MarkReadUnread":return Object(U.a)(_.a);case"FlagUnflag":return Object(U.a)(b.a);case"AssignPolicy":return Object(U.a)(y.a);case"AddToSafeSenders":return Object(U.a)(j.b);case"MarkJunkNotJunk":return Object(U.a)(h.a);case"MarkAsPhishing":return Object(U.a)(j.e);case"Block":return Object(U.b)(Object(U.a)(v.a),"");case"CreateRule":return Object(U.a)(g.a);case"Print":return Object(U.a)(m.a);case"Translate":return Object(U.a)(p.a);case"ShowInImmersiveReader":return Object(U.a)(f.a);case"ViewMessageSource":return Object(B.a)()?Object(U.a)(j.h):Object(U.a)(j.g);case"ToggleDarkMode":return Object(U.a)(d.a);case"ReplyByIM":return Object(U.a)(j.l);case"ReplyAllByIM":return Object(U.a)(j.k);case"ToggleAmp":return Object(U.a)(j.m);default:return""}}function W(e){switch(e){case"None":return Object(U.a)(j.i);case"Delete":return Object(U.a)(l.a);case"Archive":return Object(U.a)(u.a);case"PinUnpin":return Object(U.a)(c.a);case"ReadUnread":return Object(U.a)(j.j);case"FlagUnflag":return Object(U.a)(s.a);case"Move":return Object(U.a)(a.a);default:return""}}var G=n(3820),z=n(4343),q=n(3777),K=n(5),X=n(266),J=n(9),Q=n(134);function Y(){var e=[{key:"Reply",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAll",hideInGroup:!1,hideInSxS:!1},{key:"Forward",hideInGroup:!1,hideInSxS:!1}];return Object(K.d)("rp-replyByMeeting")&&e.push({key:"-",hideInGroup:!1,hideInSxS:!1},{key:"ReplyByMeeting",hideInGroup:!0,hideInSxS:!0}),e.push({key:"-",hideInGroup:!1,hideInSxS:!1},{key:"Delete",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"MarkReadUnread",hideInGroup:!1,hideInSxS:!0},{key:"FlagUnflag",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(K.d)("fwk-skypeBusinessV2")&&e.push({key:"ReplyByIM",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAllByIM",hideInGroup:!0,hideInSxS:!1},{key:"-",hideInGroup:!0,hideInSxS:!1}),Object(J.a)().SessionSettings.IsShadowMailbox||e.push({key:"AddToSafeSenders",hideInGroup:!0,hideInSxS:!0},{key:"MarkJunkNotJunk",hideInGroup:!0,hideInSxS:!0},{key:"MarkAsPhishing",hideInGroup:!0,hideInSxS:!0},{key:"Block",hideInGroup:!0,hideInSxS:!0},{key:"ReportAbuse",hideInGroup:!Object(B.a)(),hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),!Object(B.a)()&&Object(K.d)("tri-retentionPolicies")&&e.push({key:"AssignPolicy",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),e.push({key:"CreateRule",hideInGroup:!0,hideInSxS:!0},{key:"Print",hideInGroup:!1,hideInSxS:!1}),Object(K.d)("rp-inlineTranslationManual")&&e.push({key:"Translate",hideInGroup:!0,hideInSxS:!0}),Object(Q.c)()&&e.push({key:"ToggleDarkMode",hideInGroup:!1,hideInSxS:!1}),Object(K.d)("rp-immersiveReader")&&e.push({key:"ShowInImmersiveReader",hideInGroup:!1,hideInSxS:!0}),e.push({key:"ViewMessageSource",hideInGroup:!1,hideInSxS:!0}),e.push({key:"Popout",hideInGroup:!1,hideInSxS:!0}),Object(K.d)("rp-like")&&!Object(B.a)()&&e.push({key:"LikeUnlike",hideInGroup:!1,hideInSxS:!0}),Object(K.d)("rp-amp")&&Object(B.a)()&&e.push({key:"ToggleAmp",hideInGroup:!1,hideInSxS:!0}),e}function Z(){var e=[{key:"AddAttachment",hideInGroup:!1},{key:"AddInlineImage",hideInGroup:!1}];return e.push({key:"AddEmoji",hideInGroup:!1}),Object(K.d)("cmp-dictation")&&e.push({key:"ToggleDictation",hideInGroup:!1}),e=e.concat([{key:"ToggleRibbon",hideInGroup:!1},{key:"SaveDraft",hideInGroup:!1},{key:"InsertSignature",hideInGroup:!1},{key:"ShowFrom",hideInGroup:!1},{key:"SetImportance",hideInGroup:!1},{key:"SwitchBodyType",hideInGroup:!1},{key:"AccChecker",hideInGroup:!1}]),Object(K.d)("cmp-clp")&&!Object(B.a)()&&e.push({key:"SensitivityMenu",hideInGroup:!1}),Object(q.a)()&&e.push({key:"ProtectMessage",hideInGroup:!1}),Object(z.a)()&&e.push({key:"ShowMessageOptions",hideInGroup:!1}),e}function $(e){return"Reply"==e||"ReplyAll"==e||"Forward"==e}function ee(e){return-1!==Object(X.c)(X.a.SurfaceActions).readSurfaceActions.indexOf(e)}var te=n(18);function ne(e,t,n,r){var o;r?o=r:(o="Pinned",n&&n.renderedInOverflow&&(o=n.isPinned?"Overflow":"NotPinned")),Object(te.o)(e?"CSACountComposeUserAction":"CSACountReadUserAction",[t,o])}function re(e){e.subMenuProps&&e.subMenuProps.items.forEach(function(e){e.renderedInOverflow=!0})}function oe(e){e.subMenuProps&&e.subMenuProps.items.forEach(function(e){e.renderedInOverflow=!1})}n.d(t,"j",function(){return ae}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return H}),n.d(t,"g",function(){return V}),n.d(t,"f",function(){return W}),n.d(t,"a",function(){return"-"}),n.d(t,"d",function(){return G.a}),n.d(t,"h",function(){return G.c}),n.d(t,"e",function(){return Z}),n.d(t,"i",function(){return Y}),n.d(t,"o",function(){return $}),n.d(t,"n",function(){return ee}),n.d(t,"k",function(){return ne}),n.d(t,"m",function(){return re}),n.d(t,"l",function(){return oe});var ie=new r.c(function(){return n.e(380).then(n.bind(null,11913))}),ae=new r.a(ie,function(e){return e.setAddinOptionSurfaceItems})},4141:function(e,t,n){"use strict";var r=n(5);function o(){return Object(r.d)("addin-inClientStoreEnabled")}function i(){return Object(r.d)("addin-inClientStorePinnableExperience")}function a(){return Object(r.d)("addin-persistentTaskPane")}function s(){return Object(r.d)("addin-complianceVerification")}n.d(t,"b",function(){return o}),n.d(t,"d",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return s})},4155:function(e){e.exports={a:"lVa"}},4164:function(e,t,n){"use strict";var r=n(4),o=n(4632),i=n(3670),a=n(4165),s=n(5245),c=n.n(s),u=n(56),l=n(3716),d=n(7),f=n(3829),p=n(4449),m=n(12),g=Object(d.action)("triggerPolicyTips")(function(e,t,n,r,i){var a=e.policyTipsViewState;if(!a.handlerDisabled&&!e.IRMData){var s,u=a.inProgressPolicyMatch,d=a.succeededPolicyMatch,p=a.pendingPolicyMatch;if(n||(n=y(e.subject)),r||(r=y(e.content)),i||(i=Object(o.a)(e)),a.isRequestInProgress)a.pendingRequests=!0,p.itemId=e.itemId,p.subjectChecksum=n,p.contentChecksum=r,p.eventTrigger=t,p.attachmentIds=i;else{if(a.pendingRequests=!1,u.itemId=e.itemId,u.subjectChecksum=n,u.contentChecksum=r,u.eventTrigger=t,u.attachmentIds=i,0==(s=u).subjectChecksum&&0==s.contentChecksum&&0==s.attachmentIds.length)return d.policyMatchDetails=[],d.subjectChecksum=0,d.contentChecksum=0,d.attachmentIds=[],void Object(l.a)(e,"dlpPolicyTips");(b(u,d)||function(e,t){if(e.attachmentIds.length!=t.attachmentIds.length)return!0;for(var n=0;n<e.attachmentIds.length;n++)if(null!=e.attachmentIds[n]&&null!=t.attachmentIds[n]&&e.attachmentIds[n].Id!=t.attachmentIds[n].Id)return!0;return!1}(u,d)||1==t)&&function(e){var t=e.policyTipsViewState,n=t.succeededPolicyMatch,r=t.inProgressPolicyMatch,o=e.itemId;if(o&&o.Id){var i={ItemId:o,ClientSupportsScanResultData:!0,ScanResultData:n.scanResultData,ScanResultMetadata:n.scanResultMetaData,BodyOrSubjectChanged:b(r,n),NeedToReclassify:!n.itemId,CustomizedStringsNeeded:!0,Recipients:Object(f.a)(e),EventTrigger:r.eventTrigger};e.policyTipsViewState.isRequestInProgress=!0,c()(i).then(function(t){!function(e,t,n,r){var o=t.policyTipsViewState,i=o.pendingPolicyMatch;o.isRequestInProgress=!1,o.pendingRequests&&i&&g(t,i.eventTrigger,i.subjectChecksum,i.contentChecksum,i.attachmentIds);0==e.EvaluationResult||1==e.OptimizationResult||2==e.EvaluationResult?n(t,e):r(t,e)}(t,e,v,h)})}}(e)}}});function v(e,t){var n,r=e.policyTipsViewState,o=r.succeededPolicyMatch,s=r.inProgressPolicyMatch;o.itemId=s.itemId,o.attachmentIds=s.attachmentIds,o.subjectChecksum=s.subjectChecksum,o.contentChecksum=s.contentChecksum,o.policyMatchDetails=t.Matches,t.ScanResultData&&(o.scanResultData=t.ScanResultData),t.ScanResultMetadata&&(o.scanResultMetaData=t.ScanResultMetadata),1==t.OptimizationResult&&(r.handlerDisabled=!0),function(e,t){if(t){var n=e.policyTipsViewState,r={complianceUrl:t.ComplianceURL,blockString:t.PolicyTipMessageBlockString,notifyString:t.PolicyTipMessageNotifyString,overrideString:t.PolicyTipMessageOverrideString};Object(a.a)(n,r,function(e,t){return t||e})}}(e,t.CustomizedStrings),n=e,Object(l.a)(n,["consumerDlpPolicyTips","enterpriseDlpPolicyTips"]),Object(p.a)(n.policyTipsViewState.succeededPolicyMatch)&&(Object(u.a)()?Object(i.a)(n,"consumerDlpPolicyTips"):Object(i.a)(n,"enterpriseDlpPolicyTips"))}function h(e,t){var n=e.policyTipsViewState;t?(m.c.warn(Object(r.b)("PolicyTips failed with EvaluationResult code of: {0}",t.EvaluationResult)+" Diagnostic: "+t.DiagnosticData),4!=t.EvaluationResult&&7!=t.EvaluationResult&&1!=t.EvaluationResult&&6!=t.EvaluationResult&&8!=t.EvaluationResult||(m.c.warn("Disabling further PolicyTips requests because of the failure"),n.handlerDisabled=!0)):(m.c.warn("PolicyTipsResponse is null (PolicyTipsRequest is timed out)"),n.handlerDisabled=!0),Object(l.a)(e,"dlpPolicyTips")}function y(e){var t=0;if(e)for(var n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}function b(e,t){return e.subjectChecksum!=t.subjectChecksum||e.contentChecksum!=t.contentChecksum}t.a=g},4165:function(e,t,n){"use strict";var r=n(1601),o=n(1602),i=n(3566),a=Object(o.a)(function(e,t,n,o){Object(r.a)(t,Object(i.a)(t),e,o)});t.a=a},4166:function(e,t,n){"use strict";var r=n(4167),o=n(4450),i=n(3547);t.a=function(e,t){return e&&e.length?Object(r.a)(e,Object(i.a)(t,2),o.a):void 0}},4167:function(e,t,n){"use strict";var r=n(1160);t.a=function(e,t,n){for(var o=-1,i=e.length;++o<i;){var a=e[o],s=t(a);if(null!=s&&(void 0===c?s==s&&!Object(r.a)(s):n(s,c)))var c=s,u=a}return u}},4168:function(e,t,n){"use strict";var r=n(4167),o=n(3547),i=n(4451);t.a=function(e,t){return e&&e.length?Object(r.a)(e,Object(o.a)(t,2),i.a):void 0}},4169:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(4299),o=n(1589),i="MailComposeSend";t.b={MailComposeReply:{name:"MailComposeReply",options:{isQos:!0},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeReplyAll:{name:"MailComposeReplyAll",options:{isQos:!0},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeForward:{name:"MailComposeForward",options:{isQos:!0},customData:function(e,t,n,r){return[t]},actionSource:function(e,t,n,r){return t},cosmosOnlyData:function(e,t,n,r){return e&&e.toString()}},MailComposeSendE2E:{name:"MailComposeSendE2E",customData:function(e){return{composeTraceId:e.logTraceId,operation:e.operation,isGroupScenario:Object(o.b)(e)}}},MailComposeSave:{name:"MailComposeSave"},MailComposeUpConvert:{name:"MailComposeUpConvert"},ComposeCommandDiscardCompose:{name:"ComposeCommandDiscardCompose",customData:function(e){return{composeTraceId:e.logTraceId,wasEmptyBody:e.initialContent===e.content,wasEmptySubject:""===e.subject}},options:{isCore:!0},cosmosOnlyData:function(e){return JSON.stringify({smartReplyExtractionId:Object(r.a)(e)})}},ComposeCommandShowFrom:{name:"ComposeCommandShowFrom"},ComposeCommandSetImportance:{name:"ComposeCommmandSetImportance",customData:function(e,t){return[t]}}}},4170:function(e,t,n){"use strict";n.d(t,"d",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"a",function(){return m}),n.d(t,"b",function(){return g});var r=n(0),o=n(4724),i=n(31),a=n(1300),s=n(9),c=n(56);function u(e){var t=Object(s.a)().SessionSettings,n=[],r=t.UserProxyAddresses;return t.NotManagedEmailAddresses&&(r=r.concat(t.NotManagedEmailAddresses)),r&&r.length>0&&r.forEach(function(t){e==t||v(t)||n.push(t)}),n}function l(e){var t,n=Object(i.t)(),r=n&&n.items;if(r&&e&&r.has(e.Id)&&(t=r.get(e.Id)),t){var o=d(t.ToRecipients,t.CcRecipients);if(o&&o!==f())return o}return null}function d(e,t){return function(e,t,n){for(var r=0;r<n.length;r++)if(h(n[r],e)||h(n[r],t))return n[r];return null}(e,t,g())||f()}function f(){var e=Object(s.a)(),t=Object(c.a)()?e.SessionSettings.DefaultFromAddress:e.UserOptions.SendAddressDefault;return Object(a.a)(t)?t:p()}function p(){return Object(s.a)().SessionSettings.UserEmailAddress}function m(e){var t=l(e);return{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:t||function(){var e=f(),t=p();if(t==e&&v(e)){var n=u(t);if(n&&n.length>0)return n[0]}return e}(),Name:Object(s.a)().SessionSettings.UserDisplayName}}function g(){var e,t,n=[],r=p();return v(r)||n.push(r),Object(c.a)()&&(n=n.concat(u(r))),e=n,(t=Object(s.a)().SessionSettings.ConnectedAccountInfos)&&t.length>0&&t.forEach(function(t){-1==e.lastIndexOf(t.EmailAddress)&&e.push(t.EmailAddress)}),n=e}function v(e){var t=!1;if(Object(c.a)()){var n=Object(s.a)();t=0==(e=e.toLowerCase()).indexOf("outlook_"+n.HexCID)||-1!=e.indexOf("@shadow.outlook.com")}return t}function h(e,t){var n,i;if(t&&t.length>0)try{for(var a=r.__values(t),s=a.next();!s.done;s=a.next()){var c=s.value;if(Object(o.a)(e,c.EmailAddress))return!0}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return!1}},4171:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(9),o=n(56),i=n(5);function a(){return Object(r.a)().PolicyTipsEnabled&&(Object(o.a)()||Object(i.d)("cmp-policyTips"))}},418:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"IndexedPageView:#Exchange"},e)}},4180:function(e,t,n){"use strict";var r=n(0),o=n(4427),i=n(4),a=n(2),s=n(7),c=Object(s.action)("setTableEditMenuViewState")(function(e,t,n){e.position=t,e.hasHeaders=n}),u=n(1445),l=n(8),d=n(20),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onDismiss=function(){c(t.props.viewState,null,t.props.viewState.hasHeaders)},t.setTableHeaders=function(e,n){t.onDismiss(),t.props.plugin.setTableHeaders(t.props.viewState.hasHeaders)},t.editTable=function(e,n){t.onDismiss();var r=n.data;t.props.plugin.editTable(r)},t.formatTable=function(e,n){t.onDismiss();var r=n.data;t.props.plugin.formatTable(r)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.viewState.position;return e&&a.createElement(u.a,{shouldFocusOnMount:!0,target:e,onDismiss:this.onDismiss,items:this.menuItems})},Object.defineProperty(t.prototype,"menuItems",{get:function(){return[{key:"insert",name:Object(i.a)(o.f),subMenuProps:{items:[{key:"insertAbove",name:Object(i.a)(o.g),data:0,onClick:this.editTable},{key:"insertBelow",name:Object(i.a)(o.h),data:1,onClick:this.editTable},{key:"insertLeft",name:Object(i.a)(o.i),data:2,onClick:this.editTable},{key:"insertRight",name:Object(i.a)(o.j),data:3,onClick:this.editTable}]}},{key:"delete",name:Object(i.a)(o.a),subMenuProps:{items:[{key:"deleteTable",name:Object(i.a)(o.d),data:4,onClick:this.editTable},{key:"deleteColumn",name:Object(i.a)(o.b),data:5,onClick:this.editTable},{key:"deleteRow",name:Object(i.a)(o.c),data:6,onClick:this.editTable}]}},{key:"merge",name:Object(i.a)(o.k),subMenuProps:{items:[{key:"mergeAbove",name:Object(i.a)(o.l),data:7,onClick:this.editTable},{key:"mergeBelow",name:Object(i.a)(o.m),data:8,onClick:this.editTable},{key:"mergeLeft",name:Object(i.a)(o.n),data:9,onClick:this.editTable},{key:"mergeRight",name:Object(i.a)(o.o),data:10,onClick:this.editTable}]}},{key:"split",name:Object(i.a)(o.p),subMenuProps:{items:[{key:"splitHorizontally",name:Object(i.a)(o.q),data:11,onClick:this.editTable},{key:"splitVertically",name:Object(i.a)(o.r),data:12,onClick:this.editTable}]}},{key:"style",name:Object(i.a)(o.s),subMenuProps:{items:[{key:"styleDefault",name:Object(i.a)(o.u),data:"Default",onClick:this.formatTable},{key:"styleGrid",name:Object(i.a)(o.v),data:"Grid",onClick:this.formatTable},{key:"styleLightLines",name:Object(i.a)(o.x),data:"LightLines",onClick:this.formatTable},{key:"styleTwoTones",name:Object(i.a)(o.y),data:"TwoTones",onClick:this.formatTable},{key:"styleLightBands",name:Object(i.a)(o.w),data:"LightBands",onClick:this.formatTable},{key:"styleClear",name:Object(i.a)(o.t),data:"Clear",onClick:this.formatTable}]}},{key:"headers",name:Object(i.a)(o.e),isChecked:this.props.viewState.hasHeaders,canCheck:!0,onClick:this.setTableHeaders}]},enumerable:!0,configurable:!0}),r.__decorate([l.computed],t.prototype,"menuItems",null),t=r.__decorate([d.observer],t)}(a.Component),p=n(3856),m="TD",g="TH";function v(e,t,n,r,o){return{bgColorEven:e,bgColorOdd:t,topBorderColor:n,bottomBorderColor:r,verticalBorderColor:o}}var h={Default:v("#FFF","#FFF","#ABABAB","#ABABAB","#ABABAB"),LightLines:v("#FFF","#FFF",null,"#92C0E0"),TwoTones:v("#C0E4FF","#FFF"),LightBands:v("#D8D8D8","#FFF"),Grid:v("#D8D8D8","#FFF","#ABABAB","#ABABAB","#ABABAB"),Clear:v("#FFF","#FFF")},y=function(){function e(e){var t=this;this.viewState=e,this.onContextMenu=function(e){var n=t.editor.getElementAtCursor(m+","+g,e.srcElement||e.target);if(n){t.range=t.editor.getSelectionRange(),t.invokedTableCell=n;for(var r=t.pluginUtils.createVTable(t.invokedTableCell),o=!0,i=0;i<r.cells[0].length;i++){var a=r.cells[0][i].td;if(a&&a.tagName!=g){o=!1;break}}c(t.viewState,{x:e.pageX,y:e.pageY},o),e.preventDefault()}}}return e.prototype.getName=function(){return"TableEdit"},e.prototype.initialize=function(e){this.editor=e,this.onContextMenuDisposer=this.editor.addDomEventHandler("contextmenu",this.onContextMenu)},e.prototype.dispose=function(){this.onContextMenuDisposer&&(this.onContextMenuDisposer(),this.onContextMenuDisposer=null),this.editor=null,this.invokedTableCell=null},e.prototype.setPluginUtils=function(e){this.pluginUtils=e},e.prototype.editTable=function(e){this.range&&this.editor&&(this.editor.select(this.range),this.pluginUtils.editTable(this.editor,e),this.range=null)},e.prototype.formatTable=function(e){var t=h[e];t&&this.range&&this.editor&&(this.editor.select(this.range),this.pluginUtils.formatTable(this.editor,t),this.range=null)},e.prototype.setTableHeaders=function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return this.range&&this.editor?[4,p.d.import()]:[3,2];case 1:t.sent()(this.editor,this.invokedTableCell,e),t.label=2;case 2:return this.invokedTableCell=null,[2]}})})},e}();function b(){return{position:null,hasHeaders:!1}}n.d(t,"a",function(){return f}),n.d(t,"b",function(){return y}),n.d(t,"c",function(){return b})},4183:function(e,t,n){"use strict";var r=n(4113),o=35;n.d(t,"a",function(){return s});var i=14,a=["1f602","2764","1f60d","1f62d","1f60a","1f612","1f495","1f618","267b","1f629","1f44c","1f60f","1f601","1f609","1f44d","2b05","1f60c","1f64f","1f914","1f622","1f60e","1f633","1f440","1f605","1f64c","1f494","1f648","270c","2728","1f499","1f49c","1f4af","1f604","1f496","1f61c"];function s(e){void 0===e&&(e=o);for(var t=Object(r.b)(Math.min(e,i)),n=0;t.length<e;n++){var s=a[n];t.includes(s)||t.push(s)}return t}},4192:function(e,t,n){"use strict";var r=n(216);t.a=function(e){return e==e&&!Object(r.a)(e)}},4193:function(e,t,n){"use strict";t.a=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},4203:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r,o=n(2576);function i(e,t,n){return r||(r=Object(o.a)()),{composeId:n,allowShowMultipleRows:!e,didViewOverflowOneRow:!1,canOverrideAllowShowMultipleRows:!0,docViewAttachments:[],imageViewAttachments:[],inlineAttachments:[],isInitialized:t,isReadOnly:e,groupId:null,maxTotalClassicAttachmentSize:r,totalClassicAttachmentSize:0,saveAllToCloudStatus:0,supportedMenuActions:null,sharingLinkIds:[]}}},4204:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return a}),n.d(t,"e",function(){return s}),n.d(t,"f",function(){return c});var r="Emoji",o="EmojiPicker",i=":",a="emojiPickerSuggestions",s="emojiPickerSuggestion-",c=6},4205:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(18),o="2d",i="canvas",a="image/png";function s(e){try{var t=document.createElement(i),n=e.naturalWidth,s=e.naturalHeight;if(n>0&&s>0||(Object(r.o)("CreateDataURIMissingNaturalDimensions"),n=e.width,s=e.height),n>0&&s>0)return t.width=n,t.height=s,t.getContext(o).drawImage(e,0,0),t.toDataURL(a)}catch(e){}return null}},4207:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"d",function(){return u});var r=n(3568),o=n(3),i=n(3863);n.d(t,"c",function(){return i.a});var a=new o.c(function(){return Promise.all([n.e(32),n.e(68),n.e(507),n.e(12),n.e(326)]).then(n.bind(null,4904))}),s=Object(r.a)(a,function(e){return e.PraguePlugin},"Prague",null),c=Object(o.d)(a,function(e){return e.PragueLoaderComponent}),u=new o.b(a,function(e){return e.fetchFileProviderAuthToken})},4234:function(e,t,n){"use strict";var r=n(0),o=n(3731),i=n(7),a=Object(i.action)("setNumberOfWaitingAttachments")(function(e,t){t<0||(e.numberOfWaitingAttachments=t)}),s=n(3703),c=n(18),u=n(45),l=n(5),d=n(4164),f=n(4171),p=n(1015),m=n(3880),g=n(12),v=n(787);function h(e,t,n,r){if(e.isInline)for(var o=t.length,i=n.attachmentWell.inlineAttachments.length,a=0;a<o;a++){var s=n.attachmentWell.inlineAttachments[i-o+a];r&&r(s.placeholderId,t[a])}}function y(e,t,n,i,y,b,_,S,C,O){return r.__awaiter(this,void 0,void 0,function(){var I,A,T;return r.__generator(this,function(E){switch(E.label){case 0:I=!1,A=Object(m.a)(t.smimeViewState),!Object(l.d)("cmp-upgradeCompose")||t.itemId||A||(I=!0,a(t,t.numberOfWaitingAttachments+1)),E.label=1;case 1:return E.trys.push([1,,6,7]),(T=!t.itemId&&!A)?[4,Object(s.f)(t)]:[3,3];case 2:T=!E.sent(),E.label=3;case 3:return T?[4,Object(s.b)(t)]:[3,5];case 4:E.sent(),E.label=5;case 5:return function(e,t,n,i,a,s,l,d,f,y){var b=this;Object(m.a)(t.smimeViewState)?p.c.import().then(function(l){return r.__awaiter(b,void 0,void 0,function(){var d,f;return r.__generator(this,function(p){switch(p.label){case 0:return p.trys.push([0,2,,3]),[4,l(e,r.__assign({},t.itemId,{mailboxInfo:Object(u.e)()}),t.attachmentWell,n,a||Object(o.a)(t),s||Object(o.c)(t))];case 1:return d=p.sent(),h(n,d,t,i),[3,3];case 2:return f=p.sent(),Object(c.o)("CreateSmimeAttachmentsFromFilesErrorDatapoint",{errorMessage:f.message},{isCore:!0}),g.c.warn(f),[3,3];case 3:return[2]}})})}):v.g.import().then(function(c){var p=c(t.attachmentWell,r.__assign({},t.itemId,{mailboxInfo:t.mailboxInfo?t.mailboxInfo:Object(u.e)()}),e,a||Object(o.a)(t),s||Object(o.c)(t),n,l,d,f,y);h(n,p,t,i)})}(e,t,n,i,y,b,function(e){_&&_(e),Object(f.a)()&&Object(d.a)(t,8)},S,C,O),[3,7];case 6:return I&&a(t,t.numberOfWaitingAttachments-1),[7];case 7:return[2]}})})}n.d(t,"a",function(){return y})},4240:function(e){e.exports={a:"i5a"}},4241:function(e){e.exports={a:"b5a"}},4242:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.None=-1]="None",e[e.Preset0=0]="Preset0",e[e.Preset1=1]="Preset1",e[e.Preset2=2]="Preset2",e[e.Preset3=3]="Preset3",e[e.Preset4=4]="Preset4",e[e.Preset5=5]="Preset5",e[e.Preset6=6]="Preset6",e[e.Preset7=7]="Preset7",e[e.Preset8=8]="Preset8",e[e.Preset9=9]="Preset9",e[e.Preset10=10]="Preset10",e[e.Preset11=11]="Preset11",e[e.Preset12=12]="Preset12",e[e.Preset13=13]="Preset13",e[e.Preset14=14]="Preset14",e[e.Preset15=15]="Preset15",e[e.Preset16=16]="Preset16",e[e.Preset17=17]="Preset17",e[e.Preset18=18]="Preset18",e[e.Preset19=19]="Preset19",e[e.Preset20=20]="Preset20",e[e.Preset21=21]="Preset21",e[e.Preset22=22]="Preset22",e[e.Preset23=23]="Preset23",e[e.Preset24=24]="Preset24"}(r||(r={}))},4245:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(3022);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("CreateItem",e,t)}},4246:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(3637);function o(e,t){return"HTML"==t&&e&&e.indexOf("<")>=0?r.HtmlSanitizer.convertInlineCss(e):e}},4263:function(e){e.exports={a:"Y4a"}},4264:function(e){e.exports={a:"X4a"}},4265:function(e){e.exports={a:"U4a"}},4266:function(e){e.exports={a:"A4a"}},4267:function(e,t,n){"use strict";var r=n(1616),o=n(3799),i=1,a=2;t.a=function(e,t,n,s){var c=n.length,u=c,l=!s;if(null==e)return!u;for(e=Object(e);c--;){var d=n[c];if(l&&d[2]?d[1]!==e[d[0]]:!(d[0]in e))return!1}for(;++c<u;){var f=(d=n[c])[0],p=e[f],m=d[1];if(l&&d[2]){if(void 0===p&&!(f in e))return!1}else{var g=new r.a;if(s)var v=s(p,m,f,e,t,g);if(!(void 0===v?Object(o.a)(m,p,i|a,s,g):v))return!1}}return!0}},4268:function(e,t,n){"use strict";var r=n(4192),o=n(3566);t.a=function(e){for(var t=Object(o.a)(e),n=t.length;n--;){var i=t[n],a=e[i];t[n]=[i,a,Object(r.a)(a)]}return t}},4269:function(e,t,n){"use strict";var r=n(3755),o=n(952),i=n(879),a=n(1092),s=n(946),c=n(3633);t.a=function(e,t,n){for(var u=-1,l=(t=Object(r.a)(t,e)).length,d=!1;++u<l;){var f=Object(c.a)(t[u]);if(!(d=null!=e&&n(e,f)))break;e=e[f]}return d||++u!=l?d:!!(l=null==e?0:e.length)&&Object(s.a)(l)&&Object(a.a)(f,l)&&(Object(i.a)(e)||Object(o.a)(e))}},427:function(e,t,n){"use strict";var r=n(947),o=n(45),i={};function a(e){var t=e.toLocaleLowerCase();if(!i[t]){var n={type:o.a.GroupMailbox,deprecatedMailboxId:e,primarySmtpAddress:e,routingKey:Object(o.c)()+e,returnModernConversationItems:!1,requestOptions:Object(r.a)(e)};i[t]=n}return i[t]}var s=n(1),c=Object(s.action)("EDIT_GROUP_SUCCESS",function(e,t){return{groupSmtp:e,photoUrl:t}}),u=Object(s.action)("ADD_GROUP_MEMBER_SUCCESS",function(e){return{groupSmtp:e}}),l=Object(s.action)("POPUP_OPENED",function(){return{isOpen:!0}}),d=Object(s.action)("POPUP_CLOSED",function(){return{isOpen:!1}}),f=Object(s.action)("DELETE_GROUP_SUCCESS",function(e){return{groupSmtp:e}});n.d(t,"m",function(){return r.a}),n.d(t,"l",function(){return a}),n.d(t,"k",function(){return c}),n.d(t,"i",function(){return u}),n.d(t,"p",function(){return l}),n.d(t,"o",function(){return d}),n.d(t,"j",function(){return f}),n.d(t,"q",function(){return"SwitchGroup"}),n.d(t,"n",function(){return"NavigateFromMeToWe"}),n.d(t,"f",function(){return"GroupHeader_SendEmail_Button_Clicked"}),n.d(t,"b",function(){return"GroupHeader_Email_Button_Clicked"}),n.d(t,"c",function(){return"GroupHeader_Files_Button_Clicked"}),n.d(t,"a",function(){return"GroupHeader_Calendar_Button_Clicked"}),n.d(t,"d",function(){return"GroupHeader_Notebook_Button_Clicked"}),n.d(t,"e",function(){return"GroupHeader_Planner_Button_Clicked"}),n.d(t,"h",function(){return"GroupHeader_Site_Button_Clicked"}),n.d(t,"g",function(){return"GroupHeader_Settings_Button_Clicked"})},4299:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(31);function o(e){var t="";if(e){var n=r.H.items.get(e.referenceItemId&&e.referenceItemId.Id);n&&n.SmartReplyData&&n.SmartReplyData.ExtractionID&&(t=n.SmartReplyData.ExtractionID)}return t}},430:function(e,t,n){"use strict";function r(e,t){for(var n=-1,r=0;e&&r<e.length;r++)if(t(e[r],r)){n=r;break}return n}function o(e,t){var n=r(e,t);if(!(n<0))return e[n]}function i(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n}function a(e,t){return e.reduce(function(e,n,r){return r%t==0?e.push([n]):e[e.length-1].push(n),e},[])}function s(e,t){return e.filter(function(e,n){return t!==n})}function c(e,t,n){var r=e.slice();return r[n]=t,r}function u(e,t,n){var r=e.slice();return r.splice(t,0,n),r}function l(e){var t=[];return e.forEach(function(e){return t=t.concat(e)}),t}function d(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,"e",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"i",function(){return a}),n.d(t,"g",function(){return s}),n.d(t,"h",function(){return c}),n.d(t,"a",function(){return u}),n.d(t,"f",function(){return l}),n.d(t,"b",function(){return d})},4320:function(e,t,n){"use strict";var r=n(3997),o=500;var i=/^\./,a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,c=function(e){var t=Object(r.a)(e,function(e){return n.size===o&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return i.test(e)&&t.push(""),e.replace(a,function(e,n,r,o){t.push(r?o.replace(s,"$1"):n||e)}),t});t.a=c},4321:function(e,t,n){"use strict";var r=n(4518),o=n(56);var i=n(4170),a=n(4636),s=n(9);function c(e,t,n,c,u){void 0===u&&(u=!0);var l=!!t,d=(Object(a.a)()||null!=e)&&!l&&u,f=null;if(!e){var p=Object(i.d)(n);p&&(f={MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:p,Name:Object(s.a)().SessionSettings.UserDisplayName})}return function(e,t,n,i){return{from:e||n||i?Object(r.a)(t):null,isFromShown:e,isFromContextMenuShown:!1,sendAsEmailAddresses:[],loadAliasActionStatus:Object(o.a)()?0:2,isFromReadOnly:n,isFromEditing:!1,isFromValid:!0,fromWellFindControlViewState:null}}(d,e||f,l,c)}n.d(t,"a",function(){return c})},4331:function(e,t,n){"use strict";var r=n(1),o=Object(r.createStore)("SurfaceActionsStore",{addinOptionSurfaceItems:{}})();t.a=o},4332:function(e){e.exports={a:"l5a"}},4333:function(e){e.exports={a:"g5a"}},4334:function(e){e.exports={a:"f5a"}},4335:function(e){e.exports={a:"d5a"}},4336:function(e){e.exports={a:"Z4a"}},4337:function(e){e.exports={a:"W4a"}},4338:function(e){e.exports={a:"V4a"}},4339:function(e){e.exports={a:"T4a"}},4340:function(e){e.exports={a:"S4a"}},4341:function(e){e.exports={a:"R4a"}},4342:function(e){e.exports={a:"C4a"}},4343:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(5),o=n(27);function i(){return!Object(o.n)()&&(Object(r.d)("cmp-requestReadReceipts")||Object(r.d)("cmp-requestDeliveryReceipts")||Object(r.d)("cmp-setMessageSensitivity")||Object(r.d)("cmp-smime"))}},435:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(14),o=n(333),i=Object(o.b)(function(e,t){var n={position:"absolute",width:1,right:31,top:8,bottom:8},o={splitButtonContainer:[Object(r.getFocusStyle)(e,{highContrastStyle:{left:-2,top:-2,bottom:-2,right:-2,border:"none"}}),{display:"inline-flex"}],splitButtonContainerFocused:{outline:"none!important"},splitButtonMenuButton:{padding:6,height:"auto",boxSizing:"border-box",border:0,borderRadius:0,outline:"transparent",userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",width:32,marginLeft:-1,marginTop:0,marginRight:0,marginBottom:0},splitButtonDivider:n,splitButtonDividerDisabled:n,splitButtonMenuButtonDisabled:{pointerEvents:"none",selectors:{":hover":{cursor:"default"}}},splitButtonFlexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},splitButtonContainerDisabled:{outline:"none",border:"none"}};return Object(r.concatStyleSets)(o,t)})},4359:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SingleRecipientType:#Exchange"},e)}},4360:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o});var r=function(e,t,n){return void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===n&&(n=0),{shouldEncryptMessageAsSmime:e,shouldSignMessageAsSmime:t,signingCertRawData:null,errorCode:n,errorContext:0,smimeBccForkingMode:0,currentBccRecipientIndex:-1}};function o(e){switch(e){case 6:return r(!0,!1);case 10:case 11:return r(!1,!0);case 12:case 13:case 14:return r(!0,!0);case-1:case 0:default:return r()}}},437:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(21),o=n(194);function i(){var e=Object(o.c)(),t=null;return null==(t=1===e.type?e.searchFolderId:5===e.type?e.data.searchFolderId:e.id)?null:r.n.folderTable.get(t)}},4377:function(e,t,n){"use strict";var r=n(6165),o=n(4774);function i(e){var t=Object(r.a)(e);return Object(o.a)()[t]}var a=n(4775);function s(e){return e.isActionable&&e.control.Action.SupportsPersistence}var c=n(0),u=n(4),l=n(3548),d=n(4141),f=n(6133),p=!1;function m(e){return c.__awaiter(this,void 0,void 0,function(){var t,n;return c.__generator(this,function(r){switch(r.label){case 0:return Object(d.c)()?e===l.a.AppointmentAttendee||e===l.a.AppointmentOrganizer?[2]:p?[3,2]:[4,Object(f.a)()]:[2];case 1:t=r.sent(),(n=JSON.parse(t)).addins&&(p=!0,n.addins.forEach(function(e){if(function(e){return!Object(u.g)(e.mode)&&!Object(u.g)(e.addinId)&&!Object(u.g)(e.commandId)}(e)){var t={addinId:e.addinId,commandId:e.commandId};Object(o.a)()[e.mode]=t}})),r.label=2;case 2:return[2]}})})}function g(){return p}function v(e){return{addinId:e.extension.Id,commandId:e.control.Id}}var h=n(3538);function y(e){for(var t=Object.keys(Object(o.a)()),n=0;n<t.length;n++){var r=t[n],i=Object(o.a)()[r];i&&e.indexOf(i.addinId)<0&&(Object(a.b)(r,null),Object(h.cb)(i.addinId))}}var b=function(e){var t=i(l.a.MessageRead),n=i(l.a.MessageCompose);return!!(t&&e.extension.Id===t.addinId&&e.get_Id().indexOf(t.commandId)>=0)||!!(n&&e.extension.Id===n.addinId&&e.get_Id().indexOf(n.commandId)>=0)};n.d(t,"c",function(){return i}),n.d(t,"h",function(){return a.a}),n.d(t,"a",function(){return s}),n.d(t,"f",function(){return m}),n.d(t,"e",function(){return g}),n.d(t,"b",function(){return v}),n.d(t,"g",function(){return y}),n.d(t,"d",function(){return b})},440:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s});var r,o=2,i=[window.location.origin];function a(e,t,n){var r={version:o,type:t,serializedData:JSON.stringify(n)};e.postMessage(JSON.stringify(r),"*")}function s(e){if(i.indexOf(e.origin)>=0){var t=void 0;try{t=JSON.parse(e.data)}catch(e){return null}if(t&&o==t.version)return t}return null}!function(e){e[e.Unknown=0]="Unknown",e[e.PopoutReady=1]="PopoutReady",e[e.SetData=2]="SetData"}(r||(r={}))},4401:function(e){e.exports={a:"D4a",d:"E4a",f:"F4a",c:"G4a",b:"H4a",e:"I4a",h:"J4a",g:"K4a",i:"L4a",j:"M4a",l:"N4a",k:"O4a",m:"P4a",n:"Q4a"}},4411:function(e,t,n){"use strict";var r=n(4267),o=n(4268),i=n(4193);t.a=function(e){var t=Object(o.a)(e);return 1==t.length&&t[0][2]?Object(i.a)(t[0][0],t[0][1]):function(n){return n===e||Object(r.a)(n,e,t)}}},4412:function(e,t,n){"use strict";var r=n(3799),o=n(3996),i=n(3928),a=n(3909),s=n(4192),c=n(4193),u=n(3633),l=1,d=2;t.a=function(e,t){return Object(a.a)(e)&&Object(s.a)(t)?Object(c.a)(Object(u.a)(e),t):function(n){var a=Object(o.a)(n,e);return void 0===a&&a===t?Object(i.a)(n,e):Object(r.a)(t,a,l|d)}}},4425:function(e,t,n){"use strict";function r(){return{isOpen:!1,errors:[]}}n.d(t,"a",function(){return r})},4426:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(4183);function o(){return{emojiResults:Object(r.a)(),queryString:"",wordBeforeCursor:"",isSuggesting:!1,isPopupShown:!1,selectedEmojiIndex:0}}},4427:function(e){e.exports={f:"Qda",g:"Rda",h:"Sda",i:"Tda",j:"Uda",a:"Vda",d:"Wda",b:"Xda",c:"Yda",k:"Zda",l:"_da",m:"$da",n:"aea",o:"bea",p:"cea",q:"dea",r:"eea",s:"fea",u:"gea",v:"hea",x:"iea",y:"jea",w:"kea",t:"lea",e:"mea"}},4429:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s});var r=n(3),o=n(3568),i=new r.c(function(){return n.e(83).then(n.bind(null,5453))}),a=Object(o.a)(i,function(e){return e.AccCheckerPlugin},"AccChecker",null),s=Object(r.d)(i,function(e){return e.AccCheckerPane})},4437:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"a",function(){return d});var r,o=n(4205),i=n(3661),a=n(18),s=n(9),c="none",u=function(){function e(){var e=this;this.restoreImageAttributes=function(){if(e.imagesToRestore)for(var t=e.imagesToRestore.pop();t;){var n=t.image,r=t.sourceToRestore,o=t.shouldSetUserSelectNone;r&&(n.src=r),o&&(n.style.webkitUserSelect=c),t=e.imagesToRestore.pop()}},this.imagesToRestore=[]}return e.prototype.dispose=function(){this.imagesToRestore=null},e.prototype.handleCopy=function(e){for(var t=e.getElementsByTagName("img"),n=t.length,r=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,u=Object(s.a)().ApplicationSettings.DownloadUrlBase,l=window.location.origin,d=0;d<n;d++){var f=t[d],p=f.getAttribute("src");if(p&&(0==p.indexOf(u)||0==p.indexOf(l))){var m=f.getAttribute("originalsrc"),g=i.a.inlineImages[m];if(g||(g=Object(o.a)(f)),g){var v=null,h=!1,y=f.getAttribute("contenttype");y&&-1!=y.indexOf("gif")&&(v=p),r&&f.style.webkitUserSelect==c&&(f.style.webkitUserSelect="all",h=!0),(v||h)&&this.imagesToRestore.push({image:f,sourceToRestore:v,shouldSetUserSelectNone:h}),f.src=g}else Object(a.o)("ImageCopyHandlerNullDataURI")}}this.imagesToRestore.length>0&&setTimeout(this.restoreImageAttributes,500)},e}();function l(e){r||(r=new u),r.handleCopy(e)}function d(){r&&(r.dispose(),r=null)}},4449:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(4166),o=n(4168);function i(e){var t=e.policyMatchDetails,n=t.filter(function(e){return 0!=e.MatchPriority});return n.length>0?Object(o.a)(n,function(e){return e.MatchPriority}):Object(r.a)(t,function(e){return function(e){switch(e){case 1:return 0;case 4:case 2:case 3:return 1;case 5:return 2;default:return 3}}(e.Action)})}},4450:function(e,t,n){"use strict";t.a=function(e,t){return e>t}},4451:function(e,t,n){"use strict";t.a=function(e,t){return e<t}},4480:function(e,t,n){"use strict";var r;!function(e){e[e.Success=0]="Success",e[e.OperationNotSupported=5e3]="OperationNotSupported",e[e.InternalError=5001]="InternalError",e[e.BrowserAPINotSupported=5009]="BrowserAPINotSupported",e[e.CrossZone=12011]="CrossZone",e[e.NotSsoAgave=13e3]="NotSsoAgave",e[e.UserNotSignedIn=13001]="UserNotSignedIn",e[e.UserAborted=13002]="UserAborted",e[e.UnsupportedUserIdentity=13003]="UnsupportedUserIdentity",e[e.InvalidResourceUrl=13004]="InvalidResourceUrl",e[e.InvalidGrant=13005]="InvalidGrant",e[e.ClientError=13006]="ClientError",e[e.ServerError=13007]="ServerError",e[e.AddinIsAlreadyRequestingToken=13008]="AddinIsAlreadyRequestingToken"}(r||(r={}));var o=n(0),i=n(6617),a=n(5703),s=n(4),c=n(2),u=null;function l(e){u=e}function d(){l(null)}var f=function(e,t){u&&u(e,t)},p=n(3538);function m(e){f(e),d(),Object(p.F)()}var g,v=n(135),h=n(94),y="https",b="store.office.com",_="client/consentnotification.aspx",S="WAC_Outlook";!function(e){e[e.ConsentResult=0]="ConsentResult",e[e.TabExit=1]="TabExit",e[e.ButtonClick=2]="ButtonClick",e[e.PageLoad=3]="PageLoad"}(g||(g={}));var C=g,O={NoUserLogin:"AADSTS50058",InvalidResourceUrl:"AADSTS50001",InvalidGrant:"AADSTS65001"};var I,A=n(282),T="bc59ab01-8403-45c6-8796-ac3ef710b3e3",E="/owa/extSSO.aspx";function x(e,t){var n=Object(p.E)(e),r=Object(v.resolve)(window.location.origin,E);Object(A.getAccessTokenOnBehalfOfResource)(T,r,n,t,P)}function P(e,t){var n,o;t?f(null,t):f((n=e,o=r.InternalError,n&&n.indexOf(O.NoUserLogin)>=0?o=r.UserNotSignedIn:n&&n.indexOf(O.InvalidResourceUrl)>=0?o=r.InvalidResourceUrl:n&&n.indexOf(O.InvalidGrant)>=0&&(o=r.InvalidGrant),o)),d()}function M(e,t){Object(p.F)(),x(e,t)}!function(e){e[e.Success=0]="Success",e[e.Cancelled=100]="Cancelled",e[e.ClientError=400]="ClientError",e[e.ServerError=500]="ServerError",e[e.UnknowError=600]="UnknowError"}(I||(I={}));var w=I;var R=n(20),k=n(5704),D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.refcallback=function(e){var t=function(n){if(e&&n.source==e.contentWindow){var o=JSON.parse(n.data);o.messageType==C.ConsentResult?(window.removeEventListener("message",t),function(e){switch(e){case w.Success:var t=Object(p.A)();M(t.controlId,t.authChallenge);break;case w.Cancelled:m(r.UserAborted);break;default:m(r.InvalidGrant)}}(o.messageValue)):o.messageType==C.PageLoad&&Object(p.mb)(!0)}};window.addEventListener("message",t),null!=e&&null!=e.contentWindow&&e.contentWindow.focus()},t}return o.__extends(t,e),t.prototype.render=function(){var e=Object(p.A)(),t=function(e,t,n){var r={client:S,cv:n,ui:t,appDomain:window.location.origin,rs:e.extension.MarketplaceContentMarket,notificationType:2,corr:Object(h.a)()};return e.extension.MarketplaceAssetID?r.assetid=e.extension.MarketplaceAssetID:(r.appid=e.extension.WebAppId,r.scopes=e.extension.WebAppScopes.join(",")),Object(v.format)({protocol:y,host:b,pathname:_,query:r})}(Object(p.n)(e.controlId),this.props.userCulture,this.props.owaVersion);return c.createElement("div",null,c.createElement("iframe",{src:t,frameBorder:"0",className:k.consentContainer,ref:this.refcallback}))},t=o.__decorate([R.observer],t)}(c.Component),j=n(6619),N=n(2515),F=n(1452),L=n(1891),U=n(1599),B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.render=function(){return c.createElement("div",null,c.createElement(U.a,null,Object(s.a)(j.a)),c.createElement(L.a,null,c.createElement(N.a,{onClick:this.onSignInClick,text:Object(s.a)(a.a)}),c.createElement(F.a,{onClick:this.onDismiss,text:Object(s.a)(a.b)})))},t.prototype.onSignInClick=function(){var e=Object(p.A)();M(e.controlId,e.authChallenge)},t.prototype.onDismiss=function(){m(r.UserAborted)},t=o.__decorate([R.observer],t)}(c.Component),H=n(3013),V=n(1012),W=n(27),G=n(15),z=n(5704),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.render=function(){var e=Object(p.A)(),t=e.isVisible?"":z.hiddenContainer,n=this.createSsoDialog(e.type);return n?c.createElement("div",null,c.createElement(H.a,{isOpen:e.isOpen,type:n.type,onDismiss:this.closeDialog,title:n.title,modalProps:{isBlocking:!0,containerClassName:"ms-dialogMainOverride"},className:t},n.component)):c.createElement("div",null)},t.prototype.closeDialog=function(){m(r.UserAborted)},t.prototype.createSsoDialog=function(e){switch(e){case p.e.OmexConsent:var t=Object(W.g)(),n=Object(G.i)();return{component:c.createElement(D,{userCulture:t,owaVersion:n}),title:Object(s.a)(i.a),type:V.a.close};case p.e.MFASignIn:return{component:c.createElement(B,null),title:Object(s.a)(a.a),type:V.a.normal};default:return null}},t=o.__decorate([R.observer],t)}(c.Component);function K(e){l(e)}n.d(t,"a",function(){return q}),n.d(t,"d",function(){return K}),n.d(t,"c",function(){return x}),n.d(t,"b",function(){return r})},451:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(85),o=r.a.GreyDark,i=r.a.GreyDark},4515:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r="<div id=appendonsend></div>";function o(e){var t="";return"HTML"==e&&(t+=r),t}},4516:function(e,t,n){"use strict";var r=n(3866);t.a=function(){for(var e=Object(r.b)().userLabels,t=0;t<e.length;t++)if(e[t].isDefault)return e[t];return null}},4517:function(e,t,n){"use strict";n.d(t,"d",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"b",function(){return d});var r=n(0),o=n(18),i=n(6),a=n(9);function s(e,t){var n=f(e.selectedCLPLabel,"Change"),i=e.originalCLPLabel,a=e.selectedCLPLabel,s=r.__assign({},n,{IsLabelChanged:!0,LabelIdBefore:i.id,IsProtectionChanged:i.isEncryptingLabel!=a.isEncryptingLabel,ProtectedBefore:i.isEncryptingLabel,UserJustification:t});o.i.importAndExecute(s)}function c(e){var t=f(e,"Discover");o.i.importAndExecute(t)}function u(e){e&&Object(o.o)("LoadCLPLabelOnBoot",{isLabelListEmpty:!e.value||0==e.value.length})}function l(e){e&&Object(o.o)("LoadCLPLabelComposeUsage",{isDefaultLabel:e.isDefault,isEncryptingLabel:e.isEncryptingLabel})}function d(e,t){t&&e?Object(o.o)("LoadCLPLabelChange",{isDowngrade:e.settingOrder>t.settingOrder,isOriginalLabelDefault:e.isDefault}):e&&Object(o.o)("LoadCLPLabelUnselect",{isOriginalLabelDefault:e.isDefault,isOriginalLabelEncrypting:e.isEncryptingLabel})}function f(e,t){var n=Object(a.a)().SessionSettings,r=n.ExternalDirectoryTenantGuid,o=n.UserEmailAddress;return{CreationTime:Object(i.jb)(Object(i.Db)()),Version:"1.1",Operation:t,OrganizationId:r,UserId:o,ApplicationId:"00000002-0000-0ff1-ce00-000000000000",ApplicationName:"Outlook Web",DataState:"Use",LabelId:e?e.id:null,Protected:e?e.isEncryptingLabel:null}}},4518:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(4170);function o(e,t){return{email:e||Object(r.a)(t)}}},4519:function(e,t,n){"use strict";var r=n(7),o=n(3671);t.a=Object(r.action)("preloadComposePlugins")(function(e){var t=Object(o.b)(e);t&&(t.mentionsPickerPlugin&&e.atMentions.atMentionTuples&&Object.keys(e.atMentions.atMentionTuples).length>0&&t.mentionsPickerPlugin.getPlugin(),t.praguePlugin&&t.praguePlugin.getPlugin())})},452:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(9),o=n(273);function i(e){var t=(e&&Object(o.i)(e.primarySmtpAddress)?Object(o.h)(e.primarySmtpAddress):Object(r.a)()).MasterCategoryList;return t&&t.MasterList||[]}},4520:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),o=n(805),i=n(4726);function a(e){var t,n,a=null,s=null;if(e&&e.recipients)try{for(var c=r.__values(r.__spread(o.a.viewStates.values())),u=c.next();!u.done;u=c.next()){var l=u.value;if((s=Object(i.a)(l)).toRecipients===e.recipients||s.ccRecipients===e.recipients||s.bccRecipients===e.recipients){a=l;break}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return a}},4521:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1),o=Object(r.createStore)("dictationStore",{isDictationOn:!1})},4522:function(e,t,n){"use strict";function r(){return{nonTenantLabelString:"",selectedLabel:null}}n.d(t,"a",function(){return r})},453:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var r=n(451),o=n(184),i=n(452);function a(e,t){t||(t=Object(i.a)());for(var n=0;n<t.length;n++){var r=t[n];if(r.Name.toLowerCase()===e.toLowerCase())return o.a.colorCodeColorValueMap[r.Color.toString()]}return s()}function s(){return o.a.colorCodeColorValueMap[r.a]}},454:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return p});var r=n(4),o=n(686),i=n(12),a=n(107),s=n(61),c=n(9),u=n(5);function l(e){try{if(!e)return null;for(var t=atob(e),n=t.length,r=new Uint8Array(new ArrayBuffer(n)),a=0;a<n;a++)r[a]=t.charCodeAt(a);return Object(o.a)(r)}catch(t){return i.c.error("getMailboxGuidFromEwsId : conversion failed for id "+e+" with error "+t),null}}function d(e,t){if(!e||!t)return null;return r.b("{0}@{1}",e,t)}function f(e){if(!Object(u.d)("tri-anchorMailboxHeader"))return null;if(!e)return null;var t=Object(c.a)().SessionSettings,n=Object(a.a)(),r=n&&n.get(e);return r||e===s.d?e===s.d||r.treeType===s.c?d(t.ArchiveMailboxGuid,t.OrganizationDomain):r.treeType===s.i?d(l(e),t.OrganizationDomain):null:null}function p(e){if(!Object(u.d)("tri-anchorMailboxHeader"))return null;if(!e)return null;var t=Object(c.a)().SessionSettings,n=l(e);return n===t.MailboxGuid?null:d(n,t.OrganizationDomain)}},4542:function(e,t,n){"use strict";var r=n(3568);function o(){return{position:null,subMenuSelectionIndex:-1}}var i=n(3);n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return o});var a=new i.c(function(){return Promise.all([n.e(4),n.e(8),n.e(10),n.e(11),n.e(242)]).then(n.bind(null,11816))}),s=Object(i.d)(a,function(e){return e.PasteOptioin}),c=Object(r.a)(a,function(e){return e.PasteOptionPlugin},"PasteOption",function(e,t){return 6===e.eventType&&"Paste"==e.source})},455:function(e,t,n){"use strict";var r=n(7),o=n(33),i=n(132);t.a=Object(r.select)({folderTable:function(){return Object(i.a)().folderTable}})(function(e,t){var n=Object(o.a)(e);return n||(n=e),t.folderTable.get(n).FolderId})},4551:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetClientAccessTokenJsonRequest:#Exchange"},e)}},4563:function(e,t,n){"use strict";n.d(t,"h",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"g",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"e",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"f",function(){return f});var r=n(0),o=n(3538);function i(e){return s(e)?c(e).isMenu:e.AddinCommands.size>1}function a(e){return!!s(e)&&c(e).isActionable}function s(e){return 1==e.AddinCommands.size}function c(e){return e.AddinCommands.size>0?r.__spread(e.AddinCommands.values())[0]:null}function u(e){return s(e)?c(e).control.Supertip.Title:""}function l(e){var t=e.DisplayName;s(e)&&(t+=" - "+c(e).control.Supertip.Title);return t}function d(e,t,n){var i,a,s,c,u=o.k.EnabledAddinCommands;if(!u)return null;try{for(var l=r.__values(u.getExtensionPoint(n)),d=l.next();!d.done;d=l.next()){var f=d.value;if(f.Id==e&&f.AddinCommands.size>0)try{for(var p=(s=void 0,r.__values(f.AddinCommands.values())),m=p.next();!m.done;m=p.next()){var g=m.value;if(g.control.Id==t)return g}}catch(e){s={error:e}}finally{try{m&&!m.done&&(c=p.return)&&c.call(p)}finally{if(s)throw s.error}}}}catch(e){i={error:e}}finally{try{d&&!d.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}return null}function f(e){return o.k.compliance.isMinor&&(!function(e){return"Default"===e.TypeString}(t=e.extension)&&!function(e){return"Organization"===e.OriginString}(t)&&!function(e){return"Private"===e.TypeString}(t));var t}},4564:function(e){e.exports={b:"Itb",a:"Jtb",c:"Ktb",g:"Ltb",f:"Mtb",d:"Ntb",e:"Otb"}},4565:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"InstallExtensionJsonRequest:#Exchange"},e)}},4632:function(e,t,n){"use strict";function r(e){var t=[],n=e.attachmentWell;return n&&(n.docViewAttachments.forEach(function(e){t.push(e.attachmentId)}),n.inlineAttachments.forEach(function(e){t.push(e.attachmentId)}),n.imageViewAttachments.forEach(function(e){t.push(e.attachmentId)})),t}n.d(t,"a",function(){return r})},4633:function(e,t,n){"use strict";var r=n(0);t.a=function(e){return e&&0!==e.length?e.filter(function(e){return!!e}).reduce(function(e,t){return r.__spread(e,(n=t)&&n.recipients?n.recipients.slice():[]);var n},[]):[]}},4634:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(18);function o(e,t){if(t){var n=null;switch(e){case 0:n="SmartReplySendMessage";break;case 1:n="SmartReplySaveMessage";break;case 2:n="SmartReplyDiscardMessage"}Object(r.o)(n,[t])}}},4635:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(4),o=n(4725),i=n(4246),a="Signature";function s(e,t,n){var s="";if(t&&!function(e,t){if("HTML"==e){var n=(new DOMParser).parseFromString(t,"text/html").documentElement;if(n&&n.innerText){var r=n.innerText.replace(/(\t|\n|\r|\v|\f)/g,""),o=n.querySelectorAll('img[src]:not([src=""])');return!r&&0==o.length}return!0}return!t}(e,t))if("HTML"==e){var c=Object(o.b)(),u=Object(i.a)(t,e);s=n?c+c:c,s+=Object(r.b)("<div id='{0}'>{1}</div>",a,u)}else s="\n\n"+t;return s}},4636:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(9),o=n(27);function i(){var e=Object(r.a)().UserOptions,t=Object(r.a)().SessionSettings;return e.AlwaysShowFrom||Object(o.n)()&&(a(t.ConnectedAccountInfos,0)||a(t.NotManagedEmailAddresses,0)||a(t.UserProxyAddresses,1))}function a(e,t){return e&&e.length>t}},4637:function(e,t,n){"use strict";var r=n(7);t.a=Object(r.action)("switchToReadWriteRecipient")(function(e){e.showCompactRecipientWell=!1})},4638:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return s});var r="@",o="AtMention",i="OWAAM",a="suggestedRecipients",s="suggestedRecipient-"},4639:function(e,t,n){"use strict";var r=n(3866),o=n(4522),i=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/g;function a(e,t){if(!t)return null;for(var n=0;n<t.length;n++){var r=t[n];if(r.id==e)return r;var o=a(e,r.children);if(o)return o}return null}t.a=function(e){var t=Object(o.a)();if(!e)return t;for(var n=e.split(";"),s=Object(r.b)().userLabels,c={},u=0;u<n.length;u++){var l=n[u];if(l){var d=l.match(i);if(d&&0!=d.length){var f=d[0];c[f]?c[f].push(l):c[f]=[l]}}}var p=Object.keys(c);for(u=0;u<p.length;u++){var m=a(p[u],s);if(m){t.selectedLabel=m,delete c[p[u]];break}}return Object.values(c).forEach(function(e){t.nonTenantLabelString+=e.join(";")+";"}),t}},4686:function(e,t,n){"use strict";var r=n(0),o=n(88),i=60,a=6e4;function s(e){var t=e.split("-");return{year:parseInt(t[0]),month:parseInt(t[1]),day:parseInt(t[2])}}var c="Monday",u="Tuesday",l="Wednesday",d="Thursday",f="Friday",p="Saturday",m="Sunday",g=[c,u,l,d,f].join(" "),v=[p,m].join(" "),h=[g,v].join(" ");function y(e){switch(e){case"mon":return c;case"tue":return u;case"wed":return l;case"thu":return d;case"fri":return f;case"sat":return p;case"sun":return m;case"weekday":return g;case"weekendDay":return v;case"day":return h}return""}function b(e){switch(e){case c:return"mon";case u:return"tue";case l:return"wed";case d:return"thu";case f:return"fri";case p:return"sat";case m:return"sun";case g:return"weekday";case v:return"weekendDay";case h:return"day"}return""}var _="January",S="February",C="March",O="April",I="May",A="June",T="July",E="August",x="September",P="October",M="November",w="December";function R(e){switch(e){case"jan":return _;case"feb":return S;case"mar":return C;case"apr":return O;case"may":return I;case"jun":return A;case"jul":return T;case"aug":return E;case"sep":return x;case"oct":return P;case"nov":return M;case"dec":return w}return""}function k(e){switch(e){case _:return"jan";case S:return"feb";case C:return"mar";case O:return"apr";case I:return"may";case A:return"jun";case T:return"jul";case E:return"aug";case x:return"sep";case P:return"oct";case M:return"nov";case w:return"dec"}return""}var D="First",j="Second",N="Third",F="Fourth",L="Last";function U(e){switch(e){case"first":return D;case"second":return j;case"third":return N;case"fourth":return F;case"last":return L}return""}function B(e){switch(e){case D:return"first";case j:return"second";case N:return"third";case F:return"fourth";case L:return"last"}return""}function H(e){if(null==e.recurrenceType)return null;var t=function(e){var t=e.startTime,n=e.endTime,c=e.recurrenceType,u=e.timeZone,l=s(c.RecurrenceRange.StartDate),d=(n.getTime()-t.getTime())/a,f=t.getUTCHours()*i+t.getUTCMinutes()+Object(o.f)(t,u),p={startYear:l.year,startMonth:l.month,startDay:l.day,startTimeMin:f,durationMin:d};if(c.RecurrenceRange.EndDate){var m=s(c.RecurrenceRange.EndDate);p=r.__assign({},p,{endDay:m.day,endMonth:m.month,endYear:m.year})}else p.noEndDate=!0;return p}(e),n={name:e.timeZone,offset:Object(o.f)(e.startTime,e.timeZone)},c=e.recurrenceType.RecurrencePattern;switch(c.__type){case"DailyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval},recurrenceType:"daily",seriesTimeJson:t,recurrenceTimeZone:n}}(c,t,n);case"WeeklyRecurrence:#Exchange":return function(e,t,n){if(1===e.Interval&&"weekday"===b(e.DaysOfWeek))return{recurrenceProperties:void 0,recurrenceType:"weekday",seriesTimeJson:t,recurrenceTimeZone:n};return{recurrenceProperties:{interval:e.Interval,days:e.DaysOfWeek.split(" ").map(b),firstDayOfWeek:b(e.FirstDayOfWeek)},recurrenceType:"weekly",seriesTimeJson:t,recurrenceTimeZone:n}}(c,t,n);case"AbsoluteMonthlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval,dayOfMonth:e.DayOfMonth},recurrenceType:"monthly",seriesTimeJson:t,recurrenceTimeZone:n}}(c,t,n);case"RelativeMonthlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval,dayOfWeek:b(e.DaysOfWeek),weekNumber:B(e.DayOfWeekIndex)},recurrenceType:"monthly",seriesTimeJson:t,recurrenceTimeZone:n}}(c,t,n);case"AbsoluteYearlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:0,dayOfMonth:e.DayOfMonth,month:k(e.Month)},recurrenceType:"yearly",seriesTimeJson:t,recurrenceTimeZone:n}}(c,t,n);case"RelativeYearlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:0,dayOfWeek:b(e.DaysOfWeek),weekNumber:B(e.DayOfWeekIndex),month:k(e.Month)},recurrenceType:"yearly",seriesTimeJson:t,recurrenceTimeZone:n}}(c,t,n)}return null}var V=60;function W(e,t,n,r){var o=Math.floor(r/V);return r-=o*V,new Date(Date.UTC(e,t-1,n,o,r))}function G(e,t){switch(e){case"daily":return function(e){return{__type:"DailyRecurrence:#Exchange",Interval:e.interval}}(t);case"weekday":return{__type:"WeeklyRecurrence:#Exchange",Interval:1,FirstDayOfWeek:"Monday",DaysOfWeek:"Monday Tuesday Wednesday Thursday Friday"};case"weekly":return function(e){return{__type:"WeeklyRecurrence:#Exchange",Interval:e.interval,FirstDayOfWeek:y(e.firstDayOfWeek),DaysOfWeek:e.days.map(y).join(" ")}}(t);case"monthly":return function(e){return e.dayOfMonth?{__type:"AbsoluteMonthlyRecurrence:#Exchange",DayOfMonth:e.dayOfMonth,Interval:e.interval}:{__type:"RelativeMonthlyRecurrence:#Exchange",Interval:e.interval,DaysOfWeek:y(e.dayOfWeek),DayOfWeekIndex:U(e.weekNumber)}}(t);case"yearly":return function(e){return e.dayOfMonth?{__type:"AbsoluteYearlyRecurrence:#Exchange",Month:R(e.month),DayOfMonth:e.dayOfMonth}:{__type:"RelativeYearlyRecurrence:#Exchange",Month:R(e.month),DaysOfWeek:y(e.dayOfWeek),DayOfWeekIndex:U(e.weekNumber)}}(t);default:return null}}function z(e,t,n){return e+"-"+q(t)+"-"+q(n)}function q(e){return e<10?"0"+e:""+e}function K(e){if(null==e)return null;var t,n,r=e.seriesTimeJson,o=e.recurrenceProperties,i=e.recurrenceType,a=r.startDay,s=r.startMonth,c=r.startYear,u=r.startTimeMin,l=r.durationMin;return{recurrenceType:{__type:"RecurrenceType:#Exchange",RecurrenceRange:(t=r,n=z(t.startYear,t.startMonth,t.startDay),t.noEndDate?{__type:"NoEndRecurrence:#Exchange",StartDate:n}:{__type:"EndDateRecurrence:#Exchange",StartDate:n,EndDate:z(t.endYear,t.endMonth,t.endDay)}),RecurrencePattern:G(i,o)},startTime:W(c,s,a,u),endTime:W(c,s,a,u+l)}}function X(e,t,n){return e>=1601&&t>=1&&t<=12&&n>=1&&n<=31}function J(e,t,n){var r=new Date;return r.setFullYear(e),r.setMonth(t-1),r.setDate(n),r}function Q(e){return null==e||!!e.recurrenceType&&(!(!e.seriesTimeJson||!function(e){if(!e)return!1;if(!X(e.startYear,e.startMonth,e.startDay))return!1;if(!e.noEndDate){if(!X(e.endYear,e.endMonth,e.endDay))return!1;if(J(e.startYear,e.startMonth,e.startDay)>=J(e.endYear,e.endMonth,e.endDay))return!1}return!(e.startTimeMin<0||e.durationMin<0)}(e.seriesTimeJson))&&!!function(e,t){switch(e){case"daily":return!!(n=t)&&!(!n.interval||n.interval<1);case"weekly":return function(e){return!!e&&(!(!e.interval||e.interval<1)&&(!(!e.days||e.days.length<1)&&!!e.firstDayOfWeek))}(t);case"monthly":return function(e){return!!e&&(!(!e.interval||e.interval<1)&&(!(!e.dayOfMonth||e.dayOfWeek||e.weekNumber)||!(!e.dayOfWeek||!e.weekNumber||e.dayOfMonth)))}(t);case"yearly":return function(e){return!!e&&(!(!e.interval||e.interval<1)&&(!!e.month&&(!(!e.dayOfMonth||e.dayOfWeek||e.weekNumber)||!(!e.dayOfWeek||!e.weekNumber||e.dayOfMonth))))}(t);case"weekday":return!t}var n}(e.recurrenceType,e.recurrenceProperties))}n.d(t,"a",function(){return H}),n.d(t,"b",function(){return K}),n.d(t,"c",function(){return Q})},4689:function(e,t,n){"use strict";var r=n(0),o=n(6647),i=n(4);var a=function(e){return function(){window.open(e.extension.EndNodeUrl)}};function s(e){switch(e){case 0:case 3:case 1:return 2;case 2:default:return 0}}var c=n(15),u=n(27),l={sets:[{name:"mailbox",maxVersion:"1.7"},{name:"DialogAPI"},{name:"react"}]},d="16.01",f=["progress.gif","agavedefaulticon96x96.png","moe_status_icons.png"],p=["moeerrorux.css"],m="resources/images/osfruntime/",g="resources/styles/osfruntime/";function v(e,t,n){t.getLocalizedCSSFilePath=h(p,Object(c.q)()+g),t.getLocalizedImageFilePath=h(f,Object(c.q)()+m),t._notifyHostError=t._notifyHost,t._hostType="Outlook",t._hostPlatform="Web",t._hostSpecificFileVersion=d,t.getRequirementsChecker().setRequirements(l)}function h(e,t){return function(n){var r=e.filter(function(e){return n==e})[0];return(r=function(e){if(!Object(u.o)())return e;switch(e){case"moeerrorux.css":return"moerroruxrtl.css";default:return e}}(r))?t+r:""}}n(3792);var y=n(3620),b=n(3538),_=n(4070),S=function(e){return function(t,n){if(t){var r=t.ApiParams,o=x(t.MethodData.ControlId),i=t.MethodData.DispatchId;Object(y.m)(e,i,o,r,n)}}},C=function(e,t,n){Object(_.c)(e,n,t)},O=function(e,t,n){n.controlId=x(n.controlId),n.eventDispId=function(e){if(e==_.a.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID)return _.a.DISPLAY_DIALOG_DISPID;return e}(n.eventDispId),Object(_.j)(n,t)},I=[{name:"GetInitialData",isBlocking:!0,action:S},{name:"executeMethod",isBlocking:!1,action:function(e){return function(t,n){if(t){var r=x(t.DdaMethod.ControlId),o=t.DdaMethod.DispatchId;Object(y.m)(e,o,r,t,n)}}}},{name:"ExecuteMethod",isBlocking:!1,action:S}];function A(e){return[{name:"appCommandInvoked",registerAction:OfficeExt.AddinCommandsRuntimeManager.registerEvent,unregisterAction:OfficeExt.AddinCommandsRuntimeManager.unregisterEvent},{name:"dialogMessageReceived",registerAction:C,unregisterAction:O},{name:"dialogNotificationShown",registerAction:C,unregisterAction:O},{name:"olkItemSelectedChanged",registerAction:C,unregisterAction:O},{name:"olkAppointmentTimeChanged",registerAction:C,unregisterAction:O},{name:"olkRecipientsChanged",registerAction:C,unregisterAction:O},{name:"olkRecurrenceChanged",registerAction:C,unregisterAction:O},{name:"olkEnhancedLocationsChanged",registerAction:C,unregisterAction:O},{name:"olkAttachmentsChanged",registerAction:C,unregisterAction:O}]}function T(e,t){I.forEach(function(n){t.registerMethod(n.name,n.action(e),Microsoft.Office.Common.InvokeType.async,n.isBlocking)}),A().forEach(function(e){t.registerEventEx(e.name,e.registerAction,Microsoft.Office.Common.InvokeType.asyncRegisterEvent,e.unregisterAction,Microsoft.Office.Common.InvokeType.asyncUnregisterEvent)})}function E(e,t){I.forEach(function(e){return t.unregisterMethod(e.name)}),A().forEach(function(e){return t.unregisterEvent(e.name)})}function x(e){var t=Object(b.t)().activeDialog;return t&&t.controlId===e?t.parentControlId:e}function P(e,t,n){var r=t.addinCommand,o=t.controlId,i=t.isDialog,a=r.extension.Settings?JSON.parse(r.extension.Settings):{},s=function(e,t){var n=Object(y.n)(t);return JSON.stringify({userType:Object(y.q)(),userId:Object(c.h)(),extensionType:e.extension.TypeString,module:Object(c.b)(),deployment:Object(c.m)(),scenario:Object(b.z)(t),clientVersion:Object(c.i)(),isPinned:n.isAddinPinned(e.extension.Id),react:!0,disableLogging:!1})}(r,e);return{div:n,id:o,marketplaceID:i?o:r.extension.Id,marketplaceVersion:r.extension.Version,settings:a,store:"",storeType:OSF.StoreType.Exchange,hostCustomMessage:s,isDialog:i,isVirtualOsfControl:!1}}var M=n(7616),w=n(5049),R=n(5),k=n(141),D=function(){function e(e,t,n,o,i){var a,s,c=this;this.hostItemIndex=e,this.notifyHost=this.notifyHost.bind(this),this.contextActivationManager=(a=Object(u.g)(),s=this.notifyHost,OSF.AppSpecificSetup._setupFacade=v,new OSF.ContextActivationManager({appName:64,appVersion:d,clientMode:1,appUILocale:a,lcid:a,notifyHost:s,dataLocale:"",hostControl:{},localizedScriptsUrl:OSF.getLocalizedStringsFilePath(),docUrl:""})),this.notifyHostActions=n||{},this.onInsertOsfControlAction=o,this.onDisplayNotificationAction=i,this.manifestCacheProvider=t;var l=this.notifyHostActions[8];this.notifyHostActions[8]=function(e,t){return r.__awaiter(c,void 0,void 0,function(){return r.__generator(this,function(n){return l&&l(e,t),this.notifyHostError(e,t),[2]})})},this.notifyHostActions[23]=this.sendTelemetryEvent.bind(this)}return e.prototype.insertOsfControl=function(e,t){T(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),this.activeOsfControl=e,this.extensionContainer=t,this.manifestCacheProvider.cache(e,Object(u.g)()),this.contextActivationManager.insertOsfControl(P(this.hostItemIndex,this.activeOsfControl,t))},e.prototype.purgeOsfControl=function(){if(this.activeOsfControl&&this.extensionContainer){var e=this.activeOsfControl.controlId;E(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),Object(_.b)(e),this.contextActivationManager.purgeOsfControl(e,!1),this.activeOsfControl=null,this.extensionContainer=null}},e.prototype.onInsertOsfControl=function(){var e=this.activeOsfControl.addinCommand.extension;("User"==e.OriginString||"Organization"==e.OriginString)&&b.k.Context&&b.k.Context.IsInOrgMarketplaceRole&&this.tryDisplayNotification(e.AppStatus,e.LicenseType),this.onInsertOsfControlAction&&this.onInsertOsfControlAction()},e.prototype.notifyAgave=function(e){var t=this.activeOsfControl.controlId;this.contextActivationManager.notifyAgave(t,e)},e.prototype.updateHostItemIndex=function(e){E(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),this.hostItemIndex=e,T(e,this.contextActivationManager._serviceEndPoint)},e.prototype.dispose=function(){this.contextActivationManager.dispose(),this.contextActivationManager=null},e.prototype.notifyHost=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var o,i;return r.__generator(this,function(r){switch(r.label){case 0:return(o=this.notifyHostActions)&&(i=o[t])?[4,i(e,n)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},e.prototype.notifyHostError=function(e,t){var n=this.activeOsfControl.addinCommand;Object(w.e)(!1,n,this.hostItemIndex,Object(b.r)(e),t.errorCode)},e.prototype.sendTelemetryEvent=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var e,n,o,i,a;return r.__generator(this,function(r){switch(r.label){case 0:return Object(R.d)("addin-oteljs")?[4,Object(k.c)(t.telemetryProperties.ariaTenantToken)]:[3,2];case 1:e=r.sent(),n=Object(M.a)(t,[],Date.now()),o=this.activeOsfControl,i=o.addinCommand,a=o.controlId,Object(w.a)(n,i,this.hostItemIndex,a),e.logEvent(n),r.label=2;case 2:return[2]}})})},e.prototype.displayNotification=function(e){this.contextActivationManager.displayNotification(e),this.onDisplayNotificationAction&&this.onDisplayNotificationAction(e)},e.prototype.tryDisplayNotification=function(e,t){var n=this.activeOsfControl,r=n.addinCommand,s=n.controlId;if(e){var c=function(e,t,n){var r="",s="",c=!1,u=!1;switch(n){case"1.0":r=Object(i.a)(o.b),s=Object(i.a)(o.l),c=!0,u=!0;break;case"1.1":r=Object(i.a)(o.c),s=Object(i.a)(o.l),c=!0,u=!0;break;case"1.2":r=Object(i.a)(o.d),s=Object(i.a)(o.l),c=!0,u=!0;break;case"2.0":r=Object(i.a)(o.e),s=Object(i.a)(o.l);break;case"2.1":r=Object(i.a)(o.f),s=Object(i.a)(o.l);break;case"3.0":r=Object(i.a)(o.g),s=Object(i.a)(o.k);break;case"3.1":r=Object(i.a)(o.h),s=Object(i.a)(o.k);break;case"3.2":r=Object(i.a)(o.i),s=Object(i.a)(o.k);break;case"3.3":r=Object(i.a)(o.j),s=Object(i.a)(o.k);break;default:return null}return{infoType:1,id:e,title:Object(i.a)(o.m),description:r,buttonTxt:s,buttonCallback:a(t),detailView:c,displayDeactive:u,reDisplay:!0}}(s,r,e);c&&this.displayNotification(c)}else 1==t&&this.displayNotification(function(e,t){return{infoType:2,id:t,title:Object(i.a)(o.n),description:Object(i.a)(o.o),buttonTxt:Object(i.a)(o.a),buttonCallback:function(){window.open(e.extension.EndNodeUrl)},reDisplay:!0}}(r,s))},e}(),j="permission";var N="DefaultSettings",F="0",L={cache:function(e,t){var n,o,i=e.addinCommand,a=i.extension,s="Preinstalled"===a.TypeString&&2!==a.ConsentState?function(e){var t,n=function(e){switch(e){case 1:return"ReadItem";case 2:return"ReadWriteMailbox";case 3:return"ReadWriteItem";default:return"Restricted"}}(e),r=Object(b.s)().ConsentUrl;if(r.indexOf("?")>0)t=(o=r.split("?"))[0]+"?"+j+"="+n+"&"+o[1];else if(r.indexOf("#")>0){var o;t=(o=r.split("#"))[0]+"?"+j+"="+n+"#"+o[1]}else t=r+"?"+j+"="+n;return t}(a.RequestedCapabilities):i.get_EntryPoint();o=B(s,t),n=function(e,t,n){var o=n._sourceLocations[t];return new OSF.Manifest.Manifest(function(t){t._id=e.get_Id(),t._version=e.extension.Version,t._extensionSettings={},t._displayNames={},t._defaultLocale="",t._displayNames[F]=e.extension.DisplayName,t._extensionSettings[N]=n,t._appDomains=r.__spread(e.extension.AppDomains,[o])})}(i,t,o),OSF.OsfManifestManager.cacheManifest(i.extension.Id,i.extension.Version,n)}},U={cache:function(e,t){var n=e.addinCommand,r=e.controlId,o=e.sourceLocation,i=function(e,t,n,r){var o=OSF.OsfManifestManager.getCachedManifest(e.extension.Id,e.extension.Version),i=OfficeExt.AddinCommandsManifestManager.createManifestForAddinAction(o,r,null,t);return i._extensionSettings={},i._extensionSettings[N]=B(r,n),i}(n,r,t,o);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(i,r,n.extension.Version)}};function B(e,t){var n=new OSF.Manifest.ExtensionSettings;return n._sourceLocations={},n._sourceLocations[t]=e,n}n.d(t,"a",function(){return L}),n.d(t,"b",function(){return U}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return D})},4690:function(e,t,n){"use strict";var r=n(0);function o(e){return"object"==typeof e&&null!==e&&e.hasOwnProperty("Text")&&e.hasOwnProperty("HTML")&&Object.keys(e).every(function(t){return c[e[t]]===t})}var i,a="compose.PREFERRED_EDITORS",s={Text:1,HTML:2},c=((i={})[1]="Text",i[2]="HTML",i[3]="HTML",i),u=null;function l(){return null===u&&(u=function(){try{var e=JSON.parse(localStorage.getItem(a));return o(e)?e:null}catch(e){return null}}()||r.__assign({},s)),r.__assign({},u)}function d(e,t){u[e]=t,localStorage.setItem(a,JSON.stringify(u))}function f(e){null==e.bodyType&&setTimeout(function(){throw new Error("viewState.bodyType was nullish ("+e.bodyType+"). Please report this + what you were doing before it happened.")},0);var t=e.bodyType||"HTML";null==e.preferredEditors&&setTimeout(function(){throw new Error("viewState.preferredEditors was nullish ("+e.preferredEditors+"). Please report this + what you were doing before it happened.")},0);var n=e.preferredEditors||r.__assign({},s);try{return n[t]}catch(e){return setTimeout(function(){throw e},0),2}}var p,m=((p={})[1]={bottomActionBar:!0},p[2]={formattingRibbon:!0,bottomActionBar:!0},p[3]={},p);function g(e){return m[e.preferredEditors[e.bodyType]]}n.d(t,"a",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"e",function(){return d}),n.d(t,"b",function(){return f}),n.d(t,"d",function(){return g})},4694:function(e,t,n){"use strict";var r,o=n(0),i=n(8),a=n(1271),s=n(458),c=n(109),u=n(12),l=n(87),d=n(7),f=n(297),p=n(787),m=n(4026),g=n(1586),v=n(4437),h="Upload",y="SmimeInline",b="Attachment",_="NullAttachmentUrl",S=new RegExp("^file:///[a-zA-Z]:","i"),C=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");!function(e){e[e.Started=0]="Started",e[e.PlaceholderShown=1]="PlaceholderShown"}(r||(r={}));var O={position:2,updateCursor:!0,replaceSelection:!0,insertOnNewLine:!1},I=function(){function e(e,t,n,r,o){var i=this;this.getInlineAttachmentStates=e,this.createAttachments=t,this.deleteInlineAttachments=n,this.convertContentIdToAttachmentUrl=r,this.processInlineImageAfterUploadSuccess=function(e,t,n,r){if(!n&&i.editor){var o=r.attachmentStore.get(e.Id).model,s=Object(f.d)(e.Id),c=s?i.getAttachmentUrlForSmime(o):Object(a.b)(e,1);c?i.replacePlaceholderImage(t,c,o.ContentId,o.Size,o.ContentType,s):m.h.import().then(function(e){return e(b,"",_,"",s?y:h)})}},this.onCopy=function(e){Object(v.b)(e.currentTarget)},this.processNodeDeleted=function(e){for(var t=0;t<e.length;t++){var n=e[t].removedNodes;if(n)for(var r=0;r<n.length;r++){var o=n.item(r),a=i.getPendingPlaceholderForNode(o);a&&(u.c.info("InlineImagePlugin: Pending image placeholder removed from DOM. Deleting the attachment."),i.deleteInlineAttachments(a),i.imageStatusMap[a]&&delete i.imageStatusMap[a])}}i.disconnectMutationObserverIfNecessary()},m.c.importAndExecute(),this.processInlineImageAfterUploadSuccess=Object(d.select)({attachmentStore:function(){return Object(f.b)().attachments}})(this.processInlineImageAfterUploadSuccess)}return e.prototype.getName=function(){return"InlineImage"},e.prototype.onPluginEvent=function(e){if(8==e.eventType)this.processInlineImage(e);else if(6==e.eventType){var t=e.source;"Addins"==t?this.convertAllContentIdToAttachmentUrl():"SetContent"!=t&&"UpgradeCompose"!=t||(this.loadInlineImages(),this.loadExternalImages())}},e.prototype.initialize=function(e){var t=this;this.editor=e,this.imageStatusMap={};var n=this.getInlineAttachmentStates(),r=Object(i.computed)(function(){return n.map(function(e){return e.status})});this.onCopyDisposer=this.editor.addDomEventHandler("copy",this.onCopy),this.observer=new MutationObserver(this.processNodeDeleted),this.autorunDisposer=Object(i.autorun)(function(){r.get().forEach(function(e,r){var o=n[r];o.isHiddenInline||1!=e&&2!=e&&3!=e||(1==e||3==e?t.processInlineImageAfterUploadSuccess(o.attachmentId,o.placeholderId,o.skipProcessInlineImage):t.onImageError(null,o.placeholderId,null),p.t.importAndExecute(o,4))})})},e.prototype.dispose=function(){this.editor=null,this.observer.disconnect(),this.imageStatusMap=null,this.autorunDisposer(),Object(v.a)(),this.onCopyDisposer&&(this.onCopyDisposer(),this.onCopyDisposer=null)},e.prototype.processInlineImageBeforeUpload=function(e,t){return o.__awaiter(this,void 0,void 0,function(){var n,i=this;return o.__generator(this,function(o){switch(o.label){case 0:return this.editor&&this.imageStatusMap?(m.i.import().then(function(e){return e(t.fileType.toString())}),t.fileType!=g.a.Base64InlineImage?[3,1]:(this.imageStatusMap[e]={status:r.PlaceholderShown,placeholder:t.imageNode},[3,4])):[2];case 1:return t.fileType!=g.a.Local?[3,3]:(n=t.fileObject,this.imageStatusMap[e]={status:r.Started},[4,p.n.import()]);case 2:return o.sent()(n,function(n,r){return i.insertPlaceholderImage(e,t.name,n,r)}),[3,4];case 3:m.h.import().then(function(e){return e(t.fileType.toString(),"","UnsupportedFileType","",h)}),o.label=4;case 4:return[2]}})})},e.prototype.insertPlaceholderImage=function(e,t,n,o){if(this.editor){var i=this.imageStatusMap[e];if(i&&i.status==r.Started){this.editor.addUndoSnapshot();var a=this.generatePlaceholderNode(e,t,n,o);this.editor.insertNode(a,O);var s=a.offsetWidth;s<n&&(a.style.height=Math.ceil(s/n*o).toString()),i.placeholder=a,i.status=r.PlaceholderShown;var c=this.getContentEditableParent(a);c&&(u.c.info("InlineImagePlugin: Start observing on content editable div"),this.observer.observe(c,{subtree:!0,childList:!0}))}}},e.prototype.onSmimeUploadSuccess=function(e,t,n){var r=this.getImageElementsByContentId(e);return r.length>0?(r[0].setAttribute("originalSrc","cid:"+n),!0):(u.c.warn("S/MIME onSmimeUploadSuccess : Inline image target element not found for content id : "+e),!1)},e.prototype.onImageLoad=function(e,t){if(this.editor){t.setAttribute("unselectable","on"),t.setAttribute("tabindex","-1"),t.style.msUserSelect="none",t.style.webkitUserSelect="none";var n=this.imageStatusMap[e];if(n&&n.status==r.PlaceholderShown){var o=n.placeholder;this.editor.contains(o)?(o.removeAttribute("data-loadPending"),this.editor.replaceNode(o,t),this.editor.select(t,-3)):this.editor.insertNode(t,O)}else this.editor.insertNode(t,O);Object(l.e)()?setTimeout(function(){m.b.import().then(function(e){return e(t)})},1e3):m.b.import().then(function(e){return e(t)}),delete this.imageStatusMap[e],this.addEditorUndoSnapshotIfNecessary(),this.disconnectMutationObserverIfNecessary(),t.onload=null}},e.prototype.onImageError=function(e,t,n){if(this.editor){var o=this.imageStatusMap[t];if(o&&o.status==r.PlaceholderShown){var i=o.placeholder;i&&this.editor.deleteNode(i)}delete this.imageStatusMap[t],this.addEditorUndoSnapshotIfNecessary()}},e.prototype.processInlineImage=function(e){if(0==e.pasteOption){for(var t=e.fragment.querySelectorAll("img"),n=t.length,r=[],o=0,i=0;i<n;i++){var a=t[i],s=a.getAttribute("src");if(s&&0!==s.indexOf("blob:")&&0!==s.indexOf("webkit-fake-url:")&&!s.match(S)){var c=s.match(C);if(c&&3===c.length){var u={name:"pastedImagebase64"+o+++".png",size:0,type:c[1],dataUri:c[2],imageNode:a,fileType:g.a.Base64InlineImage};r.push(u)}}else a.parentNode.removeChild(a)}r.length>0&&this.createAttachments(r,!0,!1,!1,this.processInlineImageBeforeUpload.bind(this))}else if(2==e.pasteOption){for(;e.fragment.firstChild;)e.fragment.removeChild(e.fragment.firstChild);e.pasteOption=0,this.createAttachmentsForLocalFiles(e.clipboardData.image)}},e.prototype.getImageElementsByContentId=function(e){return this.editor.queryElements('img[originalsrc^="cid:'+e+'"]')},e.prototype.replacePlaceholderImage=function(e,t,n,r,o,i){var a=this;void 0===i&&(i=!1);var s,c=!1;if(i){var u=this.getImageElementsByContentId(n);u.length>0&&(s=u[0],c=!0)}s||((s=this.editor.getDocument().createElement("img")).setAttribute("originalSrc","cid:"+n),s.setAttribute("size",r.toString()),s.setAttribute("contentType",o),s.style.maxWidth="100%"),m.e.import().then(function(n){return n(s,t,i?y:h,c?null:function(t){a.onImageLoad(e,t)},c?null:function(n){a.onImageError(t,e,n)})})},e.prototype.generatePlaceholderNode=function(e,t,n,r){var o=this.editor.getDocument().createElement("div"),i=o.style;return 0!=n&&0!=r||(n=320,r=220),i.display="inline-block",i.maxWidth="100%",i.borderWidth="1px",i.borderStyle="dashed",i.borderColor=Object(c.g)().themePrimary,i.boxSizing="border-box",i.width=n.toString()+"px",i.height=r.toString()+"px",o.title=t,o.contentEditable="false",o.setAttribute("tempid",e),o.setAttribute("data-loadPending","true"),o},e.prototype.createAttachmentsForLocalFiles=function(e){var t=Object(g.e)([e])[0];t.name||(t.name="pastedImagefile.png"),this.createAttachments([t],!0,!1,!1,this.processInlineImageBeforeUpload.bind(this))},e.prototype.addEditorUndoSnapshotIfNecessary=function(){0==Object.keys(this.imageStatusMap).length&&(this.editor.triggerContentChangedEvent("InlineImage"),this.editor.addUndoSnapshot())},e.prototype.disconnectMutationObserverIfNecessary=function(){0===Object.keys(this.imageStatusMap).length&&(u.c.info("InlineImagePlugin: Disconnect mutation observer"),this.observer.disconnect())},e.prototype.getContentEditableParent=function(e){for(;e;){if("true"==e.contentEditable)return e;e=e.parentElement}return null},e.prototype.getPendingPlaceholderForNode=function(e){if("div"==e.nodeName.toLowerCase()&&e.hasAttribute("tempid")&&e.hasAttribute("data-loadPending"))return e.getAttribute("tempid");if(e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++){var n=this.getPendingPlaceholderForNode(e.childNodes[t]);if(n)return n}return null},e.prototype.convertAllContentIdToAttachmentUrl=function(){var e=this;this.editor.queryElements('img[src^="cid:"]',function(t){var n=t.src.substr("cid:".length),r=e.convertContentIdToAttachmentUrl(n);r&&(t.setAttribute("originalsrc","cid:"+r.contentId),m.e.import().then(function(e){return e(t,r.url,"MoveFromAttachmentWell")}))})},e.prototype.loadInlineImages=function(){this.editor.queryElements("img["+s.a+"]",function(e){m.d.import().then(function(t){return t(e,"Compose",!1)})})},e.prototype.loadExternalImages=function(){this.editor.queryElements("img[data-imageproxyendpoint]",function(e){m.g.import().then(function(t){return t(e,"Compose")})})},e.prototype.getAttachmentUrlForSmime=function(e){var t=e.Content;return"data:"+e.ContentType+";base64,"+t},e}();var A=n(3),T=n(3568);n.d(t,"b",function(){return x}),n.d(t,"c",function(){return P}),n.d(t,"a",function(){return I});var E=new A.c(function(){return n.e(252).then(n.bind(null,11841))}),x=Object(T.a)(E,function(e){return e.InlineImageResizePlugin},"InlineImageResize",function(e,t){if(5==e.eventType){var n=e.rawEvent.target;if(null!=n&&"IMG"==n.nodeName)return!0}return!1}),P=new A.b(E,function(e){return e.getSelectedImage})},47:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.TestFeature=1]="TestFeature",e[e.SmartSuggestions=2]="SmartSuggestions",e[e.DiverseEmojis=4]="DiverseEmojis",e[e.SurfaceActions=5]="SurfaceActions",e[e.SkypeNotifications=6]="SkypeNotifications",e[e.WebPushNotifications=7]="WebPushNotifications",e[e.Confetti=8]="Confetti",e[e.GdprAdsPrefs=9]="GdprAdsPrefs",e[e.CalendarSurfaceAddins=10]="CalendarSurfaceAddins",e[e.ExternalImages=11]="ExternalImages",e[e.EventCapture=12]="EventCapture",e[e.LinkedInBindingDismissed=13]="LinkedInBindingDismissed",e[e.Translation=14]="Translation",e[e.CalendarSurfaceOptions=15]="CalendarSurfaceOptions",e[e.TxpEventNotifications=16]="TxpEventNotifications",e[e.MentionEventNotifications=17]="MentionEventNotifications",e[e.ComposeAssistance=18]="ComposeAssistance"}(r||(r={}))},4701:function(e,t,n){"use strict";var r=n(3),o=n(3568);n.d(t,"a",function(){return a});var i=new r.c(function(){return Promise.all([n.e(4),n.e(8),n.e(10),n.e(11),n.e(242)]).then(n.bind(null,11698))}),a=Object(o.a)(i,function(e){return e.LinkPlugin},"Link",function(e){return 6===e.eventType||7===e.eventType||0===e.eventType||1===e.eventType},!0)},4702:function(e,t,n){"use strict";var r=n(4204);var o=n(3),i=n(3568);n.d(t,"a",function(){return s});var a=new o.c(function(){return Promise.all([n.e(34),n.e(38),n.e(181)]).then(n.bind(null,11734))}),s=Object(i.a)(a,function(e){return e.EmojiPickerPlugin},"EmojiPicker",function(e,t){return 1===e.eventType&&e.rawEvent.key==r.c})},4703:function(e,t,n){"use strict";var r=function(){function e(){}return e.prototype.getName=function(){return"AddIn"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.plainTextEditor=null},e.prototype.isPlainTextEditor=function(){return!!this.plainTextEditor},e.prototype.setPlainTextEditor=function(e){this.plainTextEditor=e},e.prototype.updateContent=function(e,t){if(this.editor.getContent(!1)!=e){this.editor.setContent("");var n=this.createNodeFromContent(e);this.insertNode(n,{position:0,updateCursor:!0,replaceSelection:!1,insertOnNewLine:!1}),this.editor.select(n,-3),this.triggerContentChangedByAddinEvent(),this.editor.addUndoSnapshot()}},e.prototype.getContent=function(){return this.isPlainTextEditor()?this.plainTextEditor.value:this.editor.getContent()},e.prototype.getSelectedData=function(){if(this.isPlainTextEditor()){var e=this.plainTextEditor.selectionStart,t=this.plainTextEditor.selectionEnd;return{data:this.plainTextEditor.value.substring(e,t),sourceProperty:"body",startPosition:e,endPosition:t}}var n=this.editor.getSelectionRange(),r=n.cloneContents(),o=document.createElement("div");return o.appendChild(r),{data:o.innerHTML.length>0?o.innerHTML:null,sourceProperty:"body",startPosition:n.startOffset,endPosition:n.endOffset}},e.prototype.prependContent=function(e){if(this.isPlainTextEditor())this.plainTextEditor.value=e+this.plainTextEditor.value;else{var t=this.createNodeFromContent(e);this.insertNode(t,{position:0,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1})}},e.prototype.setSelectedData=function(e){if(this.isPlainTextEditor()){var t=this.plainTextEditor.selectionStart,n=this.plainTextEditor.selectionEnd;this.plainTextEditor.value=this.plainTextEditor.value.substring(0,t)+e+this.plainTextEditor.value.substring(n+1)}else{var r=this.createNodeFromContent(e),o=this.editor.getSelectionRange()?2:1;this.insertNode(r,{position:o,updateCursor:!0,replaceSelection:!0,insertOnNewLine:!1})}},e.prototype.insertNode=function(e,t){this.editor.addUndoSnapshot(),this.editor.focus(),this.triggerContentChangedByAddinEvent(),this.editor.insertNode(e,t),this.triggerContentChangedByAddinEvent(),this.editor.addUndoSnapshot()},e.prototype.createNodeFromContent=function(e){var t=this.editor.getDocument().createElement("span");return t.innerHTML=e,t},e.prototype.triggerContentChangedByAddinEvent=function(){this.editor.triggerContentChangedEvent("Addins")},e}();n.d(t,"a",function(){return r})},4724:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(9);function o(e,t){return e==t||e&&t&&e.toLowerCase()==t.toLowerCase()}function i(e){return e&&o(e.EmailAddress,Object(r.a)().SessionSettings.UserEmailAddress)}},4725:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(4115);function o(e){var t=document.createElement("div");e?t.innerHTML=e:t.appendChild(document.createElement("br"));var n=t.style,o=Object(r.a)();return o.fontFamily&&(n.fontFamily=o.fontFamily),o.fontSize&&(n.fontSize=o.fontSize),o.textColor&&(n.color=o.textColor),o.bold&&(n.fontWeight="bold"),o.italic&&(n.fontStyle="italic"),o.underline&&(n.textDecoration="underline"),t.outerHTML}t.b=function(){return o()}},4726:function(e,t,n){"use strict";function r(e){return{toRecipients:e.toRecipientWell?e.toRecipientWell.recipients:[],ccRecipients:e.ccRecipientWell?e.ccRecipientWell.recipients:[],bccRecipients:e.bccRecipientWell?e.bccRecipientWell.recipients:[]}}n.d(t,"a",function(){return r})},4727:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(5),o=n(27);function i(){var e=Object(o.g)();return Object(r.d)("mc-smartCompose")&&("en-US"===e||"en-CA"===e||"en-AU"===e||"en-GB"===e||"en-NZ"===e)}},4728:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var r=n(3),o=n(3568),i=new r.c(function(){return n.e(373).then(n.bind(null,6457))}),a=Object(o.a)(i,function(e){return e.default},"SmartCompose",null),s=new r.a(i,function(e){return e.updateRecipientsForSmartCompose})},4773:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(3538);function o(e){var t=Object(r.B)("NonPersistent");!t||e&&t.hostItemIndex!==e||Object(r.db)("NonPersistent")}},4774:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r={};function o(){return r}},4775:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});var r=n(6165),o=n(4774),i=n(6133);function a(e,t){s(Object(r.a)(e),t)}function s(e,t){var n=t?t.addinId:"",r=t?t.commandId:"";Object(o.a)()[e]=t||void 0,Object(i.b)(e,n,r)}},4776:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(4565);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("InstallExtension",e,t)}},4777:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),o=n(2),i=n(4141),a=n(4689),s=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.refCallback=function(e){e&&(r.extensionContainer=e,r.osfControlAdapter.insertOsfControl(r.props,r.extensionContainer))},r.handlerContainerOnFocus=function(){r.notifyAgave(11)},r.osfControlAdapter=r.props.osfControlAdapter?r.props.osfControlAdapter:new a.c(t.hostItemIndex,t.manifestCacheProvider,t.notifyHostActions,t.onInsertOsfControl,t.onDisplayNotification),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.osfControlAdapter.onInsertOsfControl()},t.prototype.componentWillReceiveProps=function(e){Object(i.c)()&&this.isNewHostItemIndex(e)&&this.osfControlAdapter.updateHostItemIndex(e.hostItemIndex)},t.prototype.shouldComponentUpdate=function(e){return this.isNewOsfControl(e)},t.prototype.componentWillUpdate=function(){this.osfControlAdapter.purgeOsfControl()},t.prototype.componentDidUpdate=function(){this.osfControlAdapter.onInsertOsfControl()},t.prototype.componentWillUnmount=function(){this.osfControlAdapter.purgeOsfControl(),this.osfControlAdapter.dispose(),this.osfControlAdapter=null},t.prototype.notifyAgave=function(e){this.osfControlAdapter.notifyAgave(e)},t.prototype.isNewOsfControl=function(e){return this.props.controlId!=e.controlId},t.prototype.isNewHostItemIndex=function(e){return this.props.hostItemIndex!=e.hostItemIndex},t.prototype.render=function(){return this.extensionContainer&&this.osfControlAdapter.insertOsfControl(this.props,this.extensionContainer),o.createElement("div",{tabIndex:0,ref:this.refCallback,style:this.props.style,className:this.props.className,onFocus:this.handlerContainerOnFocus})},t}(o.Component)},4815:function(e,t,n){"use strict";function r(e){if(e.smimeBccForkingMode){var t=e.smimeBccForkingMode;return 2===t||3===t}return!1}n.d(t,"a",function(){return r})},4822:function(e,t,n){"use strict";function r(){return{maxActionBatchSize:10,entityType:1,entityScenarioName:"FindPeople_react",hasSessionStarted:!1,isSessionPaused:!1,entityFeedbackEntries:[],clientSessionId:"",clientVersion:"1.0",clientId:1,entrySequenceNumber:0}}n.d(t,"a",function(){return r})},4826:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"b",function(){return c});var r=n(0),o=n(45),i=n(276),a={width:1095,height:640};function s(e,t,n){if(e){var i=Object(o.e)();c(r.__assign({ItemId:r.__assign({mailboxInfo:i},e)},t),n,0)}}function c(e,t,n){Object(i.c)("calendar","compose",{event:e,composeEntrySource:t},a)}},4828:function(e,t,n){"use strict";var r=n(7);t.a=Object(r.action)("setIsDirty")(function(e){e.isDirty=!0})},4829:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade","errorMessageExceededHourlyMessageLimit","errorMessageExceededMaxRecipientLimit","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimit","errorMessageExceededMessageLimitShowTierUpgrade","errorMessageMessageSubmissionBlocked","errorMessageMessageBlocked","errorMessageTimeout","errorMessageThrottled","errorMessageTransientError","errorMessageItemNoLongerExistToSave","errorMessageItemNoLongerExistToSend","errorMessageQuotaExceededMessageCanNotBeSaved","errorMessageQuotaExceededMessageCanNotBeSent","errorMessageSubmissionQuotaExceededMessageCanNotBeSent","errorMessageMessageCanNotBeSaved","errorMessageMessageCanNotBeSent","errorMessageNoPermissionToSendAs","errorMessageNoRecipentsMailCanNotBeSend","errorMessageInvalidSenderMailCanNotBeSend","warningMessageMaxRecipientsExceed","warningMessageNoPermissionToPerformAction","error500","error503","errorFailedToFetch","errorSessionTimeout","errorMailboxStoreUnavailable","errorMessageErrorWithDetail","smimeEncodeError","smimeBccForkingFailedError"]},4830:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(230),o=n.n(r);function i(e){return e?o()({Id:e.Id,ChangeKey:e.ChangeKey}):null}},4831:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="msip_labels"},4832:function(e,t,n){"use strict";n.d(t,"a",function(){return _});var r=n(4245),o=n.n(r),i=n(2552),a=n.n(i),s=n(385),c=n.n(s),u=n(57),l=n.n(u),d=n(658),f=n(29),p=n(108),m=n.n(p),g=n(272),v=n.n(g),h=n(1339),y=n(9),b=n(5);function _(e,t,n,r,i,s,u,p,g){var _,S=function(e,t,n,r,o,i,s,u,f){var p="PostItem:#Exchange"==e.__type?"newPost":"newMail",g=s?v()({BaseFolderId:m()({Id:s})}):null,h=a()({ClientSupportsIrm:!0,ComposeOperation:p,MessageDisposition:n?"SendAndSaveCopy":"SaveOnly",OutboundCharset:"AutoDetect",Items:[e],TimeFormat:r,SendOnNotFoundError:!0,RemoteExecute:u,ItemShape:c()({BaseShape:"IdOnly",AdditionalProperties:[l()({FieldURI:"ItemLastModifiedTime"})]}),SavedItemFolderId:g,SuppressMarkAsReadOnReplyOrForward:Object(b.d)("tri-suppressMarkReadBehaviorOnRF")&&f});return i&&i.IsOwner&&(h.ComplianceId=i.RmsTemplateId?i.RmsTemplateId.toUpperCase():"0"),n?o&&(h.ItemShape.ReturnOnlyInternetMessageId=!0):(h.ItemShape=Object(d.b)(t),h.ShapeName="MailCompose"),h}(e,t,n,r,i,s,u,p,g);if("PostItem:#Exchange"==e.__type){var C=h.b.folderTable.get(u);_=Object(h.a)(null!=C.ReplicaList?C.ReplicaList[0]:Object(y.a)().SessionSettings.DefaultPublicFolderMailbox)}return o()({Header:Object(f.getJsonRequestHeader)(),Body:S},_).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}},4833:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(658),o=n(5249),i=n.n(o),a=n(385),s=n.n(a),c=n(57),u=n.n(c),l=n(5250),d=n.n(l),f=n(29);function p(e,t,n,o,a,c){var l=function(e,t,n,o,a,c){var l=i()({ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:o?"SendAndSaveCopy":"SaveOnly",OutboundCharset:"AutoDetect",Items:[t],TimeFormat:a,ItemShape:s()({BaseShape:"IdOnly",AdditionalProperties:[u()({FieldURI:"ItemLastModifiedTime"})]})});return o?c&&(l.ItemShape.ReturnOnlyInternetMessageId=!0):(l.ItemShape=Object(r.b)(n),l.ShapeName="MailCompose"),l.GroupSmtpAddress=e,l}(e,t,n,o,a,c);return d()({Header:Object(f.getJsonRequestHeader)(),Body:l}).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}},4834:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n(1513),o=n.n(r),i=n(226),a=n.n(i),s=n(2532),c=n.n(s),u=n(1913),l=n.n(u);function d(e){return l()({Path:a()(e.ExtendedFieldURI),Item:c()({ExtendedProperty:[o()(e)]})})}},4898:function(e,t,n){"use strict";var r=n(0),o=n(3671),i=n(3703),a=n(4635),s=n(2618),c=n(1589),u=n(562),l=n(18),d=n(3910),f=n(1),p=Object(f.mutatorAction)("removeAppendOnSend",function(e){e.appendOnSend=[]}),m=function(){function e(e){this.viewState=e,this.hiddenAttachmentsHtml=""}return e.prototype.getName=function(){return"ContentOperation"},e.prototype.initialize=function(e){this.editor=e,this.saveOnDispose=!0},e.prototype.dispose=function(){this.saveOnDispose&&(this.cursorSnapshot={},this.editor&&this.editor.getSelectionRange()&&(this.cursorSnapshot.htmlSnapshotWithCursorMarker=this.editor.getContent(!1,!0)),this.updateContentToViewState(),this.cursorSnapshot.snapshot=this.viewState.content,Object(c.c)(this.viewState)&&!this.viewState.subjectPickerViewState.isLoadingConversation&&Object(i.b)(this.viewState,!0)),this.saveOnDispose=!1,this.editor=null},e.prototype.hasCursorSnapshot=function(){return this.cursorSnapshot&&this.cursorSnapshot.htmlSnapshotWithCursorMarker},e.prototype.focusToEditor=function(){this.editor?(this.editor.focus(),this.hasCursorSnapshot()&&this.cursorSnapshot.snapshot==this.viewState.content&&(this.editor.setContent(this.cursorSnapshot.htmlSnapshotWithCursorMarker,void 0,this.editor.isDarkMode()),this.editor.triggerContentChangedEvent("RestoreCursor"))):this.plainTextEditor&&(this.plainTextEditor.focus(),this.plainTextEditor.selectionStart=0,this.plainTextEditor.selectionEnd=0),this.cursorSnapshot=null},e.prototype.stopSaveOnDispose=function(){this.saveOnDispose=!1},e.prototype.updateContentToViewState=function(){var e=this.editor?this.editor.getContent(!0):this.plainTextEditor?this.plainTextEditor.value:null;null!=e&&Object(d.a)(this.viewState,e)},e.prototype.setPlainTextEditor=function(e){this.plainTextEditor=e},e.prototype.onPluginEvent=function(e){if(9===e.eventType){var t=this.editor.queryElements("#OwaReferenceAttachments")[0],n=this.editor.queryElements("#OwaReferenceAttachmentsEnd")[0];t&&!t.previousElementSibling&&n&&n.previousElementSibling==t&&(this.hiddenAttachmentsHtml=(t?t.outerHTML:"")+(n?n.outerHTML:""),this.editor.deleteNode(t),this.editor.deleteNode(n))}else if(7===e.eventType)e.content=this.hiddenAttachmentsHtml+e.content;else if(6===e.eventType){"SetContent"===e.source&&this.replyWithTextElementId&&this.moveCaretBelowHtmlElement(this.replyWithTextElementId)}},e.prototype.insertSignature=function(e){var t=Object(a.a)(e,Object(s.a)(e));if("HTML"==e&&this.editor)this.editor.focus(),this.editor.addUndoSnapshot(),this.editor.insertContent(t,{position:2,updateCursor:!1,replaceSelection:!0,insertOnNewLine:!0}),this.editor.triggerContentChangedEvent("Signature"),this.editor.addUndoSnapshot();else if("Text"==e&&this.plainTextEditor){var n=this.plainTextEditor.selectionEnd,r=this.plainTextEditor.value.substr(0,n)+t+this.plainTextEditor.value.substr(n);this.plainTextEditor.value=r,this.updateContentToViewState()}},e.prototype.insertAppendOnSend=function(e){var t=this,n=this.viewState.appendOnSend,r="",o="MailComposeAppendOnSend";if("HTML"==e&&this.editor){if(n.map(function(e){var n=e.txt;e.typ===u.d.Text&&(n=t.escapeAppendOnSendForHtml(n)),r+=n}),r.length>0){var i=this.editor.queryElements("div#appendonsend");if(0==i.length)Object(l.o)(o,["End","HTML"]),this.editor.insertContent(r,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!0});else for(var a=0;a<i.length;a++){var s=i[a];if("appendonsend"===s.id&&""===s.innerHTML){Object(l.o)(o,["Div","HTML"]),s.innerHTML=r;break}}}}else if("Text"==e&&this.plainTextEditor&&(n.map(function(e){e.typ!==u.d.Html&&(r+="\n"+e.txt)}),r.length>0)){Object(l.o)(o,["End","Text"]);var c=this.plainTextEditor.value+r;this.plainTextEditor.value=c}p(this.viewState)},e.prototype.escapeAppendOnSendForHtml=function(e){return e=(e=(e=(e=(e=(e=e.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/"/g,"&quot;")).replace(/'/g,"&#39;")).replace(/\//g,"&#x2F;")},e.prototype.moveCaretBelowHtmlElement=function(e){this.editor?this.placeCursorAfterElement(e):this.replyWithTextElementId=e},e.prototype.isEmpty=function(){return this.editor&&this.editor.isEmpty()},e.prototype.removeInlineImage=function(){var e=this;this.editor.queryElements("img",function(t){e.editor.deleteNode(t)})},e.prototype.getTextContent=function(){return this.editor&&this.editor.getTextContent()},e.prototype.insertContentIntoEditor=function(e,t,n,r){var o="HTML"==this.viewState.bodyType;if(o&&this.editor)r&&this.editor.focus(),this.editor.addUndoSnapshot(),this.editor.insertContent(e,{insertOnNewLine:n,position:n?1:2,replaceSelection:!1,updateCursor:!n}),this.editor.triggerContentChangedEvent(t),this.editor.addUndoSnapshot();else if(!o&&this.plainTextEditor){var i=this.plainTextEditor.selectionStart,a=this.plainTextEditor.selectionEnd;n?(this.plainTextEditor.value+=e,this.plainTextEditor.selectionStart=i,this.plainTextEditor.selectionEnd=a):this.plainTextEditor.value=this.plainTextEditor.value.substr(0,i)+e+this.plainTextEditor.value.substr(a)}r&&o||this.updateContentToViewState()},e.prototype.placeCursorAfterElement=function(e){var t=this.editor.getDocument().getElementById(e);t&&(this.editor.focus(),this.editor.select(t,-3))},e}(),g=n(4519),v=n(4637),h=n(4982),y=n(4234),b=n(3731),_=n(787),S=n(238);var C=n(1482);var O=n(3829),I=n(4064),A=n(4727),T=n(4703),E=n(3568),x=n(3),P=new x.c(function(){return Promise.all([n.e(3),n.e(11),n.e(34),n.e(475),n.e(160)]).then(n.bind(null,11678))}),M=Object(E.a)(P,function(e){return e.CortanaPickerPlugin},"CortanaCompose",function(e){return 1===e.eventType&&"/"==e.rawEvent.key}),w=n(4429),R=n(4071),k=n(4702),D=n(4701),j=n(4638);var N=new x.c(function(){return Promise.all([n.e(4),n.e(8),n.e(10),n.e(11),n.e(242)]).then(n.bind(null,11712))}),F=Object(E.a)(N,function(e){return e.AtMentionPickerPlugin},"AtMentionsPicker",function(e,t){if(1===e.eventType){var n=e.rawEvent;return n.key==j.e||"2"==n.key&&n.shiftKey}return!1}),L=n(4542),U=n(3725),B=n(4983);var H=new x.c(function(){return n.e(375).then(n.bind(null,11705))}),V=Object(E.a)(H,function(e){return e.default},"SmartSuggestion",function(e,t){if(2===e.eventType){var n=e.rawEvent;if(n.which===B.f||n.which===B.m)return!0}return!1}),W=n(4728),G=n(4180),z=n(5);n(3782);var q=new x.c(function(){return n.e(264).then(n.bind(null,11905))}),K=Object(E.a)(q,function(e){return e.default},"LinkPreview",function(e,t){if(6===e.eventType){var n=e;if(("AutoLink"===n.source||"SetContent"===n.source)&&t.getContent(!1).toLowerCase().indexOf("<a ")>=0)return!0}return!1}),X=n(4207),J=n(4633),Q=n(9),Y=n(4694),Z=n(4984);function $(e){return function(t){!function(e,t){if(t.attachmentWell&&t.attachmentWell.inlineAttachments){for(var n=null,o=0;o<t.attachmentWell.inlineAttachments.length;++o){var i=t.attachmentWell.inlineAttachments[o];if(i.placeholderId==e&&0===i.status){n=i;break}}if(n){var a=r.__assign({},t.itemId,{mailboxInfo:Object(S.a)()});_.h.importAndExecute(t.attachmentWell,n,a,Object(b.a)(t),Object(b.c)(t))}}}(t,e)}}function ee(e){return function(){return e.subject}}function te(e,t){var n=Object(R.a)(e.docking),i=n.getScrollAdapter(),a=new Y.a(function(e){return function(){return e.attachmentWell.inlineAttachments}}(e),function(e){return function(t,n,o,i,a){var s={isInline:n,isHiddenInline:i},c=o?r.__assign({},s,{shouldShare:!0}):r.__assign({},s,{shouldShare:!1});Object(y.a)(t,e,c,a)}}(e),$(e),function(e){return function(t){var n,o;if(e.attachmentWell&&e.attachmentWell.inlineAttachments)try{for(var i=r.__values(e.attachmentWell.inlineAttachments),a=i.next();!a.done;a=i.next()){var s=a.value,c=Object(C.a)(s.attachmentId);if(c&&c.thumbnailImage&&c.model&&(c.model.ContentId==t||c.model.Name==t))return{url:c.thumbnailImage.url,contentId:c.model.ContentId}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return null}}(e)),s=function(e){return function(){return Object(O.c)(e)}},c=Object(Q.a)().SessionSettings.IsUserCultureRightToLeft,u={undo:t,dockingPlugin:n,ribbonPlugin:new U.a(e.ribbon,Y.c.import()),inlineImagePlugin:a,inlineImageResizePlugin:new Y.b(i),mentionsPickerPlugin:new F(e.atMentions,i,e.toRecipientWell,function(e){return function(){e.showCompactRecipientWell&&Object(v.a)(e)}}(e),Object(h.a)(e),function(e){return function(){return Object(J.a)(Object(O.c)(e))}}(e)),cortanaComposePlugin:Object(z.d)("mc-cortanaCompose")&&new M(i),emojiPickerPlugin:new k.a(e.emojiPicker,i,!0),contentOperationPlugin:new m(e),smartSuggestionsPlugin:Object(z.d)("mc-smartSuggestions")?new V(s(e)):null,linkPreviewPlugin:new K(i),addinPlugin:Object(z.d)("rp-addins")?new T.a:null,pasteOptionPlugin:new L.a(e.pasteOption,i,c),tableEdit:new G.b(e.tableEdit),accCheckerPlugin:new w.b(e.accChecker),linkPlugin:Object(z.d)("cmp-prague")?null:new D.a(e.attachmentWell,i,s(e),Object(I.a)(e.toRecipientWell)),smartComposePlugin:Object(A.a)()?new W.a(s(e),ee(e),e.operation,e.composeFeedbackViewState):null,praguePlugin:Object(z.d)("cmp-prague")?new X.a:null,dictationPlugin:Object(z.d)("cmp-dictation")?new Z.a:null};return Object(o.a)(e,u),Object(g.a)(e),u}n.d(t,"a",function(){return te})},4913:function(e,t,n){"use strict";var r=n(3);function o(){return{shouldShowFeedbackRibbon:!1,feedbackRibbonDetails:{ribbonMessage:void 0,subFeature:void 0,thankYouMessage:void 0}}}n.d(t,"a",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"b",function(){return o});var i=new r.c(function(){return n.e(153).then(n.bind(null,11868))}),a=Object(r.d)(i,function(e){return e.ComposeFeedback}),s=new r.a(i,function(e){return e.showFeedbackRibbon})},4915:function(e,t,n){"use strict";var r=n(0),o=n(1342),i=n(1308),a=n(6614),s=n.n(a),c=n(6616),u=n.n(c),l=n(29);function d(e,t,n){var r=u()({ItemId:t,Id:e,Notifications:n});return s()({Header:Object(l.getJsonRequestHeader)(),Body:r})}var f=n(3543),p=n(1329);function m(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,s,c;return r.__generator(this,function(r){switch(r.label){case 0:if(n=Object(f.c)(e),!(a={Id:n.getItemId()}).Id)throw new o.a(i.b.CannotPersistPropertyInUnsavedDraftError);return s=Object(p.d)(e,t),c=Object.keys(s).map(function(e){var t=s[e];return{Key:t.Key,Type:t.Type,Message:t.Message,Icon:t.Icon}}),[4,d(t,a,c).catch(function(e){throw new o.a(i.b.PersistedNotificationArraySaveError)})];case 1:return r.sent(),[2]}})})}n.d(t,"a",function(){return m})},4933:function(e,t,n){"use strict";var r=n(5047);n.d(t,"a",function(){return r.a});var o=n(5069);n.d(t,"b",function(){return o.a})},494:function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function o(e){var t=r(e);return t?t.replace(".",""):null}var i=n(1315),a=n(4);function s(e){var t;return e>=1073741824?(e/=1073741824,t=Object(a.a)(i.b)):e>=1048576?(e/=1048576,t=Object(a.a)(i.d)):e>=1024?(e/=1024,t=Object(a.a)(i.c)):t=Object(a.a)(i.a),Object(a.b)(t,Math.round(e))}function c(e){return e&&(t=e,(n=l.exec(t))&&n.length>1&&u[n[1].toLowerCase()]);var t,n}var u={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},l=/^\s*([^;\s]*)(?:;|\s|$)/;var d=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"];function f(e,t){var n=r(e)||c(t);return!!n&&d.indexOf(n.toLowerCase())>=0}var p=n(5),m=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function g(e){if(!Object(p.d)("doc-attachment-documentThumbnail"))return!1;var t=r(e);return!!t&&m.indexOf(t.toLowerCase())>=0}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return g})},4973:function(e,t,n){"use strict";var r=n(7),o=n(1725),i=Object(r.action)("removeInfoBarMessageInReadingPane")(function(e,t){Object(o.a)(e,t,e.itemId)});t.a=i},4977:function(e,t,n){"use strict";function r(e,t){if(e){if(e.indexOf("500")>=0)return"error500";if(e.indexOf("503")>=0)return"error503";if(e.indexOf("Failed to fetch")>=0)return"errorFailedToFetch"}switch(e){case"ErrorSessionTimeout":return"errorSessionTimeout";case"ErrorMailboxStoreUnavaiable":return"errorMailboxStoreUnavailable";case"ErrorSendAsDenied":return"errorMessageNoPermissionToSendAs";case"ErrorRightsManagementPermanentException":return null;case"ErrorSubmissionQuotaExceeded":return"errorMessageSubmissionQuotaExceededMessageCanNotBeSent";case"ErrorAccountSuspend":return"errorMessageAccountSuspend";case"ErrorExceededMaxRecipientLimit":return"errorMessageExceededMaxRecipientLimit";case"ErrorExceededMessageLimit":return"errorMessageExceededMessageLimit";case"ErrorExceededHourlyMessageLimit":return"errorMessageExceededHourlyMessageLimit";case"ErrorMessageBlocked":return"errorMessageMessageBlocked";case"ErrorMessageSubmissionBlocked":return"errorMessageMessageSubmissionBlocked";case"ErrorAccountSuspendShowTierUpgrade":return"errorMessageAccountSuspendShowTierUpgrade";case"ErrorExceededMaxRecipientLimitShowTierUpgrade":return"errorMessageExceededMaxRecipientLimitShowTierUpgrade";case"ErrorExceededMessageLimitShowTierUpgrade":return"errorMessageExceededMessageLimitShowTierUpgrade";case"ErrorMessageTimeout":return"errorMessageTimeout";case"ErrorMessageThrottled":return"errorMessageThrottled";case"ErrorMessageTransientError":return"errorMessageTransientError";case"ErrorItemNotFound":return t?"errorMessageItemNoLongerExistToSend":"errorMessageItemNoLongerExistToSave";case"ErrorAccessDenied":return"warningMessageNoPermissionToPerformAction";case"SmimeEncodeError":return"smimeEncodeError";case"ErrorQuotaExceeded":return t?"errorMessageQuotaExceededMessageCanNotBeSent":"errorMessageQuotaExceededMessageCanNotBeSaved";default:return t?"errorMessageMessageCanNotBeSent":"errorMessageMessageCanNotBeSaved"}}n.d(t,"a",function(){return r})},4978:function(e,t,n){"use strict";n.d(t,"d",function(){return m}),n.d(t,"c",function(){return g}),n.d(t,"b",function(){return y}),n.d(t,"a",function(){return b});var r=n(0),o=n(5247),i=n(4),a=n(3716),s=n(3703),c=n(4979),u=n(5),l=n(1184),d="",f="",p="/owa/owahipcontrol.aspx?compose=1";function m(e,t){if(e){e.WasclUpgradeToPremiumUrl&&(d=e.WasclUpgradeToPremiumUrl),e.AccountRecoveryFlowUrl&&(f=e.AccountRecoveryFlowUrl);var n=e.ResponseMessages&&e.ResponseMessages.Items?e.ResponseMessages.Items[0]:null;!n||"ErrorExceededMessageLimit"!=n.ResponseCode&&"ErrorExceededHourlyMessageLimit"!=n.ResponseCode&&"ErrorExceededMessageLimitShowTierUpgrade"!=n.ResponseCode||Object(s.b)(t,!0)}}function g(e){return{text:Object(i.a)(o.a),action:function(){Object(a.a)(e,["errorMessageExceededMessageLimit","errorMessageExceededMaxRecipientLimit"]),window.open(d)}}}var v=null;function h(e){Object(a.a)(e,["errorMessageMessageSubmissionBlocked","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimitShowTierUpgrade"])}function y(e){return{text:Object(i.a)(o.b),action:function(){var t;if(Object(u.d)("cmp-hipCheckModal")){if(null!==v)return;t=r.__read(Object(l.a)(c.a),1),(v=t[0]).then(function(t){var n=t.success;v=null,n&&h(e)},function(e){v=null})}else h(e),window.open(p)}}}function b(e){return{text:Object(i.a)(o.b),action:function(){Object(a.a)(e,["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade"]),window.open(f)}}}},4979:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(3),o=new r.c(function(){return Promise.all([n.e(503),n.e(311)]).then(n.bind(null,6470))}),i=Object(r.d)(o,function(e){return e.HipCheckModal})},4980:function(e,t,n){"use strict";var r;!function(e){e.LTR="ltr",e.RTL="rtl"}(r||(r={})),t.a=r},4981:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(134),o=n(5);function i(){return Object(o.d)("cmp-darkMode")&&Object(r.c)()}},4982:function(e,t,n){"use strict";function r(e){var t=e.IRMData;return!t||t.IsOwner||t.ForwardAllowed}n.d(t,"a",function(){return r})},4983:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"f",function(){return o}),n.d(t,"m",function(){return i}),n.d(t,"e",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"g",function(){return u}),n.d(t,"h",function(){return l}),n.d(t,"i",function(){return d}),n.d(t,"j",function(){return f}),n.d(t,"l",function(){return p}),n.d(t,"n",function(){return m}),n.d(t,"k",function(){return g}),n.d(t,"a",function(){return v});var r=8,o=13,i=32,a=46,s=48,c=57,u=65,l=90,d=96,f=105,p=186,m=192,g=219,v=222},4984:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(3),o=n(3568),i=n(4521);n.d(t,"b",function(){return i.a});var a=new r.c(function(){return Promise.all([n.e(480),n.e(173)]).then(n.bind(null,6477))}),s=Object(o.a)(a,function(e){return e.DictationPlugin},"Dictation",null)},4985:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ReplyAllToItem:#Exchange"},e)}},4986:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ReplyToItem:#Exchange"},e)}},4989:function(e,t,n){"use strict";var r=n(1633),o=n(7);t.a=Object(o.action)("showCcWell")(function(e){e.ccRecipientWell||(e.ccRecipientWell=Object(r.a)(e.findPeopleFeedbackManager,[]))})},4990:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),o=n(562),i=n(1586),a=n(494);function s(e){var t,n,s=[];try{for(var c=r.__values(e),u=c.next();!u.done;u=c.next()){var l=u.value,d=null;l.attachmentType==o.k.Item?d={fileType:i.a.MailItem,name:l.name,size:l.size,itemId:l.id}:l.attachmentType==o.k.File&&(d={fileType:i.a.Uri,name:l.name,size:l.size,uri:l.id,type:Object(a.a)(l.id)}),d&&s.push({file:d,isInline:l.isInline})}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return s}},5042:function(e,t,n){"use strict";var r=n(0),o=n(4),i=n(4830),a=n(4170),s=n(1593),c=n(4360),u=n(4815);var l=new RegExp("<img[^>]*\\s+src=[\"']data:image\\/[^<]+;base64,\\s*[a-zA-Z0-9+\\/=&#;]+[\"'][^>]*>","gi");function d(e){var t=0;if(e){var n=e.match(l);t=n?n.length:0}return t}var f=n(5),p=n(3597);var m=new RegExp('<IMG[^>]+?ORIGINALSRC\\s*=\\s*"[\\s\\S]+?"[\\s\\S]*?>',"gim"),g=new RegExp('\\sSRC\\s*=\\s*"[\\s\\S]+?"',"im"),v=new RegExp('\\sORIGINALSRC\\s*=\\s*"',"im");function h(e,t){return e?e.replace(m,function(e){return e=e.replace(g,""),t&&(e=e.replace(v,' src="')),e}):e}var y=n(9),b=n(4359),_=n.n(b),S=n(1513),C=n.n(S),O=n(226),I=n.n(O),A=35356;function T(e,t){if(t.ExtendedProperty)for(var n=e.length;n--&&t.ExtendedProperty.length>0;)for(var r=t.ExtendedProperty.length;r--;)if(e[n]===t.ExtendedProperty[r].ExtendedFieldURI.PropertyName){t.ExtendedProperty.splice(r,1);break}}function E(e,t,n){var r,o;n?T(["AppendOnSend"],t):e.appendOnSend&&e.appendOnSend.length>0&&(r=e.appendOnSend,(o=t).ExtendedProperty||(o.ExtendedProperty=[]),o.ExtendedProperty.push(C()({Value:JSON.stringify(r),ExtendedFieldURI:I()({DistinguishedPropertySetId:"Common",PropertyName:"AppendOnSend",PropertyType:"String"})})))}function x(e,t){e.internetHeaders.size>0&&function(e,t){var n,o;t.ExtendedProperty||(t.ExtendedProperty=[]);try{for(var i=r.__values(e.keys()),a=i.next();!a.done;a=i.next()){var s=a.value;t.ExtendedProperty.push(C()({Value:e.get(s),ExtendedFieldURI:I()({DistinguishedPropertySetId:"InternetHeaders",PropertyName:s,PropertyType:"String"})}))}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}}(e.internetHeaders,t),e.keysOfInternetHeadersToBeRemoved.length>0&&T(e.keysOfInternetHeadersToBeRemoved,t)}var P=n(1589),M=n(4978),w=n(1),R=Object(w.mutatorAction)("clearKeysOfInternetHeadersToBeRemoved",function(e){e.keysOfInternetHeadersToBeRemoved=[]}),k=n(660),D=n(1597),j=n(4045),N=n(7),F=Object(N.action)(j.c)(function(e,t,n){}),L=n(3671),U=n(4980),B=n(4515),H=n(787),V=n(21),W=n(427),G=n(4516),z=function(e){var t="Standard",n=e.selectedCLPLabel,r=e.originalCLPLabel;return n&&(r?n.id!=r.id&&(t="Privileged"):n.id!=Object(G.a)().id&&(t="Privileged")),t},q=n(6),K=n(4517),X=n(4831),J="MSIP_Label";function Q(e,t){var n=Object(y.a)().SessionSettings.ExternalDirectoryTenantGuid,r=e.selectedCLPLabel,o=e.nonTenantLabelString;if(r||o){var i="";if(r)i=function(e,t){return Object.keys(e).map(function(n){return J+"_"+t.id+"_"+n+"="+e[n]+";"}).join("")}({Enabled:"True",SiteId:n,SetDate:Object(q.jb)(Object(q.Db)()),Name:r.displayName,ContentBits:0,Method:z(e)},r);var a=C()({ExtendedFieldURI:I()({PropertyName:X.a,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:o?o+i:i});t.ExtendedProperty?t.ExtendedProperty.push(a):t.ExtendedProperty=[a],Object(K.a)(r)}}var Y=n(4011),Z=n(194),$=n(4832),ee=n(4833),te=n(156),ne=n(385),re=n.n(ne),oe=n(5252),ie=n.n(oe),ae=n(57),se=n.n(ae),ce=n(5253),ue=n.n(ce),le=n(29);function de(e,t,n,r,o,i){var a=function(e,t,n,r,o,i){var a=ie()({ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:"SendAndSaveCopy",OutboundCharset:"AutoDetect",Items:[t],TimeFormat:r,ItemShape:re()({BaseShape:"IdOnly",AdditionalProperties:[se()({FieldURI:"ItemLastModifiedTime"})]})});return i&&(a.ItemShape.ReturnOnlyInternetMessageId=!0),o&&o.IsOwner&&(a.ComplianceId=o.RmsTemplateId?o.RmsTemplateId.toUpperCase():"0"),a}(e,t,0,r,o,i),s={headers:Object(te.c)(null,"GroupMailbox")};return ue()({Header:Object(le.getJsonRequestHeader)(),Body:a},s).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}var fe=n(5255),pe=n.n(fe),me=n(5257),ge=n.n(me);function ve(e,t,n,r,o,i){var a=function(e,t,n,r,o){var i=ge()({ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},SkipGroupSyncDelivery:!0,ClientSupportsIrm:!0,Item:t,ItemShape:re()({BaseShape:"IdOnly",AdditionalProperties:[se()({FieldURI:"ItemLastModifiedTime"})]})});return o&&(i.ItemShape.ReturnOnlyInternetMessageId=!0),i}(e,t,0,0,i);return pe()({Header:Object(le.getJsonRequestHeader)(),Body:a},o).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}var he=n(4834),ye=n(4084),be=n(1945),_e=n.n(be);function Se(e,t){return _e()({Path:I()({DistinguishedPropertySetId:e,PropertyName:t,PropertyType:"String"})})}var Ce=n(1906),Oe=n.n(Ce),Ie=n(230),Ae=n.n(Ie),Te=n(2540),Ee=n.n(Te),xe=n(2538),Pe=n.n(xe);function Me(e,t,n,o){var i=function(e,t,n,o){var i=[];e.MimeContent&&i.push(Object(ye.a)("MimeContent",e.MimeContent));var a=[Object(ye.a)("ToRecipients",e.ToRecipients),Object(ye.a)("CcRecipients",e.CcRecipients),Object(ye.a)("BccRecipients",e.BccRecipients),Object(ye.a)("Subject",e.Subject),Object(ye.a)("Body",e.Body),Object(ye.a)("Importance",e.Importance),Object(ye.a)("IsReadReceiptRequested",e.IsReadReceiptRequested),Object(ye.a)("IsDeliveryReceiptRequested",e.IsDeliveryReceiptRequested)];e.Attachments&&e.Attachments.length&&a.push(Object(ye.a)("Attachments",e.Attachments)),e.ItemClass&&a.push(Object(ye.a)("ItemClass",e.ItemClass)),e.From&&a.push(Object(ye.a)("From",e.From)),o.length>0&&o.map(function(e){a.push(Se("InternetHeaders",e))}),t&&a.push(Se("Common","AppendOnSend")),e.MentionsEx&&a.push(Object(ye.a)("MentionsEx",e.MentionsEx)),e.Sensitivity&&a.push(Object(ye.a)("Sensitivity",e.Sensitivity)),e.ExtendedProperty&&e.ExtendedProperty.map(function(e){a.push(Object(he.a)(e))}),t&&e.DocLinks&&e.DocLinks.length>0&&a.push(Object(ye.a)("DocLinks",e.DocLinks));var s=Oe()({Updates:r.__spread(i,a),ItemId:Ae()({Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey})}),c=Ee()({ItemChanges:[s],ConflictResolution:"AlwaysOverwrite",ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone",MessageDisposition:t?"SendAndSaveCopy":"SaveOnly",SuppressReadReceipts:!1,ComposeOperation:"newMail",OutboundCharset:"AutoDetect",PromoteInlineAttachments:!1,SendOnNotFoundError:!0,ItemShape:re()({BaseShape:"IdOnly",AdditionalProperties:[se()({FieldURI:"ItemLastModifiedTime"})]})});return n&&n.IsOwner&&(c.ComplianceId=n.RmsTemplateId?n.RmsTemplateId.toUpperCase():"0"),c}(e,t,n,o);return Pe()({Header:Object(le.getJsonRequestHeader)(),Body:i}).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}var we=n(73),Re="InternetHeaders",ke="X-Ms-Exchange-Organization-Dlp-SenderOverrideJustification",De="X-Ms-Exchange-Organization-Dlp-FalsePositive";var je=n(5258),Ne=n.n(je),Fe=n(1819),Le=n.n(Fe),Ue=n(2532),Be=n.n(Ue),He=n(5259),Ve=n.n(He),We=n(5260),Ge=n.n(We),ze=n(4985),qe=n.n(ze),Ke=n(4986),Xe=n.n(Ke),Je=n(56),Qe=n(1020),Ye=n(3880),Ze=n(1180),$e=n(1015);n.d(t,"c",function(){return ct}),n.d(t,"b",function(){return ut}),n.d(t,"a",function(){return lt});var et='<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css" style="display:none;"> P {{margin-top:0;margin-bottom:0;}} </style></head><body dir="{0}">{1}</body></html>',tt="IPM.Note";function nt(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var o,i,a,s,c,u;return r.__generator(this,function(r){switch(r.label){case 0:return(o=Object(L.b)(e))&&o.mentionsPickerPlugin&&o.mentionsPickerPlugin.isImported()?[4,o.mentionsPickerPlugin.getPlugin()]:[3,2];case 1:i=r.sent(),a=i.dataProvider,t?(s=Object(y.a)().SessionSettings,(c=a.getMentionsWrappersForSend({MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:s.UserEmailAddress,Name:s.UserDisplayName}))&&c.length>0&&(n.MentionsEx=c)):(u=a.getPendingTagsForSave()).length>0&&(n.PendingSocialActivityTagIds=u),r.label=2;case 2:return[2]}})})}function rt(e){var t=e.content;if("HTML"==e.bodyType){var n=e.explicitTextDirection||(Object(y.a)().SessionSettings.IsUserCultureRightToLeft?U.a.RTL:U.a.LTR);t=h(t),t=Object(o.b)(et,n,t)}var i,a=Le()({BodyType:e.bodyType,Value:t});a.DataUriCount=d(e.content);var s={Subject:e.subject||"",Importance:e.importance,Sensitivity:e.sensitivity};return i=Ve()(r.__assign({},s,{Body:a})),e.itemId&&(i.ItemId=e.itemId),e.fromViewState&&function(e,t){var n=e.from;t.From=_()({Mailbox:n.email})}(e.fromViewState,i),i}var ot=function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return!Object(f.d)("cmp-smime")||Object(Ye.a)(e.smimeViewState)?[2,null]:[4,H.i.import()];case 1:return(t=r.sent()(e.attachmentWell,e.content,e.bodyType,!0))&&t.length?[4,$e.i.import()]:[3,3];case 2:return n=r.sent()(t),[3,4];case 3:n=null,r.label=4;case 4:return[2,n]}})})};function it(e){var t=e.content,n=Object(Ye.a)(e.smimeViewState);if(e.useSmartResponse&&(t+=Object(B.a)(e.bodyType)),"HTML"==e.bodyType){var a=e.explicitTextDirection||(Object(y.a)().SessionSettings.IsUserCultureRightToLeft?U.a.RTL:U.a.LTR);n&&(t=h(t,n)),t=Object(o.b)(et,a,t)}var c=Le()({BodyType:e.bodyType,Value:t});c.DataUriCount=d(e.content);var u,l=Object(i.a)(e.itemId),p=Object(i.a)(e.referenceItemId),m=[],g=[],v=[];if(Object(f.d)("cmp-smime")&&e.smimeViewState&&0!=e.smimeViewState.smimeBccForkingMode)switch(e.smimeViewState.smimeBccForkingMode){case 1:m=Object(s.a)(e.toRecipientWell),g=Object(s.a)(e.ccRecipientWell);break;case 2:if(e.bccRecipientWell){var b=e.smimeViewState.currentBccRecipientIndex;v=[Object(s.a)(e.bccRecipientWell)[b]]}break;case 3:e.bccRecipientWell&&(v=Object(s.a)(e.bccRecipientWell))}else m=Object(s.a)(e.toRecipientWell),g=Object(s.a)(e.ccRecipientWell),v=Object(s.a)(e.bccRecipientWell);var S={Subject:e.subject||"",Importance:e.importance,IsReadReceiptRequested:e.isReadReceiptRequested,IsDeliveryReceiptRequested:e.isDeliveryReceiptRequested,ToRecipients:m,CcRecipients:g,BccRecipients:v,Sensitivity:e.sensitivity};return e.useSmartResponse?u=(2==e.operation?qe.a:Xe.a)(r.__assign({},S,{UpdateResponseItemId:l,ReferenceItemId:p,ReferenceItemDocumentId:e.referenceItemDocumentId||0,NewBodyContent:c})):5==e.operation||6==e.operation?u=(5==e.operation?Ne.a:Ge.a)(r.__assign({},S,{ReferenceItemId:p,Body:c})):(u=Be()(r.__assign({},S,{Body:c})),e.itemId&&(u.ItemId=e.itemId)),e.fromViewState&&function(e,t){var n=e.from;if(n){var r=!1,o=Object(y.a)().SessionSettings.ConnectedAccountInfos;if(o)for(var i=0;i<o.length;i++){var a=o[i];if(a.EmailAddress==n.email.EmailAddress){r=!0;var s=C()({Value:a.SubscriptionGuid,ExtendedFieldURI:I()({PropertyId:A,DistinguishedPropertySetId:"Sharing",PropertyType:"CLSID"})});t.ExtendedProperty?t.ExtendedProperty.push(s):t.ExtendedProperty=[s],t.From=_()({Mailbox:{MailboxType:n.email.MailboxType,RoutingType:"SMTP",EmailAddress:n.email.EmailAddress,Name:a.DisplayName}});break}}r||(t.From=_()({Mailbox:n.email}))}}(e.fromViewState,u),u}function at(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,o,i,l,d,p,m,g,v,h;return r.__generator(this,function(b){switch(b.label){case 0:return i=Object(y.a)().UserOptions.TimeFormat,Object(Y.b)(e)?(l=e,n=rt(e),[4,Object($.a)(n,e.bodyType,t,i,e.isInlineCompose,e.IRMData,l.publicFolderId)]):[3,2];case 1:return o=b.sent(),[3,12];case 2:return n=it(e),d=n,[4,ot(e)];case 3:return d.Attachments=b.sent(),x(e,n),E(e,n,t),Object(f.d)("cmp-clp")&&!Object(P.b)(e)&&Q(e.clpViewState,n),[4,nt(e,t,n)];case 4:if(b.sent(),!Object(Ye.a)(e.smimeViewState))return[3,9];b.label=5;case 5:return b.trys.push([5,7,,8]),p=function(e,t,n){var o,i=e.smimeViewState||Object(c.a)(),l=e.attachmentWell,d=l.docViewAttachments,f=l.inlineAttachments,p=Object(u.a)(i);return(o=d.slice(0)).push.apply(o,r.__spread(f)),{smimeViewState:i,message:t,fromAddress:Object(a.a)(),isSend:n,composeId:e.composeId,toRecipients:p?Object(s.a)(e.toRecipientWell):[],ccRecipients:p?Object(s.a)(e.ccRecipientWell):[],attachments:o}}(e,n,t),[4,$e.p.import().then(function(e){return e(p)})];case 6:return b.sent(),[3,8];case 7:return m=b.sent(),(h=new Error).message=m.message==Qe.a?Qe.a:"SmimeEncodeError",[2,Promise.reject(h)];case 8:return[3,10];case 9:Object(f.d)("cmp-smime")&&e.itemId&&(g=Object(we.c)().items.get(e.itemId.Id))&&Object(Ze.b)(g.ItemClass)&&(n.ItemClass=tt),b.label=10;case 10:return t&&function(e){var t=[];if(e.isReportedFalsePositive){var n={ExtendedFieldURI:{PropertyName:De,PropertyType:"String",DistinguishedPropertySetId:Re},Value:""};t.push(n)}e.isOverridden&&(n={ExtendedFieldURI:{PropertyName:ke,PropertyType:"String",DistinguishedPropertySetId:Re},Value:e.overrideJustification},t.push(n));return t}(e.policyTipsViewState).map(function(e){return r=e,void(null==(t=n).ExtendedProperty?t.ExtendedProperty=[r]:t.ExtendedProperty.push(r));var t,r}),[4,st(e,n,i,t)];case 11:o=b.sent(),b.label=12;case 12:return R(e),(v=o&&o.ResponseMessages&&o.ResponseMessages.Items?o.ResponseMessages.Items[0]:o&&!o.ResponseMessages?o:null)&&"Success"==v.ResponseClass?[2,Promise.resolve(v)]:(Object(M.d)(o,e),h=void 0,v?(h=new Error(v.ResponseCode)).messageText=v.MessageText:h=new Error("Unrecognized response"),[2,Promise.reject(h)])}})})}function st(e,t,n,o){return r.__awaiter(this,void 0,void 0,function(){var i,a,s,c,u,l;return r.__generator(this,function(r){switch(r.label){case 0:return Object(P.b)(e)?o&&3!=e.operation?Object(Je.a)()||e.itemId||t.RightsManagementLicenseData||e.IRMData?[4,de(e.groupId,t,e.bodyType,n,e.IRMData,e.isInlineCompose)]:[3,2]:[3,4]:[3,6];case 1:return[2,r.sent()];case 2:return i=Object(W.l)(e.groupId),[4,ve(e.groupId,t,e.bodyType,0,i.requestOptions,e.isInlineCompose)];case 3:return[2,r.sent()];case 4:return a=1==e.operation||2==e.operation,!e.itemId&&a||e.useSmartResponse?[4,Object(ee.a)(e.groupId,t,e.bodyType,!1,n,e.isInlineCompose)]:[3,6];case 5:return[2,r.sent()];case 6:return s=Object(Z.c)(),c=!(!s||s.treeType!==V.j&&s.treeType!==V.c),o&&(u=function(e){var t=[];return Object(f.d)("doc-attachment-contextualSharingTips")?(e.attachmentWell.sharingLinkIds.forEach(function(e){var n=Object(p.h)(e),r=function(e){switch(e){case 4:return 4;case 3:return 3;case 6:return 6;case 5:return 5;case 2:return 2;case 1:return 1;default:return 0}}(n.permissionLevel);if(1===r||2===r){var o={ProviderType:"OneDrivePro",Url:n.url,PermissionType:r};t.push(o)}}),t):t}(e))&&u.length>0&&(t.DocLinks=u),!e.useSmartResponse&&e.itemId?[3,8]:[4,Object($.a)(t,e.bodyType,o,n,e.isInlineCompose,e.IRMData,null,c)];case 7:return l=r.sent(),[3,10];case 8:return[4,Me(t,o,e.IRMData,e.keysOfInternetHeadersToBeRemoved)];case 9:l=r.sent(),r.label=10;case 10:return[2,l]}})})}function ct(e){return at(e,!0)}function ut(e){return at(e,!1)}function lt(e,t){if(Object(k.a)(e)){var n=function(e){if(e&&e.Items)return e.Items[0];if(e&&e.Item)return e.Item;return null}(e);return n&&(Object(f.d)("cmp-smime")&&!Object(Ye.a)(t.smimeViewState)&&H.i.import().then(function(e){var r=e(t.attachmentWell,t.content,t.bodyType,!0);r.length&&$e.r.import().then(function(e){return e(r,n.Attachments,Ae()({Id:t.composeId}))})}),n.ItemId&&(Object(D.a)(t,n.ItemId.Id,n.ItemId.ChangeKey,n.LastModifiedTime),n.Body&&(t.lastSavedMessageBody=n.Body.Value)),n.InternetMessageId&&F(t.conversationId,t.itemId?t.itemId.Id:null,n.InternetMessageId)),!0}return!1}},5045:function(e,t,n){"use strict";var r=n(5452),o=n(1343),i=n(4773),a=n(5482),s=n(2),c=n(70),u=n(0),l=n(4564),d=n(4),f=n(6187),p=n(5483),m=n(4141),g=n(20),v=n(6645),h=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.handleRemoveLinkClick=function(e){e.stopPropagation(),e.preventDefault(),r.props.onClickUninstall&&r.props.onClickUninstall(),Object(m.b)()&&Object(p.a)()},r.handleRemoveLinkClick=r.handleRemoveLinkClick.bind(r),r}return u.__extends(t,e),t.prototype.render=function(){return s.createElement("div",{className:v.divContainer},s.createElement("div",null,Object(d.a)(l.b)," ",s.createElement("a",{href:"",onClick:this.handleRemoveLinkClick},Object(d.a)(l.a))))},t=u.__decorate([g.observer],t)}(s.Component),y=n(1071),b=n(1166),_=n(4689),S=n(1286),C=n(209),O=n(1401),I=n(4563),A=n(4777),T=(n(3792),n(3538)),E=n(6648),x=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.refCallback=r.refCallback.bind(r),r.focusOnAddinBar=r.focusOnAddinBar.bind(r),r.dismissCallout=r.dismissCallout.bind(r),r.getContextualExecutor=r.getContextualExecutor.bind(r),r.convertAddinsToCommandBarItems=r.convertAddinsToCommandBarItems.bind(r),r}return u.__extends(t,e),t.prototype.dismissCallout=function(){Object(T.t)().activeDialog||(Object(T.t)().contextualCalloutState.contextualAnchor.focus(),Object(T.bb)())},t.prototype.focusOnAddinBar=function(){this.commandBar.focus()},t.prototype.getContextualExecutor=function(e){return function(){var t=Object(T.t)().runningContextualAddinCommand,n=t.hostItemIndex,r=t.addinCommand;e.get_Id()!==r.get_Id()&&Object(f.a)(n,e)}},t.prototype.convertAddinsToCommandBarItems=function(e,t){var n=this;return e.map(function(e){var r=e.get_Id()===t.get_Id();return{key:e.get_Id(),className:r&&E.selected,text:e.detectedEntity.Label,onClick:n.getContextualExecutor(e)}})},t.prototype.refCallback=function(e){this.commandBar=e},t.prototype.onRenderContextualAddin=function(e){return s.createElement(y.a,{className:e.className,onClick:e.onClick,text:e.text,ariaLabel:e.text})},t.prototype.onRenderOverflowButton=function(e){return s.createElement(b.a,{menuIconProps:{iconName:"More"},menuProps:{items:e},ariaLabel:Object(d.a)(l.c)})},t.prototype.render=function(){var e=Object(T.t)();if(!e.runningContextualAddinCommand)return s.createElement("div",null);var t=e.contextualCalloutState.contextualAnchor,n=e.runningContextualAddinCommand,r=n.hostItemIndex,o=n.addinCommand,i=this.convertAddinsToCommandBarItems(e.contextualCalloutState.activeContextualAddinCommands,o),a={height:o.detectedEntity.RequestedHeight?o.detectedEntity.RequestedHeight+"px":"350px"},c={};c[13]=this.focusOnAddinBar,c[14]=this.focusOnAddinBar,c[15]=this.dismissCallout;var u=Object(I.f)(o)?s.createElement(h,{onClickUninstall:this.dismissCallout}):s.createElement(A.a,{addinCommand:e.runningContextualAddinCommand.addinCommand,controlId:e.runningContextualAddinCommand.controlId,hostItemIndex:r,manifestCacheProvider:_.a,style:a,notifyHostActions:c});return s.createElement(S.a,{gapSpace:0,target:t,onDismiss:this.dismissCallout,setInitialFocus:!0,calloutWidth:parseInt("570px"),beakWidth:19,className:E.divContainer},s.createElement(C.a,{className:E.appIcon,iconName:"OfficeAddinsLogo"}),s.createElement("div",{className:E.divider}),s.createElement(O.a,{componentRef:this.refCallback,items:i,className:E.contextualBar,onRenderItem:this.onRenderContextualAddin,onRenderOverflowButton:this.onRenderOverflowButton}),s.createElement("div",{className:E.contextualAddinFrame},u))},t=u.__decorate([g.observer],t)}(s.Component),P=n(6650),M=n(3013),w=n(1012),R=n(4070),k=n(6651),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u.__extends(t,e),t.prototype.hideDialog=function(e){Object(R.j)({eventDispId:R.a.DISPLAY_DIALOG_DISPID,controlId:e})},t.prototype.render=function(){var e=Object(T.t)().activeDialog;if(!e)return s.createElement("div",{className:k.divContainer});if(e.isOpen&&1==e.dialogType){var t=Object(T.n)(e.parentControlId),n=t.extension.DisplayName,r={height:e.heightInPercentage+"vh",width:e.widthInPercentage+"vw",overflow:"hidden"},o=Object(d.a)(P.a);o&&(o=o.replace("{0}",n));var i={};return i[15]=this.hideDialog,s.createElement(M.a,{hidden:!e.isOpen,onDismiss:this.hideDialog.bind(this,e.parentControlId),dialogContentProps:{type:w.a.close,title:n,closeButtonAriaLabel:o},modalProps:{isBlocking:!0,containerClassName:k.dialogContainer},forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0},s.createElement(A.a,{addinCommand:t,controlId:e.controlId,isDialog:!0,hostItemIndex:e.hostItemIndex,sourceLocation:e.url,manifestCacheProvider:_.b,notifyHostActions:i,style:r}))}return s.createElement("div",{className:k.divContainer})},t=u.__decorate([g.observer],t)}(s.Component),j=n(6131),N=n(6663),F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hideDialog=function(){Object(R.j)({eventDispId:R.a.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID,controlId:t.props.controlId})},t}return u.__extends(t,e),t.prototype.render=function(){var e=T.k.activeDialog,t=!1;e&&e.parentControlId==this.props.controlId&&2==e.dialogType&&(t=!0);var n=this.props.addinCommand,r=n.extension.ConsentState,o=n.extension.Type,i=2!=r&&"Preinstalled"==o?N.consentContainer:N.uiLessContainer,a=t?"":N.hiddenContainer;return s.createElement("div",null,s.createElement(M.a,{hidden:!1,onDismiss:this.hideDialog,dialogContentProps:{type:w.a.normal,title:n.extension.DisplayName},modalProps:{isBlocking:t,containerClassName:N.dialogContainer,className:a},forceFocusInsideTrap:t,containerClassName:N.dialogContainer,isClickableOutsideFocusTrap:!0},s.createElement("div",{className:i},this.props.children)))},t=u.__decorate([g.observer],t)}(s.Component),L=n(6665),U=n(3620),B=n(1),H=Object(B.action)("onUILessExecutionCompleted",function(e,t,n,r,o){return{addinCommand:e,controlId:t,hostItemIndex:n,args:r,status:o}});Object(B.orchestrator)(H,function(e){var t=e.args?e.args.completedContext:void 0,n=Object(T.K)(e.addinCommand);Object(T.eb)(e.controlId,e.hostItemIndex,e.status,t),n&&Object(T.Q)(e.hostItemIndex)});var V,W=H,G=n(6666),z=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.addDisplayNotification=r.addDisplayNotification.bind(r),r.addGenericErrorNotification=r.addGenericErrorNotification.bind(r),r.invokeAppCommand=r.invokeAppCommand.bind(r),r.infoBarId=0,r}return u.__extends(t,e),t.prototype.addDisplayNotification=function(e){Object(U.e)(this.props.hostItemIndex,this.props.controlId,!1,""+this.props.addinCommand.get_Id()+this.infoBarId++,Object(_.d)(e.infoType),e.description)},t.prototype.addGenericErrorNotification=function(){var e=Object(d.b)(Object(d.a)(L.b),this.props.addinCommand.get_ExtensionDisplayName());Object(U.e)(this.props.hostItemIndex,this.props.controlId,!1,this.props.addinCommand.get_Id(),2,e,this.props.addinCommand.get_Size16Icon())},t.prototype.removeProgressNotification=function(){Object(U.s)(this.props.hostItemIndex,this.props.controlId,this.props.addinCommand.get_Id())},t.prototype.addProgressNotification=function(){var e=Object(d.b)(Object(d.a)(L.a),this.props.addinCommand.get_ExtensionDisplayName(),this.props.addinCommand.get_Label());Object(U.e)(this.props.hostItemIndex,this.props.controlId,!1,this.props.addinCommand.get_Id(),1,e)},t.prototype.invokeAppCommand=function(){var e=this.props.addinCommand.getControl(),t=e.Action.FunctionName,n={source:{id:e.Id}};this.props.disableProgressBar||this.addProgressNotification(),OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(this.props.controlId,t,n,this.onEventCompleted.bind(this))},t.prototype.onEventCompleted=function(e,t){this.props.disableProgressBar||this.removeProgressNotification(),e!=T.d.Success&&Object(T.J)(this.props.hostItemIndex)&&this.addGenericErrorNotification(),W(this.props.addinCommand,this.props.controlId,this.props.hostItemIndex,t,e)},t.prototype.render=function(){var e={};return e[8]=this.addGenericErrorNotification,s.createElement(A.a,{addinCommand:this.props.addinCommand,controlId:this.props.controlId,hostItemIndex:this.props.hostItemIndex,manifestCacheProvider:_.a,onInsertOsfControl:this.invokeAppCommand,onDisplayNotification:this.addDisplayNotification,notifyHostActions:e,className:G.uiLessContainer})},t=u.__decorate([g.observer],t)}(s.Component),q=n(51),K=Object(q.a)(function(e){var t=[];return Object(T.t)().runningUILessAddinCommands.forEach(function(e,n){e.forEach(function(e,r){var o=Object(T.K)(e);t.push(s.createElement(F,{hostItemIndex:n,controlId:r,addinCommand:e,key:r},s.createElement(z,{addinCommand:e,controlId:r,hostItemIndex:n,disableProgressBar:o})))})}),s.createElement("div",null,t)}),X=n(4480);function J(e){V||(V=document.createElement("div"),document.body.appendChild(V),c.render(s.createElement(Q,{renderTaskPaneInPanel:e}),V))}function Q(e){return s.createElement("div",null,e.renderTaskPaneInPanel&&s.createElement(j.a,{renderTaskPaneInPanel:!0}),s.createElement(K,null),s.createElement(x,null),s.createElement(D,null),s.createElement(X.a,null))}var Y=n(6188),Z=n(6189),$=n(171);function ee(e){var t,n=e.map(te);return n.push({key:(t=Object(Z.a)()).key,name:t.name,itemType:t.itemType,iconProps:t.iconProps}),n}function te(e){return{key:e.Id,name:e.DisplayName,itemType:$.a.Normal,iconProps:Object(Y.a)(e.IconUrl)}}var ne=n(5),re=function(e,t){if(Object(ne.d)("addin-autoRunAddins")){var n=Object(U.n)(e).mode,r=Object(T.p)(t,n);Object(T.f)(r,e),Object(T.Q)(e)}};n.d(t,"f",function(){return r.a}),n.d(t,"a",function(){return o.a}),n.d(t,"b",function(){return i.a}),n.d(t,"g",function(){return a.a}),n.d(t,"e",function(){return J}),n.d(t,"c",function(){return ee}),n.d(t,"d",function(){return re})},5047:function(e,t,n){"use strict";var r=n(0),o=n(3548),i=function(){function e(e){this.addinFactory=e}return e.prototype.activate=function(e){var t=this;return new Promise(function(n,r){var i=new Map;Object.values(o.a).filter(function(e){return isNaN(Number(o.a[e]))}).forEach(function(n){i.set(n,[]),e.forEach(function(e){var r=t.addinFactory.CreateAddinIfEntryPointSupported(e,n);r&&i.get(n).push(r)})}),n(i)})},e}(),a=n(4139),s=n(5045);var c=n(3538),u=n(5),l=function(){function e(){var e=this;this.getAutoRunAddinsByEvent=function(t,n){var r=e.getAddinsForMode(n),o=[],i=[];return e.autoRunAddinsIndexMapping.has(n)&&(o=e.autoRunAddinsIndexMapping.get(n).get(t))&&o.map(function(e){i.push(r[e])}),i},this.setAutoRunAddinsMapping=function(t,n){n.forEach(function(n,o){r.__spread(n.AddinCommands.values()).forEach(function(n){var r=n.getTriggeringEvent();e.setAutoRunAddinMapForMode(t,r,o)})})},this.setAutoRunAddinMapForMode=function(t,n,r){e.autoRunAddinsIndexMapping.has(t)?e.autoRunAddinsIndexMapping.get(t).has(n)?e.autoRunAddinsIndexMapping.get(t).get(n).push(r):e.autoRunAddinsIndexMapping.get(t).set(n,[r]):(e.autoRunAddinsIndexMapping.set(t,new Map),e.autoRunAddinsIndexMapping.get(t).set(n,[r]))},this.isInitialized=!1,this.appointmentAttendeeAddins=[],this.appointmentOrganizerAddins=[],this.detectedEntityAddins=[],this.messageReadAddins=[],this.messageComposeAddins=[],this.meetingRequestAddins=[],this.eventsAddins=[],this.autoRunOnMessageComposeAddins=[],this.autoRunOnAppointmentOrganizerAddins=[],this.autoRunAddinsIndexMapping=new Map}return e.prototype.getExtensionPoint=function(e,t){var n=this.getAddinsForMode(e);if(t){if(!Object(u.d)("addin-delegateAccess"))return[];n&&(n=Object(c.m)(n))}return n},e.prototype.setExtensionPoint=function(e,t){switch(t){case o.a.MeetingRequest:this.meetingRequestAddins=e;break;case o.a.AppointmentAttendee:this.appointmentAttendeeAddins=e;break;case o.a.AppointmentOrganizer:this.appointmentOrganizerAddins=e;break;case o.a.DetectedEntity:this.detectedEntityAddins=e;break;case o.a.MessageCompose:this.messageReadAddins=e;break;case o.a.MessageRead:this.messageComposeAddins=e;break;case o.a.TrapOnSendEvent:this.eventsAddins=e;break;case o.a.AutoRunOnAppointmentOrganizer:this.autoRunOnAppointmentOrganizerAddins=e,this.setAutoRunAddinsMapping(o.a.AutoRunOnAppointmentOrganizer,e);break;case o.a.AutoRunOnMessageCompose:this.autoRunOnMessageComposeAddins=e,this.setAutoRunAddinsMapping(o.a.AutoRunOnMessageCompose,e)}},e.prototype.getAddinsForMode=function(e){switch(e){case o.a.MeetingRequest:return this.meetingRequestAddins;case o.a.AppointmentAttendee:return this.appointmentAttendeeAddins;case o.a.AppointmentOrganizer:return this.appointmentOrganizerAddins;case o.a.DetectedEntity:return this.detectedEntityAddins;case o.a.MessageCompose:return this.messageReadAddins;case o.a.MessageRead:return this.messageComposeAddins;case o.a.TrapOnSendEvent:return this.eventsAddins;case o.a.AutoRunOnMessageCompose:return this.autoRunOnMessageComposeAddins;case o.a.AutoRunOnAppointmentOrganizer:return this.autoRunOnAppointmentOrganizerAddins;default:return null}},e}(),d=n(4377);function f(e,t){var n=new l;return t.activate(e).then(function(e){Object.values(o.a).forEach(function(t){n.setExtensionPoint(e.get(t),t)})}).then(function(){n.isInitialized=!0,Object(c.U)(n),function(e){var t={};[o.a.MessageRead,o.a.MessageCompose,o.a.AppointmentAttendee,o.a.AppointmentOrganizer].forEach(function(n){var r=e.getExtensionPoint(n);t[n]=Object(s.c)(r)}),a.j.importAndExecute(t)}(n);var t=e.map(function(e){return e.Id});Object(d.g)(t)})}var p=n(5069),m=n(4141),g=n(12);n.d(t,"a",function(){return h});var v=!1;function h(){var e=this;return new Promise(function(t,n){return r.__awaiter(e,void 0,void 0,function(){var e,n,o;return r.__generator(this,function(r){switch(r.label){case 0:if((v||Object(c.L)())&&!Object(c.M)())return Object(c.nb)(t),[2];Object(c.W)(!1),y(!0),[],e=new i(new c.c(new c.b)),n=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(p.a)()];case 2:return n=r.sent(),[3,4];case 3:return o=r.sent(),g.c.error(o),[3,4];case 4:return Object(c.V)(n),n=Object(c.s)(),Object(m.a)()&&Object(c.S)(n.GenericInfo),[4,f(function(e){return e&&e.Extensions?e.Extensions.filter(function(e){return e.Enabled&&null!=e.ExtensionPointCollection}):[]}(n),e)];case 5:return r.sent(),y(!1),t(),[2]}})})})}function y(e){v=e}},5049:function(e,t,n){"use strict";var r=function(){return{tenantTokens:["56468f6991c348029c6bba403b444607-7f5d6cd1-7fbe-4ab1-be03-3b2b6aeb3eb4-7696"]}},o=n(3620),i=n(18),a=n(5),s=n(27),c=n(3538),u=n(15),l=function(e,t,n,l,d){if(Object(a.d)("addin-launchDatapoint")){var f=function(e){if(Object(a.d)("addin-delegateAccess")){var t=Object(o.n)(e);if(t.isSharedItem)return t.isSharedItem()}return!1}(n);!function(e,t,n,o,a,l){var d=new i.a("ExtAddinLaunched",r());d.addCustomData({id:t.extension.Id,name:t.extension.DisplayName,owa_1:Object(u.b)(),owa_2:Object(c.z)(n),owa_3:o,lang:Object(s.g)(),owa_4:t.extension.Type,errorCode:a,delegate:l}),e?d.end():d.endWithError("Timeout",new Error("Add-in failed to load with code: "+a))}(e,t,n,l,d,f),e&&f&&function(e,t){var n=new i.a("ExtDelegateAddinLaunched",r());n.addCustomData({id:e.extension.Id,name:e.extension.DisplayName,owa_1:Object(u.b)(),owa_2:Object(c.z)(t)}),n.end()}(t,n)}};var d=9e5;function f(){var e=r();return e.timeout=d,new i.a("ExtItemSendEvent",e)}function p(e,t){e.addCustomData({owa_1:t}),e.end()}function m(e,t,n){e.addCustomData({reason:g(t),id:n.extension.Id,name:n.extension.DisplayName,module:Object(u.b)()}),e.end()}function g(e){if(e.status===c.d.Success)return e.allowEvent?4:2;switch(e.status){case c.d.TimedOut:return 16;case c.d.FunctionNotFound:return 8;default:return 32}}var v=n(4377),h=n(3548),y=n(136);function b(e,t,n,r){var i,a=Object(s.f)();e.properties["App.Name"]="Outlook",e.properties["App.Platform"]="Web",e.properties["App.Version"]=Object(u.i)(),e.properties["Release.AudienceGroup"]=function(){switch(Object(u.m)()){case"Dogfood":return"Dogfood";case"Microsoft":return"Microsoft";default:return"Production"}}(),e.properties["Release.Audience"]=Object(u.m)(),e.properties["User.TenantId"]=a.SessionSettings.ExternalDirectoryTenantGuid,e.properties["User.TenantGroup"]="outlookCom"===(i=Object(o.q)())||"gmail"===i?"Consumer":"Commercial",e.properties["User.PrimaryIdentitySpace"]=function(){switch(Object(o.q)()){case"outlookCom":return"MsaPuid";case"office365":return"OrgIdPuid";default:return"Unknown"}}(),e.properties["User.PrimaryIdentityHash"]=a.SessionSettings.UserPuid,e.properties["Browser.Name"]=Object(y.a)().browser,e.properties["Browser.Version"]=Object(y.a)().browserVersion.join("."),e.properties["Session.Id"]=function(e){if(void 0!==e)return(e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(20)).toLowerCase();return e}(Object(u.h)()),e.properties["Event.Time"]=(new Date).toISOString(),e.properties["Data.SDX.AppState"]=function(e){switch(Object(o.n)(e).mode){case h.a.MessageRead:return"MessageRead";case h.a.MessageCompose:return"MessageCompose";case h.a.AppointmentAttendee:return"AppointmentAttendee";case h.a.AppointmentOrganizer:return"AppointmentOrganizer";default:return"Unknown"}}(n),e.properties["Device.OsVersion"]="N/A",e.properties["Device.OsBuild"]="N/A",e.properties["Data.SDX.LaunchReason"]=function(e,t){if(Object(c.O)(e.extension.Id,t))return"Auto";if(Object(v.d)(e))return"Auto";return"Manual"}(t,r),e.properties["Data.SDX.CommandPlacement"]=function(e,t,n){if(Object(c.O)(e.extension.Id,n))return"OnSend";if(Object(v.d)(e))return"Persistent";if(e.detectedEntity)return"Contextual";return Object(o.n)(t).isAddinPinned(e.extension.Id)?"Ribbon":"Overflow"}(t,n,r),e.properties["Data.SDX.ActionType"]=function(e){switch(Object(c.r)(e)){case 2:return"ShowTaskpane";case 3:return"ExecuteFunction";case 1:return"Contextual";case 5:return"Dialog";case 4:return"Unknown"}}(r),e.properties["Data.ExEnv"]=Object(u.m)()}n.d(t,"e",function(){return l}),n.d(t,"b",function(){return f}),n.d(t,"c",function(){return m}),n.d(t,"d",function(){return p}),n.d(t,"a",function(){return b})},5067:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(3538);function o(e,t){var n=Object(r.n)(t);return!!n&&n.get_Id()===e+"ItemSend"}},5068:function(e,t,n){"use strict";var r=n(4034),o=n(1);t.a=Object(o.mutatorAction)("updatePersistentTaskPaneError",function(e){var t=Object(r.b)("Persistent");t&&(t.errorType=e)})},5069:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n(0),o=n(3620),i=n(27),a=3,s=3e3,c=3,u=!0,l="1.7",d="1.1";function f(){return function e(t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,(f=t==a?0:s,new Promise(function(e,t){setTimeout(function(){e()},f)}))];case 1:return r.sent(),[4,Object(o.p)(c,Object(i.j)(),u,l,d)];case 2:return[2,r.sent()];case 3:if(n=r.sent(),0==t)throw n;return[3,4];case 4:return[4,e(--t)];case 5:return[2,r.sent()]}var f})})}(a)}},5070:function(e,t,n){var r=n(6658),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},508:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"e",function(){return i}),n.d(t,"d",function(){return u});var r=n(6),o=Object(r.Eb)("UTC",4500,8,1),i=Object(r.jb)(o).slice(0,-1);function a(e){return c(e.lastDeliveryOrRenewTimeStamp)}function s(e){return c(e.ReceivedOrRenewTime)}function c(e){return e===u()||new Date(e).getTime()==Object(r.pb)(o)}function u(){try{return new Date(Object(r.pb)(o)).toLocaleString(),Object(r.Wb)(o).toString()}catch(e){return null}}},509:function(e,t,n){"use strict";n.r(t),n.d(t,"getCanDelete",function(){return p}),n.d(t,"getCategories",function(){return m}),n.d(t,"getConversationId",function(){return g}),n.d(t,"getIsPinned",function(){return v}),n.d(t,"getItemIds",function(){return h}),n.d(t,"getExecuteSearchSortOrder",function(){return y}),n.d(t,"getUniqueSenders",function(){return b}),n.d(t,"getFlagStatus",function(){return _}),n.d(t,"getEffectiveMentioned",function(){return S}),n.d(t,"getLastDeliveryOrRenewTimeStamp",function(){return C}),n.d(t,"getLastModifiedTimeStamp",function(){return O}),n.d(t,"getLastDeliveryTimeStamp",function(){return I}),n.d(t,"getSubject",function(){return A}),n.d(t,"getLastSenderMailbox",function(){return T}),n.d(t,"getLastSenderSMTP",function(){return E}),n.d(t,"getUnreadCount",function(){return x}),n.d(t,"getSize",function(){return P}),n.d(t,"getRowIdString",function(){return M}),n.d(t,"getRowClientItemId",function(){return w}),n.d(t,"getParentFolderId",function(){return R}),n.d(t,"getInstrumentationContext",function(){return k}),n.d(t,"getIsDraft",function(){return D}),n.d(t,"getIsSubmitted",function(){return j}),n.d(t,"getIsSnoozed",function(){return N}),n.d(t,"getValidCouponIndexes",function(){return F}),n.d(t,"getImportance",function(){return L}),n.d(t,"getArchiveTag",function(){return U}),n.d(t,"getPolicyTag",function(){return B});var r,o=n(298),i=n(810),a=n(1090),s=n(508),c=n(18),u=n(1087),l=n(31),d=n(12),f=n(897);function p(e,t){return H(e,t,r.CanDelete)}function m(e,t){return H(e,t,r.Categories)}function g(e,t){return H(e,t,r.ConversationId)}function v(e,t){return H(e,t,r.IsPinned)}function h(e,t){return H(e,t,r.ItemIds)}function y(e,t){return H(e,t,r.ExecuteSearchSortOrder)}function b(e,t){return H(e,t,r.UniqueSenders)}function _(e,t){return H(e,t,r.FlagStatus)}function S(e,t){return H(e,t,r.EffectiveMentioned)}function C(e,t){return H(e,t,r.LastDeliveryOrRenewTimeStamp)}function O(e,t){return H(e,t,r.LastModifiedTimeStamp)}function I(e,t){return H(e,t,r.LastDeliveryTimeStamp)}function A(e,t){return H(e,t,r.Subject)}function T(e,t){return H(e,t,r.LastSenderMailbox)}function E(e,t){return H(e,t,r.LastSenderSMTP)}function x(e,t){return H(e,t,r.UnreadCount)}function P(e,t){return H(e,t,r.Size)}function M(e,t){return H(e,t,r.RowIdString)}function w(e,t){return H(e,t,r.RowClientItemId)}function R(e,t){return H(e,t,r.ParentFolderId)}function k(e,t){return H(e,t,r.InstrumentationContext)}!function(e){e[e.ArchiveTag=0]="ArchiveTag",e[e.CanDelete=1]="CanDelete",e[e.Categories=2]="Categories",e[e.ConversationId=3]="ConversationId",e[e.EffectiveMentioned=4]="EffectiveMentioned",e[e.ExecuteSearchSortOrder=5]="ExecuteSearchSortOrder",e[e.FlagStatus=6]="FlagStatus",e[e.Importance=7]="Importance",e[e.InstrumentationContext=8]="InstrumentationContext",e[e.IsDraft=9]="IsDraft",e[e.IsPinned=10]="IsPinned",e[e.IsSnoozed=11]="IsSnoozed",e[e.IsSubmitted=12]="IsSubmitted",e[e.ItemIds=13]="ItemIds",e[e.LastDeliveryOrRenewTimeStamp=14]="LastDeliveryOrRenewTimeStamp",e[e.LastDeliveryTimeStamp=15]="LastDeliveryTimeStamp",e[e.LastModifiedTimeStamp=16]="LastModifiedTimeStamp",e[e.LastSenderMailbox=17]="LastSenderMailbox",e[e.LastSenderSMTP=18]="LastSenderSMTP",e[e.ParentFolderId=19]="ParentFolderId",e[e.PolicyTag=20]="PolicyTag",e[e.RowClientItemId=21]="RowClientItemId",e[e.RowIdString=22]="RowIdString",e[e.Size=23]="Size",e[e.Subject=24]="Subject",e[e.UniqueSenders=25]="UniqueSenders",e[e.UnreadCount=26]="UnreadCount",e[e.ValidCouponIndexes=27]="ValidCouponIndexes"}(r||(r={}));var D=function(e,t){return H(e,t,r.IsDraft)},j=function(e,t){return H(e,t,r.IsSubmitted)};function N(e,t){return H(e,t,r.IsSnoozed)}function F(e,t){return H(e,t,r.ValidCouponIndexes)}function L(e,t){return H(e,t,r.Importance)}function U(e,t){return H(e,t,r.ArchiveTag)}function B(e,t){return H(e,t,r.PolicyTag)}function H(e,t,n){switch(t.tableQuery.listViewType){case 0:return function(e,t,n){var i=Object(o.a)(e,t.id);if(!i)return V("getConversationProperty should not be called on conversation that not in cache.",n),null;var a=i.id,c=Object(u.a)(a),d=l.H.conversations.get(a),p=l.H.items.get(i.itemIds[0]);switch(n){case r.RowIdString:return i.id;case r.RowClientItemId:return c.clientId;case r.ConversationId:return a;case r.FlagStatus:return i.flagStatus;case r.IsPinned:return s.b(i);case r.ItemIds:return i.itemIds;case r.LastDeliveryOrRenewTimeStamp:return i.lastDeliveryOrRenewTimeStamp;case r.LastDeliveryTimeStamp:return i.lastDeliveryTimeStamp;case r.LastModifiedTimeStamp:return i.lastModifiedTimeStamp;case r.UnreadCount:return i.unreadCount;case r.LastSenderMailbox:return i.lastSender&&i.lastSender.Mailbox;case r.LastSenderSMTP:return i.lastSender&&i.lastSender.Mailbox.EmailAddress;case r.ExecuteSearchSortOrder:return i.executeSearchSortOrder;case r.ParentFolderId:return 1===t.tableQuery.type?i.parentFolderId:t.tableQuery.folderId;case r.Subject:return c.subject;case r.UniqueSenders:return i.uniqueSenders;case r.Size:return c.size;case r.EffectiveMentioned:return i.effectiveMentioned;case r.InstrumentationContext:return i.instrumentationContext;case r.Categories:return i.categories;case r.CanDelete:return d&&d.canDelete;case r.ValidCouponIndexes:return c.validCouponIndexes;case r.Importance:return i.importance;case r.ArchiveTag:return p&&p.ArchiveTag;case r.PolicyTag:return p&&p.PolicyTag;case r.IsSnoozed:return Object(f.a)(i);case r.IsSubmitted:case r.IsDraft:default:return null}}(e,t,n);case 1:return function(e,t,n){var o=Object(i.a)(e,t.id);if(!o)return V("getItemProperty: item not in item relations.",n),null;var c=o.clientId,u=l.H.items.get(c.Id);if(!u)return V("getItemProperty: Item not in item cache.",n),null;var d=Object(a.a)(u)?u:null,p=d&&d.From&&d.From.Mailbox;switch(n){case r.RowIdString:return c.Id;case r.RowClientItemId:return c;case r.ConversationId:return d.ConversationId.Id;case r.FlagStatus:return u.Flag?u.Flag.FlagStatus:null;case r.IsPinned:return s.c(u);case r.ItemIds:return[c.Id];case r.LastDeliveryOrRenewTimeStamp:return u.ReceivedOrRenewTime;case r.LastDeliveryTimeStamp:return u.DateTimeReceived;case r.LastModifiedTimeStamp:return u.LastModifiedTime;case r.UnreadCount:return d&&!d.IsRead?1:0;case r.LastSenderMailbox:return p;case r.LastSenderSMTP:return p&&p.EmailAddress;case r.UniqueSenders:return p?[p.Name]:null;case r.ExecuteSearchSortOrder:return o.executeSearchSortOrder;case r.ParentFolderId:return u.ParentFolderId.Id;case r.Subject:return u.Subject;case r.Size:return u.Size;case r.EffectiveMentioned:return u.MentionedMe;case r.IsDraft:return u.IsDraft;case r.IsSubmitted:return u.IsSubmitted;case r.InstrumentationContext:return o.instrumentationContext;case r.Categories:return u.Categories;case r.CanDelete:return u.CanDelete;case r.ValidCouponIndexes:return u.validCouponIndexes;case r.Importance:return u.Importance;case r.ArchiveTag:return u.ArchiveTag;case r.PolicyTag:return u.PolicyTag;case r.IsSnoozed:return Object(f.b)(u);default:return null}}(e,t,n);default:return null}}function V(e,t){var n=Object(c.q)(),r=e+" PropertyType:"+t;n&&(r+=" Scenario:"+n.eventName),d.c.error(r)}},510:function(e,t,n){"use strict";function r(e,t){return t+e}n.d(t,"a",function(){return r})},511:function(e,t,n){"use strict";n.d(t,"j",function(){return r}),n.d(t,"l",function(){return o}),n.d(t,"w",function(){return i}),n.d(t,"u",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"q",function(){return c}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"g",function(){return d}),n.d(t,"h",function(){return f}),n.d(t,"i",function(){return p}),n.d(t,"f",function(){return m}),n.d(t,"e",function(){return g}),n.d(t,"m",function(){return v}),n.d(t,"d",function(){return h}),n.d(t,"k",function(){return y}),n.d(t,"t",function(){return b}),n.d(t,"o",function(){return _}),n.d(t,"v",function(){return S}),n.d(t,"p",function(){return C}),n.d(t,"r",function(){return O}),n.d(t,"s",function(){return I}),n.d(t,"n",function(){return A});var r="multipart/signed",o="application/pkcs7-mime",i="application/x-pkcs7-mime",a=".p7m",s="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",c="CLASSID",u="4",l="0800",d=57,f=16,p=11,m="IPM.Note.SMIME.MultipartSigned",g="IPM.Note.SMIME",v="smime-",h="image",y="OwaToSmime",b="SmimeToOwa",_="en-US",S=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],C="https://ow2.res.office365.com/owasmime/20.19.214.1/owasmime.msi",O="OwaSmimeEdgeExtension.appxbundle",I="https://ow2.res.office365.com/owasmime/20.19.214.1/OwaSmimeEdgeExtension.appxbundle",A="https://ow2.res.office365.com/owasmime/20.19.214.1/SmimeOutlookWebChrome.msi"},520:function(e,t,n){"use strict";var r,o,i;n.d(t,"c",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i}),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity"}(o||(o={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(i||(i={}))},523:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l});var r,o=n(0),i=n(373),a=n(440),s=n(283),c=n(253);function u(){Object(i.a)(s.a.Loading),r&&r()}function l(e){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(e){r=function(){e()}})];case 1:return t.sent(),[2,Object(c.a)().isPopoutV2?new Promise(function(t,n){var r=function(n){var o=Object(a.b)(n);if(o&&o.type==a.a.SetData){window.removeEventListener("message",r);var i=void 0;try{i=e?e(o.serializedData):JSON.parse(o.serializedData)}catch(e){}t(i)}};window.addEventListener("message",r);try{var o=window.opener;Object(a.c)(o,a.a.PopoutReady,null)}catch(e){t(null)}}):Promise.resolve(null)]}})})}},5245:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(5246);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetDlpPolicyTips",e,t)}},5246:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetDlpPolicyTipsRequest:#Exchange"},e)}},5247:function(e){e.exports={a:"Kda",b:"Lda"}},5248:function(e){e.exports={a:"Mda",b:"Nda"}},5249:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CreateResponseFromModernGroupRequest:#Exchange"},e)}},5250:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(5251);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("CreateResponseFromModernGroup",e,t)}},5251:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CreateResponseFromModernGroupJsonRequest:#Exchange"},e)}},5252:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"PostGroupItemRequest:#Exchange"},e)}},5253:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(5254);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("PostGroupItem",e,t)}},5254:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"PostGroupItemJsonRequest:#Exchange"},e)}},5255:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(5256);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("PostUnifiedGroupItem",e,t)}},5256:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"PostUnifiedGroupItemJsonRequest:#Exchange"},e)}},5257:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"PostUnifiedGroupItemRequest:#Exchange"},e)}},5258:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ApproveRequestItem:#Exchange"},e)}},5259:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"PostItem:#Exchange"},e)}},5260:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"RejectRequestItem:#Exchange"},e)}},5270:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(4990),o=n(197);function i(e,t,n,i,a,s){var c={operation:0,bodyType:"HTML",subject:i,newContent:a,to:e,cc:t,bcc:n,preferAsyncSend:!0},u=Object(r.a)(s);o.u.importAndExecute(c,o.a.Popout,null,u)}},5452:function(e,t,n){"use strict";var r=n(4563),o=n(3620),i=n(4377),a=n(5),s=n(3538);function c(e,t){var n=Object(o.n)(e);if(n){var c=n.mode,u=Object(i.c)(c);if(u){var l=Object(r.c)(u.addinId,u.commandId,c);if(!n.isSharedItem||!n.isSharedItem()||Object(a.d)("addin-delegateAccess")&&Object(s.g)(l))if(l&&!Object(r.f)(l)){var d=Object(s.y)();Object(s.X)(d,e,l,"Persistent",c,t)}else!l&&Object(s.L)()&&Object(i.h)(c,null)}}}var u=n(3548),l={hostItemIndex:null,mode:u.a.Unknown,isNullSent:!1};function d(){return l}function f(e){l=e}function p(e){switch(Object(o.n)(e).mode){case u.a.MessageRead:case u.a.MeetingRequest:return u.a.MessageRead;case u.a.MessageCompose:return u.a.MessageCompose;default:return u.a.Unknown}}function m(){Object(s.db)("Persistent"),f({hostItemIndex:null,mode:u.a.Unknown,isNullSent:!1})}var g=n(0),v=n(4070);function h(e){var t,n=d();n.mode!==u.a.MessageCompose&&n.mode!==u.a.Unknown?(Object(s.kb)(e),n.isNullSent||((t=Object(s.B)("Persistent"))&&Object(v.d)(v.a.ITEM_CHANGED_EVENT_DISPID,t.controlId,null),f({hostItemIndex:null,mode:u.a.MessageRead,isNullSent:!0}))):m()}var y=n(5068);function b(e){Object(y.a)(0),Object(s.B)("Persistent")?(Object(s.lb)(e),function(e){g.__awaiter(this,void 0,void 0,function(){var t,n;return g.__generator(this,function(r){switch(r.label){case 0:return(t=Object(s.B)("Persistent"))?[4,Object(o.b)(t.controlId,e)]:[3,2];case 1:n=r.sent(),Object(v.d)(v.a.ITEM_CHANGED_EVENT_DISPID,t.controlId,n),r.label=2;case 2:return[2]}})})}(e)):c(e),f({hostItemIndex:e,mode:p(e),isNullSent:!1})}var _=n(4141),S=n(1343);function C(e,t){if(Object(_.c)())switch(e){case S.a.NotSupported:m();break;case S.a.Empty:h(1);break;case S.a.Multi:h(2);break;case S.a.Single:t&&function(e){Object(o.k)(e)&&Object(s.L)()&&Object(i.e)()&&!function(e){var t=Object(o.n)(e);return t.mode===u.a.MessageRead&&t.isInlineComposeOpen()}(e)&&function(e){var t=Object(o.n)(e);return t.mode!==u.a.MessageRead||t.isItemSelected()}(e)&&!function(e){return e===d().hostItemIndex}(e)&&(function(e){var t=Object(o.n)(e),n=t.mode;return!(!Object(a.d)("addin-delegateAccess")&&t.isSharedItem&&t.isSharedItem())&&(n!==u.a.MessageRead||Object(s.Z)(t.getItem()))}(e)?function(e){return p(e)!==d().mode}(e)?function(e){Object(s.db)("Persistent"),c(e),f({hostItemIndex:e,mode:p(e),isNullSent:!1})}(e):!function(e){var t=Object(o.n)(e),n=Object(s.B)("Persistent");return!!n&&!Object(s.g)(n.addinCommand)&&!!(t&&t.isSharedItem&&t.isSharedItem())}(e)?b(e):h(4):h(3))}(t)}}n.d(t,"a",function(){return C})},5481:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(3548),o=n(3538);function i(e){var t=Object(o.t)().EnabledAddinCommands;return t?t.getExtensionPoint(r.a.TrapOnSendEvent).map(function(t){return t.AddinCommands.get(e.toString())}):[]}},5482:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(4773),o=n(3620),i=n(4377),a=n(3538);function s(e,t,n,s){Object(r.a)(e);var c=Object(a.B)("Persistent");if(!(c&&(u=c.addinCommand,l=t,u&&l&&u.get_Id()===l.get_Id()))){var u,l,d=Object(o.n)(e);d.openTaskPane&&d.openTaskPane();var f=Object(a.y)();Object(a.X)(f,e,t,function(e,t){var n=Object(i.c)(t);if(!n)return"NonPersistent";var r=n.addinId,o=n.commandId;return e.get_Id()===""+r+o?"Persistent":"NonPersistent"}(t,n),n,s)}}},5483:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r,o=n(2),i=n(70),a=n(5705),s=n(6128);function c(){Object(s.a)().then(function(e){var t=e,n=o.createElement(a.a,{storeUrl:t});i.render(n,r).setPanelOpen()})}r=document.createElement("div"),document.body.appendChild(r)},5532:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),o=n(276),i=n(4826);function a(e,t,n,a){var s="read/"+encodeURIComponent(e);Object(o.c)("calendar",s,r.__assign({},n,{entrySource:t}),i.a,!1,t)}},555:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Parent=0]="Parent",e[e.Self=1]="Self"}(r||(r={}))},5577:function(e){e.exports={a:"Fea"}},564:function(e,t,n){"use strict";n.d(t,"b",function(){return m}),n.d(t,"a",function(){return v});var r=n(663),o="SearchFolderId",i="PersonaId",a="MainEmailAddress",s="EmailAddresses",c="ContactDisplayName",u="ContactMainEmailAddress",l="PdlId",d="MemberNames",f="EmailAddress",p="ExtDirId";function m(e,t){var n=e.SingleValueSettings&&e.SingleValueSettings.filter(function(e){return e.Key==t});return n&&1===n.length?n[0].Value:void 0}function g(e,t){var n=e.MultiValueSettings&&e.MultiValueSettings.filter(function(e){return e.Key==t});return n&&1===n.length?n[0].Values:[]}function v(e,t){var n;switch(t){case"folder":n={treeType:"favorites",favoriteId:e.Id,type:"folder",displayName:e.DisplayName,folderId:Object(r.b)(e.SingleValueSettings[0].Value),client:e.Client,lastModifiedTime:e.LastModifiedTime};break;case"persona":var v=m(e,o),h=v?Object(r.b)(v):null,y=g(e,s),b=m(e,a),_=m(e,i),S=m(e,c),C=m(e,u);n={treeType:"favorites",favoriteId:e.Id,type:"persona",displayName:e.DisplayName,client:e.Client,lastModifiedTime:e.LastModifiedTime,searchFolderId:h,allEmailAddresses:y,mainEmailAddress:b,isSearchFolderPopulated:!!h,personaId:_,contactDisplayName:S,contactMainEmailAddress:C,isSyncUpdateDone:!1};break;case"privatedistributionlist":for(var O=m(e,o),I=O?Object(r.b)(O):null,A=m(e,l),T=m(e,"PersonaId"),E=T?Object(r.b)(T):null,x=g(e,s),P=g(e,d),M=[],w=0;w<x.length;w++)M.push({name:P[w],emailAddress:x[w]});n={treeType:"favorites",favoriteId:e.Id,type:"privatedistributionlist",displayName:e.DisplayName,client:e.Client,lastModifiedTime:e.LastModifiedTime,searchFolderId:I,isSearchFolderPopulated:!!I,pdlId:A,members:M,owsPersonaId:E};break;case"group":n={treeType:"favorites",favoriteId:e.Id,type:"group",displayName:e.DisplayName,groupId:e.SingleValueSettings[0].Value.toLowerCase(),client:e.Client,lastModifiedTime:e.LastModifiedTime,groupSmtp:m(e,f).toLowerCase(),groupExternalDirectoryObjectId:m(e,p)};break;case"category":n={treeType:"favorites",favoriteId:e.Id,type:"category",displayName:e.DisplayName,categoryId:e.SingleValueSettings[0].Value,client:e.Client,lastModifiedTime:e.LastModifiedTime};break;case"search":n={treeType:"favorites",favoriteId:e.Id,type:"search",displayName:e.DisplayName,searchQuery:e.SingleValueSettings[0].Value,client:e.Client,lastModifiedTime:e.LastModifiedTime};break;case"publicFolder":n={treeType:"favorites",favoriteId:e.Id,type:"publicFolder",displayName:e.DisplayName,publicFolderId:m(e,"FolderId"),client:e.Client,lastModifiedTime:e.LastModifiedTime};break;default:n={treeType:"favorites",favoriteId:e.Id,type:e.Type,displayName:e.DisplayName,client:e.Client,lastModifiedTime:e.LastModifiedTime}}return n}},565:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"d",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return u});var r=n(148),o=n(430);function i(e){return e.reduce(function(e,t){return e+r.f+t.split("").join(r.f)},r.e)}function a(e,t){var n=t.length,r=t.slice().pop(),i=e.slice();return Object(o.a)(i,n-1,r)}function s(e){return"["+r.b+'="'+i(e)+'"]'}function c(e){return"["+r.a+'="'+e+'"]'}function u(e){var t=" "+r.d;return e.length?t+" "+i(e):t}},566:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return f}),n.d(t,"c",function(){return p});var r=n(1033),o=n.n(r),i=n(95),a=n(5),s=n(57),c=n.n(s),u="ReactConversationListView",l="ReactConversationSentItemsListView",d="ReactFindConversationSearchFolderListView";function f(e){return e&&"scheduled"==Object(i.a)(e)?o()({BaseShape:"IdOnly",AdditionalProperties:[c()({FieldURI:"ConversationReturnTime"})]}):o()({BaseShape:"IdOnly"})}function p(e,t){return"sentitems"==Object(i.a)(e)||"drafts"==Object(i.a)(e)?l:Object(a.d)("tri-conversationView-folderTags")&&t?d:u}},57:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"PropertyUri:#Exchange"},e)}},570:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.AsyncSendFailed=0]="AsyncSendFailed",e[e.AddFavoritePersonaFailedNotification=1]="AddFavoritePersonaFailedNotification",e[e.RemoveFavoritePersonaFailedNotification=2]="RemoveFavoritePersonaFailedNotification",e[e.PeopleHubNotification=3]="PeopleHubNotification",e[e.SkypeNotification=4]="SkypeNotification",e[e.SkypeForBusinessNotification=5]="SkypeForBusinessNotification"}(r||(r={}))},5703:function(e){e.exports={a:"ntb",b:"otb"}},5704:function(e,t,n){var r=n(6618),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},5705:function(e,t,n){"use strict";var r=n(0),o=n(5706),i=n(4),a=n(20),s=n(2),c=n(1354),u=n(1166),l=n(5),d=n(1897),f=n(3489),p=n(922),m=n(6639),g=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isPanelOpen:!0},n}return r.__extends(t,e),t.prototype.setPanelOpen=function(){this.setState({isPanelOpen:!0})},t.prototype.openSendFeedbackCompose=function(){c.a.sendFeedback()},t.prototype.render=function(){var e=this;return Object(l.d)("addin-centerAlignedICSEnabled")?s.createElement(d.a,{isOpen:this.state.isPanelOpen,onDismiss:function(){return e.setState({isPanelOpen:!1})}},s.createElement("div",{className:m.container},s.createElement(u.a,{className:m.closeButton,onClick:function(){e.setState({isPanelOpen:!1})},iconProps:{iconName:"Cancel"}}),s.createElement("iframe",{src:this.props.storeUrl,title:"",className:m.inClientStoreIFrameCenter,frameBorder:0})),Object(l.d)("addin-inClientStoreSendFeedbackEnabled")&&s.createElement("div",{className:m.FeedbackCommandBarCenter},s.createElement("div",{onClick:this.openSendFeedbackCompose},Object(i.a)(o.a)))):s.createElement(f.a,{isOpen:this.state.isPanelOpen,type:p.a.largeFixed,isLightDismiss:!0,focusTrapZoneProps:{forceFocusInsideTrap:!1},onDismiss:function(){return e.setState({isPanelOpen:!1})},className:m.inClientStorePanelContainer},s.createElement("iframe",{src:this.props.storeUrl,title:"",className:m.inClientStoreIFrame,frameBorder:0}),Object(l.d)("addin-inClientStoreSendFeedbackEnabled")&&s.createElement("div",{className:m.FeedbackCommandBar},s.createElement("div",{onClick:this.openSendFeedbackCompose},Object(i.a)(o.a))))},t=r.__decorate([a.observer],t)}(s.Component);t.a=g},5706:function(e){e.exports={a:"nGa"}},5707:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"DisableExtensionJsonRequest:#Exchange"},e)}},5708:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UninstallExtensionJsonRequest:#Exchange"},e)}},5709:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"EnableAppDataRequest:#Exchange"},e)}},575:function(e,t,n){"use strict";t.a={popouts:null}},5784:function(e){e.exports={a:"YGa"}},603:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"Folder:#Exchange"},e)}},604:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(1493);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("FindFolder",e,t)}},605:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindFolderRequest:#Exchange"},e)}},61:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"h",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"e",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"f",function(){return c}),n.d(t,"j",function(){return u}),n.d(t,"i",function(){return l}),n.d(t,"g",function(){return d}),n.d(t,"c",function(){return f});var r="archivemsgfolderroot",o="msgfolderroot",i="archivedeleteditems",a="deleteditems",s="archiverecoverableitemsdeletions",c="recoverableitemsdeletions",u="msgfolderroot",l="sharedFolderTree",d="primaryFolderTree",f="archiveFolderTree"},6128:function(e,t,n){"use strict";n(3792);var r=n(3905),o=n(4076),i=n(4565),a=n.n(i),s=n(4776),c=n.n(s),u=n(15),l=n(1162);function d(e){e.registerMethod("InstallOutlookWebExt",function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:e[1],MarketplaceContentMarket:e[0],Client:"WAC_Outlook",ClientVersion:Object(u.i)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:null},n={Header:Object(l.getJsonRequestHeader)(o.f()),Body:t},i=a()(n),s=Object(r.b)();return c()(i,s)})(e).then(function(n){if("Error"==n.Body.ResponseClass.toString())t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1);else{var r=n.Body.Extension?n.Body.Extension.MarketplaceAssetID:e[1],i=!!n.Body.WasFirstInstall;t([r,i],0),o.g()}})},Microsoft.Office.Common.InvokeType.async,!1)}var f=n(9),p=n(56),m=n(3538),g=n(141);var v=n(5707),h=n.n(v),y=n(6642),b=n.n(y);function _(e){e.registerMethod("DisableOutlookWebExt",function(e,t){(function(e){var t={__type:"DisableAppRequest:#Exchange",ID:e.toString(),DisableReason:"NoReason"},n={Header:Object(l.getJsonRequestHeader)(o.f()),Body:t},i=h()(n),a=Object(r.b)();return b()(i,a)})(e).then(function(n){"Error"==n.Body.ResponseClass.toString()?t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1):t([e.toString()],0),o.g()})},Microsoft.Office.Common.InvokeType.async,!1)}var S=n(5);var C=n(5708),O=n.n(C),I=n(6643),A=n.n(I);function T(e){e.registerMethod("UninstallOutlookWebExt",function(e,t){(function(e){var t={__type:"UninstallAppRequest:#Exchange",ID:e.toString()},n={Header:Object(l.getJsonRequestHeader)(o.f()),Body:t},i=O()(n),a=Object(r.b)();return A()(i,a)})(e).then(function(n){"Error"==n.Body.ResponseClass.toString()?t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1):(t([e.toString()],0),o.g())})},Microsoft.Office.Common.InvokeType.async,!1)}function E(e){e.registerMethod("InstallOutlookWebExtByManifest",function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(u.i)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:e[0],Id:null};t.Manifest=o.b(t.Manifest);var n={Header:Object(l.getJsonRequestHeader)(o.f()),Body:t},i=a()(n),s=Object(r.b)();return c()(i,s)})(e).then(function(e){"Error"==e.Body.ResponseClass.toString()?t([e.Body.MessageText.toString(),e.Body.ResponseCode.toString()],-1):(t([!!e.Body.WasFirstInstall,e.Body.Extension?e.Body.Extension.Id:null,e.Body.Extension?e.Body.Extension.Enabled.toString():"false",e.Body.Extension?e.Body.Extension.ConsentState.toString():null,e.Body.Extension?e.Body.Extension.TypeString.toString():null,e.Body.Extension?e.Body.Extension.LicenseStatus.toString():null,e.Body.Extension?e.Body.Extension.TrialExpirationDate:null,e.Body.Extension?e.Body.Extension.Description:null,e.Body.Extension?e.Body.Extension.ProviderName:null,e.Body.Extension?e.Body.Extension.IconUrl:null,e.Body.Extension?e.Body.Extension.HighResolutionIconUrl:null,e.Body.Extension?e.Body.Extension.DisplayName:null,e.Body.Extension?e.Body.Extension.Requirements.toString():null,e.Body.Extension?e.Body.Extension.Version:null],0),o.g())})},Microsoft.Office.Common.InvokeType.async,!1)}function x(e){e.registerMethod("InstallOutlookWebExtByManifestUrl",function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(u.i)(),SendWelcomeEmail:!0,ManifestUrl:e[0],Manifest:null,Id:null},n={Header:Object(l.getJsonRequestHeader)(o.f()),Body:t},i=a()(n),s=Object(r.b)();return c()(i,s)})(e).then(function(e){"Error"==e.Body.ResponseClass.toString()?t([e.Body.MessageText.toString(),e.Body.ResponseCode.toString()],-1):(t([!!e.Body.WasFirstInstall,e.Body.Extension?e.Body.Extension.Id:null,!!e.Body.Extension&&e.Body.Extension.Enabled.toString(),e.Body.Extension?e.Body.Extension.ConsentState.toString():null,e.Body.Extension?e.Body.Extension.TypeString.toString():null,e.Body.Extension?e.Body.Extension.LicenseStatus.toString():null,e.Body.Extension?e.Body.Extension.TrialExpirationDate:null,e.Body.Extension?e.Body.Extension.Description:null,e.Body.Extension?e.Body.Extension.ProviderName:null,e.Body.Extension?e.Body.Extension.IconUrl:null,e.Body.Extension?e.Body.Extension.HighResolutionIconUrl:null,e.Body.Extension?e.Body.Extension.DisplayName:null,e.Body.Extension?e.Body.Extension.Requirements.toString():null,e.Body.Extension?e.Body.Extension.Version:null],0),o.g())})},Microsoft.Office.Common.InvokeType.async,!1)}function P(e){e.registerMethod("InstallOutlookWebExtByProductId",function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(u.i)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:null,Id:e},n={Header:Object(l.getJsonRequestHeader)(o.f()),Body:t},i=a()(n),s=Object(r.b)();return c()(i,s)})(e).then(function(n){if("Error"==n.Body.ResponseClass.toString())t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1);else{t([e,!1],0)}o.g()})},Microsoft.Office.Common.InvokeType.async,!1)}var M=n(5709),w=n.n(M),R=n(6644),k=n.n(R),D=n(4933);function j(e){e.registerMethod("EnableApp",function(e,t){(function(e){var t={DisplayName:e[0],RawIdentity:e[1]},n={Header:Object(l.getJsonRequestHeader)(o.f()),Identity:t},i=w()(n),a=Object(r.b)();return k()(i,a)})(e).then(function(e){t([e.WasSuccessful],0),Object(D.b)().then(function(e){Object(m.V)(e),Object(m.W)(!0)})}).catch(function(e){e.ErrorMessage?t([e.ErrorMessage],-1):t([],-1)})},Microsoft.Office.Common.InvokeType.async,!1)}var N=n(266);function F(e,t){!function(e){e.registerMethod("GetTelemetryInfoFromOutlook",function(e,t){var n=Object(m.s)(),r=Object(f.a)(),i=!r.SessionSettings.IsSPOnPrem,a=Object(p.a)(),s=i?a?"Consumer":"Business":"OnPremise";t([Object(g.a)(),r.SessionSettings.UserCulture,"16.2130.0.9999",o.c(),s,i,a,n.MarketplaceUrl,r.SessionSettings.ExternalDirectoryUserGuid,r.SessionSettings.OrganizationDomain,o.e(),"other","OWA_REACT",n.GenericInfo],0)},Microsoft.Office.Common.InvokeType.async,!1)}(e),function(e){e.registerMethod("GetAllInstalledAddIns",function(e,t){var n=Object(m.s)(),o=[];n.Extensions.forEach(function(e){"Private"!==e.TypeString&&"Default"!==e.TypeString&&o.push([e.Id,e.MarketplaceAssetID,e.Enabled.toString(),Object(r.e)(e.ConsentState),e.TypeString,e.LicenseStatus.toString(),e.TrialExpirationDate,e.IsMandatory.toString(),e.OriginString])}),t(o,0)},Microsoft.Office.Common.InvokeType.async,!1)}(e),function(e){e.registerMethod("GetAllPrivateAddIns",function(e,t){var n=Object(m.s)().Extensions,o=[];n.forEach(function(e){("Private"===e.TypeString||Object(S.d)("addin-inClientStoreDefaultAddinsEnabled")&&"Default"===e.TypeString)&&o.push([e.Id,e.Enabled.toString(),Object(r.e)(e.ConsentState),e.TypeString.toString(),e.LicenseStatus.toString(),e.TrialExpirationDate,e.Description,e.ProviderName,e.IconUrl,e.HighResolutionIconUrl,e.DisplayName,e.RequestedCapabilities.toString(),e.Version,e.OriginString,e.IsMandatory.toString()])}),t(o,0)},Microsoft.Office.Common.InvokeType.async,!1)}(e),d(e),_(e),T(e),E(e),x(e),P(e),j(e),function(e){e.registerMethod("LaunchUrl",function(e){var t=e;return window.open(t),null},Microsoft.Office.Common.InvokeType.sync,!1)}(e),function(e){e.registerMethod("UpdateAddinPinOptions",function(e){var t={readMode:e[2],composeMode:e[3],calendarMode:e[4]};N.g.importAndExecute(e[0],e[1],t)},Microsoft.Office.Common.InvokeType.async,!1)}(e),e.registerConversation(r.d(),t,null,null)}t.a=function(){var e=r.c();return Object(D.a)().then(function(){var t=r.a();return F(e,t),t})}},6131:function(e,t,n){"use strict";var r=n(0),o=n(2),i=n(6653),a=n(4),s=n(203),c=n.n(s),u=n(4564),l=n(6654),d=n(20),f=n(209),p=n(6655),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.getErrorText(this.props.errorType);return o.createElement("div",{className:p.errorContainer},o.createElement("div",{className:p.errorContent},o.createElement(f.a,{className:p.errorIcon,iconName:"OfficeAddinsLogo"}),o.createElement("span",{className:c()([p.errorTextCommon,p.errorTextTitle])},e.title),o.createElement("span",{className:c()([p.errorTextCommon,p.errorTextDescription])},e.description)))},t.prototype.getErrorText=function(e){switch(e){case 1:return{title:Object(a.a)(l.d),description:Object(a.a)(l.e)};case 2:return{title:Object(a.a)(u.d),description:Object(a.a)(u.e)};case 3:return{title:Object(a.a)(l.a),description:Object(a.a)(l.b)};case 4:return{title:Object(a.a)(l.a),description:Object(a.a)(l.c)};default:return{title:null,description:null}}},t=r.__decorate([d.observer],t)}(o.Component),g=n(6657),v=n(629),h=n(63),y=n(871),b=n(5070),_=function(e){function t(t){var n=e.call(this,t)||this;return n.onLoadingStateChanged=function(e){e==h.c.error?n.setState({hasLoadFailed:!0}):n.setState({hasLoadFailed:!1})},n.state={hasLoadFailed:!1},n}return r.__extends(t,e),t.prototype.render=function(){return this.state.hasLoadFailed?o.createElement(f.a,{iconName:"Photo2",iconType:v.a.default,className:c()([b.fallbackIcon,this.props.className])}):o.createElement(y.a,{onLoadingStateChange:this.onLoadingStateChanged,src:this.props.src,width:this.props.width,height:this.props.height,imageFit:h.b.contain,className:this.props.className})},t=r.__decorate([d.observer],t)}(o.Component),S=n(1166),C=n(5070),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.getPersistButtonIcon(),t=this.getPersistButtonText();return o.createElement(S.a,{className:C.persistIcon,onClick:this.props.togglePersist,title:t,ariaLabel:t,iconProps:{iconName:e}})},t.prototype.getPersistButtonText=function(){var e=this.props.isPersisted?Object(a.a)(u.g):Object(a.a)(u.f);return Object(a.b)(e,this.props.displayName)},t.prototype.getPersistButtonIcon=function(){return this.props.isPersisted?"Pinned":"Pin"},t=r.__decorate([d.observer],t)}(o.Component),I=n(4141),A=n(5070),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.focusCloseButton=function(){this.closeButton&&this.closeButton.focus()},t.prototype.render=function(){var e=this,t=this.props.isCalendar;return o.createElement("div",{className:c()(A.addinPaneHeader,t&&A.addinPaneHeaderCalendar)},o.createElement(_,{src:this.props.iconUrl,width:32,height:32,className:A.addinPaneIcon}),o.createElement("div",{className:c()([A.addinPaneLabelText,A.ellipsis])},this.props.displayName),o.createElement("div",{className:A.rightButtons},Object(I.c)()&&this.props.isPersistable&&!t&&o.createElement(O,{displayName:this.props.displayName,isPersisted:this.props.isPersisted,togglePersist:this.props.togglePersist}),o.createElement(S.a,{componentRef:function(t){return e.closeButton=t},className:A.closeButton,onClick:this.props.closeOnClick,ariaLabel:Object(a.a)(g.a),iconProps:{iconName:"Cancel"}})))},t=r.__decorate([d.observer],t)}(o.Component),E=n(4689),x=n(2296),P=n(3489),M=n(6659),w=function(e){return e.renderInPanel?o.createElement(P.a,{focusTrapZoneProps:{forceFocusInsideTrap:!1,disableFirstFocus:e.disableFirstFocus,isClickableOutsideFocusTrap:!0},hasCloseButton:!1,isOpen:!0,onDismiss:e.onDismiss,className:c()(M.taskPane,e.isDeepLink&&M.taskPaneNoHeader),isBlocking:!1,isFooterAtBottom:!0,isLightDismiss:!0},e.children):o.createElement(x.a,{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,className:M.taskPane},e.children)},R=n(3620),k=n(3548),D=n(1821),j=n(4777),N=(n(3792),n(3538)),F=n(4377),L=n(6661),U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.focusTaskPaneHeader=function(){t.taskPaneHeader&&t.taskPaneHeader.focusCloseButton()},t.renderError=function(){var e=t.props.instance.errorType;return t.hasError()&&o.createElement(m,{errorType:e})},t.renderOsfHostContainer=function(){var e=t.props.instance,n=e.hostItemIndex,r=e.controlId,i=e.addinCommand,a={};return a[15]=t.focusTaskPaneHeader,a[14]=t.focusTaskPaneHeader,a[13]=t.focusTaskPaneHeader,o.createElement(j.a,{addinCommand:i,controlId:r,className:c()([L.extensionHost,t.hasError()&&L.hide]),hostItemIndex:n,manifestCacheProvider:E.a,notifyHostActions:a})},t.hasError=function(){return 0!==t.props.instance.errorType},t.close=function(){var e=t.props.instance,n=e.mode,r=e.controlId;t.isPersisted()&&Object(F.h)(n,null),Object(R.f)(r)},t.togglePersist=function(){var e=t.isPersisted()?null:Object(F.b)(t.props.instance.addinCommand);Object(F.h)(t.props.instance.mode,e),Object(N.fb)(t.props.type)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.instance,n=void 0===this.props.renderInPanel||this.props.renderInPanel;if(!t)return o.createElement("div",{className:L.divContainer});var r=t.addinCommand;return o.createElement(w,{renderInPanel:n,onDismiss:this.close,isDeepLink:Object(D.a)(),disableFirstFocus:this.isPersisted()},o.createElement(T,{iconUrl:r.extension.IconUrl,displayName:r.extension.DisplayName,closeOnClick:this.close,ref:function(t){return e.taskPaneHeader=t},isCalendar:this.isCalendar(),isPersistable:this.supportsPersisted(),isPersisted:this.isPersisted(),togglePersist:this.togglePersist}),o.createElement("div",{tabIndex:0,className:c()(L.extensionContainer,this.isCalendar()&&L.extensionContainerCalendar),"aria-label":Object(a.b)(Object(a.a)(i.a),r.extension.DisplayName),role:"complementary"},this.renderError(),this.renderOsfHostContainer()))},t.prototype.supportsPersisted=function(){return Object(F.a)(this.props.instance.addinCommand)},t.prototype.isCalendar=function(){return this.props.instance.mode===k.a.AppointmentAttendee||this.props.instance.mode===k.a.AppointmentOrganizer},t.prototype.isPersisted=function(){return"Persistent"===this.props.type},t=r.__decorate([d.observer],t)}(o.Component),B=n(1256),H=n(4077),V=n(1462),W="addinTaskPane";var G=n(15),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidUpdate=function(){if("Mail"===Object(G.b)()){var e=Object(N.t)().taskPanes;!this.previousTaskPanesSize&&e.size?(Object(B.a)(W,!0,!1),V.b.importAndExecute(),H.a.importAndExecute()):this.previousTaskPanesSize&&!e.size&&(Object(B.a)(W,!1,!1),V.b.importAndExecute()),this.previousTaskPanesSize=e.size}},t.prototype.renderTaskPane=function(e){var t=Object(N.B)(e);return t&&o.createElement(U,{key:t.controlId,type:e,instance:t,renderInPanel:this.props.renderTaskPaneInPanel})},t.prototype.render=function(){var e=Object(I.c)()&&this.renderTaskPane("Persistent"),t=this.renderTaskPane("NonPersistent");return o.createElement(o.Fragment,null,[e,t])},t=r.__decorate([d.observer],t)}(o.Component);t.a=z},6133:function(e,t,n){"use strict";var r=n(94),o=n(75),i="/ows/api/beta/PersistedAddins";function a(e,t,n){var a=Object(r.a)();Object(o.c)(i,{Addin:{mode:e,addinId:t,commandId:n}},a)}var s=n(0),c=n(252);function u(){return s.__awaiter(this,void 0,void 0,function(){var e,t;return s.__generator(this,function(n){switch(n.label){case 0:return e=Object(r.a)(),[4,Object(o.b)(i,e,!0)];case 1:return t=n.sent(),Object(c.a)(t.status)?[4,t.text()]:[3,3];case 2:return[2,n.sent()];case 3:return[2,"{}"]}})})}n.d(t,"b",function(){return a}),n.d(t,"a",function(){return u})},6141:function(e,t,n){"use strict";var r=n(0),o=n(4070),i=n(3538),a=function(e){Object(i.t)().activeDialog&&Object(i.t)().activeDialog.parentControlId==e&&Object(o.j)({eventDispId:o.a.DISPLAY_DIALOG_DISPID,controlId:e}),Object(i.F)(e)};function s(e){Object(i.t)().runningUILessAddinCommands.has(e)&&r.__spread(Object(i.t)().runningUILessAddinCommands.get(e).keys()).forEach(function(t,n){!function(e,t,n){a(e),Object(i.eb)(e,t,n)}(t,e,i.d.NavigatedBeforeCompleted)})}function c(e){s(e),Object(i.h)(e)}n.d(t,"a",function(){return c})},6165:function(e,t,n){"use strict";var r;!function(e){e.MailRead="MailRead",e.MailCompose="MailCompose",e.NoEndpoint=""}(r||(r={}));var o=r,i=n(3548);function a(e){switch(e){case i.a.MessageRead:case i.a.MeetingRequest:return o.MailRead;case i.a.MessageCompose:return o.MailCompose;default:return o.NoEndpoint}}n.d(t,"a",function(){return a})},617:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",function(e,t){return{itemIdToRemove:e,removeItemSource:t}})},6186:function(e,t,n){"use strict";function r(e){var t=e&&e.Action;return t&&!!t.SourceLocation}function o(e){var t=e&&e.Action;return t&&!!t.FunctionName}function i(e){return!!e&&!!e.MenuItems}n.d(t,"c",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i})},6187:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(3538);function o(e,t){var n=Object(r.y)();Object(r.T)(n,e,t)}},6188:function(e,t,n){"use strict";var r=n(2),o=n(629),i=n(209),a=n(63),s=n(6668);t.a=function(e){return{iconType:o.a.Image,imageProps:{src:e,width:16,height:16,imageFit:a.b.contain,shouldFadeIn:!1},styles:{root:{width:"16px !important",height:"16px !important"}},imageErrorAs:function(e){return r.createElement(i.a,{className:s.fallbackIcon,iconName:"Photo2",iconType:o.a.Default})}}}},6189:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return u});var r=n(6670),o=n(4),i=n(5483),a=n(629),s=n(171);function c(){return{key:"AddinMarketplace",name:Object(o.a)(r.a),title:Object(o.a)(r.a),ariaLabel:Object(o.a)(r.a),iconProps:{iconName:"AddIn",iconType:a.a.default},itemType:s.a.Normal,onClick:function(){Object(i.a)()}}}function u(){return{key:"AddinMarketplaceDivider",displayName:"-",itemType:s.a.Divider,iconProps:{iconName:"AddIn",iconType:a.a.default},onClick:null}}},644:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(72);function o(){return r.a.selectedTableViewId}},648:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FolderResponseShape:#Exchange"},e)}},656:function(e,t,n){"use strict";var r=n(384),o=n(216),i="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",c="[object Proxy]";t.a=function(e){if(!Object(o.a)(e))return!1;var t=Object(r.a)(e);return t==a||t==s||t==i||t==c}},657:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),o=n(237),i=n(430),a=n(115),s=n(148),c=function(){function e(){this.keytips=[],this.persistedKeytips=[],this.inKeytipMode=!1,this.shouldEnterKeytipMode=!0}return e.getInstance=function(){return this._instance},e.prototype.register=function(e,t){void 0===t&&(t=!1);var n=e;t||(n=this.addParentOverflow(e));var r=this._getUniqueKtp(n);t?this.persistedKeytips.push(r):this.keytips.push(r);var i=t?s.g.PERSISTED_KEYTIP_ADDED:s.g.KEYTIP_ADDED;return o.a.raise(this,i,{keytip:n,uniqueID:r.uniqueID}),r.uniqueID},e.prototype.update=function(e,t){var n=this.addParentOverflow(e),r=this._getUniqueKtp(n,t),a=Object(i.e)(this.keytips,function(e){return e.uniqueID===t});a>=0&&(r.keytip.visible=this.keytips[a].keytip.visible,this.keytips=Object(i.h)(this.keytips,r,a),o.a.raise(this,s.g.KEYTIP_UPDATED,{keytip:r.keytip,uniqueID:r.uniqueID}))},e.prototype.unregister=function(e,t,n){void 0===n&&(n=!1),n?this.persistedKeytips=this.persistedKeytips.filter(function(e){return e.uniqueID!==t}):this.keytips=this.keytips.filter(function(e){return e.uniqueID!==t});var r=n?s.g.PERSISTED_KEYTIP_REMOVED:s.g.KEYTIP_REMOVED;o.a.raise(this,r,{keytip:e,uniqueID:t})},e.prototype.enterKeytipMode=function(){o.a.raise(this,s.g.ENTER_KEYTIP_MODE)},e.prototype.exitKeytipMode=function(){o.a.raise(this,s.g.EXIT_KEYTIP_MODE)},e.prototype.getKeytips=function(){return this.keytips.map(function(e){return e.keytip})},e.prototype.addParentOverflow=function(e){var t=e.keySequences.slice();if(t.pop(),0!==t.length){var n=Object(i.d)(this.getKeytips(),function(e){return Object(i.b)(t,e.keySequences)});if(n&&n.overflowSetSequence)return r.__assign({},e,{overflowSetSequence:n.overflowSetSequence})}return e},e.prototype.menuExecute=function(e,t){o.a.raise(this,s.g.PERSISTED_KEYTIP_EXECUTE,{overflowButtonSequences:e,keytipSequences:t})},e.prototype._getUniqueKtp=function(e,t){return void 0===t&&(t=Object(a.c)()),{keytip:r.__assign({},e),uniqueID:t}},e._instance=new e,e}()},658:function(e,t,n){"use strict";n.d(t,"b",function(){return C}),n.d(t,"a",function(){return O}),n.d(t,"c",function(){return I});var r,o=n(5),i=n(1017),a=n(226),s=n.n(a),c=n(385),u=n.n(c),l=n(57),d=n.n(l),f=n(1162),p=n(9),m=n(458);!function(e){e.None="None",e.OwaProxy="OwaProxy",e.ConnectorsProxy="ConnectorsProxy",e.Compose="Compose",e.OwaAndConnectorsProxy="OwaAndConnectorsProxy",e.OwaConnectorsProxyAndCompose="OwaConnectorsProxyAndCompose"}(r||(r={}));var g,v,h="rps_"+(g=1,v=65535,Math.ceil(Math.random()*(v-g)+g)).toString(16),y=2097152,b=20,_="ExplicitMessageCard",S="00062008-0000-0000-C000-000000000046";function C(e){var t=u()({BaseShape:"IdOnly",ClientSupportsIrm:!0,FilterHtmlContent:!0,InlineImageCustomDataTemplate:m.e,InlineImageUrlOnLoadTemplate:"",InlineImageUrlTemplate:m.g,AdditionalProperties:[d()({FieldURI:"ItemLastModifiedTime"})]});return Object(o.d)("cmp-clp")&&A(t),e&&(t.BodyType=e),t.ImageProxyCapability=Object(o.d)("rp-replyImageProxy")&&Object(i.a)()?r.OwaConnectorsProxyAndCompose:r.None,t}function O(){var e,t=u()({BaseShape:"IdOnly",AddBlankTargetToLinks:!0,BlockContentFromUnknownSenders:(e=Object(p.a)(),!!e.SafetyUserOptions&&e.SafetyUserOptions.BlockContentFromUnknownSenders),BlockExternalImagesIfSenderUntrusted:!0,ClientSupportsIrm:!0,CssScopeClassName:h,FilterHtmlContent:!0,FilterInlineSafetyTips:!0,InlineImageCustomDataTemplate:m.e,InlineImageUrlTemplate:m.g,MaximumBodySize:y,MaximumRecipientsToReturn:b,ImageProxyCapability:Object(i.a)()?r.OwaAndConnectorsProxy:r.None,AdditionalProperties:[d()({FieldURI:"CanDelete"}),s()(Object(f.getExtendedPropertyUri)(S,_,"String"))]});return Object(o.d)("cmp-clp")&&A(t),t.InlineImageUrlOnLoadTemplate=Object(o.d)("rp-imageContentHandler")?"":m.f,t}function I(){var e=O();return e.ExcludeBindForInlineAttachments=!0,e.CalculateOnlyFirstBody=!0,e}function A(e){e.AdditionalProperties.push(s()({PropertyName:"msip_labels",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}))}},659:function(e,t,n){"use strict";var r=n(8),o=n(1),i={folderTable:new r.ObservableMap,rootFolder:null},a=Object(o.createStore)("publicFolderFavoriteStore",i)();t.a=a},66:function(e,t,n){"use strict";n.r(t);var r=n(3),o=n(1),i=n(275),a=n(1259),s=n(1539),c=n(1540);Object(o.mutator)(i.a,function(e){var t=e.temporaryData,n=e.favoriteData;Object(s.a)(t),Object(c.b)(t),Object(a.a)(n)}),Object(o.mutator)(i.c,function(e){var t=e.favoriteData;Object(a.a)(t),Object(c.a)(t)}),Object(o.mutator)(i.d,function(e){var t=e.favoriteData;Object(a.a)(t)}),Object(o.mutator)(i.b,function(e){var t=e.favoriteData;Object(c.b)(t),Object(s.a)(t)}),Object(o.mutator)(i.e,function(e){var t=e.temporaryFavorites,n=e.favoritesData;t.forEach(function(e){Object(s.a)(e)}),n.forEach(function(e){Object(a.a)(e)})}),Object(o.mutator)(i.f,function(e){e.favoritesData.forEach(function(e){Object(a.a)(e)})});var u=n(110),l=Object(o.action)("LOAD_OUTLOOK_FAVORITES"),d=Object(o.action)("ADD_TO_ORDERED_FAVORITE_ID_LIST",function(e){return{favoriteId:e}}),f=(Object(o.mutator)(d,function(e){u.a.orderedOutlookFavoritesIds.push(e.favoriteId)}),n(1179)),p=(Object(o.mutator)(f.a,function(e){u.a.favoritesLoaded=!0}),n(0)),m=Object(o.action)("ADD_NEW_MAILBOX_DEFAULT_FAVORITES"),g=n(33),v=n(21),h=n(564);function y(e,t,n){return{folderId:t.FolderId.Id,treeType:"favorites",type:"folder",favoriteId:e,displayName:t.DisplayName,client:n?"MigrateDefault":"OWA"}}function b(e,t){return{Type:"folder",DisplayName:e.DisplayName,SingleValueSettings:[{Key:"FolderId",Value:Object(fe.a)(e.FolderId.Id)}],Client:t?"MigrateDefault":"OWA"}}var _=n(94),S=n(954),C=n(75),O=n(955);function I(e){return Object(O.a)(function(){return Object(C.d)(S.a+"/Create",e,void 0,!0,null,!0)})}Object(o.orchestrator)(m,function(e){return p.__awaiter(void 0,void 0,void 0,function(){var e,t,n,r,o,a,s,c,u,l,d,f,m,S,C;return p.__generator(this,function(O){switch(O.label){case 0:e=[Object(g.a)("inbox"),Object(g.a)("drafts"),Object(g.a)("archive")],t=[],n=[];try{for(r=p.__values(e),o=r.next();!o.done;o=r.next())a=o.value,s=Object(_.a)(),c=v.n.folderTable.get(a),u=b(c,!0),l=y(s,c,!0),t.push(u),n.push(l)}catch(e){S={error:e}}finally{try{o&&!o.done&&(C=r.return)&&C.call(r)}finally{if(S)throw S.error}}O.label=1;case 1:return O.trys.push([1,3,,4]),[4,I(t)];case 2:return d=O.sent(),f=(d.value||[]).map(function(e){return Object(h.a)(e,"folder")}),Object(i.e)(n,f),[3,4];case 3:return m=O.sent(),n.forEach(function(e){return Object(i.b)(m,e)}),[3,4];case 4:return[2]}})})});var A=Object(o.action)("LOAD_FAVORITES"),T=n(1958),E=n(5),x=(Object(o.orchestrator)(A,function(e){Object(E.d)("tri-favorites-roaming")?l():Object(T.a)()}),n(9)),P=n(1499),M=n(26),w=Object(o.action)("MIGRATE_OUTLOOK_FAVORITES",function(){return Object(M.a)(P.a.MigrateOutlookFavorites)}),R=n(211),k=n(18),D=n(949),j=Object(o.action)("SET_FIRST_RUN_FAVORITES_MIGRATION_BIT"),N=36e5;Object(o.orchestrator)(l,function(e){return p.__awaiter(void 0,void 0,void 0,function(){var e;return p.__generator(this,function(t){return u.a.favoritesLoaded?[2]:(0===v.n.folderTable.size&&Object(v.B)(),function(){var e=Object(x.a)().Favorites?Object(x.a)().Favorites.value:null;if(!e)return;e.forEach(function(e){var t=e.Type.toLocaleLowerCase(),n=null;try{switch(n=Object(h.a)(e,t),t){case"folder":!function(e,t){(function(e,t){if(0===v.n.folderTable.size)return!1;return!u.a.outlookFavorites.has(e)&&v.n.folderTable.has(t)})(t,e.folderId)&&Object(i.d)(e)}(n,e.SingleValueSettings[0].Value);break;case"persona":Object(i.d)(n);break;case"group":!function(e){Object(G.d)(e.groupId)||Object(i.d)(e)}(n);break;case"category":!function(e){(function(e){return Object(R.n)(e.categoryId)&&!u.a.outlookFavorites.has(e.favoriteId)})(e)&&Object(i.d)(e)}(n);break;case"privatedistributionlist":Object(E.d)("peo-favoritePdls")&&Object(i.d)(n);break;default:d(n.favoriteId)}}catch(e){Object(k.o)("AddFavoriteToStoreInitialFailed",{favoriteType:t,errorMessage:e.toString()})}})}(),e=Object(D.a)(2),Object(D.a)(16)||w(),e||(0==u.a.orderedOutlookFavoritesIds.length&&(n=new Date(Object(x.a)().MailboxCreateDate),Date.now()-n.getTime()<N)&&m(),j()),Object(f.a)(),r=p.__spread(u.a.outlookFavorites.values()),o=r.filter(function(e){return"folder"===e.type}),a=o.filter(function(e){return"Migration"===e.client}),s=r.filter(function(e){return"category"===e.type}),c=s.filter(function(e){return"Migration"==e.client}),l=r.filter(function(e){return"persona"===e.type}),g=l.filter(function(e){return"Migration"==e.client}),y=r.filter(function(e){return"group"===e.type}),b=r.filter(function(e){return"privatedistributionlist"===e.type}),Object(k.o)("LoadOutlookFavorites",[o.length,y.length,s.length,l.length,b.length,a.length,c.length,g.length]),[2]);var n,r,o,a,s,c,l,g,y,b})})});var F=n(155),L=n(139),U=n.n(L),B=n(91),H=n.n(B),V=n(27),W=(Object(o.orchestrator)(j,function(e){var t=Object(V.f)().UserOptions;Object(D.b)(!0,2),Object(F.a)("OWA.UserOptions",[U()({DictionaryKey:H()({Type:"String",Value:["FavoritesBitFlags"]}),DictionaryValue:H()({Type:"Integer32",Value:[""+t.FavoritesBitFlags]})})])}),n(1904)),G=n(739),z=n(1170);function q(){var e=Object(u.b)();return Object(E.d)("tri-favorites-roaming")?p.__spread(e.outlookFavorites.entries()).filter(function(e){var t=p.__read(e,2);t[0];return"persona"===t[1].type}).map(function(e){var t=p.__read(e,2),n=t[0];t[1];return n}):p.__spread(e.favoritesPersonaNodes.keys())}function K(e){var t=Object(u.b)();return Object(E.d)("tri-favorites-roaming")?t.outlookFavorites.get(e):t.favoritesPersonaNodes.get(e)}function X(e){var t=K(e);return t?t.mainEmailAddress:null}function J(e){var t=K(e);return t?t.displayName:null}var Q=n(1732),Y=n(1728),Z=n(4),$=n(1948),ee=n(51),te=n(2),ne=Object(ee.a)(function(e){var t=e.isInFavorites,n=e.isClickDisabled,r=e.animate,o=e.iconStyles,i=e.buttonStyles,a=e.spinnerStyles,s=e.onClick;return te.createElement($.a,{isStarred:t,onClick:s,isClickDisabled:n,animate:r,iconStyles:o,buttonStyles:i,spinnerStyles:a,ariaLabelText:t?Object(Z.a)(Y.a):Object(Z.a)(Q.a),tooltip:{starred:Object(Z.a)(Y.a),unstarred:Object(Z.a)(Q.a)}})}),re=n(1173),oe=n(1912),ie=n(1500),ae=n(1172),se=n(1917),ce=n(1909),ue=n(1502);function le(e){return Object(E.d)("tri-favorites-roaming")?p.__spread(u.a.outlookFavorites.values()).filter(function(e){return"persona"===e.type}).some(function(t){return t.searchFolderId&&t.searchFolderId===e}):p.__spread(u.a.favoritesPersonaNodes.values()).some(function(t){return t.searchFolderId&&t.searchFolderId===e})}function de(e){return!!Object(E.d)("tri-favorites-roaming")&&p.__spread(u.a.outlookFavorites.values()).filter(function(e){return"privatedistributionlist"===e.type}).some(function(t){return t.searchFolderId&&t.searchFolderId===e})}var fe=n(663),pe=n(1501),me=n(1707),ge=n(1918),ve=n(1706),he=n(1919),ye=n(1916),be=n(1516);function _e(e,t){return function(e){var t=p.__spread(u.a.outlookFavorites.values()).filter(function(t){return"privatedistributionlist"===t.type&&t.pdlId===e});return t.length>0?t[0].favoriteId:void 0}(e)||function(e){var t=p.__spread(u.a.outlookFavorites.values()).filter(function(t){return"privatedistributionlist"===t.type&&Object(be.a)(t.members,e)});return t.length>0?t[0].favoriteId:void 0}(t)}n.d(t,"lazyMigrateFavorites",function(){return Ce}),n.d(t,"lazyMoveFavoriteUpDown",function(){return Oe}),n.d(t,"lazyUpdateFavoritePosition",function(){return Ie}),n.d(t,"lazyAddFavoriteCategory",function(){return Ae}),n.d(t,"lazyRemoveFavoriteCategory",function(){return Te}),n.d(t,"lazyRemoveFavoritePersonaV2",function(){return Ee}),n.d(t,"lazyAddFavoritePersonaV2",function(){return xe}),n.d(t,"lazyRemoveFavoriteGroup",function(){return Pe}),n.d(t,"lazyAddFavoriteGroup",function(){return Me}),n.d(t,"lazyRemoveFavoriteFolderV2",function(){return we}),n.d(t,"lazyAddFavoriteFolderV2",function(){return Re}),n.d(t,"lazyRemoveFavoritePrivateDistributionList",function(){return ke}),n.d(t,"lazyAddFavoritePrivateDistributionList",function(){return De}),n.d(t,"lazyEditFavoritePrivateDistributionList",function(){return je}),n.d(t,"lazyAddFavoriteToStore",function(){return Ne}),n.d(t,"lazyAddFavoriteCompleted",function(){return Fe}),n.d(t,"lazyAddFavoriteFailed",function(){return Le}),n.d(t,"lazyAddMultipleFavoritesToStore",function(){return Ue}),n.d(t,"lazyAddMultipleFavoritesCompleted",function(){return Be}),n.d(t,"lazyRemoveFavoriteFromStore",function(){return He}),n.d(t,"lazyRemoveFavoriteCompleted",function(){return Ve}),n.d(t,"lazyRemoveFavoriteFailed",function(){return We}),n.d(t,"addFavoriteFailed",function(){return i.b}),n.d(t,"addFavoriteToStoreInitial",function(){return i.d}),n.d(t,"removeFavoriteFailed",function(){return W.b}),n.d(t,"getStore",function(){return u.b}),n.d(t,"favoritesStore",function(){return u.a}),n.d(t,"loadFavorites",function(){return A}),n.d(t,"isFolderInFavorites",function(){return G.c}),n.d(t,"isGroupInFavorites",function(){return G.d}),n.d(t,"isPersonaInFavorites",function(){return G.e}),n.d(t,"isSearchInFavorites",function(){return G.h}),n.d(t,"isCategoryInFavorites",function(){return G.b}),n.d(t,"isPublicFolderInFavorites",function(){return G.g}),n.d(t,"isPrivateDLInFavorites",function(){return G.f}),n.d(t,"getPersonaFromPersonIdOrEmailAddress",function(){return G.a}),n.d(t,"isOutlookFavoritingInProgress",function(){return z.a}),n.d(t,"getFavoriteIdsForPersonaFavorites",function(){return q}),n.d(t,"getFavoritePersonaEmail",function(){return X}),n.d(t,"getFavoritePersonaDisplayName",function(){return J}),n.d(t,"ToggleFavoriteButton",function(){return ne}),n.d(t,"datapoints",function(){return P.a}),n.d(t,"parseFavoriteNode",function(){return re.a}),n.d(t,"updateFavoritesUserOption",function(){return oe.a}),n.d(t,"getIsBitEnabled",function(){return D.a}),n.d(t,"setFavoriteBitFlag",function(){return D.b}),n.d(t,"getFavoriteIdFromGroupId",function(){return ie.a}),n.d(t,"createOutlookFavoriteService",function(){return ae.a}),n.d(t,"editOutlookFavoriteService",function(){return se.a}),n.d(t,"deleteOutlookFavoriteService",function(){return ce.a}),n.d(t,"getFavoriteIdFromFolderId",function(){return ue.a}),n.d(t,"isFolderPersonaFavoriteSearchFolder",function(){return le}),n.d(t,"isFolderPrivateDLFavoriteSearchFolder",function(){return de}),n.d(t,"convertEWSFolderIdToRestFolderId",function(){return fe.a}),n.d(t,"convertRestFolderIdToEWSFolderId",function(){return fe.b}),n.d(t,"getFavoriteIdFromCategoryId",function(){return pe.a}),n.d(t,"createMultipleOutlookFavoritesService",function(){return I}),n.d(t,"createClientFavoriteCategoryData",function(){return me.a}),n.d(t,"createOwsFavoriteCategoryData",function(){return me.b}),n.d(t,"createOwsFavoriteFolderData",function(){return ge.a}),n.d(t,"migrateOutlookFavorites",function(){return w}),n.d(t,"onCategoryFavorited",function(){return ve.a}),n.d(t,"onCategoryUnfavorited",function(){return ve.b}),n.d(t,"convertFavoritePersonaDataToFavoritePersonaNode",function(){return he.a}),n.d(t,"convertFavoritePdlDataToFavoritePdlNode",function(){return ye.a}),n.d(t,"convertServiceResponseToFavoriteData",function(){return h.a}),n.d(t,"getSingleValueSettingValueForKey",function(){return h.b}),n.d(t,"getFavoriteIdForPDL",function(){return _e});var Se=new r.c(function(){return n.e(195).then(n.bind(null,11669))}),Ce=new r.a(Se,function(e){return e.migrateFavorites}),Oe=new r.b(Se,function(e){return e.moveFavoriteUpDown}),Ie=new r.b(Se,function(e){return e.updateFavoritePosition}),Ae=new r.b(Se,function(e){return e.addFavoriteCategory}),Te=new r.b(Se,function(e){return e.removeFavoriteCategory}),Ee=new r.b(Se,function(e){return e.removeFavoritePersonaV2}),xe=new r.b(Se,function(e){return e.addFavoritePersonaV2}),Pe=new r.b(Se,function(e){return e.removeFavoriteGroup}),Me=new r.b(Se,function(e){return e.addFavoriteGroup}),we=new r.b(Se,function(e){return e.removeFavoriteFolderV2}),Re=new r.b(Se,function(e){return e.addFavoriteFolderV2}),ke=new r.b(Se,function(e){return e.removeFavoritePrivateDistributionList}),De=new r.b(Se,function(e){return e.addFavoritePrivateDistributionList}),je=new r.b(Se,function(e){return e.editFavoritePrivateDistributionList}),Ne=new r.b(Se,function(e){return e.addFavoriteToStore}),Fe=new r.b(Se,function(e){return e.addFavoriteCompleted}),Le=new r.b(Se,function(e){return e.addFavoriteFailed}),Ue=new r.b(Se,function(e){return e.addMultipleFavoritesToStore}),Be=new r.b(Se,function(e){return e.addMultipleFavoritesCompleted}),He=new r.b(Se,function(e){return e.removeFavoriteFromStore}),Ve=new r.b(Se,function(e){return e.removeFavoriteCompleted}),We=new r.b(Se,function(e){return e.removeFavoriteFailed})},660:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r="Success";function o(e){return e&&e.ResponseClass==r}},661:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var r=n(1357),o=n.n(r),i=n(1358),a=n.n(i),s=n(230),c=n.n(s),u=n(29),l=n(5),d=n(57),f=n.n(d),p=n(56);function m(e,t,n,r,i,s){var d=Object(u.getJsonRequestHeader)();if(r&&(d.RequestServerVersion=r),Object(p.a)()&&Object(l.d)("rp-amp")){var m=f()({FieldURI:"AmpHtmlBody"});t.AdditionalProperties?t.AdditionalProperties.push(m):t.AdditionalProperties=[m]}var g=e.map(function(e){return c()({Id:e})});return o()({Header:d,Body:a()({ItemShape:t,ItemIds:g,ShapeName:n,InternetMessageId:s})},i).then(function(e){return e.Body.ResponseMessages.Items})}},6614:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(6615);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("UpdateClientExtensionNotifications",e,t)}},6615:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateClientExtensionNotificationsJsonRequest:#Exchange"},e)}},6616:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateClientExtensionNotificationsRequest:#Exchange"},e)}},6617:function(e){e.exports={a:"ptb"}},6618:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,"._1ehE94wkOCsOeE73Qu5s41{width:300px;height:71px}._3imQjBaji-SGvUX3dMlZrz{display:none!important}",""]),t.locals={consentContainer:"_1ehE94wkOCsOeE73Qu5s41",hiddenContainer:"_3imQjBaji-SGvUX3dMlZrz"}},6619:function(e){e.exports={a:"mtb"}},6620:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59);t.default=function(e,t){return r.makeServiceRequest("SanitizeHtml",e,t)}},6621:function(e,t){
/*!
    Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.

    This file also contains the following Promise implementation (with a few small modifications):
        * @overview es6-promise - a tiny implementation of Promises/A+.
        * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
        * @license   Licensed under MIT license
        *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
        * @version   2.3.0
*/
var n,r;n=l||(l={}),r=function(){var e=!0;function t(){}return t.prototype.isMsAjaxLoaded=function(){var t="function",n="undefined";return!!(typeof Sys!==n&&typeof Type!==n&&Sys.StringBuilder&&typeof Sys.StringBuilder===t&&Type.registerNamespace&&typeof Type.registerNamespace===t&&Type.registerClass&&typeof Type.registerClass===t&&typeof Function._validateParams===t&&Sys.Serialization&&Sys.Serialization.JavaScriptSerializer&&typeof Sys.Serialization.JavaScriptSerializer.serialize===t)&&e},t.prototype.loadMsAjaxFull=function(e){var t=("https:"===window.location.protocol.toLowerCase()?"https:":"http:")+"//ajax.aspnetcdn.com/ajax/3.5/MicrosoftAjax.js";i.OUtil.loadScript(t,e)},Object.defineProperty(t.prototype,"msAjaxError",{get:function(){var e=this;return null==e._msAjaxError&&e.isMsAjaxLoaded()&&(e._msAjaxError=Error),e._msAjaxError},set:function(e){this._msAjaxError=e},enumerable:e,configurable:e}),Object.defineProperty(t.prototype,"msAjaxString",{get:function(){var e=this;return null==e._msAjaxString&&e.isMsAjaxLoaded()&&(e._msAjaxString=String),e._msAjaxString},set:function(e){this._msAjaxString=e},enumerable:e,configurable:e}),Object.defineProperty(t.prototype,"msAjaxDebug",{get:function(){var e=this;return null==e._msAjaxDebug&&e.isMsAjaxLoaded()&&(e._msAjaxDebug=Sys.Debug),e._msAjaxDebug},set:function(e){this._msAjaxDebug=e},enumerable:e,configurable:e}),t}(),n.MicrosoftAjaxFactory=r;var o=new l.MicrosoftAjaxFactory,i=i||{};!function(e){var t=function(){function e(e){this._internalStorage=e}return e.prototype.getItem=function(e){try{return this._internalStorage&&this._internalStorage.getItem(e)}catch(e){return null}},e.prototype.setItem=function(e,t){try{this._internalStorage&&this._internalStorage.setItem(e,t)}catch(e){}},e.prototype.clear=function(){try{this._internalStorage&&this._internalStorage.clear()}catch(e){}},e.prototype.removeItem=function(e){try{this._internalStorage&&this._internalStorage.removeItem(e)}catch(e){}},e.prototype.getKeysWithPrefix=function(e){var t=[];try{for(var n=this._internalStorage&&this._internalStorage.length||0,r=0;r<n;r++){var o=this._internalStorage.key(r);0===o.indexOf(e)&&t.push(o)}}catch(e){}return t},e}();e.SafeStorage=t}(l||(l={})),i.XdmFieldName={ConversationUrl:"ConversationUrl",AppId:"AppId"},i.WindowNameItemKeys={BaseFrameName:"baseFrameName",HostInfo:"hostInfo",XdmInfo:"xdmInfo",SerializerVersion:"serializerVersion",AppContext:"appContext"},i.OUtil=function(){var e="focus",t="on",n="configurable",r="writable",a="enumerable",s="",c="undefined",u=!1,d=!0,f=2147483647,p=null,m=-1,g=m,v="&_xdm_Info=",h="&_serializer_version=",y="_xdm_",b="#",_="class",S={},C=p,O=p,I=(new Date).getTime();function A(){var e=f*Math.random();return(e^=I^(new Date).getMilliseconds()<<Math.floor(21*Math.random())).toString(16)}function T(){if(!C){try{var e=window.sessionStorage}catch(t){e=p}C=new l.SafeStorage(e)}return C}function E(e){for(var t,n=[],r=[],o=e.length,i=0;i<o;i++)(t=e[i]).tabIndex?t.tabIndex>0?r.push(t):0===t.tabIndex&&n.push(t):n.push(t);return r=r.sort(function(e,t){var n=e.tabIndex-t.tabIndex;return 0===n&&(n=r.indexOf(e)-r.indexOf(t)),n}),[].concat(r,n)}return{set_entropy:function(e){if("string"==typeof e)for(var t=0;t<e.length;t+=4){for(var n=0,r=0;r<4&&t+r<e.length;r++)n=(n<<8)+e.charCodeAt(t+r);I^=n}else I^="number"==typeof e?e:f*Math.random();I&=f},extend:function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.uber=t.prototype,t.prototype.constructor===Object.prototype.constructor&&(t.prototype.constructor=t)},setNamespace:function(e,t){t&&e&&!t[e]&&(t[e]={})},unsetNamespace:function(e,t){t&&e&&t[e]&&delete t[e]},serializeSettings:function(e){var t={};for(var n in e){var r=e[n];try{r=JSON?JSON.stringify(r,function(e,t){return i.OUtil.isDate(this[e])?i.DDA.SettingsManager.DateJSONPrefix+this[e].getTime()+i.DDA.SettingsManager.DataJSONSuffix:t}):Sys.Serialization.JavaScriptSerializer.serialize(r),t[n]=r}catch(e){}}return t},deserializeSettings:function(e){var t={};for(var n in e=e||{}){var r=e[n];try{r=JSON?JSON.parse(r,function(e,t){var n;return"string"==typeof t&&t&&t.length>6&&t.slice(0,5)===i.DDA.SettingsManager.DateJSONPrefix&&t.slice(m)===i.DDA.SettingsManager.DataJSONSuffix&&(n=new Date(parseInt(t.slice(5,m))))?n:t}):Sys.Serialization.JavaScriptSerializer.deserialize(r,d),t[n]=r}catch(e){}}return t},loadScript:function(e,t,n){if(e&&t){var r=window.document,o=S[e];if(o)o.loaded?t():o.pendingCallbacks.push(t);else{var i=r.createElement("script");i.type="text/javascript",o={loaded:u,pendingCallbacks:[t],timer:p},S[e]=o;var a=function(){o.timer!=p&&(clearTimeout(o.timer),delete o.timer),o.loaded=d;for(var e=o.pendingCallbacks.length,t=0;t<e;t++){o.pendingCallbacks.shift()()}},s=function(){delete S[e],o.timer!=p&&(clearTimeout(o.timer),delete o.timer);for(var t=o.pendingCallbacks.length,n=0;n<t;n++){o.pendingCallbacks.shift()()}};i.readyState?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(i.onreadystatechange=p,a())}:i.onload=a,i.onerror=s,n=n||3e4,o.timer=setTimeout(s,n),i.setAttribute("crossOrigin","anonymous"),i.src=e,r.getElementsByTagName("head")[0].appendChild(i)}}},loadCSS:function(e){if(e){var t=window.document,n=t.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.getElementsByTagName("head")[0].appendChild(n)}},parseEnum:function(e,t){var n=t[e.trim()];if(typeof n==c)throw o.msAjaxDebug.trace("invalid enumeration string:"+e),o.msAjaxError.argument("str");return n},delayExecutionAndCache:function(){var e={calc:arguments[0]};return function(){return e.calc&&(e.val=e.calc.apply(this,arguments),delete e.calc),e.val}},getUniqueId:function(){return(g+=1).toString()},formatString:function(){var e=arguments;return e[0].replace(/{(\d+)}/gm,function(t,n){var r=parseInt(n,10)+1;return void 0===e[r]?"{"+n+"}":e[r]})},generateConversationId:function(){return[A(),A(),(new Date).getTime().toString()].join("_")},getFrameName:function(e){return y+e+this.generateConversationId()},addXdmInfoAsHash:function(e,t){return i.OUtil.addInfoAsHash(e,v,t,u)},addSerializerVersionAsHash:function(e,t){return i.OUtil.addInfoAsHash(e,h,t,d)},addInfoAsHash:function(e,t,n,r){var o,i=(e=e.trim()||s).split(b),a=i.shift(),c=i.join(b);return o=r?[t,encodeURIComponent(n),c].join(s):[c,t,n].join(s),[a,b,o].join(s)},parseHostInfoFromWindowName:function(e,t){return i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.HostInfo)},parseXdmInfo:function(e){var t=i.OUtil.parseXdmInfoWithGivenFragment(e,window.location.hash);return t||(t=i.OUtil.parseXdmInfoFromWindowName(e,window.name)),t},parseXdmInfoFromWindowName:function(e,t){return i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.XdmInfo)},parseXdmInfoWithGivenFragment:function(e,t){return i.OUtil.parseInfoWithGivenFragment(v,y,u,e,t)},parseSerializerVersion:function(e){var t=i.OUtil.parseSerializerVersionWithGivenFragment(e,window.location.hash);return isNaN(t)&&(t=i.OUtil.parseSerializerVersionFromWindowName(e,window.name)),t},parseSerializerVersionFromWindowName:function(e,t){return parseInt(i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.SerializerVersion))},parseSerializerVersionWithGivenFragment:function(e,t){return parseInt(i.OUtil.parseInfoWithGivenFragment(h,"_serializer_version=",d,e,t))},parseInfoFromWindowName:function(e,t,n){try{var r=JSON.parse(t),o=r!=p?r[n]:p,a=T();if(!e&&a&&r!=p){var s=r[i.WindowNameItemKeys.BaseFrameName]+n;o?a.setItem(s,o):o=a.getItem(s)}return o}catch(e){return p}},parseInfoWithGivenFragment:function(e,t,n,r,o){var i=o.split(e),a=i.length>1?i[i.length-1]:p;n&&a!=p&&(a.indexOf("&")>=0&&(a=a.split("&")[0]),a=decodeURIComponent(a));var s=T();if(!r&&s){var c=window.name.indexOf(t);if(c>m){var u=window.name.indexOf(";",c);u==m&&(u=window.name.length);var l=window.name.substring(c,u);a?s.setItem(l,a):a=s.getItem(l)}}return a},getConversationId:function(){var e=window.location.search,t=p;if(e){var n=e.indexOf("&");(t=n>0?e.substring(1,n):e.substr(1))&&"="===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1))&&(t=decodeURIComponent(t))}return t},getInfoItems:function(e){var t=e.split("$");return typeof t[1]==c&&(t=e.split("|")),typeof t[1]==c&&(t=e.split("%7C")),t},getXdmFieldValue:function(e,t){var n=s,r=i.OUtil.parseXdmInfo(t);if(r){var o=i.OUtil.getInfoItems(r);if(null!=o&&o.length>=3)switch(e){case i.XdmFieldName.ConversationUrl:n=o[2];break;case i.XdmFieldName.AppId:n=o[1]}}return n},validateParamObject:function(e,t){var n=Function._validateParams(arguments,[{name:"params",type:Object,mayBeNull:u},{name:"expectedProperties",type:Object,mayBeNull:u},{name:"callback",type:Function,mayBeNull:d}]);if(n)throw n;for(var r in t)if(n=Function._validateParameter(e[r],t[r],r))throw n},writeProfilerMark:function(e){window.msWriteProfilerMark&&(window.msWriteProfilerMark(e),o.msAjaxDebug.trace(e))},outputDebug:function(e){typeof o!==c&&o.msAjaxDebug&&o.msAjaxDebug.trace&&o.msAjaxDebug.trace(e)},defineNondefaultProperty:function(e,t,n,r){for(var o in n=n||{},r){var i=r[o];null==n[i]&&(n[i]=d)}return Object.defineProperty(e,t,n),e},defineNondefaultProperties:function(e,t,n){for(var r in t=t||{})i.OUtil.defineNondefaultProperty(e,r,t[r],n);return e},defineEnumerableProperty:function(e,t,n){return i.OUtil.defineNondefaultProperty(e,t,n,[a])},defineEnumerableProperties:function(e,t){return i.OUtil.defineNondefaultProperties(e,t,[a])},defineMutableProperty:function(e,t,o){return i.OUtil.defineNondefaultProperty(e,t,o,[r,a,n])},defineMutableProperties:function(e,t){return i.OUtil.defineNondefaultProperties(e,t,[r,a,n])},finalizeProperties:function(e,t){t=t||{};for(var n=Object.getOwnPropertyNames(e),r=n.length,o=0;o<r;o++){var i=n[o],a=Object.getOwnPropertyDescriptor(e,i);a.get||a.set||(a.writable=t.writable||u),a.configurable=t.configurable||u,a.enumerable=t.enumerable||d,Object.defineProperty(e,i,a)}return e},mapList:function(e,t){var n=[];if(e)for(var r in e)n.push(t(e[r]));return n},listContainsKey:function(e,t){for(var n in e)if(t==n)return d;return u},listContainsValue:function(e,t){for(var n in e)if(t==e[n])return d;return u},augmentList:function(e,t){var n=e.push?function(t,n){e.push(n)}:function(t,n){e[t]=n};for(var r in t)n(r,t[r])},redefineList:function(e,t){for(var n in e)delete e[n];for(var r in t)e[r]=t[r]},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.apply(e)},isDate:function(e){return"[object Date]"===Object.prototype.toString.apply(e)},addEventListener:function(e,n,r){e.addEventListener?e.addEventListener(n,r,u):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.attachEvent?e.attachEvent(t+n,r):e[t+n]=r},removeEventListener:function(e,n,r){e.removeEventListener?e.removeEventListener(n,r,u):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.detachEvent?e.detachEvent(t+n,r):e[t+n]=p},getCookieValue:function(e){return RegExp(e+"[^;]+").exec(document.cookie).toString().replace(/^[^=]+./,s)},xhrGet:function(e,t,n){var r;try{(r=new XMLHttpRequest).onreadystatechange=function(){4==r.readyState&&(200==r.status?t(r.responseText):n(r.status))},r.open("GET",e,d),r.send()}catch(e){n(e)}},xhrGetFull:function(e,t,n,r){var o,i=t;try{(o=new XMLHttpRequest).onreadystatechange=function(){4==o.readyState&&(200==o.status?n(o,i):r(o.status))},o.open("GET",e,d),o.send()}catch(e){r(e)}},encodeBase64:function(e){if(!e)return e;var t,n,r,o,i,a,c,u=[],l=[],d=0,f=e.length;do{t=e.charCodeAt(d++),n=e.charCodeAt(d++),r=e.charCodeAt(d++),c=0,o=255&t,i=t>>8,a=255&n,l[c++]=o>>2,l[c++]=(3&o)<<4|i>>4,l[c++]=(15&i)<<2|a>>6,l[c++]=63&a,isNaN(n)||(o=n>>8,i=255&r,a=r>>8,l[c++]=o>>2,l[c++]=(3&o)<<4|i>>4,l[c++]=(15&i)<<2|a>>6,l[c++]=63&a),isNaN(n)?l[c-1]=64:isNaN(r)&&(l[c-2]=64,l[c-1]=64);for(var p=0;p<c;p++)u.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l[p]))}while(d<f);return u.join(s)},getSessionStorage:function(){return T()},getLocalStorage:function(){if(!O){try{var e=window.localStorage}catch(t){e=p}O=new l.SafeStorage(e)}return O},convertIntToCssHexColor:function(e){return"#"+(Number(e)+16777216).toString(16).slice(-6)},attachClickHandler:function(e,t){e.onclick=function(){t()},e.ontouchend=function(e){t(),e.preventDefault()}},getQueryStringParamValue:function(e,t){if(Function._validateParams(arguments,[{name:"queryString",type:String,mayBeNull:u},{name:"paramName",type:String,mayBeNull:u}]))return o.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: Parameters cannot be null."),s;var n=new RegExp("[\\?&]"+t+"=([^&#]*)","i");return n.test(e)?n.exec(e)[1]:(o.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: The parameter is not found."),s)},isiOS:function(){return window.navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?d:u},isChrome:function(){return window.navigator.userAgent.indexOf("Chrome")>0&&!i.OUtil.isEdge()},isEdge:function(){return window.navigator.userAgent.indexOf("Edge")>0},isIE:function(){return window.navigator.userAgent.indexOf("Trident")>0},isFirefox:function(){return window.navigator.userAgent.indexOf("Firefox")>0},shallowCopy:function(e){if(e==p)return p;if(e instanceof Object){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}var r=e.constructor();for(var o in e)e.hasOwnProperty(o)&&(r[o]=e[o]);return r}return e},createObject:function(e){var t=p;if(e){t={};for(var n=e.length,r=0;r<n;r++)t[e[r].name]=e[r].value}return t},addClass:function(e,t){if(!i.OUtil.hasClass(e,t)){var n=e.getAttribute(_);n?e.setAttribute(_,n+" "+t):e.setAttribute(_,t)}},removeClass:function(e,t){if(i.OUtil.hasClass(e,t)){var n=e.getAttribute(_),r=new RegExp("(\\s|^)"+t+"(\\s|$)");n=n.replace(r,s),e.setAttribute(_,n)}},hasClass:function(e,t){var n=e.getAttribute(_);return n&&n.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},focusToFirstTabbable:function(t,n){var r,o,i=u,a=function(){i=d},s=function(e,t,n){return t<0||t>e?m:0===t&&n?m:t!==e-1||n?n?t-1:t+1:m};if(t=E(t),r=n?t.length-1:0,0===t.length)return p;for(;!i&&r>=0&&r<t.length;)o=t[r],window.focus(),o.addEventListener(e,a),o.focus(),o.removeEventListener(e,a),r=s(t.length,r,n),i||o!==document.activeElement||(i=d);return i?o:p},focusToNextTabbable:function(t,n,r){var o,i,a,s=u,c=function(){s=d},l=function(e,t,n){return t<0||t>e?m:0===t&&n?m:t!==e-1||n?n?t-1:t+1:m};if(o=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return m}(t=E(t),n),(i=l(t.length,o,r))<0)return p;for(;!s&&i>=0&&i<t.length;)(a=t[i]).addEventListener(e,c),a.focus(),a.removeEventListener(e,c),i=l(t.length,i,r),s||a!==document.activeElement||(s=d);return s?a:p}}}(),i.OUtil.Guid=function(){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return{generateNewGuid:function(){for(var t="",n=(new Date).getTime(),r=0;r<32&&n>0;r++)8!=r&&12!=r&&16!=r&&20!=r||(t+="-"),t+=e[n%16],n=Math.floor(n/16);for(;r<32;r++)8!=r&&12!=r&&16!=r&&20!=r||(t+="-"),t+=e[Math.floor(16*Math.random())];return t}}}(),window.OSF=i,function(e){var t="\n",n=!0,r=null,i="undefined",a=function(){function e(){}return e.isInstanceOfType=function(e,t){if(typeof t===i||t===r)return!1;if(t instanceof e)return n;var o=t.constructor;return o&&"function"==typeof o&&o.__typeName&&"Object"!==o.__typeName||(o=Object),!(o!==e)||o.__typeName&&e.__typeName&&o.__typeName===e.__typeName},e}();e.MsAjaxTypeHelper=a;var s=function(){var e="Parameter name: {0}";function n(){}return n.create=function(e,t){var n=new Error(e);if(n.message=e,t)for(var r in t)n[r]=t[r];return n.popStackFrame(),n},n.parameterCount=function(e){var t="Sys.ParameterCountException: "+(e||"Parameter count mismatch."),r=n.create(t,{name:"Sys.ParameterCountException"});return r.popStackFrame(),r},n.argument=function(r,o){var i="Sys.ArgumentException: "+(o||"Value does not fall within the expected range.");r&&(i+=t+c.format(e,r));var a=n.create(i,{name:"Sys.ArgumentException",paramName:r});return a.popStackFrame(),a},n.argumentNull=function(r,o){var i="Sys.ArgumentNullException: "+(o||"Value cannot be null.");r&&(i+=t+c.format(e,r));var a=n.create(i,{name:"Sys.ArgumentNullException",paramName:r});return a.popStackFrame(),a},n.argumentOutOfRange=function(o,a,s){var u="Sys.ArgumentOutOfRangeException: "+(s||"Specified argument was out of the range of valid values.");o&&(u+=t+c.format(e,o)),typeof a!==i&&a!==r&&(u+=t+c.format("Actual value was {0}.",a));var l=n.create(u,{name:"Sys.ArgumentOutOfRangeException",paramName:o,actualValue:a});return l.popStackFrame(),l},n.argumentType=function(r,o,i,a){var s="Sys.ArgumentTypeException: ";s+=a||(o&&i?c.format("Object of type '{0}' cannot be converted to type '{1}'.",o.getName?o.getName():o,i.getName?i.getName():i):"Object cannot be converted to the required type."),r&&(s+=t+c.format(e,r));var u=n.create(s,{name:"Sys.ArgumentTypeException",paramName:r,actualType:o,expectedType:i});return u.popStackFrame(),u},n.argumentUndefined=function(r,o){var i="Sys.ArgumentUndefinedException: "+(o||"Value cannot be undefined.");r&&(i+=t+c.format(e,r));var a=n.create(i,{name:"Sys.ArgumentUndefinedException",paramName:r});return a.popStackFrame(),a},n.invalidOperation=function(e){var t="Sys.InvalidOperationException: "+(e||"Operation is not valid due to the current state of the object."),r=n.create(t,{name:"Sys.InvalidOperationException"});return r.popStackFrame(),r},n}();e.MsAjaxError=s;var c=function(){function e(){}return e.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(/{(\d+)}/gm,function(e,n){var r=parseInt(n,10);return void 0===t[r]?"{"+n+"}":t[r]})},e.startsWith=function(e,t){return e.substr(0,t.length)===t},e}();e.MsAjaxString=c;var u=function(){function e(){}return e.trace=function(){},e}();if(e.MsAjaxDebug=u,!o.isMsAjaxLoaded()){var l=function(e,t,n){void 0!==e.__typeName&&e.__typeName!==r||(e.__typeName=t),void 0!==e.__class&&e.__class!==r||(e.__class=n)};l(Function,"Function",n),l(Error,"Error",n),l(Object,"Object",n),l(String,"String",n),l(Boolean,"Boolean",n),l(Date,"Date",n),l(Number,"Number",n),l(RegExp,"RegExp",n),l(Array,"Array",n),Function.createCallback||(Function.createCallback=function(e,t){var r=Function._validateParams(arguments,[{name:"method",type:Function},{name:"context",mayBeNull:n}]);if(r)throw r;return function(){var n=arguments.length;if(n>0){for(var r=[],o=0;o<n;o++)r[o]=arguments[o];return r[n]=t,e.apply(this,r)}return e.call(this,t)}}),Function.createDelegate||(Function.createDelegate=function(e,t){var r=Function._validateParams(arguments,[{name:"instance",mayBeNull:n},{name:"method",type:Function}]);if(r)throw r;return function(){return t.apply(e,arguments)}}),Function._validateParams||(Function._validateParams=function(e,t,n){var o,a=t.length;if(n=n||typeof n===i,o=Function._validateParameterCount(e,t,n))return o.popStackFrame(),o;for(var s=0,c=e.length;s<c;s++){var u=t[Math.min(s,a-1)],l=u.name;if(u.parameterArray)l+="["+(s-a+1)+"]";else if(!n&&s>=a)break;if(o=Function._validateParameter(e[s],u,l))return o.popStackFrame(),o}return r}),Function._validateParameterCount||(Function._validateParameterCount=function(e,t,o){var i,a,c=t.length,u=e.length;if(u<c){var l=c;for(i=0;i<c;i++){var d=t[i];(d.optional||d.parameterArray)&&l--}u<l&&(a=n)}else if(o&&u>c)for(a=n,i=0;i<c;i++)if(t[i].parameterArray){a=!1;break}if(a){var f=s.parameterCount();return f.popStackFrame(),f}return r}),Function._validateParameter||(Function._validateParameter=function(e,t,n){var o,a=t.type,s=!!t.integer,c=!!t.domElement,u=!!t.mayBeNull;if(o=Function._validateParameterType(e,a,s,c,u,n))return o.popStackFrame(),o;var l=t.elementType,d=!!t.elementMayBeNull;if(a===Array&&typeof e!==i&&e!==r&&(l||!d))for(var f=!!t.elementInteger,p=!!t.elementDomElement,m=0;m<e.length;m++){var g=e[m];if(o=Function._validateParameterType(g,l,f,p,d,n+"["+m+"]"))return o.popStackFrame(),o}return r}),Function._validateParameterType||(Function._validateParameterType=function(t,n,o,a,s,c){var u;return typeof t===i?s?r:((u=e.MsAjaxError.argumentUndefined(c)).popStackFrame(),u):t===r?s?r:((u=e.MsAjaxError.argumentNull(c)).popStackFrame(),u):n&&!e.MsAjaxTypeHelper.isInstanceOfType(n,t)?((u=e.MsAjaxError.argumentType(c,typeof t,n)).popStackFrame(),u):r}),window.Type||(window.Type=Function),Type.registerNamespace||(Type.registerNamespace=function(e){for(var t=e.split("."),n=window,r=0;r<t.length;r++)n[t[r]]=n[t[r]]||{},n=n[t[r]]}),Type.prototype.registerClass||(Type.prototype.registerClass=function(e){({})}),typeof Sys===i&&Type.registerNamespace("Sys"),Error.prototype.popStackFrame||(Error.prototype.popStackFrame=function(){var e=this;if(0!==arguments.length)throw s.parameterCount();if(typeof e.stack!==i&&e.stack!==r&&typeof e.fileName!==i&&e.fileName!==r&&typeof e.lineNumber!==i&&e.lineNumber!==r){for(var n=e.stack.split(t),o=n[0],a=e.fileName+":"+e.lineNumber;typeof o!==i&&o!==r&&-1===o.indexOf(a);)n.shift(),o=n[0];var c=n[1];if(typeof c!==i&&c!==r){var u=c.match(/@(.*):(\d+)$/);typeof u!==i&&u!==r&&(e.fileName=u[1],e.lineNumber=parseInt(u[2]),n.shift(),e.stack=n.join(t))}}}),o.msAjaxError=s,o.msAjaxString=c,o.msAjaxDebug=u}}(l||(l={})),i.OUtil.setNamespace("Microsoft",window),i.OUtil.setNamespace("Office",Microsoft),i.OUtil.setNamespace("Common",Microsoft.Office),Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},i.SerializerVersion={MsAjax:0,Browser:1},function(e){(l||(l={})).appSpecificCheckOrigin=function(){return!1}}(),Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},Microsoft.Office.Common.InvokeResultCode={noError:0,errorInRequest:-1,errorHandlingRequest:-2,errorInResponse:-3,errorHandlingResponse:-4,errorHandlingRequestAccessDenied:-5,errorHandlingMethodCallTimedout:-6},Microsoft.Office.Common.MessageType={request:0,response:1},Microsoft.Office.Common.ActionType={invoke:0,registerEvent:1,unregisterEvent:2},Microsoft.Office.Common.ResponseType={forCalling:0,forEventing:1},Microsoft.Office.Common.MethodObject=function(e,t,n){this._method=e,this._invokeType=t,this._blockingOthers=n},Microsoft.Office.Common.MethodObject.prototype={getMethod:function(){return this._method},getInvokeType:function(){return this._invokeType},getBlockingFlag:function(){return this._blockingOthers}},Microsoft.Office.Common.EventMethodObject=function(e,t){this._registerMethodObject=e,this._unregisterMethodObject=t},Microsoft.Office.Common.EventMethodObject.prototype={getRegisterMethodObject:function(){return this._registerMethodObject},getUnregisterMethodObject:function(){return this._unregisterMethodObject}},Microsoft.Office.Common.ServiceEndPoint=function(e){var t=this,n=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:!1}]);if(n)throw n;t._methodObjectList={},t._eventHandlerProxyList={},t._Id=e,t._conversations={},t._policyManager=null,t._appDomains={},t._onHandleRequestError=null},Microsoft.Office.Common.ServiceEndPoint.prototype={registerMethod:function(e,t,n,r){var i="invokeType",a=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:!1},{name:"method",type:Function,mayBeNull:!1},{name:i,type:Number,mayBeNull:!1},{name:"blockingOthers",type:Boolean,mayBeNull:!1}]);if(a)throw a;if(n!==Microsoft.Office.Common.InvokeType.async&&n!==Microsoft.Office.Common.InvokeType.sync)throw o.msAjaxError.argument(i);var s=new Microsoft.Office.Common.MethodObject(t,n,r);this._methodObjectList[e]=s},unregisterMethod:function(e){var t=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:!1}]);if(t)throw t;delete this._methodObjectList[e]},registerEvent:function(e,t,n){var r=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:!1},{name:"registerMethod",type:Function,mayBeNull:!1},{name:"unregisterMethod",type:Function,mayBeNull:!1}]);if(r)throw r;var o=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,Microsoft.Office.Common.InvokeType.syncRegisterEvent,!1),new Microsoft.Office.Common.MethodObject(n,Microsoft.Office.Common.InvokeType.syncUnregisterEvent,!1));this._methodObjectList[e]=o},registerEventEx:function(e,t,n,r,o){var i=!1,a=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:i},{name:"registerMethod",type:Function,mayBeNull:i},{name:"registerMethodInvokeType",type:Number,mayBeNull:i},{name:"unregisterMethod",type:Function,mayBeNull:i},{name:"unregisterMethodInvokeType",type:Number,mayBeNull:i}]);if(a)throw a;var s=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,n,i),new Microsoft.Office.Common.MethodObject(r,o,i));this._methodObjectList[e]=s},unregisterEvent:function(e){var t=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:!1}]);if(t)throw t;this.unregisterMethod(e)},registerConversation:function(e,t,n,r){var i="appDomains",a=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1},{name:"conversationUrl",type:String,mayBeNull:!1,optional:!0},{name:i,type:Object,mayBeNull:!0,optional:!0},{name:"serializerVersion",type:Number,mayBeNull:!0,optional:!0}]);if(a)throw a;if(n){if(!(n instanceof Array))throw o.msAjaxError.argument(i);this._appDomains[e]=n}this._conversations[e]={url:t,serializerVersion:r}},unregisterConversation:function(e){var t=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1}]);if(t)throw t;delete this._conversations[e]},setPolicyManager:function(e){var t="policyManager",n=Function._validateParams(arguments,[{name:t,type:Object,mayBeNull:!1}]);if(n)throw n;if(!e.checkPermission)throw o.msAjaxError.argument(t);this._policyManager=e},getPolicyManager:function(){return this._policyManager},dispose:function(){var e=null,t=this;t._methodObjectList=e,t._eventHandlerProxyList=e,t._Id=e,t._conversations=e,t._policyManager=e,t._appDomains=e,t._onHandleRequestError=e}},Microsoft.Office.Common.ClientEndPoint=function(e,t,n,r){var a="targetWindow",s=this,c=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1},{name:a,mayBeNull:!1},{name:"targetUrl",type:String,mayBeNull:!1},{name:"serializerVersion",type:Number,mayBeNull:!0,optional:!0}]);if(c)throw c;try{if(!t.postMessage)throw o.msAjaxError.argument(a)}catch(e){if(!Object.prototype.hasOwnProperty.call(t,"postMessage"))throw o.msAjaxError.argument(a)}s._conversationId=e,s._targetWindow=t,s._targetUrl=n,s._callingIndex=0,s._callbackList={},s._eventHandlerList={},s._serializerVersion=null!=r?r:i.SerializerVersion.Browser},Microsoft.Office.Common.ClientEndPoint.prototype={invoke:function(e,t,n){var r=this,o=Function._validateParams(arguments,[{name:"targetMethodName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"param",mayBeNull:!0}]);if(o)throw o;var i=r._callingIndex++,a={callback:t,createdOn:(new Date).getTime()};n&&"object"==typeof n&&"number"==typeof n.__timeout__&&(a.timeout=n.__timeout__,delete n.__timeout__),r._callbackList[i]=a;try{var s=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.invoke,r._conversationId,i,n),c=Microsoft.Office.Common.MessagePackager.envelope(s,r._serializerVersion);r._targetWindow.postMessage(c,r._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete r._callbackList[i]}}},registerForEvent:function(e,t,n,r){var o=this,i=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"eventHandler",type:Function,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(i)throw i;var a=o._callingIndex++,s=new Date;o._callbackList[a]={callback:n,createdOn:s.getTime()};try{var c=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.registerEvent,o._conversationId,a,r),u=Microsoft.Office.Common.MessagePackager.envelope(c,o._serializerVersion);o._targetWindow.postMessage(u,o._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer(),o._eventHandlerList[e]=t}catch(e){try{null!==n&&n(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete o._callbackList[a]}}},unregisterForEvent:function(e,t,n){var r=this,o=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(o)throw o;var i=r._callingIndex++,a=new Date;r._callbackList[i]={callback:t,createdOn:a.getTime()};try{var s=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.unregisterEvent,r._conversationId,i,n),c=Microsoft.Office.Common.MessagePackager.envelope(s,r._serializerVersion);r._targetWindow.postMessage(c,r._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete r._callbackList[i]}}finally{delete r._eventHandlerList[e]}}},Microsoft.Office.Common.XdmCommunicationManager=function(){var e="serviceEndPointId",t=!0,n="channel is not ready.",r="conversationId",a="Unknown conversation Id.",s=!1,c=null,u=[],d=c,f=c,p=10,m=s,g=c,v=65e3,h={},y={},b=s;function _(e){for(var t in h)if(h[t]._conversations[e])return h[t];throw o.msAjaxDebug.trace(a),o.msAjaxError.argument(r)}function S(e){var t=y[e];return!t&&o.msAjaxDebug.trace(a),t}function C(e){u.push(e)}function O(){if(f!==c){if(!m)if(u.length>0){I(u.shift())}else clearInterval(f),f=c}else o.msAjaxDebug.trace(n)}function I(e){m=e.getInvokeBlockingFlag(),e.invoke(),d=(new Date).getTime()}function A(){if(g){var e,t,r=0,i=new Date;for(var a in y)for(var s in(e=y[a])._callbackList){var u=e._callbackList[s];if((t=u.timeout?u.timeout:v)>=0&&Math.abs(i.getTime()-u.createdOn)>=t)try{u.callback&&u.callback(Microsoft.Office.Common.InvokeResultCode.errorHandlingMethodCallTimedout,c)}finally{delete e._callbackList[s]}else r++}0===r&&(clearInterval(g),g=c)}else o.msAjaxDebug.trace(n)}function T(){m=s}function E(e,n){var r,o,i=s;return e===t?t:e&&n&&e.length&&n.length?(r=document.createElement("a"),o=document.createElement("a"),r.href=e,o.href=n,i=P(r,o),delete r,i):i}function x(e,t){var n=s;if(!(t&&t.length&&e&&e instanceof Array&&e.length))return n;var r=document.createElement("a"),o=document.createElement("a");r.href=t;for(var i=0;i<e.length&&!n;i++)-1!==e[i].indexOf("://")&&(o.href=e[i],n=P(r,o));return delete r,n}function P(e,t){return e.hostname==t.hostname&&e.protocol==t.protocol&&e.port==t.port}function M(e){var n="Access Denied";if(i&&""!=e.data){var r,a=i.SerializerVersion.Browser,u=e.data;try{a=(r=Microsoft.Office.Common.MessagePackager.unenvelope(u,i.SerializerVersion.Browser))._serializerVersion!=c?r._serializerVersion:a}catch(e){return}if(r._messageType===Microsoft.Office.Common.MessageType.request){var g=e.origin==c||"null"==e.origin?r._origin:e.origin;try{var v=_(r._conversationId),h=v._conversations[r._conversationId];a=h.serializerVersion!=c?h.serializerVersion:a;var y=[h.url].concat(v._appDomains[r._conversationId]);if(!x(y,e.origin)&&!l.appSpecificCheckOrigin(y,e,r._origin,x))throw"Failed origin check";var b=v.getPolicyManager();if(b&&!b.checkPermission(r._conversationId,r._actionName,r._data))throw n;var A=function(e,t){var n=e._methodObjectList[t._actionName];if(!n)throw o.msAjaxDebug.trace("The specified method is not registered on service endpoint:"+t._actionName),o.msAjaxError.argument("messageObject");return t._actionType===Microsoft.Office.Common.ActionType.invoke?n:t._actionType===Microsoft.Office.Common.ActionType.registerEvent?n.getRegisterMethodObject():n.getUnregisterMethodObject()}(v,r),P=new Microsoft.Office.Common.InvokeCompleteCallback(e.source,g,r._actionName,r._conversationId,r._correlationId,T,a),M=new Microsoft.Office.Common.Invoker(A,r._data,P,v._eventHandlerProxyList,r._conversationId,r._actionName,a),w=t;f==c&&((d==c||(new Date).getTime()-d>p)&&!m?(I(M),w=s):f=setInterval(O,p)),w&&C(M)}catch(t){v&&v._onHandleRequestError&&v._onHandleRequestError(r,t);var R=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequest;t==n&&(R=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequestAccessDenied);var k=new Microsoft.Office.Common.Response(r._actionName,r._conversationId,r._correlationId,R,Microsoft.Office.Common.ResponseType.forCalling,t),D=Microsoft.Office.Common.MessagePackager.envelope(k,a),j=s;try{j=!(!e.source||!e.source.postMessage)}catch(e){}j&&e.source.postMessage(D,g)}}else{if(r._messageType!==Microsoft.Office.Common.MessageType.response)return;var N=S(r._conversationId);if(!N)return;if(N._serializerVersion=a,!E(N._targetUrl,e.origin))throw"Failed orgin check";if(r._responseType===Microsoft.Office.Common.ResponseType.forCalling){var F=N._callbackList[r._correlationId];if(F)try{F.callback&&F.callback(r._errorCode,r._data)}finally{delete N._callbackList[r._correlationId]}}else{var L=N._eventHandlerList[r._actionName];void 0!==L&&L!==c&&L(r._data)}}}}function w(){b||(!function(e){if(window.addEventListener)window.addEventListener("message",e,s);else{if(!(navigator.userAgent.indexOf("MSIE")>-1&&window.attachEvent))throw o.msAjaxDebug.trace("Browser doesn't support the required API."),o.msAjaxError.argument("Browser");window.attachEvent("onmessage",e)}}(M),b=t)}return{connect:function(e,t,n,r){var o=y[e];return o||(w(),o=new Microsoft.Office.Common.ClientEndPoint(e,t,n,r),y[e]=o),o},getClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:r,type:String,mayBeNull:s}]);if(t)throw t;return y[e]},createServiceEndPoint:function(e){w();var t=new Microsoft.Office.Common.ServiceEndPoint(e);return h[e]=t,t},getServiceEndPoint:function(t){var n=Function._validateParams(arguments,[{name:e,type:String,mayBeNull:s}]);if(n)throw n;return h[t]},deleteClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:r,type:String,mayBeNull:s}]);if(t)throw t;delete y[e]},deleteServiceEndPoint:function(t){var n=Function._validateParams(arguments,[{name:e,type:String,mayBeNull:s}]);if(n)throw n;delete h[t]},checkUrlWithAppDomains:function(e,t){return x(e,t)},_setMethodTimeout:function(e){var t=Function._validateParams(arguments,[{name:"methodTimeout",type:Number,mayBeNull:s}]);if(t)throw t;v=e<=0?65e3:e},_startMethodTimeoutTimer:function(){g||(g=setInterval(A,2e3))}}}(),Microsoft.Office.Common.Message=function(e,t,n,r,o){var i=this,a=Function._validateParams(arguments,[{name:"messageType",type:Number,mayBeNull:!1},{name:"actionName",type:String,mayBeNull:!1},{name:"conversationId",type:String,mayBeNull:!1},{name:"correlationId",mayBeNull:!1},{name:"data",mayBeNull:!0,optional:!0}]);if(a)throw a;i._messageType=e,i._actionName=t,i._conversationId=n,i._correlationId=r,i._origin=window.location.href,i._data=void 0===o?null:o},Microsoft.Office.Common.Message.prototype={getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getOrigin:function(){return this._origin},getData:function(){return this._data},getMessageType:function(){return this._messageType}},Microsoft.Office.Common.Request=function(e,t,n,r,o){Microsoft.Office.Common.Request.uber.constructor.call(this,Microsoft.Office.Common.MessageType.request,e,n,r,o),this._actionType=t},i.OUtil.extend(Microsoft.Office.Common.Request,Microsoft.Office.Common.Message),Microsoft.Office.Common.Request.prototype.getActionType=function(){return this._actionType},Microsoft.Office.Common.Response=function(e,t,n,r,o,i){Microsoft.Office.Common.Response.uber.constructor.call(this,Microsoft.Office.Common.MessageType.response,e,t,n,i),this._errorCode=r,this._responseType=o},i.OUtil.extend(Microsoft.Office.Common.Response,Microsoft.Office.Common.Message),Microsoft.Office.Common.Response.prototype.getErrorCode=function(){return this._errorCode},Microsoft.Office.Common.Response.prototype.getResponseType=function(){return this._responseType},Microsoft.Office.Common.MessagePackager={envelope:function(e){return"object"==typeof e&&(e._serializerVersion=i.SerializerVersion.Browser),JSON.stringify(e)},unenvelope:function(e){return JSON.parse(e)}},Microsoft.Office.Common.ResponseSender=function(e,t,n,r,i,a,s){var c=!1,u=this,l=Function._validateParams(arguments,[{name:"requesterWindow",mayBeNull:c},{name:"requesterUrl",type:String,mayBeNull:c},{name:"actionName",type:String,mayBeNull:c},{name:"conversationId",type:String,mayBeNull:c},{name:"correlationId",mayBeNull:c},{name:"responsetype",type:Number,maybeNull:c},{name:"serializerVersion",type:Number,maybeNull:!0,optional:!0}]);if(l)throw l;u._requesterWindow=e,u._requesterUrl=t,u._actionName=n,u._conversationId=r,u._correlationId=i,u._invokeResultCode=Microsoft.Office.Common.InvokeResultCode.noError,u._responseType=a;var d=u;u._send=function(e){try{var t=new Microsoft.Office.Common.Response(d._actionName,d._conversationId,d._correlationId,d._invokeResultCode,d._responseType,e),n=Microsoft.Office.Common.MessagePackager.envelope(t,s);d._requesterWindow.postMessage(n,d._requesterUrl)}catch(e){o.msAjaxDebug.trace("ResponseSender._send error:"+e.message)}}},Microsoft.Office.Common.ResponseSender.prototype={getRequesterWindow:function(){return this._requesterWindow},getRequesterUrl:function(){return this._requesterUrl},getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getSend:function(){return this._send},setResultCode:function(e){this._invokeResultCode=e}},Microsoft.Office.Common.InvokeCompleteCallback=function(e,t,n,r,i,a,s){var c=this;Microsoft.Office.Common.InvokeCompleteCallback.uber.constructor.call(c,e,t,n,r,i,Microsoft.Office.Common.ResponseType.forCalling,s),c._postCallbackHandler=a;var u=c;c._send=function(e,t){null!=t&&(u._invokeResultCode=t);try{var n=new Microsoft.Office.Common.Response(u._actionName,u._conversationId,u._correlationId,u._invokeResultCode,u._responseType,e),r=Microsoft.Office.Common.MessagePackager.envelope(n,s);u._requesterWindow.postMessage(r,u._requesterUrl),u._postCallbackHandler()}catch(e){o.msAjaxDebug.trace("InvokeCompleteCallback._send error:"+e.message)}}},i.OUtil.extend(Microsoft.Office.Common.InvokeCompleteCallback,Microsoft.Office.Common.ResponseSender),Microsoft.Office.Common.Invoker=function(e,t,n,r,o,i,a){var s=this,c=Function._validateParams(arguments,[{name:"methodObject",mayBeNull:!1},{name:"paramValue",mayBeNull:!0},{name:"invokeCompleteCallback",mayBeNull:!1},{name:"eventHandlerProxyList",mayBeNull:!0},{name:"conversationId",type:String,mayBeNull:!1},{name:"eventName",type:String,mayBeNull:!1},{name:"serializerVersion",type:Number,mayBeNull:!0,optional:!0}]);if(c)throw c;s._methodObject=e,s._param=t,s._invokeCompleteCallback=n,s._eventHandlerProxyList=r,s._conversationId=o,s._eventName=i,s._serializerVersion=a},Microsoft.Office.Common.Invoker.prototype={invoke:function(){var e=this;try{var t;switch(e._methodObject.getInvokeType()){case Microsoft.Office.Common.InvokeType.async:e._methodObject.getMethod()(e._param,e._invokeCompleteCallback.getSend());break;case Microsoft.Office.Common.InvokeType.sync:t=e._methodObject.getMethod()(e._param),e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.syncRegisterEvent:var n=e._createEventHandlerProxyObject(e._invokeCompleteCallback);t=e._methodObject.getMethod()(n.getSend(),e._param),e._eventHandlerProxyList[e._conversationId+e._eventName]=n.getSend(),e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.syncUnregisterEvent:var r=e._eventHandlerProxyList[e._conversationId+e._eventName];t=e._methodObject.getMethod()(r,e._param),delete e._eventHandlerProxyList[e._conversationId+e._eventName],e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.asyncRegisterEvent:var o=e._createEventHandlerProxyObject(e._invokeCompleteCallback);e._methodObject.getMethod()(o.getSend(),e._invokeCompleteCallback.getSend(),e._param),e._eventHandlerProxyList[e._callerId+e._eventName]=o.getSend();break;case Microsoft.Office.Common.InvokeType.asyncUnregisterEvent:var i=e._eventHandlerProxyList[e._callerId+e._eventName];e._methodObject.getMethod()(i,e._invokeCompleteCallback.getSend(),e._param),delete e._eventHandlerProxyList[e._callerId+e._eventName]}}catch(t){e._invokeCompleteCallback.setResultCode(Microsoft.Office.Common.InvokeResultCode.errorInResponse),e._invokeCompleteCallback.getSend()(t)}},getInvokeBlockingFlag:function(){return this._methodObject.getBlockingFlag()},_createEventHandlerProxyObject:function(e){return new Microsoft.Office.Common.ResponseSender(e.getRequesterWindow(),e.getRequesterUrl(),e.getActionName(),e.getConversationId(),e.getCorrelationId(),Microsoft.Office.Common.ResponseType.forEventing,this._serializerVersion)}},i.OUtil.setNamespace("OSF",window),i.MessageIDs={FetchBundleUrl:0,LoadReactBundle:1,LoadBundleSuccess:2,LoadBundleError:3},i.AppName={Unsupported:0,Excel:1,Word:2,PowerPoint:4,Outlook:8,ExcelWebApp:16,WordWebApp:32,OutlookWebApp:64,Project:128,AccessWebApp:256,PowerpointWebApp:512,ExcelIOS:1024,Sway:2048,WordIOS:4096,PowerPointIOS:8192,Access:16384,Lync:32768,OutlookIOS:65536,OneNoteWebApp:131072,OneNote:262144,ExcelWinRT:524288,WordWinRT:1048576,PowerpointWinRT:2097152,OutlookAndroid:4194304,OneNoteWinRT:8388608,ExcelAndroid:8388609,VisioWebApp:8388610,OneNoteIOS:8388611,WordAndroid:8388613,PowerpointAndroid:8388614},i.InternalPerfMarker={DataCoercionBegin:"Agave.HostCall.CoerceDataStart",DataCoercionEnd:"Agave.HostCall.CoerceDataEnd"},i.HostCallPerfMarker={IssueCall:"Agave.HostCall.IssueCall",ReceiveResponse:"Agave.HostCall.ReceiveResponse",RuntimeExceptionRaised:"Agave.HostCall.RuntimeExecptionRaised"},i.AgaveHostAction={Select:0,UnSelect:1,CancelDialog:2,InsertAgave:3,CtrlF6In:4,CtrlF6Exit:5,CtrlF6ExitShift:6,SelectWithError:7,NotifyHostError:8,RefreshAddinCommands:9,PageIsReady:10,TabIn:11,TabInShift:12,TabExit:13,TabExitShift:14,EscExit:15,F2Exit:16,ExitNoFocusable:17,ExitNoFocusableShift:18,MouseEnter:19,MouseLeave:20,UpdateTargetUrl:21,InstallCustomFunctions:22,SendTelemetryEvent:23},i.SharedConstants={NotificationConversationIdSuffix:"_ntf"},i.DialogMessageType={DialogMessageReceived:0,DialogParentMessageReceived:1,DialogClosed:12006},i.OfficeAppContext=function(e,t,n,r,o,i,a,s,c,u,l,d,f,p,m,g,v,h,y,b,_,S,C,O){var I=this;I._id=e,I._appName=t,I._appVersion=n,I._appUILocale=r,I._dataLocale=o,I._docUrl=i,I._clientMode=a,I._settings=s,I._reason=c,I._osfControlType=u,I._eToken=l,I._correlationId=d,I._appInstanceId=f,I._touchEnabled=p,I._commerceAllowed=m,I._appMinorVersion=g,I._requirementMatrix=v,I._hostCustomMessage=h,I._hostFullVersion=y,I._isDialog=!1,I._clientWindowHeight=b,I._clientWindowWidth=_,I._addinName=S,I._appDomains=C,I._dialogRequirementMatrix=O,I.get_id=function(){return this._id},I.get_appName=function(){return this._appName},I.get_appVersion=function(){return this._appVersion},I.get_appUILocale=function(){return this._appUILocale},I.get_dataLocale=function(){return this._dataLocale},I.get_docUrl=function(){return this._docUrl},I.get_clientMode=function(){return this._clientMode},I.get_bindings=function(){return this._bindings},I.get_settings=function(){return this._settings},I.get_reason=function(){return this._reason},I.get_osfControlType=function(){return this._osfControlType},I.get_eToken=function(){return this._eToken},I.get_correlationId=function(){return this._correlationId},I.get_appInstanceId=function(){return this._appInstanceId},I.get_touchEnabled=function(){return this._touchEnabled},I.get_commerceAllowed=function(){return this._commerceAllowed},I.get_appMinorVersion=function(){return this._appMinorVersion},I.get_requirementMatrix=function(){return this._requirementMatrix},I.get_dialogRequirementMatrix=function(){return this._dialogRequirementMatrix},I.get_hostCustomMessage=function(){return this._hostCustomMessage},I.get_hostFullVersion=function(){return this._hostFullVersion},I.get_isDialog=function(){return this._isDialog},I.get_clientWindowHeight=function(){return this._clientWindowHeight},I.get_clientWindowWidth=function(){return this._clientWindowWidth},I.get_addinName=function(){return this._addinName},I.get_appDomains=function(){return this._appDomains}},i.OsfControlType={DocumentLevel:0,ContainerLevel:1},i.ClientMode={ReadOnly:0,ReadWrite:1},i.OUtil.setNamespace("Microsoft",window),i.OUtil.setNamespace("Office",Microsoft),i.OUtil.setNamespace("Client",Microsoft.Office),i.OUtil.setNamespace("WebExtension",Microsoft.Office),Microsoft.Office.WebExtension.InitializationReason={Inserted:"inserted",DocumentOpened:"documentOpened"},Microsoft.Office.WebExtension.ValueFormat={Unformatted:"unformatted",Formatted:"formatted"},Microsoft.Office.WebExtension.FilterType={All:"all"},Microsoft.Office.WebExtension.Parameters={BindingType:"bindingType",CoercionType:"coercionType",ValueFormat:"valueFormat",FilterType:"filterType",Columns:"columns",SampleData:"sampleData",GoToType:"goToType",SelectionMode:"selectionMode",Id:"id",PromptText:"promptText",ItemName:"itemName",FailOnCollision:"failOnCollision",StartRow:"startRow",StartColumn:"startColumn",RowCount:"rowCount",ColumnCount:"columnCount",Callback:"callback",AsyncContext:"asyncContext",Data:"data",Rows:"rows",OverwriteIfStale:"overwriteIfStale",FileType:"fileType",EventType:"eventType",Handler:"handler",SliceSize:"sliceSize",SliceIndex:"sliceIndex",ActiveView:"activeView",Status:"status",PlatformType:"platformType",HostType:"hostType",ForceConsent:"forceConsent",ForceAddAccount:"forceAddAccount",AuthChallenge:"authChallenge",Reserved:"reserved",Tcid:"tcid",Xml:"xml",Namespace:"namespace",Prefix:"prefix",XPath:"xPath",Text:"text",ImageLeft:"imageLeft",ImageTop:"imageTop",ImageWidth:"imageWidth",ImageHeight:"imageHeight",TaskId:"taskId",FieldId:"fieldId",FieldValue:"fieldValue",ServerUrl:"serverUrl",ListName:"listName",ResourceId:"resourceId",ViewType:"viewType",ViewName:"viewName",GetRawValue:"getRawValue",CellFormat:"cellFormat",TableOptions:"tableOptions",TaskIndex:"taskIndex",ResourceIndex:"resourceIndex",CustomFieldId:"customFieldId",Url:"url",MessageHandler:"messageHandler",Width:"width",Height:"height",RequireHTTPs:"requireHTTPS",MessageToParent:"messageToParent",DisplayInIframe:"displayInIframe",MessageContent:"messageContent",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",PromptBeforeOpen:"promptBeforeOpen",AppCommandInvocationCompletedData:"appCommandInvocationCompletedData",Base64:"base64",FormId:"formId"},i.OUtil.setNamespace("DDA",i),i.DDA.DocumentMode={ReadOnly:1,ReadWrite:0},i.DDA.PropertyDescriptors={AsyncResultStatus:"AsyncResultStatus"},i.DDA.EventDescriptors={},i.DDA.ListDescriptors={},i.DDA.UI={},i.DDA.getXdmEventName=function(e,t){return t==Microsoft.Office.WebExtension.EventType.BindingSelectionChanged||t==Microsoft.Office.WebExtension.EventType.BindingDataChanged||t==Microsoft.Office.WebExtension.EventType.DataNodeDeleted||t==Microsoft.Office.WebExtension.EventType.DataNodeInserted||t==Microsoft.Office.WebExtension.EventType.DataNodeReplaced?e+"_"+t:t},i.DDA.MethodDispId={dispidMethodMin:64,dispidGetSelectedDataMethod:64,dispidSetSelectedDataMethod:65,dispidAddBindingFromSelectionMethod:66,dispidAddBindingFromPromptMethod:67,dispidGetBindingMethod:68,dispidReleaseBindingMethod:69,dispidGetBindingDataMethod:70,dispidSetBindingDataMethod:71,dispidAddRowsMethod:72,dispidClearAllRowsMethod:73,dispidGetAllBindingsMethod:74,dispidLoadSettingsMethod:75,dispidSaveSettingsMethod:76,dispidGetDocumentCopyMethod:77,dispidAddBindingFromNamedItemMethod:78,dispidAddColumnsMethod:79,dispidGetDocumentCopyChunkMethod:80,dispidReleaseDocumentCopyMethod:81,dispidNavigateToMethod:82,dispidGetActiveViewMethod:83,dispidGetDocumentThemeMethod:84,dispidGetOfficeThemeMethod:85,dispidGetFilePropertiesMethod:86,dispidClearFormatsMethod:87,dispidSetTableOptionsMethod:88,dispidSetFormatsMethod:89,dispidExecuteRichApiRequestMethod:93,dispidAppCommandInvocationCompletedMethod:94,dispidCloseContainerMethod:97,dispidGetAccessTokenMethod:98,dispidOpenBrowserWindow:102,dispidCreateDocumentMethod:105,dispidInsertFormMethod:106,dispidDisplayRibbonCalloutAsyncMethod:109,dispidGetSelectedTaskMethod:110,dispidGetSelectedResourceMethod:111,dispidGetTaskMethod:112,dispidGetResourceFieldMethod:113,dispidGetWSSUrlMethod:114,dispidGetTaskFieldMethod:115,dispidGetProjectFieldMethod:116,dispidGetSelectedViewMethod:117,dispidGetTaskByIndexMethod:118,dispidGetResourceByIndexMethod:119,dispidSetTaskFieldMethod:120,dispidSetResourceFieldMethod:121,dispidGetMaxTaskIndexMethod:122,dispidGetMaxResourceIndexMethod:123,dispidCreateTaskMethod:124,dispidAddDataPartMethod:128,dispidGetDataPartByIdMethod:129,dispidGetDataPartsByNamespaceMethod:130,dispidGetDataPartXmlMethod:131,dispidGetDataPartNodesMethod:132,dispidDeleteDataPartMethod:133,dispidGetDataNodeValueMethod:134,dispidGetDataNodeXmlMethod:135,dispidGetDataNodesMethod:136,dispidSetDataNodeValueMethod:137,dispidSetDataNodeXmlMethod:138,dispidAddDataNamespaceMethod:139,dispidGetDataUriByPrefixMethod:140,dispidGetDataPrefixByUriMethod:141,dispidGetDataNodeTextMethod:142,dispidSetDataNodeTextMethod:143,dispidMessageParentMethod:144,dispidSendMessageMethod:145,dispidExecuteFeature:146,dispidQueryFeature:147,dispidMethodMax:147},i.DDA.EventDispId={dispidEventMin:0,dispidInitializeEvent:0,dispidSettingsChangedEvent:1,dispidDocumentSelectionChangedEvent:2,dispidBindingSelectionChangedEvent:3,dispidBindingDataChangedEvent:4,dispidDocumentOpenEvent:5,dispidDocumentCloseEvent:6,dispidActiveViewChangedEvent:7,dispidDocumentThemeChangedEvent:8,dispidOfficeThemeChangedEvent:9,dispidDialogMessageReceivedEvent:10,dispidDialogNotificationShownInAddinEvent:11,dispidDialogParentMessageReceivedEvent:12,dispidObjectDeletedEvent:13,dispidObjectSelectionChangedEvent:14,dispidObjectDataChangedEvent:15,dispidContentControlAddedEvent:16,dispidActivationStatusChangedEvent:32,dispidRichApiMessageEvent:33,dispidAppCommandInvokedEvent:39,dispidOlkItemSelectedChangedEvent:46,dispidOlkRecipientsChangedEvent:47,dispidOlkAppointmentTimeChangedEvent:48,dispidOlkRecurrenceChangedEvent:49,dispidOlkAttachmentsChangedEvent:50,dispidTaskSelectionChangedEvent:56,dispidResourceSelectionChangedEvent:57,dispidViewSelectionChangedEvent:58,dispidDataNodeAddedEvent:60,dispidDataNodeReplacedEvent:61,dispidDataNodeDeletedEvent:62,dispidEventMax:63},i.Constants={FileVersion:"16.0.10908.10000",ThreePartsFileVersion:"16.0.10908",OmexAnonymousServiceExtension:"/anonymousserviceextension.aspx",OmexGatedServiceExtension:"/gatedserviceextension.aspx",OmexUnGatedServiceExtension:"/ungatedserviceextension.aspx",OmexConsentNotificationPage:"/client/consentnotification.aspx",Http:"http",Https:"https",ProtocolSeparator:"://",SignInRedirectUrl:"/logontoliveforwac.aspx?returnurl=",ETokenParameterName:"et",ActivatedCacheKey:"__OSF_RUNTIME_.Activated.{0}.{1}.{2}",AuthenticatedConnectMaxTries:3,IgnoreSandBoxSupport:"Ignore_SandBox_Support",IEUpgradeUrl:"https://office.microsoft.com/redir/HA102789344.aspx",OmexForceAnonymousParamName:"SKAV",OmexForceAnonymousParamValue:"274AE4CD-E50B-4342-970E-1E7F36C70037",EndPointInternalSuffix:"_internal",PreloadOfficeJsId:"OFFICEJSPRELOAD",PreloadOfficeJsUrl:"//appsforoffice.microsoft.com/preloading/preloadoffice.js",StringResourceFile:"osfruntime_strings.js"};var a,s,c=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)};!function(e){!function(e){var t="ov:Control",n="ov:SourceLocation",r="resid",o="ov:Description",i="ov:Title",a="bt:Image",s="ov:VersionOverrides",u="o:OfficeApp",l=null,d=function(){return function(e){this.name="AddinManifestError",this.message=this.name+": "+e}}(),f=function(){return function(e){this.name="AddinInternalError",this.message=e}}();function p(e,t){if(e==l)throw new d(t)}var m=function(){function e(e){var t="bt:String",n=this;n.Images={},n.Urls={},n.LongStrings={},n.ShortStrings={};var r=e.manifest._xmlProcessor.selectSingleNode(u),o=e.selectSingleNode(r,[s,"ov:Resources"]);n.parseCollection(e,e.selectChildNodes(a,o,["bt:Images"]),n.Images),n.parseCollection(e,e.selectChildNodes("bt:Url",o,["bt:Urls"]),n.Urls),n.parseCollection(e,e.selectChildNodes(t,o,["bt:LongStrings"]),n.LongStrings),n.parseCollection(e,e.selectChildNodes(t,o,["bt:ShortStrings"]),n.ShortStrings)}return e.prototype.parseCollection=function(e,t,n){for(var r=t.length,o=0;o<r;o++){var i=t[o];n[i.getAttribute("id")]=e.parseLocaleAwareSettingsAndGetValue(i)}},e}();e.ManifestResourceManager=m;var g=function(){function e(e,t,n,r){var o=this;o.hostType=e,o.formFactor=t,o.entitlement=n,o.manifest=r,o.resources=new m(o)}return e.prototype.parseIdRequired=function(e){var t=e.getAttribute("id");return p(t,"Id required"),t},e.prototype.parseLabel=function(e){var t=this.manifest._xmlProcessor.selectSingleNode("ov:Label",e);return t!=l?this.getShortString(t):l},e.prototype.parseLabelRequired=function(e){var t=this.parseLabel(e);return p(t,"Label required"),t},e.prototype.parseRequiredSuperTip=function(e){var t=this.parseSuperTip(e);return p(t,"SuperTip required"),t},e.prototype.parseSuperTip=function(e){var t=this,n=l,r=t.manifest._xmlProcessor.selectSingleNode("ov:Supertip",e);if(r!=l){var a,s=r;p(r=t.manifest._xmlProcessor.selectSingleNode(i,s),"Title is necessary for SuperTip."),a=t.getShortString(r),p(r=t.manifest._xmlProcessor.selectSingleNode(o,s),"Description is necessary for SuperTip."),n={title:a,description:t.getLongString(r)}}return n},e.prototype.parseRequiredIcon=function(e){var t=this.parseIcon(e);return p(t,"Icon required"),t},e.prototype.parseIcon=function(e){var t=this.selectChildNodes(a,e,["ov:Icon"]),n=t.length;if(0==n)return l;for(var r={},o=0;o<n;o++){var i=t[o];r[i.getAttribute("size")]=this.getImageResource(i)}return r},e.prototype.parseChildControls=function(e,t,n){var r=this.manifest._xmlProcessor.selectNodes(e,t);return this.parseControls(r,n)},e.prototype.parseControls=function(e,t){for(var n=[],r=e.length,o=0;o<r;o++){var i=t(this,e[o]);p(i,"parser must return a control."),n.push(i)}return n},e.prototype.parseControlInGroup=function(t){var n,r=t.getAttribute(e.typeAttributeName);switch(r){case"Menu":n=new O;break;case"Button":n=new A(r);break;default:throw new d("Unsupported control type.")}return n.parse(this,t),n},e.prototype.parseMenuItem=function(e){var t=new T;return t.parse(this,e),t},e.prototype.parseLocaleAwareSettingsAndGetValue=function(e){var t=this,n={},r=e.getAttribute("DefaultValue");n[t.manifest._defaultLocale]=r,n[t.manifest._defaultLocale.toLocaleLowerCase()]=r;var o=t.manifest._xmlProcessor.selectNodes("bt:Override",e);if(o)for(var i=o.length,a=0;a<i;a++){var s=(e=o[a]).getAttribute("Locale"),c=e.getAttribute("Value");n[s]=c,n[s.toLocaleLowerCase()]=c}return t.manifest._getDefaultValue(n)},e.prototype.selectSingleNode=function(e,t){if(t==l)return e;for(var n=0;n<t.length&&(e=this.manifest._xmlProcessor.selectSingleNode(t[n],e))!=l;n++);return e},e.prototype.selectChildNodes=function(e,t,n){return(t=this.selectSingleNode(t,n))==l?[]:this.manifest._xmlProcessor.selectNodes(e,t)},e.prototype.getResourceByNode=function(e,t){var n=t.getAttribute(r),o=e[n];return p(o,"resid: "+n+" not found"),o},e.prototype.getImageResource=function(e){return this.getResourceByNode(this.resources.Images,e)},e.prototype.getUrlResource=function(e){return this.getResourceByNode(this.resources.Urls,e)},e.prototype.getLongString=function(e){return this.getResourceByNode(this.resources.LongStrings,e)},e.prototype.getShortString=function(e){return this.getResourceByNode(this.resources.ShortStrings,e)},e.typeAttributeName="xsi:type",e}();e.ParsingContext=g;var v=function(){function e(){}return e.buildControls=function(e,t){for(var n=t.length,r=0;r<n;r++){t[r].apply(e)}},e}(),h=function(){return function(e,t){this.functionFile=e,this.builder=t}}(),y=function(){function e(){}return e.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor,r=n.selectSingleNode(i,t);p(r,"Title is necessary for GetStarted."),this.title=e.getShortString(r);var a=n.selectSingleNode(o,t);p(a,"Description is necessary for GetStarted."),this.description=e.getLongString(a);var s=n.selectSingleNode("ov:LearnMoreUrl",t);this.learnMoreUrl=e.getUrlResource(s)},e}(),b=function(){function e(e){this.type=e}return e.prototype.buildAction=function(){},e.prototype.parse=function(){},e}(),_=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.buildAction=function(e){return e.actionBuilder.buildShowTaskpane(this.sourceLocation,this.title,this.taskpaneId)},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n);var r=t.manifest._xmlProcessor.selectSingleNode("ov:TaskpaneId",n);r!=l&&(this.taskpaneId=r.firstChild.nodeValue),(r=t.manifest._xmlProcessor.selectSingleNode(i,n))!=l&&(this.title=t.getShortString(r))},t}(function(e){function t(){e.apply(this,arguments),this.title=l}return c(t,e),t.prototype.parse=function(e,t){var r=e.manifest._xmlProcessor.selectSingleNode(n,t);p(r,"SourceLocation is necessary for ShowTaskpane action"),this.sourceLocation=e.getUrlResource(r),e.manifest.addManifestUrl(this.sourceLocation)},t}(b)),S=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.buildAction=function(e){return p(e.functionFile,"Function file source url is necessary for ExecuteFunctionAction."),e.actionBuilder.buildCallFunction(e.functionFile,this.functionName,this.controlId)},t.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode("ov:FunctionName",t);p(n,"FunctionName is necessary for ExecuteFunctionAction."),this.functionName=e.manifest._xmlProcessor.getNodeValue(n)},t}(b),C=function(){function e(){}return e.prototype.parse=function(e,t){this.id=e.parseIdRequired(t),this.label=e.parseLabelRequired(t)},e}(),O=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.apply=function(e){e.controlBuilder.startBuildMenu(this),v.buildControls(e,this.children),e.controlBuilder.endBuildMenu()},t.prototype.parse=function(t,n){var r=this;e.prototype.parse.call(r,t,n),r.icon=t.parseRequiredIcon(n),r.superTip=t.parseRequiredSuperTip(n);var o=t.selectChildNodes("ov:Item",n,["ov:Items"]);r.children=t.parseControls(o,function(e,t){return e.parseMenuItem(t)})},t}(C),I=function(e){function t(t){e.call(this),this.controlType=t}return c(t,e),t.prototype.apply=function(e){var t=this,n=t.action.buildAction(e),r={id:t.id,label:t.label,icon:t.icon,superTip:t.superTip,actionType:t.actionType,action:n};t.applyControl(e,r)},t.prototype.parse=function(t,n){var r=this;e.prototype.parse.call(r,t,n),r.icon=r.parseIcon(t,n),r.superTip=t.parseRequiredSuperTip(n);var o=t.manifest._xmlProcessor.selectSingleNode("ov:Action",n);p(o,"Action is necessary for itemControl.");var i,a=o.getAttribute(g.typeAttributeName);switch(a){case"ShowTaskpane":i=new _(a);break;case"ExecuteFunction":(i=new S(a)).controlId=r.id;break;default:throw new d("Unsupported action type.")}i.parse(t,o),r.actionType=a,r.action=i},t.prototype.applyControl=function(){throw new f("Not implemented method applyControl for ItemControl.")},t.prototype.parseIcon=function(e,t){return e.parseIcon(t)},t}(C),A=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.applyControl=function(e,t){e.controlBuilder.addButton(t)},t.prototype.parseIcon=function(e,t){return e.parseRequiredIcon(t)},t}(I),T=function(e){function t(){e.call(this,"MenuItem")}return c(t,e),t.prototype.applyControl=function(e,t){e.controlBuilder.addMenuItem(t)},t}(I),E=function(){function e(e){var t=this;t.label=l,t.isOfficeTab=!1,t.children=[],t.isOfficeTab=e}return e.prototype.apply=function(e){e.builder.ribbonBuilder.startBuildTab(this);for(var t=this.children.length,n=0;n<t;n++){this.children[n].apply(e)}e.builder.ribbonBuilder.endBuildTab()},e.prototype.parse=function(e,t){var n=this;n.id=e.parseIdRequired(t),n.isOfficeTab||(n.label=e.parseLabelRequired(t)),n.children=e.parseChildControls("ov:Group",t,function(e,t){var n=new x;return n.parse(e,t),n})},e}(),x=function(e){function n(){e.apply(this,arguments)}return c(n,e),n.prototype.parse=function(n,r){e.prototype.parse.call(this,n,r),this.icon=n.parseRequiredIcon(r),this.children=n.parseChildControls(t,r,function(e,t){return e.parseControlInGroup(t)})},n.prototype.apply=function(e){e.builder.ribbonBuilder.startBuildGroup(this),v.buildControls({functionFile:e.functionFile,actionBuilder:e.builder.actionBuilder,controlBuilder:e.builder.ribbonBuilder},this.children),e.builder.ribbonBuilder.endBuildGroup()},n}(C),P=function(){function e(e){this.type=e,this.tabs=[]}return e.prototype.apply=function(e){if(this.type==e.builder.commandSurface)for(var t=this.tabs.length,n=0;n<t;n++){this.tabs[n].apply(e)}},e.prototype.parse=function(e,t){var n,r=e.manifest._xmlProcessor.selectSingleNode("ov:OfficeTab",t);r!=l&&((n=new E(!0)).parse(e,r),this.tabs.push(n));(r=e.manifest._xmlProcessor.selectSingleNode("ov:CustomTab",t))!=l&&((n=new E(!1)).parse(e,r),this.tabs.push(n))},e}(),M=function(){function e(){}return e.prototype.parse=function(e,n){this.id=e.parseIdRequired(n),this.children=e.parseChildControls(t,n,function(e,t){return e.parseControlInGroup(t)})},e.prototype.apply=function(e){e.controlBuilder.startBuildMenu({id:this.id,label:l,superTip:l}),v.buildControls(e,this.children),e.controlBuilder.endBuildMenu()},e}(),w=function(){function e(e){this.type=e}return e.prototype.apply=function(e){this.type==e.builder.commandSurface&&v.buildControls({functionFile:e.functionFile,actionBuilder:e.builder.actionBuilder,controlBuilder:e.builder.contextMenuBuilder},this.children)},e.prototype.parse=function(e,t){this.children=e.parseChildControls("ov:OfficeMenu",t,function(e,t){var n=new M;return n.parse(e,t),n})},e}(),R=function(){function e(e){this.type=e}return e.prototype.apply=function(){},e.prototype.parse=function(e,t){var n=this,o=e.manifest._xmlProcessor.selectSingleNode("ov:Namespace",t);if(o&&(n.namespaceResId=o.getAttribute(r)),!n.namespaceResId)throw new d("Missing required <Namespace> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var i=e.manifest._xmlProcessor.selectSingleNode("ov:Script",t);if(i&&(n.scriptResId=n._parseSourceLocationResId(e,i)),!n.scriptResId)throw new d("Missing required <Script> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var a=e.manifest._xmlProcessor.selectSingleNode("ov:Page",t);if(a&&(n.pageResId=n._parseSourceLocationResId(e,a)),!n.pageResId)throw new d("Missing required <Page> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var s=e.manifest._xmlProcessor.selectSingleNode("ov:Metadata",t);if(s&&(n.metadataResId=n._parseSourceLocationResId(e,s)),!n.metadataResId)throw new d("Missing required <Metadata> element under element <ExtensionPoint xsi:type='CustomFunctions'>.")},e.prototype._parseSourceLocationResId=function(e,t){var o=e.manifest._xmlProcessor.selectSingleNode(n,t);if(o)return o.getAttribute(r)},e}();e.CustomFunctionsExtensionPoint=R;var k=function(){function e(){var e=this;e.getStartedNode=l,e.functionFile=l,e.cacheableUrls=[],e.ExtensionPoints=[]}return e.prototype.cacheableResources=function(){return this.cacheableUrls},e.prototype.apply=function(e,t){var n=this;try{e.startApplyAddin({entitlement:n.extensionEntitlement,manifest:n.extensionManifest,startedNode:n.getStartedNode,overrides:{type:n.type,description:n.description}});for(var r=new h(n.functionFile,e),o=n.ExtensionPoints.length,i=0;i<o;i++){n.ExtensionPoints[i].apply(r)}e.endApplyAddin()}catch(e){throw e instanceof d&&t.setErrorMessageForAddin(n.extensionEntitlement.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),e}},e.prototype.parse=function(e,t){var n=this;n.type=t.getAttribute(g.typeAttributeName);var r=e.manifest._xmlProcessor.selectSingleNode(o,t);r!=l&&(n.description=e.getLongString(r));for(var i=e.selectChildNodes("ov:Host",t,["ov:Hosts"]),a=l,s=i.length,c=0;c<s;c++){var u=i[c];if(u.getAttribute(g.typeAttributeName)==e.hostType){(a=e.manifest._xmlProcessor.selectSingleNode("ov:"+e.formFactor,u))==l&&(a=e.manifest._xmlProcessor.selectSingleNode("ov:AllFormFactors",u));break}}var f=e.manifest._xmlProcessor.selectSingleNode("ov:GetStarted",a);f!=l&&(n.getStartedNode=new y,n.getStartedNode.parse(e,f)),(r=e.manifest._xmlProcessor.selectSingleNode("ov:FunctionFile",a))!=l&&(n.functionFile=e.getUrlResource(r),e.manifest.addManifestUrl(n.functionFile));var p=e.manifest._xmlProcessor.selectNodes("ov:ExtensionPoint",a);s=p.length;for(c=0;c<s;c++){var m,v=p[c],h=v.getAttribute(g.typeAttributeName);switch(h){case"Events":throw"Not Implemented";case"PrimaryCommandSurface":m=new P(h);break;case"ContextMenu":m=new w(h);break;case"CustomFunctions":m=new R(h);break;default:throw new d("Unsupported extension type.")}m.parse(e,v),n.ExtensionPoints.push(m)}var b=e.resources.Images;for(var _ in b)n.cacheableUrls.push(b[_]);n.extensionEntitlement=e.entitlement,n.extensionManifest=e.manifest},e}();e.VersionOverrides=k;var D=function(){function e(){}return e.prototype.cacheableResources=function(){return[]},e.prototype.apply=function(){},e}(),j=function(){function e(e,t){this.hostType=e,this.formFactor=t}return e.prototype.parseExtensions=function(e,t,n){try{var r=t._xmlProcessor.selectSingleNode(u),o=t._xmlProcessor.selectSingleNode(s,r);if(o==l)return new D;var i=new k;return i.parse(new g(this.hostType,this.formFactor,e,t),o),i}catch(t){throw t instanceof d&&n.setErrorMessageForAddin(e.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),t}},e}();e.AddinCommandsManifestParser=j}(e.Parser||(e.Parser={}))}(l||(l={})),function(e){var t=function(){function e(){}return e.createManifestForAddinAction=function(e,t,n,r){var o=null,a=new i.Manifest.ExtensionSettings,s=(i.FormFactor.Default,{}),c=e._UILocale.toLocaleLowerCase();s[c]=n,a._defaultHeight=o,a._defaultWidth=o,a._sourceLocations={},a._sourceLocations[c]=t;var u=e;return new i.Manifest.Manifest(function(e){e._xmlProcessor=u._xmlProcessor,e._displayNames=n!=o?s:u._displayNames,e._iconUrls=u._iconUrls,e._extensionSettings={formFactor:a},e._highResolutionIconUrls=u._highResolutionIconUrls,e._target=u._target,e._id=r!=o?r:u._id,e._version=u._version,e._providerName=u._providerName,e._idIssuer=u._idIssuer,e._alternateId=u._alternateId,e._defaultLocale=u._defaultLocale,e._signature=u._signature,e._capabilities=u._capabilities,e._hosts=u._hosts,e._descriptions=u._descriptions,e._appDomains=u._appDomains,e._permissions=u._permissions,e._requirements=u._requirements,e._webApplicationResource=u._webApplicationResource,e._webApplicationId=u._webApplicationId,e._webApplicationScopes=u._webApplicationScopes,e._webApplicationAuthorizations=u._webApplicationAuthorizations},u._UILocale)},e.cacheManifestForAction=function(e,t,n){i.OsfManifestManager.cacheManifest(t,n,e)},e.purgeManifestForAction=function(e,t){i.OsfManifestManager.purgeManifest(e,t)},e}();e.AddinCommandsManifestManager=t}(l||(l={})),function(e){var t="##UILessContainer##",n=null;e.AddinActionContextMap={},e.AutoShowTaskPaneControlIdMap={};var r={};!function(e){var t="ExclusiveForNew",n="ExclusiveForCur";e[e.Default=1]="Default",e[e[n]=2]=n,e[e[t]=3]=t}(e.CommandInvokeMode||(e.CommandInvokeMode={}));var o,a=e.CommandInvokeMode;!function(e){var t="ooeOperationNotSupported",n="ooeSuccess",r="ooeTimeout";e[e[r]=-1]=r,e[e[n]=0]=n,e[e[t]=5e3]=t}(o||(o={}));var s=function(){function a(e,t,n){this.contextProvider=e,this.manifest=n,this.entitlement=t}return a.prototype.buildShowTaskpane=function(e,t,n){return this.CreateManifestAndActivationContextForTaskpaneCommand(e,t,n)},a.prototype.buildCallFunction=function(e,t,n){return this.CreateManifestAndActivationContextForUILessCommand(e,t,n)},a.prototype.CreateManifestAndActivationContextForTaskpaneCommand=function(e,t,i){var a=function(e,t){t==o.ooeSuccess&&i!=n&&(r[i]=e)},s=function(e,t){var o=r[e];if(o==n)return!1;var i=t.getOsfControl(o);return i!=n&&(i._refresh(),!0)};return this.CreateManifestAndActivationContext(e,t,i,function(e,t,r,o){i!=n&&s(i,t),e.showTaskpane(r,o,a)})},a.prototype.CreateManifestAndActivationContext=function(t,r,o,a){var s=this,c=e.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,t,r,n);return function(t){var r=s.contextProvider.createActionContext(t,function(n,r){var u={assetId:s.entitlement.assetId+(o||t),appVersion:s.entitlement.appVersion,storeId:s.entitlement.storeId,storeType:i.StoreType.InMemory,targetType:i.OsfControlTarget.TaskPane};c._inMemoryEToken=s.entitlement.eToken,e.AddinCommandsManifestManager.cacheManifestForAction(c,u.assetId,u.appVersion),a(n,r,u,c)});e.AddinActionContextMap[t]=r,e.AutoShowTaskPaneControlIdMap[s.entitlement.assetId]==n&&"Office.AutoShowTaskpaneWithDocument"==o&&(e.AutoShowTaskPaneControlIdMap[s.entitlement.assetId]=t)}},a.prototype.CreateManifestAndActivationContextForUILessCommand=function(r,a,s){var c=this,u=function(e,t){if(t==o.ooeSuccess){var n={source:{id:s}};d.invokeAppCommand(e,a,n,function(){})}},l=e.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,r,n,n);return function(n){var r=c.contextProvider.createActionContext(n,function(n){var r={assetId:c.entitlement.assetId+t,appVersion:c.entitlement.appVersion,storeId:c.entitlement.storeId,storeType:i.StoreType.InMemory,targetType:i.OsfControlTarget.TaskPane};e.AddinCommandsManifestManager.cacheManifestForAction(l,r.assetId,r.appVersion),n.createUILessSandbox(r,l,function(e,t){if(t==o.ooeSuccess)d.ensureOsfHostEntry(e,n);u(e,t)})});e.AddinActionContextMap[n]=r}},a}(),c=function(){function n(e,t){this.contextProvider=e,this.entitlement=t}return n.prototype.buildShowTaskpane=function(){var t=this;return function(n){delete e.AddinActionContextMap[n],e.AddinCommandsManifestManager.purgeManifestForAction(t.entitlement.assetId+n,t.entitlement.appVersion)}},n.prototype.buildCallFunction=function(){var n=this;return function(r){delete e.AddinActionContextMap[r],e.AddinCommandsManifestManager.purgeManifestForAction(n.entitlement.assetId+t,n.entitlement.appVersion)}},n}(),u=function(){function t(){}return t.createActionBuilder=function(e,t,n){return new s(e,t,n)},t.createDeleterActionBuilder=function(e,t){return new c(e,t)},t.bindAction=function(e,t){t(e)},t.retrieveActionContext=function(t){return e.AddinActionContextMap[t]},t.retrieveAutoShowTaskPaneControlIdMap=function(){return e.AutoShowTaskPaneControlIdMap},t}();e.DefaultControlActionBinder=u;var l=function(){function e(){this.invocationQueue={}}return e.prototype.invokeAppCommand=function(t,r,o,s,c){var u=this,l={dispid:i.DDA.EventDispId.dispidAppCommandInvokedEvent,controlId:u.osfControlId};l[0]=t,l[1]=r,l[2]=JSON.stringify(o),c=c||e.defaultTimeout;var d=o&&o.commandMode?o.commandMode:a.Default,f={args:l,onComplete:s,timeout:c,timeoutTimer:n},p=u.invocationQueue[r];p==n&&(p=[],u.invocationQueue[r]=p),!(d==a.ExclusiveForCur&&p.length>0)&&!(d==a.ExclusiveForNew&&p.length>1)&&p.push(f),1==p.length&&u.trySendInvocation(f)},e.prototype.invocationCompleted=function(e,t,r){var o=this,i=o;for(var a in o.invocationQueue){var s=o.invocationQueue[a],c=s[0];if(e==c.args[0]){if(s.length>1){s.splice(0,1);var u=s[0];window.setTimeout(function(){i.trySendInvocation(u)},0)}else delete o.invocationQueue[a];return c.timeoutTimer!=n&&(window.clearTimeout(c.timeoutTimer),c.timeoutTimer=n),void c.onComplete(t,r)}}},e.prototype.sendInvocations=function(e){var t=this;if(t.eventHandler=e,e!=n)for(var r in t.invocationQueue){var o=t.invocationQueue[r][0];t.sendInvocation(e,o)}},e.prototype.trySendInvocation=function(e){var t=this.eventHandler;t!=n&&this.sendInvocation(t,e)},e.prototype.sendInvocation=function(e,t){var n=this,r=t.args;e(r),t.timeoutTimer=window.setTimeout(function(){n.invocationTimeout(r[0])},t.timeout)},e.prototype.invocationTimeout=function(e){this.invocationCompleted(e,o.ooeTimeout,n)},e.prototype.disposeHost=function(){var e=this;for(var t in e.invocationQueue)return;e.host.disposeHost(e.osfControlId),e.onDisposed!=n&&e.onDisposed(e)},e.defaultTimeout=3e5,e}(),d=function(){var e="targetId",t="controlId",r="eventDispId";function a(){}return a.registerEvent=function(n,o,i){a.registerEventInternal(i[r],i[t],i[e],n,function(e){o&&o(0==e)})},a.unregisterEvent=function(n,o,i){a.unregisterEventInternal(i[r],i[t],i[e],n,function(e){o&&o(0==e)})},a.invokeAppCommand=function(e,t,n,r){var o=a.getOrCreateOsfHostEntry(e),i=a.getNextAppCommandId();o.invokeAppCommand(i,t,n,r)},a.invocationCompleted=function(e,t){var r=a.getOrCreateOsfHostEntry(e),o=t[0],i=t[1],s=t[2]?JSON.parse(t[2]):n;r.invocationCompleted(o,i,s)},a.ensureOsfHostEntry=function(e,t){var r=a.getOrCreateOsfHostEntry(e);return r.host==n&&(r.host=t),r},a.getNextAppCommandId=function(){return"AppCmd"+a._nextAppCommandId++},a.getOrCreateOsfHostEntry=function(e){var t=a._invocationQueues[e];return t==n&&((t=new l).osfControlId=e,t.onDisposed=function(e){delete a._invocationQueues[e.osfControlId]},a._invocationQueues[e]=t),t},a.registerEventInternal=function(e,t,n,r,s){switch(e){case i.DDA.EventDispId.dispidAppCommandInvokedEvent:var c=a.getOrCreateOsfHostEntry(t);return s(o.ooeSuccess),void c.sendInvocations(r)}s(o.ooeOperationNotSupported)},a.unregisterEventInternal=function(e,t,r,s,c){switch(e){case i.DDA.EventDispId.dispidAppCommandInvokedEvent:var u=a.getOrCreateOsfHostEntry(t);return u.eventHandler==s&&(u.eventHandler=n),void c(o.ooeSuccess)}c(o.ooeOperationNotSupported)},a._nextAppCommandId=0,a._invocationQueues={},a}();e.AddinCommandsRuntimeManager=d}(l||(l={})),i.ShowWindowDialogParameterKeys={Url:"url",Width:"width",Height:"height",DisplayInIframe:"displayInIframe",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",PromptBeforeOpen:"promptBeforeOpen"},i.HostThemeButtonStyleKeys={ButtonBorderColor:"buttonBorderColor",ButtonBackgroundColor:"buttonBackgroundColor"},i.OmexPageParameterKeys={AppName:"client",AppVersion:"cv",AppUILocale:"ui",AppDomain:"appDomain",StoreLocator:"rs",AssetId:"assetid",NotificationType:"notificationType",AppCorrelationId:"corr",AuthType:"authType",AppId:"appid",Scopes:"scopes"},i.AuthType={Anonymous:0,MSA:1,OrgId:2,ADAL:3},i.OmexMessageKeys={MessageType:"messageType",MessageValue:"messageValue"},i.OmexRemoveAddinMessageKeys={RemoveAddinResultCode:"resultCode",RemoveAddinResultValue:"resultValue"},i.OmexRemoveAddinResultCode={Success:0,ClientError:400,ServerError:500,UnknownError:600},function(e){!function(e){var t="^https://[a-z0-9-]+.(officeapps.live|officeapps-df.live|partner.officewebapps).com/";function n(e){if("undefined"!=typeof JSON)try{return JSON.stringify(e)}catch(e){}return""}function r(){try{var e=window.navigator.userAgent;return e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1||e.indexOf("Edge/")>-1}catch(e){return a("Error happens in isInternetExplorer.",e),!1}}function a(e,t){o.msAjaxDebug.trace(e+" Exception details: "+n(t))}e.parseAppContextFromWindowName=function(e,t){return i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.AppContext)},e.serializeObjectToString=n,e.isHostTrusted=function(){return new RegExp(t).test(i.getClientEndPoint()._targetUrl.toLowerCase())},e.addHostInfoAsQueryParam=function(e,t){if(!e)return null;var n,r="#",o=(e=e.trim()||"").split(r),i=o.shift(),a=o.join(r),s=i.split("?");return s.length>1?n=i+"&_host_Info="+t:s.length>0&&(n=i+"?_host_Info="+t),a?[n,r,a].join(""):n},e.getDomainForUrl=function(e){if(!e)return null;var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host},e.shouldUseLocalStorageToPassMessage=function(){try{for(var e=["Windows NT 6.1","Windows NT 6.2","Windows NT 6.3"],t=window.navigator.userAgent,n=0,o=e.length;n<o;n++)if(t.indexOf(e[n])>-1)return r();return!1}catch(e){return a("Error happens in shouldUseLocalStorageToPassMessage.",e),!1}},e.isInternetExplorer=r,e.removeMatchesFromLocalStorage=function(e){for(var t=i.OUtil.getLocalStorage(),n=t.getKeysWithPrefix(""),r=0,o=n.length;r<o;r++)for(var a=n[r],s=0,c=e.length;s<c;s++)if(e[s].test(a)){t.removeItem(a);break}},e.logExceptionToBrowserConsole=a;var s=function(){function e(){}return e.GatedCacheKeyPrefix="__OSF_GATED_OMEX.",e.AuthenticatedAppInstallInfoCacheKey=e.GatedCacheKeyPrefix+"appinstall_authenticated.{0}.{1}.{2}.{3}",e.EntitlementsKey="entitle.{0}.{1}",e}();e.CacheConstants=s}(e.WACUtils||(e.WACUtils={}))}(l||(l={})),i.XmlConstants={MaxXmlSize:1048576,MaxElementDepth:64},i.Xpath3Provider=function(e,t){var n=this;n._xmldoc=(new DOMParser).parseFromString(e,"text/xml"),n._evaluator=new XPathEvaluator,n._namespaceMapping={},n._defaultNamespace=null;for(var r,o=t.split(" "),i=0;i<o.length;++i)(r=/xmlns="([^"]*)"/g.exec(o[i]))?n._defaultNamespace=r[1]:(r=/xmlns:([^=]*)="([^"]*)"/g.exec(o[i]))&&(n._namespaceMapping[r[1]]=r[2]);n._resolver=n},i.Xpath3Provider.prototype={lookupNamespaceURI:function(e){return this._namespaceMapping[e]||this._defaultNamespace},addNamespaceMapping:function(e,t){return!this._namespaceMapping[e]&&(this._namespaceMapping[e]=t,!0)},selectSingleNode:function(e,t){var n=(t?"./":"/")+e;t=t||this.getDocumentElement();var r=this._evaluator.evaluate(n,t,this._resolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null);return r?r.singleNodeValue:null},selectNodes:function(e,t){var n=(t?"./":"/")+e;t=t||this.getDocumentElement();var r=this._evaluator.evaluate(n,t,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),o=[];if(r)for(var i=r.iterateNext();i;)o.push(i),i=r.iterateNext();return o},selectNodesByXPath:function(e,t){var n=this._evaluator.evaluate(e,t,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),r=[];if(n)for(var o=n.iterateNext();o;)r.push(o),o=n.iterateNext();return r},getDocumentElement:function(){return this._xmldoc.documentElement}},i.IEXpathProvider=function(e,t){for(var n=null,r=["MSXML2.DOMDocument.6.0"],a=0;a<r.length;a++)try{(n=new ActiveXObject(r[a])).setProperty("ResolveExternals",!1),n.setProperty("ValidateOnParse",!1),n.setProperty("ProhibitDTD",!0),n.setProperty("MaxXMLSize",i.XmlConstants.MaxXmlSize),n.setProperty("MaxElementDepth",i.XmlConstants.MaxElementDepth),n.async=!1,n.loadXML(e),n.setProperty("SelectionLanguage","XPath"),n.setProperty("SelectionNamespaces",t);break}catch(e){o.msAjaxDebug.trace("xml doc creating error:"+e)}this._xmldoc=n},i.IEXpathProvider.prototype={selectSingleNode:function(e,t){var n=(t?"./":"/")+e;return(t=t||this.getDocumentElement()).selectSingleNode(n)},addNamespaceMapping:function(e,t){var n="SelectionNamespaces",r=this._xmldoc.getProperty(n),o="xmlns:"+e+"=",i="xmlns:"+e+'="'+t+'"';return-1==r.indexOf(o)&&(r=r+" "+i,this._xmldoc.setProperty(n,r),!0)},selectNodes:function(e,t){var n=(t?"./":"/")+e;return(t=t||this.getDocumentElement()).selectNodes(n)},selectNodesByXPath:function(e,t){return t.selectNodes(e)},getDocumentElement:function(){return this._xmldoc.documentElement},getActiveXObject:function(){return this._xmldoc}},i.DomParserProvider=function(e,t){var n=this;try{n._xmldoc=(new DOMParser).parseFromString(e,"text/xml")}catch(e){Sys.Debug.trace("xml doc creating error:"+e)}n._namespaceMapping={},n._defaultNamespace=null;for(var r,o=t.split(" "),i=0;i<o.length;++i)(r=/xmlns="([^"]*)"/g.exec(o[i]))?n._defaultNamespace=r[1]:(r=/xmlns:([^=]*)="([^"]*)"/g.exec(o[i]))&&(n._namespaceMapping[r[1]]=r[2])},i.DomParserProvider.prototype={addNamespaceMapping:function(e,t){return!this._namespaceMapping[e]&&(this._namespaceMapping[e]=t,!0)},selectSingleNode:function(e,t){var n=t||this._xmldoc,r=this._selectNodes(e,n);return 0===r.length?null:r[0]},selectNodes:function(e,t){var n=t||this._xmldoc;return this._selectNodes(e,n)},selectNodesByXPath:function(){return null},_selectNodes:function(e,t){var n=[];if(!e)return n;var r,i,a=e.split(":");if(1===a.length)r=null,i=a[0];else{if(2!==a.length)throw o.msAjaxError.argument("name");r=this._namespaceMapping[a[0]],i=a[1]}if(!t.hasChildNodes)return n;for(var s=t.childNodes,c=0;c<s.length;c++)i===this._removeNodePrefix(s[c].nodeName)&&r===s[c].namespaceURI&&n.push(s[c]);return n},_removeNodePrefix:function(e){var t=e.split(":");return 1===t.length?e:t[1]},getDocumentElement:function(){return this._xmldoc.documentElement}},i.XmlProcessor=function(e,t){var n=this,r=Function._validateParams(arguments,[{name:"xml",type:String,mayBeNull:!1},{name:"xmlNamespaces",type:String,mayBeNull:!1}]);if(r)throw r;document.implementation&&document.implementation.hasFeature("XPath","3.0")?n._provider=new i.Xpath3Provider(e,t):(n._provider=new i.IEXpathProvider(e,t),n._provider.getActiveXObject()||(n._provider=new i.DomParserProvider(e,t)))},i.XmlProcessor.prototype={addNamespaceMapping:function(e,t){var n=Function._validateParams(arguments,[{name:"namespacePrefix",type:String,mayBeNull:!1},{name:"namespaceUri",type:String,mayBeNull:!1}]);if(n)throw n;return this._provider.addNamespaceMapping(e,t)},selectSingleNode:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return this._provider.selectSingleNode(e,t)},selectNodes:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return this._provider.selectNodes(e,t)},selectNodesByXPath:function(e,t){var n=Function._validateParams(arguments,[{name:"xpath",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return t=t||this._provider.getDocumentElement(),this._provider.selectNodesByXPath(e,t)},getDocumentElement:function(){return this._provider.getDocumentElement()},getNodeValue:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.text?e.text:e.textContent},getNodeText:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return 9==this.getNodeType(e)?this.getNodeText(this.getDocumentElement()):e.text?e.text:e.textContent},setNodeText:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"text",type:String,mayBeNull:!1}]);if(n)throw n;if(9==this.getNodeType(e))return!1;try{e.text?e.text=t:e.textContent=t}catch(e){return!1}return!0},getNodeXml:function(e){var t,n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(n)throw n;return e.xml?t=e.xml:(t=(new XMLSerializer).serializeToString(e),2==this.getNodeType(e)&&(t=this.getNodeBaseName(e)+'="'+t+'"')),t},setNodeXml:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"xml",type:String,mayBeNull:!1}]);if(n)throw n;var r=new i.XmlProcessor(t,"");if(!r.isValidXml())return null;var o=r.getDocumentElement();try{e.parentNode.replaceChild(o,e)}catch(e){return null}return o},getNodeNamespaceURI:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.namespaceURI},getNodePrefix:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.prefix},getNodeBaseName:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return!e.nodeType||1!=e.nodeType&&2!=e.nodeType?e.nodeName:e.baseName?e.baseName:e.localName},getNodeType:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.nodeType},appendChild:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"childXml",type:String,mayBeNull:!1}]);if(n)throw n;var r=new i.XmlProcessor(t,"");if(!r.isValidXml())return null;var o=r.getDocumentElement();return e.appendChild(o),o},_getAttributeLocalName:function(e){return e.localName?e.localName:e.baseName},readAttributes:function(e,t,n){var r=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"attributesToRead",type:Object,mayBeNull:!1},{name:"objectToFill",type:Object,mayBeNull:!1}]);if(r)throw r;for(var o,i,a=0;a<e.attributes.length;a++)for(var s in o=e.attributes[a],i=this._getAttributeLocalName(o),t)i===s&&(n[t[s]]=o.value)},isValidXml:function(){var e="parsererror";if(null==this.getDocumentElement())return!1;if(this._provider._xmldoc.getElementsByTagName(e).length>0){var t=(new DOMParser).parseFromString("<","text/xml").getElementsByTagName(e)[0].namespaceURI;return this._provider._xmldoc.getElementsByTagNameNS(t,e).length<=0}return!0}},function(e){var t=function(){function e(){}return e.prototype.Serialize=function(e){try{return JSON.stringify(e)}catch(e){return null}},e.prototype.Deserialize=function(e){try{return JSON.parse(e)}catch(e){return null}},e}();e.SafeSerializer=t;var n=function(){function e(e,t){this._localStorage=e,this._serializer=t}return e.prototype.GetCacheItem=function(t,n,r,o,i){var a="cacheExpired",s=this;void 0===n&&(n=!0),void 0===i&&(i=!0),s.ValidateCurrentCache();var c=s._localStorage.getItem(t);if(c){var u=s._serializer.Deserialize(c);if(void 0!==o&&o>0&&o-u.createdOn>0)s._localStorage.removeItem(t),r&&(r[a]=!0);else{if(!n)return u.data;var l=new Date;if(Math.abs(l.getTime()-u.createdOn)<e.msPerDay*u.refreshRate)return u.data;i&&(s._localStorage.removeItem(t),r&&(r[a]=!0))}}},e.prototype.SetCacheItem=function(t,n,r){r=r||e.defaultRefreshRateInDays;var o={data:n,createdOn:(new Date).getTime(),refreshRate:r};this._localStorage.setItem(t,this._serializer.Serialize(o))},e.prototype.RemoveCacheItem=function(e){this._localStorage.removeItem(e)},e.prototype.RemoveAll=function(e){for(var t=this._localStorage.getKeysWithPrefix(e),n=0,r=t.length;n<r;n++)this._localStorage.removeItem(t[n])},e.prototype.RemoveMatches=function(e){for(var t=this._localStorage.getKeysWithPrefix(""),n=0,r=t.length;n<r;n++)for(var o=t[n],i=0,a=e.length;i<a;i++)if(e[i].test(o)){this._localStorage.removeItem(o);break}},e.prototype.ValidateCurrentCache=function(){this._localStorage.getItem(e.cacheVersionKey)!=e.currentSchemaVersion&&(this.RemoveMatches([new RegExp("__OSF_(?!.*activated).*$","i")]),this._localStorage.setItem(e.cacheVersionKey,e.currentSchemaVersion))},e.defaultRefreshRateInDays=3,e.msPerDay=864e5,e.currentSchemaVersion="1",e.checkedCache=!1,e.cacheVersionKey="osfCacheVersion",e}();e.AppsDataCacheManager=n;var r=function(e){function t(t,n){e.call(this,t,n)}return c(t,e),t.prototype.GetRefreshToken=function(n,r){var o=i.OUtil.formatString(t._refreshTokenCacheKey,n,r);return e.prototype.GetCacheItem.call(this,o)},t.prototype.AddRefreshToken=function(n,r,o){var a=i.OUtil.formatString(t._refreshTokenCacheKey,r,o);e.prototype.SetCacheItem.call(this,a,n)},t.prototype.RemoveAll=function(){e.prototype.RemoveAll.call(this,t._refreshTokenCachePrefixKey)},t.prototype.RemoveRefreshToken=function(n,r){var o=i.OUtil.formatString(t._refreshTokenCacheKey,n,r);e.prototype.RemoveCacheItem.call(this,o)},t._refreshTokenCacheKey="_OSF_PRIVATECATALOG_REFRESHTOKEN_{0}_{1}",t._refreshTokenCachePrefixKey="_OSF_PRIVATECATALOG_REFRESHTOKEN",t}(n);e.TokenCacheManager=r}(l||(l={})),function(e){var t="Error",n="ResponseTime",r="Result",o="OperationMetadata",i="ErrorResult",a="AssetId",s="CorrelationId",u=!0,l=function(){function e(e){this._table=e,this._fields={}}return Object.defineProperty(e.prototype,"Fields",{get:function(){return this._fields},enumerable:u,configurable:u}),Object.defineProperty(e.prototype,"Table",{get:function(){return this._table},enumerable:u,configurable:u}),e.prototype.SerializeFields=function(){},e.prototype.SetSerializedField=function(e,t){null!=t&&(this._serializedFields[e]=t.toString())},e.prototype.SerializeRow=function(){var e=this;return e._serializedFields={},e.SetSerializedField("Table",e._table),e.SerializeFields(),JSON.stringify(e._serializedFields)},e}();e.BaseUsageData=l;var d=function(e){var t="Stage11Time",n="Stage10Time",r="Stage9Time",o="Stage8Time",l="Stage7Time",d="Stage6Time",f="Stage5Time",p="Stage4Time",m="Stage3Time",g="Stage2Time",v="Stage1Time",h="InstanceId",y="ActivationInfo",b="AppInfo";function _(){e.call(this,"AppLoadTime")}return c(_,e),Object.defineProperty(_.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,b,{get:function(){return this.Fields[b]},set:function(e){this.Fields[b]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,y,{get:function(){return this.Fields[y]},set:function(e){this.Fields[y]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,h,{get:function(){return this.Fields[h]},set:function(e){this.Fields[h]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,v,{get:function(){return this.Fields[v]},set:function(e){this.Fields[v]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,g,{get:function(){return this.Fields[g]},set:function(e){this.Fields[g]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,m,{get:function(){return this.Fields[m]},set:function(e){this.Fields[m]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,p,{get:function(){return this.Fields[p]},set:function(e){this.Fields[p]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,f,{get:function(){return this.Fields[f]},set:function(e){this.Fields[f]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,d,{get:function(){return this.Fields[d]},set:function(e){this.Fields[d]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,l,{get:function(){return this.Fields[l]},set:function(e){this.Fields[l]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),Object.defineProperty(_.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),_.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(b,e.AppInfo),e.SetSerializedField(y,e.ActivationInfo),e.SetSerializedField(h,e.InstanceId),e.SetSerializedField(a,e.AssetId),e.SetSerializedField(v,e.Stage1Time),e.SetSerializedField(g,e.Stage2Time),e.SetSerializedField(m,e.Stage3Time),e.SetSerializedField(p,e.Stage4Time),e.SetSerializedField(f,e.Stage5Time),e.SetSerializedField(d,e.Stage6Time),e.SetSerializedField(l,e.Stage7Time),e.SetSerializedField(o,e.Stage8Time),e.SetSerializedField(r,e.Stage9Time),e.SetSerializedField(n,e.Stage10Time),e.SetSerializedField(t,e.Stage11Time),e.SetSerializedField(i,e.ErrorResult)},_}(l);e.AppLoadTimeUsageData=d;var f=function(e){var t="NotificationClickInfo";function n(){e.call(this,"AppNotification")}return c(n,e),Object.defineProperty(n.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(n.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),Object.defineProperty(n.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),n.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(i,e.ErrorResult),e.SetSerializedField(t,e.NotificationClickInfo)},n}(l);e.AppNotificationUsageData=f;var p=function(e){function t(){e.call(this,"AppManagementMenu")}return c(t,e),Object.defineProperty(t.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),t.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(a,e.AssetId),e.SetSerializedField(o,e.OperationMetadata),e.SetSerializedField(i,e.ErrorResult)},t}(l);e.AppManagementMenuUsageData=p;var m=function(e){var t="LastActiveTabCount",n="LastActiveTab",r="DialogState",o="TrustPageSessionTime",i="TotalSessionTime";function s(){e.call(this,"InsertionDialogSession")}return c(s,e),Object.defineProperty(s.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(s.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),Object.defineProperty(s.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(s.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(s.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(s.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),s.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(a,e.AssetId),e.SetSerializedField(i,e.TotalSessionTime),e.SetSerializedField(o,e.TrustPageSessionTime),e.SetSerializedField(r,e.DialogState),e.SetSerializedField(n,e.LastActiveTab),e.SetSerializedField(t,e.LastActiveTabCount)},s}(l);e.InsertionDialogSessionUsageData=m;var g=function(e){function t(){e.call(this,"UploadFileDevCatelog")}return c(t,e),Object.defineProperty(t.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),t.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(o,e.OperationMetadata),e.SetSerializedField(i,e.ErrorResult)},t}(l);e.UploadFileDevCatelogUsageData=g;var v=function(e){var t="AppSizeHeight",n="AppSizeWidth",r="IsAppCommand",o="AppTargetType",i="AppVersion",a="AppId",l="StoreType";function d(){e.call(this,"UploadFileDevCatalogUsage")}return c(d,e),Object.defineProperty(d.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,l,{get:function(){return this.Fields[l]},set:function(e){this.Fields[l]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),d.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(l,e.StoreType),e.SetSerializedField(a,e.AppId),e.SetSerializedField(i,e.AppVersion),e.SetSerializedField(o,e.AppTargetType),e.SetSerializedField(r,e.IsAppCommand),e.SetSerializedField(n,e.AppSizeWidth),e.SetSerializedField(t,e.AppSizeHeight)},d}(l);e.UploadFileDevCatalogUsageUsageData=v;var h=function(e){function o(){e.call(this,"OneDriveCatalogGetAccessToken")}return c(o,e),Object.defineProperty(o.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),o.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},o}(l);e.OneDriveCatalogGetAccessTokenUsageData=h;var y=function(e){function o(){e.call(this,"OneDriveCatalogGetManifests")}return c(o,e),Object.defineProperty(o.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),o.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},o}(l);e.OneDriveCatalogGetManifestsUsageData=y;var b=function(e){var o="id";function i(){e.call(this,"OneDriveCatalogGetManifest")}return c(i,e),Object.defineProperty(i.prototype,o,{get:function(){return this.Fields.id},set:function(e){this.Fields.id=e},enumerable:u,configurable:u}),Object.defineProperty(i.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(i.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(i.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),i.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(o,e.id),e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},i}(l);e.OneDriveCatalogGetManifestUsageData=b;var _=function(e){function o(){e.call(this,"OneDriveCatalogInsertManifest")}return c(o,e),Object.defineProperty(o.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),o.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},o}(l);e.OneDriveCatalogInsertManifestUsageData=_}(a||(a={})),function(e){var t=null;!function(e){var t="verboseEx",n="unexpected";e[e[n]=10]=n,e[e.warning=15]="warning",e[e.info=50]="info",e[e.verbose=100]="verbose",e[e[t]=200]=t}(e.ULSTraceLevel||(e.ULSTraceLevel={}));var n=e.ULSTraceLevel;!function(e){var t="msoulscat_Osf_UploadFileDevCatalogUsage",n="msoulscat_Osf_UploadFileDevCatelog",r="msoulscat_Osf_InsertionDialogSession",o="msoulscat_Osf_AppManagementMenu",i="msoulscat_Osf_Runtime",a="msoulscat_Osf_Notification",s="msoulscat_Osf_Latency";e[e[s]=1401]=s,e[e[a]=1402]=a,e[e[i]=1403]=i,e[e[o]=1404]=o,e[e[r]=1405]=r,e[e[n]=1406]=n,e[e[t]=1411]=t}(e.ULSCat||(e.ULSCat={}));var r,o,s=e.ULSCat;!function(e){var t="IsAnonymous",n="InsertionDialogClosed",r="ConfirmationDialogCancel";e[e[r]=256]=r,e[e[n]=512]=n,e[e[t]=1024]=t}(r||(r={})),function(e){var t="TrustPageVisited",n="Canceled",r="Inserted",o="Undefined";e[e[o]=0]=o,e[e[r]=1]=r,e[e[n]=2]=n,e[e.Closed=3]="Closed",e[e[t]=8]=t}(o||(o={}));var c=function(){function e(){this.timeValue=0}return e.prototype.Start=function(){this.timeValue=-(new Date).getTime(),this.finishedMeasurement=!1},e.prototype.Stop=function(){this.timeValue<0&&(this.timeValue+=(new Date).getTime(),this.finishedMeasurement=!0)},Object.defineProperty(e.prototype,"Finished",{get:function(){return this.finishedMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){var e=this.timeValue;return!this.Finished&&e<0&&(e=Math.abs(e)-(new Date).getTime()),e},enumerable:!0,configurable:!0}),e}();e.LatencyStopwatch=c;var u=function(){return function(){}}();e.Context=u;var l=function(){function e(){}return e.SendULSTraceTag=function(e,t,n,r){Microsoft.Office.WebExtension.FULSSupported&&Diag.UULS.trace(r,e,t,n)},e}(),d=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),6062431)},e.category=s.msoulscat_Osf_Notification,e.level=n.info,e}();e.NotificationLogger=d;var f=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085957)},e.category=s.msoulscat_Osf_AppManagementMenu,e.level=n.info,e}();e.AppManagementMenuLogger=f;var p=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085958)},e.category=s.msoulscat_Osf_UploadFileDevCatelog,e.level=n.info,e}();e.UploadFileDevCatelogLogger=p;var m=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17834653)},e.category=s.msoulscat_Osf_UploadFileDevCatalogUsage,e.level=n.info,e}();e.UploadFileDevCatalogUsageLogger=m;var g=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),4748055)},e.category=s.msoulscat_Osf_Latency,e.level=n.info,e}();e.LatencyLogger=g;var v=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){l.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085959)},e.category=s.msoulscat_Osf_InsertionDialogSession,e.level=n.info,e}();e.InsertionDialogSessionLogger=v;var h=function(){function e(){}return e.LogNotification=function(e,t,n){var r=new a.AppNotificationUsageData;r.CorrelationId=e,r.ErrorResult=t,r.NotificationClickInfo=n,d.Instance().LogData(r)},e}();e.AppNotificationHelper=h;var y=function(){function e(){}return e.LogAppManagementMenuAction=function(e,t,n,o,i,s){var c=new a.AppManagementMenuUsageData,u=0===e.toLowerCase().indexOf("wa")?parseInt(e.substring(2),10):parseInt(e,10);o&&(t|=r.InsertionDialogClosed),i&&(t|=r.IsAnonymous),c.AssetId=u,c.OperationMetadata=t,c.ErrorResult=s,f.Instance().LogData(c)},e}();e.AppManagementMenuHelper=y;var b=function(){function e(){}return e.LogUploadFileDevCatelogAction=function(e,t,n,r,o,i){var s=new a.UploadFileDevCatelogUsageData;s.CorrelationId=e,s.OperationMetadata=t,s.ErrorResult=i,p.Instance().LogData(s)},e}();e.UploadFileDevCatelogHelper=b;var _=function(){function e(){}return e.LogUploadFileDevCatalogUsageAction=function(e,t,n,r,o,i,s,c){var u=new a.UploadFileDevCatalogUsageUsageData;u.CorrelationId=e,u.StoreType=t,u.AppId=n,u.AppVersion=r,u.AppTargetType=o,u.IsAppCommand=i,u.AppSizeWidth=s,u.AppSizeHeight=c,m.Instance().LogData(u)},e}();e.UploadFileDevCatalogUsageHelper=_;var S=function(){var e="Stage11Time",r="Stage10Time",o="Stage9Time",i="Stage8Time",u="Stage7Time",d="Stage5Time",f="Stage4Time",p="Stage2Time",m="Stage1Time";function v(){}return v.GenerateActivationMessage=function(e,n){var r="";return e!=t&&(r+="ActivationRuntimeType: "+e.toString()+"|"),n!=t&&(r+="CorrelationId: "+n),r},v.ActivationStart=function(t,g,h,y,b,_){v.activatingNumber++,t.LoadTime=new a.AppLoadTimeUsageData,t.Timers={},t.LoadTime.CorrelationId=y,t.LoadTime.AppInfo=g,t.LoadTime.ActivationInfo=0,t.LoadTime.InstanceId=b,t.LoadTime.AssetId=h,t.LoadTime.Stage1Time=0,t.Timers[m]=new c,t.LoadTime.Stage2Time=0,t.Timers[p]=new c,t.LoadTime.Stage3Time=0,t.LoadTime.Stage4Time=0,t.Timers[f]=new c,t.LoadTime.Stage5Time=0,t.Timers[d]=new c,t.LoadTime.Stage6Time=v.activatingNumber,t.LoadTime.Stage7Time=0,t.Timers[u]=new c,t.LoadTime.Stage8Time=0,t.Timers[i]=new c,t.LoadTime.Stage9Time=0,t.Timers[o]=new c,t.LoadTime.Stage10Time=0,t.Timers[r]=new c,t.LoadTime.Stage11Time=0,t.Timers[e]=new c,t.LoadTime.ErrorResult=0,t.ActivationRuntimeType=_,v.StartStopwatch(t,m),l.SendULSTraceTag(s.msoulscat_Osf_Runtime,n.info,v.GenerateActivationMessage(_,y),19515419)},v.ActivationEnd=function(e){v.ActivateEndInternal(e)},v.PageStart=function(e){v.StartStopwatch(e,p)},v.PageLoaded=function(e){v.StopStopwatch(e,p)},v.ServerCallStart=function(e){v.StartStopwatch(e,f)},v.ServerCallEnd=function(e){v.StopStopwatch(e,f)},v.AuthenticationStart=function(e){v.StartStopwatch(e,d)},v.AuthenticationEnd=function(e){v.StopStopwatch(e,d)},v.EntitlementCheckStart=function(e){v.StartStopwatch(e,u)},v.EntitlementCheckEnd=function(e){v.StopStopwatch(e,u)},v.KilledAppsCheckStart=function(e){v.StartStopwatch(e,i)},v.KilledAppsCheckEnd=function(e){v.StopStopwatch(e,i)},v.AppStateCheckStart=function(e){v.StartStopwatch(e,o)},v.AppStateCheckEnd=function(e){v.StopStopwatch(e,o)},v.ManifestRequestStart=function(e){v.StartStopwatch(e,r)},v.ManifestRequestEnd=function(e){v.StopStopwatch(e,r)},v.OfficeJSStartToLoad=function(t){v.StartStopwatch(t,e)},v.OfficeJSLoaded=function(t){v.StopStopwatch(t,e)},v.SetAnonymousFlag=function(e,t){v.SetActivationInfoField(e,v.ConvertFlagToBit(t),2,0)},v.SetRetryCount=function(e,t){v.SetActivationInfoField(e,t,3,2)},v.SetManifestTrustCachedFlag=function(e,t){v.SetActivationInfoField(e,v.ConvertFlagToBit(t),2,5)},v.SetManifestDataCachedFlag=function(e,t){v.SetActivationInfoField(e,v.ConvertFlagToBit(t),2,7)},v.SetOmexHasEntitlementFlag=function(e,t){v.SetActivationInfoField(e,v.ConvertFlagToBit(t),2,9)},v.SetManifestDataInvalidFlag=function(e,t){v.SetActivationInfoField(e,v.ConvertFlagToBit(t),2,11)},v.SetAppStateDataCachedFlag=function(e,t){v.SetActivationInfoField(e,v.ConvertFlagToBit(t),2,13)},v.SetAppStateDataInvalidFlag=function(e,t){v.SetActivationInfoField(e,v.ConvertFlagToBit(t),2,15)},v.SetActivationRuntimeType=function(e,t){v.SetActivationInfoField(e,t,2,17)},v.SetErrorResult=function(e,t){e.LoadTime&&(e.LoadTime.ErrorResult=t,v.ActivateEndInternal(e))},v.SetBit=function(e,t,n,r){v.SetActivationInfoField(e,t,r||2,n)},v.StartStopwatch=function(e,t){e.LoadTime&&e.Timers&&e.Timers[t]&&(e.Timers[t].Start(),v.UpdateActivatingNumber(e))},v.StopStopwatch=function(e,t){e.LoadTime&&e.Timers&&e.Timers[t]&&(e.Timers[t].Stop(),v.UpdateActivatingNumber(e))},v.ConvertFlagToBit=function(e){return e?2:1},v.SetActivationInfoField=function(e,t,n,r){e.LoadTime&&(v.UpdateActivatingNumber(e),e.LoadTime.ActivationInfo=v.SetBitField(e.LoadTime.ActivationInfo,t,n,r))},v.SetBitField=function(e,t,n,r){return e&~(Math.pow(2,n)-1<<r)|t<<r},v.UpdateActivatingNumber=function(e){e.LoadTime&&(e.LoadTime.Stage6Time=e.LoadTime.Stage6Time>v.activatingNumber?e.LoadTime.Stage6Time:v.activatingNumber)},v.ActivateEndInternal=function(e){if(e.LoadTime){if(v.StopStopwatch(e,m),e.Timers)for(var r in e.Timers)e.Timers[r].ElapsedTime!=t&&(e.LoadTime[r]=e.Timers[r].ElapsedTime);l.SendULSTraceTag(s.msoulscat_Osf_Runtime,n.info,v.GenerateActivationMessage(e.ActivationRuntimeType,e.LoadTime.CorrelationId),19515420),g.Instance().LogData(e.LoadTime),e.LoadTime=t,v.activatingNumber--}},v.activatingNumber=0,v}();e.AppLoadTimeHelper=S;var C=function(){var e=" AppCorrelationId:";function r(){}return r.LogProxyFailure=function(e,o,a){var s;e==t&&(e=""),s=i.OUtil.formatString("appCorrelationId:{0}, methodName:{1}",e,o),Object.keys(a).forEach(function(e){var n=a[e];n!=t&&(n=n.toString()),s+=", "+e+":"+n}),l.SendULSTraceTag(r.category,n.warning,s,6062432)},r.LogExceptionTag=function(o,i,a,s){var c=o;i&&(i.name&&(c+=" Exception name:"+i.name+"."),i.paramName&&(c+=" Param name:"+i.paramName+"."),i.message&&(c+=" Message:"+i.message+"."),i.stack&&(c+=" [Stack:"+i.stack+"]")),a!=t&&(c+=e+a+"."),l.SendULSTraceTag(r.category,n.warning,c,s)},r.LogCommonMessageTag=function(o,i,a){i!=t&&(o+=e+i+"."),l.SendULSTraceTag(r.category,n.info,o,a)},r.category=s.msoulscat_Osf_Runtime,r}();e.RuntimeTelemetryHelper=C;var O=function(){function e(){}return e.LogInsertionDialogSession=function(e,t,n,r,i,s){var c=new a.InsertionDialogSessionUsageData,u=0===e.toLowerCase().indexOf("wa")?parseInt(e.substring(2),10):parseInt(e,10),l=o.Undefined;l|=r?o.Inserted:o.Canceled,n>0&&(l|=o.TrustPageVisited),c.AssetId=u,c.TotalSessionTime=t,c.TrustPageSessionTime=n,c.DialogState=l,c.LastActiveTab=i,c.LastActiveTabCount=s,v.Instance().LogData(c)},e}();e.InsertionDialogSessionHelper=O}(s||(s={}));var u='xmlns="urn:schemas-microsoft-com:office:office" xmlns:o="urn:schemas-microsoft-com:office:office"';i.AppVersion={access:"ZAC150",excel:"ZXL150",excelwebapp:"WAE160",outlook:"ZOL150",outlookwebapp:"MOW150",powerpoint:"ZPP151",powerpointwebapp:"WAP160",project:"ZPJ150",word:"ZWD150",wordwebapp:"WAW160",onenotewebapp:"WAO160"},i.AppSubType={Taskpane:1,Content:2,Contextual:3,Dictionary:4},i.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2};var l;i.HostSpecificFileVersionDefault="16.00",i.HostSpecificFileVersionMap={access:{web:"16.00"},agavito:{winrt:"16.00"},excel:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},onenote:{web:"16.00",win32:"16.00",winrt:"16.00"},outlook:{ios:"16.00",mac:"16.00",web:"16.01",win32:"16.02"},powerpoint:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},project:{win32:"16.00"},sway:{web:"16.00"},word:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"}},i.HostType={Excel:"Excel",Outlook:"Outlook",Access:"Access",PowerPoint:"PowerPoint",Word:"Word",Sway:"Sway",OneNote:"OneNote"},i.ManifestHostType={Workbook:"Workbook",Document:"Document",Presentation:"Presentation",Notebook:"Notebook",Mailbox:"Mailbox"},i.HostPlatform={Web:"Web"},i.getAppVerCode=function(e){var t,n="Invalid appName.";switch(e){case i.AppName.ExcelWebApp:t="excel.exe";break;case i.AppName.AccessWebApp:t="ZAC";break;case i.AppName.PowerpointWebApp:t="WAP";break;case i.AppName.WordWebApp:t="WAW";break;case i.AppName.OneNoteWebApp:t="WAO";break;default:throw o.msAjaxDebug.trace(n),n}return t},i.getModernAppVerCode=function(e){var t,n="Invalid appName.";switch(e){case i.AppName.ExcelWebApp:t="WAC_Excel";break;case i.AppName.PowerpointWebApp:t="WAC_PowerPoint";break;case i.AppName.WordWebApp:t="WAC_Word";break;case i.AppName.OneNoteWebApp:t="WAC_OneNote";break;case i.AppName.OutlookWebApp:t="WAC_Outlook";break;default:throw o.msAjaxDebug.trace(n),n}return t},i.getManifestHostType=function(e){var t;switch(e){case i.HostType.Excel:t=i.ManifestHostType.Workbook;break;case i.HostType.Word:t=i.ManifestHostType.Document;break;case i.HostType.PowerPoint:t=i.ManifestHostType.Presentation;break;case i.HostType.OneNote:t=i.ManifestHostType.Notebook;break;case i.HostType.Outlook:t=i.ManifestHostType.Mailbox;default:throw o.msAjaxDebug.trace("Invalid host type."),"Invalid hostType."}return t},i.Capability={Mailbox:"Mailbox",Document:"Document",Workbook:"Workbook",Project:"Project",Presentation:"Presentation",Database:"Database",Sway:"Sway",Notebook:"Notebook"},i.HostCapability={Excel:i.Capability.Workbook,Outlook:i.Capability.Mailbox,Access:i.Capability.Database,PowerPoint:i.Capability.Presentation,Word:i.Capability.Document,Sway:i.Capability.Sway,OneNote:i.Capability.Notebook},i.OsfControlTarget={Undefined:-1,InContent:0,TaskPane:1,Contextual:2},i.OsfControlPermission={Restricted:1,ReadDocument:2,WriteDocument:4,ReadItem:32,ReadWriteMailbox:64,ReadAllDocument:131,ReadWriteDocument:135},i.OsfControlStatus={NotActivated:1,Activated:2,AppStoreNotReachable:3,InvalidOsfControl:4,UnsupportedStore:5,UnknownStore:6,ActivationFailed:7,NotSandBoxSupported:8},i.OsfControlPageStatus={NotStarted:1,Loading:2,Ready:3,FailedHandleRequest:4,FailedOriginCheck:5,FailedPermissionCheck:6},i.StoreType={OMEX:"omex",SPCatalog:"spcatalog",SPApp:"spapp",Exchange:"exchange",FileSystem:"filesystem",Registry:"registry",InMemory:"inmemory",OneDrive:"onedrive",PrivateCatalog:"excatalog",HardCodedPreinstall:"hardcodedpreinstall",FirstParty:"firstparty",UploadFileDevCatalog:"uploadfiledevcatalog",Sdx:"sdxcatalog"},i.StoreTypeEnum={MarketPlace:0,Catalog:1,SPApp:2,Exchange:3,FileSystem:4,Registry:5,OneDrive:9,PrivateCatalog:10,HardCodedPreinstall:11,FirstParty:12,Sdx:14,UploadFileDevCatalog:15},i.ManifestIdIssuer={Microsoft:"Microsoft",Custom:"Custom"},i.OmexClientAppStatus={OK:1,UnknownAssetId:2,KilledAsset:3,NoEntitlement:4,DownloadsExceeded:5,Expired:6,Invalid:7,Revoked:8,ServerError:9,BadRequest:10,LimitedTrial:11,TrialNotSupported:12,EntitlementDeactivated:13,VersionMismatch:14,VersionNotSupported:15,UserIsMinor:16},i.OmexState={Killed:0,OK:1,Withdrawn:2,Flagged:3,DeveloperWithdrawn:4},i.OmexTrialType={None:0,Office:1,External:2},i.OmexEntitlementType={Free:"free",Trial:"trial",Paid:"paid"},i.OmexAuthNStatus={NotAttempted:-1,CheckFailed:0,Authenticated:1,Anonymous:2,Unknown:3},i.OmexRemoveAppStatus={Failed:0,Success:1},i.OfficeAppType={ContentApp:i.OsfControlTarget.InContent,TaskPaneApp:i.OsfControlTarget.TaskPane,MailApp:i.OsfControlTarget.Contextual},i.FormFactor={Default:"DefaultSettings",Desktop:"DesktopSettings",Tablet:"TabletSettings",Phone:"PhoneSettings"},i.OsfOfficeExtensionManagerPerfMarker={GetEntitlementStart:"Agave.OfficeExtensionManager.GetEntitlementStart",GetEntitlementEnd:"Agave.OfficeExtensionManager.GetEntitlementEnd"},i.OsfControlActivationPerfMarker={ActivationStart:"Agave.AgaveActivationStart",ActivationEnd:"Agave.AgaveActivationEnd",DeactivationStart:"Agave.AgaveDeactivationStart",DeactivationEnd:"Agave.AgaveDeactivationEnd",SelectionTimeout:"Agave.AgaveSelectionTimeout"},i.NotificationUxPerfMarker={RenderLoadingAnimationStart:"Agave.NotificationUx.RenderLoadingAnimationStart",RenderLoadingAnimationEnd:"Agave.NotificationUx.RenderLoadingAnimationEnd",RemoveLoadingAnimationStart:"Agave.NotificationUx.RemoveLoadingAnimationStart",RemoveLoadingAnimationEnd:"Agave.NotificationUx.RemoveLoadingAnimationEnd",RenderStage1Start:"Agave.NotificationUx.RenderStage1Start",RenderStage1End:"Agave.NotificationUx.RenderStage1End",RemoveStage1Start:"Agave.NotificationUx.RemoveStage1Start",RemoveStage1End:"Agave.NotificationUx.RemoveStage1End",RenderStage2Start:"Agave.NotificationUx.RenderStage2Start",RenderStage2End:"Agave.NotificationUx.RenderStage2End",RemoveStage2Start:"Agave.NotificationUx.RemoveStage2Start",RemoveStage2End:"Agave.NotificationUx.RemoveStage2End"},i.ProxyCallStatusCode={Succeeded:1,Failed:0,ProxyNotReady:-1},i.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2},i.SQMDataPoints={DATAID_APPSFOROFFICEUSAGE:10595,DATAID_APPSFOROFFICENOTIFICATIONS:10942},i.BWsaStreamTypes={Static:1},i.BWsaConfig={defaultMaxStreamRows:1e3},i.ErrorStatusCodes={E_OEM_EXTENSION_NOT_ENTITLED:2147758662,E_MANIFEST_SERVER_UNAVAILABLE:2147758672,E_USER_NOT_SIGNED_IN:2147758677,E_MANIFEST_DOES_NOT_EXIST:2147758673,E_OEM_EXTENSION_KILLED:2147758660,E_OEM_OMEX_EXTENSION_KILLED:2147758686,E_MANIFEST_UPDATE_AVAILABLE:2147758681,S_OEM_EXTENSION_TRIAL_MODE:275013,E_OEM_EXTENSION_WITHDRAWN_FROM_SALE:2147758690,E_TOKEN_EXPIRED:2147758675,E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED:2147757992,E_MANIFEST_REFERENCE_INVALID:2147758678,S_USER_CLICKED_BUY:274205,E_MANIFEST_INVALID_VALUE_FORMAT:2147758654,E_TRUSTCENTER_MOE_UNACTIVATED:2147757996,S_OEM_EXTENSION_FLAGGED:275040,S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE:275041,E_BROWSER_VERSION:2147758194,E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR:-2147209295,WAC_AgaveUnsupportedStoreType:1041,WAC_AgaveActivationError:1042,WAC_ActivateAttempLoading:1043,WAC_HTML5IframeSandboxNotSupport:1044,WAC_AgaveRequirementsErrorOmex:1045,WAC_AgaveRequirementsError:1046,WAC_AgaveOriginCheckError:1047,WAC_AgavePermissionCheckError:1048,WAC_AgaveHostHandleRequestError:1049,WAC_AgaveUnknownClientAppStatus:1050,WAC_AgaveAnonymousProxyCreationError:1051,WAC_AgaveOsfControlActivationError:1052,WAC_AgaveEntitlementRequestFailure:1053,WAC_AgaveManifestRequestFailure:1054,WAC_AgaveManifestAndEtokenRequestFailure:1055,WAC_FirstPartyAddInListRequestFailure:1056,WAC_SSOAddinRequireConsent:1057},i.InvokeResultCode={S_OK:0,E_REQUEST_TIME_OUT:-2147471590,E_USER_NOT_SIGNED_IN:-2147208619,E_CATALOG_ACCESS_DENIED:-2147471591,E_CATALOG_REQUEST_FAILED:-2147471589,E_OEM_NO_NETWORK_CONNECTION:-2147208640,E_PROVIDER_NOT_REGISTERED:-2147208617,E_OEM_CACHE_SHUTDOWN:-2147208637,E_OEM_REMOVED_FAILED:-2147209421,E_CATALOG_NO_APPS:-1,E_GENERIC_ERROR:-1e3,S_HIDE_PROVIDER:10},i.OmexClientNames=function(){var e={},t=i.AppName;return e[t.ExcelWebApp]="WAC_Excel",e[t.WordWebApp]="WAC_Word",e[t.OutlookWebApp]="WAC_Outlook",e[t.AccessWebApp]="WAC_Access",e[t.PowerpointWebApp]="WAC_Powerpoint",e[t.OneNoteWebApp]="WAC_OneNote",e}(),i.OmexAppVersions=function(){var e={},t=i.AppName;return e[t.ExcelWebApp]=i.AppVersion.excelwebapp,e[t.WordWebApp]=i.AppVersion.wordwebapp,e[t.OutlookWebApp]=i.AppVersion.outlookwebapp,e[t.AccessWebApp]=i.AppVersion.access,e[t.PowerpointWebApp]=i.AppVersion.powerpointwebapp,e[t.OneNoteWebApp]=i.AppVersion.onenotewebapp,e}(),i.ActivationTypes={V1Enabled:0,V1S2SEnabled:1,V2Enabled:2,V2S2SEnabled:3},i.ManifestRequestTypes={Manifest:1,Etoken:2,Both:3},function(e){var t=null,n=function(){function e(){}return e.versionLessThan=function(e,t){return i.OsfManifestManager.versionLessThan(e,t)},e.ParseManifest=function(e,n,r){try{return new i.Manifest.Manifest(e,n)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest:",e,r,20306078),t}},e}();e.ManifestUtil=n;var r=function(){function n(){}return n.failed=function(n,r,o){if(n.status!=e.DataServiceResultCode.Succeeded){var i={status:n.status,httpStatus:n.httpStatus};return o!=t&&(i.value=o),r(i),!0}return!1},n}();e.AsyncUtil=r;var o=function(){function e(){}return e.register=function(e,t){this._registry[e]=t},e.resolve=function(e,n){var r=this,o=r._resolved[e];if(o!=t)return o;if((n=n||r._hostInfo)!=t){var i=r._registry[e];if(i==t)return t;r._resolved[e]=o=i(n)}return o},e.setHostContext=function(e){this._hostInfo=e},e.getHostContext=function(){return this._hostInfo},e._registry={},e._resolved={},e}();e.CatalogFactory=o}(l||(l={})),function(e){var t=function(){function t(e){this._initParams=e}return t.prototype.getEntitlementAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed,httpStatus:403})},t.prototype.getAndCacheManifest=function(t,n,r,o){o({status:e.DataServiceResultCode.Failed,httpStatus:404})},t.prototype.activateAsync=function(t,n){var r=this;r._initParams&&r._initParams.loaderParams?r._initParams.controlStatus===i.OsfControlStatus.ActivationFailed?n.fail(r._initParams.loaderParams,r._initParams.controlStatus):n.notifyUser(r._initParams.loaderParams):n.fail(e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveActivationError_ERR,errorCode:i.ErrorStatusCodes.WAC_AgaveActivationError}),i.OsfControlStatus.ActivationFailed)},t.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed,httpStatus:403})},t.prototype.getAppDetails=function(t,n,r,o){o({status:e.DataServiceResultCode.Failed,httpStatus:403})},t}();e.ForbiddenCatalog=t}(l||(l={})),function(e){var t=function(){var e=null;function t(){}return t.defaultTitle=function(e){switch(e){case i.InfoType.Information:return Strings.OsfRuntime.L_AgaveInformationTitle_TXT;case i.InfoType.Error:return Strings.OsfRuntime.L_AgaveErrorTile_TXT;case i.InfoType.Warning:return Strings.OsfRuntime.L_AgaveWarningTitle_TXT}return Strings.OsfRuntime.L_AgaveInformationTitle_TXT},t.fillMissing=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?i.InfoType.Information:n.infoType,n.title=n.title||t.defaultTitle(n.infoType),n.buttonTxt=n.buttonTxt||Strings.OsfRuntime.L_OkButton_TXT,n.buttonCallback=n.buttonCallback||e,n.url=n.url||e,n.urlButtonTxt=n.urlButtonTxt||e,n.dismissCallback=n.dismissCallback||e,n.reDisplay=!n.dismissCallback,n.displayDeactive=n.displayDeactive==e||n.displayDeactive,n.detailView=n.detailView||!1,n.logAsError=n.logAsError||!1,n.highPriority=n.highPriority||!1,n.retryAll=n.retryAll||!1,n.errorCode=n.errorCode?n.errorCode:0,n},t.error=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?i.InfoType.Error:n.infoType,n.logAsError=n.logAsError==e||n.logAsError,t.fillMissing(n)},t.warning=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?i.InfoType.Warning:n.infoType,n.logAsError=n.logAsError==e||n.logAsError,t.fillMissing(n)},t.showNotification=function(e,n){e.notifyUser(t.fillMissing(n))},t.showError=function(e,n){e.notifyUser(t.error(n))},t.showWarning=function(e,n){e.notifyUser(t.warning(n))},t.failWithWarning=function(e,n,r){r=t.isNullOrUndefined(r)?i.OsfControlStatus.ActivationFailed:r,e.fail(t.warning(n),r)},t.failWithError=function(e,n,r){r=t.isNullOrUndefined(r)?i.OsfControlStatus.ActivationFailed:r,e.fail(t.error(n),r)},t.isNullOrUndefined=function(t){return t===e||void 0===t},t}();e.LoaderUtil=t}(l||(l={})),function(e){var t=function(){function t(e,t){this.osfControl=e,this.trusted=t}return t.prototype.getRequirementsChecker=function(){return this.osfControl._contextActivationMgr.getRequirementsChecker()},t.prototype.load=function(t,n){var r=null,o=this;o.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted&&(o.osfControl._retryActivate=r,o.osfControl._contextActivationMgr.retryAll(t.entitlement.assetId)),o.osfControl._status!==i.OsfControlStatus.NotActivated&&o.osfControl.deActivate();var a=t.manifest,s=o.osfControl;if(s._etoken=t.eToken,s._manifest=a,s._sourceLocationOverrideResourceId?s._iframeUrl=a.getSourceLocationOverrideByResourceId(s._sourceLocationOverrideResourceId):s._iframeUrl=a.getDefaultSourceLocation(s._contextActivationMgr.getFormFactor()),s.getStoreType()===i.StoreType.Sdx&&s._iframeUrl&&t.manifestUrl!==r){var c=t.manifestUrl.lastIndexOf("/");if(-1!==c){var u=t.manifestUrl.substr(0,c)+"/index.html";s.updateUrlsForSdxBundle(u)}}if(s._permission=a.getPermission(),s._appDomains=a.getAppDomains(),s.processManifestForCustomFunctions(a),n!=r&&(s._iframeUrl=n.decorateUrl(s._iframeUrl)),s._contextActivationMgr._doesUrlHaveSupportedProtocol(s._iframeUrl)){n!=r&&n.preLoad(s,s._contextActivationMgr);var l=a.getDefaultDisplayName();s._isAddinCommands(function(e){e&&(s._isvirtualOsfControl=!0,s.invokeVirtualOsfControlActivationCallback(a)),(!e||a.containsCustomFunctionsForAppHost(s._contextActivationMgr._hostType))&&s._createIframeAndActivateOsfControl(l)}),n!=r&&n.postLoad(s,s._contextActivationMgr)}else e.LoaderUtil.failWithError(o,{description:Strings.OsfRuntime.L_AgaveManifestError_ERR,detailView:!0,errorCode:i.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT})},t.prototype.skipTrust=function(){var e=this;return e.osfControl._contextActivationMgr._autoTrusted||e.osfControl.getTrustNoPrompt()||e.osfControl._isOsfControlInEmbeddingMode(e.osfControl)},t.prototype.hasConsent=function(){return this.trusted||this.isInsertion()},t.prototype.isInsertion=function(){return this.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted},t.prototype.setRetryCall=function(e){this.osfControl._retryActivate=e},t.prototype.askForTrust=function(e,t){var n=this;this.osfControl._showTrustError(e.clientName,e.displayName,e.providerName,e.iconUrl,e.entitlement.storeType,function(){n.restartActivation(),t()},e.url,e.isSSOAddin)},t.prototype.askForUpgrade=function(e,t){var n=this;e.buttonCallback=function(){n.restartActivation(),t()},this.notifyUser(e)},t.prototype.askForConsentForSideloadAddin=function(e,t){var n=this;this.osfControl._manifest=e,this.osfControl._isAddinCommands(function(e){e?n.osfControl.showConsentError(t,i.NotificationType.ConsentWhiteDialog,!0):n.osfControl.showConsentError(t,i.NotificationType.ConsentYellowBar,!0)})},t.prototype.fail=function(e,t){var n=this.osfControl;n._status=t,this.notifyUser(e),n._contextActivationMgr.raiseOsfControlStatusChange(n)},t.prototype.notifyUser=function(e){var t=this.osfControl;e.id=t._id,t._contextActivationMgr.displayNotification(e)},t.prototype.restartActivation=function(){this.osfControl._restartActivate()},t.prototype.isForCustomFunctionSandbox=function(){return this.osfControl.isCustomFunctionSandbox()},t.prototype.setIsUpgrading=function(e){this.osfControl.setIsUpgrading(e)},t}();e.OsfControlLoader=t}(l||(l={})),function(e){var t=function(){function e(e){this._requirementsChecker=e}return e.prototype.getRequirementsChecker=function(){return this._requirementsChecker},e.prototype.load=function(){},e.prototype.skipTrust=function(){return!1},e.prototype.hasConsent=function(){return!1},e.prototype.setRetryCall=function(){},e.prototype.askForTrust=function(){},e.prototype.askForUpgrade=function(){},e.prototype.askForConsentForSideloadAddin=function(){},e.prototype.fail=function(){},e.prototype.notifyUser=function(){},e.prototype.restartActivation=function(){},e.prototype.isForCustomFunctionSandbox=function(){return!1},e.prototype.setIsUpgrading=function(){},e}();e.PreCacher=t}(l||(l={})),function(e){var t=function(){var t=null;function n(){var e=this;e.isReady=!1,e.clientEndPoint=t,e.pendingCallbacks=[],e.iframe=t,e._pendingRequests={},e.conversationId=i.OUtil.generateConversationId()}return n.prototype.invokeProxyCommandAsync=function(n,r,o){var i=this,a=r||r.correlationId||"";this.prepareProxy(function(c){c.value!=t?i.invokeProxyMethodAsync(n,o,r):(s.RuntimeTelemetryHelper.LogExceptionTag("clientendpoint is invalid",t,a,18940552),o({status:e.DataServiceResultCode.ProxyNotReady}))},function(){s.RuntimeTelemetryHelper.LogExceptionTag("proxysetup failure",t,a,18940553),o({status:e.DataServiceResultCode.ProxyNotReady})})},n.prototype.prepareProxy=function(){},n.prototype.doesUrlHaveSupportedProtocol=function(e){var n=!1;e&&(n=decodeURIComponent(e).match(/^https?:\/\/.+$/gi)!=t);return n},n.prototype.invokeProxyMethodAsync=function(n,r,o){var a,c=o||o.correlationId||"",u=[this.clientEndPoint._targetUrl,n];for(var l in o)("string"===(a=typeof o[l])||"number"===a||"boolean"===a)&&u.push(o[l]);var d=u.join("."),f=this._pendingRequests,p={onCompleted:r,methodName:n,correlationId:c},m=f[d];if(m)m.push(p);else{f[d]=[p];o||(o={}),o.officeVersion=i.Constants.ThreePartsFileVersion,this.clientEndPoint.invoke(n,function(n,r){var o=t,i=0,a=e.DataServiceResultCode.Failed;0===n&&r.status&&(o=r.result,a=e.DataServiceResultCode.Succeeded);var c=f[d];delete f[d];for(var u=c.length,l=0;l<u;l++){var p=c.shift();try{r&&r.failureInfo&&(i=r.failureInfo.statusCode||t,r.failureInfo.result=r.result,s.RuntimeTelemetryHelper.LogProxyFailure(p.correlationId,p.methodName,r.failureInfo)),p.onCompleted({status:a,httpStatus:i,value:o})}catch(t){var m="invokeProxyMethodAsync failed";e.WACUtils.logExceptionToBrowserConsole(m,t),s.RuntimeTelemetryHelper.LogExceptionTag(m,t,p.correlationId,19015124)}}},o)}},n}();e.ProxyBase=t}(l||(l={})),function(e){!function(e){var t="ManifestRequest",n="KilledAppsCheck",r="AppStateCheck",o="EntitlementCheck",i="Authentication",a="ServerCall",s="Activation";e[e[s]=0]=s,e[e[a]=1]=a,e[e[i]=2]=i,e[e[o]=3]=o,e[e[r]=4]=r,e[e[n]=5]=n,e[e[t]=6]=t}(e.Activity||(e.Activity={}));var t=e.Activity;!function(e){var t="DmsRequestCachedFlag",n="ManifestRequestType",r="ActivationRuntimeType",o="AppStateDataInvalidFlag",i="AppStateDataCachedFlag",a="ManifestDataInvalidFlag",s="OmexHasEntitlementFlag",c="ManifestDataCachedFlag",u="ManifestTrustCachedFlag",l="RetryCount",d="AnonymousFlag";e[e[d]=0]=d,e[e[l]=1]=l,e[e[u]=2]=u,e[e[c]=3]=c,e[e[s]=4]=s,e[e[a]=5]=a,e[e[i]=6]=i,e[e[o]=7]=o,e[e[r]=8]=r,e[e[n]=9]=n,e[e[t]=10]=t}(e.FlagName||(e.FlagName={}));var n=e.FlagName,r=function(){function r(e,t,n,r,o){var i=this;i.correlationId=e,i.perfContext=t,i.appInfo=n,i.assetId=r,i.instanceId=o}return r.prototype.startActivity=function(o){var a=this;switch(o){case t.Activation:var c=i.ActivationTypes.V2Enabled;return 0==(15&a.appInfo)&&e.S2SOmexCatalogService._requestHandler&&(c=i.ActivationTypes.V2S2SEnabled),s.AppLoadTimeHelper.ActivationStart(a.perfContext,a.appInfo,a.assetId,a.correlationId,a.instanceId,c),void a.setBits(n.ActivationRuntimeType,c)}s.AppLoadTimeHelper.StartStopwatch(a.perfContext,r.StopWatchName[o])},r.prototype.stopActivity=function(e){s.AppLoadTimeHelper.StopStopwatch(this.perfContext,r.StopWatchName[e])},r.prototype.setFlag=function(e,t){var n=t?2:1;this.setBits(e,n)},r.prototype.setBits=function(e,t){s.AppLoadTimeHelper.SetBit(this.perfContext,t,r.FlagOffsetMap[e],2)},r.FlagOffsetMap=[0,2,5,7,9,11,13,15,17,19,21],r.StopWatchName=["Stage1Time","Stage4Time","Stage5Time","Stage7Time","Stage9Time","Stage8Time","Stage10Time"],r}();e.ActivationTelemetryContext=r;var o=function(){function e(e){this.correlationId=e}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.AddinCommandsTelemetryContext=o;var a=function(){function e(e){this.correlationId=e}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.InsertDialogTelemetryContext=a;var c=function(){function e(){}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.SimpleTelemetryContext=c}(l||(l={})),function(e){var t=null,n=function(){var n=".";function r(n,r){void 0===r&&(r=t),this._initParam=n,this._cacheManager=r||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return r.prototype.getEntitlementAsync=function(n,r,o){var a=this,s=a,c=[],u=[],l=n?a.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey():a.getUploadFileDevCatalogAddinsCacheKey(),d=a._cacheManager.GetCacheItem(l);d!=t&&(d.forEach(function(n){var r=s._cacheManager.GetCacheItem(s.getUploadFileDevCatalogManifestCacheKey(n));if(r!=t){var o=e.ManifestUtil.ParseManifest(r,s._initParam.appUILocale);if(o==t)return;var a={assetId:n,appVersion:o.getMarketplaceVersion(),storeId:"developer",storeType:i.StoreType.UploadFileDevCatalog,targetType:o.getTarget()};u.push(a),c.push(n)}}),c.length!=d.length&&(c.length>0?a._cacheManager.SetCacheItem(l,c):a._cacheManager.RemoveCacheItem(l))),o({status:e.DataServiceResultCode.Succeeded,value:u})},r.prototype.getAndCacheManifest=function(n,r,o,a){var s=i.OsfManifestManager.getCachedManifest(n.assetId,n.appVersion);if(s==t){if(s==t){var c=this._cacheManager.GetCacheItem(this.getUploadFileDevCatalogManifestCacheKey(n.assetId));c!=t&&(s=e.ManifestUtil.ParseManifest(c,this._initParam.appUILocale))!=t&&i.OsfManifestManager.cacheManifest(n.assetId,n.appVersion,s)}a({status:s!=t?e.DataServiceResultCode.Succeeded:e.DataServiceResultCode.Failed,value:s})}else a({status:e.DataServiceResultCode.Succeeded,value:s})},r.prototype.activateAsync=function(n,r,o){var a=this;this.getAndCacheManifest(n,n.storeId,o,function(s){if(s.status!=e.DataServiceResultCode.Succeeded)e.LoaderUtil.failWithError(r,{description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),a.activateAsync(n,r,o)},errorCode:i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE});else{var c=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();if(c&&c.enableSingleSignOnForAddin&&!r.isForCustomFunctionSandbox()){var u=s.value;if(u.isSSOAddin()){return void r.askForConsentForSideloadAddin(u,function(){r.load({entitlement:n,eToken:"",manifest:s.value},t)})}}r.load({entitlement:n,eToken:"",manifest:s.value},t)}})},r.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},r.prototype.getAppDetails=function(t,n,r,o){o({status:e.DataServiceResultCode.Failed})},r.prototype.validateAndCacheNewManifest=function(e,t,n,r){return!!this.validateAddinIdAndVersion(e,t)&&(this.cacheManifest(e,t,n,r),!0)},r.prototype.localCacheAddinCommands=function(e){this.cacheMyAddins(this.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey(),e)},r.prototype.validateAddinIdAndVersion=function(e,t){return r.idRegExp.test(e)&&r.versionRegExp.test(t)},r.prototype.cacheManifest=function(e,t,n,r){var o=this;i.OsfManifestManager.cacheManifest(e,t,r),o.cacheMyAddins(o.getUploadFileDevCatalogAddinsCacheKey(),e),o._cacheManager.SetCacheItem(o.getUploadFileDevCatalogManifestCacheKey(e),n)},r.prototype.cacheMyAddins=function(e,n){var r=this._cacheManager.GetCacheItem(e);r==t&&(r=[]),r.lastIndexOf(n)<0&&(r.push(n),this._cacheManager.SetCacheItem(e,r))},r.prototype.getUploadFileDevCatalogAddinsCacheKey=function(){return r.UploadFileCatalogCacheKey.myAddins+n+this._initParam.appName+n+this._initParam.userNameHashCode},r.prototype.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey=function(){return r.UploadFileCatalogCacheKey.addinCommandsMyAddins+n+this._initParam.appName+n+this._initParam.userNameHashCode},r.prototype.getUploadFileDevCatalogManifestCacheKey=function(e){return r.UploadFileCatalogCacheKey.manifest+n+this._initParam.appName+n+e},r.UploadFileCatalogCacheKeyPrefix="__OSF_UPLOADFILE.",r.UploadFileCatalogCacheKey={myAddins:r.UploadFileCatalogCacheKeyPrefix+"MyAddins",addinCommandsMyAddins:r.UploadFileCatalogCacheKeyPrefix+"AddinCommandsMyAddins",manifest:r.UploadFileCatalogCacheKeyPrefix+"Manifest"},r.idRegExp=new RegExp("[\\w-]+"),r.versionRegExp=new RegExp("(\\d{1,2}.)*\\d{1,2}"),r}();e.CatalogFactory.register(i.StoreType.UploadFileDevCatalog,function(r){return r.enableUploadFileDevCatalog?new n({appName:r.appName,appUILocale:r.appUILocale,userNameHashCode:r.userNameHashCode}):new e.ForbiddenCatalog(t)});var r=function(){var t="Should never here";function n(e,t){this._catalog=e,this._storeType=t}return n.prototype.validateAndCacheNewManifest=function(){throw t},n.prototype.getEntitlementsAsync=function(t,n,r,o){this._catalog.getEntitlementAsync(n,new e.AddinCommandsTelemetryContext(i.OUtil.Guid.generateNewGuid()),function(e){o(e.value)},!1,r)},n.prototype.getManifestAsync=function(){throw t},n.prototype.localCacheAddinCommands=function(e,t,n,r){this._storeType==i.StoreType.UploadFileDevCatalog&&this._catalog.localCacheAddinCommands(t,n,r)},n}(),o=function(){function n(){}return n.createAddinDataProvider=function(n){var o=e.CatalogFactory.resolve(n);return o==t?t:new r(o,n)},n}();e.AddinDataProviderFactory=o}(l||(l={})),function(e){!function(e){var t="Unauthenticated",n="UnknownUserType",r="ProxyNotReady",o="Succeeded";e[e[o]=1]=o,e[e.Failed=0]="Failed",e[e[r]=-1]=r,e[e[n]=2]=n,e[e[t]=3]=t}(e.DataServiceResultCode||(e.DataServiceResultCode={}));e.DataServiceResultCode}(l||(l={})),function(e){var t=function(){var t=null;function n(n,r){void 0===r&&(r=t),this._initParam=n,this._cacheManager=r||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return n.prototype.getEntitlementAsync=function(){throw new Error("in firstParty get Entitlementasync")},n.prototype.getAndCacheManifest=function(){throw new Error("in firstParty getAndCacheManifest")},n.prototype.removeAsync=function(){throw new Error("in firstParty removeAsync")},n.prototype.getAppDetails=function(){throw new Error("in firstParty getappDetails")},n.prototype.TryFallBackFirstPartyAddInList=function(n,r){s.RuntimeTelemetryHelper.LogExceptionTag("Falling back to stale 1st party add-ins list.",t,n.correlationId,34366471);var o=this._cacheManager.GetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,!1);r(o?{status:e.DataServiceResultCode.Succeeded,value:o}:{status:e.DataServiceResultCode.Failed,value:t})},n.prototype.GetFirstyPartyAddInsInfo=function(n,r,o){var i=this,a=this._cacheManager.GetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,!0,t,t,!1);if(a){var c={addInList:a,refreshRate:t};o({status:e.DataServiceResultCode.Succeeded,value:c})}else n.getFirstPartyAddInList(function(n){if(n.status==e.DataServiceResultCode.Succeeded){var a=t;try{a=e.OmexXmlProcessor.ProcessFirstPartyAddInList(n.value)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Problem parsing first party list.",e,r.correlationId,34366472),void i.TryFallBackFirstPartyAddInList(r,o)}i._cacheManager.SetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,a.addInList,a.refreshRate/e.CacheConsts.hourToDayConversionFactor),o({status:e.DataServiceResultCode.Succeeded,value:a})}else i.TryFallBackFirstPartyAddInList(r,o)})},n.prototype.TryFallBackFirstPartyManifest=function(n,r,o){s.RuntimeTelemetryHelper.LogExceptionTag("Falling back to stale manifest for: "+n,t,r.correlationId,34366473);var i=this.ReadFirstPartyManifestFromLocalStorage(r,n);o(i?{status:e.DataServiceResultCode.Succeeded,value:i}:{status:e.DataServiceResultCode.Failed,value:t})},n.prototype.ReadFirstPartyManifestFromLocalStorage=function(n,r){var o=i.OUtil.formatString(e.CacheConsts.firstPartyManifestCacheKey,r),a=this._cacheManager.GetCacheItem(o,!1);return a?e.ManifestUtil.ParseManifest(a,this._initParam.appUILocale,n.correlationId):t},n.prototype.GetFirstPartyManifest=function(t,n,r,o){var a=this,s=i.OsfManifestManager.getCachedManifest(r.assetId,"");if(s||(s=this.ReadFirstPartyManifestFromLocalStorage(n,r.assetId))&&i.OsfManifestManager.cacheManifest(r.assetId,"",s),!s||i.OsfManifestManager.versionLessThan(s.getMarketplaceVersion(),r.version)){var c=i.OUtil.formatString("{0}/{1}",this._initParam.firstPartyManifestCDNUrl,r.path);t.getFirstPartyManifest(c,function(t){if(t.status==e.DataServiceResultCode.Succeeded){var s=e.ManifestUtil.ParseManifest(t.value,a._initParam.appUILocale,n.correlationId);if(s){i.OsfManifestManager.cacheManifest(r.assetId,"",s);var c=i.OUtil.formatString(e.CacheConsts.firstPartyManifestCacheKey,r.assetId);a._cacheManager.SetCacheItem(c,t.value),o({status:e.DataServiceResultCode.Succeeded,value:s})}else a.TryFallBackFirstPartyManifest(r.assetId,n,o)}else a.TryFallBackFirstPartyManifest(r.assetId,n,o)})}else o({status:e.DataServiceResultCode.Succeeded,value:s})},n.prototype.getDataService=function(n,r){var o=this,i=o;if(o._dataService==t){var a={status:e.DataServiceResultCode.Failed,value:t},s=function(t,n){t.status==e.DataServiceResultCode.Succeeded?(i._dataService=n,a.value=n,a.status=e.DataServiceResultCode.Succeeded,r(a)):(a.httpStatus=t.httpStatus,r(a))},c=e.ProxyBasedCatalogService.getFirstPartyInstance(o._initParam);c.prepareProxy(n.correlationId,function(e){s(e,c)})}else r({status:e.DataServiceResultCode.Succeeded,value:o._dataService})},n.prototype.createActivityScope=function(t,n){var r=this;this.getDataService(t,function(o){if(!e.AsyncUtil.failed(o,n)){var i=o.value,a={cacheManager:r._cacheManager,cachePrefix:e.CacheConsts.anonymousCacheKeyPrefix,cid:i.getCID(),anonymous:!0,telemetryContext:t},s=i.createScope(a);n({status:e.DataServiceResultCode.Succeeded,value:s})}})},n.prototype.activateAsync=function(n,r,o){var a=this;o.startActivity(e.Activity.Activation),o.startActivity(e.Activity.ServerCall);var c=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),u=c&&c.enableFirstPartySDXErrorMessages;this.createActivityScope(o,function(c){if(c.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("Failed to create 1st party activity scope.",t,o.correlationId,34366474),void e.LoaderUtil.failWithError(r,{title:u?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:u?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),a.activateAsync(n,r,o)},errorCode:i.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError});var l=c.value;a.GetFirstyPartyAddInsInfo(l,o,function(c){if(c.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("Failed get list of 1st party addIns.",t,o.correlationId,34366475),void e.LoaderUtil.failWithError(r,{title:u?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:u?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),a.activateAsync(n,r,o)},errorCode:i.ErrorStatusCodes.WAC_FirstPartyAddInListRequestFailure});var d=c.value.addInList[n.assetId];if(!d)return s.RuntimeTelemetryHelper.LogExceptionTag("Could not find 1st party addin assetId in list: "+n.assetId,t,o.correlationId,34366476),void e.LoaderUtil.failWithError(r,{title:u?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:u?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),a.activateAsync(n,r,o)},errorCode:i.ErrorStatusCodes.WAC_FirstPartyAddInListRequestFailure});o.startActivity(e.Activity.ManifestRequest),a.GetFirstPartyManifest(l,o,d,function(c){if(c.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("Could not find get 1st party manifest: "+n.assetId,t,o.correlationId,34366477),void e.LoaderUtil.failWithError(r,{title:u?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:u?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),a.activateAsync(n,r,o)},errorCode:i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure});o.stopActivity(e.Activity.ManifestRequest),o.stopActivity(e.Activity.ServerCall);var l=c.value;r.load({entitlement:n,manifest:l,eToken:""},t)})})})},n}();e.FirstPartyCatalog=t,e.CatalogFactory.register(i.StoreType.FirstParty,function(n){if(n.osfOmexBaseUrl&&n.firstPartyManifestCDNUrl){var r,o=n.osfOmexBaseUrl.indexOf(i.Constants.ProtocolSeparator);r=o>=0?n.osfOmexBaseUrl.substr(o):i.Constants.ProtocolSeparator+n.osfOmexBaseUrl;var a=i.Constants.Https+r;return new t({appName:n.appName,appUILocale:n.appUILocale,AppVersion:n.appVersion,clientMode:n.clientMode,docUrl:n.docUrl,omexBaseUrl:a,omexForceAnonymous:!0,firstPartyManifestCDNUrl:n.firstPartyManifestCDNUrl})}return new e.ForbiddenCatalog({loaderParams:e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED}),controlStatus:i.OsfControlStatus.ActivationFailed})})}(l||(l={})),function(e){var t=function(){var e="OMEX_clearCacheAsync",t="OMEX_removeCacheAsync",n="OMEX_getAppStateAsync",r="OMEX_getKilledAppsAsync",o="OMEX_getManifestAndETokenAsync";function i(){}return i.CheckProxyIsReady="OMEX_isProxyReady",i.Gated_GetManifestAndEToken=o,i.Gated_GetKilledApps=r,i.Gated_GetEntitlementSummary="OMEX_getEntitlementSummaryAsync",i.Gated_GetAppState=n,i.Gated_RemoveApp="OMEX_removeAppAsync",i.Gated_RemoveCache=t,i.Gated_ClearCache=e,i.UnGated_GetAppDetails="OMEX_getAppDetailsAsync",i.UnGated_GetRecommendations="OMEX_getRecommendationsAsync",i.UnGated_ClearCache=e,i.Anonymous_GetManifestAndEToken=o,i.Anonymous_GetKilledApps=r,i.Anonymous_GetAppState=n,i.Anonymous_RemoveCache=t,i.Anonymous_ClearCache=e,i.Anonymous_GetAuthNStatus="OMEX_getAuthNStatus",i.Anonymous_GetFirstPartyAddInList="OMEX_getFirstPartyAddInListAsync",i.Anonymous_GetFirstPartyManifest="OMEX_getFirstPartyManifestAsync",i}();e.OmexProxyMethods=t;var n=function(n){var r=null;function o(e){n.call(this),this.osfOmexBaseUrl=e}return c(o,n),o.prototype.prepareProxy=function(e,t,n){var i=this;n&&(i.isReady=!1,o.resetProxy(i)),i.isReady?e({status:r,value:{clientEndpoint:i.clientEndPoint}}):i.clientEndPoint?i.pendingCallbacks.push([e,t]):i.createProxy(e,t)},o.resetProxy=function(e){Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e.conversationId)&&Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e.conversationId),e.iframe&&(i.OUtil.removeEventListener(e.iframe,"load",e.iframeOnload),e.iframe.parentNode.removeChild(e.iframe),e.iframe=r),e.clientEndPoint=r},o.prototype.createProxy=function(n,a){var c=this;try{!c.doesUrlHaveSupportedProtocol(c.proxyUrl)&&a({status:r,value:{errorMessage:"Protocal of proxyUrl is not supported."}});var u=document.createElement("iframe");u.setAttribute("id",c.proxyName),u.setAttribute("name",c.proxyName);var l=c.proxyUrl+"?"+c.conversationId;l=i.OUtil.addXdmInfoAsHash(l,c.conversationId+"|"+c.proxyName+"|"+window.location.href),l=i.OUtil.addSerializerVersionAsHash(l,i.SerializerVersion.Browser),u.setAttribute("src",l),u.setAttribute("scrolling","auto"),u.setAttribute("border","0"),u.setAttribute("width","0"),u.setAttribute("height","0"),u.setAttribute("style","position: absolute; left: -100px; top:0px;"),document.body.appendChild(u);var d=c,f=function(){if(d.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(d.conversationId,u.contentWindow,d.proxyUrl),d.clientEndPoint)d.clientEndPoint.invoke(t.CheckProxyIsReady,function(e,t){var n=d.pendingCallbacks.length;if(0!=n){var i=r;0===e&&t.status?(d.isReady=!0,i={status:r,value:{clientEndpoint:d.clientEndPoint}}):(o.resetProxy(d),i={status:r,value:{errorMessage:"isProxyReadyCallback failed, error code "+e}});for(var a=0;a<n;a++){var s=d.pendingCallbacks.shift();d.isReady?s[0](i):s[1](i)}}},{__timeout__:500});else{var e="Unexpected error, iframe loaded again after failing OMEX_isProxyReady";s.RuntimeTelemetryHelper.LogExceptionTag(e,r,r,18121820),a({status:r,value:{errorMessage:e}})}i.OUtil.set_entropy((new Date).getTime())};i.OUtil.addEventListener(u,"load",f),c.iframeOnload=f,c.pendingCallbacks.push([n,a]),c.iframe=u}catch(t){var p="Error creating client endpoint with proxyUrl = ["+c.proxyUrl+"], msg:"+e.WACUtils.serializeObjectToString(t);a({status:r,value:{errorMessage:p}})}},o}(e.ProxyBase);e.OmexProxyBase=n}(l||(l={})),function(e){var t=function(t){function n(e){var n=this;t.call(n,e),n.proxyName="__omexExtensionAnonymousProxy",n.proxyUrl=n.osfOmexBaseUrl+"/anonymousserviceextension.aspx"}return c(n,t),n.prototype.getManifestAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetManifestAndEToken,t,function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertClientAppInstallInfo(t.value)),n(t)})},n.prototype.getFirstPartyAddInListAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetFirstPartyAddInList,t,function(e){n(e)})},n.prototype.getFirstPartyManifestAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetFirstPartyManifest,t,function(e){n(e)})},n.prototype.getAppStateAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetAppState,t,function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppState(t.value)),n(t)})},n.prototype.getKilledAppAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetKilledApps,t,function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertKilledAppsInfo(t.value)),n(t)})},n.prototype.getAuthNStatusAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetAuthNStatus,t,n)},n}(e.OmexProxyBase);e.AnonymousOmexProxy=t}(l||(l={})),function(e){var t=function(t){var n=null;function r(e){var n=this;t.call(n,e),n.proxyName="__omexExtensionGatedProxy",n.proxyUrl=n.osfOmexBaseUrl+"/gatedserviceextension.aspx"}return c(r,t),r.prototype.getOmexEntitlementsAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetEntitlementSummary,t,function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertEntitlementInfo(t.value)),r(t)})},r.prototype.getManifestAndETokenAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetManifestAndEToken,t,function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertClientAppInstallInfo(t.value)),r(t)})},r.prototype.getAppStateAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetAppState,t,function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppState(t.value)),r(t)})},r.prototype.getKilledAppAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetKilledApps,t,function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertKilledAppsInfo(t.value)),r(t)})},r.prototype.removeApps=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_RemoveApp,t,function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertRemoveAppResponse(t.value)),r(t)})},r}(e.OmexProxyBase);e.GatedOmexProxy=t}(l||(l={})),function(e){var t,n="",r=null;!function(e){var t="AnonymousUser",n="AuthedUser",r="NotDetected";e[e[r]=0]=r,e[e[n]=1]=n,e[e[t]=2]=t}(t||(t={}));var o=function(){function o(n){var r=this;r.currentUserType=t.NotDetected,r.omexAuthNStatus=i.OmexAuthNStatus.NotAttempted,r.omexAuthConnectTries=1,r.initParams=n,r.gatedProxy=new e.GatedOmexProxy(n.omexBaseUrl),r.ungatedProxy=new e.UnGatedOmexProxy(n.omexBaseUrl),r.anonymousProxy=new e.AnonymousOmexProxy(n.omexBaseUrl)}return o.getInstance=function(e){return o._instance==r&&(o._instance=new o(e)),o._instance},o.getFirstPartyInstance=function(e){if(o._firstPartyInstance==r){var t=new o(e);t._isFirstParty=!0,t.omexAuthNStatus=i.OmexAuthNStatus.Anonymous,this._firstPartyInstance=t}return o._firstPartyInstance},o.prototype.prepareProxy=function(o,i){var a=this;o=o||n;this.ensureOmexProxySetUp(o,function(n){var o;n&&n.status!=r?n.status:e.DataServiceResultCode.ProxyNotReady;n&&n.value&&(a._isFirstParty?o=!0:n.value.currentUserType&&(n.value.currentUserType==t.AuthedUser?o=!1:n.value.currentUserType==t.AnonymousUser&&(o=!0))),i({status:n.status,value:{anonymous:o}})})},o.prototype.createScope=function(e){return new c(e,this)},o.prototype.getCID=function(){switch(this.currentUserType){case t.AuthedUser:return this._cid;case t.AnonymousUser:return n}throw"not initialized"},o.prototype.ensureOmexProxySetUp=function(n,o){var a=this;if(a.currentUserType==t.NotDetected||!a.anonymousProxy.isReady&&!a.gatedProxy.isReady){var c=a,u=function(){c.currentUserType=t.AuthedUser,o({status:e.DataServiceResultCode.Succeeded,value:c})},l=function(){c.omexAuthConnectTries<i.Constants.AuthenticatedConnectMaxTries?(c.omexAuthConnectTries++,c.omexAuthNStatus!==i.OmexAuthNStatus.CheckFailed?c.anonymousProxy.prepareProxy(d,p):c.gatedProxy.prepareProxy(u,l)):(s.RuntimeTelemetryHelper.LogExceptionTag("exceed maximum tries and fail",r,n,18657693),c.anonymousProxy.prepareProxy(f,p))},d=function(e){if(e&&e.value){c.anonymousProxy.getAuthNStatusAsync({correlationId:n},function(e){if(e.status===i.ProxyCallStatusCode.Succeeded){var t=e.value;t==i.OmexAuthNStatus.Authenticated?(c.omexAuthNStatus=i.OmexAuthNStatus.Authenticated,c.gatedProxy.prepareProxy(u,l)):t!=i.OmexAuthNStatus.Anonymous&&t!=i.OmexAuthNStatus.Unknown||(c.omexAuthNStatus=i.OmexAuthNStatus.Anonymous,c.anonymousProxy.prepareProxy(f,p))}else s.RuntimeTelemetryHelper.LogExceptionTag("auth check failure.",r,n,18657694),c.omexAuthNStatus=i.OmexAuthNStatus.CheckFailed,c.initParams.omexForceAnonymous?c.anonymousProxy.prepareProxy(f,p):c.gatedProxy.prepareProxy(u,l)})}else s.RuntimeTelemetryHelper.LogExceptionTag("GetAuthNStatus callback param invalid",r,n,18657695)},f=function(n){c.omexAuthNStatus==i.OmexAuthNStatus.NotAttempted?d(n):(c.currentUserType=t.AnonymousUser,o({status:e.DataServiceResultCode.Succeeded,value:c}))},p=function(){s.RuntimeTelemetryHelper.LogExceptionTag("create anonymous proxy failure",r,n,18657696),o({status:e.DataServiceResultCode.ProxyNotReady})};c.initParams.omexForceAnonymous?c.anonymousProxy.prepareProxy(f,p):c.gatedProxy.prepareProxy(u,l)}else o({status:e.DataServiceResultCode.Succeeded,value:a})},o}();e.ProxyBasedCatalogService=o;var a=function(){function e(){}return e.dummyApplicationName="unused",e}(),c=function(){var o="contentMarket",c="assetID",l="applicationName",d="errors";function f(e,t){var r=this;r._build=i.Constants.FileVersion,r._catalogService=t,r._appVersion=i.OmexAppVersions[r._catalogService.initParams.appName],r._clientName=i.OmexClientNames[r._catalogService.initParams.appName],r._clientVersion=u.getClientVersionFromWACAppVersion(r._catalogService.initParams.AppVersion),r._correlationId=e.telemetryContext.correlationId||n}return f.prototype.getFirstPartyAddInList=function(e){var t=this.buildOmexRequestParameters();t[d]={},this._catalogService.anonymousProxy.getFirstPartyAddInListAsync(t,e)},f.prototype.getFirstPartyManifest=function(e,t){var n=this.buildOmexRequestParameters();n[d]={},n.manifestUrl=e,this._catalogService.anonymousProxy.getFirstPartyManifestAsync(n,t)},f.prototype.tryFail=function(t,n,r){return t!=e.DataServiceResultCode.Succeeded&&(r({status:t}),!0)},f.prototype.isUserTypeValid=function(e){return e!==t.NotDetected||(s.RuntimeTelemetryHelper.LogExceptionTag("userType is invalid.",r,this._correlationId,18657698),!1)},f.prototype.getEntitlementAsync=function(n,r,o){var i=this,s=i,c=i.buildOmexRequestParameters();c[l]=a.dummyApplicationName,c.appVersion=i._appVersion,c.clearEntitlement=o||!1;var u=i._catalogService.currentUserType;i.isUserTypeValid(u)?u===t.AuthedUser?i._catalogService.gatedProxy.getOmexEntitlementsAsync(c,function(e){s.tryFail(e.status,e.httpStatus,r)||(s._catalogService._cid=e.value.cid,r(e))}):u===t.AnonymousUser&&r({status:e.DataServiceResultCode.Succeeded,value:{refreshRate2:0,entitlements:[]}}):r({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,entitlements:[]}})},f.prototype.getLastStoreUpdate=function(){},f.prototype.isStoreDisabled=function(t){t({status:e.DataServiceResultCode.Succeeded,value:!1})},f.prototype.getManifest=function(t,r,o){this.getETokenAndManifestInternal(t,r,i.ClientAppInfoReturnType.urlOnly,function(t){var r=t&&t.value&&t.value.manifest?t.value.manifest:n,a=t&&t.value&&t.value.status2?t.value.status2:i.OmexClientAppStatus.ServerError,s=t?t.status:e.DataServiceResultCode.Failed;o({status:s,value:{status2:a,manifest:r}})})},f.prototype.getEToken=function(e,t,n){this.getETokenAndManifestInternal(e,t,i.ClientAppInfoReturnType.etokenOnly,n)},f.prototype.getETokenAndManifest=function(e,t,n){this.getETokenAndManifestInternal(e,t,i.ClientAppInfoReturnType.both,n)},f.prototype.getAppState=function(r,i){var a=this,s=a,u=a.buildOmexRequestParameters();u[c]=r.assetId,u[o]=r.storeId,u[d]={};var l=a._catalogService.currentUserType;a.isUserTypeValid(l)?l===t.AuthedUser?a._catalogService.gatedProxy.getAppStateAsync(u,function(e){s.tryFail(e.status,e.httpStatus,i)?s.logServiceCallResponseError("appstate",e.httpStatus):i(e)}):l===t.AnonymousUser&&a._catalogService.anonymousProxy.getAppStateAsync(u,i):i({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,assetId:n,productId:n,version:n,state2:-1}})},f.prototype.getKilledApps=function(n){var o=this,i=o,a=o.buildOmexRequestParameters(),s=o._catalogService.currentUserType;o.isUserTypeValid(s)?s===t.AuthedUser?o._catalogService.gatedProxy.getKilledAppAsync(a,function(e){i.tryFail(e.status,e.httpStatus,n)?i.logServiceCallResponseError("killedapps",e.httpStatus):n(e)}):s===t.AnonymousUser&&o._catalogService.anonymousProxy.getKilledAppAsync(a,n):n({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,killedApps:r}})},f.prototype.getAppDetails=function(e,t,r){var i=this,a=this.buildOmexRequestParameters();a.assetid=n,a[c]=e.join(","),a[o]=t,this._catalogService.ungatedProxy.getAppDetailsAsync(a,function(e){i.tryFail(e.status,e.httpStatus,r)?i.logServiceCallResponseError("appdetails",e.httpStatus):r(e)})},f.prototype.removeApps=function(r,o){var i=this,a=i,s=i.buildOmexRequestParameters();s.assetid=n,s[c]=r.join(",");var u=i._catalogService.currentUserType;i.isUserTypeValid(u)?u===t.AuthedUser?i._catalogService.gatedProxy.removeApps(s,function(e){a.tryFail(e.status,e.httpStatus,o)?a.logServiceCallResponseError("removeapps",e.httpStatus):o(e)}):u===t.AnonymousUser&&o({status:e.DataServiceResultCode.Succeeded,value:{removedApps:[]}}):o({status:e.DataServiceResultCode.UnknownUserType,value:{removedApps:[]}})},f.prototype.getETokenAndManifestInternal=function(s,u,d,f){var p=this,m=p,g=p.buildOmexRequestParameters();g[l]=a.dummyApplicationName,g[c]=s.assetId,g.clientAppInfoReturnType=d;var v=p._catalogService.currentUserType;p.isUserTypeValid(v)?v===t.AuthedUser&&d!=i.ClientAppInfoReturnType.urlOnly?(g.assetContentMarket=u,g.userContentMarket=s.storeId,g.expectedVersion=s.appVersion,p._catalogService.gatedProxy.getManifestAndETokenAsync(g,function(e){m.tryFail(e.status,e.httpStatus,f)?m.logServiceCallResponseError("manifestandetoken",e.httpStatus):f(e)})):(g[o]=s.storeId,g.clientAppInfoReturnType==i.ClientAppInfoReturnType.etokenOnly?f({status:e.DataServiceResultCode.Succeeded,value:{status2:i.OmexClientAppStatus.OK,etoken:n,manifest:r}}):p._catalogService.anonymousProxy.getManifestAsync(g,function(e){m.tryFail(e.status,e.httpStatus,f)?m.logServiceCallResponseError("manifest",e.httpStatus):f(e)})):f({status:e.DataServiceResultCode.UnknownUserType,value:{etoken:n,manifest:r}})},f.prototype.buildOmexRequestParameters=function(){var e=this;return{clientName:e._clientName,clientVersion:e._clientVersion,correlationId:e._correlationId,build:e._build}},f.prototype.logServiceCallResponseError=function(e,t){var n="proxybased request "+e+" failed";t&&(n+=":"+t),s.RuntimeTelemetryHelper.LogExceptionTag(n,r,this._correlationId,18657697)},f}();e.ProxyBasedCatalogServiceScope=c;var u=function(){function e(){}return e.getClientVersionFromWACAppVersion=function(e){if(e){var t=e.split("."),n=parseInt(t[0],10),r=parseInt(t[1],10)||0;if(!(n<=15&&r<=0)){var o=i.Constants.FileVersion.split(".");return n+"."+r+"."+o[2]+"."+o[3]}}},e.getOmexEndPointPageUrl=function(e,t,n){return i.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",e,n,t)},e}();e.OmexUtils=u}(l||(l={})),function(e){var t=function(t){function n(e){var n=this;t.call(n,e),n.proxyName="__omexExtensionProxy",n.proxyUrl=n.osfOmexBaseUrl+"/ungatedserviceextension.aspx"}return c(n,t),n.prototype.getAppDetailsAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.UnGated_GetAppDetails,t,function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppDetails(t.value)),n(t)})},n}(e.OmexProxyBase);e.UnGatedOmexProxy=t}(l||(l={})),function(e){var t=!1,n=null,r=!0,o=function(){var o="cacheExpired";function a(e,t){var n=this;n._initParam=t,n._cacheManager=e.cacheManager,n._cachePrefix=e.cachePrefix,n._cid=e.cid,n._anonymous=e.anonymous,n._telemetryContext=e.telemetryContext}return a.prototype.GetCacheKeyPrefix=function(){return this._cachePrefix},a.prototype.getOmexEndPointPageUrl=function(t,n){return e.OmexUtils.getOmexEndPointPageUrl(this._initParam.omexBaseUrl,t,n)},a.prototype.getKilledApps=function(t,o,a){var s=this,c=s;s._telemetryContext.startActivity(e.Activity.KilledAppsCheck);var u=i.OUtil.formatString(e.CacheConsts.killedAppsCacheKey,s.GetCacheKeyPrefix());if(a)s._cacheManager.RemoveCacheItem(u);else{var l=s._cacheManager.GetCacheItem(u,r);if(l&&l.refreshRate2!=n)return s._telemetryContext.stopActivity(e.Activity.KilledAppsCheck),void o({status:e.DataServiceResultCode.Succeeded,value:l})}t.getKilledApps(function(t){t.status==e.DataServiceResultCode.Succeeded?(c._telemetryContext.stopActivity(e.Activity.KilledAppsCheck),l=t.value,c._cacheManager.SetCacheItem(u,l,l.refreshRate/e.CacheConsts.hourToDayConversionFactor),o(t)):o(t)})},a.prototype.getAppState=function(a,s,c,u){var l=this,d=l;l._telemetryContext.startActivity(e.Activity.AppStateCheck);var f,p=i.OUtil.formatString(e.CacheConsts.appStateCacheKey,l.GetCacheKeyPrefix(),s.storeId,s.assetId);if(u)l._cacheManager.RemoveCacheItem(p);else{var m={};if(f=l._cacheManager.GetCacheItem(p,r,m),l._telemetryContext.setFlag(e.FlagName.AppStateDataInvalidFlag,m[o]||t),f&&f.state2!=n)return l._telemetryContext.stopActivity(e.Activity.AppStateCheck),l._telemetryContext.setFlag(e.FlagName.AppStateDataCachedFlag,r),void c({status:e.DataServiceResultCode.Succeeded,value:f})}a.getAppState(s,function(n){n.status==e.DataServiceResultCode.Succeeded?(d._telemetryContext.stopActivity(e.Activity.AppStateCheck),d._telemetryContext.setFlag(e.FlagName.AppStateDataCachedFlag,t),f=n.value,d._cacheManager.SetCacheItem(p,f,f.refreshRate2/e.CacheConsts.hourToDayConversionFactor),c(n)):c(n)})},a.prototype.getManifest=function(a,s,c,u,l){var d=this,f=d;d._telemetryContext.startActivity(e.Activity.ManifestRequest);var p,m=i.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,s.assetId,s.storeId);if(l)d._cacheManager.RemoveCacheItem(m);else{var g={};if(p=d._cacheManager.GetCacheItem(m,r,g),d._telemetryContext.setFlag(e.FlagName.ManifestDataInvalidFlag,g[o]||t),p&&p.status2!=n)return d._telemetryContext.stopActivity(e.Activity.ManifestRequest),d._telemetryContext.stopActivity(e.Activity.ServerCall),d._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,r),void u({status:e.DataServiceResultCode.Succeeded,value:{status2:p.status2,manifest:p.manifest}})}a.getManifest(s,c,function(n){n.status==e.DataServiceResultCode.Succeeded&&n.value.status2==i.OmexClientAppStatus.OK?(f._telemetryContext.stopActivity(e.Activity.ManifestRequest),f._telemetryContext.stopActivity(e.Activity.ServerCall),f._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,t),f._telemetryContext.setBits(e.FlagName.ManifestRequestType,i.ManifestRequestTypes.Manifest),p={etoken:"",status2:n.value.status2,manifest:n.value.manifest},f._cacheManager.SetCacheItem(m,p,e.CacheConsts.manifestRefreshRate),u(n)):u(n)})},a.prototype.removeApps=function(n,o,a){var s=this;n.removeApps(o,function(n){if(n.status==e.DataServiceResultCode.Succeeded){for(var o=".*",c=t,u=[],l=n.value.removedApps,d=0;d<l.length;++d)l[d].result2==i.OmexRemoveAppStatus.Success&&(u.push(new RegExp(i.OUtil.formatString(e.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,o,l[d].assetId,o,o),"i")),c=r);c&&s._cacheManager.RemoveMatches(u),a(n)}else a(n)})},a.prototype.getCachedETokenAndManifest=function(i){var a={},s=this._cacheManager.GetCacheItem(i,r,a);if(this._telemetryContext.setFlag(e.FlagName.ManifestDataInvalidFlag,a[o]||t),s){if(s.status2&&s.tokenExpirationDate2&&s.tokenExpirationDate2>(new Date).getTime())return s;s.etoken=n,s.tokenExpirationDate2=n,s.entitlementType=n}return s},a.prototype.getETokenAndManifest=function(o,a,s,c,u){var l=this,d=l;if(l._anonymous)l.getManifest(o,a,s,function(t){e.AsyncUtil.failed(t,c)||c({status:t.status,value:{etoken:"",status2:t.value.status2,manifest:t.value.manifest}})},u);else{l._telemetryContext.startActivity(e.Activity.ManifestRequest);var f,p=function(t,n){d._telemetryContext.stopActivity(e.Activity.ManifestRequest),d._telemetryContext.stopActivity(e.Activity.ServerCall),d._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,t),n&&d._telemetryContext.setBits(e.FlagName.ManifestRequestType,n)},m=i.OUtil.formatString(e.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,l._cid,a.assetId,a.storeId,s);if(u)l._cacheManager.RemoveCacheItem(m);else{if((f=l.getCachedETokenAndManifest(m))&&f.etoken&&f.manifest)return p(r),void c({status:e.DataServiceResultCode.Succeeded,value:f});var g=f?f.manifest:n;if(g==n||""==g){var v=i.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,a.assetId,a.storeId),h=l._cacheManager.GetCacheItem(v,r);h&&(g=h.manifest)}if(g)return void(f&&f.etoken?(p(r),f.manifest=g,c({status:e.DataServiceResultCode.Succeeded,value:f})):o.getEToken(a,s,function(n){n.status===e.DataServiceResultCode.Succeeded&&n.value&&(p(t,i.ManifestRequestTypes.Etoken),(f=n.value).status2===i.OmexClientAppStatus.OK&&(d._cacheManager.SetCacheItem(m,f,e.CacheConsts.manifestRefreshRate),f.manifest=g)),c(n)}))}o.getETokenAndManifest(a,s,function(n){n.status==e.DataServiceResultCode.Succeeded?(p(t,i.ManifestRequestTypes.Both),n.value.status2===i.OmexClientAppStatus.OK&&d._cacheManager.SetCacheItem(m,n.value,e.CacheConsts.manifestRefreshRate),c(n)):c(n)})}},a.prototype.getEntitlements=function(t,r,o,i){var a=this,s=a;a._telemetryContext.startActivity(e.Activity.EntitlementCheck);var c,u,l=function(){u!=n&&c!=n&&(c=c.filter(function(e){return u.every(function(t){return t.assetId!=e.assetId})}),o({status:e.DataServiceResultCode.Succeeded,value:{entitlements:c,killed:u}}))};a._anonymous?(c=[],a._telemetryContext.stopActivity(e.Activity.EntitlementCheck),l()):t.getEntitlementAsync(r,function(t){s._telemetryContext.stopActivity(e.Activity.EntitlementCheck),o!=n&&(e.AsyncUtil.failed(t,o)?o=n:(s._cid||(s._cid=t.value.cid),c=t.value.entitlements,l()))},i),a.getKilledApps(t,function(t){o!=n&&(u=t.status==e.DataServiceResultCode.Succeeded?t.value.killedApps:[],l())})},a.prototype.activate=function(o,a,c){var u,l,d=this,f={assetId:a.assetId,appVersion:a.appVersion,storeId:a.storeId,storeType:a.storeType,targetType:a.targetType},p=t,m=this.getOmexEndPointPageUrl(f.assetId,f.storeId),g=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),v=function(l,p){switch(l.status2){case i.OmexClientAppStatus.OK:if(l.tokenExpirationDate2&&l.tokenExpirationDate2<=(new Date).getTime())return void e.LoaderUtil.failWithWarning(c,e.LoaderUtil.warning({description:Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){return h()},errorCode:i.ErrorStatusCodes.E_TOKEN_EXPIRED}));var v=e.ManifestUtil.ParseManifest(l.manifest,d._initParam.appUILocale,d._telemetryContext.correlationId);if(v==n)return void e.LoaderUtil.failWithError(c,{infoType:i.InfoType.Error,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),h()},description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,errorCode:i.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT});var b=v.getMarketplaceVersion();if(i.OsfManifestManager.cacheManifest(f.assetId,a.appVersion,v),v.requirementsSupported===t||void 0===v.requirementsSupported&&!c.getRequirementsChecker().isManifestSupported(v)){v.requirementsSupported=t;var S;return S=Strings.OsfRuntime.L_AgaveManifestRequirementsErrorOmex_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,void e.LoaderUtil.failWithError(c,{description:S,url:m,detailView:r,errorCode:i.ErrorStatusCodes.WAC_AgaveRequirementsErrorOmex})}v.requirementsSupported=r,d._telemetryContext.setFlag(e.FlagName.ManifestTrustCachedFlag,!p);var C=i.OUtil.formatString(i.Constants.ActivatedCacheKey,a.assetId.toLowerCase(),a.storeType,a.storeId);if(p&&!c.skipTrust(a)){var O=i.OmexClientNames[d._initParam.appName];if(!(d._anonymous&&d._cacheManager.GetCacheItem(C,t))&&!c.hasConsent(a)&&!c.isForCustomFunctionSandbox())return void c.askForTrust({anonymous:t,clientName:O,entitlement:f,displayName:v.getDefaultDisplayName(),providerName:v.getProviderName(),iconUrl:v.getDefaultIconUrl(),url:m,isSSOAddin:v.isSSOAddin()},function(){d.restartActivationTelemetry(),d._cacheManager.SetCacheItem(C,r),d._anonymous?c.load({entitlement:f,manifest:v,eToken:l.etoken},n):d.getETokenAndManifest(o,f,f.storeId,function(t){t.status==e.DataServiceResultCode.Succeeded&&t.value.status2==i.OmexClientAppStatus.OK?(t.value.version!=n&&e.ManifestUtil.versionLessThan(f.appVersion,t.value.version)&&(f.appVersion=t.value.version),_(r)):e.LoaderUtil.failWithError(c,{infoType:i.InfoType.Error,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),h()},description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,errorCode:i.ErrorStatusCodes.WAC_AgaveManifestAndEtokenRequestFailure})})})}c.hasConsent(a)&&d._cacheManager.SetCacheItem(C,r);var I=u.version;e.ManifestUtil.versionLessThan(I,a.appVersion)&&(I=a.appVersion),e.ManifestUtil.versionLessThan(b,I)?(f.appVersion=I,e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),c.setIsUpgrading(r),h(r),y()},url:m,highPriority:r,displayDeactive:t,errorCode:i.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE})):u.state2===i.OmexState.DeveloperWithdrawn?e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveRetiring_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,url:m,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE}):u.state2===i.OmexState.Flagged?e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveSoftKilled_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,url:m,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_OEM_EXTENSION_FLAGGED}):!d._anonymous&&l.entitlementType&&l.entitlementType.toLowerCase()===i.OmexEntitlementType.Trial&&(e.LoaderUtil.showNotification(c,{description:Strings.OsfRuntime.L_AgaveTrial_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:function(){return window.open(m)},reDisplay:r,highPriority:r,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_OEM_EXTENSION_TRIAL_MODE}),e.LoaderUtil.showNotification(c,{description:Strings.OsfRuntime.L_AgaveTrialRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),h(r)},detailView:r,reDisplay:r,highPriority:r,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_USER_CLICKED_BUY})),c.load({entitlement:f,manifest:v,eToken:l.etoken},n);break;case i.OmexClientAppStatus.KilledAsset:e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED});break;case i.OmexClientAppStatus.NoEntitlement:case i.OmexClientAppStatus.TrialNotSupported:case i.OmexClientAppStatus.LimitedTrial:case i.OmexClientAppStatus.EntitlementDeactivated:if(d._anonymous){e.LoaderUtil.failWithError(c,{title:Strings.OsfRuntime.L_AgaveSigninRequiredTitle_TXT,description:Strings.OsfRuntime.L_AgaveNotViewableAnonymous_ERR,buttonTxt:Strings.OsfRuntime.L_SignInButton_TXT,buttonCallback:function(){var e=window.location.href,t=d._initParam.omexBaseUrl+i.Constants.SignInRedirectUrl+encodeURIComponent(e);window.open(t)},errorCode:i.ErrorStatusCodes.E_USER_NOT_SIGNED_IN})}else{c.setRetryCall(function(){d.restartActivationTelemetry(),h(r)}),e.LoaderUtil.failWithWarning(c,{description:Strings.OsfRuntime.L_AgaveLicenseNotAquired_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:function(){window.open(m),e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveLicenseNotAquiredRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),h(r)},detailView:r,retryAll:r,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})},errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})}break;case i.OmexClientAppStatus.UnknownAssetId:e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,errorCode:i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST});break;case i.OmexClientAppStatus.Expired:case i.OmexClientAppStatus.Invalid:e.LoaderUtil.failWithWarning(c,{description:Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),h()},errorCode:i.ErrorStatusCodes.E_TOKEN_EXPIRED});break;case i.OmexClientAppStatus.Revoked:e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveRetired_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE});break;case i.OmexClientAppStatus.VersionMismatch:f.appVersion=l.version,c.askForUpgrade(e.LoaderUtil.warning({description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,url:m,highPriority:r,logAsError:r,errorCode:i.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE}),function(){d.restartActivationTelemetry(),c.setIsUpgrading(r),h(r)});break;case i.OmexClientAppStatus.VersionNotSupported:e.LoaderUtil.failWithWarning(c,{description:Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,errorCode:i.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType},i.OsfControlStatus.UnsupportedStore);break;case i.OmexClientAppStatus.UserIsMinor:g&&g.enableDisplayBlockedMinorError&&e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR});break;default:s.RuntimeTelemetryHelper.LogExceptionTag("unknown clientAppStatus in manifestAndEtoken: "+l.status2,n,d._telemetryContext.correlationId,20030238),e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),h(r)},errorCode:i.ErrorStatusCodes.WAC_AgaveUnknownClientAppStatus})}},h=function(a){var s=l?l.contentMarket:f.storeId,m=function(n,o){return n.status!=e.DataServiceResultCode.Succeeded?g&&g.enableDisplayBlockedMinorError&&451===n.httpStatus?(e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR}),r):(e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),h(a)},errorCode:o}),r):t};c.skipTrust(f)?d.getManifest(o,f,s,function(e){if(!m(e,i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure))return a?(u=n,void S(r)):void v({etoken:"",status2:e.value.status2,manifest:e.value.manifest})},a):d.getETokenAndManifest(o,f,s,function(e){if(!m(e,i.ErrorStatusCodes.WAC_AgaveManifestAndEtokenRequestFailure))return a?(u=n,p=t,_(r),void S(r)):void v(e.value)},a)},y=function(){var t=i.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,f.assetId,f.storeId);d._cacheManager.RemoveCacheItem(t)},b=function(){if(u!=n&&p){if(l!=n)return f.appVersion=l.version,void h();var t,s,g;if(u.state2===i.OmexState.Flagged?t=r:u.state2===i.OmexState.DeveloperWithdrawn?s=r:u.state2===i.OmexState.Withdrawn&&(g=r),!(t||s||g)||(e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveRetired_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE}),!t))if(c.hasConsent(a))h();else{var y=l?l.contentMarket:f.storeId;d.getManifest(o,f,y,function(t){t.status==e.DataServiceResultCode.Succeeded?v({etoken:"",status2:t.value.status2,manifest:t.value.manifest},r):e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),b()},errorCode:i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure})})}}},_=function(a){l=n,p=t,d.getEntitlements(o,t,function(o){if(o.status!=e.DataServiceResultCode.Succeeded)return g&&g.enableDisplayBlockedMinorError&&451===o.httpStatus?void e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR}):void e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),_()},errorCode:i.ErrorStatusCodes.WAC_AgaveEntitlementRequestFailure});o.value.killed.some(function(e){return e.assetId==f.assetId})?e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED}):(o.value.entitlements.some(function(e){return e.assetId.toLowerCase()==f.assetId.toLowerCase()?(l=e,m=d.getOmexEndPointPageUrl(e.assetId,e.contentMarket),r):t}),d._telemetryContext.setFlag(e.FlagName.OmexHasEntitlementFlag,l!=n),p=r,b())},a)},S=function(t){u=n,d.getAppState(o,f,function(t){if(t.status!=e.DataServiceResultCode.Succeeded)return u={state2:i.OmexState.OK,productId:n,assetId:f.assetId,version:f.appVersion,refreshRate2:0},void b();t.value.state2!==i.OmexState.Killed?(u=t.value,b()):e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED})},t)};S(),_()},a.prototype.restartActivationTelemetry=function(){var t=this;t._telemetryContext.startActivity(e.Activity.Activation),t._telemetryContext.startActivity(e.Activity.ServerCall),t._telemetryContext.setFlag(e.FlagName.AnonymousFlag,t._anonymous)},a}(),a=function(){function a(t,o){void 0===o&&(o=n),this._anonymous=r,this._initParam=t,this._cacheManager=o||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return a.prototype.GetCacheKeyPrefix=function(){return this._anonymous?e.CacheConsts.anonymousCacheKeyPrefix:e.WACUtils.CacheConstants.GatedCacheKeyPrefix},a.prototype.getOmexEndPointPageUrl=function(e,t){return i.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._initParam.omexBaseUrl,t,e)},a.prototype.getDataService=function(t,r){var o=this,a=o;if(o._dataService==n)if(o._dataServiceReady==n){o._dataServiceReady=r;var s={status:e.DataServiceResultCode.Failed,value:n},c=function(t,r){var o=a._dataServiceReady;a._dataServiceReady=n,t.status==e.DataServiceResultCode.Succeeded?(a._anonymous=t.value.anonymous,a._dataService=r,s.value=r,s.status=e.DataServiceResultCode.Succeeded,o(s)):(s.httpStatus=t.httpStatus,o(s))};t.startActivity(e.Activity.Authentication);var u=new e.S2SOmexCatalogService(o._initParam);u.initialize(t.correlationId,function(n){if(n.status==e.DataServiceResultCode.Succeeded){var r=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();if(!r||!r.enableAnonymousUseLegacyCatalogService||!n.value.anonymous)return t.stopActivity(e.Activity.Authentication),void c(n,u)}t.setBits(e.FlagName.ActivationRuntimeType,i.ActivationTypes.V2Enabled);var o=e.ProxyBasedCatalogService.getInstance(a._initParam);o.prepareProxy(t.correlationId,function(n){t.stopActivity(e.Activity.Authentication),t.setBits(e.FlagName.RetryCount,o.omexAuthConnectTries),c(n,o)})})}else{t.startActivity(e.Activity.Authentication);var l=o._dataServiceReady;o._dataServiceReady=function(n){t.stopActivity(e.Activity.Authentication),l(n),r(n)}}else r({status:e.DataServiceResultCode.Succeeded,value:o._dataService})},a.prototype.createActivityScope=function(t,r){var i=this;this.getDataService(t,function(a){if(e.AsyncUtil.failed(a,r))s.RuntimeTelemetryHelper.LogExceptionTag("failed to get data service.",n,t.correlationId,18657692);else{t.setFlag(e.FlagName.AnonymousFlag,i._anonymous);var c=a.value,u={cacheManager:i._cacheManager,cachePrefix:i.GetCacheKeyPrefix(),cid:c.getCID(),anonymous:i._anonymous,telemetryContext:t},l=c.createScope(u),d=new o(u,i._initParam);r({status:e.DataServiceResultCode.Succeeded,value:{serviceScope:l,activityScope:d}})}})},a.prototype.getEntitlementAsync=function(t,n,r,o,a){var s=this;this.createActivityScope(n,function(n){e.AsyncUtil.failed(n,r,[])||(s._anonymous?r({status:e.DataServiceResultCode.Failed,httpStatus:403}):n.value.serviceScope.getEntitlementAsync(t,function(t){if(!e.AsyncUtil.failed(t,r,[])){for(var n=t.value.entitlements,o=0;o<n.length;o++){var a=n[o],s=a;s.appVersion=a.version,s.storeId=a.contentMarket,s.storeType=i.StoreType.OMEX,s.targetType=i.OUtil.getTargetType(a.appSubType)}r({status:t.status,value:n})}},o,a))})},a.prototype.getAndCacheManifest=function(r,o,a,s,c){var u=this;c=c||t;var l=i.OsfManifestManager.getCachedManifest(r.assetId,r.appVersion);c||l==n?this.createActivityScope(a,function(t){if(!e.AsyncUtil.failed(t,s)){var l=t.value.serviceScope;t.value.activityScope.getManifest(l,r,o,function(t){if(!e.AsyncUtil.failed(t,s))if(t.value.status2==i.OmexClientAppStatus.OK){var o=e.ManifestUtil.ParseManifest(t.value.manifest,u._initParam.appUILocale,a.correlationId);o!=n?(i.OsfManifestManager.cacheManifest(r.assetId,r.appVersion,o),s({status:e.DataServiceResultCode.Succeeded,value:o})):s({status:e.DataServiceResultCode.Failed,value:o})}else s({status:e.DataServiceResultCode.Failed})},c)}}):s({status:e.DataServiceResultCode.Succeeded,value:l})},a.prototype.activateAsync=function(t,n,o){var a=this;o.startActivity(e.Activity.Activation),o.startActivity(e.Activity.ServerCall),this.createActivityScope(o,function(s){a.isStoreDisabled(o,function(c){if(c.value===r)e.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_OmexStoreDisabledByAdmin,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED});else if(s.status!=e.DataServiceResultCode.Succeeded)return void e.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),a.activateAsync(t,n,o)},errorCode:i.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError})});var c=s.value.serviceScope;s.value.activityScope.activate(c,t,n)})},a.prototype.removeAsync=function(t,n,r){this.createActivityScope(n,function(n){if(!e.AsyncUtil.failed(n,r)){var o=n.value.serviceScope;n.value.activityScope.removeApps(o,t,r)}})},a.prototype.getAppDetails=function(t,o,a,s,c){var u=this,l=u,d=[];if(c)u._cacheManager.RemoveAll(e.CacheConsts.ungatedCacheKeyPrefix);else{for(var f=t,p=[],m=0;m<f.length;++m){var g=i.OUtil.formatString(e.CacheConsts.appDetailKey,f[m]),v=u._cacheManager.GetCacheItem(g,r);v&&v.state2!=n?d.push(v):p.push(f[m])}if(0===p.length)return void s({status:e.DataServiceResultCode.Succeeded,value:d});t=p}u.createActivityScope(a,function(n){e.AsyncUtil.failed(n,s,d)||n.value.serviceScope.getAppDetails(t,o,function(t){if(!e.AsyncUtil.failed(t,s,d)){for(var n=t.value,r=0;r<n.length;++r){var o=n[r],a=i.OUtil.formatString(e.CacheConsts.appDetailKey,o.assetId);l._cacheManager.SetCacheItem(a,o),d.push(o)}t.value=d,s(t)}})})},a.prototype.isStoreDisabled=function(n,r){this.createActivityScope(n,function(n){e.AsyncUtil.failed(n,r,t)||n.value.serviceScope.isStoreDisabled(r)})},a}();e.OmexCatalog=a,e.CatalogFactory.register(i.StoreType.OMEX,function(t){if(t.allowExternalMarketplace&&t.osfOmexBaseUrl){var n,o=t.osfOmexBaseUrl.indexOf(i.Constants.ProtocolSeparator);n=o>=0?t.osfOmexBaseUrl.substr(o):i.Constants.ProtocolSeparator+t.osfOmexBaseUrl;var s=i.Constants.Https+n;return i.OUtil.getQueryStringParamValue(window.location.search,i.Constants.OmexForceAnonymousParamName).toLowerCase()==i.Constants.OmexForceAnonymousParamValue.toLowerCase()&&(t.omexForceAnonymous=r),new a({appName:t.appName,appUILocale:t.appUILocale,AppVersion:t.appVersion,clientMode:t.clientMode,docUrl:t.docUrl,omexBaseUrl:s,omexForceAnonymous:t.omexForceAnonymous})}return new e.ForbiddenCatalog({loaderParams:e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED}),controlStatus:i.OsfControlStatus.ActivationFailed})})}(l||(l={})),function(e){var t=function(){function e(){}return e.anonymousCacheKeyPrefix="__OSF_ANONYMOUS_OMEX.",e.ungatedCacheKeyPrefix="__OSF_OMEX.",e.manifestRefreshRate=1825,e.hourToDayConversionFactor=24,e.anonymousAppInstallInfoCacheKey=e.anonymousCacheKeyPrefix+"appInstallInfo.{0}.{1}",e.firstPartyAddinListCacheKey=e.anonymousCacheKeyPrefix+"firstPartyAddInList",e.firstPartyManifestCacheKey=e.anonymousCacheKeyPrefix+"firstPartyManifest.{0}",e.killedAppsCacheKey="{0}killedApps",e.appStateCacheKey="{0}appState.{1}.{2}",e.appDetailKey="__OSF_OMEX.appDetails.{0}",e}();e.CacheConsts=t}(l||(l={})),function(e){var t=null,n=function(){function n(e,t,n){var r=this;r._handler=e,r._initParam=t,r._cacheManager=n.cacheManager,r._cachePrefix=n.cachePrefix,r._cid=n.cid,r._correlationId=n.telemetryContext.correlationId}return n.prototype.tryFail=function(t,n){return 200!=t&&(n({httpStatus:t,status:e.DataServiceResultCode.Failed}),!0)},n.prototype.getLastStoreUpdate=function(t){var n=this,r=n,o=n._initParam.appUILocale;n._handler.getLastStoreUpdate(o,n._correlationId,function(n,o){r.tryFail(n,t)?r.logServiceCallResponseError("laststoreupdate",n):t({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessLastStoreUpdate(o)})})},n.prototype.getEntitlementAsync=function(n,r,o,a){var s=this,c=s,u=i.OmexAppVersions[s._initParam.appName],l=i.OUtil.formatString(s._cachePrefix+e.WACUtils.CacheConstants.EntitlementsKey,u,s._cid);if(o)s._cacheManager.RemoveCacheItem(l);else{var d=s._cacheManager.GetCacheItem(l,!0,t,a);if(d!=t)return void r({status:e.DataServiceResultCode.Succeeded,value:d})}s._handler.getEntitlement(n,u,s._correlationId,function(t,n){if(c.tryFail(t,r))c.logServiceCallResponseError("entitlement",t);else{var o=e.OmexXmlProcessor.ProcessEntitlement(n);o.cid=c._cid,c._cacheManager.SetCacheItem(l,o,o.refreshRate2/e.CacheConsts.hourToDayConversionFactor),r({status:e.DataServiceResultCode.Succeeded,value:o})}})},n.prototype.getEToken=function(t,n,r){var o=this,a=n,s=t.storeId,c=t.assetId,u=t.appVersion;this._handler.getEToken(s,a,c,u,this._correlationId,function(t,n){o.tryFail(t,r)?o.logServiceCallResponseError("etoken",t):r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessClientAppInstallInfo(n,i.ClientAppInfoReturnType.etokenOnly)})})},n.prototype.getETokenAndManifest=function(t,n,r){var o=this;this.getEToken(t,n,function(i){i.status==e.DataServiceResultCode.Succeeded?o.getManifest(t,n,function(t){if(t.status!=e.DataServiceResultCode.Succeeded)return i.status=t.status,i.httpStatus=t.httpStatus,void r(i);i.value.manifest=t.value.manifest,r(i)}):r(i)})},n.prototype.getManifest=function(t,n,r){var o=n;this._handler.getManifest(o,t.assetId,this._correlationId,function(t,n){r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ConvertAnonymousManifest(t,n)})})},n.prototype.getAppState=function(t,n){var r=this,o=t.storeId+":"+t.assetId;this._handler.getAppState(o,this._correlationId,function(t,o){r.tryFail(t,n)?r.logServiceCallResponseError("appstate",t):n({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessAppState(o)})})},n.prototype.getKilledApps=function(t){var n=this;this._handler.getKilledApps(this._correlationId,function(r,o){n.tryFail(r,t)?n.logServiceCallResponseError("killedapps",r):t({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessKilledApps(o)})})},n.prototype.getAppDetails=function(t,n,r){var o=this;this._handler.getAppDetails(n,t.join(","),this._correlationId,function(t,n){o.tryFail(t,r)?o.logServiceCallResponseError("appdetails",t):r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessAppDetails(n)})})},n.prototype.removeApps=function(t,n){var r=this;this._handler.removeApps(t.join(","),this._correlationId,function(t,o){if(r.tryFail(t,n))r.logServiceCallResponseError("removeapps",t);else{var a=e.OmexXmlProcessor.ProcessRemoveAppResponse(o);a.removedApps.some(function(e){return e.result2==i.OmexRemoveAppStatus.Success})&&r.clearEntitlementCache(),n({status:e.DataServiceResultCode.Succeeded,value:a})}})},n.prototype.clearEntitlementCache=function(){var t=new RegExp(i.OUtil.formatString(e.WACUtils.CacheConstants.EntitlementsKey,".*",".*"),"i");this._cacheManager.RemoveMatches([t])},n.prototype.isStoreDisabled=function(t){var n=this;this._handler.isStoreDisabled(this._correlationId,function(r){if(200!=r&&403!=r&&401!=r)return n.logServiceCallResponseError("isStoreDisabled",r),void t({status:e.DataServiceResultCode.Failed,value:!1});t({status:e.DataServiceResultCode.Succeeded,value:401==r})})},n.prototype.logServiceCallResponseError=function(e,n){var r="s2s request "+e+" failed";n&&(r+=":"+n),s.RuntimeTelemetryHelper.LogExceptionTag(r,t,this._correlationId,18657699)},n}();e.OmexCatalogServiceS2SScope=n;var r=function(){function r(e){this._cid="",this._initParam=e}return r.initRequestHandler=function(e){r._requestHandler==t&&(r._requestHandler=e)},r.prototype.getCID=function(){return this._cid},r.prototype.initialize=function(n,o){var i=this;r._requestHandler!=t?this._initParam.omexForceAnonymous?o({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!0}}):r._requestHandler.getUserId(n,function(r,a){200==r?(i._cid=a.trim(),o({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!1}})):403==r?o({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!0}}):(s.RuntimeTelemetryHelper.LogExceptionTag("s2s getuserId request failed "+r,t,n,18657728),o({status:e.DataServiceResultCode.Failed,httpStatus:r}))}):o({status:e.DataServiceResultCode.Failed,httpStatus:404})},r.prototype.createScope=function(e){return new n(r._requestHandler,this._initParam,e)},r}();e.S2SOmexCatalogService=r}(l||(l={})),function(e){var t=function(){var e="description",t="provider",n="o:assets",r="contentMarket",o="appSubType",a="expirationDate",s="state",c="version",l="productId",d="assetId",f="o:asset",p="o:results",m="refreshRate",g=null;function v(){}return v.ProcessLastStoreUpdate=function(e){var t=new i.XmlProcessor(e,u).getDocumentElement().selectSingleNode("o:update");return t.firstChild!=g?Date.parse(t.firstChild.nodeValue):g},v.ProcessAppState=function(e){var t={},n=new i.XmlProcessor(e,u),r=n.getDocumentElement();n.readAttributes(r,{rr:m},t);var o=n.selectSingleNode(p),g=n.selectSingleNode("o:lang",o),h=n.selectSingleNode(f,g);return n.readAttributes(h,{assetid:d,prodid:l,ver:c,state:s,tdurl:"takeDownUrl",upv:"unsafePreviousVersion",expiry:a},t),v.ConvertAppState(t)},v.ProcessFirstPartyAddInList=function(e){var t={addInList:{},refreshRate:g},n=new i.XmlProcessor(e,u),r=n.getDocumentElement(),o=n.selectSingleNode("o:Apps",r),a=o.getAttribute("d1p1:rr");t.refreshRate=a?parseInt(a):0;for(var s=n.selectNodes("o:App",o),c=0;c<s.length;c++){var l=s[c],f={assetId:g,path:g,version:g};n.readAttributes(l,{assetid:d},f);var p=n.selectSingleNode("o:Path",l);f.path=p.text!=g?p.text:p.textContent!=g?p.textContent:p.nodeTypedValue;var m=n.selectSingleNode("o:Version",l);f.version=m.text!=g?m.text:m.textContent!=g?m.textContent:m.nodeTypedValue,t.addInList[f.assetId]=f}return t},v.ConvertAppState=function(e){return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e.state2=e.state?parseInt(e.state):0,e.expirationDate2=v.GetTickByDate(e.expirationDate),e},v.ProcessEntitlement=function(e){var t={},n=new i.XmlProcessor(e,u),s=n.selectSingleNode("o:entitlementlist"),f=n.selectSingleNode("o:hdr",s);n.readAttributes(f,{pm:"billingMarket",pagesize:"pageSize",rr:m},t);for(var p,g,h=n.selectNodes("o:entitlement",n.selectSingleNode("o:entitlements",s)),y=[],b=0;b<h.length;++b)g={},p=h[b],n.readAttributes(p,{assetid:d,pid:l,ver:c,appst:o,cm:r,trlt:"licenseType",acqdate:"acquireDate",expiry2:a,attreq:"attentionRequired"},g),y.push(g);return t.entitlements=y,v.ConvertEntitlementInfo(t)},v.ConvertEntitlementInfo=function(e){for(var t=e.entitlements,n=0;n<t.length;++n){var r=t[n];r.appSubType2=r.appSubType?parseInt(r.appSubType):0,r.acquireDate2=v.GetTickByDate(r.acquireDate),r.expirationDate2=v.GetTickByDate(r.expirationDate),r.attentionRequired2="true"===r.attentionRequired}return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e},v.ProcessKilledApps=function(e){var t={},r=new i.XmlProcessor(e,u),o=r.getDocumentElement();r.readAttributes(o,{rr:m},t);for(var a=[],s=r.selectSingleNode(n),c=r.selectNodes(f,s),p=0;p<c.length;++p){var g=c[p],h={};r.readAttributes(g,{assetid:d,pid:l},h),a.push({assetId:h.assetId,productId:h.productId})}return t.killedApps=a,v.ConvertKilledAppsInfo(t)},v.ConvertKilledAppsInfo=function(e){return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e},v.ProcessClientAppInstallInfo=function(e,t){var o=new i.XmlProcessor(e,u),a=o.selectSingleNode(n),s=o.selectSingleNode(f,a),l={etoken:g,manifest:g};if(t===i.ClientAppInfoReturnType.urlOnly?o.readAttributes(s,{url:"url"},l):t===i.ClientAppInfoReturnType.etokenOnly?o.readAttributes(s,{etok:"etoken"},l):o.readAttributes(s,{url:"url",etok:"etoken"},l),o.readAttributes(s,{status:"status",cm:r,assetid:d,ver:c},l),t!=i.ClientAppInfoReturnType.urlOnly&&l.etoken){var p=new i.XmlProcessor(l.etoken,""),m=p.selectSingleNode("t",p.selectSingleNode("r"));p.readAttributes(m,{te:"tokenExpirationDate",et:"entitlementType",cid:"cid"},l)}return v.ConvertClientAppInstallInfo(l)},v.ConvertClientAppInstallInfo=function(e){return e.status2=e.status?parseInt(e.status):0,e.tokenExpirationDate2=v.GetTickByDate(e.tokenExpirationDate),e},v.ProcessManifest=function(e){return{manifest:e}},v.ProcessRemoveAppResponse=function(e){for(var t,n,r={removedApps:[]},o=new i.XmlProcessor(e,u),a=(o.getDocumentElement(),o.selectSingleNode("o:apps",o.selectSingleNode("o:removedApps"))),s=o.selectNodes("o:app",a),c=0;c<s.length;++c)t=s[c],n={},o.readAttributes(t,{assetid:d,result:"result"},n),r.removedApps.push(n);return v.ConvertRemoveAppResponse(r)},v.ConvertRemoveAppResponse=function(e){for(var t=e.removedApps,n=0;n<t.length;++n){var r=t[n];r.result2=r.result?parseInt(r.result):0}return e},v.ProcessAppDetails=function(n){for(var r,a,l=new i.XmlProcessor(n,u),f=l.selectSingleNode(p),m=l.selectNodes("o:wainfo",f),g=[],h=0;h<m.length;++h)r=m[h],a={},l.readAttributes(r,{assetid:d,defhei:"defaultHeight",defwid:"defaultWidth",title:"name",prov:t,desc:e,icon:"iconUrl",ver:c,state:s,appst:o,appvers:"appVersions",req:"requirements",hosts:"hosts",highresicon:"highResolutionIconUrl"},a),g.push(a);return v.ConvertAppDetails(g)},v.ConvertAppDetails=function(e){for(var t=0;t<e.length;++t){var n=e[t];n.defaultHeight2=n.defaultHeight?parseInt(n.defaultHeight):0,n.defaultWidth2=n.defaultWidth?parseInt(n.defaultWidth):0,n.state2=n.state?parseInt(n.state):0,n.appSubType2=n.appSubType?parseInt(n.appSubType):0}return e},v.ProcessRecommendations=function(n){for(var r,o,a,l=new i.XmlProcessor(n,u),f=l.selectSingleNode(p),m=l.selectNodes("o:wa",f),g=[],v=0;v<m.length;++v)r=m[v],a={},l.readAttributes(r,{assetid:d,title:"name",desc:e,icon:"iconUrl",ver:c,state:s,rat:"rating",dls:"downloads",prov:t},a),o=l.selectSingleNode("o:price",r),l.readAttributes(o,{fop:"originalPrice",opt:"originalPriceTier",fpp:"promotionalPrice",ppt:"promotionalPriceTier",cmod:"priceModel"},a),g.push(a);return g},v.ConvertAnonymousManifest=function(e,t){var n,r="";switch(e){case 200:n=i.OmexClientAppStatus.OK,r=t;break;case 204:case 1223:n=i.OmexClientAppStatus.NoEntitlement;break;case 400:n=i.OmexClientAppStatus.BadRequest;break;case 410:n=i.OmexClientAppStatus.KilledAsset;break;case 404:n=i.OmexClientAppStatus.UnknownAssetId;break;case 412:n=i.OmexClientAppStatus.VersionNotSupported;break;case 451:n=i.OmexClientAppStatus.UserIsMinor;break;default:n=i.OmexClientAppStatus.ServerError}return{status2:n,manifest:r}},v.GetTickByDate=function(e){return e?new Date(e).getTime():g},v}();e.OmexXmlProcessor=t}(l||(l={})),function(e){var t=function(){var t=null;function n(n,r,o,a){void 0===a&&(a=t),this._cacheManager=a||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer),this._privateCatalogService=new e.PrivateCatalogService(i.OmexClientNames[n],i.OUtil.normalizeAppVersion(r)),this._uiLocale=o}return n.prototype.getEntitlementAsync=function(t,r,o,i){r.startActivity(e.Activity.EntitlementCheck),i&&(this._cacheManager.RemoveAll(n._addInsCacheKey),this._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey)),this.GetAddInList(t,r,function(t){for(var i=[],a=0;a<t.length;a++){var s=t[a];s.addInState===n._addInOkState&&i.push(s)}r.stopActivity(e.Activity.EntitlementCheck),o({status:e.DataServiceResultCode.Succeeded,value:i})},function(e){o({status:e})})},n.prototype.getAppDetails=function(r,o,i,a,s){var c=this,u=c;s&&c._cacheManager.RemoveAll(n._addInDetailsCacheKeyPrefix);for(var l=[],d=[],f=0;f<r.length;f++){var p=n.GetAppDetailsCacheKey(r[f].ProductId),m=c._cacheManager.GetCacheItem(p);m?l.push(m):d.push(r[f])}0!==d.length?c._privateCatalogService.GetManifests(d,t,t,i,function(t){for(var r=0;r<t.length;r++){var o=u.ParseAndCacheManifest(t[r],i);if(o){var s=n.CreateAddInDetails(o);l.push(s);var c=n.GetAppDetailsCacheKey(s.assetId);u._cacheManager.SetCacheItem(c,s,n._addInDetailsRefreshRateDays)}}a({status:e.DataServiceResultCode.Succeeded,value:l})},function(e){a({status:e})}):a({status:e.DataServiceResultCode.Succeeded,value:l})},n.prototype.getAndCacheManifest=function(t,r,o,i){var a={ProductId:t.assetId,Version:t.appVersion,AddInState:n._addInOkState,StoreInfo:{AssetId:t.storeId,ContentMarket:r}};this.GetManifest(a,o,function(t){i({status:e.DataServiceResultCode.Succeeded,value:t})},function(e){i({status:e})})},n.prototype.activateAsync=function(r,o,a){var s=this;a.startActivity(e.Activity.Activation);var c=this;this.GetAddInList(!1,a,function(u){for(var l,d=/[{}]/g,f=0;f<u.length;f++){var p=u[f];if(r.assetId.replace(d,"").toLowerCase()===p.assetId.replace(d,"").toLowerCase()){l=p;break}}if(l)if(l.addInState===n._addInOkState){r.appVersion=l.appVersion;var m={ProductId:l.assetId,Version:l.appVersion,AddInState:n._addInOkState,StoreInfo:{AssetId:l.storeId,ContentMarket:""}};s.GetManifest(m,a,function(e){o.load({entitlement:r,manifest:e,eToken:""},t)},function(){e.LoaderUtil.failWithError(o,{description:Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message,url:"",errorCode:i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){o.restartActivation(),c.activateAsync(r,o,a)}})})}else e.LoaderUtil.failWithError(o,{description:Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,url:"",errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED});else e.LoaderUtil.showWarning(o,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){o.restartActivation(),c._cacheManager.RemoveAll(n._addInsCacheKey),c._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey),c.activateAsync(r,o,a)},detailView:!0,retryAll:!0,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})},function(){e.LoaderUtil.showWarning(o,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){o.restartActivation(),c._cacheManager.RemoveAll(n._addInsCacheKey),c._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey),c.activateAsync(r,o,a)},detailView:!0,retryAll:!0,errorCode:i.ErrorStatusCodes.WAC_AgaveActivationError}),a.stopActivity(e.Activity.Activation)})},n.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},n.GetAppDetailsCacheKey=function(e){return n._addInDetailsCacheKeyPrefix+i.OUtil.formatString(n._addInDetailsCacheKeySufix,e)},n.GetManifestCacheKey=function(e,t){return n._manifestCacheKeyPrefix+i.OUtil.formatString(n._manifestCacheKeySufix,e,t)},n.CreateAddInDetails=function(e){return{assetId:e.getMarketplaceID(),defaultHeight2:e.getDefaultHeight()||0,defaultHeight:String(e.getDefaultHeight()||0),defaultWidth2:e.getDefaultWidth()||0,defaultWidth:String(e.getDefaultWidth()||0),name:e.getDefaultDisplayName(),provider:e.getProviderName(),description:e.getDefaultDescription(),iconUrl:e.getDefaultIconUrl(),version:e.getMarketplaceVersion(),state2:1,state:"1",appSubType2:e.getOmexTargetCode(),appSubType:String(e.getOmexTargetCode()),appVersions:void 0,requirements:e.getRequirementsXml(),hosts:e.getHostsXml(),highResolutionIconUrl:e.getDefaultHighResolutionIconUrl()}},n.prototype.GetAddInList=function(e,r,o,i){var a,s=this;e||!(a=this._cacheManager.GetCacheItem(n._addInsCacheKey))?this._privateCatalogService.GetAddInList(t,t,r,function(e){for(var t=0;t<e.length;t++){var r=e[t],i=n.GetAppDetailsCacheKey(r.assetId),a=s._cacheManager.GetCacheItem(i);a&&a.version!==r.appVersion&&s._cacheManager.RemoveCacheItem(i)}s._cacheManager.SetCacheItem(n._addInsCacheKey,e,n._addInListRefreshRateDays),o(e)},i):o(a)},n.prototype.GetManifest=function(r,o,a,s){var c=this,u=c;o.startActivity(e.Activity.ManifestRequest);var l=i.OsfManifestManager.getCachedManifest(r.ProductId,r.Version);if(l)return o.stopActivity(e.Activity.ManifestRequest),void a(l);var d=n.GetManifestCacheKey(r.ProductId,r.Version),f=c._cacheManager.GetCacheItem(d);if(f)return(l=new i.Manifest.Manifest(f,c._uiLocale))?(o.stopActivity(e.Activity.ManifestRequest),void a(l)):void s(e.DataServiceResultCode.Failed);c._privateCatalogService.GetManifests([r],t,t,o,function(t){(l=u.ParseAndCacheManifest(t[0],o))?(i.OsfManifestManager.cacheManifest(r.ProductId,r.Version,l),o.stopActivity(e.Activity.ManifestRequest),a(l)):s(e.DataServiceResultCode.Failed)},function(e){s(e)})},n.prototype.ParseAndCacheManifest=function(e,r){try{var o=new i.Manifest.Manifest(e,this._uiLocale),a=n.GetManifestCacheKey(o.getMarketplaceID(),o.getMarketplaceVersion());return this._cacheManager.SetCacheItem(a,e,n._addInManifestRefreshRateDays),o}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest retrieved from Private Catalog.",e,r.correlationId,19965729)}return t},n._addInsCacheKey="__OSF_PRIVATECATALOG_ADDINS",n._addInDetailsCacheKeyPrefix="__OSF_PRIVATECATALOG_ADDINDETAILS",n._addInDetailsCacheKeySufix="_{0}",n._manifestCacheKeyPrefix="__OSF_PRIVATECATALOG_MANIFEST",n._manifestCacheKeySufix="_{0}_{1}",n._lastCatalogUpdateKey="_OSF_PRIVATECATALOG_LASTUPDATE",n._addInListRefreshRateDays=1/24,n._addInDetailsRefreshRateDays=365,n._addInManifestRefreshRateDays=365,n._addInOkState="Ok",n}();e.PrivateCatalog=t,e.CatalogFactory.register(i.StoreType.PrivateCatalog,function(e){return new t(e.appName,e.appVersion,e.appUILocale)})}(l||(l={})),function(e){var t=function(){var t=!1,n=null;function r(e,t){this._clientCode=e,this._clientVersion=t}return r.initRequestHandler=function(t,o,a){r._requestHandler==n&&(r._requestHandler=t),r.authenticationProxy==n&&(r.authenticationProxy=o),r._isThirdPartyHostEnabled=a,r._tokenCacheManager=new e.TokenCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer),r._cacheManager=new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)},r.ParseAddInList=function(e,t){var o,a=[];try{o=JSON.parse(e)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetAddIns reponse.",e,t.correlationId,19965730),n}if(!o||!o.AddIns)return s.RuntimeTelemetryHelper.LogCommonMessageTag("GetPrivateCatalogAddIns response could not be parsed.",t.correlationId,20194262),a;for(var c=0,u=o.AddIns;c<u.length;c++){var l=u[c];l.AddInState&&l.ProductId&&l.Version?(a.push({assetId:l.ProductId,storeId:l.StoreInfo?l.StoreInfo.AssetId:"none",appVersion:l.Version,storeType:i.StoreType.PrivateCatalog,targetType:i.OsfControlTarget.Undefined,addInState:l.AddInState,contentMarket:l.StoreInfo?l.StoreInfo.ContentMarket:""}),r.StoreAuthenticationData(o)):s.RuntimeTelemetryHelper.LogCommonMessageTag(i.OUtil.formatString('Add-In metadata was missing some data. ID: "{0}", Version: "{1}", State: "{2}".',l.ProductId||"",l.Version||"",l.AddInState||""),t.correlationId,20194263)}return a},r.ParseAndCacheManifestList=function(e,t){var o,i=[];try{o=JSON.parse(e)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetManifests reponse.",e,t.correlationId,19965731),n}if(!o||!o.Manifests)return s.RuntimeTelemetryHelper.LogCommonMessageTag("GetAddInManifests response could not be parsed.",t.correlationId,20194264),i;for(var a=0,c=o.Manifests;a<c.length;a++){var u=c[a];i.push(u)}return r.StoreAuthenticationData(o),i},r.StoreAuthenticationData=function(e){r._tokenCacheManager.AddRefreshToken(e.RefreshToken,e.UserId,e.TenantId),r._userId=e.UserId,r._tenantId=e.TenantId},r.prototype.GetLastPrivateCatalogUpdate=function(o,i,a,c,u){var l=this,d=0;r._requestHandler.getLastPrivateCatalogUpdate(this._clientCode,this._clientVersion,o,i,a.correlationId,function(f,p){if(d++,200===f){var m;try{m=JSON.parse(p)}catch(t){return s.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetLastPrivateCatalogUpdate reponse.",t,a.correlationId,22823177),void u(e.DataServiceResultCode.Failed)}return m&&m.LastUpdate?(r.StoreAuthenticationData(m),void c(m.LastUpdate)):(s.RuntimeTelemetryHelper.LogCommonMessageTag("GetLastPrivateCatalogUpdate response could not be parsed.",a.correlationId,22823178),void u(e.DataServiceResultCode.Failed))}if(403===f){var g;if(1==d)if(d++,g=JSON.parse(p)){var v=r._tokenCacheManager.GetRefreshToken(g.UserId,g.TenantId);if(v!=n)return void l.GetLastPrivateCatalogUpdate(o,v,a,c,u)}if(d>2||o!=n)return s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetLastPrivateCatalogUpdate authentication loop occured.",n,a.correlationId,22823179),void u(e.DataServiceResultCode.Unauthenticated);var h=!0;return setTimeout(function(){r.authenticationProxy.tryAuthorize(function(e){h&&(h=t,l.GetLastPrivateCatalogUpdate(e,i,a,c,u))},function(){h&&(h=t,u(e.DataServiceResultCode.Unauthenticated))})},0),void setTimeout(function(){h&&(h=t,u(e.DataServiceResultCode.Unauthenticated))},5e3)}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetLastPrivateCatalogUpdate request failed with status code "+f,n,a.correlationId,22823180),u(e.DataServiceResultCode.Failed)})},r.prototype.GetAddInList=function(o,i,a,c,u){var l=this,d=0;r._requestHandler.getPrivateCatalogAddIns(this._clientCode,this._clientVersion,o,i,a.correlationId,function(f,p){if(d++,200===f){var m=r.ParseAddInList(p,a);return m?void c(m):void u(e.DataServiceResultCode.Failed)}if(403===f){var g;if(1==d)if(d++,g=JSON.parse(p)){var v=r._tokenCacheManager.GetRefreshToken(g.UserId,g.TenantId);if(v!=n)return void l.GetAddInList(o,v,a,c,u)}if(d>2||o!=n)return s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetAddInList authentication loop occured. Either authentication attempts count is greater than 2, or authorizationCode is not null. attemptsCount: "+d,n,a.correlationId,20497158),void u(e.DataServiceResultCode.Unauthenticated);var h=!0;return setTimeout(function(){r.authenticationProxy.tryAuthorize(function(e){h&&(h=t,l.GetAddInList(e,i,a,c,u))},function(){h&&(h=t,u(e.DataServiceResultCode.Failed))})},0),void setTimeout(function(){if(h){h=t;var n=r._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;u(n)}},5e3)}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetAddInList request failed with status code "+f,n,a.correlationId,20497159),u(e.DataServiceResultCode.Failed)})},r.prototype.GetManifests=function(t,o,i,a,c,u){var l=this,d=0,f={AddIns:t,RefreshToken:i,UserId:"",TenantId:""};r._requestHandler.getPrivateCatalogManifests(e.WACUtils.serializeObjectToString(f),o,i,a.correlationId,function(f,p){if(d++,200===f){var m=r.ParseAndCacheManifestList(p,a);return m?void c(m):void u(e.DataServiceResultCode.Failed)}if(403===f){var g;if(1==d)if(d++,g=JSON.parse(p)){var v=r._tokenCacheManager.GetRefreshToken(g.UserId,g.TenantId);if(v!=n)return void l.GetManifests(t,o,v,a,c,u)}return d>2?(s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetManifests authentication loop occured.",n,a.correlationId,20497160),void u(e.DataServiceResultCode.Unauthenticated)):void r.authenticationProxy.tryAuthorize(function(e){l.GetManifests(t,e,i,a,c,u)},function(){u(e.DataServiceResultCode.Unauthenticated)})}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetManifests request failed with status code "+f,n,a.correlationId,20497161),u(e.DataServiceResultCode.Failed)})},r.SignOutUser=function(){s.RuntimeTelemetryHelper.LogCommonMessageTag(i.OUtil.formatString("PrivateCatalogService.SignOutUser: userId = {0}, tenantId = {1}",r._userId,r._tenantId),n,21616005),r._tokenCacheManager.RemoveRefreshToken(r._userId,r._tenantId),r.authenticationProxy.signOut(function(){r._cacheManager.RemoveAll(e.PrivateCatalog._addInsCacheKey),r._cacheManager.RemoveAll(e.PrivateCatalog._addInDetailsCacheKeyPrefix)},function(){s.RuntimeTelemetryHelper.LogCommonMessageTag("Private Catalog: Failed to sign out ",n,22316866)})},r}();e.PrivateCatalogService=t}(l||(l={})),function(e){var t=function(){var t=null;function n(){}return n.ConvertSessionStartInfoToDmsRing=function(e){var r="Production",o="Microsoft",i=t;if(e&&e.sessionStartInfoJson){var a=n.JsonSerializer.Deserialize(e.sessionStartInfoJson);a!=t&&(i=a.AudienceGroup)}switch(i){case"Dogfood":case"Automation":return"Dogfood";case o:return o;case r:return r;default:return s.RuntimeTelemetryHelper.LogExceptionTag("Could not obtain DMS ring from settings. AudienceGroup value: "+i,t,t,38590113),r}},n.GenerateCapabilitiesList=function(e){var r=[],o=e._getSupportedSet();return o!=t&&(o="string"==typeof o?n.JsonSerializer.Deserialize(o):o,r=Object.keys(o).map(function(e){return{Name:e,Version:o[e]}})),r},n.GenerateDMSPackageListRequestBody=function(e,t,r,o){var i={};i.Hosts=[t],i.ReactNativeVersion="0.0.0.0",i.Channel="DevMain",i.Capabilities=n.GenerateCapabilitiesList(r),i.Ring=n.ConvertSessionStartInfoToDmsRing(o),i.Platform="Web",i.Locales=[e],o&&o.clientId&&(i.ClientId=o.clientId);var a={};return a.Context=i,a.SyncId=0,n.JsonSerializer.Serialize(a)},n.GetDMSPackageList=function(t,r,o,i,a,s){e.SdxWebRequestHandler.SendRequestAsync("POST",t,n.GenerateDMSPackageListRequestBody(r,o,i,a),{"Content-Type":"application/json"},s)},n.JsonSerializer=new e.SafeSerializer,n}();e.DMSHandler=t}(l||(l={})),function(e){var t=function(){function t(){}return t.GetSdxList=function(e,n){var r=i.OUtil.formatString(t.SdxListCacheKeyCompleteFormatter,e,n),o=t.CacheManager.GetCacheItem(r,!0);if(null==o){var a=i.OUtil.formatString(t.SdxListCacheKeyHostPrefixFormatter,e);t.CacheManager.RemoveAll(a)}return o},t.CacheSdxList=function(e,n,r){var o=e.CacheTtlInSec/86400,a=i.OUtil.formatString(t.SdxListCacheKeyCompleteFormatter,n,r);t.CacheManager.SetCacheItem(a,e,o)},t.CacheManager=new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer),t.SdxListCacheKeyHostPrefixFormatter="__OSF_SdxList.{0}",t.SdxListCacheKeyCompleteFormatter=t.SdxListCacheKeyHostPrefixFormatter+".{1}",t}();e.SdxCache=t}(l||(l={})),function(e){var t=function(){var t=null;function n(){}return n.generateLoaderError=function(t,r,o,i,a,s,c){e.LoaderUtil.failWithError(i,{description:t,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){i.restartActivation(),n.activateAsync(o,i,a,s,c)},errorCode:r})},n.GetSDXList=function(r,o,i,a,c,u,l){var d=e.SdxCache.GetSdxList(a,i);r.setFlag(e.FlagName.DmsRequestCachedFlag,d!=t),d==t?e.DMSHandler.GetDMSPackageList(o,i,a,c,u,function(r){if(r.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("GetDMSPackageList request to DMS failed with status = "+r.status+".",t,t,37291604),void l({status:r.status,value:t});var o=n.jsonSerializer.Deserialize(r.value);if(o==t)return s.RuntimeTelemetryHelper.LogExceptionTag("GetDMSPackageList DMS response could not be parsed.",t,t,37291605),void l({status:e.DataServiceResultCode.Failed,value:t});e.SdxCache.CacheSdxList(o,a,i),l({status:e.DataServiceResultCode.Succeeded,value:o})}):l({status:e.DataServiceResultCode.Succeeded,value:d})},n.activateAsync=function(r,o,a,c,u){a.startActivity(e.Activity.Activation),a.startActivity(e.Activity.ServerCall);var l=e.CatalogFactory.getHostContext(),d=i.getManifestHostType(l.hostType);s.RuntimeTelemetryHelper.LogCommonMessageTag('Start activating SDX with assetId ".'+r.assetId+'".',a.correlationId,37291606),n.GetSDXList(a,l.sdxDmsUrl,l.appUILocale,d,c,u,function(d){if(d.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("Retrieving SDX list failed.",t,t,37291607),void n.generateLoaderError(Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,i.ErrorStatusCodes.WAC_AgaveActivationError,r,o,a,c,u);for(var f=t,p=0,m=d.value.Packages;p<m.length;p++){var g=m[p];if(g.AssetId.toLowerCase()==r.assetId.toLowerCase()){f=g;break}}if(f==t)return s.RuntimeTelemetryHelper.LogExceptionTag('Unable to find SDX with assetId "'+r.assetId+'".',t,t,37291608),void n.generateLoaderError(Strings.OsfRuntime.L_AgaveNotExist_ERR,i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST,r,o,a,c,u);a.startActivity(e.Activity.ManifestRequest),e.SdxCdnHandler.GetManifestFromCdn(l.sdxCdnUrl,f,function(d){if(d.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("Retrieving SDX manifest from CDN failed.",t,t,37291609),void n.generateLoaderError(Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure,r,o,a,c,u);var p=e.ManifestUtil.ParseManifest(d.value,l.appUILocale,a.correlationId);if(p==t)return s.RuntimeTelemetryHelper.LogExceptionTag("Unable to parse the SDX manifest.",t,t,37291610),void n.generateLoaderError(Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,i.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT,r,o,a,c,u);a.stopActivity(e.Activity.ServerCall),a.stopActivity(e.Activity.ManifestRequest);var m=e.SdxCdnHandler.GetManifestCdnUrl(l.sdxCdnUrl,f);o.load({entitlement:r,manifest:p,eToken:"",manifestUrl:m},t)})})},n.jsonSerializer=new e.SafeSerializer,n}();e.SDXCatalog=t}(l||(l={})),function(e){var t=function(){function t(){}return t.GetManifestFromCdn=function(n,r,o){var i=t.GetManifestCdnUrl(n,r);e.SdxWebRequestHandler.SendRequestAsync("GET",i,null,null,o)},t.GetManifestCdnUrl=function(e,t){return i.OUtil.formatString(e,t.AssetId,t.FFN,t.Version,"en-us")},t}();e.SdxCdnHandler=t}(l||(l={})),function(e){var t=function(){function t(){}return t.SendRequestAsync=function(t,n,r,o,i){var a="HTTP request (",c=null;void 0===r&&(r=c),void 0===o&&(o=c);var u=new XMLHttpRequest;if(u.open(t,n,!0),u.onload=function(){if(u.readyState==XMLHttpRequest.DONE){var r=u.status;if(r>=200&&r<300&&u.responseText!=c)return void i({status:e.DataServiceResultCode.Succeeded,value:u.responseText})}s.RuntimeTelemetryHelper.LogExceptionTag(a+t+" "+n+") failed with status code = "+u.status+".",c,c,37291611),i({status:e.DataServiceResultCode.Failed,value:c})},u.onerror=function(){s.RuntimeTelemetryHelper.LogExceptionTag(a+t+" "+n+") failed with unexpected error.",c,c,37291612),i({status:e.DataServiceResultCode.Failed,value:c})},u.timeout=3e3,u.ontimeout=function(){s.RuntimeTelemetryHelper.LogExceptionTag(a+t+" "+n+") timeout.",c,c,37291613),i({status:e.DataServiceResultCode.Failed,value:c})},o!=c)for(var l in o)u.setRequestHeader(l,o[l]);u.send(r)},t}();e.SdxWebRequestHandler=t}(l||(l={})),function(e){var t=!1,n=null,r=!0,o=function(){function o(e,t){this._initParam=t,this._cacheManager=e.cacheManager,this._telemetryContext=e.telemetryContext}return o.prototype.getManifest=function(o,a,s,c){var u=this,l=u;u._telemetryContext.startActivity(e.Activity.ManifestRequest);var d=i.OsfManifestManager.getCachedManifest(a.OfficeExtensionID,a.OfficeExtensionVersion);if(d)return u._telemetryContext.stopActivity(e.Activity.ManifestRequest),u._telemetryContext.stopActivity(e.Activity.ServerCall),void s({status:e.DataServiceResultCode.Succeeded,value:{manifest:d,cached:r}});a.EncodedAbsUrl?o.getManifest(a.EncodedAbsUrl,a.OfficeExtensionID,a.OfficeExtensionVersion,function(r){if(l._telemetryContext.stopActivity(e.Activity.ManifestRequest),l._telemetryContext.stopActivity(e.Activity.ServerCall),r.status==e.DataServiceResultCode.Succeeded){var o=e.ManifestUtil.ParseManifest(r.value.manifest,l._initParam.appUILocale,l._telemetryContext.correlationId);o==n&&(r.status=e.DataServiceResultCode.Failed),s({status:r.status,value:{manifest:o,cached:t}})}else s({status:r.status,value:{manifest:n,cached:t}})},c):s({status:e.DataServiceResultCode.Failed,value:{manifest:n,cached:t}})},o.prototype.activate=function(o,a,s){var c,u=this,l={assetId:a.assetId,appVersion:a.appVersion,storeId:a.storeId,storeType:a.storeType,targetType:a.targetType},d=function(o,c){var d=o.manifest,f=d.getMarketplaceVersion();if(i.OsfManifestManager.cacheManifest(a.assetId,a.appVersion,d),o.cached&&e.ManifestUtil.versionLessThan(f,a.appVersion))m(r);else{if(d.requirementsSupported===t||void 0===d.requirementsSupported&&!s.getRequirementsChecker().isManifestSupported(d)){d.requirementsSupported=t;var p;return p=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,void e.LoaderUtil.failWithError(s,{description:p,detailView:r,errorCode:i.ErrorStatusCodes.WAC_AgaveRequirementsError})}if(d.requirementsSupported=r,c&&!s.skipTrust(a)){var g=i.OUtil.formatString(i.Constants.ActivatedCacheKey,a.assetId.toLowerCase(),a.storeType,a.storeId),v=i.OmexClientNames[u._initParam.applicationName];if(!u._cacheManager.GetCacheItem(g,t)&&!s.hasConsent(a)&&!s.isForCustomFunctionSandbox())return void s.askForTrust({anonymous:n,clientName:v,entitlement:l,displayName:d.getDefaultDisplayName(),providerName:d.getProviderName(),iconUrl:d.getDefaultIconUrl(),isSSOAddin:d.isSSOAddin()},function(){u._cacheManager.SetCacheItem(g,r),s.load({entitlement:l,manifest:d,eToken:n},n)})}s.hasConsent(a)&&u._cacheManager.SetCacheItem(g,r),s.load({entitlement:l,manifest:d,eToken:n},n)}},f=function(t){u.getManifest(o,c,function(n){n.status===e.DataServiceResultCode.Succeeded&&n.value.manifest?d(n.value,r):e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){s.restartActivation(),f(t)},errorCode:i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE})},t)},p=function(t){c?c.OfficeExtensionKillbit?e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_KILLED}):f(t):e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){s.restartActivation(),u._telemetryContext.startActivity(e.Activity.Activation),u._telemetryContext.startActivity(e.Activity.ServerCall),m(r)},errorCode:i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST})},m=function(r){c=n,u._telemetryContext.startActivity(e.Activity.EntitlementCheck),o.getEntitlementAsync(t,a.targetType,function(t){if(t.status==e.DataServiceResultCode.Succeeded){u._telemetryContext.stopActivity(e.Activity.EntitlementCheck);for(var o,a=n,d=t.value.entitlements,f=0;f<d.length;f++)(o=d[f]).OfficeExtensionID&&l.assetId&&o.OfficeExtensionID.toLowerCase()==l.assetId.toLowerCase()&&(a&&!e.ManifestUtil.versionLessThan(a.OfficeExtensionVersion,o.OfficeExtensionVersion)||(a=o));c=a,p(r)}else e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){s.restartActivation(),u._telemetryContext.startActivity(e.Activity.Activation),u._telemetryContext.startActivity(e.Activity.ServerCall),m()},errorCode:i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE})},r)};m()},o}(),a=function(){function a(t,r){var o=this;void 0===r&&(r=n),o._appDataService={},o._catalogUrlDataService={},o._initParam=t,o._cacheManager=r||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return a.prototype.getDataService=function(e,t,n){this.getDataServiceInternal(this._appDataService,e,t,n)},a.prototype.getCatalogUrlDataService=function(e,t,n){this.getDataServiceInternal(this._catalogUrlDataService,e,t,n)},a.prototype.getDataServiceInternal=function(t,r,o,i){if(t[r]==n&&(t[r]={spCatalogService:n,spCatalogServiceReady:n}),t[r].spCatalogService==n)if(t[r].spCatalogServiceReady==n){t[r].spCatalogServiceReady=i;var a={status:e.DataServiceResultCode.Failed,value:n},s=function(o,i){var s=t[r].spCatalogServiceReady;t[r].spCatalogServiceReady=n,o.status==e.DataServiceResultCode.Succeeded?(t[r].spCatalogService=i,a.value=i,a.status=e.DataServiceResultCode.Succeeded,s(a)):(a.httpStatus=o.httpStatus,s(a))};o.startActivity(e.Activity.Authentication);var c=e.SPCatalogProxyBasedCatalogService.getInstance(this._initParam);c.prepareProxy(r,o.correlationId,function(t){o.stopActivity(e.Activity.Authentication),s(t,c)})}else{var u=t[r].spCatalogServiceReady;t[r].spCatalogServiceReady=function(e){u(e),i(e)}}else i({status:e.DataServiceResultCode.Succeeded,value:t[r].spCatalogService})},a.prototype.createActivityScope=function(t,n,r){var i=this;this.getDataService(t,n,function(a){if(!e.AsyncUtil.failed(a,r)){var s=a.value,c={cacheManager:i._cacheManager,storeId:t,telemetryContext:n},u=s.createScope(c),l=new o(c,i._initParam);r({status:e.DataServiceResultCode.Succeeded,value:{serviceScope:u,activityScope:l}})}})},a.prototype.getEntitlementAsync=function(t,r,o,a,s,c){var u=this,l=function(s){s.status===e.DataServiceResultCode.Succeeded?(u.myOrgCatalogUrl=s.value,u.createActivityScope(s.value,r,function(r){e.AsyncUtil.failed(r,o,[])||r.value.serviceScope.getEntitlementAsync(t,n,function(t){if(!e.AsyncUtil.failed(t,o,[])){for(var n=t.value.entitlements,r=0;r<n.length;r++){var a=n[r];a.assetId=a.OfficeExtensionID,a.appVersion=a.OfficeExtensionVersion,a.storeId=u.myOrgCatalogUrl,a.storeType=i.StoreType.SPCatalog,a.targetType=i.OfficeAppType[a.OEType]}o({status:t.status,value:n})}},a)})):o({status:s.status,value:n})};(c=c||this.myOrgCatalogUrl||n)?l({status:e.DataServiceResultCode.Succeeded,value:c}):this.getSPCatalogUrl(r,l)},a.prototype.getAndCacheManifest=function(o,a,s,c){var u=this;this.getEntitlementAsync(r,s,function(t){if(i.OUtil.writeProfilerMark(i.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd),t.status===e.DataServiceResultCode.Succeeded&&t.value){for(var r=t.value,a=r.length,l=n,d=0;d<a;d++){var f=r[d];f.OfficeExtensionID&&o.assetId&&f.OfficeExtensionID.toLowerCase()===o.assetId.toLowerCase()&&(l&&!i.OsfManifestManager.versionLessThan(l.OfficeExtensionVersion,f.OfficeExtensionVersion)||(l=f))}l!=n?u.createActivityScope(u.myOrgCatalogUrl,s,function(t){e.AsyncUtil.failed(t,c)||t.value.activityScope.getManifest(t.value.serviceScope,l,function(e){c({status:e.status,value:e.value.manifest})})}):c({status:e.DataServiceResultCode.Failed,value:n})}else c({status:e.DataServiceResultCode.Failed,value:n})},t,0,o.storeId)},a.prototype.activateAsync=function(t,n,r){var o=this;r.startActivity(e.Activity.Activation),r.startActivity(e.Activity.ServerCall),this.createActivityScope(t.storeId,r,function(a){if(a.status==e.DataServiceResultCode.Succeeded){var s=a.value.serviceScope;a.value.activityScope.activate(s,t,n)}else e.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),o.activateAsync(t,n,r)},errorCode:i.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError})})},a.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},a.prototype.getAppDetails=function(t,n,r,o){o({status:e.DataServiceResultCode.Failed})},a.prototype.getSPCatalogUrl=function(t,n){var r=this;this.getCatalogUrlDataService(this._initParam.spBaseUrl,t,function(){e.SPCatalogProxyBasedCatalogService.getInstance(r._initParam).getSPCatalogUrl(r._initParam.spBaseUrl,t.correlationId,n)})},a}();e.CatalogFactory.register(i.StoreType.SPCatalog,function(e){return new a({applicationName:i.HostCapability[e.hostType],AppVersion:e.appVersion,clientMode:e.clientMode,appUILocale:e.appUILocale,spBaseUrl:e.spBaseUrl,docUrl:e.docUrl})})}(l||(l={})),function(e){var t=function(){function e(){}return e.CheckProxyIsReady="OEM_isProxyReady",e.GetEntitlementSummary="OEM_getEntitlementSummaryAsync",e.GetManifest="OEM_getManifestAsync",e.GetSPCatalogUrl="OEM_getSPCatalogUrlAsync",e}();e.SPCatalogProxyMethods=t;var n=function(){function e(){this.iframeProxies={},this.iframeProxyCount=0}return e.iframeNamePrefix="__officeExtensionProxy",e}();e.IframeProxyGroup=n;var r=function(r){var o=null;function a(e,t){r.call(this),this.proxyUrl=e,this.iframeProxyGroup=t}return c(a,r),a.prototype.getEntitlementsAsync=function(e,n){this.invokeProxyCommandAsync(t.GetEntitlementSummary,e,n)},a.prototype.getManifestAsync=function(e,n){this.invokeProxyCommandAsync(t.GetManifest,e,n)},a.prototype.getSPCatalogUrlAsync=function(e,n){this.invokeProxyCommandAsync(t.GetSPCatalogUrl,e,n)},a.prototype.prepareProxy=function(e,t){var n=this;n.isReady?e({status:o,value:{clientEndpoint:n.clientEndPoint}}):n.clientEndPoint?n.pendingCallbacks.push([e,t]):n.createProxy(e,t)},a.resetProxy=function(e){delete e.iframeProxyGroup.iframeProxies[e.proxyUrl],e.iframeProxyGroup.iframeProxyCount=e.iframeProxyGroup.iframeProxyCount-1,Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e.conversationId)&&Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e.conversationId),e.iframe&&(i.OUtil.removeEventListener(e.iframe,"load",e.iframeOnload),e.iframe.parentNode.removeChild(e.iframe),e.iframe=o),e.clientEndPoint=o},a.prototype.createProxy=function(r,c){var u=this;try{if(!u.doesUrlHaveSupportedProtocol(u.proxyUrl))return void c({status:o,value:{errorMessage:"Protocal of proxyUrl is not supported."}});u.iframeProxyGroup.iframeProxies[u.proxyUrl]=u,u.iframeProxyGroup.iframeProxyCount=u.iframeProxyGroup.iframeProxyCount+1;var l=u.proxyUrl,d=l.length;"/"===l.charAt(d-1)&&(l=l.substr(0,d-1));var f=document.createElement("iframe"),p=n.iframeNamePrefix+u.iframeProxyGroup.iframeProxyCount;f.setAttribute("id",p),f.setAttribute("name",p);var m=l+"/_layouts/15/OfficeExtensionManager.aspx?"+u.conversationId;m=i.OUtil.addXdmInfoAsHash(m,u.conversationId+"|"+p+"|"+window.location.href),m=i.OUtil.addSerializerVersionAsHash(m,i.SerializerVersion.Browser),f.setAttribute("scrolling","auto"),f.setAttribute("border","0"),f.setAttribute("width","0"),f.setAttribute("height","0"),f.setAttribute("style","position: absolute; left: -100px; top:0px;");var g=u;document.body.appendChild(f);var v=function(){if(g.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(g.conversationId,f.contentWindow,g.proxyUrl),g.clientEndPoint)g.clientEndPoint.invoke(t.CheckProxyIsReady,function(e,t){var n=o;0===e&&t.status?(g.isReady=!0,n={status:o,value:{clientEndpoint:g.clientEndPoint}}):(a.resetProxy(g),n={status:o,value:{errorMessage:"isProxyReadyCallback failed, error code "+e}});for(var r=g.pendingCallbacks.length,i=0;i<r;i++){var s=g.pendingCallbacks.shift();g.isReady?s[0](n):s[1](n)}},{__timeout__:2e3});else{var e="Unexpected error, iframe loaded again after failing OEM_isProxyReady";s.RuntimeTelemetryHelper.LogExceptionTag(e,o,o,18657365),c({status:o,value:{errorMessage:e}})}};i.OUtil.addEventListener(f,"load",v),f.setAttribute("src",m),u.iframeOnload=v,u.pendingCallbacks.push([r,c]),u.iframe=f}catch(t){var h="Error creating client endpoint with proxyUrl = ["+u.proxyUrl+"], msg:"+e.WACUtils.serializeObjectToString(t);c({status:o,value:{errorMessage:h}})}},a}(e.ProxyBase);e.SPCatalogProxy=r}(l||(l={})),function(e){var t=null,n=function(){function n(t){this.proxyRetries={},this.initParams=t,this.iframeProxyGroup=new e.IframeProxyGroup}return n.getInstance=function(e){return n._instance==t&&(n._instance=new n(e)),n._instance},n.prototype.prepareProxy=function(n,r,o){r=r||"";this.proxyRetries[n]=1,this.ensureSPCatalogProxySetUp(n,r,function(n){n&&n.status!=t?n.status:e.DataServiceResultCode.ProxyNotReady;o({status:n.status})})},n.prototype.createScope=function(e){return new r(e,this)},n.prototype.getSPCatalogUrl=function(n,r,a){var c=this;this.prepareProxy(n,r,function(){var u;if(n&&(u=c.iframeProxyGroup.iframeProxies[n])){var l={};l.webUrl=n,u.getSPCatalogUrlAsync(l,function(n){var i="getspcatalogurl failed";n.status!==e.DataServiceResultCode.Succeeded&&(s.RuntimeTelemetryHelper.LogExceptionTag(i,t,r,19015125),o.msAjaxDebug.trace(i)),a(n)})}else s.RuntimeTelemetryHelper.LogExceptionTag(i.OUtil.formatString("getspcatalogurl proxy not found, webUrl: {0}",n),t,r,19969545),a({status:e.DataServiceResultCode.ProxyNotReady})})},n.prototype.ensureSPCatalogProxySetUp=function(n,r,o){if(!n)return s.RuntimeTelemetryHelper.LogExceptionTag("proxyUrl is null",t,r,19969546),void o({status:e.DataServiceResultCode.Failed});var a=this.iframeProxyGroup.iframeProxies[n];if(a||(a=new e.SPCatalogProxy(n,this.iframeProxyGroup)),a.isReady)o({status:e.DataServiceResultCode.Succeeded});else{var c=this,u=function(){o({status:e.DataServiceResultCode.Succeeded})},l=function(){c.proxyRetries[n]<i.Constants.AuthenticatedConnectMaxTries?(c.proxyRetries[n]++,a.prepareProxy(u,l)):(s.RuntimeTelemetryHelper.LogExceptionTag("sp exceed maximum tries and fail",t,r,18940555),o({status:e.DataServiceResultCode.ProxyNotReady}))};a.prepareProxy(u,l)}},n}();e.SPCatalogProxyBasedCatalogService=n;var r=function(){var n="clearCache";function r(e,t){this._catalogService=t,this.proxyUrl=e.storeId,this._correlationId=e.telemetryContext.correlationId||""}return r.prototype.tryFail=function(t,n,r){return t!=e.DataServiceResultCode.Succeeded&&(r({status:t}),!0)},r.prototype.getEntitlementAsync=function(e,t,r,o){var i=this,a=i,s=i._catalogService.iframeProxyGroup.iframeProxies[i.proxyUrl],c={};c.webUrl=i.proxyUrl,c.applicationName=i._catalogService.initParams.applicationName,c.officeExtentionTarget=t,c[n]=o||!1,c.supportedManifestVersions={"1.0":!0,1.1:!0},s.getEntitlementsAsync(c,function(e){a.tryFail(e.status,e.httpStatus,r)?a.logServiceCallResponseError("entitlement",e.httpStatus):r(e)})},r.prototype.getLastStoreUpdate=function(){},r.prototype.getManifest=function(e,t,r,o,i){var a=this,s=this._catalogService.iframeProxyGroup.iframeProxies[this.proxyUrl],c={};c.manifestUrl=e,c.id=t,c.version=r,c[n]=i,s.getManifestAsync(c,function(e){a.tryFail(e.status,e.httpStatus,o)?a.logServiceCallResponseError("manifest",e.httpStatus):o(e)})},r.prototype.logServiceCallResponseError=function(e,n){var r="spproxy request "+e+" failed";n&&(r+=":"+n),s.RuntimeTelemetryHelper.LogExceptionTag(r,t,this._correlationId,18940556)},r}();e.SPCatalogProxyBasedCatalogServiceScope=r}(l||(l={})),i.InfoType={Error:0,Warning:1,Information:2,SecurityInfo:3},i.NotificationType={TrustYellowBar:0,ConsentYellowBar:1,ConsentWhiteDialog:2,TrustPromptTaskpane:3,TrustPromptContent:4},i.ConsentResultCode={Success:0,Cancelled:100,ClientError:400,ServerError:500,UnknownError:600},i.OmexMessageType={ConsentResult:0,TabExit:1,ButtonClick:2,PageLoad:3},i._ErrorUXHelper=function(e){var t="progress_",n="input,a,button",r="moe-infobar-button2_",o=!0,a="moe-infobar-button_",c="moe-infobar-button",u=!1,d="button",f="moe-infobar-dismiss_",p="moe-infobar-dismiss",m="moe-infobar-message",g="moe-infobar-message_",v="moe-infobar-title",h="span",y="moe-infobar-message-div",b="moe-infobar-secinfo",_="moe-infobar-info",S="moe-infobar-warning",C="moe-infobar-error",O="moe-infobar-button-cell",I="moe-infobar-top-right-cell",A="moe-infobar-message-cell",T="moe-infobar-top-left-cell",E="presentation",x="role",P="moe-infobar-infotable",M="table",w="moe-infobar-body",R="alt",k=null,D="100%",j="center",N="no-repeat",F="alpha(opacity=100)",L="1",U="white",B="url(",H="onclick",V="tabindex",W="image",G="type",z="input",q="id",K="moe-background",X="class",J="div",Q="moe-trust-prompt-table_",Y="notificationbackground_",Z="moe-infobar-body_",$="agavedefaulticon96x96.png",ee="moe_status_icons.png",te="progress.gif",ne="img",re=e,oe=re.getOsfOmexBaseUrl(),ie="omexNotificationIframeClassName";i.OUtil.loadCSS(re.getLocalizedCSSFilePath("moeerrorux.css")),document.createElement(ne).src=re.getLocalizedImageFilePath(te),document.createElement(ne).src=re.getLocalizedImageFilePath(ee),document.createElement(ne).src=re.getLocalizedImageFilePath($);var ae={},se=0,ce=function(e){for(var t,n=e.childNodes.length,r=0;r<n;)"iframe"===(t=e.childNodes.item(r)).tagName.toLowerCase()?r++:(e.removeChild(t),n--)},ue=function(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)},le=function(e,t){var n;i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2Start),n=t?Z+e:Y+e;var r=Pe(e);r&&ae[e][0].highPriority&&se--,ue(n),r&&ae[e].shift(),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2End)},de=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2Start);var t=Q+e.id,n=Pe(e.id);n&&ae[e.id][0].highPriority&&se--,ue(t),n&&ae[e.id].shift(),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2End)},fe=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage1Start),ce(e.div);var t=document.createElement(J);t.setAttribute(X,K),t.setAttribute(q,"icon_"+e.id);var n=document.createElement(z);n.setAttribute(q,"iconImg_"+e.id),n.setAttribute(G,W),n.setAttribute(V,"0"),n.src=re.getLocalizedImageFilePath(ee);var r,o,a;n.setAttribute(H,"getIntoStage2(params)"),i.OUtil.attachClickHandler(n,function(){!function(e){e.sqmDWords[1]|=2,Oe(e.id);var t=l.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();t&&t.enableSingleSignOnForAddin?me(e):pe(e)}(e)}),t.appendChild(n),e.displayDeactive&&(t.style.backgroundImage=B+re.getLocalizedImageFilePath($)+")",t.style.backgroundColor=U,t.style.opacity=L,t.style.filter=F,t.style.backgroundRepeat=N,t.style.backgroundPosition=j,t.style.height=D),e.infoType===i.InfoType.Error?(r="moe-status-error-icon",o="iconImg_error_"+e.id,a=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===i.InfoType.Warning?(r="moe-status-warning-icon",o="iconImg_warning_"+e.id,a=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===i.InfoType.Information?(r="moe-status-info-icon",o="iconImg_info_"+e.id,a=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(r="moe-status-secinfo-icon",o="iconImg_secinfo_"+e.id,a=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)!=k&&9==parseFloat(RegExp.$1)&&(r+="_ie"),n.setAttribute(X,r),n.setAttribute(q,o),n.setAttribute(R,a),0!=e.div.childNodes.length?e.div.insertBefore(t,e.div.childNodes[0]):e.div.appendChild(t),Ae(e.id,i.AgaveHostAction.TabIn),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage1End)},pe=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2Start),ce(e.div);var t=e.description;e.title.length>100&&(e.title=e.title.substring(0,99)),e.description.length>255&&(e.description=e.description.substring(0,254));var n=Z+e.id,l=document.getElementById(n);null==l&&((l=document.createElement(J)).setAttribute(X,w),l.setAttribute(q,n));var Q=document.createElement(J);Q.innerHTML=t,l.setAttribute("title",Q.textContent),Q=k;var te=document.createElement(M);te.setAttribute(X,P),te.setAttribute(x,E);for(var oe=0;oe<3;oe++)te.insertRow(oe).setAttribute(x,E);var ie=te.rows;ie[0].insertCell(0),ie[0].insertCell(1),ie[0].insertCell(2),ie[0].cells[1].setAttribute("rowSpan","2"),ie[1].insertCell(0),ie[1].insertCell(1),ie[2].insertCell(0),ie[2].insertCell(1),ie[2].insertCell(2),ie[0].cells[0].setAttribute(X,T),ie[0].cells[1].setAttribute(X,A),ie[0].cells[2].setAttribute(X,I),ie[2].cells[1].setAttribute(X,O);var ae,se,ue=document.createElement(ne);ue.src=re.getLocalizedImageFilePath(ee),e.infoType===i.InfoType.Error?(ae=C,se=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===i.InfoType.Warning?(ae=S,se=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===i.InfoType.Information?(ae=_,se=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(ae=b,se=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),ue.setAttribute(X,ae),ue.setAttribute(R,se),ie[0].cells[0].appendChild(ue);var de=document.createElement("a");de.setAttribute(X,y),de.setAttribute(V,L);var fe=document.createElement(h);fe.setAttribute(X,v),fe.innerHTML=e.title;var pe=g+e.id,me=document.getElementById(pe);null==me&&((me=document.createElement(h)).setAttribute(X,m),me.setAttribute(q,pe)),me.innerHTML=e.description,de.appendChild(fe),de.appendChild(me),ie[0].cells[1].appendChild(de);var ge=function(e){var t=re.getOsfControl(e.id);s.AppNotificationHelper.LogNotification(t._appCorrelationId,e.sqmDWords[0],e.sqmDWords[1])},ve=function(){e.sqmDWords[1]|=8,ge(e),!e.reDisplay&&le(e.id,e.displayDeactive),Oe(e.id),e.reDisplay?Ee(e):xe(e.id),e.dismissCallback&&e.dismissCallback()},he=document.createElement(z);he.setAttribute(G,W),he.setAttribute("src",re.getLocalizedImageFilePath(ee)),he.setAttribute(X,p),he.setAttribute(q,f+e.id),he.setAttribute(V,"0"),he.setAttribute(R,Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT),he.setAttribute(x,d),he.setAttribute(H,"handleDismiss();"),i.OUtil.attachClickHandler(he,ve),ie[0].cells[2].appendChild(he),e.detailView=u;var ye=document.createElement(d);if(ye.setAttribute(X,c),ye.innerHTML=e.buttonTxt,ye.setAttribute(q,a+e.id),ye.setAttribute(V,L),ye.setAttribute(G,d),e.buttonCallback){ye.setAttribute(H,"handleButtonClick()"),i.OUtil.attachClickHandler(ye,function(){if(e.sqmDWords[1]|=4,ge(e),le(e.id,u),Oe(e.id),xe(e.id),e.retryAll===o){var t=re.getOsfControl(e.id);t._retryActivate=k,re.retryAll(t._marketplaceID)}e.buttonCallback()})}else ye.setAttribute(H,"handleDismiss()"),i.OUtil.attachClickHandler(ye,ve);if(ie[2].cells[1].appendChild(ye),e.url){var be=document.createElement(d);be.setAttribute(X,c),be.innerHTML=e.urlButtonTxt?e.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT,be.setAttribute(q,r+e.id),be.setAttribute(H,"moreInfoButtonClick()"),i.OUtil.attachClickHandler(be,function(){e.sqmDWords[1]|=4,ge(e),e.sqmDWords[1]=1,window.open(e.url)}),be.setAttribute(V,L),be.setAttribute(G,d),ie[2].cells[1].appendChild(be)}l.appendChild(te);var _e=document.createElement(J);_e.setAttribute(X,K),_e.setAttribute(q,Y+e.id),e.displayDeactive&&(_e.style.backgroundImage=B+re.getLocalizedImageFilePath($)+")",_e.style.backgroundColor=U,_e.style.opacity=L,_e.style.filter=F,_e.style.backgroundRepeat=N,_e.style.backgroundPosition=j,_e.style.height=D),_e.appendChild(l),0!=e.div.childNodes.length?e.div.insertBefore(_e,e.div.childNodes[0]):e.div.appendChild(_e),Ae(e.id,i.AgaveHostAction.TabIn),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2End)},me=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2Start);try{ce(e.div);var t=e.description;e.title.length>100&&(e.title=e.title.substring(0,99)),e.description.length>255&&(e.description=e.description.substring(0,254));var n=Z+e.id,r=document.getElementById(n);null==r&&((r=document.createElement(J)).className=w,r.id=n),r.title=t,e.iframeNotificationUrl?r.appendChild(he(e,r)):r.appendChild(ve(e));var o=document.createElement(J);o.className=K,o.id=Y+e.id,e.displayDeactive&&(o.style.backgroundImage=B+re.getLocalizedImageFilePath($)+")",o.style.backgroundColor=U,o.style.opacity=L,o.style.filter=F,o.style.backgroundRepeat=N,o.style.backgroundPosition=j,o.style.height=D),o.appendChild(r),0!=e.div.childNodes.length?e.div.insertBefore(o,e.div.childNodes[0]):e.div.appendChild(o),Ae(e.id,i.AgaveHostAction.TabIn)}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to show infobar, error message: ",e,k,23455900)}i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2End)},ge=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2Start);try{ce(e.div);var t=function(e){function t(e,t){var n=e.insertRow(-1);n.className="moe-trust-prompt-row "+t,n.setAttribute(x,E),n.insertCell(-1).className="moe-trust-prompt-cell"}e.id;var n=Q+e.id,r=document.getElementById(n);r===k&&((r=document.createElement(M)).id=n,r.className="moe-trust-prompt-table",r.setAttribute(x,E)),t(r.createTHead(),"moe-trust-prompt-header");var o=r.createTBody();return t(o,"moe-trust-prompt-preview"),t(o,"moe-trust-prompt-description"),t(r.createTFoot(),"moe-trust-prompt-footer"),r}(e),n=t.rows,r=function(e){var t=document.createElement("p");return t.innerHTML=e.notificationType===i.NotificationType.TrustPromptContent?e.name:e.title,t.className="moe-trust-prompt-header-title",t}(e);n[0].cells[0].appendChild(r);var a=function(e){var t=document.createElement(ne);return t.src=e.icon,t.className="moe-trust-prompt-preview-img",t.setAttribute(R,e.iconTitle),t}(e),c=function(e){var t=document.createElement("p");return t.innerHTML=e.name,t.className="moe-trust-prompt-preview-title",t}(e),u=function(e){var t=document.createElement("p");return t.innerHTML=e.provider,t.className="moe-trust-prompt-preview-sub",t}(e);n[1].cells[0].appendChild(a),n[1].cells[0].appendChild(c),n[1].cells[0].appendChild(u);var l=function(e){var t=document.createElement("p");return t.innerHTML=e.description,t.className="moe-trust-prompt-description-text",t}(e);n[2].cells[0].appendChild(l);var f=function(){var t,n=document.createElement(d);return n.textContent=e.buttonTxt,n.className="moe-trust-prompt-button moe-trust-prompt-button-primary moe-trust-prompt-buttons-action",n.id="moe-trust-prompt-buttons-action_"+e.id,n.tabIndex=0,n.type=d,t=e.buttonCallback?function(){if(e.sqmDWords[1]|=4,_e(e),de(e),Oe(e.id),xe(e.id),e.retryAll===o){var t=re.getOsfControl(e.id);t._retryActivate=k,re.retryAll(t._marketplaceID)}e.buttonCallback()}:function(){e.sqmDWords[1]|=8,_e(e),!e.reDisplay&&de(e),Oe(e.id),e.reDisplay?Ee(e):xe(e.id),e.dismissCallback&&e.dismissCallback()},i.OUtil.attachClickHandler(n,t),n}();if(n[3].cells[0].appendChild(f),e.url!==k){var p=function(e){var t=document.createElement(d);return t.textContent=e.urlButtonTxt||Strings.OsfRuntime.L_MoreInfoButton_TXT,t.className="moe-trust-prompt-button moe-trust-prompt-buttons-url",t.id="moe-trust-prompt-buttons-url_"+e.id,t.tabIndex=1,t.type=d,i.OUtil.attachClickHandler(t,function(){e.sqmDWords[1]|=4,_e(e),window.open(e.url)}),t}(e);n[3].cells[0].appendChild(p)}var m=function(e){var t=document.createElement(J);t.className="moe-trust-prompt-collapse cui-ctl-iconContainer cui-img-cont-float cui-img-16by16";var n=document.createElement(ne);switch(e.clientName){case"WAC_Powerpoint":n.src=re.getLocalizedImageFilePath("per.png"),n.className="per_UpChevron_16x16x32";break;case"WAC_Word":n.src=re.getLocalizedImageFilePath("we.png"),n.className="we_UpChevron_16x16x32";break;case"WAC_Excel":n.src=re.getLocalizedImageFilePath("EwaEdit.png"),n.className="ewaboot_UpChevron16"}return n.alt=Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT,t.appendChild(n),i.OUtil.attachClickHandler(t,function(){var t="collapsed";e.collapsed===o?e.div.classList.remove(t):e.div.classList.add(t),e.collapsed=!e.collapsed}),t}(e);0!=e.div.childNodes.length?e.div.insertBefore(t,e.div.childNodes[0]):e.div.appendChild(t),e.div.appendChild(m),e.div.style.overflowY="auto",e.div.classList.add("moe-trust-prompt"),e.div.classList.add(e.clientName),e.div.classList.add(e.notificationType===i.NotificationType.TrustPromptContent?"content-add-in":"taskpane-add-in"),Ae(e.id,i.AgaveHostAction.TabIn)}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to show trust prompt, error message: ",e,k,38592974)}i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2End)},ve=function(e){var t=ye(e),n=t.rows;n[0].cells[0].appendChild(be(e));var s=document.createElement("a");s.className=y,s.tabIndex=1;var l=document.createElement(h);l.className=v,l.textContent=e.title;var f=g+e.id,p=document.getElementById(f);null==p&&((p=document.createElement(h)).className=m,p.id=f),p.textContent=e.description,s.appendChild(l),s.appendChild(p),n[0].cells[1].appendChild(s);var b=function(){Se(e)},_=Ce(e);i.OUtil.attachClickHandler(_,b),n[0].cells[2].appendChild(_),e.detailView=u;var S=document.createElement(d);if(S.className=c,S.textContent=e.buttonTxt,S.id=a+e.id,S.tabIndex=1,S.type=d,e.buttonCallback){i.OUtil.attachClickHandler(S,function(){if(e.sqmDWords[1]|=4,_e(e),le(e.id,u),Oe(e.id),xe(e.id),e.retryAll===o){var t=re.getOsfControl(e.id);t._retryActivate=k,re.retryAll(t._marketplaceID)}e.buttonCallback()})}else i.OUtil.attachClickHandler(S,b);if(n[2].cells[1].appendChild(S),e.url){var C=document.createElement(d);C.className=c,C.textContent=e.urlButtonTxt?e.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT,C.id=r+e.id,i.OUtil.attachClickHandler(C,function(){e.sqmDWords[1]|=4,_e(e),e.sqmDWords[1]=1,window.open(e.url)}),C.tabIndex=1,C.type=d,n[2].cells[1].appendChild(C)}return t},he=function(e,t){var n="message",r=ye(e),a=r.rows,c=document.createElement("iframe");window.getComputedStyle(e.div,k);c.width=D,c.frameBorder="0",c.className=ie,c.src=e.iframeNotificationUrl,a[0].cells[1].appendChild(c);var l="moe-hovered";t.addEventListener("mouseenter",function(){i.OUtil.addClass(t,l),c.contentWindow.postMessage(i.AgaveHostAction.MouseEnter,oe)}),t.addEventListener("mouseleave",function(){i.OUtil.removeClass(t,l),c.contentWindow.postMessage(i.AgaveHostAction.MouseLeave,oe)}),e.detailView=u;var d=k,f=Ce(e);return i.OUtil.attachClickHandler(f,function(){Se(e),window.removeEventListener(n,d)}),a[0].cells[2].appendChild(f),f.addEventListener("keydown",function(e){9==e.keyCode&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),c.contentWindow.postMessage(i.AgaveHostAction.TabInShift,oe))}),e.buttonCallback&&(d=function(t){try{if(t.source==c.contentWindow){var r=JSON.parse(t.data),a=parseInt(r[i.OmexMessageKeys.MessageType]),l=parseInt(r[i.OmexMessageKeys.MessageValue]);if(a==i.OmexMessageType.ConsentResult){if(le(e.id,u),Oe(e.id),xe(e.id),e.retryAll===o&&(e.notificationType==i.NotificationType.TrustYellowBar||e.notificationType==i.NotificationType.ConsentYellowBar&&l==i.ConsentResultCode.Success)){var p=re.getOsfControl(e.id);p._retryActivate=k,re.retryAll(p._marketplaceID)}window.removeEventListener(n,d),e.buttonCallback(l)}else a==i.OmexMessageType.TabExit&&(l==i.AgaveHostAction.TabExitShift&&re._notifyHost?re._notifyHost(e.id,i.AgaveHostAction.TabExitShift):l==i.AgaveHostAction.TabExit&&(window.focus(),f.focus()))}}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Exception in receivedMessageHandler: ",e,k,23455901)}},window.addEventListener(n,d)),r},ye=function(e){var t=document.createElement(M);t.className=P,t.setAttribute(x,E);for(var n=e.iframeNotificationUrl?1:3,r=0;r<n;r++){t.insertRow(r).setAttribute(x,E)}var o=t.rows;return o[0].insertCell(0),o[0].insertCell(1),o[0].insertCell(2),o[0].cells[1].setAttribute("rowSpan","2"),o[0].cells[0].setAttribute(X,T),o[0].cells[1].setAttribute(X,A),o[0].cells[2].setAttribute(X,I),e.iframeNotificationUrl==k&&(o[1].insertCell(0),o[1].insertCell(1),o[2].insertCell(0),o[2].insertCell(1),o[2].insertCell(2),o[2].cells[1].setAttribute(X,O)),o[0].cells[0].appendChild(be(e)),t},be=function(e){var t,n,r=document.createElement(ne);return r.src=re.getLocalizedImageFilePath(ee),e.infoType===i.InfoType.Error?(t=C,n=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===i.InfoType.Warning?(t=S,n=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===i.InfoType.Information?(t=_,n=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(t=b,n=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),r.className=t,r.alt=n,r},_e=function(e){var t=re.getOsfControl(e.id);s.AppNotificationHelper.LogNotification(t._appCorrelationId,e.sqmDWords[0],e.sqmDWords[1])},Se=function(e){e.sqmDWords[1]|=8,_e(e),!e.reDisplay&&le(e.id,e.displayDeactive),Oe(e.id),e.reDisplay?Ee(e):xe(e.id),e.dismissCallback&&e.dismissCallback()},Ce=function(e){var t=document.createElement(z);return t.type=W,t.src=re.getLocalizedImageFilePath(ee),t.className=p,t.id=f+e.id,t.tabIndex=0,t.alt=Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT,t.setAttribute(x,d),t},Oe=function(e){var t=re.getOsfControl(e);t&&(t._controlFocus=o)},Ie=function(e){var t=re.getOsfControl(e);if(t&&!Pe(e))if(t.getStatus()===i.OsfControlStatus.Activated&&t.getPageStatus()===i.OsfControlPageStatus.Ready)t.notifyAgave(i.AgaveHostAction.TabIn);else{var n="_trySetFocusInAppContent$newCallback";if(t._notifyHostIFrameOnLoaded&&t._notifyHostIFrameOnLoaded.newCallbackIdentity&&t._notifyHostIFrameOnLoaded.newCallbackIdentity===n)return;var r=function(e){return function(){if(e)try{e()}catch(e){}t.getStatus()===i.OsfControlStatus.Activated&&t.getPageStatus()===i.OsfControlPageStatus.Ready&&t.notifyAgave(i.AgaveHostAction.TabIn),t._notifyHostIFrameOnLoaded=e}}(t._notifyHostIFrameOnLoaded);r.newCallbackIdentity=n,t._notifyHostIFrameOnLoaded=r}},Ae=function(e,t){var r=re.getOsfControl(e);if(r&&r._controlFocus)if(Pe(e)){var o=ae[e][0];if(o&&o.div)if(o.iframeNotificationUrl!=k){var a=o.div.getElementsByClassName(ie)[0];a&&(a.contentWindow.postMessage(i.AgaveHostAction.TabIn,oe),re._notifyHost&&re._notifyHost(e,i.AgaveHostAction.SelectWithError))}else{var s=o.div.querySelectorAll(n);if(s&&s.length>0){var c=s[0];c instanceof HTMLElement&&(window.focus(),c.focus(),re._notifyHost&&re._notifyHost(e,i.AgaveHostAction.SelectWithError))}}}else r.notifyAgave(t)},Te=function(e,t){var r=re.getOsfControl(e);if(r&&r._controlFocus)if(Pe(e)){var o=ae[e][0];if(o&&o.div){var a=o.div.querySelectorAll(n);if(a&&a.length>0){var s=a.length>1?a[1]:a[0];s instanceof HTMLElement&&(window.focus(),s.focus(),re._notifyHost&&re._notifyHost(e,i.AgaveHostAction.SelectWithError))}}}else r._controlFocus=u,re._notifyHost(e,t)},Ee=function(e){var t=l.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),n=t&&t.enableNewTrustPromptForAddIn;e.notificationType!==i.NotificationType.TrustPromptContent&&e.notificationType!==i.NotificationType.TrustPromptTaskpane||!n?null==e.detailView||e.detailView===u?(e.sqmDWords[1]=0,fe(e)):(e.sqmDWords[1]=1,t&&t.enableSingleSignOnForAddin?me(e):pe(e)):ge(e)},xe=function(e){if(Pe(e)){var t=ae[e][0];Ee(t)}else Ie(e)},Pe=function(e){return ae[e]&&ae[e].length>0};return{showProgress:function(e,n){try{if(i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderLoadingAnimationStart),!document.getElementById(t+n)){ae[n]=[];var r=document.createElement(J);r.setAttribute(X,K),r.setAttribute(q,t+n),r.style.backgroundColor="rgba(255, 255, 255, 0.5)",r.style.opacity=L,r.style.filter=F,r.style.height=D;var o=document.createElement(J);o.style.width=D,o.style.height=D,o.style.backgroundImage=B+re.getLocalizedImageFilePath(te)+")",o.style.backgroundRepeat=N,o.style.backgroundPosition=j,r.appendChild(o),e.appendChild(r)}i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderLoadingAnimationEnd)}catch(e){}},showNotification:function(e){e.sqmDWords=[e.errorCode,0],delete e.errorCode,null==e.highPriority&&(e.highPriority=e.infoType===i.InfoType.Error?o:u),null==e.reDisplay&&(e.reDisplay=e.infoType===i.InfoType.Error?o:u);var t=ae[e.id];void 0===t&&(t=[],ae[e.id]=t),e.highPriority===u?t.push(e):(t.splice(se,0,e),se++),(1===ae[e.id].length||e.highPriority)&&Ee(t[0])},showICon:function(e){fe(e)},removeDOMElement:function(e){ue(e)},removeProgressDiv:function(e,n){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveLoadingAnimationStart),e.ownerDocument.getElementById(t+n)&&ce(e),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveLoadingAnimationEnd)},removeIConDiv:function(e){!function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage1Start),ue("icon_"+e),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage1End)}(e)},removeInfoBarDiv:function(e,t){le(e,t)},dismissMessages:function(e){!function(e){if(ae[e]){if(ae[e].length>0){var t=ae[e][0].div;ce(t)}delete ae[e]}}(e)},getHTMLEncodedString:function(e){return function(e){var t=document.createElement(J),n=document.createTextNode(e);return t.appendChild(n),t.innerHTML}(e)},purgeOsfControlNotification:function(e){var t=ae[e],n=re.getOsfControl(e);t&&t.length>0&&n&&s.AppNotificationHelper.LogNotification(e,t[0].sqmDWords[0],t[0].sqmDWords[1])},focusOnNotificationUx:function(e,t){Oe(e),Ae(e,t)},focusOnNotificationUxShiftIn:function(e,t){Oe(e),Te(e,t)},appHasNotifications:function(e){return Pe(e)}}},function(e){var t=function(){function e(){}return e.setHostFeatureEnabledInfo=function(e){this._hostFeatureEnabledInfo=e},e.getHostFeatureEnabledInfo=function(){return this._hostFeatureEnabledInfo},e}();e.HostFeatureEnabledInfo=t}(l||(l={})),i.OUtil.setNamespace("AppSpecificSetup",i),i.ContextActivationManager=function(e){var t="0",n="osfControl for the given ID doesn't exist.",r=null,a=!0,c=!1,u=this;if(i.OUtil.validateParamObject(e,{appName:{type:Number,mayBeNull:c},appVersion:{type:String,mayBeNull:c},clientMode:{type:Number,mayBeNull:c},appUILocale:{type:String,mayBeNull:c},dataLocale:{type:String,mayBeNull:c},osfOmexBaseUrl:{type:String,mayBeNull:a},devCatalogUrl:{type:String,mayBeNull:a},oneDriveCatalogBaseApiUrl:{type:String,mayBeNull:a},sdxCdnUrl:{type:String,mayBeNull:a},sdxDmsUrl:{type:String,mayBeNull:a},spBaseUrl:{type:String,mayBeNull:a},docUrl:{type:String,mayBeNull:a},hostControl:{type:Object,mayBeNull:a},pageBaseUrl:{type:String,mayBeNull:a},lcid:{type:String,mayBeNull:a},formFactor:{type:String,mayBeNull:a},controlStatusChanged:{type:Object,mayBeNull:a},notifyHost:{type:Object,mayBeNull:a},allowExternalMarketplace:{type:Boolean,mayBeNull:a},localizedScriptsUrl:{type:String,mayBeNull:a},localizedImagesUrl:{type:String,mayBeNull:a},localizedStylesUrl:{type:String,mayBeNull:a},localizedResourcesUrl:{type:String,mayBeNull:a},trustAgaves:{type:Boolean,mayBeNull:a},enableAddinCommands:{type:Boolean,mayBeNull:a},enableBlackForestRedirect:{type:Boolean,mayBeNull:a},enableMyOrg:{type:Boolean,mayBeNull:a},enableMyApps:{type:Boolean,mayBeNull:a},enableDevCatalog:{type:Boolean,mayBeNull:a},enableOneDriveCatalog:{type:Boolean,mayBeNull:a},enablePrivateCatalog:{type:Boolean,mayBeNull:a},enableTaskpaneUpgradeToAppCommand:{type:Boolean,mayBeNull:a},enableUploadFileDevCatalog:{type:Boolean,mayBeNull:a},enableV1RedirectApis:{type:Boolean,mayBeNull:a},omexForceAnonymous:{type:Boolean,mayBeNull:a},userNameHashCode:{type:Number,mayBeNull:a},hostFullVersion:{type:String,mayBeNull:a},envCode:{type:String,mayBeNull:a},showSignOutFromPrivateCatalogMessage:{type:Boolean,mayBeNull:a},enableSingleSignOnForAddin:{type:Boolean,mayBeNull:a},enableServiceDeliveredExperience:{type:Boolean,mayBeNull:a},hideAppsExtensionUrl:{type:String,mayBeNull:a},enableInsertDialogAccessibilityFix:{type:Boolean,mayBeNull:a},disableLogging:{type:Boolean,mayBeNull:a},enableDisplayBlockedMinorError:{type:Boolean,mayBeNull:a},enableFirstPartySSO:{type:Boolean,mayBeNull:a},enableFirstPartySSOResourceCheck:{type:Boolean,mayBeNull:a},enableFirstPartyUseWopiIdentity:{type:Boolean,mayBeNull:a},disableAppsForOfficeThirdParty:{type:Boolean,mayBeNull:a},wacSessionId:{type:String,mayBeNull:a},enableFirstPartySDXErrorMessages:{type:Boolean,mayBeNull:a},isHostDocumentDomain:{type:Boolean,mayBeNull:a},enableRichApiCellEditDelay:{type:Boolean,mayBeNull:a},enableNewTrustPromptForAddIn:{type:Boolean,mayBeNull:a}},r),u._osfOmexBaseUrl=e.osfOmexBaseUrl,u._devCatalogUrl=e.devCatalogUrl,u._sdxCdnUrl=e.sdxCdnUrl,u._sdxDmsUrl=e.sdxDmsUrl,u._firstPartyManifestCDNUrl=e.firstPartyManifestCDNUrl,u._oneDriveCatalogBaseApiUrl=e.oneDriveCatalogBaseApiUrl,u._spBaseUrl=e.spBaseUrl,u._myOrgCatalogUrl=r,u._enableAddinCommands=e.enableAddinCommands||c,u._enableBlackForestRedirect=e.enableBlackForestRedirect||c,u._enableInsertDialogAccessibilityFix=e.enableInsertDialogAccessibilityFix||c,u._enableFirstPartySDXErrorMessages=e.enableFirstPartySDXErrorMessages||c,u._enableMyOrg=e.enableMyOrg||c,u._enableMyApps=e.enableMyApps||c,u._enableDevCatalog=e.enableDevCatalog||c,u._enableOneDriveCatalog=e.enableOneDriveCatalog||c,u._enablePrivateCatalog=e.enablePrivateCatalog||c,u._showSignOutFromPrivateCatalogMessage=e.showSignOutFromPrivateCatalogMessage||c,u._enableTaskpaneUpgradeToAppCommand=e.enableTaskpaneUpgradeToAppCommand||c,u._enableUploadFileDevCatalog=e.enableUploadFileDevCatalog||c,u._enableV1RedirectApis=e.enableV1RedirectApis||c,u._appName=e.appName,u._appVersion=e.appVersion,u._clientMode=e.clientMode,u._appUILocale=e.appUILocale,u._dataLocale=e.dataLocale,u._docUrl=e.docUrl,u._hostControl=e.hostControl,u._formFactor=e.formFactor||i.FormFactor.Default,u._pageBaseUrl=e.pageBaseUrl,u._lcid=e.lcid,u._controlStatusChanged=e.controlStatusChanged,u._notifyHost=e.notifyHost||function(){},u._allowExternalMarketplace=e.allowExternalMarketplace,u._localizedScriptsUrl=e.localizedScriptsUrl,u._localizedImagesUrl=e.localizedImagesUrl,u._localizedStylesUrl=e.localizedStylesUrl,u._localizedResourcesUrl=e.localizedResourcesUrl,u._autoTrusted=e.trustAgaves,u._omexForceAnonymous=e.omexForceAnonymous||c,u._userNameHashCode=e.userNameHashCode||0,u._hostFullVersion=e.hostFullVersion,u._wacHostEnvironment=e.envCode,u._enableSingleSignOnForAddin=e.enableSingleSignOnForAddin||c,u._enableFirstPartySSO=e.enableFirstPartySSO||c,u._enableFirstPartySSOResourceCheck=e.enableFirstPartySSOResourceCheck||c,u._enableFirstPartyUseWopiIdentity=e.enableFirstPartyUseWopiIdentity||c,u._enableServiceDeliveredExperience=e.enableServiceDeliveredExperience||a,u._hideAppsExtensionUrl=u._osfOmexBaseUrl+e.hideAppsExtensionUrl,u._disableLogging=e.disableLogging||c,u._enableDisplayBlockedMinorError=e.enableDisplayBlockedMinorError||c,u._disableAppsForOfficeThirdParty=e.disableAppsForOfficeThirdParty||c,u._isHostDocumentDomain=e.isHostDocumentDomain||c,u._enableRichApiCellEditDelay=e.enableRichApiCellEditDelay||c,u._loggableUserId=e.loggableUserId,u._sessionStartInfoJson=e.sessionStartInfoJson,u._enableNewTrustPromptForAddIn=e.enableNewTrustPromptForAddIn||c,l.HostFeatureEnabledInfo.setHostFeatureEnabledInfo(e),u._pageBaseUrl&&"/"!==u._pageBaseUrl.charAt(u._pageBaseUrl.length-1)&&(u._pageBaseUrl=u._pageBaseUrl+"/"),u._localizedResourcesUrl&&"/"!==u._localizedResourcesUrl.charAt(u._localizedResourcesUrl.length-1)&&(u._localizedResourcesUrl=u._localizedResourcesUrl+"/"),u._clientId=i.OUtil.getUniqueId(),u._cachedOsfControls={},u._iframeAttributeBag={},u._serviceEndPoint=r,u._serviceEndPointInternal=r,u._internalConversationId=r,u._iframeProxies={},u._iframeProxyCount=0,u._iframeNamePrefix="__officeExtensionProxy",u._webUrl=r,u._wsa=r,u._insertDialogDiv=r,u._hasPreloadedOfficeJs=c,u._contextMgrCorrelationId=e.wacSessionId||i.OUtil.Guid.generateNewGuid(),s.RuntimeTelemetryHelper.LogCommonMessageTag("_contextMgrCorrelationId :"+u._contextMgrCorrelationId,r,20194265),u._hostType=r,u._hostPlatform=r,u._hostSpecificFileVersion=r,u._requirementsChecker=new i.RequirementsChecker,u._onClickInstallOsfControl=r,u._osfOmexBaseUrl){var d,f=u._osfOmexBaseUrl.indexOf(i.Constants.ProtocolSeparator);d=f>=0?u._osfOmexBaseUrl.substr(f):i.Constants.ProtocolSeparator+u._osfOmexBaseUrl;var p=i.Constants.Https+d,m=i.Constants.Https+d;i.OUtil.getQueryStringParamValue(window.location.search,i.Constants.OmexForceAnonymousParamName).toLowerCase()==i.Constants.OmexForceAnonymousParamValue.toLowerCase()?(u._omexAuthNStatus=i.OmexAuthNStatus.Anonymous,u._omexForceAnonymous=a):u._omexAuthNStatus=i.OmexAuthNStatus.NotAttempted,u._omexGatedWSProxy={proxyUrl:p+i.Constants.OmexGatedServiceExtension,proxyName:"__omexExtensionGatedProxy",isReady:c,clientEndPoint:r,pendingCallbacks:[]},u._omexWSProxy={proxyUrl:m+i.Constants.OmexUnGatedServiceExtension,proxyName:"__omexExtensionProxy",isReady:c,clientEndPoint:r,pendingCallbacks:[]},u._omexAnonymousWSProxy={proxyUrl:p+i.Constants.OmexAnonymousServiceExtension,proxyName:"__omexExtensionAnonymousProxy",isReady:c,clientEndPoint:r,pendingCallbacks:[]},u._omexBillingMarket=r,u._omexEndPointBaseUrl=m}u._isFromWacAutomation=function(){if(void 0!==this._isFromWacAutomation&&this._isFromWacAutomation!==r)return this._isFromWacAutomation;try{for(var e=window,t=void 0;e!==t;){if(!e.location||!e.location.search)return c;if(e.location.search.toLowerCase().indexOf("automation=1")>=0)return a;t=e,e=e.parent}}catch(e){return c}return c}(),i.OsfManifestManager._setUILocale(u._appUILocale);var g=u;if(g.getContextForEmbeddingPage=function(){var e=0;if(g._hostSpecificFileVersion&&-1!=g._hostSpecificFileVersion.indexOf(".")){var t=g._hostSpecificFileVersion.split("."),n=t[1];isNaN(n)||(e=parseInt(t[1]))}var r=g._requirementsChecker._getSupportedSet();return{appName:g._appName,appVersion:g._appVersion,appUILocal:g._appUILocale,dataLocale:g._dataLocale,docUrl:g._docUrl||window.location.href,clientMode:g._clientMode,minorVersion:e,requirements:r}},u._enableServiceDeliveredExperience)var v=function(e){var t=e&&e.contextId?g.getOsfControl(e.contextId):r;switch(e.id){case i.MessageIDs.FetchBundleUrl:if(!t._agaveEndPoint){var n=t._conversationId+i.SharedConstants.NotificationConversationIdSuffix;t._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(n,t._frame.contentWindow,t._iframeUrl)}if(t._bundleUrl){var a={id:i.MessageIDs.LoadReactBundle,bundleUrl:t._bundleUrl};t.sendMessageToSdx(a)}break;case i.MessageIDs.LoadBundleSuccess:t._pageStatus=i.OsfControlPageStatus.Ready,t._contextActivationMgr._ErrorUXHelper&&t._contextActivationMgr._ErrorUXHelper.removeProgressDiv(t._div,t._id);break;case i.MessageIDs.LoadBundleError:break;default:o.msAjaxDebug.trace("MessageID: "+e.id+" onMessageFromSdx got wrong message.")}};var h=function(e,t){e.hasOwnProperty("fromInsertDialog")&&!e.fromInsertDialog||g._insertDialogDiv!=r&&2==g._insertDialogDiv.childNodes.length&&g._insertDialogDiv.removeChild(g._insertDialogDiv.lastChild);var n,a=i.OUtil.Guid.generateNewGuid(),s=new l.InsertDialogTelemetryContext(a);e.storeType==i.StoreTypeEnum.MarketPlace?n={storeType:i.StoreType.OMEX,storeLocator:g._osfOmexBaseUrl}:e.storeType==i.StoreTypeEnum.Catalog?n={storeType:i.StoreType.SPCatalog,storeLocator:g._myOrgCatalogUrl}:e.storeType==i.StoreTypeEnum.OneDrive&&(n={storeType:i.StoreType.OneDrive,storeLocator:g._oneDriveCatalogBaseApiUrl});var u=e.refresh,d={assetId:"",contentMarket:"",anonymous:c,clientEndPoint:r,clearCache:u,clearKilledApps:c,referenceInUse:n,hostType:g._hostType};if(e&&e.storeType==i.StoreTypeEnum.MarketPlace){d.clientVersion=g._getClientVersionForOmex(),d.clientVersion&&(d.clientName=g._getClientNameForOmex(),d.appVersion=g._getAppVersionForOmex());(p=l.CatalogFactory.resolve(i.StoreType.OMEX)).getEntitlementAsync(c,s,Function.createDelegate(g,function(e){if(e.status==l.DataServiceResultCode.Succeeded&&e.value){var n=e.value,o=n.length;0===o&&t({errorCode:i.InvokeResultCode.S_OK});for(var a,c={},d=[],f=0;f<o;f++)c[(a=n[f]).contentMarket]?c[a.contentMarket].push(a.assetId):c[a.contentMarket]=[a.assetId];var m=0,v=function(e,n){if(e.status==l.DataServiceResultCode.Succeeded&&e.value&&e.value.length&&e.value.length>0)for(var r=e.value,a=g.getRequirementsChecker(),s=0;s<r.length;s++){if(a.isEntitlementFromOmexSupported(r[s])){var c=[];c.push(r[s].name),c.push(r[s].assetId),c.push(r[s].description),c.push(i.OUtil.getTargetType(r[s].appSubType)),c.push(i.OUtil.normalizeAppVersion(r[s].version)),c.push(r[s].assetId),c.push(i.StoreType.OMEX),c.push(parseInt(r[s].defaultWidth)),c.push(parseInt(r[s].defaultHeight)),c.push(r[s].iconUrl),c.push(r[s].provider),c.push(n),c.push(i.StoreType.OMEX),d.push(c)}m++}if(m===o){var u={value:d,errorCode:i.InvokeResultCode.S_OK};t(u)}},h=function(e,t){p.getAppDetails(e,t,s,function(e){Function.createDelegate(g,v)(e,t)},u)};for(var y in c)h(c[y],y)}else{var b={value:r,errorCode:i.InvokeResultCode.E_USER_NOT_SIGNED_IN};t(b)}}),u)}else if(e&&e.storeType==i.StoreTypeEnum.Catalog){var f=l.CatalogFactory.resolve(i.StoreType.SPCatalog);f.myOrgCatalogUrl=g._myOrgCatalogUrl;f.getEntitlementAsync(c,s,Function.createDelegate(g,function(e){var o;if(i.OUtil.writeProfilerMark(i.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd),e.status==l.DataServiceResultCode.Succeeded&&e.value){for(var a,s=e.value,c=s.length,u=[],d=0,f=g.getRequirementsChecker(),p=0;p<c;p++)if(a=s[p],f.isEntitlementFromCorpCatalogSupported(a)){var m=[];m.push(a.Title),m.push(a.OfficeExtensionID),m.push(a.OfficeExtensionDescription),m.push(i.OfficeAppType[a.OEType]),m.push(i.OUtil.normalizeAppVersion(a.OfficeExtensionVersion)),m.push(a.OfficeExtensionID),m.push(i.StoreType.SPCatalog),m.push(parseInt(a.OfficeExtensionDefaultWidth.toString())),m.push(parseInt(a.OfficeExtensionDefaultHeight.toString())),m.push(a.OfficeExtensionIcon),m.push(a.OEProviderName),m.push(n.storeLocator),m.push(i.StoreType.SPCatalog),u.push(m),d++}o=d>0?{value:u,errorCode:i.InvokeResultCode.S_OK}:{value:r,errorCode:i.InvokeResultCode.E_CATALOG_NO_APPS}}else o=n.storeLocator?{value:r,errorCode:i.InvokeResultCode.E_GENERIC_ERROR}:{value:r,errorCode:i.InvokeResultCode.E_CATALOG_NO_APPS};t(o)}),u)}else if(e&&e.storeType==i.StoreTypeEnum.OneDrive){i.OsfManifestManager.getOneDriveEntitlementsAsync(d,function(e){var n;e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value&&(n={value:e.value.entitlements,errorCode:i.InvokeResultCode.S_OK},t(n))})}else if(e&&e.storeType==i.StoreTypeEnum.PrivateCatalog){var p;(p=l.CatalogFactory.resolve(i.StoreType.PrivateCatalog)).getEntitlementAsync(c,s,Function.createDelegate(g,function(e){if(e.status!=l.DataServiceResultCode.Unauthenticated)if(e.status===l.DataServiceResultCode.Succeeded&&e.value){var n=e.value;if(0!==n.length){var o;o=n.map(function(e){return{ProductId:e.assetId,AddInState:e.addInState,Version:e.appVersion}});var a=[];p.getAppDetails(o,"",s,Function.createDelegate(g,function(e){if(e.status===l.DataServiceResultCode.Succeeded&&e.value&&e.value.length&&0!==e.value.length){for(var n=e.value,o=g.getRequirementsChecker(),s=0;s<n.length;s++)if(o.isEntitlementFromOmexSupported(n[s])){var c=[];c.push(n[s].name),c.push(n[s].assetId),c.push(n[s].description),c.push(i.OUtil.getTargetType(n[s].appSubType)),c.push(i.OUtil.normalizeAppVersion(n[s].version)),c.push(n[s].assetId),c.push(i.StoreType.PrivateCatalog),c.push(parseInt(n[s].defaultWidth)),c.push(parseInt(n[s].defaultHeight)),c.push(n[s].iconUrl),c.push(n[s].provider),c.push(i.StoreType.PrivateCatalog),c.push(i.StoreType.PrivateCatalog),a.push(c)}t({value:a,errorCode:i.InvokeResultCode.S_OK})}else t({value:r,errorCode:i.InvokeResultCode.E_CATALOG_REQUEST_FAILED})}),u)}else t({errorCode:i.InvokeResultCode.E_CATALOG_NO_APPS})}else t({value:r,errorCode:i.InvokeResultCode.E_CATALOG_REQUEST_FAILED});else t({value:r,errorCode:i.InvokeResultCode.E_USER_NOT_SIGNED_IN})}),u)}else o.msAjaxDebug.trace("Unknown store type.")};u._onClickInstallOsfControl=function(e){if(g._enableUploadFileDevCatalog){o.msAjaxDebug.trace("onClickInstallOsfControl!");try{i.OUtil.validateParamObject(e,{manifest:{type:String,mayBeNull:c}},r);var n=new i.Manifest.Manifest(e.manifest,g.getAppUILocale()),u=n.getMarketplaceID(),d=n.getMarketplaceVersion();if(l.CatalogFactory.resolve(i.StoreType.UploadFileDevCatalog).validateAndCacheNewManifest(u,d,e.manifest,n)){var f={id:u,targetType:n.getTarget(),appVersion:d,currentStoreType:i.StoreType.UploadFileDevCatalog,storeId:"developer",assetId:u,assetStoreId:i.StoreType.UploadFileDevCatalog,width:parseInt(n.getDefaultWidth()||t),height:parseInt(n.getDefaultHeight()||t),isAddinCommands:n._isAddinCommandsManifest(i.getManifestHostType(g._hostType))};i.OUtil.validateParamObject(f,{id:{type:String,mayBeNull:c},targetType:{type:Number,mayBeNull:c},appVersion:{type:String,mayBeNull:c},width:{type:Number,mayBeNull:a},height:{type:Number,mayBeNull:a}},r),s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,f.currentStoreType,f.assetId,f.appVersion,f.targetType,f.isAddinCommands,f.width,f.height),g._notifyHost(t,i.AgaveHostAction.InsertAgave,f)}else g._notifyHost(t,i.AgaveHostAction.NotifyHostError,r)}catch(e){var p="Invalid manifest from addincommands dev catalog.";return l.WACUtils.logExceptionToBrowserConsole(p,e),s.RuntimeTelemetryHelper.LogExceptionTag(p,e,this._appCorrelationId,19203548),void g._notifyHost(t,i.AgaveHostAction.NotifyHostError,r)}}};var y=function(e){o.msAjaxDebug.trace("onClickRefreshfAddinCommands!"),g._notifyHost(t,i.AgaveHostAction.RefreshAddinCommands,e)},b=function(e){var t=i.OUtil.Guid.generateNewGuid(),n=new l.InsertDialogTelemetryContext(t),o=l.CatalogFactory.resolve(i.StoreType.OMEX),a=new l.PreCacher(g.getRequirementsChecker()),s={assetId:e.assetId,storeType:i.StoreType.OMEX,storeId:e.storeId,appVersion:"",targetType:r};o.activateAsync(s,a,n)},_=function(e,t){if(g._enableSingleSignOnForAddin)S(e,t);else{var n={assetId:e.id,clientVersion:g._getClientVersionForOmex(),clientName:g._getClientNameForOmex(),clientEndPoint:g._omexGatedWSProxy.clientEndPoint},r=g._insertDialogDiv,o={errorCode:i.InvokeResultCode.E_OEM_REMOVED_FAILED},a=i.OUtil.Guid.generateNewGuid(),u=new l.InsertDialogTelemetryContext(a);l.CatalogFactory.resolve(i.StoreType.OMEX).removeAsync([n.assetId],u,function(a){var u=0;if(a.status==l.DataServiceResultCode.Succeeded&&a.value&&a.value.removedApps&&a.value.removedApps.length>0){for(var d=a.value.removedApps,f=i.InvokeResultCode.E_OEM_REMOVED_FAILED,p=0;p<d.length;p++)if(d[p].assetId==n.assetId){d[p].result==i.OmexRemoveAppStatus.Success&&(f=i.InvokeResultCode.S_OK);break}f==i.InvokeResultCode.S_OK&&(u=g.untrustOsfControls(e)),o.errorCode=f}var m=!document.documentElement.contains(r);s.AppManagementMenuHelper.LogAppManagementMenuAction(n.assetId,i.AppManagementAction.Remove,u,m,c,o.errorCode),t(o)})}},S=function(e,n){var r=g._hideAppsExtensionUrl+"&"+i.OmexPageParameterKeys.AppName+"="+i.getModernAppVerCode(g._appName)+"&"+i.OmexPageParameterKeys.AssetId+"="+e.id+"&"+i.OmexPageParameterKeys.AppCorrelationId+"="+g._contextMgrCorrelationId,o=document.createElement("iframe");o.setAttribute("id","serviceExtensionIframe"),o.setAttribute("src",r),o.setAttribute("scrolling","auto"),o.setAttribute("border",t),o.setAttribute("width",t),o.setAttribute("height",t),o.setAttribute("style","position: absolute; left: -100px; top:0px;"),document.body.appendChild(o);var a=g._insertDialogDiv,u=function(t){if(t.source==o.contentWindow){var r={errorCode:i.InvokeResultCode.E_OEM_REMOVED_FAILED};document.body.removeChild(o),window.removeEventListener("message",u);var l=0,d=JSON.parse(t.data),f=parseInt(d[i.OmexRemoveAddinMessageKeys.RemoveAddinResultCode]),p=i.InvokeResultCode.E_OEM_REMOVED_FAILED;if(f===i.OmexRemoveAddinResultCode.Success){for(var m=d[i.OmexRemoveAddinMessageKeys.RemoveAddinResultValue],v=0;v<m.length;v++)if(m[v]==e.id){p=i.InvokeResultCode.S_OK;break}p==i.InvokeResultCode.S_OK&&(l=g.untrustOsfControls(e),C(e.id)),r.errorCode=p}var h=!document.documentElement.contains(a);s.AppManagementMenuHelper.LogAppManagementMenuAction(e.id,i.AppManagementAction.Remove,l,h,c,r.errorCode),n(r)}};window.addEventListener("message",u)},C=function(e){var t=".*",n=[];n.push(new RegExp(i.OUtil.formatString(l.WACUtils.CacheConstants.EntitlementsKey,t,t),"i")),n.push(new RegExp(i.OUtil.formatString(l.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,t,e,t,t),"i")),l.WACUtils.removeMatchesFromLocalStorage(n)};if(u._serviceEndPoint=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(u._clientId),u._serviceEndPoint._onHandleRequestError=function(e,t){var n,o,a;e&&(n=e._data)&&((o="string"==typeof(o="object"==typeof n?n[0]:n)?o:r)&&(a=g.getOsfControl(o))&&(a._pageStatus="Failed origin check"===t?i.OsfControlPageStatus.FailedOriginCheck:"Access Denied"===t?i.OsfControlPageStatus.FailedPermissionCheck:i.OsfControlPageStatus.FailedHandleRequest,s.RuntimeTelemetryHelper.LogExceptionTag(t,r,a.getCorrelationId(),19203549)))},u._serviceEndPoint.registerMethod("ContextActivationManager_getAppContextAsync",function(e,u){var l="string"==typeof e?e:"object"==typeof e&&e.length>0?e[0]:r;(!l||!u)&&s.RuntimeTelemetryHelper.LogExceptionTag("Parameter validation error in getAppContextAsync.",r,r,19203545);var d=g.getOsfControl(l);if(!d)throw o.msAjaxDebug.trace(n),s.RuntimeTelemetryHelper.LogExceptionTag("Cannot get osfControl with given ID.",r,r,19203546),o.msAjaxError.argument("contextId");s.AppLoadTimeHelper.OfficeJSLoaded(d._telemetryContext);var f=d.getEToken(),p=0;if(g._hostSpecificFileVersion&&-1!=g._hostSpecificFileVersion.indexOf(".")){var m=g._hostSpecificFileVersion.split("."),v=m[1];isNaN(v)||(p=parseInt(m[1]))}var h=g._requirementsChecker._getSupportedSet(),y=new i.OfficeAppContext(d.getMarketplaceID(),g._appName,g._appVersion,g._appUILocale,g._dataLocale,g._docUrl||window.location.href,g._clientMode,d.getSettings(),d.getReason(),d.getOsfControlType(),f,d._appCorrelationId,d.getID(),c,a,p,h,d.getHostCustomMessage(),g._hostFullVersion||i.Constants.FileVersion,window.innerHeight,window.innerWidth,d.getManifest()?d.getManifest().getDefaultDisplayName():r,d._appDomains,void 0);y._wacHostEnvironment=g._wacHostEnvironment||t,y._isFromWacAutomation=!!g._isFromWacAutomation,u(y),d._pageStatus=i.OsfControlPageStatus.Ready,d._pageIsReadyTimerExpired&&s.RuntimeTelemetryHelper.LogExceptionTag("App attempted to retrieve context after app activation error has occured.",r,d.getCorrelationId(),19203547),d._contextActivationMgr._ErrorUXHelper&&d._contextActivationMgr._ErrorUXHelper.removeProgressDiv(d._div,d._id),d._timer&&(window.clearTimeout(d._timer),d._timer=r);var b=d._conversationId+i.SharedConstants.NotificationConversationIdSuffix;d._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(b,d._frame.contentWindow,d._iframeUrl),s.AppLoadTimeHelper.ActivationEnd(d._telemetryContext)},Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPoint.registerMethod("ContextActivationManager_notifyHost",function(e){e&&2==e.length||(!e||3!=e.length||e[1]!==i.AgaveHostAction.UpdateTargetUrl&&e[1]!==i.AgaveHostAction.SendTelemetryEvent)&&o.msAjaxDebug.trace("ContextActivationManager_notifyHost params is wrong.");var t=e[0],r=e[1],a=g.getOsfControl(t);if(a)if(r===i.AgaveHostAction.TabExitShift||r===i.AgaveHostAction.ExitNoFocusableShift)g._ErrorUXHelper.focusOnNotificationUxShiftIn(t,r);else if(r===i.AgaveHostAction.UpdateTargetUrl){var s=e[2];a.checkAppDomains(s)&&a.updateAgaveEndPointTargetUrl(s)}else if(r===i.AgaveHostAction.SendTelemetryEvent){var c=e[2];a._contextActivationMgr._notifyHost(t,r,c)}else a._contextActivationMgr._notifyHost?a._contextActivationMgr._notifyHost(t,r):o.msAjaxDebug.trace("No notifyHost provided by the host.");else o.msAjaxDebug.trace(n)},Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPoint.registerMethod("ContextActivationManager_openWindowInHost",function(e){window.open(e.strUrl,e.strWindowName,e.strWindowFeatures)},Microsoft.Office.Common.InvokeType.async,c),u._enableServiceDeliveredExperience&&u._serviceEndPoint.registerMethod("Office_sendMessageToHost",v,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(u._clientId+i.Constants.EndPointInternalSuffix),u._serviceEndPointInternal.registerMethod("ContextActivationManager_getEntitlementsForInsertDialog",h,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignIn",function(e){if(e&&e.storeType!=i.StoreTypeEnum.PrivateCatalog){var n=window.location.href,o=g._osfOmexBaseUrl+i.Constants.SignInRedirectUrl+encodeURIComponent(n);window.location.assign(o)}else l.PrivateCatalogService.authenticationProxy.getSignInUrl(function(e){window.top.location.replace(e)},function(){g._notifyHost(t,i.AgaveHostAction.NotifyHostError,r)})},Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignOut",function(e){e&&e.storeType==i.StoreTypeEnum.PrivateCatalog&&l.PrivateCatalogService.SignOutUser(),y(e,r)},Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeWindowOpen",function(e){window.open(e.pageUrl)},Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInsertOsfControl",function(e){o.msAjaxDebug.trace("onClickInsertOsfControl!"),g._notifyHost(t,i.AgaveHostAction.InsertAgave,e)},Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInstallOsfControl",u._onClickInstallOsfControl,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickRefreshAddinCommands",y,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickCancelDialog",function(){o.msAjaxDebug.trace("onClickCancelDialog!"),g._notifyHost(t,i.AgaveHostAction.CancelDialog),g._internalConversationId&&(g._serviceEndPointInternal.unregisterConversation(g._internalConversationId),g._internalConversationId=r)},Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_removeAppForInsertDialog",_,Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_logTelemetryDataForInsertDialog",function(e){switch(e.datapointName){case i.DataPointNames.AppManagementMenu:i.OUtil.validateParamObject(e,{assetId:{type:String,mayBeNull:c},operationMetadata:{type:Number,mayBeNull:c},hrStatus:{type:Number,mayBeNull:c}},r),s.AppManagementMenuHelper.LogAppManagementMenuAction(e.assetId,e.operationMetadata,0,c,c,e.hrStatus);break;case i.DataPointNames.InsertionDialogSession:i.OUtil.validateParamObject(e,{assetId:{type:String,mayBeNull:c},totalSessionTime:{type:Number,mayBeNull:c},trustPageSessionTime:{type:Number,mayBeNull:c},appInserted:{type:Boolean,mayBeNull:c},lastActiveTab:{type:Number,mayBeNull:c},lastActiveTabCount:{type:Number,mayBeNull:c}},r),s.InsertionDialogSessionHelper.LogInsertionDialogSession(e.assetId,e.totalSessionTime,e.trustPageSessionTime,e.appInserted,e.lastActiveTab,e.lastActiveTabCount);break;case i.DataPointNames.UploadFileDevCatelog:i.OUtil.validateParamObject(e,{operationMetadata:{type:Number,mayBeNull:c},hrStatus:{type:Number,mayBeNull:c}},r),s.UploadFileDevCatelogHelper.LogUploadFileDevCatelogAction(this._appCorrelationId,e.operationMetadata,0,c,c,e.hrStatus);break;case i.DataPointNames.UploadFileDevCatalogUsage:i.OUtil.validateParamObject(e,{currentStoreType:{type:String,mayBeNull:c},id:{type:String,mayBeNull:a},appVersion:{type:String,mayBeNull:a},appTargetType:{type:Number,mayBeNull:c},isAppCommand:{type:String,mayBeNull:c},appSizeWidth:{type:Number,mayBeNull:a},appSizeHeight:{type:Number,mayBeNull:a}},r),s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,e.currentStoreType,e.Id,e.appVersion,e.appTargetType,e.isAppCommand,e.appSizeWidth,e.appSizeHeight)}},Microsoft.Office.Common.InvokeType.async,c),u._serviceEndPointInternal.registerMethod("ContextActivationManager_getOmexData",b,Microsoft.Office.Common.InvokeType.async,c),i.AppSpecificSetup._setupFacade(u._hostControl,u,u._serviceEndPoint,u._serviceEndPointInternal),e.hostType=u._hostType,e.spBaseUrl=u._spBaseUrl,l.CatalogFactory.setHostContext(e),u._localeStringLoadingPendingCallbacks=[],u._localizedScriptsUrl&&"null/"!=u._localizedScriptsUrl){u._loadLocaleString(Function.createDelegate(u,function(){this._ErrorUXHelper=new i._ErrorUXHelper(this)}))}u.queryEntitlementDetails=function(e){h(e,e.callbackFunc)},u._getOmexData=function(e){b(e)},u._removeAppForInsertDialog=function(e){_(e,e.callbackFunc)}},i.ContextActivationManager.prototype={insertOsfControl:function(e){var t=!0,n=!1,r=this;if(i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:n},id:{type:String,mayBeNull:n},marketplaceID:{type:String,mayBeNull:n},marketplaceVersion:{type:String,mayBeNull:n},store:{type:String,mayBeNull:n},storeType:{type:String,mayBeNull:n},alternateReference:{type:Object,mayBeNull:t},settings:{type:Object,mayBeNull:t},reason:{type:String,mayBeNull:t},osfControlType:{type:Number,mayBeNull:t},snapshotUrl:{type:String,mayBeNull:t},preactivationCallback:{type:Object,mayBeNull:t},virtualOsfControlActivationCallback:{type:Object,mayBeNull:t},isvirtualOsfControl:{type:Boolean,mayBeNull:t},isDialog:{type:Boolean,mayBeNull:t},hostCustomMessage:{type:String,mayBeNull:t},isForUILessAction:{type:Boolean,mayBeNull:t},ownerAddinAssetId:{type:String,mayBeNull:t},ownerAddinStoreType:{type:String,mayBeNull:t}},null),!r._disableAppsForOfficeThirdParty||e.storeType.toLowerCase()===i.StoreType.FirstParty.toLowerCase()){var o={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,alternateReference:e.alternateReference,settings:e.settings,reason:e.reason,osfControlType:e.osfControlType,snapshotUrl:e.snapshotUrl,contextActivationMgr:r,preactivationCallback:e.preactivationCallback,virtualOsfControlActivationCallback:e.virtualOsfControlActivationCallback,isvirtualOsfControl:e.isvirtualOsfControl,isDialog:e.isDialog,hostCustomMessage:e.hostCustomMessage,isForUILessAction:e.isForUILessAction,ownerAddinAssetId:e.ownerAddinAssetId,sourceLocationOverrideResourceId:e.sourceLocationOverrideResourceId,ownerAddinStoreType:e.ownerAddinStoreType},a=r.getSQMAgaveUsage(o.storeType,o.osfControlType,o.reason,e.marketplaceID),s=new i.OsfControl(o);s._sqmDWords[0]=a[0],s._sqmDWords[1]=a[1],s._contextActivationMgr._ErrorUXHelper&&s._contextActivationMgr._ErrorUXHelper.showProgress(s._div,s._id);return r._loadLocaleString(Function.createDelegate(r,function(){s.activate()})),s}},insertDialogControl:function(e){var t=!1;i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:t},id:{type:String,mayBeNull:t},dialogUrl:{type:String,mayBeNull:t},marketplaceID:{type:String,mayBeNull:t},marketplaceVersion:{type:String,mayBeNull:t},appDomains:{type:Array,mayBeNull:t},store:{type:String,mayBeNull:t},storeType:{type:String,mayBeNull:t},agaveName:{type:String,mayBeNull:!0}},null);var n={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,isDialog:!0,contextActivationMgr:this};new i.OsfControl(n).createIframeForDialogControl(e.agaveName,e.dialogUrl,e.appDomains)},insertBlankControlWithErrorUX:function(e,t){var n=!1,r=this;i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:n},id:{type:String,mayBeNull:n},marketplaceID:{type:String,mayBeNull:n},marketplaceVersion:{type:String,mayBeNull:n},store:{type:String,mayBeNull:n},osfControlType:{type:Number,mayBeNull:!0},storeType:{type:String,mayBeNull:n}},null);var o={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,osfControlType:e.osfControlType,contextActivationMgr:r,isvirtualOsfControl:n},a=new i.OsfControl(o);a._contextActivationMgr.registerOsfControl(a);var s=function(e,t){var r,o="",i="",a="",s=n;e.status===l.DataServiceResultCode.Succeeded&&e.value&&(o=(r=e.value).getDefaultDisplayName(),i=r.getProviderName(),a=r.getDefaultIconUrl(),s=r.isSSOAddin()),t(o,i,a,s)},c=l.OmexUtils.getOmexEndPointPageUrl(r.getOsfOmexBaseUrl(),e.marketplaceID,e.store),u=l.CatalogFactory.resolve(e.storeType.toLowerCase());if(null!=u){var d={assetId:e.marketplaceID,appVersion:e.marketplaceVersion,storeType:e.storeType,storeId:e.store,targetType:null},f=i.OmexClientNames[r._appName];u.getAndCacheManifest(d,r._storeLocator,new l.AddinCommandsTelemetryContext(a.getCorrelationId()),function(n){s(n,function(n,r,o,i){a._showTrustError(f,n,r,o,e.storeType,t,c,i)})})}},purgeDialogControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&(n._conversationId&&this._getServiceEndPoint().unregisterConversation(n._conversationId),this.unregisterOsfControl(n))},dispose:function(){var e=this;e._serviceEndPoint&&(e._serviceEndPoint.dispose(),Microsoft.Office.Common.XdmCommunicationManager.deleteServiceEndPoint(e._clientId),e._serviceEndPoint=null),e._serviceEndPointInternal&&(e._serviceEndPointInternal.dispose(),Microsoft.Office.Common.XdmCommunicationManager.deleteServiceEndPoint(e._clientId+i.Constants.EndPointInternalSuffix),e._serviceEndPointInternal=null)},setLocalizedUrl:function(e,t,n){var r=this,o=Function._validateParams(arguments,[{name:"scriptUrl",type:String,mayBeNull:!1},{name:"imageUrl",type:String,mayBeNull:!1},{name:"styleUrl",type:String,mayBeNull:!1}]);if(o)throw o;if(r._localizedScriptsUrl=e,r._localizedImagesUrl=t,r._localizedStylesUrl=n,r._localizedScriptsUrl&&"null/"!=r._localizedScriptsUrl){r._loadLocaleString(Function.createDelegate(r,function(){this._ErrorUXHelper||(this._ErrorUXHelper=new i._ErrorUXHelper(this))}))}},getOsfControlStatus:function(e){var t=this._cachedOsfControls[e];return t?t.getStatus():i.OsfControlStatus.InvalidOsfControl},activateOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&n.activate()},deActivateOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&n.deActivate()},purgeOsfControl:function(e,t){var n=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"purgeManifest",type:Boolean,mayBeNull:!1}]);if(n)throw n;var r=this._cachedOsfControls[e];void 0!==r&&r.purge(t)},purgeOsfControlNotifications:function(){for(var e in this._cachedOsfControls)this._ErrorUXHelper.purgeOsfControlNotification(e)},untrustOsfControls:function(e){var t=this,n=0,r=function(e){return function(){e.activate({hasConsent:!0})}},o=i.OUtil.formatString(i.Constants.ActivatedCacheKey,e.id.toLowerCase(),e.currentStoreType,e.storeId);for(var a in t._deleteCachedFlag(o),t._cachedOsfControls){var s=t._cachedOsfControls[a];if(s._marketplaceID.toLowerCase()==e.id.toLowerCase()){t._ErrorUXHelper.purgeOsfControlNotification(s._id),s.deActivate();var c=l.OmexUtils.getOmexEndPointPageUrl(t.getOsfOmexBaseUrl(),s._marketplaceID,e.storeId),u=i.OmexClientNames[t._appName];s._showTrustError(u,e.displayName,e.providerName,e.iconUrl,e.currentStoreType,r(s),c),n++}}return n},retryAll:function(e){var t=this;for(var n in t._cachedOsfControls){var r=t._cachedOsfControls[n];r._marketplaceID.toLowerCase()==e.toLowerCase()&&r._retryActivate&&(t._ErrorUXHelper.purgeOsfControlNotification(r._id),t._ErrorUXHelper.removeInfoBarDiv(n,!1),r._retryActivate(),r._retryActivate=null)}},getOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;return this._cachedOsfControls[e]},getOsfControls:function(){var e=[];for(var t in this._cachedOsfControls)e.push(this._cachedOsfControls[t]);return e},getOsfOmexBaseUrl:function(){return this._osfOmexBaseUrl},getAppName:function(){return this._appName},getClientMode:function(){return this._clientMode},getClientId:function(){return this._clientId},getFormFactor:function(){return this._formFactor},getDocUrl:function(){return this._docUrl},getAppUILocale:function(){return this._appUILocale},getDataLocale:function(){return this._dataLocale},getPageBaseUrl:function(){return this._pageBaseUrl},getLcid:function(){return this._lcid},isExternalMarketplaceAllowed:function(){return this._allowExternalMarketplace},isStoreDisabled:function(e){this._loadLocaleString(Function.createDelegate(this,function(){var t=l.CatalogFactory.resolve(i.StoreType.OMEX),n=i.OUtil.Guid.generateNewGuid(),r=new l.InsertDialogTelemetryContext(n);t instanceof l.OmexCatalog?t.isStoreDisabled(r,e):e({value:!1,status:200})}))},getLocalizedScriptsUrl:function(){return this._localizedScriptsUrl?this._localizedScriptsUrl:""},getLocalizedImagesUrl:function(){return this._localizedImagesUrl?this._localizedImagesUrl:""},getLocalizedStylesUrl:function(){return this._localizedStylesUrl?this._localizedStylesUrl:""},raiseOsfControlStatusChange:function(e){this._controlStatusChanged&&this._controlStatusChanged(e)},registerOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;this._cachedOsfControls[e.getID()]=e},unregisterOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;delete this._cachedOsfControls[e.getID()]},setIframeAttributeBag:function(e){this._iframeAttributeBag=e},getOmexIframeNotificationUrl:function(e,t,n){var r="&",o="=",a=this,s=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"notificationType",type:Number,mayBeNull:!1},{name:"isForSideloadAddin",type:Boolean,mayBeNull:!1}]);if(s)throw s;var c=a.getOsfControl(e);if(c){var u=a._osfOmexBaseUrl+i.Constants.OmexConsentNotificationPage+"?"+i.OmexPageParameterKeys.AppName+o+i.getModernAppVerCode(a._appName)+r+i.OmexPageParameterKeys.AppVersion+o+(a._hostFullVersion||i.Constants.FileVersion)+r+i.OmexPageParameterKeys.AppUILocale+o+a._appUILocale+r+i.OmexPageParameterKeys.AppDomain+o+window.location.origin+r+i.OmexPageParameterKeys.StoreLocator+o+c.getStoreLocator()+r+i.OmexPageParameterKeys.NotificationType+o+t+r+i.OmexPageParameterKeys.AppCorrelationId+o+c.getCorrelationId()+r+i.OmexPageParameterKeys.AuthType+o+a._getAuthTypeForHideAppsExtensionUrl();if(n){var l=c.getManifest().getWebApplicationId(),d=c.getManifest().getWebApplicationScopes();u=u+r+i.OmexPageParameterKeys.AppId+o+l+r+i.OmexPageParameterKeys.Scopes+o+encodeURIComponent(d.join(","))}else{var f=c.getOwnerAddinAssetId(),p=f||c.getMarketplaceID();u=u+r+i.OmexPageParameterKeys.AssetId+o+p}return u}return null},displayNotification:function(e){var t=null,n=!0,r=!1,o=this;i.OUtil.validateParamObject(e,{infoType:{type:Number,mayBeNull:r},id:{type:String,mayBeNull:r},title:{type:String,mayBeNull:r},description:{type:String,mayBeNull:r},url:{type:String,mayBeNull:n},icon:{type:String,mayBeNull:n},buttonTxt:{type:String,mayBeNull:n},buttonCallback:{type:Function,mayBeNull:n},dismissCallback:{type:Function,mayBeNull:n},"displayDeactive ":{type:Boolean,mayBeNull:n},highPriority:{type:Boolean,mayBeNull:n},detailView:{type:Boolean,mayBeNull:n},reDisplay:{type:Boolean,mayBeNull:n},logAsError:{type:Boolean,mayBeNull:n},errorCode:{type:Number,mayBeNull:n},retryAll:{type:Boolean,mayBeNull:n},iframeNotificationUrl:{type:String,mayBeNull:n},notificationType:{type:Number,mayBeNull:n}},t),e.errorCode||(e.errorCode=0);var a=o._cachedOsfControls[e.id];if(a)if(a._isvirtualOsfControl){if(e.errorCode==i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED||e.errorCode==i.ErrorStatusCodes.E_OEM_EXTENSION_KILLED)return void o.purgeOsfControl(e.id,n);if(null==e.highPriority&&(e.highPriority=e.infoType===i.InfoType.Error?n:r),e.highPriority===r)a._notificationParams.push(e);else{for(var c=a._notificationParams,u=0;u<c.length;u++)if(!c[u].highPriority){c.splice(u,0,e),c=t;break}c!=t&&c.push(e)}!a._isvirtualOsfControlCallbackInvoked&&a.ensureToGetVirtualOsfControlManifest(function(e){a.invokeVirtualOsfControlActivationCallback(e)}),!a._isManifestProcessedForCustomFunctions&&a.ensureToGetVirtualOsfControlManifest(function(e){a.processManifestForCustomFunctions(e)})}else{if(e.logAsError&&(s.AppLoadTimeHelper.SetErrorResult(a._telemetryContext,e.errorCode),o._notifyHostError)){var l={errorCode:e.errorCode};o._notifyHostError(e.id,i.AgaveHostAction.NotifyHostError,l)}(e.displayDeactive||e.iframeNotificationUrl!=t)&&(e.detailView=n),e.div=a._div,o._ErrorUXHelper.showNotification(e)}},dismissMessages:function(e){this._ErrorUXHelper&&this._ErrorUXHelper.dismissMessages(e)},notifyAgave:function(e,t){var n=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"actionId",type:Number,mayBeNull:!1}]);if(n)throw n;var r=this._cachedOsfControls[e];void 0!==r&&(t===i.AgaveHostAction.CtrlF6In||t===i.AgaveHostAction.TabIn||t===i.AgaveHostAction.Select?this._ErrorUXHelper.focusOnNotificationUx(e,t):t===i.AgaveHostAction.TabInShift&&r._pageStatus!==i.OsfControlPageStatus.Ready?this._ErrorUXHelper.focusOnNotificationUxShiftIn(e,t):r.notifyAgave(t))},setWSA:function(e){var t=this;t._wsa=e,t._wsa&&(t._wsa.createStreamUnobfuscated(i.SQMDataPoints.DATAID_APPSFOROFFICEUSAGE,i.BWsaStreamTypes.Static,2,i.BWsaConfig.defaultMaxStreamRows),t._wsa.createStreamUnobfuscated(i.SQMDataPoints.DATAID_APPSFOROFFICENOTIFICATIONS,i.BWsaStreamTypes.Static,4,i.BWsaConfig.defaultMaxStreamRows))},getWSA:function(){return this._wsa},getSQMAgaveUsage:function(e,t,n,r){var o,a;switch(e.toLowerCase()){case i.StoreType.OMEX:o=0;break;case i.StoreType.SPCatalog:o=1;break;case i.StoreType.FileSystem:o=2;break;case i.StoreType.Registry:o=3;break;case i.StoreType.Exchange:o=4;break;case i.StoreType.SPApp:o=5;break;case i.StoreType.FirstParty:o=6;break;case i.StoreType.Sdx:o=7;break;default:o=15}switch(t){case i.OsfControlType.DocumentLevel:a=1;break;case i.OsfControlType.ContainerLevel:a=0;break;default:a=2}var s=7;if(n&&n.toLowerCase)switch(n.toLowerCase()){case Microsoft.Office.WebExtension.InitializationReason.Inserted.toLowerCase():s=0;break;case Microsoft.Office.WebExtension.InitializationReason.DocumentOpened.toLowerCase():s=1}var c=0;0!==r.toLowerCase().indexOf("wa")&&0!==r.toLowerCase().indexOf("fa")||(c=r&&r.length>2?parseInt(r.substring(2),10):0,isNaN(c)&&(c=0));return[s<<8|a<<4|o,c]},isMyOrgReady:function(e){var t=this;if(t._enableMyOrg)if(t._spBaseUrl&&t._iframeProxies&&t._iframeProxies[t._spBaseUrl]&&t._iframeProxies[t._spBaseUrl].clientEndPoint)e({isReady:!0,clientEndPoint:t._iframeProxies[t._spBaseUrl].clientEndPoint});else{t._createSharePointIFrameProxy(t._spBaseUrl,function(t){e(t?{isReady:!0,clientEndPoint:t}:{isReady:!1})})}else e({isReady:!1})},openInputUrlDialog:function(e){var t=document.createElement("p");t.setAttribute("id","title-p"),t.textContent="DevCatalog server Url is configured in settings.xml - Enter manifest file name only (AppId.xml):",e.appendChild(t);var n=document.createElement("input");n.setAttribute("type","url"),n.setAttribute("id","url-input"),n.setAttribute("size","80"),n.setAttribute("data-lpignore","true"),e.appendChild(n);var r=this,o=function(e){var t=new i.Manifest.Manifest(e,r.getAppUILocale());!i.OsfManifestManager.hasManifest(t.getMarketplaceID(),t.getMarketplaceVersion())&&i.OsfManifestManager.cacheManifest(t.getMarketplaceID(),t.getMarketplaceVersion(),t);var n={id:t.getMarketplaceID(),targetType:t.getTarget(),appVersion:t.getMarketplaceVersion(),currentStoreType:i.StoreType.Registry,storeId:"developer",assetId:t.getMarketplaceID(),assetStoreId:i.StoreType.Registry,width:t.getDefaultWidth()||0,height:t.getDefaultHeight()||0,isAddinCommands:t._isAddinCommandsManifest(i.getManifestHostType(r._hostType))};s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,n.currentStoreType,n.id,n.appVersion,n.targetType,n.isAddinCommands,n.width,n.height),r._notifyHost("0",i.AgaveHostAction.InsertAgave,n)},a=function(e){alert("Error when requsting manifest file: "+e)},c=document.createElement("input");c.setAttribute("type","button"),c.setAttribute("value","Insert"),i.OUtil.addEventListener(c,"click",function(){i.OUtil.xhrGet(r._devCatalogUrl+"/"+n.value,o,a)}),e.appendChild(c)},launchInsertDialog:function(e,t,n){var r=null,o="100%";0!=e.childNodes.length&&e.removeChild(e.childNodes.item(0));var a,c=i.OUtil.Guid.generateNewGuid(),u=new l.InsertDialogTelemetryContext(c);if(this._enableDevCatalog){(a=document.createElement("div")).style.width=o,a.style.height="80%",e.appendChild(a);var d=document.createElement("div");d.style.width=o,d.style.height="20%",e.appendChild(d),this.openInputUrlDialog(d)}else a=e;var f=this;f._insertDialogDiv=a;var p=document.createElement("div");p.style.width=o,p.style.height=o,p.style.backgroundImage="url("+f.getLocalizedImageFilePath("progress.gif")+")",p.style.backgroundRepeat="no-repeat",p.style.backgroundPosition="center",a.appendChild(p);!function(e,t){if(f._enableMyOrg)try{i.OUtil.validateParamObject(e,{webUrl:{type:String,mayBeNull:!1}},t),f.isMyOrgReady(function(n){n.isReady?(e.clientEndPoint=n.clientEndPoint,l.CatalogFactory.resolve(i.StoreType.SPCatalog).getSPCatalogUrl(u,function(n){t({statusCode:n.status,value:n.value,context:e})})):t({statusCode:i.InvokeResultCode.E_GENERIC_ERROR,value:r,context:e})})}catch(n){return s.RuntimeTelemetryHelper.LogExceptionTag("Error when getting corporate catalog url:",n,this._appCorrelationId,34719254),void t({statusCode:i.InvokeResultCode.E_GENERIC_ERROR,value:r,context:e})}else t({statusCode:i.InvokeResultCode.E_CATALOG_NO_APPS,value:r,context:e})}({webUrl:f._spBaseUrl},function(e){var c=document.createElement("iframe");c.setAttribute("id","InsertDialog"),c.setAttribute("src","about:blank"),c.setAttribute("width",o),c.setAttribute("height",o),c.setAttribute("marginHeight","0"),c.setAttribute("marginWidth","0"),c.setAttribute("frameBorder","0"),c.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups"),"undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime&&c.setAttribute("title",Strings.OsfRuntime.L_InsertionDialogTile_TXT);var u=r,l=[];f.isStoreDisabled(function(o){var d='"}',p='], "url":"',m='{ "IsUploadFileDevCatalogEnabled":'+f._enableUploadFileDevCatalog+',"isStoreDisabled":'+o.value+',"showSignOutFromPrivateCatalogMessage":'+f._showSignOutFromPrivateCatalogMessage+',"enableInsertDialogAccessibilityFix":'+f._enableInsertDialogAccessibilityFix+',"isBlackForestRedirectEnabled":'+f._enableBlackForestRedirect+',"isHostDocumentDomain":'+f._isHostDocumentDomain+" }";if(f.isExternalMarketplaceAllowed()){var g='{ "provValues":[0,0,0,'+(f._enableMyApps?i.InvokeResultCode.S_OK.toString():i.InvokeResultCode.S_HIDE_PROVIDER.toString())+p+f._osfOmexBaseUrl+'", "client":"'+f._getClientNameForOmex()+'", "'+i.OmexPageParameterKeys.AuthType+'":'+f._getAuthTypeForHideAppsExtensionUrl()+"}";l.push('"myApp":'+g),s.RuntimeTelemetryHelper.LogCommonMessageTag("isExternalMarketplaceAllowed is true, myApp tab show firstly.",f._contextMgrCorrelationId,20194266)}if(e&&e.value!=r){if(f._enableMyOrg){f._myOrgCatalogUrl=e.value;var v='{ "provValues":[1,1,0,'+e.statusCode+p+e.value+d;l.push('"myOrg":'+v)}if(f._enableOneDriveCatalog&&-1!=document.cookie.indexOf("OneDriveCatalog=true")){f._myOneDriveCatalogUrl=e.value;var h='{ "provValues":[9,9,0,0], "url":"'+e.value+d;l.push('"myOneDrive":'+h)}}if(f._enablePrivateCatalog){var y='{"provValues":[10,10,0,0], "client":"'+f._getClientNameForOmex()+d;l.push('"privateCatalog":'+y)}l.length>0&&(u="{"+l.join(", ")+"}"),f._internalConversationId&&f._serviceEndPointInternal.unregisterConversation(f._internalConversationId);var b=f.getClientId()+"_"+f.getDocUrl(),_=i.OUtil.getFrameName(b),S=i.OUtil.generateConversationId();f._internalConversationId=i.OUtil.generateConversationId(),c.setAttribute("name",_);var C=r;n!=r&&(C='{ "navigationMode":'+n.navigationMode+', "navigationModeParameter": "'+n.assetId+'", "category":"'+n.category+d);var O="",I=[S,encodeURIComponent(window.location.href),f._appVersion,i.getAppVerCode(f._appName),f.getLcid(),i.Constants.FileVersion,encodeURIComponent(u),t,encodeURIComponent(m),encodeURIComponent(C),f._contextMgrCorrelationId];O=f._localizedResourcesUrl?f._localizedResourcesUrl+"WefGallery.htm?b="+i.Constants.FileVersion:f._pageBaseUrl+f.getLcid()+"/WefGallery.htm?b="+i.Constants.FileVersion;var A=i.OUtil.addXdmInfoAsHash(O,I.join("|"));f._serviceEndPointInternal.registerConversation(S,A),c.setAttribute("src",A),f._insertDialogDiv?(0!=a.childNodes.length&&a.removeChild(a.childNodes.item(0)),a.appendChild(c)):(a.insertBefore(c,a.firstChild),f._insertDialogDiv=a)})}),f._preloadOfficeJs()},activateAgavesBlockedBySandboxNotSupport:function(){for(var e in this._cachedOsfControls){var t=this._cachedOsfControls[e];t._status===i.OsfControlStatus.NotSandBoxSupported&&t.activate()}},setRequirementsChecker:function(e){this._requirementsChecker=e},getRequirementsChecker:function(){return this._requirementsChecker},appHasNotifications:function(e){return!!this._ErrorUXHelper&&this._ErrorUXHelper.appHasNotifications(e)},refreshOsfControl:function(e,t){var n=this;for(var r in n._cachedOsfControls)if(n._cachedOsfControls[r]&&e==n._cachedOsfControls[r]._marketplaceID&&t==n._cachedOsfControls[r]._sourceLocationOverrideResourceId){n._cachedOsfControls[r].refresh();break}},_doesUrlHaveSupportedProtocol:function(e){var t=!1;e&&(t=null!=decodeURIComponent(e).match(/^https?:\/\/.+$/gi));return t},_loadLocaleString:function(e){var t=this;if("undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime){for(var n=t._localeStringLoadingPendingCallbacks.length,r=0;r<n;r++){t._localeStringLoadingPendingCallbacks.shift()()}e()}else{t._localeStringLoadingPendingCallbacks.push(e);var o=t._localeStringLoadingPendingCallbacks;if(1===o.length){t._loadStringScript(function(){for(var e=o.length,t=0;t<e;t++){var n=o.shift();"function"==typeof n&&n()}})}}},_loadStringScript:function(e){var t=this,n=this.getLocalizedScriptsUrl();n+=i.Constants.StringResourceFile;var r=0,o=function(){var a=null;if("undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime){if(r>0){c=i.OUtil.formatString("osfruntime_strings loaded after {0} retries.",r);s.RuntimeTelemetryHelper.LogExceptionTag(c,a,a,20306077)}e()}else{if(++r<3)return void setTimeout(function(){i.OUtil.loadScript(n,o)},750*r);t._localeStringLoadingPendingCallbacks.length=0;var c=i.OUtil.formatString("The locale, {0}, provided by the host app is not supported. Url: {1}",t.getLcid(),n);s.RuntimeTelemetryHelper.LogExceptionTag(c,a,a,20306076)}};i.OUtil.loadScript(n,o)},_getServiceEndPoint:function(){return this._serviceEndPoint},_getOmexEndPointPageUrl:function(e,t){return i.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._omexEndPointBaseUrl,t,e)},_getManifestAndTargetByConversationId:function(e){for(var t in this._cachedOsfControls){var n=this._cachedOsfControls[t];if(e===n._getConversationId()){var r=n.getStoreType()==i.StoreType.FirstParty?"":n.getMarketplaceVersion();return{manifest:n.getManifest()||i.OsfManifestManager.getCachedManifest(n.getMarketplaceID()),version:r,target:n.getOsfControlType()}}}return null},_createSharePointIFrameProxy:function(e,t){var n=null,r=this;if(r._doesUrlHaveSupportedProtocol(e)){var o=e.length;"/"===e.charAt(o-1)&&(e=e.substr(0,o-1));var a=r._iframeProxies[e];if(a)a.isReady?t(a.clientEndPoint):a.pendingCallbacks.push(t);else{var c=i.OUtil.generateConversationId(),u=document.createElement("iframe");r._iframeProxyCount=r._iframeProxyCount+1;var l=r._iframeNamePrefix+r._iframeProxyCount;u.setAttribute("id",l),u.setAttribute("name",l);var d=e+"/_layouts/15/OfficeExtensionManager.aspx?"+c;d=i.OUtil.addXdmInfoAsHash(d,c+"|"+l+"|"+window.location.href),d=i.OUtil.addSerializerVersionAsHash(d,i.SerializerVersion.Browser),u.setAttribute("scrolling","auto"),u.setAttribute("border","0"),u.setAttribute("width","0"),u.setAttribute("height","0"),u.setAttribute("style","position: absolute; left: -100px; top:0px;");var f=r,p=function(t,r){var o,a=f._iframeProxies[e];if(a&&0===t&&r.status?(a.isReady=!0,o=a.clientEndPoint):(delete f._iframeProxies[e],Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(c)?(Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(c),i.OUtil.removeEventListener(u,"load",m),u.parentNode.removeChild(u)):s.RuntimeTelemetryHelper.LogExceptionTag("Unexpected error occured with SharePoint proxy.",n,n,19203550),o=n),a)for(var l=a.pendingCallbacks.length,d=0;d<l;d++){a.pendingCallbacks.shift()(o)}},m=function(){f._iframeProxies[e]&&(f._iframeProxies[e].clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(c,u.contentWindow,e),f._iframeProxies[e].clientEndPoint.invoke("OEM_isProxyReady",p,{__timeout__:2e3}))};document.body.appendChild(u),i.OUtil.addEventListener(u,"load",m),u.setAttribute("src",d),r._iframeProxies[e]={clientEndPoint:n,isReady:!1,pendingCallbacks:[t]}}}else t(n)},_getClientVersionForOmex:function(){if(this._appVersion){var e=this._appVersion.split("."),t=parseInt(e[0],10),n=parseInt(e[1],10)||0;if(!(t<=15&&n<=0)){var r=i.Constants.FileVersion.split(".");return t+"."+n+"."+r[2]+"."+r[3]}}},_getClientNameForOmex:function(){return i.OmexClientNames[this._appName]},_getAppVersionForOmex:function(){return i.OmexAppVersions[this._appName]},_setCachedFlag:function(e){var t=i.OUtil.getLocalStorage();t&&t.setItem(e,"true")},_getCachedFlag:function(e){var t=i.OUtil.getLocalStorage();if(t)return!!t.getItem(e)},_deleteCachedFlag:function(e){var t=i.OUtil.getLocalStorage();t&&t.removeItem(e)},_preloadOfficeJs:function(){var e=this;if(!e._hasPreloadedOfficeJs){var t=document.createElement("script");t.src=i.OUtil.formatString("{0}?locale={1}&host={2}&version={3}",i.Constants.PreloadOfficeJsUrl,e._appUILocale,e._appName,e._hostSpecificFileVersion),t.type="text/javascript",t.id=i.Constants.PreloadOfficeJsId,t.onerror=function(){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to connect to preload service.",null,null,19203551)},document.getElementsByTagName("head")[0].appendChild(t),e._hasPreloadedOfficeJs=!0}},_getAuthTypeForHideAppsExtensionUrl:function(){var e=i.OUtil.getQueryStringParamValue(this._hideAppsExtensionUrl,i.OmexPageParameterKeys.AuthType);return e||i.AuthType.Anonymous},isAddinCommandsAsync:function(e,t){var n=null,r=!1;i.OUtil.validateParamObject(e,{marketplaceId:{type:String,mayBeNull:r},marketplaceVersion:{type:String,mayBeNull:r},storeType:{type:String,mayBeNull:r},storeId:{type:String,mayBeNull:r},targetData:{type:Object,mayBeNull:r},clearCache:{type:Boolean,mayBeNull:!0}},n);var o=e.storeType.toLowerCase(),a={contextActivationMgr:n,referenceInUse:n},c=e.clearCache||r;try{a.referenceInUse={id:e.marketplaceId,version:e.marketplaceVersion,storeType:e.storeType,storeLocator:e.storeId},a.contextActivationMgr=this;var u=function(o){o!=n&&o.statusCode==l.DataServiceResultCode.Succeeded&&o.value!=n?t(!0,o.value._isAddinCommandsManifest(i.getManifestHostType(a.contextActivationMgr._hostType)),e):t(r,r,e)};if(i.StoreType.OMEX===o||i.StoreType.UploadFileDevCatalog===o||i.StoreType.SPCatalog===o||i.StoreType.PrivateCatalog===o){var d=l.CatalogFactory.resolve(o),f={assetId:a.referenceInUse.id,storeType:o,storeId:a.referenceInUse.storeLocator,appVersion:a.referenceInUse.version,targetType:n},p=i.OUtil.Guid.generateNewGuid(),m=new l.AddinCommandsTelemetryContext(p);d.getAndCacheManifest(f,f.storeId,m,function(e){u({statusCode:e.status,value:e.value})},c)}else t(!0,r,e)}catch(o){s.RuntimeTelemetryHelper.LogExceptionTag("Error for checking is addincommands or not",o,n,19203552),t(r,r,e)}},getManifestInvaildErrorString:function(){return Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message},getUserNameHashCode:function(){return this._userNameHashCode}},i.OsfControl=function(e){var t=null,n=!0,r=!1,o=this;i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:r},contextActivationMgr:{type:Object,mayBeNull:r},id:{type:String,mayBeNull:r},marketplaceID:{type:String,mayBeNull:r},marketplaceVersion:{type:String,mayBeNull:r},store:{type:String,mayBeNull:r},storeType:{type:String,mayBeNull:r},alternateReference:{type:Object,mayBeNull:n},settings:{type:Object,mayBeNull:n},reason:{type:String,mayBeNull:n},osfControlType:{type:Number,mayBeNull:n},snapshotUrl:{type:String,mayBeNull:n},preactivationCallback:{type:Object,mayBeNull:n},virtualOsfControlActivationCallback:{type:Object,mayBeNull:n},isvirtualOsfControl:{type:Boolean,mayBeNull:n},isDialog:{type:Boolean,mayBeNull:n},hostCustomMessage:{type:String,mayBeNull:n},isForUILessAction:{type:Boolean,mayBeNull:n},ownerAddinAssetId:{type:String,mayBeNull:n},sourceLocationOverrideResourceId:{type:String,mayBeNull:n},ownerAddinStoreType:{type:String,mayBeNull:n}},t),o._div=e.div,o._sourceLocationOverrideResourceId=e.sourceLocationOverrideResourceId,o._contextActivationMgr=e.contextActivationMgr,o._id=e.id,o._storeType=e.storeType.toLowerCase(),o._storeLocator=e.store,o._marketplaceID=e.marketplaceID,o._marketplaceVersion=e.marketplaceVersion,o._alternateReference=e.alternateReference,o._settings=e.settings||{},o._reason=null==e.reason?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:e.reason,o._osfControlType=null==e.osfControlType?i.OsfControlType.DocumentLevel:e.osfControlType,o._snapshotUrl=e.snapshotUrl,o._status=i.OsfControlStatus.NotActivated,o._notificationParams=[],o._iframeUrl=t,o._permission=t,o._conversationId=t,o._manifestUrl=t,o._pageStatus=i.OsfControlPageStatus.NotStarted,o._pageIsReadyTimerExpired=r,o._timer=t,o._retryLoadingNum=2,o._frame=t,o._agaveEndPoint=t,o._etoken="",o._sqmDWords=[0,0],o._preactivationCallback=e.preactivationCallback,o._telemetryContext={},o._controlFocus=r,o._agavePageUrl=t,o._agaveWindowName=t,o._manifest=t,o._virtualOsfControlActivationCallback=e.virtualOsfControlActivationCallback,o._isvirtualOsfControl=null==e.isvirtualOsfControl?r:e.isvirtualOsfControl,o._isvirtualOsfControlCallbackInvoked=r,o._isManifestProcessedForCustomFunctions=r,o._isDialog=null==e.isDialog?r:e.isDialog,o._hostCustomMessage=e.hostCustomMessage,o._isUpgrading=r,o._contextActivationMgr._enableServiceDeliveredExperience&&(o._bundleUrl=t,o._sdxIframeTemplateUrl="https://osf-agave/rtm/sdx/index.html"),o._isUILessAddInCommands=!!e.isForUILessAction,o._ownerAddinAssetId=e.ownerAddinAssetId?e.ownerAddinAssetId:t,o._ownerAddinStoreType=e.ownerAddinStoreType?e.ownerAddinStoreType:t,i.OUtil.isiOS()&&(o._div.style.webkitOverflowScrolling="touch",o._div.style.overflow="auto"),o._appCorrelationId=o._contextActivationMgr._contextMgrCorrelationId||i.OUtil.Guid.generateNewGuid(),o._iframeOnLoadDelegate=Function.createDelegate(o,o._iframeOnLoad),o._retryActivate=t,o._onKeyDownEventDelegate=Function.createDelegate(o,o._onKeydownEvent)},i.OsfControl.prototype={activate:function(e){var t=!0,n=null,r=this,o=r;if(r._status!==i.OsfControlStatus.Activated){try{if(r._contextActivationMgr.registerOsfControl(r),i.OUtil.addEventListener(r._div,"keydown",r._onKeyDownEventDelegate),(e=e||{}).hostType=r._contextActivationMgr._hostType,e.osfControl=e.osfControl||r,e.referenceInUse=e.referenceInUse||{id:r._marketplaceID,version:r._marketplaceVersion,storeType:r._storeType,storeLocator:r._storeLocator},e.correlationId=e.osfControl._appCorrelationId,!r._doesBrowserSupportRequiredFeatures())return r._contextActivationMgr._enableFirstPartySDXErrorMessages&&r.isFirstParty()?r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnsupportedBroswer_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,t,i.ErrorStatusCodes.E_BROWSER_VERSION):r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnsupportedBroswer_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,t,i.ErrorStatusCodes.E_BROWSER_VERSION),void r.invokePreactivationCompletedCallback();var a=document.createElement("iframe"),c="sandbox"in a;a=n;var u=!1,d=i.OUtil.getLocalStorage();if(d&&(u=d.getItem(i.Constants.IgnoreSandBoxSupport)),r._contextActivationMgr._autoTrusted&&!c&&!u)return r._contextActivationMgr._ErrorUXHelper.removeProgressDiv(r._div,r._id),r._status=i.OsfControlStatus.NotSandBoxSupported,r._contextActivationMgr._enableFirstPartySDXErrorMessages&&r.isFirstParty()?r._contextActivationMgr.displayNotification({id:r._id,infoType:i.InfoType.Warning,title:Strings.OsfRuntime.L_AppsDisabled_WRN_FirstParty,description:Strings.OsfRuntime.L_NotSandBoxSupported_ERR_FirstParty,icon:n,buttonTxt:Strings.OsfRuntime.L_EnableAppsButton_TXT_FirstParty,buttonCallback:Function.createCallback(r._activateAgavesBlockedBySandboxNotSupport,r._contextActivationMgr),url:i.Constants.IEUpgradeUrl,urlButtonTxt:Strings.OsfRuntime.L_UpgradeBrowserButton_TXT,dismissCallback:n,reDisplay:t,displayDeactive:t,errorCode:i.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport,highPriority:t}):r._contextActivationMgr.displayNotification({id:r._id,infoType:i.InfoType.Warning,title:Strings.OsfRuntime.L_AppsDisabled_WRN,description:Strings.OsfRuntime.L_NotSandBoxSupported_ERR,icon:n,buttonTxt:Strings.OsfRuntime.L_EnableAppsButton_TXT,buttonCallback:Function.createCallback(r._activateAgavesBlockedBySandboxNotSupport,r._contextActivationMgr),url:i.Constants.IEUpgradeUrl,urlButtonTxt:Strings.OsfRuntime.L_UpgradeBrowserButton_TXT,dismissCallback:n,reDisplay:t,displayDeactive:t,errorCode:i.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport,highPriority:t}),void r.invokePreactivationCompletedCallback();r.startActivate();var f=r,p=e.referenceInUse;if(p.storeType===i.StoreType.OMEX||p.storeType===i.StoreType.UploadFileDevCatalog||p.storeType===i.StoreType.SPCatalog||p.storeType===i.StoreType.PrivateCatalog||p.storeType===i.StoreType.FirstParty||p.storeType===i.StoreType.Sdx){var m=new l.OsfControlLoader(r,e.hasConsent),g=new l.ActivationTelemetryContext(r.getCorrelationId(),r._telemetryContext,r._sqmDWords[0],r._sqmDWords[1],r._id);if(p.storeType===i.StoreType.Sdx)l.SDXCatalog.activateAsync({assetId:p.id,storeId:p.storeLocator,appVersion:p.version,storeType:p.storeType,targetType:""},m,g,r._contextActivationMgr.getRequirementsChecker(),{clientId:r._contextActivationMgr._loggableUserId,sessionStartInfoJson:r._contextActivationMgr._sessionStartInfoJson});else{var v=e.noTargetType||e.osfControl.getOsfControlType()===i.OsfControlTarget.TaskPane?n:e.osfControl.getOsfControlType();l.CatalogFactory.resolve(p.storeType).activateAsync({assetId:p.id,storeId:p.storeLocator,appVersion:p.version,storeType:p.storeType,targetType:p.storeType===i.StoreType.SPCatalog?v:""},m,g)}return void r.invokePreactivationCompletedCallback()}if("1B4CD97F-DBFE-4C1A-B4C4-FC163B4F9693"===p.id&&s.RuntimeTelemetryHelper.LogCommonMessageTag("ONO_Onboarding_CorrelationId :"+r.getCorrelationId(),n,23381916),s.AppLoadTimeHelper.ActivationStart(r._telemetryContext,r._sqmDWords[0],r._sqmDWords[1],r.getCorrelationId(),r._id,i.ActivationTypes.V2Enabled),s.AppLoadTimeHelper.ServerCallStart(r._telemetryContext),p.storeType===i.StoreType.Exchange||p.storeType===i.StoreType.InMemory)i.OsfManifestManager.getManifestAsync(e,function(e){e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value&&!o._etoken&&(o._etoken=e.value.getInMemoryEToken()||""),o._onGetManifestCompleted(e)});else if(p.storeType===i.StoreType.Registry&&r._contextActivationMgr._enableDevCatalog||p.storeType===i.StoreType.HardCodedPreinstall)if(e.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.DocumentOpened){i.OUtil.xhrGet(r._contextActivationMgr._devCatalogUrl+"/"+p.id+".xml",function(t){var n=new i.Manifest.Manifest(t,f._contextActivationMgr.getAppUILocale());!i.OsfManifestManager.hasManifest(n.getMarketplaceID(),n.getMarketplaceVersion())&&i.OsfManifestManager.cacheManifest(n.getMarketplaceID(),n.getMarketplaceVersion(),n),i.OsfManifestManager.getManifestAsync(e,Function.createDelegate(f,f._onGetManifestCompleted))},function(e){alert("Error when requsting manifest file: "+e)})}else i.OsfManifestManager.getManifestAsync(e,Function.createDelegate(r,r._onGetManifestCompleted));else if(p.storeType===i.StoreType.OneDrive&&r._contextActivationMgr._enableOneDriveCatalog){var h=function(t){var n=new i.Manifest.Manifest(t,f._contextActivationMgr.getAppUILocale());i.OsfManifestManager.cacheManifest(p.id,n.getMarketplaceVersion(),n),i.OsfManifestManager.getManifestAsync(e,Function.createDelegate(f,f._onGetManifestCompleted))},y=function(){f._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(f,f._refresh),n,n,n,n,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},b=window.location.protocol+"//"+window.location.host;i.OneDriveOAuth.setHostCallbackUri(b);var _=r._contextActivationMgr._oneDriveCatalogBaseApiUrl+"/root:/Manifests/"+p.id+":/content?access_token=";i.OneDriveOAuth.getAccessToken(function(e){_+=e,i.OUtil.xhrGet(_,h,y)},function(){f._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(f,f._refresh),n,n,n,n,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)})}else p.storeType===i.StoreType.SPApp?(s.AppLoadTimeHelper.EntitlementCheckStart(r._telemetryContext),e.baseUrl=r._contextActivationMgr.getPageBaseUrl(),e.pageUrl=r._contextActivationMgr._docUrl,e.webUrl=r._contextActivationMgr._webUrl,e.appWebUrl=r._contextActivationMgr._webUrl,i.OsfManifestManager.getSPAppEntitlementsAsync(e,Function.createDelegate(r,r._onGetEntitlementsCompleted))):p.storeType===i.StoreType.FileSystem||p.storeType===i.StoreType.Registry||p.storeType===i.StoreType.HardCodedPreinstall?r._showActivationWarning(i.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,n,n,n,n,i.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType):p.storeType===i.StoreType.OneDrive?r._showActivationWarning(i.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,n,n,n,n,i.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType):r._showActivationError(i.OsfControlStatus.UnknownStore,Strings.OsfRuntime.L_AgaveUnknownStoreType_ERR,n,n,n,n,n,n,i.ErrorStatusCodes.E_MANIFEST_REFERENCE_INVALID)}catch(e){var S="Error getting app data.";l.WACUtils.logExceptionToBrowserConsole(S,e),s.RuntimeTelemetryHelper.LogExceptionTag(S,e,r.getCorrelationId(),18420419),r._contextActivationMgr._enableFirstPartySDXErrorMessages&&r.isFirstParty()?r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,n,i.ErrorStatusCodes.WAC_AgaveOsfControlActivationError):r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,n,i.ErrorStatusCodes.WAC_AgaveOsfControlActivationError)}r.invokePreactivationCompletedCallback()}else r.invokePreactivationCompletedCallback()},createIframeForDialogControl:function(e,t,n){for(var r=this;r._div.childNodes.length>0;)r._div.removeChild(r._div.childNodes.item(0));var o=r._createIframeForControl(e);r._iframeUrl=t,r._appDomains=n,r._setIframeAttribute(o,t),r._div.appendChild(o),r._contextActivationMgr.registerOsfControl(r)},deActivate:function(){var e=null,t=this;try{if(i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.DeactivationStart),t._contextActivationMgr.dismissMessages(t._id),t._retryActivate=e,t._status!==i.OsfControlStatus.NotActivated){for(t._agaveEndPoint&&(Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(t._agaveEndPoint._conversationId),t._agaveEndPoint=e),t._frame&&(i.OUtil.removeEventListener(t._frame,"load",t._iframeOnLoadDelegate),t._frame=e),t._timer&&(window.clearTimeout(t._timer),t._timer=e);t._div.childNodes.length>0;)t._div.removeChild(t._div.childNodes.item(0));t._status=i.OsfControlStatus.NotActivated,t._conversationId&&t._contextActivationMgr._getServiceEndPoint().unregisterConversation(t._conversationId),t._contextActivationMgr.raiseOsfControlStatusChange(t)}t._controlFocus=!1,i.OUtil.removeEventListener(t._div,"keydown",t._onKeyDownEventDelegate),i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.DeactivationEnd)}catch(e){var n="Deactivate failed.";l.WACUtils.logExceptionToBrowserConsole(n,e),s.RuntimeTelemetryHelper.LogExceptionTag(n,e,t.getCorrelationId(),18420420)}},startActivate:function(){var e=this;for(e._controlFocus=!0,e._pageStatus=i.OsfControlPageStatus.Loading,i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.ActivationStart),e._frame&&(i.OUtil.removeEventListener(e._frame,"load",e._iframeOnLoadDelegate),e._frame=null);e._div.childNodes.length>0;)e._div.removeChild(e._div.childNodes.item(0));e._contextActivationMgr._ErrorUXHelper.showProgress(e._div,e._id)},refresh:function(){this._refresh()},_restartActivate:function(){this.deActivate(),this.startActivate(),this.invokePreactivationCompletedCallback()},purge:function(e){var t=this,n=Function._validateParams(arguments,[{name:"purgeManifest",type:Boolean,mayBeNull:!1}]);if(n)throw n;try{t._contextActivationMgr._ErrorUXHelper.purgeOsfControlNotification(t._id),t.deActivate(),e&&i.OsfManifestManager.purgeManifest(t._marketplaceID,t._marketplaceVersion),t._contextActivationMgr.unregisterOsfControl(t)}catch(e){var r="Purge failed.";l.WACUtils.logExceptionToBrowserConsole(r,e),s.RuntimeTelemetryHelper.LogExceptionTag(r,e,t.getCorrelationId(),18420421)}},invokeVirtualOsfControlActivationCallback:function(e){var t=this;try{t._virtualOsfControlActivationCallback&&(t._virtualOsfControlActivationCallback(t,e),t._isvirtualOsfControlCallbackInvoked=!0)}catch(e){var n="invokeVirtualOsfControlActivationCallback failed.";l.WACUtils.logExceptionToBrowserConsole(n,e),s.RuntimeTelemetryHelper.LogExceptionTag(n,e,t.getCorrelationId(),36496280)}},ensureToGetVirtualOsfControlManifest:function(e){var t=null,n=this,r=n;if(n._manifest)e(n._manifest);else{var o={assetId:n._marketplaceID,appVersion:n._marketplaceVersion,storeType:n._storeType,storeId:n._storeLocator,targetType:t},a=function(n){var o=t;n.status===l.DataServiceResultCode.Succeeded&&n.value?o=n.value:r._status=i.OsfControlStatus.ActivationFailed,e(o)},s=l.CatalogFactory.resolve(o.storeType);s!=t?s.getAndCacheManifest(o,n._storeLocator,new l.AddinCommandsTelemetryContext(n.getCorrelationId()),a):(alert("AddinCommands is not supported in "+o.storeType+" store."),a({status:l.DataServiceResultCode.Failed,value:t}))}},invokePreactivationCompletedCallback:function(){this._preactivationCallback&&this._preactivationCallback()},getMarketplaceID:function(){return this._marketplaceID},getMarketplaceVersion:function(){return this._marketplaceVersion},getContainingDiv:function(){return this._div},getID:function(){return this._id},getSettings:function(){return this._settings},setSettings:function(e){this._settings=e},getReason:function(){return this._reason},getManifest:function(){return this._manifest},getOsfControlType:function(){return this._osfControlType},getSnapshotUrl:function(){return this._snapshotUrl},getStoreType:function(){return this._storeType},isFirstParty:function(){return this._storeType&&(this._storeType===i.StoreType.FirstParty||this._storeType===i.StoreType.Sdx)},updateAgaveEndPointTargetUrl:function(e){this._agaveEndPoint._targetUrl=e},getStoreLocator:function(){return this._storeLocator},getHostCustomMessage:function(){return this._hostCustomMessage},getProperty:function(e){var t=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]);if(t)throw t;return this._settings[e]},addProperty:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"value",type:String,mayBeNull:!1}]);if(n)throw n;this._settings[e]=t},removeProperty:function(e){var t=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]);if(t)throw t;delete this._settings[e]},getStatus:function(){return this._status},getPageStatus:function(){return this._pageStatus},checkAppDomains:function(e){return Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(this._appDomains,e)},getNotificationParams:function(){return this._notificationParams},removeFirstNotification:function(){this._notificationParams.shift()},getIframeUrl:function(){return this._iframeUrl},getPermission:function(){return this._permission},getTrustNoPrompt:function(){return!1},getEToken:function(){return this._etoken},getCorrelationId:function(){return this._appCorrelationId},getAgavePageUrl:function(){return this._agavePageUrl},getAgaveWindowName:function(){return this._agaveWindowName},notifyAgave:function(e){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_notifyAgave",null,e)},sendMessageToSdx:function(e,t){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_sendMessageToSdx",t,e)},isUILessAddInCommands:function(){return this._isUILessAddInCommands},getOwnerAddinAssetId:function(){return this._ownerAddinAssetId},getOwnerAddinStoreType:function(){return this._ownerAddinStoreType},_onKeydownEvent:function(e){var t="input, button, a",n=this;if(e.preventDefault=e.preventDefault||function(){e.returnValue=!1},117==e.keyCode&&(e.ctrlKey||e.metaKey)){e.preventDefault(),e.stopPropagation();var r=i.AgaveHostAction.CtrlF6Exit;e.shiftKey&&(r=i.AgaveHostAction.CtrlF6ExitShift),n._contextActivationMgr._notifyHost(n._id,r)}else if(9==e.keyCode){e.preventDefault(),e.stopPropagation();var o=n._div.querySelectorAll(t);if(0==o.length)return;i.OUtil.focusToNextTabbable(o,e.target||e.srcElement,e.shiftKey)||(e.shiftKey?n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.TabExitShift):n._agaveEndPoint?n.notifyAgave(i.AgaveHostAction.TabIn):n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.TabExit))}else if(27==e.keyCode)e.preventDefault(),n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.EscExit);else if(113==e.keyCode)e.preventDefault(),n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.F2Exit);else if(13==e.keyCode||32==e.keyCode)for(var a=n._div.querySelectorAll(t),s=0;s<a.length;s++){var c=e.target||e.srcElement;if(a[s]===c)return e.preventDefault(),e.stopPropagation(),void c.click()}else e.preventDefault(),e.stopPropagation()},_onGetEntitlementsCompleted:function(e){var t=null,n=this;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value){s.AppLoadTimeHelper.EntitlementCheckEnd(n._telemetryContext);for(var r,o=e.context.referenceInUse,a=e.value.entitlements,c=a.length,u=t,l=0;l<c;l++)(r=a[l]).OfficeExtensionID&&o.id&&r.OfficeExtensionID.toLowerCase()===o.id.toLowerCase()&&(u&&!n._lessThan(u.OfficeExtensionVersion,r.OfficeExtensionVersion)||(u=r));(r=u)?r.OfficeExtensionKillbit?n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,t,t,t,t,t,t,i.ErrorStatusCodes.E_OEM_EXTENSION_KILLED):(e.context.manifestUrl=r.EncodedAbsUrl,e.context.appInstanceId=r.AppInstanceID,e.context.productId=r.ProductID,e.context.appInstanceId?i.OsfManifestManager.getAppInstanceInfoByIdAsync(e.context,Function.createDelegate(n,n._onGetAppInstanceInfoByIdCompleted)):i.OsfManifestManager.getManifestAsync(e.context,Function.createDelegate(n,n._onGetManifestCompleted))):n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveNotExist_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createCallback(function(e){e.osfControl._refresh(e)},{clearCache:!0,referenceInUse:e.context.referenceInUse,osfControl:e.context.osfControl}),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST)}else n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetAppInstanceInfoByIdCompleted:function(e){var t=null,n=this;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value){var r=e.value,o=e.context;r.AppWebFullUrl&&(o.appWebUrl=r.AppWebFullUrl),o.clientId=r.AppPrincipalId,o.remoteAppUrl=r.RemoteAppUrl,o.appWebUrl&&o.productId?i.OsfManifestManager.getSPTokenByProductIdAsync(o,Function.createDelegate(n,n._onGetSPTokenByProductIdCompleted)):i.OsfManifestManager.getManifestAsync(o,Function.createDelegate(n,n._onGetManifestCompleted))}else n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetSPTokenByProductIdCompleted:function(e){e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value&&(this._etoken=e.value),i.OsfManifestManager.getManifestAsync(e.context,Function.createDelegate(this,this._onGetManifestCompleted))},_retryActivation:function(){var e=this;e._retryLoadingNum--,e._pageStatus===i.OsfControlPageStatus.Ready||e._retryLoadingNum<=0?(e._contextActivationMgr._ErrorUXHelper.removeProgressDiv(e._div,e._id),e._retryLoadingNum=2):e._refresh()},_iframeOnLoad:function(){var e=this;s.AppLoadTimeHelper.PageLoaded(this._telemetryContext);e._pageStatus!==i.OsfControlPageStatus.Ready?e._timer=window.setTimeout(function(){!function(e){var t=null;if(e){if(e._contextActivationMgr._ErrorUXHelper&&(i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.SelectionTimeout),e._contextActivationMgr._ErrorUXHelper.removeProgressDiv(e._div,e._id)),e._pageStatus!==i.OsfControlPageStatus.Ready)if(2===e._retryLoadingNum){var n=i.ErrorStatusCodes.WAC_AgaveActivationError;switch(e._pageStatus){case i.OsfControlPageStatus.FailedOriginCheck:n=i.ErrorStatusCodes.WAC_AgaveOriginCheckError;break;case i.OsfControlPageStatus.FailedPermissionCheck:n=i.ErrorStatusCodes.WAC_AgavePermissionCheckError;break;case i.OsfControlPageStatus.FailedHandleRequest:n=i.ErrorStatusCodes.WAC_AgaveHostHandleRequestError}e._contextActivationMgr._enableFirstPartySDXErrorMessages&&e.isFirstParty()?e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveActivationError_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,n):e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveActivationError_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,n)}else 1===e._retryLoadingNum&&(e._contextActivationMgr._enableFirstPartySDXErrorMessages&&e.isFirstParty()?e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_ActivateAttempLoading_ERR_FirstParty,Strings.OsfRuntime.L_ActivateButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,i.ErrorStatusCodes.WAC_ActivateAttempLoading):e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_ActivateAttempLoading_ERR,Strings.OsfRuntime.L_ActivateButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,i.ErrorStatusCodes.WAC_ActivateAttempLoading));else e._notifyHostIFrameOnLoaded();e._timer&&(window.clearTimeout(e._timer),e._timer=t),e._pageIsReadyTimerExpired=!0}}(e)},5e3*e._retryLoadingNum+1):e._notifyHostIFrameOnLoaded()},_isOsfControlInEmbeddingMode:function(e){var t=!1;try{t=null!=e.getContainingDiv().parentNode.parentNode.id.match(/^(m_excelEmbedRenderer_|ewaSynd).+$/gi)}catch(e){l.WACUtils.logExceptionToBrowserConsole("_isOsfControlInEmbeddingMode error.",e)}return t},_createIframeAndActivateOsfControl:function(e){var t=this._createIframeForControl(e);this._activate(t,this._iframeUrl)},_createIframeForControl:function(e){var t,n=this,r=document.createElement("iframe");for(var o in r.setAttribute("id",n._id),r.setAttribute("width","100%"),r.setAttribute("height","100%"),r.setAttribute("frameborder","0"),r.setAttribute("allowfullscreen","true"),t=n._contextActivationMgr._enableFirstPartySDXErrorMessages&&n.isFirstParty()?Strings.OsfRuntime.L_IframeTitle_TXT_FirstParty+" "+e:Strings.OsfRuntime.L_IframeTitle_TXT+" "+e,r.setAttribute("title",t),r.style.msUserSelect="element",n._setSandboxAttribute(r),n._contextActivationMgr._iframeAttributeBag)r.setAttribute(o,n._contextActivationMgr._iframeAttributeBag[o]);return n._frame=r,r},_setSandboxAttribute:function(e){e.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox"),e.setAttribute("allow","geolocation;microphone;camera")},_onGetManifestCompleted:function(e){var t=null,n=this;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value){s.AppLoadTimeHelper.ManifestRequestEnd(n._telemetryContext),s.AppLoadTimeHelper.ServerCallEnd(n._telemetryContext);var r=e.value,o=e.context,a=o.referenceInUse,c=a.storeType,u=r.getDefaultDisplayName();if(n._manifest=r,o.manifestCached&&!o.retried){var d=r.getMarketplaceVersion();if(n._lessThan(d,a.version)&&c===i.StoreType.SPApp)return void n._refresh({clearCache:!0,referenceInUse:a,osfControl:o.osfControl,retried:!0})}if(!1===r.requirementsSupported||void 0===r.requirementsSupported&&!n._contextActivationMgr.getRequirementsChecker().isManifestSupported(r)){r.requirementsSupported=!1;var f,p;return f=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,p=i.ErrorStatusCodes.WAC_AgaveRequirementsError,void n._showActivationError(i.OsfControlStatus.ActivationFailed,f,t,t,null,t,t,!0,p)}if(r.requirementsSupported=!0,n._iframeUrl=r.getDefaultSourceLocation(n._contextActivationMgr.getFormFactor()),c===i.StoreType.Sdx&&n._iframeUrl&&n.updateUrlsForSdxBundle(),n._permission=r.getPermission(),n._appDomains=r.getAppDomains(),c===i.StoreType.SPApp&&n._iframeUrl&&(o.clientId&&(n._iframeUrl=n._iframeUrl.replace(/~clientid/gi,o.clientId)),o.appWebUrl&&(n._iframeUrl=n._iframeUrl.replace(/~appweburl/gi,o.appWebUrl)),o.remoteAppUrl&&(n._iframeUrl=n._iframeUrl.replace(/~remoteappurl/gi,o.remoteAppUrl))),!n._contextActivationMgr._doesUrlHaveSupportedProtocol(n._iframeUrl))return void n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestError_ERR,t,t,t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT);n.processManifestForCustomFunctions(r),n._isvirtualOsfControl?!o.showNewerVersion&&n.invokeVirtualOsfControlActivationCallback(r):n._createIframeAndActivateOsfControl(u)}else s.RuntimeTelemetryHelper.LogExceptionTag("GetManifest failed:"+l.WACUtils.serializeObjectToString(e),t,t,18420422),n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},isCustomFunctionSandbox:function(){var e=this;if("object"==typeof e._settings&&"number"==typeof e._settings.length)for(var t=0;t<e._settings.length;t++)if("object"==typeof e._settings[t]&&"number"==typeof e._settings[t].length&&"string"==typeof e._settings[t][0]&&"string"==typeof e._settings[t][1]&&"customfunctionaddinid"==e._settings[t][0].toLowerCase())return!0;return!1},processManifestForCustomFunctions:function(e){var t=this,n=t;if((!t._isManifestProcessedForCustomFunctions||t._isUpgrading)&&(t._isManifestProcessedForCustomFunctions=!0,(t.getReason()===Microsoft.Office.WebExtension.InitializationReason.Inserted||t.getReason()===Microsoft.Office.WebExtension.InitializationReason.DocumentOpened)&&e.containsCustomFunctionsForAppHost(t._contextActivationMgr._hostType))){var r=i.getManifestHostType(t._contextActivationMgr._hostType),a=t._contextActivationMgr.getFormFactor(),s=new l.Parser.ParsingContext(r,a,null,e),c=new l.Parser.AddinCommandsManifestParser(r,a),u={assetId:t._marketplaceID,appVersion:t._marketplaceVersion,storeType:t._storeType,storeId:t._storeLocator,targetType:null},d={setErrorMessageForAddin:function(e,t){o.msAjaxDebug.trace("Error parsing app manifest: "+t)}},f=c.parseExtensions(u,e,d);if("object"==typeof f.ExtensionPoints&&"number"==typeof f.ExtensionPoints.length)for(var p=0;p<f.ExtensionPoints.length;p++)if("CustomFunctions"===f.ExtensionPoints[p].type){var m=f.ExtensionPoints[p],g=function(){var t={osfControl:n,namespace:s.resources.ShortStrings[m.namespaceResId],metadataUrl:s.resources.Urls[m.metadataResId],manifest:e._xmlProcessor.getNodeXml(e._xmlProcessor.getDocumentElement())};n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.InstallCustomFunctions,t)};t.isCustomFunctionSandbox()?(t._iframeUrl=s.resources.Urls[m.pageResId],t._isUpgrading&&g()):g();break}}},setIsUpgrading:function(e){this._isUpgrading=e},getIsUpgrading:function(){return this._isUpgrading},updateUrlsForSdxBundle:function(e){var t=this;if(t._contextActivationMgr._enableServiceDeliveredExperience){var n=".js";t._iframeUrl.substr(t._iframeUrl.length-n.length,n.length).toLowerCase()===n&&(t._bundleUrl=t._iframeUrl,t._iframeUrl=null!=e?e:t._sdxIframeTemplateUrl)}},_lessThan:function(e,t){return i.OsfManifestManager.versionLessThan(e,t)},_showTrustError:function(e,t,n,r,o,a,s,c){var u=null,l=this,d=i.OUtil.formatString(Strings.OsfRuntime.L_AgaveName_INFO,t||"");d=l._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(d);var f=i.OUtil.formatString(Strings.OsfRuntime.L_AgaveProvider_INFO,n||"");f=l._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(f);var p=i.OUtil.formatString(Strings.OsfRuntime.L_AgaveUntrusted_INFO,d,f);c=null==c?!!l.getManifest()&&l.getManifest().isSSOAddin():c;var m=Strings.OsfRuntime.L_ActivateButton_TXT,g=i.NotificationType.TrustYellowBar,v=Strings.OsfRuntime.L_AgaveNewAppTitle_TXT,h=c&&l._storeType===i.StoreType.OMEX?l._contextActivationMgr.getOmexIframeNotificationUrl(l._id,i.NotificationType.TrustYellowBar):u;l._contextActivationMgr._enableNewTrustPromptForAddIn&&(p=Strings.OsfRuntime.L_AgaveTrustAddIn_INFO,m=Strings.OsfRuntime.L_TrustButton_TXT,g=l._osfControlType===i.OsfControlType.DocumentLevel?i.NotificationType.TrustPromptContent:i.NotificationType.TrustPromptTaskpane),l._retryActivate=a,l._contextActivationMgr.displayNotification({id:l._id,infoType:i.InfoType.SecurityInfo,clientName:e,name:t||u,provider:n,title:v,description:p,icon:r||u,buttonTxt:m,buttonCallback:a,url:s||u,dismissCallback:u,reDisplay:!0,displayDeactive:!0,logAsError:!0,retryAll:!0,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_MOE_UNACTIVATED,iframeNotificationUrl:h,notificationType:g})},showConsentError:function(e,t,n){var r=this;r._retryActivate=e,r._contextActivationMgr.displayNotification({id:r._id,infoType:i.InfoType.SecurityInfo,title:"",description:"",icon:null,buttonCallback:e,dismissCallback:null,reDisplay:!0,displayDeactive:!1,retryAll:!0,errorCode:i.ErrorStatusCodes.WAC_SSOAddinRequireConsent,iframeNotificationUrl:r._contextActivationMgr.getOmexIframeNotificationUrl(r._id,t,n),notificationType:t})},_showActivationError:function(e,t,n,r,o,a,s,c,u){var l=!0,d=null,f=this;if(f._status=e,f._contextActivationMgr._enableFirstPartySDXErrorMessages&&f.isFirstParty())var p={id:f._id,infoType:i.InfoType.Error,status:e,title:s||Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty,description:t,icon:d,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||d,url:o||d,dismissCallback:a||d,reDisplay:!a&&l,displayDeactive:l,detailView:!!c&&l,logAsError:l,errorCode:u||0};else p={id:f._id,infoType:i.InfoType.Error,status:e,title:s||Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:t,icon:d,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||d,url:o||d,dismissCallback:a||d,reDisplay:!a&&l,displayDeactive:l,detailView:!!c&&l,logAsError:l,errorCode:u||0};f._contextActivationMgr.displayNotification(p),f._contextActivationMgr.raiseOsfControlStatusChange(f)},_showActivationWarning:function(e,t,n,r,o,a,s){var c=!0,u=null,l=this;if(l._status=e,l._contextActivationMgr._enableFirstPartySDXErrorMessages&&l.isFirstParty())var d={id:l._id,infoType:i.InfoType.Warning,status:e,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT_FirstParty,description:t,icon:u,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||u,url:o||u,dismissCallback:a||u,reDisplay:!a&&c,displayDeactive:c,logAsError:c,errorCode:s||0};else d={id:l._id,infoType:i.InfoType.Warning,status:e,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:t,icon:u,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||u,url:o||u,dismissCallback:a||u,reDisplay:!a&&c,displayDeactive:c,logAsError:c,errorCode:s||0};l._contextActivationMgr.displayNotification(d),l._contextActivationMgr.raiseOsfControlStatusChange(l)},_refresh:function(e){this.deActivate(),this.activate(e)},_activateAgavesBlockedBySandboxNotSupport:function(e){e.activateAgavesBlockedBySandboxNotSupport();var t=i.OUtil.getLocalStorage();t&&t.setItem(i.Constants.IgnoreSandBoxSupport,"true")},_setCachedFlag:function(e){this._contextActivationMgr._setCachedFlag(e)},_getCachedFlag:function(e){return this._contextActivationMgr._getCachedFlag(e)},_deleteCachedFlag:function(e){this._contextActivationMgr._deleteCachedFlag(e)},_notifyHostIFrameOnLoaded:function(){this._contextActivationMgr._notifyHost&&this._contextActivationMgr._notifyHost(this._id,i.AgaveHostAction.PageIsReady)},_addETokenAsQueryParameter:function(e){var t=document.createElement("a");t.href=e;var n=this.getEToken(),r=i.Constants.ETokenParameterName+"="+encodeURIComponent(i.OUtil.encodeBase64(n)),o=t.search.length>1?t.search.substr(1)+"&":"";t.search=o+r;var a=t.href;return t=null,a},_activate:function(e,t){var n=this;s.AppLoadTimeHelper.PageStart(n._telemetryContext),n._setIframeAttribute(e,t),n._pageIsReadyTimerExpired=!1,i.OUtil.addEventListener(e,"load",n._iframeOnLoadDelegate),n._div.appendChild(e),n._status=i.OsfControlStatus.Activated,i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.ActivationEnd),n._contextActivationMgr.raiseOsfControlStatusChange(n),s.AppLoadTimeHelper.OfficeJSStartToLoad(n._telemetryContext)},_setIframeAttribute:function(e,t){var n=this;t=n._addETokenAsQueryParameter(t);var r=n._contextActivationMgr.getClientId()+"_"+n._contextActivationMgr.getDocUrl()+"_"+n._id,o=i.OUtil.getFrameName(r);n._conversationId=i.OUtil.generateConversationId();var a=[n._contextActivationMgr._hostType,n._contextActivationMgr._hostPlatform,n._contextActivationMgr._hostSpecificFileVersion,n._contextActivationMgr._appUILocale,n.getCorrelationId(),n._isDialog?"isDialog":null,n._contextActivationMgr._disableLogging?"disableLogging":null].join("|"),s=t,c=window.location.href,u=n._conversationId+"|"+n._id+"|"+(c.indexOf("$")>=0?encodeURIComponent(c):c),d={};d[i.WindowNameItemKeys.BaseFrameName]=o,d[i.WindowNameItemKeys.HostInfo]=a,d[i.WindowNameItemKeys.XdmInfo]=u,d[i.WindowNameItemKeys.SerializerVersion]=i.SerializerVersion.Browser;var f=i.OUtil.getLocalStorage();if(f){var p="CustomFunctionsRuntimeLogging",m=f.getItem(p);m&&(d[p]=m)}n._contextActivationMgr._getServiceEndPoint().registerConversation(n._conversationId,s,n._appDomains),e.setAttribute("src",s),n._agaveWindowName=l.WACUtils.serializeObjectToString(d),e.setAttribute("name",n._agaveWindowName),i.OUtil.addClass(e,"AddinIframe"),n._agavePageUrl=s},_getConversationId:function(){return this._conversationId},_doesBrowserSupportRequiredFeatures:function(){var e=!1;if(Object.defineProperty)try{Object.defineProperty({},"myTestProperty",{get:function(){return this.desc},set:function(e){this.desc=e}}),e=!0}catch(e){}return e},_isAddinCommands:function(e){var t=this;if(t._isvirtualOsfControl)e(!0);else if(t._contextActivationMgr._enableAddinCommands&&t._contextActivationMgr._enableTaskpaneUpgradeToAppCommand&&null!=t._virtualOsfControlActivationCallback){var n={marketplaceId:t._marketplaceID,marketplaceVersion:t._marketplaceVersion,storeType:t._storeType,storeId:t._storeLocator,targetData:{}};t._contextActivationMgr.isAddinCommandsAsync(n,function(t,n){e(n)})}else e(!1)}},i.OUtil.setNamespace("Manifest",i),i.Manifest.HostApp=function(e){this._appName=e,this._minVersion=null},i.Manifest.HostApp.prototype={getAppName:function(){return this._appName},getMinVersion:function(){return this._minVersion},_setMinVersion:function(e){this._minVersion=e}},i.Manifest.ExtensionSettings=function(){this._sourceLocations={},this._defaultHeight=null,this._defaultWidth=null},i.Manifest.ExtensionSettings.prototype={getDefaultHeight:function(){return this._defaultHeight},getDefaultWidth:function(){return this._defaultWidth},getSourceLocations:function(){return this._sourceLocations},_addSourceLocation:function(e,t){this._sourceLocations[e.toLocaleLowerCase()]=t},_setDefaultWidth:function(e){this._defaultWidth=e},_setDefaultHeight:function(e){this._defaultHeight=e}},i.Manifest.WebAppInfoAuthorization=function(){this._resource=null,this._scopes=null},i.Manifest.WebAppInfoAuthorization.prototype={getResource:function(){return this._resource},getScopes:function(){return this._scopes}},i.Manifest.Manifest=function(e,t){var n="o:OfficeApp",r="1.1",a=this;if(a._UILocale=t||"en-us","string"==typeof e){var s;a._displayNames={},a._descriptions={},a._iconUrls={},a._extensionSettings={},a._highResolutionIconUrls={},a._xmlProcessor=new i.XmlProcessor(e,i.ManifestNamespaces[r]),a._xmlProcessor.selectSingleNode(n)?(s=function(){var e=this,t=e._xmlProcessor.selectSingleNode("o:Hosts",u);e._hosts=e._parseHosts(t),t&&(e._hostsXml=t.xml||t.outerHTML);t=e._xmlProcessor.selectSingleNode("o:Requirements",u),e._requirements=e._parseRequirements(t),t&&(e._requirementsXml=t.xml||t.outerHTML);(t=e._xmlProcessor.selectSingleNode("o:HighResolutionIconUrl",u))&&e._parseLocaleAwareSettings(t,Function.createDelegate(e,e._addHighResolutionIconUrl))},a._manifestSchemaVersion=i.ManifestSchemaVersion[r]):(a._xmlProcessor=new i.XmlProcessor(e,i.ManifestNamespaces["1.0"]),s=function(){var e=this,t=e._xmlProcessor.selectSingleNode("o:Capabilities",u),n=e._xmlProcessor.selectNodes("o:Capability",t);e._capabilities=e._parseCapabilities(n)},a._manifestSchemaVersion=i.ManifestSchemaVersion["1.0"]);var c=a._xmlProcessor.getDocumentElement();a._target=i.OUtil.parseEnum(c.getAttribute("xsi:type"),i.OfficeAppType);var u=a._xmlProcessor.selectSingleNode(n);if(c=a._xmlProcessor.selectSingleNode("o:Id",u),a._id=a._xmlProcessor.getNodeValue(c),!new RegExp("^[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}$","i").test(a._id))throw o.msAjaxError.argument("Manifest");if(c=a._xmlProcessor.selectSingleNode("o:Version",u),a._version=a._xmlProcessor.getNodeValue(c),c=a._xmlProcessor.selectSingleNode("o:ProviderName",u),a._providerName=a._xmlProcessor.getNodeValue(c),c=a._xmlProcessor.selectSingleNode("o:IdIssuer",u),a._idIssuer=a._parseIdIssuer(c),(c=a._xmlProcessor.selectSingleNode("o:AlternateId",u))&&(a._alternateId=a._xmlProcessor.getNodeValue(c)),c=a._xmlProcessor.selectSingleNode("o:DefaultLocale",u),a._defaultLocale=a._xmlProcessor.getNodeValue(c),c=a._xmlProcessor.selectSingleNode("o:DisplayName",u),a._parseLocaleAwareSettings(c,Function.createDelegate(a,a._addDisplayName)),c=a._xmlProcessor.selectSingleNode("o:Description",u),a._parseLocaleAwareSettings(c,Function.createDelegate(a,a._addDescription)),c=a._xmlProcessor.selectSingleNode("o:AppDomains",u),a._appDomains=a._parseAppDomains(c),(c=a._xmlProcessor.selectSingleNode("o:IconUrl",u))&&a._parseLocaleAwareSettings(c,Function.createDelegate(a,a._addIconUrl)),(c=a._xmlProcessor.selectSingleNode("o:Signature",u))&&(a._signature=a._xmlProcessor.getNodeValue(c)),a._parseExtensionSettings(),c=a._xmlProcessor.selectSingleNode("o:Permissions",u),a._permissions=a._parsePermission(c),a._allowSnapshot=!0,(c=a._xmlProcessor.selectSingleNode("o:AllowSnapshot",u))&&(a._allowSnapshot=a._parseBooleanNode(c)),a._manifestSchemaVersion===i.ManifestSchemaVersion[r]){var l="ov:";if(a._target==i.OfficeAppType.ContentApp&&(l="c:"),c=a._xmlProcessor.selectSingleNode(l+"VersionOverrides",u)){var d=a._xmlProcessor.selectSingleNode(l+"WebApplicationInfo",c);if(d){var f=a._xmlProcessor.selectSingleNode(l+"Resource",d);a._webApplicationResource=a._xmlProcessor.getNodeValue(f);var p=a._xmlProcessor.selectSingleNode(l+"Id",d);a._webApplicationId=a._xmlProcessor.getNodeValue(p);var m=a._xmlProcessor.selectSingleNode(l+"Scopes",d);a._webApplicationScopes=a._parseWebApplicationScopes(m,l),a._webApplicationAuthorizations=a._parseWebAppInfoAuthorizations(d,l)}}}if(a._manifestSchemaVersion===i.ManifestSchemaVersion[r]){var g=a._xmlProcessor.selectSingleNode("ov:VersionOverrides",u);g&&(a._manifestSourceLocationOverrides=a._parseSourceLocationOverrides(g))}s.apply(a)}else e(a)},i.Manifest.Manifest.prototype={getSourceLocationOverrideByResourceId:function(e){return e&&this._manifestSourceLocationOverrides?this._manifestSourceLocationOverrides[e]:null},getManifestSchemaVersion:function(){return this._manifestSchemaVersion},getMarketplaceID:function(){return this._id},getMarketplaceVersion:function(){return this._version},getDefaultLocale:function(){return this._defaultLocale},getProviderName:function(){return this._providerName},getIdIssuer:function(){return this._idIssuer},getAlternateId:function(){return this._alternateId},getSignature:function(){return this._signature},getCapabilities:function(){return this._capabilities},getDisplayName:function(e){return this._displayNames[e.toLocaleLowerCase()]},getDefaultDisplayName:function(){return this._getDefaultValue(this._displayNames)},getDescription:function(e){return this._descriptions[e]},getDefaultDescription:function(){return this._getDefaultValue(this._descriptions)},getIconUrl:function(e){return this._iconUrls[e]},getDefaultIconUrl:function(){return this._getDefaultValue(this._iconUrls)},getSourceLocation:function(e,t){return this._getExtensionSetting(t).getSourceLocations()[e.toLocaleLowerCase()]},getDefaultSourceLocation:function(e){var t=this._getExtensionSetting(e).getSourceLocations();return this._getDefaultValue(t)},getDefaultWidth:function(e){return this._getExtensionSetting(e).getDefaultWidth()},getDefaultHeight:function(e){return this._getExtensionSetting(e).getDefaultHeight()},getTarget:function(){return this._target},getOmexTargetCode:function(){switch(this._target){case i.OfficeAppType.ContentApp:return 2;case i.OfficeAppType.TaskPaneApp:return 1;case i.OfficeAppType.MailApp:return 3;default:return 0}},getPermission:function(){return this._permissions},hasPermission:function(e){return(this._permissions&e)===e},getHosts:function(){return this._hosts},getHostsXml:function(){return this._hostsXml},getRequirements:function(){return this._requirements},getRequirementsXml:function(){return this._requirementsXml},getHighResolutionIconUrl:function(e){return this._highResolutionIconUrls[e]},getDefaultHighResolutionIconUrl:function(){return this._getDefaultValue(this._highResolutionIconUrls)},getAppDomains:function(){return this._appDomains},getInMemoryEToken:function(){return this._inMemoryEToken},isAllowSnapshot:function(){return this._allowSnapshot},addManifestUrl:function(e){var t=l.WACUtils.getDomainForUrl(e);-1===this._appDomains.indexOf(t)&&this._appDomains.push(t)},getWebApplicationResource:function(){return this._webApplicationResource},getWebApplicationId:function(){return this._webApplicationId},getWebApplicationScopes:function(){return this._webApplicationScopes},getWebApplicationAuthorizations:function(){return this._webApplicationAuthorizations},isSSOAddin:function(){return!!this._webApplicationResource&&!!this._webApplicationId},containsAddinCommands:function(e){var t=this._getCurrentHostTypeNode(e);if(null!==t&&null!=this._xmlProcessor.selectSingleNode("ov:DesktopFormFactor",t))return!0;return!1},containsCustomFunctions:function(e){var t=this._getCurrentHostTypeNode(e);if(null!==t){var n=this._xmlProcessor.selectSingleNode("ov:AllFormFactors",t);if(null!==n){var r=this._xmlProcessor.selectNodes("ov:ExtensionPoint",n);if(null!==r)for(var o=r.length,i=0;i<o;i++){if("CustomFunctions"===r[i].getAttribute("xsi:type"))return!0}}}return!1},containsCustomFunctionsForAppHost:function(e){var t=i.getManifestHostType(e);return e!=i.HostType.Outlook&&this.containsCustomFunctions(t)},_getDefaultValue:function(e){var t,n=this;if(n._UILocale&&(t=e[n._UILocale]||e[n._UILocale.toLocaleLowerCase()]||void 0),!t&&n._defaultLocale&&(t=e[n._defaultLocale]||e[n._defaultLocale.toLocaleLowerCase()]||void 0),!t){var r;for(var o in e){r=o;break}t=e[r]}return t},_getExtensionSetting:function(e){var t,n=this;if(void 0!==n._extensionSettings[e])t=n._extensionSettings[e];else for(var r in n._extensionSettings){t=n._extensionSettings[r];break}return t},_addDisplayName:function(e,t){this._displayNames[e.toLocaleLowerCase()]=t},_addDescription:function(e,t){this._descriptions[e]=t},_addIconUrl:function(e,t){this._iconUrls[e]=t},_parseLocaleAwareSettings:function(e,t){if(!e)throw o.msAjaxError.argument("Manifest");var n=e.getAttribute("DefaultValue");t(this._defaultLocale,n);var r=this._xmlProcessor.selectNodes("o:Override",e);if(r)for(var i=r.length,a=0;a<i;a++){var s=r[a];t(s.getAttribute("Locale"),s.getAttribute("Value"))}},_parseBooleanNode:function(e){if(e){var t=this._xmlProcessor.getNodeValue(e).toLowerCase();return"true"===t||"1"===t}return!1},_parseIdIssuer:function(e){if(e){var t=this._xmlProcessor.getNodeValue(e);return i.OUtil.parseEnum(t,i.ManifestIdIssuer)}return i.ManifestIdIssuer.Custom},_parseCapabilities:function(e){for(var t,n=[],r=0;r<e.length;r++){t=e[r].getAttribute("Name"),t=i.OUtil.parseEnum(t,i.Capability),n.push(t)}return n},_parsePermission:function(e){if(!e)throw o.msAjaxError.argument("Manifest");var t=this._xmlProcessor.getNodeValue(e);return i.OUtil.parseEnum(t,i.OsfControlPermission)},_parseExtensionSettings:function(){var e,t,n,r=this,a=r;for(var s in i.FormFactor){var c=r._xmlProcessor.selectSingleNode("o:OfficeApp");if(t=r._xmlProcessor.selectSingleNode("o:"+i.FormFactor[s],c)){e=new i.Manifest.ExtensionSettings,n=r._xmlProcessor.selectSingleNode("o:SourceLocation",t);r._parseLocaleAwareSettings(n,function(t,n){e._addSourceLocation(t,n),a.addManifestUrl(n)}),(n=r._xmlProcessor.selectSingleNode("o:RequestedWidth",t))&&e._setDefaultWidth(r._xmlProcessor.getNodeValue(n)),(n=r._xmlProcessor.selectSingleNode("o:RequestedHeight",t))&&e._setDefaultHeight(r._xmlProcessor.getNodeValue(n)),r._extensionSettings[s]=e}}if(!e)throw o.msAjaxError.argument("Manifest")},_parseHosts:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:Host",e),r=0;r<n.length;r++)t.push(n[r].getAttribute("Name"));return t},_parseWebApplicationScopes:function(e,t){var n=[];if(e)for(var r=this._xmlProcessor.selectNodes(t+"Scope",e),o=0;o<r.length;o++)n.push(this._xmlProcessor.getNodeValue(r[o]));return n},_parseWebAppInfoAuthorizations:function(e,t){var n=this,r=[],o=n._xmlProcessor.selectSingleNode(t+"Authorizations",e);if(o){var a=n._xmlProcessor.selectNodes(t+"Authorization",o);if(a)for(var s in a){var c=a[s],u=new i.Manifest.WebAppInfoAuthorization,l=n._xmlProcessor.selectSingleNode(t+"Resource",c);l&&(u._resource=n._xmlProcessor.getNodeValue(l));var d=n._xmlProcessor.selectSingleNode(t+"Scopes",c);if(d){var f=n._xmlProcessor.selectNodes(t+"Scope",d);if(f){var p=[];for(var m in f){var g=f[m];p.push(n._xmlProcessor.getNodeValue(g))}u._scopes=p}}r.push(u)}}return r},_parseRequirements:function(e){var t=this,n={sets:[],methods:[]};if(e){var r=t._xmlProcessor.selectSingleNode("o:Sets",e);n.sets=t._parseSets(r);var o=t._xmlProcessor.selectSingleNode("o:Methods",e);n.methods=t._parseMethods(o)}return n},_parseSets:function(e){var t=[];if(e)for(var n=e.getAttribute("DefaultMinVersion"),r=this._xmlProcessor.selectNodes("o:Set",e),o=0;o<r.length;o++){var i=r[o],a=i.getAttribute("MinVersion");t.push({name:i.getAttribute("Name"),version:a||n})}return t},_parseMethods:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:Method",e),r=0;r<n.length;r++)t.push(n[r].getAttribute("Name"));return t},_parseSourceLocationOverrides:function(e){var t={};if(e){var n=this._xmlProcessor.selectSingleNode("ov:Resources",e);if(n){var r=this._xmlProcessor.selectSingleNode("bt:Urls",n);if(r){var o=this._xmlProcessor.selectNodes("bt:Url",r);if(o)for(var i=0;i<o.length;i++){var a=o[i],s=a.getAttribute("id"),c=a.getAttribute("DefaultValue");s&&c&&(t[s]=c)}}}}return t},_parseAppDomains:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:AppDomain",e),r=0;r<n.length;r++){var o=l.WACUtils.getDomainForUrl(this._xmlProcessor.getNodeValue(n[r]));-1===t.indexOf(o)&&t.push(o)}return t},_addHighResolutionIconUrl:function(e,t){this._highResolutionIconUrls[e]=t},_isAddinCommandsManifest:function(e){return this.containsAddinCommands(e)||this.containsCustomFunctions(e)},_getCurrentHostTypeNode:function(e){var t=null,n=this,r=n._xmlProcessor.selectSingleNode("o:OfficeApp");if(r!==t&&n.getManifestSchemaVersion()===i.ManifestSchemaVersion[1.1]){var o=n._xmlProcessor.selectSingleNode("ov:VersionOverrides",r);if(o!==t){var a=n._xmlProcessor.selectSingleNode("ov:Hosts",o);if(a!==t){var s=n._xmlProcessor.selectNodes("ov:Host",a);if(s!==t)for(var c=s.length,u=0;u<c;u++){if(s[u].getAttribute("xsi:type")===e)return s[u]}}}}return t}},i.OsfManifestManager=function(){var e="undefined",t="marketplaceVersion",n="marketplaceID",r=null,o=!0,a=!1,c={},u="en-us",d={};function f(e,t){return e+"_"+t}return{getManifestAsync:function(e,t){i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a}},t);var n=e.referenceInUse,u=f(n.id,n.version),d=c[u];if(e.manifestCached=a,d)e.manifestCached=o,t({statusCode:i.ProxyCallStatusCode.Succeeded,value:d,context:e});else if(e.clientEndPoint&&e.manifestUrl){s.AppLoadTimeHelper.ManifestRequestStart(e.osfControl._telemetryContext);var p={manifestUrl:e.manifestUrl,id:n.id,version:n.version,clearCache:e.clearCache||a};this._invokeProxyMethodAsync(e,"OEM_getManifestAsync",function(e){var a;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value)try{var c;a=e.context.osfControl,"string"==typeof e.value?(e.context.manifestCached=o,c=e.value):(e.context.manifestCached=e.value.cached,c=e.value.manifest),s.AppLoadTimeHelper.SetManifestDataCachedFlag(a._telemetryContext,e.value.cached),e.value=new i.Manifest.Manifest(c,a._contextActivationMgr.getAppUILocale()),i.OsfManifestManager.cacheManifest(n.id,n.version,e.value)}catch(t){var u;e.value=r,a&&(u=a._appCorrelationId);var d="Invalid manifest in getManifestAsync.";l.WACUtils.logExceptionToBrowserConsole(d,t),s.RuntimeTelemetryHelper.LogExceptionTag(d,t,u,18420423)}else s.RuntimeTelemetryHelper.LogExceptionTag("getManifestAsync failed:"+l.WACUtils.serializeObjectToString(e),r,r,18420424);t(e)},p)}else t({statusCode:i.ProxyCallStatusCode.Failed,value:r,context:e})},getAppInstanceInfoByIdAsync:function(e,t){i.OUtil.validateParamObject(e,{webUrl:{type:String,mayBeNull:a},appInstanceId:{type:String,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a}},t);var n={webUrl:e.webUrl,appInstanceId:e.appInstanceId,clearCache:e.clearCache||a};this._invokeProxyMethodAsync(e,"OEM_getSPAppInstanceInfoByIdAsync",t,n)},getSPTokenByProductIdAsync:function(e,t){i.OUtil.validateParamObject(e,{appWebUrl:{type:String,mayBeNull:a},productId:{type:String,mayBeNull:a}},t);var n=this;e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.appWebUrl,function(o){if(o){var s={webUrl:e.appWebUrl,productId:e.productId,clearCache:e.clearCache||a,clientEndPoint:o};n._invokeProxyMethodAsync(e,"OEM_getSPTokenByProductIdAsync",t,s)}else t({statusCode:i.ProxyCallStatusCode.ProxyNotReady,value:r,context:e})})},getSPAppEntitlementsAsync:function(e,t){var n="/";if(i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},baseUrl:{type:String,mayBeNull:a},pageUrl:{type:String,mayBeNull:a},webUrl:{type:String,mayBeNull:o}},t),e.webUrl)this.getCorporateCatalogEntitlementsAsync(e,t);else{var s=document.createElement("a");s.href=e.pageUrl;var c=s.pathname,u=c.split(n),l=u.length-1,d=s.href.substring(0,s.href.length-c.length);d&&d.charAt(d.length-1)!==n&&(d+=n);for(var f=[d],p=0;p<l;p++)u[p]&&(d=d+u[p]+n,f.push(d));s=r;var m=this,g=e.osfControl._contextActivationMgr,v=f.pop(),h=function(e){if(e.statusCode===i.ProxyCallStatusCode.Succeeded){var r=e.value;r&&r.charAt(r.length-1)!==n&&(r+=n),g._webUrl=r,e.context.webUrl=r,e.context.appWebUrl=r,m.getCorporateCatalogEntitlementsAsync(e.context,t)}else t(e)},y=function(n){if(n){e.clientEndPoint=n;var o={pageUrl:e.pageUrl,baseUrl:v,clearCache:e.clearCache||a};m._invokeProxyMethodAsync(e,"OEM_getSPAppWebUrlFromPageUrlAsync",h,o)}else f.length>0?(v=f.pop(),g._createSharePointIFrameProxy(v,y)):t({statusCode:i.ProxyCallStatusCode.Failed,value:r,context:e})};g._createSharePointIFrameProxy(v,y)}},getOneDriveEntitlementsAsync:function(e,t){var n="Content-Type",r=e.referenceInUse.storeLocator,o=e.referenceInUse.storeLocator+"/root:/Manifests",a=i.OneDriveOAuth.getAccessTokenFromCookie(),s="?access_token="+a,c=o+s,u=new XMLHttpRequest,l=new XMLHttpRequest;u.onreadystatechange=function(){if(4==u.readyState&&200==u.status){var t=JSON.parse(u.response).id,r=e.referenceInUse.storeLocator+"/items/"+t+"/children"+s;l.open("GET",r),l.setRequestHeader(n,"json"),l.send()}};var d=[],f=0,p=0,m=function(){f==p&&t({statusCode:i.ProxyCallStatusCode.Succeeded,value:{entitlements:d},context:e})},g=function(e,t){p++;var n=t;try{var r=new i.Manifest.Manifest(e.responseText),o=[];o.push(r.getDefaultDisplayName()),o.push(n),o.push(r.getDefaultDescription()),o.push(r.getTarget()),o.push(r.getMarketplaceVersion()),o.push(n),o.push(i.StoreType.OneDrive),o.push(r.getDefaultWidth()||0),o.push(r.getDefaultHeight()||0),o.push(r.getDefaultIconUrl()),o.push(r.getProviderName()),o.push(r.getDefaultLocale()),o.push(i.StoreType.OneDrive),d.push(o)}catch(e){}m()},v=function(){p++,m()};l.onreadystatechange=function(){if(4==l.readyState&&200==l.status){for(var e=JSON.parse(l.responseText),t=0;t<e.value.length;t++)if(".xml"==e.value[t].name.substr(e.value[t].name.length-4).toLowerCase()){var n=r+"/root:/Manifests/"+e.value[t].name+":/content?access_token="+a;i.OUtil.xhrGetFull(n,e.value[t].name,g,v),f++}m()}},u.open("GET",c),u.setRequestHeader(n,"json"),u.send()},getCorporateCatalogEntitlementsAsync:function(e,t){i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},webUrl:{type:String,mayBeNull:a}},t),s.AppLoadTimeHelper.AuthenticationStart(e.osfControl._telemetryContext);var n=this,c=0,u=function(l){if(l){s.AppLoadTimeHelper.AuthenticationEnd(e.osfControl._telemetryContext),e.clientEndPoint=l;var d={webUrl:e.webUrl,applicationName:i.HostCapability[e.hostType],officeExtentionTarget:e.noTargetType||e.osfControl.getOsfControlType()===i.OsfControlTarget.TaskPane?r:e.osfControl.getOsfControlType(),clearCache:e.clearCache||a,supportedManifestVersions:{"1.0":o,1.1:o}};n._invokeProxyMethodAsync(e,"OEM_getEntitlementSummaryAsync",t,d)}else c<i.Constants.AuthenticatedConnectMaxTries?(c++,setTimeout(function(){e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.webUrl,u)},500)):t({statusCode:i.ProxyCallStatusCode.ProxyNotReady,value:r,context:e})};e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.webUrl,u)},_invokeProxyMethodAsync:function(e,t,n,o){var a,c=[o.clientEndPoint?o.clientEndPoint._targetUrl:e.clientEndPoint._targetUrl,t];for(var u in o)("string"===(a=typeof o[u])||"number"===a||"boolean"===a)&&c.push(o[u]);var f=c.join("."),p=d,m={onCompleted:n,context:e,methodName:t},g=p[f];if(g)g.push(m);else{p[f]=[m];var v=e.clientEndPoint;o.clientEndPoint&&(v=o.clientEndPoint,delete o.clientEndPoint),e.referenceInUse&&e.referenceInUse.storeType===i.StoreType.OMEX&&(o.officeVersion=i.Constants.ThreePartsFileVersion),v.invoke(t,function(e,t){var n=r,o=i.ProxyCallStatusCode.Failed;0===e&&t.status&&(n=t.result,o=i.ProxyCallStatusCode.Succeeded);var a=p[f];delete p[f];for(var c=a.length,u=0;u<c;u++){var d,m=a.shift();try{m.context&&m.context.osfControl&&(d=m.context.osfControl._appCorrelationId),t&&t.failureInfo&&s.RuntimeTelemetryHelper.LogProxyFailure(d,m.methodName,t.failureInfo),m.onCompleted({statusCode:o,value:n,context:m.context})}catch(e){var g="_invokeProxyMethodAsync failed.";l.WACUtils.logExceptionToBrowserConsole(g,e),s.RuntimeTelemetryHelper.LogExceptionTag(g,e,d,18420425)}}},o)}},removeOmexCacheAsync:function(e,t){i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a}},t);var n=e.referenceInUse,r={applicationName:e.hostType,assetID:n.id,officeExtentionTarget:e.osfControl.getOsfControlType(),clearEntitlement:e.clearEntitlement||a,clearToken:e.clearToken||a,clearAppState:e.clearAppState||a,clearManifest:e.clearManifest||a,appVersion:e.appVersion};e.anonymous?r.contentMarket=n.storeLocator:(r.assetContentMarket=e.osfControl._omexEntitlement.contentMarket,r.userContentMarket=n.storeLocator),this._invokeProxyMethodAsync(e,"OMEX_removeCacheAsync",t,r)},purgeManifest:function(r,o){var i=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:t,type:String,mayBeNull:a}]);if(i)throw i;var s=f(r,o);typeof c[s]!=e&&delete c[s]},cacheManifestFromXml:function(e,r,o,s){var c=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:t,type:String,mayBeNull:a},{name:"manifestXml",type:String,mayBeNull:a},{name:"uiLocale",type:String,mayBeNull:a}]);if(c)throw c;this.cacheManifest(e,r,new i.Manifest.Manifest(o,s))},cacheManifest:function(e,r,o){var i=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:t,type:String,mayBeNull:a},{name:"manifest",type:Object,mayBeNull:a}]);if(i)throw i;var s=f(e,r);o._UILocale=o._UILocale||u,c[s]=o},hasManifest:function(r,i){var s=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:t,type:String,mayBeNull:a}]);if(s)throw s;var u=f(r,i);return typeof c[u]!=e?o:a},getCachedManifest:function(e,r){var o=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:t,type:String,mayBeNull:a}]);if(o)throw o;var i=f(e,r);return c[i]},versionLessThan:function(e,t){for(var n,r,o=e.split("."),i=t.split("."),s=Math.min(o.length,i.length),c=0;c<s;c++)try{if((n=parseFloat(o[c]))!=(r=parseFloat(i[c])))return n<r}catch(e){}if(o.length>=i.length)return a;s=i.length;var u=0;for(c=o.length;c<s;c++){try{r=parseFloat(i[c])}catch(e){r=0}u+=r}return u>0},_setUILocale:function(e){u=e}}}(),i.ManifestSchemaVersion={"1.0":"1.0",1.1:"1.1"},i.ManifestNamespaces={"1.0":'xmlns="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"',1.1:'xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0" xmlns:ov="http://schemas.microsoft.com/office/taskpaneappversionoverrides" xmlns:c="http://schemas.microsoft.com/office/contentappversionoverrides"'},i.OsfNavigationMode={DefaultMode:0,CategoryMode:1,TrustPageMode:2,QueryResultMode:3},i.RequirementsChecker=function(e,t,n,r,o){var i=this;i.setCapabilities(e),i.setHosts(t),i.setRequirements(n),i.setSupportedControlTargets(r),i.setSupportedOmexAppVersions(o),i.setFilteringEnabled(!1)},i.RequirementsChecker.prototype={defaultMinMaxVersion:"1.1",isManifestSupported:function(e){if(!this.isFilteringEnabled())return!0;if(!e)return!1;switch(e.getManifestSchemaVersion()||i.ManifestSchemaVersion["1.0"]){case i.ManifestSchemaVersion["1.0"]:return this._checkManifest1_0(e);case i.ManifestSchemaVersion[1.1]:return this._checkManifest1_1(e);default:return!1}},isEntitlementFromOmexSupported:function(e){var t,n=this;if(!n.isFilteringEnabled())return!0;if(!e)return!1;switch(e.appSubType){case"1":t=i.OsfControlTarget.TaskPane;break;case"2":t=i.OsfControlTarget.InContent;break;case"3":t=i.OsfControlTarget.Contextual;break;case"4":t=i.OsfControlTarget.TaskPane;break;default:return!1}if(!n._checkControlTarget(t))return!1;if(!e.requirements&&!e.hosts)return!e.hasOwnProperty("appVersions")||void 0===e.appVersions||n._checkOmexAppVersions(e.appVersions);var r,o,a,s,c=new i.Manifest.Manifest(function(){});return e.requirements&&(c._xmlProcessor=new i.XmlProcessor(e.requirements,i.ManifestNamespaces[1.1]),o=c._xmlProcessor.getDocumentElement()),r=c._parseRequirements(o),e.hosts&&(c._xmlProcessor=new i.XmlProcessor(e.hosts,i.ManifestNamespaces[1.1]),s=c._xmlProcessor.getDocumentElement()),a=c._parseHosts(s),n._checkHosts(a)&&n._checkSets(r.sets)&&n._checkMethods(r.methods)},isEntitlementFromCorpCatalogSupported:function(e){var t=this;if(!t.isFilteringEnabled())return!0;if(!e)return!1;var n=i.OfficeAppType[e.OEType];if(!t._checkControlTarget(n))return!1;var r,o,a,s,c,u=new i.Manifest.Manifest(function(){});e.OfficeExtensionCapabilitiesXML&&(u._xmlProcessor=new i.XmlProcessor(e.OfficeExtensionCapabilitiesXML,i.ManifestNamespaces[1.1]),s=u._xmlProcessor.getDocumentElement(),o=(c=u._parseRequirements(s)).sets,a=c.methods,r=u._parseHosts(s));return t._checkHosts(r)&&t._checkSets(o)&&t._checkMethods(a)},setCapabilities:function(e){this._supportedCapabilities=this._scalarArrayToObject(e)},setHosts:function(e){this._supportedHosts=this._scalarArrayToObject(e)},setRequirements:function(e){var t=this;t._supportedSets=e&&t._arrayToSetsObject(e.sets)||{},t._supportedMethods=e&&t._scalarArrayToObject(e.methods)||{}},setSupportedControlTargets:function(e){this._supportedControlTargets=this._scalarArrayToObject(e)},setSupportedOmexAppVersions:function(e){this._supportedOmexAppVersions=e&&e.slice?e.slice(0):[]},setFilteringEnabled:function(e){this._filteringEnabled=!!e},isFilteringEnabled:function(){return this._filteringEnabled},_checkManifest1_0:function(e){return this._checkCapabilities(e.getCapabilities())},_checkCapabilities:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(this._supportedCapabilities[e[t]])return!0;return!1},_checkManifest1_1:function(e){var t=e.getRequirements()||{};return this._checkHosts(e.getHosts())&&this._checkSets(t.sets)&&this._checkMethods(t.methods)},_checkHosts:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(this._supportedHosts[e[t]])return!0;return!1},_checkSets:function(e){var t=this;if(!e||0===e.length)return!0;for(var n=0;n<e.length;n++){var r=e[n],o=t._supportedSets[r.name.toLowerCase()];if(!o)return!1;if(r.version&&(t._compareVersionStrings(o.minVersion||t.defaultMinMaxVersion,r.version)>0||t._compareVersionStrings(o.maxVersion||t.defaultMinMaxVersion,r.version)<0))return!1}return!0},_checkMethods:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(!this._supportedMethods[e[t]])return!1;return!0},_checkControlTarget:function(e){return null!=e&&this._supportedControlTargets[e]},_checkOmexAppVersions:function(e){if(!e)return!1;for(var t=0;t<this._supportedOmexAppVersions.length;t++)if(e.indexOf(this._supportedOmexAppVersions[t])>=0)return!0;return!1},_scalarArrayToObject:function(e){var t={};if(e&&e.length)for(var n=0;n<e.length;n++)null!=e[n]&&(t[e[n]]=!0);return t},_arrayToSetsObject:function(e){var t={};if(e&&e.length)for(var n=0;n<e.length;n++){var r=e[n];r&&null!=r.name&&(t[r.name.toLowerCase()]=r)}return t},_getSupportedSet:function(){for(var e={},t=Object.getOwnPropertyNames(this._supportedSets),n=0;n<t.length;n++){var r=this._supportedSets[t[n]];e[r.name.toLowerCase()]=r.maxVersion||this.defaultMinMaxVersion}return"undefined"!=typeof JSON?JSON.stringify(e):e},_compareVersionStrings:function(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length),r=0;r<n;r++){var o=parseInt(e[r],10)||0,i=parseInt(t[r],10)||0;if(o!==i)return o-i}return 0}},l.appSpecificCheckOrigin=function(e,t,n,r){try{return!(!(t&&t.source&&t.source.location&&t.source.location.pathname)||t.source.location.pathname.indexOf("projection.aspx")<0)&&r(e,n)}catch(e){return!1}},window.OfficeExt=l},6622:function(e,t){e.exports={am:"am-et",ar:"ar-sa",bg:"bg-bg","bn-in":"bn-in",ca:"ca-es",cs:"cs-cz",cy:"cy-gb",da:"da-dk",de:"de-de",el:"el-gr",en:"en-us",es:"es-es","es-mx":"es-mx",et:"et-ee",eu:"eu-es",fa:"fa-ir",fi:"fi-fi",fil:"fil-ph",fr:"fr-fr","fr-ca":"fr-ca",gl:"gl-es",gu:"gu-in",he:"he-il",hi:"hi-in",hr:"hr-hr",hu:"hu-hu",id:"id-id",is:"is-is",it:"it-it",ja:"ja-jp",kk:"kk-kz",kn:"kn-in",ko:"ko-kr","lo-la":"lo-la",lt:"lt-lt",lv:"lv-lv",ml:"ml-in",mr:"mr-in",ms:"ms-my",nl:"nl-nl","nn-no":"nn-no",no:"nb-no",pl:"pl-pl",pt:"pt-br","pt-pt":"pt-pt",ro:"ro-ro",ru:"ru-ru",sk:"sk-sk",sl:"sl-si",sr:"sr-latn-rs","sr-cyrl":"sr-cyrl-rs",sv:"sv-se",sw:"sw-ke",ta:"ta-in",te:"te-in",th:"th-th",tr:"tr-tr",uk:"uk-ua",ur:"ur-pk",vi:"vi-vn","zh-hans":"zh-cn","zh-hant":"zh-tw"}},6623:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(6624);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("ExecuteEwsProxy",e,t)}},6624:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"EwsProxyRequestParameters:#Exchange"},e)}},6625:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(6626);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=o.default(e.request)),r.makeServiceRequest("LoadExtensionCustomProperties",e,t)}},6626:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"LoadExtensionCustomPropertiesParameters:#Exchange"},e)}},6627:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(6628);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("RegisterConsent",e,t)}},6628:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"RegisterConsentJsonRequest:#Exchange"},e)}},6629:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"RegisterConsentRequest:#Exchange"},e)}},663:function(e,t,n){"use strict";function r(e){return i(i(e,"/","-"),"+","_")}function o(e){return i(i(e,"-","/"),"_","+")}function i(e,t,n){return e.split(t).join(n)}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o})},6630:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(6631);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=o.default(e.request)),r.makeServiceRequest("SaveExtensionCustomProperties",e,t)}},6631:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SaveExtensionCustomPropertiesParameters:#Exchange"},e)}},6632:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(6633);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=o.default(e.request)),r.makeServiceRequest("SaveExtensionSettings",e,t)}},6633:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SaveExtensionSettingsParameters:#Exchange"},e)}},6634:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(6635);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=o.default(e.request)),r.makeServiceRequest("GetExtensibilityContext",e,t)}},6635:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetExtensibilityContextParameters:#Exchange"},e)}},6636:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(6637);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetAllClientExtensionsNotifications",e,t)}},6637:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAllClientExtensionsNotificationsJsonRequest:#Exchange"},e)}},6638:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAllClientExtensionsNotificationsRequest:#Exchange"},e)}},6639:function(e,t,n){var r=n(6640),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},664:function(e,t,n){"use strict";var r=new(n(1003).a)(50);t.a=r},6640:function(e,t,n){t=e.exports=n(43)(!1);var r=n(3017)(n(6641));t.push([e.i,"._1L11XN4SgVxRJ9zyVxumu2.ms-Panel{top:48px}._1L11XN4SgVxRJ9zyVxumu2.ms-Panel .ms-Panel-contentInner{top:40px;position:absolute;overflow:visible}._1L11XN4SgVxRJ9zyVxumu2.ms-Panel .ms-Panel-contentInner .ms-Panel-content{height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative;min-height:400px;overflow:visible}html[dir] ._1L11XN4SgVxRJ9zyVxumu2.ms-Panel .ms-Panel-contentInner .ms-Panel-content{padding-bottom:0}html[dir=ltr] ._1L11XN4SgVxRJ9zyVxumu2.ms-Panel .ms-Panel-contentInner .ms-Panel-content,html[dir=rtl] ._1L11XN4SgVxRJ9zyVxumu2.ms-Panel .ms-Panel-contentInner .ms-Panel-content{padding-left:0;padding-right:0}._1L11XN4SgVxRJ9zyVxumu2.ms-Panel .ms-Panel-main{width:955px!important}html[dir=ltr] ._1L11XN4SgVxRJ9zyVxumu2.ms-Panel .ms-Panel-main{right:0!important;left:auto!important}html[dir=rtl] ._1L11XN4SgVxRJ9zyVxumu2.ms-Panel .ms-Panel-main{left:0!important;right:auto!important}._2qUilLsZZZwhzYZKhsIt2Z{display:-webkit-box;display:-ms-flexbox;display:flex;height:calc(100vh - 80px);width:960px;overflow:hidden}._2yAs5NqC0tyECY75EFNKuk{position:absolute;top:6px;z-index:1000;cursor:pointer}html[dir] ._2yAs5NqC0tyECY75EFNKuk{background:none}html[dir=ltr] ._2yAs5NqC0tyECY75EFNKuk{left:901px}html[dir=rtl] ._2yAs5NqC0tyECY75EFNKuk{right:901px}._2FuLfACASPmvFCH0PB473R{height:100%;width:100%}html[dir] ._2FuLfACASPmvFCH0PB473R{background:url("+r+");background-repeat:no-repeat;background-position:50%;padding-top:17px}.eyaJc2hK2WQOrCnilDnkK{top:11px;z-index:1;position:absolute;cursor:pointer}html[dir=ltr] .eyaJc2hK2WQOrCnilDnkK{right:73px}html[dir=rtl] .eyaJc2hK2WQOrCnilDnkK{left:73px}._2n4PF4UpCE4-IOqB8Q-8mm{height:100%;width:100%}html[dir] ._2n4PF4UpCE4-IOqB8Q-8mm{background:url("+r+");background-repeat:no-repeat;background-position:50%}._2YvKPBK-nIy41lQgjrgQgc{top:-29px;z-index:1;position:absolute;cursor:pointer}html[dir=ltr] ._2YvKPBK-nIy41lQgjrgQgc{right:73px}html[dir=rtl] ._2YvKPBK-nIy41lQgjrgQgc{left:73px}",""]),t.locals={inClientStorePanelContainer:"_1L11XN4SgVxRJ9zyVxumu2",container:"_2qUilLsZZZwhzYZKhsIt2Z",closeButton:"_2yAs5NqC0tyECY75EFNKuk",inClientStoreIFrameCenter:"_2FuLfACASPmvFCH0PB473R",FeedbackCommandBarCenter:"eyaJc2hK2WQOrCnilDnkK",inClientStoreIFrame:"_2n4PF4UpCE4-IOqB8Q-8mm",FeedbackCommandBar:"_2YvKPBK-nIy41lQgjrgQgc"}},6641:function(e,t,n){e.exports=n.p+"../resources/images/progress-e4ba8e5c7eb8b6080aadb62c29bbf737.gif"},6642:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(5707);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("DisableExtension",e,t)}},6643:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(5708);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("UninstallExtension",e,t)}},6644:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(5709);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("EnableApp",e,t)}},6645:function(e,t,n){var r=n(6646),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},6646:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,".Lvqv9E7XvaMLXSz-FZE97{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;max-width:510px}html[dir] .Lvqv9E7XvaMLXSz-FZE97{margin:30px}",""]),t.locals={divContainer:"Lvqv9E7XvaMLXSz-FZE97"}},6647:function(e){e.exports={b:"qtb",l:"rtb",c:"stb",d:"ttb",e:"utb",f:"vtb",g:"wtb",k:"xtb",h:"ytb",i:"ztb",j:"Atb",m:"Btb",n:"Ctb",o:"Dtb",a:"Etb"}},6648:function(e,t,n){var r=n(6649),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},6649:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'._1rtDVch9GkbCp_ViyUAmCf{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary)}html[dir] ._1rtDVch9GkbCp_ViyUAmCf{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._1rtDVch9GkbCp_ViyUAmCf .ms-Callout-main{overflow:hidden!important}._9P4NwO-TqpaZEtxEjoD-z{height:32px!important;color:inherit}html[dir] ._9P4NwO-TqpaZEtxEjoD-z{background-color:transparent}._9P4NwO-TqpaZEtxEjoD-z .ms-Button{height:32px}._9P4NwO-TqpaZEtxEjoD-z .is-expanded .ms-CommandBarItem-overflow,._2lT27X73lMv1Hp4GeWqodQ .ms-Button-label{color:"[theme:themePrimary, default:#0078D4]"!important}._2urSinr9E-r1hO9fM5S_BN{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._2urSinr9E-r1hO9fM5S_BN{padding:8px}html[dir=ltr] ._2urSinr9E-r1hO9fM5S_BN{float:left}html[dir=rtl] ._2urSinr9E-r1hO9fM5S_BN{float:right}._1V3S66FxOIBQubuFGkWGk{height:16px;width:0}html[dir] ._1V3S66FxOIBQubuFGkWGk{padding:0 0 0 0;margin:8px 0;border-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"!important}html[dir=ltr] ._1V3S66FxOIBQubuFGkWGk{border-right-width:1px;border-right-style:solid;float:left}html[dir=rtl] ._1V3S66FxOIBQubuFGkWGk{border-left-width:1px;border-left-style:solid;float:right}.MWQaen6nC-X0ytdtETFF5{width:570px;max-height:450px;min-height:32px}html[dir] .MWQaen6nC-X0ytdtETFF5{border-top-style:solid;border-top-width:1px;border-top-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}',""]),t.locals={divContainer:"_1rtDVch9GkbCp_ViyUAmCf",contextualBar:"_9P4NwO-TqpaZEtxEjoD-z",selected:"_2lT27X73lMv1Hp4GeWqodQ",appIcon:"_2urSinr9E-r1hO9fM5S_BN",divider:"_1V3S66FxOIBQubuFGkWGk",contextualAddinFrame:"MWQaen6nC-X0ytdtETFF5"}},665:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(968),o=n(1e3),i=n(1001),a=n(4);function s(e){switch(e){case 0:return{displayText:Object(a.a)(r.a),icon:"Inbox"};case 1:return{displayText:Object(a.a)(i.a),icon:"InboxCheck"};case 2:return{displayText:Object(a.a)(r.c),icon:"ShoppingCart"};case 3:return{displayText:Object(a.a)(r.d),icon:"Like"};case 4:return{displayText:Object(a.a)(r.b),icon:"News"};case 5:return{displayText:Object(a.a)(o.a),icon:"MailLowImportance"};default:return null}}},6650:function(e){e.exports={a:"Ftb"}},6651:function(e,t,n){var r=n(6652),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},6652:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,"._3AZN2f23gq2mhzLnfWU_eM{display:none}._2QMg-1nVG4Qgz2_DYOCHxK{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);max-width:none!important}html[dir] ._2QMg-1nVG4Qgz2_DYOCHxK{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}",""]),t.locals={divContainer:"_3AZN2f23gq2mhzLnfWU_eM",dialogContainer:"_2QMg-1nVG4Qgz2_DYOCHxK"}},6653:function(e){e.exports={a:"Vtb"}},6654:function(e){e.exports={d:"Qtb",e:"Rtb",a:"Stb",b:"Ttb",c:"Utb"}},6655:function(e,t,n){var r=n(6656),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},6656:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'.JWZC7fbugtMGVZNTp9t0g{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);height:100%;width:100%}html[dir] .JWZC7fbugtMGVZNTp9t0g{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._3yH9ZpPKPlXKMoFqTT1gN{position:relative;top:25%}html[dir] ._3yH9ZpPKPlXKMoFqTT1gN{text-align:center}._2B0IBIiE73PiRCwqJl26U{display:inline-block;font-size:80px;line-height:1;color:"[theme:themePrimary, default:#0078D4]"}html[dir] ._2B0IBIiE73PiRCwqJl26U{text-align:center}.BKddQib7Yba8XJqHd5XkA{display:block;max-width:70%}html[dir] .BKddQib7Yba8XJqHd5XkA{margin:auto}._3Uzvhs6Ngb__WHs0G38udO{font-size:17px;font-weight:300;color:"[theme:neutralPrimary, default:#333333]"}html[dir] ._3Uzvhs6Ngb__WHs0G38udO{padding-top:25px}._1VV8n_nQYjIKR8t1OkAVZM{font-size:12px;font-weight:400;color:"[theme:neutralSecondary, default:#666666]"}html[dir] ._1VV8n_nQYjIKR8t1OkAVZM{padding-top:10px}',""]),t.locals={errorContainer:"JWZC7fbugtMGVZNTp9t0g",errorContent:"_3yH9ZpPKPlXKMoFqTT1gN",errorIcon:"_2B0IBIiE73PiRCwqJl26U",errorTextCommon:"BKddQib7Yba8XJqHd5XkA",errorTextTitle:"_3Uzvhs6Ngb__WHs0G38udO",errorTextDescription:"_1VV8n_nQYjIKR8t1OkAVZM"}},6657:function(e){e.exports={a:"Ptb"}},6658:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'.QQedyk3WqNUXvB8Fd9MNn{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:70px}html[dir] .QQedyk3WqNUXvB8Fd9MNn{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white);padding:0 22px;padding-top:10px}._3VSU6lCHfmn3S6_3s-Zdc1{height:60px}html[dir] ._3VSU6lCHfmn3S6_3s-Zdc1{padding:0 32px;padding-top:10px}html[dir=ltr] ._3VSU6lCHfmn3S6_3s-Zdc1{padding-right:36px}html[dir=rtl] ._3VSU6lCHfmn3S6_3s-Zdc1{padding-left:36px}._3ZACdwNICVQfZ_n6B3gpRb{position:static}html[dir=ltr] ._3ZACdwNICVQfZ_n6B3gpRb{margin-right:-10px;right:0}html[dir=rtl] ._3ZACdwNICVQfZ_n6B3gpRb{margin-left:-10px;left:0}._3uYrmW-AjW30gICfaV2X0X{font-size:32px;color:"[theme:neutralSecondary, default:#666666]";width:32px;height:32px;min-width:32px}html[dir] ._3uYrmW-AjW30gICfaV2X0X{border:0;padding:0}html[dir=ltr] ._3uYrmW-AjW30gICfaV2X0X{float:left}html[dir=rtl] ._3uYrmW-AjW30gICfaV2X0X{float:right}.L4eNjYuToIXQGgL8_UyIJ{color:"[theme:neutralTertiary, default:#a6a6a6]"}.B2LVrq4fqQP7B9m3f4sOX{font-size:21px;font-weight:100;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:"[theme:neutralPrimary, default:#333333]";overflow:hidden;white-space:nowrap;text-overflow:ellipsis}html[dir=ltr] .B2LVrq4fqQP7B9m3f4sOX{float:left;margin-left:8px}html[dir=rtl] .B2LVrq4fqQP7B9m3f4sOX{float:right;margin-right:8px}._29XpBxFO6PxD6pNE-rsyHM{text-overflow:ellipsis;overflow:hidden}._29XpBxFO6PxD6pNE-rsyHM,._2HeOFvcyewtW4cX9DM6fr-{white-space:nowrap}._30yP6blV6fE-y7KQcLLWJF{color:"[theme:neutralPrimary, default:#333333]"}',""]),t.locals={addinPaneHeader:"QQedyk3WqNUXvB8Fd9MNn",addinPaneHeaderCalendar:"_3VSU6lCHfmn3S6_3s-Zdc1",closeButton:"_3ZACdwNICVQfZ_n6B3gpRb",addinPaneIcon:"_3uYrmW-AjW30gICfaV2X0X",fallbackIcon:"L4eNjYuToIXQGgL8_UyIJ",addinPaneLabelText:"B2LVrq4fqQP7B9m3f4sOX",ellipsis:"_29XpBxFO6PxD6pNE-rsyHM",rightButtons:"_2HeOFvcyewtW4cX9DM6fr-",persistIcon:"_30yP6blV6fE-y7KQcLLWJF"}},6659:function(e,t,n){var r=n(6660),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},6660:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,".V1HlMY9fiwYN_hbGh40bz .ms-Panel-content{height:100%;overflow-y:hidden}html[dir] .V1HlMY9fiwYN_hbGh40bz .ms-Panel-content{padding:0}.V1HlMY9fiwYN_hbGh40bz .ms-Panel-main{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);top:48px;height:calc(100% - 48px);width:320px!important}html[dir] .V1HlMY9fiwYN_hbGh40bz .ms-Panel-main{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}html[dir=ltr] .V1HlMY9fiwYN_hbGh40bz .ms-Panel-main{left:calc(100vw - 322px)!important}html[dir=rtl] .V1HlMY9fiwYN_hbGh40bz .ms-Panel-main{right:calc(100vw - 322px)!important}._2ZDGYy549QP_FM48yySV6s .ms-Panel-main{top:0;height:100%}.V1HlMY9fiwYN_hbGh40bz .ms-Panel-contentInner{height:100%}.V1HlMY9fiwYN_hbGh40bz{height:100%;overflow-y:hidden}",""]),t.locals={taskPane:"V1HlMY9fiwYN_hbGh40bz",taskPaneNoHeader:"_2ZDGYy549QP_FM48yySV6s"}},6661:function(e,t,n){var r=n(6662),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},6662:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,"._1B1TbjYfXvy3EPJ5wmw_Sf{display:none}.A5ffLvyf3S37O5bBbgfci{width:100%;height:calc(100% - 80px)}._10WgM3-tYUtKN2tdrjHMLV{height:calc(100% - 70px)}._2B5C7FvD1Yp0RuXbaeYO1m{display:block;top:0;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box}._2B5C7FvD1Yp0RuXbaeYO1m iframe{max-height:100%}._1wSzfuASBfmPdi01eeKySA{display:none}",""]),t.locals={divContainer:"_1B1TbjYfXvy3EPJ5wmw_Sf",extensionContainer:"A5ffLvyf3S37O5bBbgfci",extensionContainerCalendar:"_10WgM3-tYUtKN2tdrjHMLV",extensionHost:"_2B5C7FvD1Yp0RuXbaeYO1m",hide:"_1wSzfuASBfmPdi01eeKySA"}},6663:function(e,t,n){var r=n(6664),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},6664:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,"._2XQ4hu2sKii4SJF4Hk8Eoc{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);max-width:none}html[dir] ._2XQ4hu2sKii4SJF4Hk8Eoc{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._3wdAN0IAYHdI_4h2kJE4ru{height:190px}._1UJPvIWC2S-_E6nQ2aTgo2{width:550px;height:400px}._1flTtm594jqbjjFNOpgTd1{display:none!important}",""]),t.locals={dialogContainer:"_2XQ4hu2sKii4SJF4Hk8Eoc",uiLessContainer:"_3wdAN0IAYHdI_4h2kJE4ru",consentContainer:"_1UJPvIWC2S-_E6nQ2aTgo2",hiddenContainer:"_1flTtm594jqbjjFNOpgTd1"}},6665:function(e){e.exports={b:"Gtb",a:"Htb"}},6666:function(e,t,n){var r=n(6667),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},6667:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,".Jldo-s3vxjefxJclrs9iA{width:100%;height:100%}",""]),t.locals={uiLessContainer:"Jldo-s3vxjefxJclrs9iA"}},6668:function(e,t,n){var r=n(6669),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},6669:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,".ms-ContextualMenu-icon ._2O_IludifDbK_Zf0Sto_2g{position:relative;top:-8px}",""]),t.locals={fallbackIcon:"_2O_IludifDbK_Zf0Sto_2g"}},6670:function(e){e.exports={a:"Wtb"}},6671:function(e){e.exports={a:"Ztb"}},668:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.Init=1]="Init",e[e.LeftNavResizeExpand=2]="LeftNavResizeExpand",e[e.ToggleExpand=3]="ToggleExpand",e[e.ToggleCollapse=4]="ToggleCollapse",e[e.WindowResize=5]="WindowResize"}(r||(r={})),t.a=r},679:function(e,t,n){"use strict";function r(e,t){return!(o(e)||i(e,t))}function o(e){return!e||!e.trim()}function i(e,t){var n=e.trim();return t.filter(function(e){return e.Name.toLocaleLowerCase()===n.toLocaleLowerCase()}).length>0}n.d(t,"a",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return i})},680:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(56),o=n(47),i=n(5);function a(){var e;return(e={})[o.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[o.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[o.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(r.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddInlineImage","AddEmoji","ToggleDictation","ToggleRibbon"],composeSurfaceAddins:[]},e[o.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[o.a.Confetti]={confettiEnabled:!0},e[o.a.ComposeAssistance]={composeAssistanceEnabled:!0},e[o.a.GdprAdsPrefs]={feature:o.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[o.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[o.a.ExternalImages]={externalImagesSelectedOption:0},e[o.a.EventCapture]={autoCollectionEnabled:!1},e[o.a.LinkedInBindingDismissed]={linkedInBindingDismissedInPeoplePicker:!1},e[o.a.Translation]={translationMode:0,excludedLanguages:[]},e[o.a.CalendarSurfaceOptions]={agendaPaneIsClosed:!Object(i.d)("cal-agenda")},e}},682:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(150),o=n(347);function i(e){var t=Object(o.a)(),n=t&&t.get(e);return n&&n.loadingState||r.a.Uninitialized}},683:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(132);function o(){return Object(r.a)().sharedFolderUserEmails}},684:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(348);function o(e){return Object(r.a)(e)}},685:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n(1096),o=n.n(r),i=n(108),a=n.n(i),s=n(29),c=n(1097),u=n.n(c),l=n(455),d=n(346);function f(e,t){return u()({Header:Object(s.getJsonRequestHeader)(),Body:o()({FolderChanges:[{Updates:t,FolderId:a()(Object(l.a)(e))}]})},Object(d.a)(e)).then(function(e){return e.Body.ResponseMessages.Items[0]})}},686:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(12);function o(e){if(!e)return null;var t=e,n=0;if(1==t[0]){if(!(t=a(t)))return null}else n=1;var o=t[++n]+(t[n+1]>>8);return function(e,t,n){if(t+n>e.length)return r.c.error("ConvertByteArrayToString: offset + count must not exceed byte array length."),null;for(var o="",i=t;i<t+n;i++)o+=String.fromCharCode(e[i]);return o}(t,n+=2,o)}function i(e){if(!e)return!1;try{for(var t=atob(e),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);var o=0;return 1===n[0]?n=a(n):o=1,n&&1===n[o]}catch(e){return!1}}function a(e){var t=s(e,null);if(0==t)return r.c.error("rleDecompress : Invalid id"),null;var n=new Uint8Array(t);return s(e,n),n}function s(e,t){for(var n=0,o=1;o<e.length;++o)if(o==e.length-1||e[o]!=e[o+1])null!=t&&(t[n]=e[o]),n++;else{if(o==e.length-2)return r.c.error("decompressEx : Invalid id"),null;for(var i=e[o+2],a=0;a<i+2;a++)null!=t&&(t[n]=e[o]),n++;o+=2}return n}},688:function(e,t,n){"use strict";var r,o=n(47),i=n(1098),a=n(1);t.a=Object(a.createStore)("owsOptionsStore",{options:(r={},r[o.a.SmartSuggestions]={feature:o.a.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},r[o.a.DiverseEmojis]={feature:o.a.DiverseEmojis,diverseEmojisSelectedSkinTone:""},r[o.a.SurfaceActions]={feature:o.a.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},r[o.a.SkypeNotifications]={feature:o.a.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},r[o.a.WebPushNotifications]={feature:o.a.WebPushNotifications,enabled:!1,applicationServerKey:null},r[o.a.Confetti]={feature:o.a.Confetti,confettiEnabled:!1},r[o.a.GdprAdsPrefs]={feature:o.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},r[o.a.CalendarSurfaceAddins]={feature:o.a.CalendarSurfaceAddins,calendarSurfaceAddins:[]},r[o.a.ExternalImages]={feature:o.a.ExternalImages,externalImagesSelectedOption:null},r[o.a.EventCapture]={autoCollectionEnabled:!1},r[o.a.LinkedInBindingDismissed]={linkedInBindingDismissedInPeoplePicker:!1},r[o.a.Translation]={feature:o.a.Translation,translationMode:0,excludedLanguages:[]},r[o.a.CalendarSurfaceOptions]={feature:o.a.CalendarSurfaceOptions,agendaPaneIsClosed:!0},r[o.a.MentionEventNotifications]={feature:o.a.MentionEventNotifications,enabled:!1},r[o.a.TxpEventNotifications]={feature:o.a.TxpEventNotifications,enabled:!1},r[o.a.ComposeAssistance]={feature:o.a.ComposeAssistance,composeAssistanceEnabled:!1},r),loadState:i.a.OptionsNotLoaded})},6892:function(e,t,n){"use strict";var r=n(1633),o=n(7);t.a=Object(o.action)("showBccWell")(function(e){e.bccRecipientWell||(e.bccRecipientWell=Object(r.a)(e.findPeopleFeedbackManager,[]))})},6893:function(e,t,n){"use strict";var r=n(7);t.a=Object(r.action)("updateSubject")(function(e,t){e.subject=t,e.isDirty=!0})},6894:function(e,t,n){"use strict";var r=n(7);t.a=Object(r.action)("updateSubjectSelectionRange")(function(e,t,n){e.subjectViewState.selectionStart=t,e.subjectViewState.selectionEnd=n})},6899:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(1586),o=n(3671),i=n(4234),a=n(3731);function s(e,t,n,s){return new Promise(function(c,u){var l=!1,d=Object(a.a)(e);try{var f=Object(r.h)([{name:t,url:n}]),p=Object(o.b)(e).inlineImagePlugin,m="HTML"!=e.bodyType?null:p.processInlineImageBeforeUpload.bind(p);Object(i.a)(f,e,{isInline:s,isHiddenInline:!0,shouldShare:!1},m,function(e,t){d(e,t),l||(l=!0,u({errorType:"UploadError",id:e}))},Object(a.c)(e),function(e){l||(l=!0,c(e.Id))})}catch(e){u({errorType:"UploadError"})}})}},6900:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1586),o=n(4234),i=n(3731);function a(e,t,n,a){return new Promise(function(s,c){var u=!1,l=Object(i.a)(e),d=Object(r.g)([t],[n]);Object(o.a)(d,e,{isInline:a,isHiddenInline:!1,shouldShare:!1},null,function(e,t){l(e,t),u||(u=!0,c({errorType:"UploadError",id:e}))},Object(i.c)(e),function(e){u||(u=!0,s(e.Id))})})}},691:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return i});var r="Calling",o="UnreadMessage",i="Summary"},694:function(e,t,n){"use strict";var r=n(7),o=n(388);t.a=Object(r.action)("removeNotification")(function(e){var t=o.a.notificationViewStates.indexOf(e);t>=0&&o.a.notificationViewStates.splice(t,1)})},699:function(e,t,n){"use strict";var r=n(741),o=function(){try{var e=Object(r.a)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.a=o},72:function(e,t,n){"use strict";n.d(t,"b",function(){return a});var r=n(8),o=n(1),i={conversationItems:new r.ObservableMap({}),itemContextMenuState:null,selectedTableViewId:null,tableViewConversationRelations:new r.ObservableMap({}),tableViewItemRelations:new r.ObservableMap({}),tableViews:new r.ObservableMap({}),attachmentViewStates:new r.ObservableMap({}),expandedConversationViewState:{expandedRowKey:null,selectedNodeIds:[],shouldBeExpanded:!1,busStopStateMap:new r.ObservableMap({})},rowAttachmentPreviewWellViews:new r.ObservableMap({}),focusedOtherDropViewState:null,couponPeekPreviews:new r.ObservableMap({}),rowInfoForVLV:new r.ObservableMap({}),offsetHeight:0,scrollTop:0,inboxPausedDateTime:null,inboxPausedLength:null},a=Object(o.createStore)("listview",i),s=a();t.a=s},73:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return c});var r=n(8),o=n(1),i={conversationNodes:new r.ObservableMap({}),conversations:new r.ObservableMap({}),items:new r.ObservableMap({}),mailModule:{showReadingPane:!1,showListPane:!0,showFolderPane:!0},searchFolderDisplayName:null,typeOfItemBeingDragged:null},a=Object(o.createStore)("mail",i),s=a();t.a=s;var c=function(){return s.mailModule}},739:function(e,t,n){"use strict";n.d(t,"c",function(){return l}),n.d(t,"d",function(){return d}),n.d(t,"h",function(){return f}),n.d(t,"b",function(){return p}),n.d(t,"e",function(){return m}),n.d(t,"f",function(){return g}),n.d(t,"g",function(){return v}),n.d(t,"a",function(){return h});var r=n(0),o=n(110),i=n(5),a=n(1516),s=n(1500),c=n(1501),u=n(1502);function l(e){var t=Object(o.b)();return Object(i.d)("tri-favorites-roaming")?!!Object(u.a)(e):t.favoritesFolderNodes.has(e)}function d(e){return!!Object(s.a)(e)}function f(e){var t=Object(o.b)();return Object(i.d)("tri-favorites-roaming")?r.__spread(Object(o.b)().outlookFavorites.values()).filter(function(e){return"search"===e.type}).some(function(t){return t.searchQuery===e}):t.favoriteSearches.has(e)}function p(e){var t=Object(o.b)();return Object(i.d)("tri-favorites-roaming")?!!Object(c.a)(e):t.favoriteCategories.has(e)}function m(e,t){return null!==h(e,t)}function g(e,t){return r.__spread(Object(o.b)().outlookFavorites.values()).filter(function(e){return"privatedistributionlist"===e.type}).some(function(n){return n.pdlId===e||Object(a.a)(n.members,t)})}function v(e){return Object(o.b)().favoriteSecondaryKeyMap.has(e)}function h(e,t){var n=Object(o.b)(),a=null;Object(i.d)("tri-favorites-roaming")?a=r.__spread(n.outlookFavorites.values()).filter(function(n){return"persona"===n.type&&y(n,e,t)}):a=r.__spread(n.favoritesPersonaNodes.values()).filter(function(n){return y(n,e,t)});return a&&a.length>0?a[0]:null}function y(e,t,n){return t&&e.personaId===t||n&&e.allEmailAddresses&&e.allEmailAddresses.some(function(e){return e&&e.toLocaleLowerCase()===n.toLocaleLowerCase()})}},740:function(e,t,n){"use strict";var r=n(656),o=n(946);t.a=function(e){return null!=e&&Object(o.a)(e.length)&&!Object(r.a)(e)}},741:function(e,t,n){"use strict";var r=n(1321);var o=function(e,t){return null==e?void 0:e[t]};t.a=function(e,t){var n=o(e,t);return Object(r.a)(n)?n:void 0}},744:function(e,t,n){"use strict";var r=n(0);function o(e){return e>0}var i=n(1),a=n(26),s=Object(i.action)("UNSUBSCRIBE_FROM_BRAND_SUBSCRIPTION",function(e,t,n,r,o){return Object(a.a)({name:"UnsubscribeSubscription",customData:{unsubscribeSourceType:e}},{unsubscribeSourceType:e,smtpIdentifier:t,unsubscribeSilentUris:n,unsubscribeHttpUri:r,completedCallback:o})}),c=Object(i.action)("AFTER_UNSUBSCRIBE",function(e,t,n,r,o){return{smtpIdentifier:e,unsubscribeSourceType:t,responseType:n,debugMessage:r,completedCallback:o}}),u=Object(i.action)("LOAD_SUBSCRIPTIONS_CACHE"),l=n(4),d=n(75),f="ows/api/beta/subscriptions/{0}/unsubscribe";var p,m=function(e,t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(n){switch(n.label){case 0:return[4,Object(d.c)(Object(l.b)(f,e),{unsubscribeSilentUris:t},null,!0)];case 1:return[2,n.sent()]}})})};!function(e){e[e.Fail=0]="Fail",e[e.Success=1]="Success"}(p||(p={}));var g=p,v=null;function h(e){if(e&&v){return r.__read(v.subscriptions.filter(function(t){return t&&t.smtpInfo&&t.smtpInfo.smtpAddress&&t.smtpInfo.smtpAddress.toLowerCase()===e.toLowerCase()}),1)[0]}}var y=n(252);Object(i.orchestrator)(s,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,i,a,s,u,l,d,f,p;return r.__generator(this,function(h){switch(h.label){case 0:return t=e.unsubscribeSourceType,n=e.smtpIdentifier,i=e.unsubscribeSilentUris,a=e.unsubscribeHttpUri,s=e.completedCallback,a&&0!==a.length||i&&0!==i.length?(i&&o(i.length)||!a?u="No unsubscribe URIs provided":(window.open(a,"_blank"),u="Opened unsubscribe URI in new tab"),[4,m(n,i)]):(u="No unsubscribe URIs or SilentURIs provided",l=g.Fail,c(n,t,l,u,s),[2,Promise.reject("No unsubscribe URIs or SilentURIs provided")]);case 1:return d=h.sent(),f=null,Object(y.a)(d.status)?(u="Unsubscribe service called successfully. "+u,l=g.Success,function(e){if(v){var t,n=r.__read(v.subscriptions.filter(function(n,r){return!(!n||!n.smtpInfo||n.smtpInfo.smtpIdentifier!==e||(t=r,0))}),1)[0];n?(v.subscriptions.splice(t,1),v.unsubscribedSubscriptions.push(n)):_()}}(n),[3,4]):[3,2];case 2:return u="Unsubscribe service failed. "+u,l=g.Fail,[4,d.text().then(function(e){return e?JSON.parse(e):{}})];case 3:p=h.sent(),(f=new Error("ResponseCode="+d.status+", ErrorMessage="+(p&&p.error&&p.error.message))).fetchErrorType="ServerFailure",h.label=4;case 4:return c(n,t,l,u,s),f?[2,Promise.reject(f)]:[2,Promise.resolve()]}})})});var b="ows/api/beta/subscriptions?orderBy=name, asc";var _=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(o){switch(o.label){case 0:return[4,Object(d.b)(e?b+"&noResolveBrand=true":b,void 0,!0)];case 1:return t=o.sent(),Object(y.a)(t.status)?[4,t.json()]:[3,3];case 2:return function(e){v=r.__assign({},e)}(n=o.sent()),[2,n];case 3:return[2,null]}})})};Object(i.orchestrator)(u,function(e){_(!0)}),n.d(t,"b",function(){return _}),n.d(t,"f",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"a",function(){return g}),n.d(t,"c",function(){return h}),n.d(t,"g",function(){return o})},745:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"c",function(){return d});var r=n(1025),o=n(1026),i=n(418),a=n.n(i),s=n(300),c=n(790),u="FindConversationOperationStart",l="FindConversationOperationEnd";function d(e,t,n,i,d,f,p,m,g,v,h,y,b,_){if(m){var S=Object(s.c)(e.Id,t);if(S)return Promise.resolve({findConversationResponseMessage:S.Body,responseInit:{status:200,statusText:"OK",headers:new Headers}})}var C=a()({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:n});return b&&b.addCheckmark(u),Object(c.a)("📩 FindConversationPerformance"),Object(r.a)(e,C,i,d,f,p,g,v,Object(o.a)(i),h,y,_).then(function(e){return b&&b.addCheckmark(l),Object(c.b)("📩 FindConversationPerformance"),e.json().then(function(t){return{findConversationResponseMessage:t.Body,responseInit:{status:e.status,statusText:e.statusText,headers:e.headers},url:e.url}})})}},7616:function(e,t,n){"use strict";var r,o=n(1284);!function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double"}(r||(r={})),n.d(t,"a",function(){return l});var i=/\./g,a=".",s="Data",c="zC",u=0;function l(e,t,n){var r,a,s={name:(r=e.eventName,r.toLowerCase().replace(i,"_")),properties:{}};if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Unable to find ariaTenantToken for namespace.");return s.properties["Event.Sequence"]={value:++u,type:o.AWTPropertyType.Int64},s.properties["Event.Name"]=e.eventName,s.properties["Event.Source"]="OTelJS",a=n?new Date(n):new Date,s.properties["Event.Time"]={value:a,type:o.AWTPropertyType.Date},e.eventContract&&(s.properties["Event.Contract"]=e.eventContract.name,d(s,e.eventContract.dataFields,!1)),d(s,t,!1),d(s,e.dataFields,!0),s}function d(e,t,n){t&&t.forEach(function(t){var r=["","",t.name],o=r[0],i=r[1],u=r[2],l=t.name.indexOf(a);l>0&&t.name.substr(0,l)===c&&(o=t.name.substring(0,l+1),u=t.name.substring(l+1)),n&&(i=s+a);var d=o+i+u;e.properties[d]={value:t.value,type:f(t.dataType)}})}function f(e){switch(e){case r.String:return o.AWTPropertyType.String;case r.Boolean:return o.AWTPropertyType.Boolean;case r.Int64:return o.AWTPropertyType.Int64;case r.Double:return o.AWTPropertyType.Double;default:throw new Error(e)}}},7622:function(e,t,n){"use strict";var r=n(2626),o=n(4973);n.d(t,"a",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s});var i=function(e){return function(t,n){Object(r.a)(e,t,n)}},a=function(e){return function(t){Object(o.a)(e,t)}},s=function(e){return function(){return function(e){return e.infoBarIds}(e)}}},778:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CreateFolderRequest:#Exchange"},e)}},779:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(1171);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("CreateFolder",e,t)}},787:function(e,t,n){"use strict";n.d(t,"p",function(){return c}),n.d(t,"s",function(){return u}),n.d(t,"t",function(){return l}),n.d(t,"a",function(){return d}),n.d(t,"r",function(){return f}),n.d(t,"g",function(){return p}),n.d(t,"h",function(){return m}),n.d(t,"e",function(){return g}),n.d(t,"f",function(){return v}),n.d(t,"k",function(){return h}),n.d(t,"j",function(){return y}),n.d(t,"m",function(){return b}),n.d(t,"n",function(){return _}),n.d(t,"l",function(){return S}),n.d(t,"d",function(){return C}),n.d(t,"q",function(){return O}),n.d(t,"u",function(){return I}),n.d(t,"c",function(){return A}),n.d(t,"o",function(){return T}),n.d(t,"b",function(){return E}),n.d(t,"i",function(){return x});var r=n(1088);n.d(t,"v",function(){return r.a});var o=n(1089);n.d(t,"w",function(){return o.a});var i=n(1081);n.d(t,"x",function(){return i.b});n(224),n(397);var a=n(3),s=new a.c(function(){return Promise.all([n.e(2),n.e(6),n.e(9),n.e(11),n.e(107)]).then(n.bind(null,2158))}),c=new a.a(s,function(e){return e.initializeAttachments}),u=new a.a(s,function(e){return e.reinitializeAttachments}),l=new a.a(s,function(e){return e.setInlineAttachmentStatus}),d=new a.a(s,function(e){return e.addAttachmentIntoWellBeforeUpload}),f=new a.b(s,function(e){return e.refreshSharingTipsAttachmentWell}),p=new a.b(s,function(e){return e.createAttachmentsViaQueueManager}),m=new a.a(s,function(e){return e.deleteAttachmentViaQueueManager}),g=new a.b(s,function(e){return e.createAttachmentFullViewStateAndStoreBackingModel}),v=new a.b(s,function(e){return e.createAttachmentFullViewState}),h=new a.b(s,function(e){return e.getAttachmentWellInitialValue}),y=new a.b(s,function(e){return e.getAttachmentWellForCompose}),b=new a.b(s,function(e){return e.getConversationAttachmentWellInitialValue}),_=new a.b(s,function(e){return e.getImageDimensionsFromFile}),S=(new a.b(s,function(e){return e.getMaxClassicAttachmentsSize}),new a.b(s,function(e){return e.getAvailableLocalAttachmentSize})),C=new a.b(s,function(e){return e.createAttachmentFileFromExistingMailboxAttachment}),O=new a.a(s,function(e){return e.mergeToConversationAttachmentWell}),I=new a.a(s,function(e){return e.sortConversationAttachmentWell}),A=new a.a(s,function(e){return e.convertImageViewAttachmentToInlineAttachment}),T=new a.b(s,function(e){return e.getLastCloudyAttachmentsSharingIssueForBlockOnSend}),E=new a.b(s,function(e){return e.checkForRemovedLinks}),x=new a.b(s,function(e){return e.getAllValidAttachments})},790:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r="undefined"!=typeof window&&window.hasOwnProperty("Performance")&&Performance.prototype.getEntriesByName;function o(e){var t;t=e+" - start",r&&performance&&performance.mark&&performance.mark(t)}function i(e){if(r){try{performance&&performance.measure&&performance.measure(e,e+" - start")}catch(e){return}var t=performance&&performance.getEntriesByName(e);return performance&&performance.clearMarks&&performance.clearMarks(e+" - start"),t&&t.length>0?t.slice(-1)[0]:void 0}}},793:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1514);function o(e){return Object(r.a)(e)&&"Resource"===e.LocationSource}},794:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),o=n(2),i=n(956),a=n(657),s=n(565),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._keytipManager=a.a.getInstance(),t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.keytipProps&&(this._uniqueId=this._keytipManager.register(this._getKtpProps()))},t.prototype.componentWillUnmount=function(){this.props.keytipProps&&this._keytipManager.unregister(this._getKtpProps(),this._uniqueId)},t.prototype.componentDidUpdate=function(){this.props.keytipProps&&this._keytipManager.update(this._getKtpProps(),this._uniqueId)},t.prototype.render=function(){var e=this.props,t=e.children,n=e.keytipProps,r=e.ariaDescribedBy,o={};return n&&(o=this._getKtpAttrs(n,r)),t(o)},t.prototype._getKtpProps=function(){return r.__assign({disabled:this.props.disabled},this.props.keytipProps)},t.prototype._getKtpAttrs=function(e,t){if(e){var n=this._keytipManager.addParentOverflow(e),r=Object(s.a)(n.keySequences),o=n.keySequences.slice();n.overflowSetSequence&&(o=Object(s.d)(o,n.overflowSetSequence));var a=Object(s.e)(o);return{"aria-describedby":Object(i.a)(t,r),"data-ktp-target":a,"data-ktp-execute-target":a}}},t}(o.Component)},798:function(e,t,n){"use strict";n.d(t,"d",function(){return d}),n.d(t,"i",function(){return f});var r=n(3),o=n(1125);n.d(t,"f",function(){return o.a});var i=n(694);n.d(t,"j",function(){return i.a});var a=n(388);n.d(t,"h",function(){return a.a});var s=n(691);n.d(t,"a",function(){return s.a}),n.d(t,"b",function(){return s.b}),n.d(t,"e",function(){return s.c});var c=n(1126);n.d(t,"g",function(){return c.a});var u=n(570);n.d(t,"c",function(){return u.a});var l=new r.c(function(){return Promise.all([n.e(0),n.e(1),n.e(4),n.e(500),n.e(302)]).then(n.bind(null,2181))}),d=Object(r.d)(l,function(e){return e.NotificationToast}),f=new r.a(l,function(e){return e.addNotification})},805:function(e,t,n){"use strict";n.d(t,"b",function(){return a});var r=n(8),o=n(1),i={viewStates:new r.ObservableMap,primaryComposeId:null,complianceConfigurations:new r.ObservableMap,newMessageCreationInProgress:!1},a=Object(o.createStore)("compose",i),s=a();t.a=s},806:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"h",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"f",function(){return u}),n.d(t,"d",function(){return l}),n.d(t,"e",function(){return d}),n.d(t,"a",function(){return f});var r=n(0),o=n(176),i="deeplink",a="compose",s="reply",c="replyall",u="read",l="group",d="/"+r.__spread(["mail"],Object(o.a)().split("/").slice(1)).join("/")+i+"/",f="/"+r.__spread(["calendar"],Object(o.a)().split("/").slice(1)).join("/")+i+"/"},808:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),o=n(152),i=n(318),a=n(12);function s(){var e,t,n=Object(i.a)();try{for(var s=r.__values(n.tabs),c=s.next();!c.done;c=s.next()){var u=c.value;if(u.isActive&&u.type!=o.a.FloatingChat)return u}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return a.c.error("There is no active tab. Something went very wrong."),null}},810:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(510),o=n(72);function i(e,t){var n=Object(r.a)(e,t);return o.a.tableViewItemRelations.get(n)}},812:function(e,t,n){"use strict";var r=n(152),o=n(1100),i=n(808),a=n(1634),s=n(1637),c=n(26),u=n(950);t.a=Object(c.b)("activateTab",o.a.TabViewActivateTab)(function(e,t){switch(Object(a.a)(e,!0),e.type){case r.a.FloatingChat:return void Object(s.a)(e);case r.a.Primary:case r.a.OverflowMenu:case r.a.SecondaryReadingPane:case r.a.Compose:if(!e.isActive){var n,o=Object(i.a)();if(o)o.isActive=!1,(n=Object(u.a)(o.type))&&n.onDeactivate&&n.onDeactivate(o);if(e)e.isActive=!0,e.blink=!1,(n=Object(u.a)(e.type))&&n.onActivate&&n.onActivate(e)}return}})},813:function(e,t,n){"use strict";var r=n(18),o=n(141),i=n(513),a={tenantTokens:Object(r.e)(),isCore:!0};function s(e,t,n){var r=new i.a(e,t,a);n&&r.addCosmosOnlyData(n),o.g.importAndExecute(r)}function c(e){return new r.a(e,a)}n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c})},815:function(e,t,n){"use strict";var r=n(1626),o=n(1602),i=Object(o.a)(function(e,t,n){Object(r.a)(e,t,n)});t.a=i},8424:function(e){e.exports={a:"aub",b:"bub"}},8425:function(e){e.exports={b:"_tb",a:"$tb"}},8426:function(e){e.exports={a:"cub"}},8427:function(e,t,n){var r=n(8428),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8428:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'._3mj2J116LjUrULGnDhqr54{width:16px;height:16px}html[dir] ._3mj2J116LjUrULGnDhqr54{padding:7px}._27KGDUDCzRaTcLWsO34eTz{width:30px;height:30px;cursor:pointer}html[dir] ._27KGDUDCzRaTcLWsO34eTz{background-color:transparent;padding:0}html[dir=ltr] ._27KGDUDCzRaTcLWsO34eTz{margin:0 5px 0 0}html[dir=rtl] ._27KGDUDCzRaTcLWsO34eTz{margin:0 0 0 5px}html[dir] ._27KGDUDCzRaTcLWsO34eTz:hover{background-color:"[theme:themeLighter, default:#DEECF9]"}._27KGDUDCzRaTcLWsO34eTz .ms-Button-menuIcon{display:none}',""]),t.locals={image:"_3mj2J116LjUrULGnDhqr54",addinEntryButton:"_27KGDUDCzRaTcLWsO34eTz"}},8429:function(e,t,n){var r=n(8430),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8430:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,".w9LM8HKUEdnpEi81ql-9-{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;height:30px}",""]),t.locals={listViewContainer:"w9LM8HKUEdnpEi81ql-9-"}},8431:function(e){e.exports={a:"dub"}},8432:function(e,t,n){var r=n(8433),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8433:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'._3Cw7Ia3kdGwIoFPzNEtx4W{display:block}html[dir] ._3Cw7Ia3kdGwIoFPzNEtx4W{background:transparent;border:none}html[dir=ltr] ._3Cw7Ia3kdGwIoFPzNEtx4W{margin-right:5px}html[dir=rtl] ._3Cw7Ia3kdGwIoFPzNEtx4W{margin-left:5px}._1sLYvhyr1tSZtUZxZIl249{height:16px;width:0;color:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir] ._1sLYvhyr1tSZtUZxZIl249{padding:0 0 0 0;margin:7px 0 7px 0}html[dir=ltr] ._1sLYvhyr1tSZtUZxZIl249{border-right-width:1px;border-right-style:solid;float:left}html[dir=rtl] ._1sLYvhyr1tSZtUZxZIl249{border-left-width:1px;border-left-style:solid;float:right}._2MxpPNhkTVXk7lBQVyGGkv{display:inline-block;width:30px;height:30px;cursor:pointer}html[dir] ._2MxpPNhkTVXk7lBQVyGGkv{background-color:transparent}html[dir] ._2MxpPNhkTVXk7lBQVyGGkv:hover{background-color:"[theme:themeLighter, default:#DEECF9]"}._2MxpPNhkTVXk7lBQVyGGkv .ms-Button-menuIcon{display:none}._3PZMODL9YdiRpuFuCsWH2S{font-size:10px;color:"[theme:neutralSecondary, default:#666666]"}',""]),t.locals={overflowContainer:"_3Cw7Ia3kdGwIoFPzNEtx4W",overflowDivider:"_1sLYvhyr1tSZtUZxZIl249",overflowChevronContainer:"_2MxpPNhkTVXk7lBQVyGGkv",overflowChevron:"_3PZMODL9YdiRpuFuCsWH2S"}},8434:function(e,t,n){var r=n(8435),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},8435:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,"._3jbbb2GAEuc3uvAtIPqdLS{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex}html[dir=ltr] ._3jbbb2GAEuc3uvAtIPqdLS{float:right}html[dir=rtl] ._3jbbb2GAEuc3uvAtIPqdLS{float:left}",""]),t.locals={divContainer:"_3jbbb2GAEuc3uvAtIPqdLS"}},8436:function(e){e.exports={a:"Xtb",b:"Ytb"}},85:function(e,t,n){"use strict";var r;!function(e){e[e.None=-1]="None",e[e.Red=0]="Red",e[e.Orange=1]="Orange",e[e.Peach=2]="Peach",e[e.YellowLight=3]="YellowLight",e[e.GreenLight=4]="GreenLight",e[e.TealLight=5]="TealLight",e[e.Olive=6]="Olive",e[e.BlueSky=7]="BlueSky",e[e.PurpleLight=8]="PurpleLight",e[e.Pink=9]="Pink",e[e.SteelLight=10]="SteelLight",e[e.SteelGrey=11]="SteelGrey",e[e.GreyLight=12]="GreyLight",e[e.GreyDark=13]="GreyDark",e[e.Black=14]="Black",e[e.RedDark=15]="RedDark",e[e.OrangeDark=16]="OrangeDark",e[e.BrownMedium=17]="BrownMedium",e[e.YellowDark=18]="YellowDark",e[e.GreenDark=19]="GreenDark",e[e.TealDark=20]="TealDark",e[e.OliveDark=21]="OliveDark",e[e.BlueDark=22]="BlueDark",e[e.PurpleDark=23]="PurpleDark",e[e.MagentaDark=24]="MagentaDark"}(r||(r={})),t.a=r},879:function(e,t,n){"use strict";var r=Array.isArray;t.a=r},880:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a});var r=n(14),o=r.AnimationVariables.durationValue2,i={root:"ms-Modal",main:"ms-Dialog-main",scrollableContent:"ms-Modal-scrollableContent",isOpen:"is-open",layer:"ms-Modal-Layer"},a=function(e){var t,n=e.className,a=e.containerClassName,s=e.scrollableContentClassName,c=e.isOpen,u=e.isVisible,l=e.hasBeenOpened,d=e.modalRectangleTop,f=e.theme,p=e.topOffsetFixed,m=e.isModeless,g=e.layerClassName,v=e.isDefaultDragHandle,h=f.palette,y=Object(r.getGlobalClassNames)(i,f);return{root:[y.root,f.fonts.medium,{backgroundColor:"transparent",position:m?"absolute":"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity "+o},p&&l&&{alignItems:"flex-start"},c&&y.isOpen,u&&{opacity:1,pointerEvents:"auto"},n],main:[y.main,{boxShadow:"0 0 5px 0 rgba(0, 0, 0, 0.4)",backgroundColor:h.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid transparent",maxHeight:"100%",overflowY:"auto",zIndex:m?r.ZIndexes.Layer:void 0},p&&l&&{top:d},v&&{cursor:"move"},a],scrollableContent:[y.scrollableContent,{overflowY:"auto",flexGrow:1,maxHeight:"100vh",selectors:(t={},t["@supports (-webkit-overflow-scrolling: touch)"]={maxHeight:window.innerHeight},t)},s],layer:m&&[g,y.layer,{position:"static",width:"unset",height:"unset"}],keyboardMoveIconContainer:{position:"absolute",display:"flex",justifyContent:"center",width:"100%",padding:"3px 0px"},keyboardMoveIcon:{fontSize:"24px",width:"24px"}}}},881:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i});var r=n(14);function o(e){var t,n,o,i=e.semanticColors,a=i.buttonBackground,s=i.buttonBackgroundChecked,c=i.buttonBackgroundHovered,u=i.buttonText,l=i.buttonTextHovered,d=i.buttonTextChecked,f=i.buttonTextCheckedHovered;return{root:{backgroundColor:a,color:u},rootHovered:{backgroundColor:c,color:l,selectors:(t={},t[r.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},t)},rootPressed:{backgroundColor:s,color:d},rootExpanded:{backgroundColor:s,color:d},rootChecked:{backgroundColor:s,color:d},rootCheckedHovered:{backgroundColor:e.palette.neutralLight,color:f},splitButtonContainer:{selectors:(n={},n[r.HighContrastSelector]={border:"none"},n)},splitButtonMenuButton:{color:e.palette.white,backgroundColor:e.palette.neutralLighter,selectors:{":hover":{backgroundColor:e.palette.neutralLight,selectors:(o={},o[r.HighContrastSelector]={color:"Highlight"},o)}}},splitButtonMenuButtonDisabled:{backgroundColor:e.palette.neutralLighter,selectors:{":hover":{backgroundColor:e.palette.neutralLighter}}},splitButtonDivider:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:e.palette.themePrimary},splitButtonMenuButtonExpanded:{backgroundColor:e.palette.neutralLight},splitButtonMenuIcon:{color:e.palette.neutralPrimary},splitButtonMenuIconDisabled:{color:e.palette.neutralTertiary}}}function i(e){return{root:{backgroundColor:e.palette.themePrimary,color:e.palette.white,selectors:(t={},t[r.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},t)},rootHovered:{backgroundColor:e.palette.themeDarkAlt,color:e.palette.white,selectors:(n={},n[r.HighContrastSelector]={color:"Window",backgroundColor:"Highlight"},n)},rootPressed:{backgroundColor:e.palette.themeDark,color:e.palette.white,selectors:(o={},o[r.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},o)},rootExpanded:{backgroundColor:e.palette.themeDark,color:e.palette.white},rootChecked:{backgroundColor:e.palette.themeDark,color:e.palette.white},rootCheckedHovered:{backgroundColor:e.palette.themePrimary,color:e.palette.white},rootDisabled:{selectors:(i={},i[r.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},i)},splitButtonContainer:{selectors:(a={},a[r.HighContrastSelector]={border:"none"},a)},splitButtonDivider:{backgroundColor:e.palette.white},splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButton:{backgroundColor:e.palette.themePrimary,color:e.palette.white,selectors:{":hover":{backgroundColor:e.palette.themeDark,selectors:(s={},s[r.HighContrastSelector]={color:"Highlight"},s)}}},splitButtonMenuButtonDisabled:{backgroundColor:e.palette.neutralLighter,selectors:{":hover":{backgroundColor:e.palette.neutralLighter}}},splitButtonMenuButtonChecked:{backgroundColor:e.palette.themeDark},splitButtonMenuButtonExpanded:{backgroundColor:e.palette.themeDark},splitButtonMenuIcon:{color:e.palette.white},splitButtonMenuIconDisabled:{color:e.palette.neutralTertiary}};var t,n,o,i,a,s}},882:function(e,t,n){"use strict";t.a=function(e){return e}},885:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateMasterCategoryListRequest:#Exchange"},e)}},886:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l});var r=n(385),o=n.n(r),i=n(57),a=n.n(i),s=n(95),c="MailListItem";function u(e){return e&&"scheduled"==Object(s.a)(e)?o()({BaseShape:"IdOnly",AdditionalProperties:[a()({FieldURI:"ReturnTime"})]}):o()({BaseShape:"IdOnly"})}function l(){return c}},887:function(e,t,n){"use strict";var r=n(274).a["__core-js_shared__"];t.a=r},888:function(e,t,n){"use strict";function r(e){switch(e.type){case"folder":return e.folderId;case"group":return e.groupId.toLowerCase();case"category":return e.categoryId;case"persona":var t=e;return t.personaId||t.mainEmailAddress;case"privatedistributionlist":return"FavoritePdl";case"publicFolder":return e.publicFolderId;default:return}}n.d(t,"a",function(){return r})},889:function(e,t,n){"use strict";t.a=function(e){return e&&e.Smime&&e.Smime.isDecoded}},897:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return c});var r=n(508),o=n(5);function i(e){return function(e,t){return s({isPinned:t,returnTime:e.returnTime,receivedOrRenewedTime:e.lastDeliveryOrRenewTimeStamp,receivedTime:e.lastDeliveryTimeStamp})}(e,Object(r.b)(e))}function a(e){return function(e,t){return s({isPinned:t,returnTime:e.ReturnTime,receivedOrRenewedTime:e.ReceivedOrRenewTime,receivedTime:e.DateTimeReceived})}(e,Object(r.c)(e))}function s(e){if(!c())return!1;var t,n=e.returnTime,r=e.receivedOrRenewedTime,o=e.receivedTime,i=e.isPinned;return!!n||!i&&r&&(t=o,!(new Date(r).setMilliseconds(0)==new Date(t).setMilliseconds(0)))}function c(){return Object(o.d)("tri-snooze")||Object(o.d)("tri-snooze-exp")}},922:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.smallFluid=0]="smallFluid",e[e.smallFixedFar=1]="smallFixedFar",e[e.smallFixedNear=2]="smallFixedNear",e[e.medium=3]="medium",e[e.large=4]="large",e[e.largeFixed=5]="largeFixed",e[e.extraLarge=6]="extraLarge",e[e.custom=7]="custom",e[e.customNear=8]="customNear"}(r||(r={}))},923:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("DELETE_ITEMS_STORE_UPDATE",function(e,t){return{itemContexts:e,parentFolderId:t}})},924:function(e,t,n){"use strict";var r=n(1),o=Object(r.actionCreator)("ADD_CHAT_TAB",function(e){return{chatConversationId:e}});t.a=o},934:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown"}(r||(r={}))},939:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n(0),o=n(2),i=n(227),a=n(146),s=n(58),c=n(1008),u=n(131),l=Object(a.a)(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.type,n=e.size,a=e.ariaLabel,u=e.ariaLive,d=e.styles,f=e.label,p=e.theme,m=e.className,g=e.labelPosition,v=a,h=Object(s.f)(this.props,s.e,["size"]),y=n;void 0===y&&void 0!==t&&(y=t===i.b.large?i.a.large:i.a.medium);var b=l(d,{theme:p,size:y,className:m,labelPosition:g});return o.createElement("div",r.__assign({},h,{className:b.root}),o.createElement("div",{className:b.circle}),f&&o.createElement("div",{className:b.label},f),v&&o.createElement("div",{role:"status","aria-live":u},o.createElement(c.a,null,o.createElement("div",{className:b.screenReaderText},v))))},t.defaultProps={size:i.a.medium,ariaLive:"polite",labelPosition:"bottom"},t}(u.a)},940:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var r=n(0),o=n(2),i=n(146),a=n(1323),s=n(772),c=n(115),u=n(58),l=n(131),d=n(555),f=n(942),p=n(319),m=Object(i.a)(),g=function(e){function t(n){var r=e.call(this,n)||this;return r._tooltipHost=o.createRef(),r._closingTimer=-1,r.show=function(){r._toggleTooltip(!0)},r.dismiss=function(){r._hideTooltip()},r._onTooltipMouseEnter=function(e){var n=r.props.overflowMode;if(t._currentVisibleTooltip&&t._currentVisibleTooltip!==r&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=r,void 0!==n){var o=r._getTargetElement();if(o&&!Object(a.b)(o))return}e.target&&Object(s.a)(e.target,r._getTargetElement())||(r._toggleTooltip(!0),r._clearDismissTimer())},r._onTooltipMouseLeave=function(e){r.props.closeDelay?(r._clearDismissTimer(),r._closingTimer=r._async.setTimeout(function(){r._toggleTooltip(!1)},r.props.closeDelay)):r._toggleTooltip(!1),t._currentVisibleTooltip===r&&(t._currentVisibleTooltip=void 0)},r._clearDismissTimer=function(){r._async.clearTimeout(r._closingTimer)},r._hideTooltip=function(){r._toggleTooltip(!1)},r.state={isTooltipVisible:!1},r}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.calloutProps,n=e.children,i=e.content,a=e.delay,s=e.directionalHint,l=e.directionalHintForRTL,d=e.hostClassName,p=e.id,g=e.setAriaDescribedBy,v=void 0===g||g,h=e.tooltipProps,y=e.styles,b=e.theme;this._classNames=m(y,{theme:b,className:d});var _=this.state.isTooltipVisible,S=p||Object(c.c)("tooltip"),C=!!(i||h&&h.onRenderContent&&h.onRenderContent()),O=_&&C,I=v&&_&&C?S:void 0;return o.createElement("div",r.__assign({className:this._classNames.root,ref:this._tooltipHost},{onFocusCapture:this._onTooltipMouseEnter},{onBlurCapture:this._hideTooltip},{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,"aria-describedby":I}),n,O&&o.createElement(f.a,r.__assign({id:S,delay:a,content:i,targetElement:this._getTargetElement(),directionalHint:s,directionalHintForRTL:l,calloutProps:Object(c.a)({},t,{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave}),onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave},Object(u.f)(this.props,u.e),h)))},t.prototype.componentWillUnmount=function(){t._currentVisibleTooltip&&t._currentVisibleTooltip===this&&(t._currentVisibleTooltip=void 0)},t.prototype._getTargetElement=function(){if(this._tooltipHost.current){var e=this.props.overflowMode;if(void 0!==e)switch(e){case d.a.Parent:return this._tooltipHost.current.parentElement;case d.a.Self:return this._tooltipHost.current}return this._tooltipHost.current}},t.prototype._toggleTooltip=function(e){var t=this;this.state.isTooltipVisible!==e&&this.setState({isTooltipVisible:e},function(){return t.props.onTooltipToggle&&t.props.onTooltipToggle(t.state.isTooltipVisible)})},t.defaultProps={delay:p.a.medium},t}(l.a)},941:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n(0),o=n(2),i=n(146),a=n(58),s=n(319),c=n(1286),u=n(67),l=Object(i.a)(),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderContent=function(e){return o.createElement("p",{className:t._classNames.subText},e.content)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.calloutProps,i=e.delay,s=e.directionalHint,u=e.directionalHintForRTL,d=e.styles,f=e.id,p=e.maxWidth,m=e.onRenderContent,g=void 0===m?this._onRenderContent:m,v=e.targetElement,h=e.theme;return this._classNames=l(d,{theme:h,className:t||n&&n.className,delay:i,maxWidth:p}),o.createElement(c.a,r.__assign({target:v,directionalHint:s,directionalHintForRTL:u},n,Object(a.f)(this.props,a.e,["id"]),{className:this._classNames.root}),o.createElement("div",{className:this._classNames.content,id:f,role:"tooltip",onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},g(this.props,this._onRenderContent)))},t.defaultProps={directionalHint:u.DirectionalHint.topCenter,delay:s.a.medium,maxWidth:"364px",calloutProps:{isBeakVisible:!0,beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1}},t}(o.Component)},942:function(e,t,n){"use strict";var r=n(637),o=n(941),i=n(319),a=n(14);n.d(t,"a",function(){return s});var s=Object(r.a)(o.a,function(e){var t=e.className,n=e.delay,r=e.maxWidth,o=e.theme,s=o.palette,c=o.fonts;return{root:["ms-Tooltip",o.fonts.medium,a.AnimationClassNames.fadeIn200,{background:s.white,padding:"8px",animationDelay:"300ms",maxWidth:r},n===i.a.zero&&{animationDelay:"0s"},n===i.a.long&&{animationDelay:"500ms"},t],content:["ms-Tooltip-content",c.small,{color:s.neutralPrimary,wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden"}],subText:["ms-Tooltip-subtext",{fontSize:"inherit",fontWeight:"inherit",color:"inherit",margin:0}]}},void 0,{scope:"Tooltip"})},946:function(e,t,n){"use strict";var r=9007199254740991;t.a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},947:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(156);function o(e){return{headers:Object(r.c)(e,"GroupMailbox")}}},948:function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"b",function(){return c});var r=n(793);function o(e,t){if(null==e&&null!=t||null!=e&&null==t)return!1;if(null==e&&null==t)return!0;if(0==e.length&&0==t.length)return!0;if(e.length!=t.length)return!1;for(var n=0;n<e.length;){if(!i(e[n],t[n]))return!1;n++}return!0}function i(e,t){return!(!e&&t||e&&!t)&&(e.Id===t.Id||Object(r.a)(e.PostalAddress)&&Object(r.a)(t.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===t.PostalAddress.LocationUri.toLowerCase())}function a(e,t){return e&&Object(r.a)(t.PostalAddress)?s(e,t.PostalAddress.LocationUri):c(e,t.Id)}function s(e,t){return e&&e.some(function(e){return Object(r.a)(e.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===t.toLowerCase()})}function c(e,t){return e&&e.some(function(e){return e.Id===t})}},949:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a});var r=n(9),o=n(7);function i(e){return!!(e&Object(r.a)().UserOptions.FavoritesBitFlags)}var a=Object(o.action)("setBit")(function(e,t){e?Object(r.a)().UserOptions.FavoritesBitFlags|=t:Object(r.a)().UserOptions.FavoritesBitFlags&=~t})},95:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(37);function o(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(e)||"none"}},950:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a});var r=n(152),o={};function i(e,t){o[r.a[e]]=t}function a(e){return o[r.a[e]]}},951:function(e,t,n){"use strict";var r=n(0),o=n(575),i=n(26),a=n(41),s=n(375),c=n(15),u=n(3),l={left:0,top:0,height:600,width:800,location:!1,menubar:!1,resizable:!0,scrollbars:!1,status:!1,toolbar:!1},d=new u.c(function(){return n.e(325).then(n.bind(null,11938))}),f=new u.b(d,function(e){return e.handleMessageFromParentWindow});t.a=Object(i.b)("addPopoutV2",{name:"PopoutAddPopout",customData:function(e,t,n,r,o,i){return[(t||"").split("/")[0],i]}})(function(e,t,n,i,u,d){var m;o.a.popouts||(f.import(),window.addEventListener("message",p),o.a.popouts=[]);var g=Object(a.q)(e,t,u,((m={}).version=Object(c.i)(),m[s.a]=s.b,m));try{var v=window.open(g,"_blank",function(e){var t=r.__assign({},l,e);return Object.getOwnPropertyNames(t).map(function(e){return e+"="+("boolean"==typeof(n=t[e])?n?"1":"0":n?String(n):void 0);var n}).join(",")}(i)),h="function"==typeof n?n:function(){return Promise.resolve(n)};o.a.popouts.push({window:v,dataCallback:h})}catch(e){}});function p(e){f.import().then(function(t){return t(e)})}},954:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="ows/api/beta/outlookfavorites"},955:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),o=n(252),i=/cv=([^&]+)&?.*$/;function a(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s;return r.__generator(this,function(r){switch(r.label){case 0:t=!1,r.label=1;case 1:return r.trys.push([1,4,,5]),[4,e()];case 2:return[4,(n=r.sent()).text().then(function(e){return e?JSON.parse(e):{}})];case 3:if(a=r.sent(),Object(o.a)(n.status))return[2,a];throw t=!0,d=n.status,f=n.url,p=a&&a.error&&a.error.code,v=(g=f)&&g.match(i),m=v&&2===v.length?decodeURIComponent(v[1]):"No CV was found",{message:"Request failed with Status Code: "+d+" - Error Code: "+p+" --- cV: "+m,statusCode:d,correlationVector:m};case 4:if(s=r.sent(),t)throw s;throw u=(c=s)?c.message:"No error message",l=c?c.stack:"No error stack",{message:"Request failed with a network error - ErrorMessage: "+u+" - ErrorStack: "+l,statusCode:void 0,correlationVector:c.correlationVector};case 5:return[2]}var c,u,l,d,f,p,m,g,v})})}},956:function(e,t,n){"use strict";function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.filter(function(e){return null!=e}).join(" ").trim();return""===n?void 0:n}n.d(t,"a",function(){return r})},964:function(e,t,n){"use strict";var r=n(1220),o=n(1),i={sweepDestinationFolderId:null,isSweepDialogShown:!1,sweepOptionType:r.a.All,sweepRequestStatus:0};t.a=Object(o.createStore)("sweepStore",i)()},968:function(e){e.exports={a:"naa",c:"oaa",d:"paa",b:"qaa"}},969:function(e){e.exports={a:"sqb",c:"tqb",b:"uqb",d:"vqb"}},991:function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(9),o="HTML",i="Text",a="Html";function s(){return Object(r.a)().UserOptions.ComposeMarkup==a?"HTML":"Text"}},993:function(e,t,n){"use strict";var r=n(8),o=n(1),i={attachments:new r.ObservableMap({})},a=Object(o.createStore)("attachment",i);t.a=a},994:function(e,t,n){"use strict";var r=function(e){return e&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(e)},o=n(4),i=n(320);function a(e){switch(e.__type){case i.e:return 0;case i.n:return e.IsLink?3:1;case i.i:return 3;case i.g:return 2;case i.h:var t=e;return r(e.EmbeddedItemClass)||Object(o.g)(t.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+e.__type)}}n.d(t,"a",function(){return a})},997:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(298),o=n(810);function i(e,t,n){switch(t.tableQuery.listViewType){case 0:Object(r.a)(e,t.id).instrumentationContext=n;break;case 1:Object(o.a)(e,t.id).instrumentationContext=n}}},999:function(e){e.exports={a:"Cqb"}}},0,[4,7,8,19,336,0,1,30,474,155,3,469,120,2,271,10,11,242,6,9,107,29,67,307,523,21,20,397,12,37,103,263,38,189,463,87,464,98,483,206,97,195,295,379,445,447]]);
//# sourceMappingURL=owa.Addins.js.map
self.scriptsLoaded['owa.Addins.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Addins.js'] = (new Date()).getTime();