self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ConversationAttachment.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[159],{1024:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(1460);n.d(t,"c",function(){return r.a});var o=n(2526);n.d(t,"d",function(){return o.a});var a=n(1165);n.d(t,"e",function(){return a.a}),n.d(t,"b",function(){return a.b});var i=n(3),c=new i.c(function(){return n.e(197).then(n.bind(null,3494))}),s=Object(i.d)(c,function(e){return e.CloudIconWithOverlay})},1074:function(e,t,n){var r=n(1317),o=36e5,a=6e4,i=2,c=/[T ]/,s=/:/,l=/^(\d{2})$/,u=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],d=/^(\d{4})/,p=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],m=/^-(\d{2})$/,h=/^-?(\d{3})$/,f=/^-?(\d{2})-?(\d{2})$/,b=/^-?W(\d{2})$/,v=/^-?W(\d{2})-?(\d{1})$/,x=/^(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,_=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/([Z+-].*)$/,O=/^(Z)$/,j=/^([+-])(\d{2})$/,I=/^([+-])(\d{2}):?(\d{2})$/;function C(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var o=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+o),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?i:Number(n);var y=function(e){var t,n={},r=e.split(c);if(s.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]),t){var o=w.exec(t);o?(n.time=t.replace(o[1],""),n.timezone=o[1]):n.time=t}return n}(e),S=function(e,t){var n,r=u[t],o=p[t];if(n=d.exec(e)||o.exec(e)){var a=n[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(n=l.exec(e)||r.exec(e)){var i=n[1];return{year:100*parseInt(i,10),restDateString:e.slice(i.length)}}return{year:null}}(y.date,n),k=S.year,A=function(e,t){if(null===t)return null;var n,r,o,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=m.exec(e))return r=new Date(0),o=parseInt(n[1],10)-1,r.setUTCFullYear(t,o),r;if(n=h.exec(e)){r=new Date(0);var i=parseInt(n[1],10);return r.setUTCFullYear(t,0,i),r}if(n=f.exec(e)){r=new Date(0),o=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,o,c),r}if(n=b.exec(e))return a=parseInt(n[1],10)-1,C(t,a);if(n=v.exec(e)){a=parseInt(n[1],10)-1;var s=parseInt(n[2],10)-1;return C(t,a,s)}return null}(S.restDateString,k);if(A){var E,P=A.getTime(),D=0;return y.time&&(D=function(e){var t,n,r;if(t=x.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*o;if(t=g.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*o+r*a;if(t=_.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var i=parseFloat(t[3].replace(",","."));return n%24*o+r*a+1e3*i}return null}(y.time)),y.timezone?(V=y.timezone,E=(N=O.exec(V))?0:(N=j.exec(V))?(M=60*parseInt(N[2],10),"+"===N[1]?-M:M):(N=I.exec(V))?(M=60*parseInt(N[2],10)+parseInt(N[3],10),"+"===N[1]?-M:M):0):(E=new Date(P+D).getTimezoneOffset(),E=new Date(P+D+E*a).getTimezoneOffset()),new Date(P+D+E*a)}var V,N,M;return new Date(e)}},10926:function(e){e.exports={a:"L5b"}},10927:function(e,t,n){var r=n(10928),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},10928:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'._1pPFwx5rYgxcgAElMzLbAd{display:block;width:261px}html[dir] ._1pPFwx5rYgxcgAElMzLbAd._3JHQes77teu7GToIsCc_xE,html[dir] ._1pPFwx5rYgxcgAElMzLbAd:focus,html[dir] ._1pPFwx5rYgxcgAElMzLbAd:hover{background:"[theme:neutralLighter, default:#f4f4f4]"}._1pPFwx5rYgxcgAElMzLbAd._3JHQes77teu7GToIsCc_xE ._302eciisr8EpJrDSwH_Sbx,._1pPFwx5rYgxcgAElMzLbAd:hover ._302eciisr8EpJrDSwH_Sbx{width:142px}._Y2ypFk_xp-nvQtuGu_-h{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;position:relative}._3wcJ_rB4jUxKLkaKrKj_GZ{display:block}html[dir] ._3wcJ_rB4jUxKLkaKrKj_GZ{margin:6px 8px}._2Pr_qifjTGwPB6L_eo24_B{font-size:24px;color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._2Pr_qifjTGwPB6L_eo24_B{background:transparent}._1Ra5rtzVEB6uogdqQiC2rx{display:block;white-space:nowrap;position:relative;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}html[dir] ._1Ra5rtzVEB6uogdqQiC2rx{padding:6px 4px}._3EsA8G8nIiVlrwi7EvfneN{font-size:14px}._3EsA8G8nIiVlrwi7EvfneN,._302eciisr8EpJrDSwH_Sbx{font-weight:400;max-width:194px}._302eciisr8EpJrDSwH_Sbx{font-size:11px}html[dir] ._302eciisr8EpJrDSwH_Sbx{padding-top:3px}._302eciisr8EpJrDSwH_Sbx .GeukVsgtTix5zrmhP2k1C{font-size:12px;font-weight:400;font-weight:600;position:relative;top:2px}html[dir=ltr] ._302eciisr8EpJrDSwH_Sbx .GeukVsgtTix5zrmhP2k1C{padding-right:4px}html[dir=rtl] ._302eciisr8EpJrDSwH_Sbx .GeukVsgtTix5zrmhP2k1C{padding-left:4px}._302eciisr8EpJrDSwH_Sbx ._1DD8d7Q5IxT7aE8KaVPUKa{color:#107c10}._302eciisr8EpJrDSwH_Sbx ._23Ys9CLV_lGJ3w0LIHTfLi{color:#e81123}._2Tuvy48k5aBpiLeRkrcceY{overflow:hidden;text-overflow:ellipsis}._2aO0rTKW0ac8YNFb8bLNnA{height:26px;width:52px;position:absolute;bottom:0;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}html[dir=ltr] ._2aO0rTKW0ac8YNFb8bLNnA{right:0}html[dir=rtl] ._2aO0rTKW0ac8YNFb8bLNnA{left:0}.CO4JS_CRPsg_js1AAXe-d{display:block;height:100%;width:26px;position:absolute;bottom:0}html[dir=ltr] .CO4JS_CRPsg_js1AAXe-d{right:0}html[dir=rtl] .CO4JS_CRPsg_js1AAXe-d{left:0}html[dir] .CO4JS_CRPsg_js1AAXe-d:focus,html[dir] .CO4JS_CRPsg_js1AAXe-d:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}.GeukVsgtTix5zrmhP2k1C{font-size:14px}html[dir] .GeukVsgtTix5zrmhP2k1C{margin:0}.KLhaPYQ6nYXemE5yXxev7{font-size:12px;font-weight:400;line-height:30px;cursor:pointer;width:261px;-webkit-box-sizing:border-box;box-sizing:border-box;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}html[dir=ltr] .KLhaPYQ6nYXemE5yXxev7{padding:0 20px 0 54px}html[dir=rtl] .KLhaPYQ6nYXemE5yXxev7{padding:0 54px 0 20px}html[dir] .KLhaPYQ6nYXemE5yXxev7:focus,html[dir] .KLhaPYQ6nYXemE5yXxev7:hover{background:"[theme:neutralLight, default:#eaeaea]"}html[dir] ._1pk_VDuef6gt4o_QRNLHAe{margin-top:-4px}._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator-itemName{display:none}._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator,._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-itemProgress,._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{height:4px}html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator,html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-itemProgress,html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{padding:0}',""]),t.locals={container:"_1pPFwx5rYgxcgAElMzLbAd",active:"_3JHQes77teu7GToIsCc_xE",secondLine:"_302eciisr8EpJrDSwH_Sbx",innerContainer:"_Y2ypFk_xp-nvQtuGu_-h",thumbnailDiv:"_3wcJ_rB4jUxKLkaKrKj_GZ",placeholder:"_2Pr_qifjTGwPB6L_eo24_B",infoDiv:"_1Ra5rtzVEB6uogdqQiC2rx",firstLine:"_3EsA8G8nIiVlrwi7EvfneN",icon:"GeukVsgtTix5zrmhP2k1C",success:"_1DD8d7Q5IxT7aE8KaVPUKa",failure:"_23Ys9CLV_lGJ3w0LIHTfLi",textOverFlow:"_2Tuvy48k5aBpiLeRkrcceY",actionsContainer:"_2aO0rTKW0ac8YNFb8bLNnA",menuButton:"CO4JS_CRPsg_js1AAXe-d",menuItem:"KLhaPYQ6nYXemE5yXxev7",progressIndicator:"_1pk_VDuef6gt4o_QRNLHAe"}},10929:function(e,t,n){var r=n(10930),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},10930:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,"._3h6BOcXe5rgJt2gWiPg7WW{overflow-y:auto;overflow-x:hidden}",""]),t.locals={container:"_3h6BOcXe5rgJt2gWiPg7WW"}},10931:function(e,t,n){var r=n(10932),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},10932:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'._2I3DVKJX90XpSU9E0jOrPI{color:"[theme:neutralDark, default:#212121]"}html[dir] ._2I3DVKJX90XpSU9E0jOrPI{border-radius:2px;border-color:transparent}html[dir] ._2I3DVKJX90XpSU9E0jOrPI:not(:hover){background-color:transparent}._2I3DVKJX90XpSU9E0jOrPI.ms-Button{min-width:50px}html[dir] ._2I3DVKJX90XpSU9E0jOrPI.ms-Button{padding:0}html[dir=ltr] .jflLAFNOz_OPbbqzYM9gl{margin-left:2px}html[dir=rtl] .jflLAFNOz_OPbbqzYM9gl{margin-right:2px}._1kEgpc1Wh6CbzQbd6iET2p{font-size:10px}html[dir] ._1kEgpc1Wh6CbzQbd6iET2p{margin:2px 6px 0 6px}._3JXvFMglzZ7tMbYPkjKuKC{font-size:14px;font-weight:400}html[dir] ._3JXvFMglzZ7tMbYPkjKuKC{margin:0}',""]),t.locals={button:"_2I3DVKJX90XpSU9E0jOrPI",icon:"jflLAFNOz_OPbbqzYM9gl",menuIcon:"_1kEgpc1Wh6CbzQbd6iET2p",label:"_3JXvFMglzZ7tMbYPkjKuKC"}},1165:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return m});var r,o=n(1822),a=n(1460),i=n(494),c={};function s(e){return e in c?c[e]:(c[e]={extraSmall:Object(a.a)(e+"_16x16"),small:Object(a.a)(e+"_20x20"),medium:Object(a.a)(e+"_32x32"),large:Object(a.a)(e+"_64x64"),cdn:-1===p.indexOf(e)?Object(o.a)(e+"_16x16"):Object(o.a)("generic_16x16")},c[e])}var l="generic",u=Object.freeze({".3g2":"video",".3gp":"video",".aac":"audio",".accdb":"accdb",".accdc":"accdb",".accde":"accdb",".accdr":"accdb",".accdt":"accdb",".acs":"accdb",".ai":"vector",".aiff":"audio",".ape":"audio",".asf":"video",".aspx":"code",".asx":"video",".avi":"video",".bmp":"photo",".csv":"csv",".dib":"photo",".dgn":"vector",".doc":"docx",".docm":"docx",".docx":"docx",".dot":"dotx",".dotm":"docx",".dotx":"dotx",".email":"email",".emf":"vector",".eml":"email",".eps":"vector",".exe":"exe",".flac":"audio",".flv":"video",".gdraw":"vector",".gif":"photo",".htm":"code",".html":"code",".ical":"calendar",".icalendar":"calendar",".ico":"photo",".ics":"calendar",".indd":"vector",".indt":"vector",".jfif":"photo",".jpe":"photo",".jpeg":"photo",".jpg":"photo",".log":"txt",".lync":l,".m1v":"video",".m4a":"audio",".mdb":"accdb",".mht":"code",".mov":"video",".mp2":"audio",".mp3":"audio",".mp4":"video",".mpa":"audio",".mpe":"video",".mpeg":"video",".mpg":"video",".mpp":"project",".mpt":"mpt",".mpv2":"video",".msg":"email",".odp":"pptx",".ods":"xlsx",".odt":"docx",".ogg":"audio",".one":"one",".onepkg":"onetoc",".onetoc":"onetoc",".onetoc2":"onetoc",".oxps":"vector",".pd":"vector",".pdf":"pdf",".plt":"vector",".png":"photo",".pot":"pptx",".potm":"pptx",".potx":"potx",".ppa":"pptx",".ppam":"pptx",".pps":"pptx",".ppsm":"pptx",".ppsx":"ppsx",".ppt":"pptx",".pptm":"pptx",".pptx":"pptx",".pro":"vector",".ps":"vector",".psd":"photo",".pub":"pblsh",".rpmsg":"rpmsg",".rtf":"txt",".sketch":"vector",".srt":"video",".svg":"vector",".svgz":"vector",".swf":"video",".tif":"photo",".tiff":"photo",".txt":"txt",".url":"link",".vcs":"calendar",".vdx":"vsdx",".vob":"video",".vsd":"vsdx",".vsdx":"vsdx",".vsl":"vsdx",".vss":"vsdx",".vssx":"vssx",".vst":"vstx",".vstx":"vstx",".wav":"audio",".wm":"audio",".wma":"audio",".wmd":"video",".wmf":"vector",".wms":"video",".wmv":"video",".wmz":"video",".wps":"docx",".wri":"docx",".xcl":"xlsx",".xd":"vector",".xla":"xlsx",".xlam":"xlsx",".xls":"xlsx",".xlsb":"xlsx",".xlsm":"xlsx",".xlsx":"xlsx",".xlt":"xlsx",".xltm":"xlsx",".xltx":"xltx",".xml":"code",".xps":"vector",".xsn":"infopath",".zip":"zip"}),d=Object.freeze({"application/vnd.google-apps.document":"gdoc","application/vnd.google-apps.spreadsheet":"gsheet","application/vnd.google-apps.presentation":"gslide","application/vnd.google-apps.form":"gform","application/onenote":"one","application/pdf":"pdf"}),p=["gdoc","gform","gsheet","gslide"];function m(e,t,n){if(void 0===t&&(t=!1),t)return r=r||{extraSmall:null,small:Object(a.a)("folder_20x20"),medium:Object(a.a)("folder_32x32"),large:Object(a.a)("folder_64x64"),cdn:Object(o.a)("folder_16x16")};var c,p=Object(i.a)(e);return p&&(c=u[p.toLowerCase()]),!c&&n&&n in d&&(c=d[n]),s(c||l)}},11818:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(10926),a=n(7159),i=n(4),c=n(20),s=n(4510),l=n(6369),u=n(1),d=Object(u.mutatorAction)("updateConversationAttachmentWellMaxHeight",function(e){e.maxHeight=(window.innerHeight||document.body.clientHeight)-200}),p=n(7623),m=n(1462),h=n(2),f=n(14),b=n(51),v=n(1166),x=n(209),g=n(4381),_=n(53),w=n(18),O=n(522),j=n(7156),I=n(7629),C=n(7333),y=n(297),S=n(1482),k=n(4323),A=n(2675),E=n(5),P=n(494),D=n(1024),V=n(166),N=n(386),M=n(12),L=n(10927),T=n(126).bind(L),F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.keyDown=function(e){e.keyCode!==_.a.enter&&e.keyCode!==_.a.space||t.onClick()},t.keyDownForMenuButton=function(e){e.keyCode!==_.a.enter&&e.keyCode!==_.a.space||(M.c.info("AttachmentMenuButton.keyDown enter|space"),e.stopPropagation())},t.onClick=function(e){var n=Object(O.e)(t.props.attachmentViewState.strategy);if(n!==O.a.NoAction){var r=j.c.OnClick,o=r.name,a=r.customData;Object(w.o)(o,a(n)),Object(k.c)(t.props.attachmentViewState,N.c.ConversationAttachmentWell,t.props.instrumentationContext,t.props.parentItemId,!1,t.props.onBeforePreview,t.props.createImageGallery,t.containerElement.parentElement)}},t.onContextMenu=function(e){e.preventDefault(),Object(s.a)(t.props.attachmentViewState,t.contextMenuJustOpened=!0)},t.onMenuButtonClicked=function(e){e.stopPropagation(),Object(s.a)(t.props.attachmentViewState,t.contextMenuJustOpened=!t.props.attachmentViewState.shouldShowContextMenu)},t.onContainerElementUpdate=function(e){t.containerElement=e},t.onFocusOrMouseOver=function(){t.props.onFocus&&t.props.onFocus(t.props.attachmentViewState.attachmentId.Id)},t}return r.__extends(t,e),t.prototype.render=function(){var e=Object(S.a)(this.props.attachmentViewState.attachmentId),t=13===e.attachmentClass&&Object(E.d)("cal-ics-preview");return h.createElement("div",{"aria-label":e.model.Name,ref:this.onContainerElementUpdate,onFocus:this.onFocusOrMouseOver,onKeyDown:this.keyDown,onMouseOver:this.onFocusOrMouseOver,className:T(L.container,{active:this.props.attachmentViewState.shouldShowContextMenu}),tabIndex:0,"data-is-focusable":!0,onClick:this.onClick,onContextMenu:this.onContextMenu},h.createElement("div",{className:L.innerContainer},this.renderIcon(e),this.renderInfo(e),this.props.attachmentViewState.strategy.showActionsMenu&&this.props.attachmentViewState.shouldShowActionsContainer&&h.createElement("div",{className:L.actionsContainer},h.createElement(j.a,{attachmentViewState:this.props.attachmentViewState,isForImageView:!1,previewState:N.a.None,shouldNotHandleOnBlur:!0,isForAddToCalendar:t}),h.createElement(v.a,{"data-is-focusable":!1,className:L.menuButton,onClick:this.onMenuButtonClicked,onKeyDown:this.keyDownForMenuButton,iconProps:{iconName:this.props.attachmentViewState.shouldShowContextMenu?"ChevronUp":"ChevronDown",styles:{root:L.icon}}}))),this.renderProgressIndicator(),this.props.attachmentViewState.shouldShowContextMenu?this.renderContextMenu(e):null)},t.prototype.renderIcon=function(e){var t=y.o.tryImportForRender();if(t&&t(e.model)){var n=e.model.Name,r=Object(D.e)(n),o=null,a=Object(f.getIconClassName)("Photo2");return Object(P.d)(n)&&(o=r.small,a=r.small),h.createElement("div",{className:L.thumbnailDiv},h.createElement(A.c,{attachmentViewState:this.props.attachmentViewState,placeHolderCSSClass:T(a,L.placeholder),fileIconCssClass:o,imageLoadErrorCSSClass:r.small,thumbnailWidth:32,thumbnailHeight:32}))}return h.createElement(A.b,{attachmentId:this.props.attachmentViewState.attachmentId})},t.prototype.renderInfo=function(e){var t=1!==e.type&&0===this.props.attachmentViewState.actionMessage?{text:Object(V.a)(this.props.itemReceivedTime),title:null,shouldDisplaySuccessIcon:!1,shouldDisplayFailureIcon:!1}:Object(I.a)(this.props.attachmentViewState,e);return h.createElement("div",{className:L.infoDiv},h.createElement("div",{className:T(L.firstLine,L.textOverFlow),title:e.model.Name},e.model.Name),h.createElement("div",{className:T(L.secondLine,L.textOverFlow),title:t.title},t.shouldDisplaySuccessIcon?h.createElement(x.a,{iconName:"Accept",className:T(L.icon,L.success)}):null,t.shouldDisplayFailureIcon?h.createElement(x.a,{iconName:"Cancel",className:T(L.icon,L.failure)}):null,t.text))},t.prototype.renderContextMenu=function(e){var t=this,n=j.d.tryImportForRender(),r=n?n(this.props.attachmentViewState,e,{viewState:this.props.attachmentViewState,previewPaneSelectionSource:N.c.ConversationAttachmentWell,parentItemId:this.props.parentItemId,isDraft:!1,onBeforePreview:this.props.onBeforePreview,createImageGallery:this.props.createImageGallery,instrumentationContext:this.props.instrumentationContext},this.props.parentItemId,null,this.containerElement.parentElement,null):[];return h.createElement("div",null,r.map(function(e){return h.createElement(z,{key:e.key,attachmentViewState:t.props.attachmentViewState,menuItem:e})}))},t.prototype.renderProgressIndicator=function(){return Object(C.a)(this.props.attachmentViewState)?h.createElement("div",{className:L.progressIndicator},h.createElement(g.a,{percentComplete:this.props.attachmentViewState.actionCompletePercent})):null},t.prototype.componentDidUpdate=function(e,t){if(this.contextMenuJustOpened&&(this.contextMenuJustOpened=!1,this.props.attachmentViewState.shouldShowContextMenu)){var n=this.containerElement.parentElement.clientHeight,r=this.containerElement.parentElement.scrollTop,o=this.containerElement.offsetHeight,a=this.containerElement.offsetTop;o+a>n+r?this.containerElement.parentElement.scrollTop=o+a-n:a<r&&(this.containerElement.parentElement.scrollTop=a)}},t=r.__decorate([c.observer],t)}(h.Component),z=Object(b.a)(function(e){var t=h.useCallback(function(t){t.stopPropagation(),e.menuItem.onClick(t,e.menuItem),Object(s.a)(e.attachmentViewState,!1)},[e.menuItem,e.attachmentViewState]),n=h.useCallback(function(t){t.keyCode!==_.a.enter&&t.keyCode!==_.a.space||(t.stopPropagation(),e.menuItem.onClick(),Object(s.a)(e.attachmentViewState,!1))},[e.menuItem,e.attachmentViewState]);return h.createElement("div",{tabIndex:0,"data-is-focusable":!0,className:L.menuItem,onClick:t,onKeyDown:n},e.menuItem.name)}),R=n(10929),B=n(126).bind(R),H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onItemFocused=function(e){t.props.viewState.docViewAttachments.forEach(function(t){Object(l.a)(t,t.attachmentId.Id===e),t.shouldShowContextMenu&&t.attachmentId.Id!==e&&Object(s.a)(t,!1)})},t.onResize=function(){d(t.props.viewState)},t.createImageGallery=function(){return r.__awaiter(t,void 0,void 0,function(){return r.__generator(this,function(e){return[2,Object(p.a)(this.props.viewState,!0)]})})},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.onResize(),m.a.importAndExecute(this.onResize)},t.prototype.componentWillUnmount=function(){m.c.importAndExecute(this.onResize)},t.prototype.render=function(){var e=this;return h.createElement("div",{className:B("disableTextSelection","customScrollBar",R.container),style:{maxHeight:this.props.viewState.maxHeight+"px"}},this.props.viewState.docViewAttachments.map(function(t){return h.createElement(F,{key:"convoWell_"+t.attachmentId.Id,attachmentViewState:t,parentItemId:e.props.viewState.parentItemIdMap[t.attachmentId.Id],itemReceivedTime:e.props.viewState.itemReceivedTimeMap[t.attachmentId.Id],instrumentationContext:e.props.instrumentationContext,onBeforePreview:e.props.onBeforePreview,onFocus:e.onItemFocused,createImageGallery:e.createImageGallery})}))},t=r.__decorate([c.observer],t)}(h.Component),X=n(1452),Y=n(1286),W=n(67),q=Object(u.mutatorAction)("setConversationAttachmentWellVisible",function(e,t){e.isVisible=t}),J=n(10931),G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dismissCallout=function(){q(t.props.viewState,!1),t.props.viewState.docViewAttachments.forEach(function(e){Object(s.a)(e,!1)})},t.onShowMenuClicked=function(){q(t.props.viewState,!t.props.viewState.isVisible)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.viewState.docViewAttachments.length;if(0===t)return null;var n=t+(this.props.canLoadMore?"+":"");return h.createElement("div",{className:this.props.className||""},h.createElement("div",{ref:function(t){return e.buttonElement=t}},h.createElement(X.a,{onClick:this.onShowMenuClicked,text:n,className:J.button,iconProps:{iconName:"Attach",styles:{root:J.icon}},menuIconProps:{iconName:"ChevronDown",styles:{root:J.menuIcon}},ariaLabel:this.getAriaLabel(),styles:{label:J.label}})),this.props.viewState.isVisible?h.createElement(Y.a,{setInitialFocus:!0,isBeakVisible:!1,target:this.buttonElement,onDismiss:this.dismissCallout,directionalHint:W.DirectionalHint.bottomRightEdge},h.createElement(H,{viewState:this.props.viewState,instrumentationContext:this.props.instrumentationContext,onBeforePreview:this.dismissCallout})):null)},t.prototype.getAriaLabel=function(){var e=this.props.viewState.docViewAttachments.length;return e>1?Object(i.b)(Object(i.a)(a.a),e):Object(i.b)(Object(i.a)(o.a),e)},t=r.__decorate([c.observer],t)}(h.Component);n.d(t,"ConversationAttachmentWellButton",function(){return G})},1282:function(e,t,n){"use strict";var r=n(1271);function o(e){window.open(e,"_blank")}function a(e,t,n,r){if(t)o(e);else{var a=document.createElement("a");a.style.display="none",a.href=e,a.download=r||"",n||(n=document.activeElement&&document.activeElement.parentElement||document.body),n.appendChild(a),a.click(),n.removeChild(a)}}var i=n(747);function c(e,t){a(Object(r.a)(e,t,0,Object(i.b)(t),!1,!0),!1)}var s=n(0),l=n(494),u=n(2561),d=n(2157);function p(e,t){return s.__awaiter(this,void 0,void 0,function(){var n,o;return s.__generator(this,function(a){switch(a.label){case 0:return".pdf"!==Object(l.a)(t.Name).toLowerCase()?[3,1]:(n=Object(r.a)(e,t,3,Object(i.b)(t),!1),window.open(n,"_blank"),[3,3]);case 1:return Object(l.c)(t.Name)?[4,Object(u.a)(e,t,Object(i.b)(t))]:[3,3];case 2:o=a.sent(),d.a.importAndExecute(function(e){var t=document.createElement("div"),n=document.createElement("img");return n.src=e,t.appendChild(n),t.innerHTML}(o),"img {max-width: 100%; max-height: 100%; width: auto;  }"),a.label=3;case 3:return[2]}})})}var m=n(2562),h=n(2563),f=n(944);function b(e){var t=Object(f.f)(e,!0),n=Object(l.a)(e.Name);return Object(h.a)(t,e,n)}function v(e){var t=Object(l.a)(e.Name);return b(e)&&t&&(".pdf"===t.toLowerCase()&&Object(m.a)()||Object(l.c)(e.Name))}n.d(t,"a",function(){return c}),n.d(t,"f",function(){return p}),n.d(t,"d",function(){return v}),n.d(t,"c",function(){return b}),n.d(t,"b",function(){return a}),n.d(t,"e",function(){return o})},1317:function(e,t){e.exports=function(e){return e instanceof Date}},1460:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3026),o="fileType-icon";function a(e){return r[function(e){return o+"-"+e}(e)]}},1822:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=1;function o(e){return"https://r"+(r++%4+1)+".res.outlook.com/owa/prem/images/"+e+".png"}},2157:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3),o=new r.c(function(){return n.e(327).then(n.bind(null,3497))}),a=new r.a(o,function(e){return e.print})},2303:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}},2307:function(e,t,n){var r=n(3014),o=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*o)}},2526:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r,o=n(1165),a=n(1822);function i(e,t,n,i,c){if(n)return r=r||{extraSmall:Object(o.b)("generic").extraSmall,small:Object(o.b)("generic").small,medium:Object(o.b)("blockedfile").medium,large:Object(o.b)("generic").large,cdn:Object(a.a)("generic_16x16")};switch(c){case"IPM.Note":case"IPM.Note.SMIME":case"IPM.Note.SMIME.MultipartSigned":return Object(o.b)("email");case"IPM.Schedule":case"IPM.Appointment":case"IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}":return Object(o.b)("calendar")}return i?Object(o.b)("sharedfolder"):Object(o.a)(e,!1,t)||Object(o.b)("generic")}},2539:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(2303);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetAccessTokenforDataProvider",e,t)}},2675:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c});var r=n(3),o=new r.c(function(){return Promise.all([n.e(2),n.e(6),n.e(9),n.e(11),n.e(107)]).then(n.bind(null,3508))}),a=Object(r.d)(o,function(e){return e.AttachmentThumbnailView}),i=Object(r.d)(o,function(e){return e.AttachmentIconView}),c=Object(r.d)(o,function(e){return e.AttachmentDocInfoView})},3014:function(e,t,n){var r=n(1074);e.exports=function(e,t){var n=r(e).getTime(),o=Number(t);return new Date(n+o)}},3756:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59);t.default=function(e,t){return r.makeServiceRequest("GetWacAttachmentInfo",e,t)}},3914:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),o=n(2),a=n(146),i=Object(a.a)(),c=.01,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderProgress=function(e){var n=t.props,r=n.ariaValueText,a=n.barHeight,s=n.className,l=n.styles,u=n.theme,d="number"==typeof t.props.percentComplete?Math.min(100,Math.max(0,100*t.props.percentComplete)):void 0,p=i(l,{theme:u,className:s,barHeight:a,indeterminate:void 0===d}),m={width:void 0!==d?d+"%":void 0,transition:void 0!==d&&d<c?"none":void 0},h=void 0!==d?0:void 0,f=void 0!==d?100:void 0,b=void 0!==d?Math.floor(d):void 0;return o.createElement("div",{className:p.itemProgress},o.createElement("div",{className:p.progressTrack}),o.createElement("div",{className:p.progressBar,style:m,role:"progressbar","aria-valuemin":h,"aria-valuemax":f,"aria-valuenow":b,"aria-valuetext":r}))},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.barHeight,n=e.className,a=e.label,c=void 0===a?this.props.title:a,s=e.description,l=e.styles,u=e.theme,d=e.progressHidden,p=e.onRenderProgress,m=void 0===p?this._onRenderProgress:p,h="number"==typeof this.props.percentComplete?Math.min(100,Math.max(0,100*this.props.percentComplete)):void 0,f=i(l,{theme:u,className:n,barHeight:t,indeterminate:void 0===h});return o.createElement("div",{className:f.root},c?o.createElement("div",{className:f.itemName},c):null,d?null:m(r.__assign({},this.props,{percentComplete:h}),this._onRenderProgress),s?o.createElement("div",{className:f.itemDescription},s):null)},t.defaultProps={label:"",description:"",width:180},t}(o.Component)},4251:function(e,t,n){"use strict";function r(e,t){return-1!==t.strategy.supportedMenuActions.indexOf(e)}n.d(t,"a",function(){return r})},4323:function(e,t,n){"use strict";var r=n(0),o=n(297),a=n(1482),i=n(1282),c=n(1015);function s(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var s,l;return r.__generator(this,function(r){switch(r.label){case 0:return(s=Object(a.a)(e))?Object(o.e)(s.model)?[4,c.e.import()]:[3,2]:[2];case 1:return r.sent()(s.model),[3,3];case 2:(l=s.download.url)&&Object(i.b)(l,t,n),r.label=3;case 3:return[2]}})})}var l=n(3),u=n(386);n.d(t,"c",function(){return p}),n.d(t,"d",function(){return m}),n.d(t,"a",function(){return u.c}),n.d(t,"b",function(){return s});var d=new l.c(function(){return Promise.all([n.e(2),n.e(6),n.e(9),n.e(11),n.e(107)]).then(n.bind(null,11894))}),p=new l.a(d,function(e){return e.clickAttachment}).importAndExecute,m=new l.a(d,function(e){return e.previewAttachment})},4330:function(e){e.exports={a:"hVa"}},4381:function(e,t,n){"use strict";var r=n(637),o=n(3914),a=n(14),i=n(249),c={root:"ms-ProgressIndicator",itemName:"ms-ProgressIndicator-itemName",itemDescription:"ms-ProgressIndicator-itemDescription",itemProgress:"ms-ProgressIndicator-itemProgress",progressTrack:"ms-ProgressIndicator-progressTrack",progressBar:"ms-ProgressIndicator-progressBar"},s=Object(a.keyframes)({"0%":{left:"-30%"},"100%":{left:"100%"}}),l=Object(a.keyframes)({"100%":{right:"-30%"},"0%":{right:"100%"}});n.d(t,"a",function(){return u});var u=Object(r.a)(o.a,function(e){var t,n,r=Object(i.a)(),o=e.className,u=e.indeterminate,d=e.theme,p=e.barHeight,m=void 0===p?2:p,h=d.palette,f=d.semanticColors,b=Object(a.getGlobalClassNames)(c,d),v=h.neutralLight;return{root:[b.root,d.fonts.medium,{fontWeight:a.FontWeights.regular},o],itemName:[b.itemName,a.noWrap,{color:f.bodyText,fontSize:a.FontSizes.medium,paddingTop:4,lineHeight:20}],itemDescription:[b.itemDescription,{color:f.bodySubtext,fontSize:a.FontSizes.xSmall,lineHeight:18}],itemProgress:[b.itemProgress,{position:"relative",overflow:"hidden",height:m,padding:"8px 0"}],progressTrack:[b.progressTrack,{position:"absolute",width:"100%",height:m,backgroundColor:v,selectors:(t={},t[a.HighContrastSelector]={borderBottom:"1px solid WindowText"},t)}],progressBar:[{backgroundColor:h.themePrimary,height:m,position:"absolute",transition:"width .3s ease",width:0,selectors:(n={},n[a.HighContrastSelector]={backgroundColor:"WindowText"},n)},u?{position:"absolute",minWidth:"33%",background:"linear-gradient(to right, "+v+" 0%, "+h.themePrimary+" 50%, "+v+" 100%)",animation:(r?l:s)+" 3s infinite"}:{transition:"width .15s linear"},b.progressBar]}},void 0,{scope:"ProgressIndicator"})},4400:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ImportCalendarEventJsonRequest:#Exchange"},e)}},4435:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SaveAttachmentsToCloudRequest:#Exchange"},e)}},4501:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(4400);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("ImportCalendarEvent",e,t)}},4502:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ImportCalendarEventRequest:#Exchange"},e)}},4581:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FileAttachment:#Exchange"},e)}},4714:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},e)}},4715:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},e)}},4716:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},e)}},4717:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},e)}},4932:function(e){e.exports={a:"kzb"}},4954:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(4435);t.default=function(e,t){return void 0===e.requestObject||e.requestObject.__type||(e.requestObject=o.default(e.requestObject)),r.makeServiceRequest("SaveAttachmentsToCloud",e,t)}},4963:function(e){e.exports={a:"mVa"}},5497:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(4714);t.default=function(e,t){return void 0===e.requestObject||e.requestObject.__type||(e.requestObject=o.default(e.requestObject)),r.makeServiceRequest("ConvertLocalToRefAttachment",e,t)}},5498:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(4715);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("CancelConvertLocalToRefAttachment",e,t)}},5499:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(4716);t.default=function(e,t){return void 0===e.requestObject||e.requestObject.__type||(e.requestObject=o.default(e.requestObject)),r.makeServiceRequest("ConvertRefToLocalAttachment",e,t)}},5500:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(4717);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("CancelConvertRefToLocalAttachment",e,t)}},5592:function(e,t,n){"use strict";var r=n(0),o=n(4963),a=n(4),i=n(20),c=n(1166),s=n(53),l=n(18),u=n(3592),d=n(6367),p=n(6035),m=n(6368),h=n(297),f=n(1482),b=n(4282),v=n(1282),x=n(1015),g=n(386),_=n(12),w=n(2),O=n(5593),j=n(4251),I=n(5),C=n(203),y=n(7157),S=function(e){function t(t){var n=e.call(this,t)||this;return n.keyDown=function(e){e.keyCode!==s.a.enter&&e.keyCode!==s.a.space||(_.c.info("AttachmentSurfaceActionButton.keyDown enter|space"),e.stopPropagation(),n.props.isForAddToCalendar?Object(m.a)(n.props.attachmentViewState,p.a.SurfaceAction):n.downloadAttachment())},n.handleOnFocus=function(){return Object(O.b)(n.props.attachmentViewState,n.props.isForImageView)},n.handleOnBlur=function(){n.props.shouldNotHandleOnBlur||Object(O.a)(n.props.attachmentViewState,n.props.isForImageView)},n.downloadAttachment=function(){return r.__awaiter(n,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return(e=Object(f.a)(this.props.attachmentViewState.attachmentId))?(Object(l.o)("AttachmentDownload",{entryPoint:"SurfaceAction",isCloudy:this.props.attachmentViewState.isCloudy,isCompose:!this.props.attachmentViewState.isReadOnly},{cosmosOnlyData:JSON.stringify({size:e.model.Size,fileType:Object(b.a)(e),attachmentId:e.model.AttachmentId&&e.model.AttachmentId.Id})}),Object(h.e)(e.model)?[4,x.e.import()]:[3,2]):(_.c.error("AttachmentSurfaceActionButton.downloadAttachment attachmentModel is null"),[2]);case 1:return t.sent()(e.model),[3,3];case 2:Object(v.b)(e.download.url,this.props.attachmentViewState.isCloudy,document.body),t.label=3;case 3:return[2]}})})},n.onClickButton=n.onClickButton.bind(n),n}return r.__extends(t,e),t.prototype.render=function(){if(this.getShouldHideButton())return null;var e=void 0,t=this.getAttachmentStyle(this.props.previewState);e=this.props.isForImageView?C([y.downloadButton,y.downloadButtonForImageView,this.props.customClassName]):this.props.attachmentViewState.isReadOnly?C([y.downloadButton,t,this.props.customClassName]):C([y.downloadButton,t,y.downloadButtonForDocViewInCompose,this.props.customClassName]);var n=this.props.isForAddToCalendar?"AddEvent":"Download";return w.createElement(c.a,{onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onKeyDown:this.keyDown,ariaLabel:Object(a.a)(o.a),title:Object(a.a)(o.a),onClick:this.onClickButton,className:e,iconProps:{iconName:n,styles:{root:y.icon}}})},t.prototype.onClickButton=function(e){_.c.info("AttachmentSurfaceActionButton.onclick"),e.stopPropagation(),this.props.isForAddToCalendar?Object(m.a)(this.props.attachmentViewState,p.a.SurfaceAction):this.downloadAttachment()},t.prototype.getShouldHideButton=function(){var e=this.props.attachmentViewState;return!Object(j.a)(u.a.Download,e)||!Object(d.a)(e)||0!==e.ongoingAction||!this.props.attachmentViewState.strategy.showActionsMenu},t.prototype.getAttachmentStyle=function(e){switch(e){case g.a.Edit:return Object(I.d)("doc-attachment-editingVisualFeature")?y.editWithVisualFeature:y.edit;case g.a.NotSelectedAndSaving:return y.notSelectedAndSaving;case g.a.OtherSaving:return y.attachmentView;case g.a.Selected:return y.selected;case g.a.SelectedAndPending:return y.selectedAndPending;case g.a.SelectedAndSaving:return y.selectedAndSaving;default:return y.default}},t=r.__decorate([i.observer],t)}(w.Component);t.a=S},5593:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return d});var r=n(6369),o=n(2335),a=n(2619),i={},c=null;function s(e,t){i[e.attachmentId.Id]&&(clearTimeout(i[e.attachmentId.Id]),i[e.attachmentId.Id]=null),c=e.attachmentId.Id,Object(r.a)(e,!0),t&&!Object(a.a)(e)&&Object(o.a)(e,!0)}function l(e,t){i[e.attachmentId.Id]&&clearTimeout(i[e.attachmentId.Id]),i[e.attachmentId.Id]=setTimeout(function(){Object(r.a)(e,!1),t&&!Object(a.a)(e)&&Object(o.a)(e,!1),e.attachmentId.Id===c&&(c=null),i[e.attachmentId.Id]=null},40)}function u(e,t){Object(r.a)(e,!0),t&&!Object(a.a)(e)&&Object(o.a)(e,!0)}function d(e,t){e.attachmentId.Id!==c&&(Object(r.a)(e,!1),t&&!Object(a.a)(e)&&Object(o.a)(e,!1))}},5594:function(e,t,n){"use strict";t.a={OnClick:{name:"AttachmentOnClick",customData:function(e){return[e]}}}},6035:function(e,t,n){"use strict";t.a={SurfaceAction:"Surface action",ContextMenu:"Context menu"}},6036:function(e){e.exports={a:"_yb"}},6037:function(e){e.exports={a:"Qyb"}},6089:function(e){e.exports={a:"Bzb"}},6155:function(e,t,n){"use strict";function r(e,t){var n,r,o=(n=e,null!=(r=new RegExp("^https?\\:\\/\\/([\\w\\.-]+)(?:\\:[0-9]{1,4})?.*$","i").exec(n))&&r.length>1?r[1].toLowerCase():null);return null!=o?o:t}var o=n(6330),a=n(494);function i(e,t){var n=t.model.Name;if(e.isCloudy){var r=t;if(r.openUrl)n+="\n \n"+r.openUrl;else{var o=t.model;o.AttachLongPathName&&(n+="\n \n"+o.AttachLongPathName)}}return n}function c(e,t){if(e.isCloudy){var n=t.model;if(e.isReadOnly)return{text:r(t.openUrl,n.AttachLongPathName||null),title:null};var i=t.info&&t.info.sharingInfo&&t.info.sharingInfo.expirationDate,c=Object(o.a)(n.PermissionType,n.ProviderType,i,e.isPlaceholderAttachment);return{text:c,title:c}}var s=t.model.Size>0?Object(a.e)(t.model.Size):null;return{text:s,title:s}}n.d(t,"a",function(){return i}),n.d(t,"b",function(){return c})},6330:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(7035),o=n(4),a=n(4018),i=n(5),c=n(420),s=n(428);function l(e,t,n,l){return void 0===n&&(n=null),void 0===l&&(l=!1),null==e||l?null:Object(i.d)("doc-attachment-referenceAttachmentExpiration")&&n&&Object(c.a)(n,Object(s.a)())?Object(o.b)(Object(o.a)(r.a),n):Object(a.e)(e,t)}},6367:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(297),o=n(1482);function a(e){var t=Object(o.a)(e.attachmentId);return!!t&&(!!Object(r.e)(t.model)||t.download.url&&t.info&&t.info.allowDownload)}},6368:function(e,t,n){"use strict";n.d(t,"a",function(){return h}),n.d(t,"b",function(){return f});var r=n(6036),o=n(4),a=n(18),i=n(3592),c=n(4432),s=n(2530),l=n(6035),u=n(1482),d=n(4282),p=n(5),m=n(4251);function h(e,t){var n=Object(u.a)(e.attachmentId),r=Object(d.a)(n);Object(a.o)("AddToCalendar",[t,n.model.Size,r]),n.model.Size>10485760||!e.attachmentId||!e.attachmentId.Id?Object(s.a)(e,0,15):(Object(c.a)(e,0),Object(i.z)(Object(i.i)(n.model.Size),.1,function(t){Object(i.v)(e,t)},e.attachmentId))}function f(e){var t=Object(u.a)(e.attachmentId);return Object(m.a)(i.a.ImportCalendarEventAttachment,e)&&t&&13===t.attachmentClass&&Object(p.d)("cal-ics-preview")?{name:Object(o.a)(r.a),key:"AddToCalendar",onClick:function(){h(e,l.a.ContextMenu)}}:null}},6369:function(e,t,n){"use strict";var r=n(7);t.a=Object(r.action)("setShouldShowActionsContainer")(function(e,t){e.shouldShowActionsContainer=t})},6370:function(e){e.exports={a:"Ryb"}},7035:function(e){e.exports={a:"gzb"}},7156:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"d",function(){return s});var r=n(5592);n.d(t,"a",function(){return r.a});var o=n(3),a=n(5594);n.d(t,"c",function(){return a.a});var i=new o.c(function(){return Promise.all([n.e(2),n.e(6),n.e(9),n.e(11),n.e(107)]).then(n.bind(null,8126))}),c=Object(o.d)(i,function(e){return e.AttachmentView}),s=new o.b(i,function(e){return e.getContextMenus})},7157:function(e,t,n){var r=n(7158),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},7158:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'._3QZNNyRu4bsfxs-OL7OQfF{font-size:14px;color:"[theme:neutralSecondary, default:#666666]";height:25px;width:26px}html[dir] ._3QZNNyRu4bsfxs-OL7OQfF{padding:4px;text-align:center}._3QZNNyRu4bsfxs-OL7OQfF:focus,._3QZNNyRu4bsfxs-OL7OQfF:hover,._3OW4PWuPDMXJ3j1YO3R8q_{color:"[theme:neutralSecondary, default:#666666]"}._3OW4PWuPDMXJ3j1YO3R8q_{display:block}._9IveE8fsson3asxDhih-X{bottom:0;position:absolute;color:"[theme:white, default:#ffffff]"}html[dir=ltr] ._9IveE8fsson3asxDhih-X{right:26px}html[dir=rtl] ._9IveE8fsson3asxDhih-X{left:26px}._9IveE8fsson3asxDhih-X:focus,._9IveE8fsson3asxDhih-X:hover{color:"[theme:white, default:#ffffff]"}html[dir] ._9IveE8fsson3asxDhih-X:focus,html[dir] ._9IveE8fsson3asxDhih-X:hover{background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] ._9IveE8fsson3asxDhih-X:focus,html[dir=ltr] ._9IveE8fsson3asxDhih-X:hover{border-bottom-right-radius:2px}html[dir=rtl] ._9IveE8fsson3asxDhih-X:focus,html[dir=rtl] ._9IveE8fsson3asxDhih-X:hover{border-bottom-left-radius:2px}._3YIYA63PW-wIVkxR2Su9w3{font-size:14px}html[dir] ._3YIYA63PW-wIVkxR2Su9w3{margin:0}html[dir] ._1-hVXxvfDp0xe0VVvmfkXI:focus,html[dir] ._1-hVXxvfDp0xe0VVvmfkXI:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] .tbC07jvl9ABO08CjRkR9G,html[dir] .u4MtH9lbDLor4YGZBCHkj,html[dir] .pjl51ZJco7p4lHev54DwN,html[dir] .hnWaZkVaaCryiaMDmw1gh,html[dir] ._2WYO4FLw4GnoQDNjqX1tF0,html[dir] ._2mWLOTqEFbyTpIo_Dy3kO6,html[dir] ._3Rg1o7_N0DLI2zwxeFuP5-{margin:0;background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] .tbC07jvl9ABO08CjRkR9G:focus,html[dir] .tbC07jvl9ABO08CjRkR9G:hover,html[dir] .u4MtH9lbDLor4YGZBCHkj:focus,html[dir] .u4MtH9lbDLor4YGZBCHkj:hover,html[dir] .pjl51ZJco7p4lHev54DwN:focus,html[dir] .pjl51ZJco7p4lHev54DwN:hover,html[dir] .hnWaZkVaaCryiaMDmw1gh:focus,html[dir] .hnWaZkVaaCryiaMDmw1gh:hover,html[dir] ._2WYO4FLw4GnoQDNjqX1tF0:focus,html[dir] ._2WYO4FLw4GnoQDNjqX1tF0:hover,html[dir] ._2mWLOTqEFbyTpIo_Dy3kO6:focus,html[dir] ._2mWLOTqEFbyTpIo_Dy3kO6:hover,html[dir] ._3Rg1o7_N0DLI2zwxeFuP5-:focus,html[dir] ._3Rg1o7_N0DLI2zwxeFuP5-:hover{background:"[theme:themeTertiary, default:#71AFE5]"}html[dir] .u4MtH9lbDLor4YGZBCHkj{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}',""]),t.locals={downloadButton:"_3QZNNyRu4bsfxs-OL7OQfF",downloadButtonForDocViewInCompose:"_3OW4PWuPDMXJ3j1YO3R8q_",downloadButtonForImageView:"_9IveE8fsson3asxDhih-X",icon:"_3YIYA63PW-wIVkxR2Su9w3",default:"_1-hVXxvfDp0xe0VVvmfkXI",edit:"tbC07jvl9ABO08CjRkR9G",editWithVisualFeature:"u4MtH9lbDLor4YGZBCHkj",notSelectedAndSaving:"pjl51ZJco7p4lHev54DwN",selected:"hnWaZkVaaCryiaMDmw1gh",selectedAndPending:"_2WYO4FLw4GnoQDNjqX1tF0",selectedAndSaving:"_2mWLOTqEFbyTpIo_Dy3kO6",thematic:"_3Rg1o7_N0DLI2zwxeFuP5-"}},7159:function(e){e.exports={a:"Yyb"}},7332:function(e){e.exports={j:"lzb",k:"mzb",l:"nzb",h:"ozb",i:"pzb",f:"qzb",g:"rzb",n:"szb",o:"tzb",p:"uzb",b:"vzb",m:"wzb",d:"xzb",c:"yzb",a:"zzb",e:"Azb"}},7333:function(e,t,n){"use strict";function r(e){return e.actionCompletePercent>0&&e.actionCompletePercent<=1}n.d(t,"a",function(){return r})},7623:function(e,t,n){"use strict";var r=n(0),o=n(297),a=n(12);function i(e,t){return void 0===t&&(t=!1),r.__awaiter(this,void 0,void 0,function(){var n,i,c,s,l,u,d,p,m,h,f;return r.__generator(this,function(r){switch(r.label){case 0:return n=[],[4,o.i.import()];case 1:return i=r.sent(),[4,o.l.import()];case 2:return c=r.sent(),t?[4,o.o.import()]:[3,4];case 3:return l=r.sent(),[3,5];case 4:l=null,r.label=5;case 5:s=l,u=t?e.docViewAttachments:e.imageViewAttachments,d=0,r.label=6;case 6:if(!(d<u.length))return[3,12];if(p=u[d],m=i(p.attachmentId),t&&!s(m.model))return[3,11];r.label=7;case 7:return r.trys.push([7,9,,10]),[4,c(p.attachmentId,e.isReadOnly)];case 8:return r.sent(),[3,10];case 9:return h=r.sent(),a.c.warn("Unable to refresh thumbnail image for "+p.attachmentId+". Got error "+h),[3,10];case 10:f={downloadUrl:m.download.url,id:p.attachmentId,previewUrl:m.previewImage.url,thumbnailUrl:m.thumbnailImage.url},n.push(f),r.label=11;case 11:return d++,[3,6];case 12:return[2,n]}})})}n.d(t,"a",function(){return i})},7629:function(e,t,n){"use strict";var r=n(4932),o=n(4330),a=n(6089),i=n(6370),c=n(7332),s=n(6037),l=n(4),u=n(420),d=n(428);function p(e){return e&&e.info&&e.info.sharingInfo&&e.info.sharingInfo.expirationDate&&Object(u.a)(e.info.sharingInfo.expirationDate,Object(d.a)())}var m=n(98),h=n(522),f=n(5),b=n(45),v=n(56),x=n(6155);function g(e,t){return t?Object(l.a)(c.h):Object(l.b)(Object(l.a)(c.i),e?Object(l.a)(i.a):Object(l.a)(s.a))}function _(e,t){var n,u=Object(v.a)(),d=void 0!==t.id.mailboxInfo&&t.id.mailboxInfo.type==b.a.GroupMailbox;if(0===e.actionMessage)return function(e,t){var n=Object(x.b)(e,t);return{text:n.text,title:n.title,shouldDisplaySuccessIcon:!1,shouldDisplayFailureIcon:!1,useExpiredAttachmentStyling:Object(f.d)("doc-attachment-referenceAttachmentExpiration")&&p(t)}}(e,t);var _=!1,w=!1;switch(e.actionMessage){case 1:n=function(e,t){if(t)return Object(l.a)(c.j);var n=Object(h.f)();return e?Object(l.b)(Object(l.a)(c.k),Object(l.a)(i.a)):Object(l.b)(Object(l.a)(c.l),n)}(u,d);break;case 5:n=Object(l.a)(c.b);break;case 2:n=g(u,d);break;case 3:n=g(u,d),_=!0;break;case 4:case 9:n=function(e,t){return t?Object(l.a)(c.f):Object(l.b)(Object(l.a)(c.g),e?Object(l.a)(i.a):Object(l.a)(s.a))}(u,d),w=!0;break;case 7:n=Object(l.a)(c.m);break;case 6:n=Object(l.a)(c.d);break;case 8:n=function(e,t){if(t)return Object(l.a)(c.n);var n=Object(h.f)();return e?Object(l.b)(Object(l.a)(c.o),n,Object(l.a)(i.a)):Object(l.b)(Object(l.a)(c.p),n)}(u,d);break;case 10:n=Object(l.a)(c.c);break;case 11:n=Object(l.a)(c.a);break;case 12:n=Object(l.a)(c.e),w=!0;break;case 16:n=Object(l.a)(c.c);break;case 14:n=Object(l.a)(a.a),_=!0;break;case 15:n=Object(l.a)(o.a),w=!0;break;case 13:n=Object(l.a)(r.a);break;case 17:n=Object(l.a)(c.m);break;default:Object(m.a)(e.actionMessage)}return{text:n,title:n,shouldDisplaySuccessIcon:_,shouldDisplayFailureIcon:w,useExpiredAttachmentStyling:!1}}n.d(t,"a",function(){return _})}},0,[2,6,9,11,107,12,37,103,463,87,464,98,498,299,197,367]]);
//# sourceMappingURL=owa.ConversationAttachment.js.map
self.scriptsLoaded['owa.ConversationAttachment.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ConversationAttachment.js'] = (new Date()).getTime();