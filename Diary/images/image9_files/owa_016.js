self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.WorkloadScenarioSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[413],{2438:function(e,t,n){"use strict";n.r(t);var r=n(4227);n.d(t,"loadWorkloadScenarioSettings",function(){return r.a});n(6130),n(5044)},2520:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(c,u){a?u(new Error("The function retry was cancelled")):(r++,e().then(function(e){return c(e)}).catch(function(e){t&&r>=t?u(e):setTimeout(function(){return i(c,u)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return i(e,t)})},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a})},4227:function(e,t,n){"use strict";var r=n(0),a=n(1),i=Object(a.action)("LOAD_WORKLOAD_SCENARIO_SETTINGS"),c=Object(a.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",function(e){return{settings:e}}),u=Object(a.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED"),o=n(75);function s(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}var l="ows/beta/ScenarioSettings";var d=71;function f(e){return 0!=(e&d)}var w=n(299);function v(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return e=["Owa"],f(t=Object(w.b)())&&(n=s(t),e.push(n)),a=function(e){var t=e.join(",");return l+"/?Scenarios="+t}(e),[4,Object(o.b)(a,void 0,void 0,void 0,!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS")];case 1:return i=r.sent(),c={timePanelSelectedView:null,timePanelCalendarIds:[]},i.settings&&i.settings.forEach(function(e){var t;(t=e).calendarIds&&"TimePanelCalendarIds"===t.settingName?c.timePanelCalendarIds=e.calendarIds:function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)&&(c.timePanelSelectedView=e.selectedView)}),[2,c]}})})}var b=n(2520),O=Object(b.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(b.a)(1e4)}),m=null;Object(a.orchestrator)(i,function(){return r.__awaiter(void 0,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),m&&m.cancel(),[4,(m=O(v)).retriableFunc()];case 1:return e=t.sent(),c(e),[3,3];case 2:return t.sent(),u(),[3,3];case 3:return m=null,[2]}})})});function S(e,t){return l+"/"+e+"/"+t}function h(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return f(t=Object(w.b)())?(n=s(t),a=S(n,"TimePanelSelectedView"),i={ViewType:e},[4,Object(o.c)(a,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}function p(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t=S("Owa","TimePanelCalendarIds"),n={CalendarIds:e},[4,Object(o.c)(t,n,void 0,void 0,void 0,!0,void 0)];case 1:return r.sent(),[2]}})})}n.d(t,"a",function(){return i}),n.d(t,"d",function(){return c}),n.d(t,"c",function(){return h}),n.d(t,"b",function(){return p})},5044:function(e,t,n){"use strict";var r=n(4227),a=n(1);function i(e,t){if(0===t.length)return null;t[t.length-1]=e}var c=n(299),u=Object(a.createStore)("timePanelSettingStore",{panelViewStack:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{stack:e||[]}}(2!==Object(c.b)()?"Calendar":"Tasks")});Object(a.mutator)(r.d,function(e){var t=e.settings;t.timePanelSelectedView&&i(t.timePanelSelectedView,u().panelViewStack.stack)});var o=Object(a.action)("pushTimePanelView",function(e){return{newView:e}}),s=Object(a.action)("updateTopTimePanelView",function(e){return{updatedView:e}}),l=Object(a.action)("popTimePanelView");Object(a.mutator)(o,function(e){var t;t=e.newView,u().panelViewStack.stack.push(t)}),Object(a.mutator)(s,function(e){i(e.updatedView,u().panelViewStack.stack)}),Object(a.mutator)(l,function(){var e=u().panelViewStack;e.stack.pop()});var d=n(0),f=n(2520),w=n(12),v=Object(f.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(f.a)(1e3)}),b=null;Object(a.orchestrator)(s,function(e){return d.__awaiter(void 0,void 0,void 0,function(){var t,n;return d.__generator(this,function(a){switch(a.label){case 0:if(t=e.updatedView,"Tasks"!==(i=t)&&"Calendar"!==i)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),b&&b.cancel(),[4,(b=v(function(){return Object(r.c)(t)})).retriableFunc()];case 2:return a.sent(),[3,4];case 3:return n=a.sent(),w.c.warn("viewStackOrchestrator: updateTimePanelSelectedViewService with retry failed: "+n),[3,4];case 4:b=null,a.label=5;case 5:return[2]}var i})})});var O={Conflicts:"Calendar",EventDetails:"Calendar",AttendeeTracking:"Calendar",Calendar:"Calendar",Tasks:"Tasks"};function m(e){return e?O[e]:null}function S(){return m(h())}function h(){var e,t=u().panelViewStack;return 0===(e=t.stack).length?null:e[e.length-1]}function p(){return u().panelViewStack.stack.length}function _(){return-1!==u().panelViewStack.stack.indexOf("Conflicts")}function j(){return-1!==u().panelViewStack.stack.indexOf("AttendeeTracking")}function I(){var e=u().panelViewStack;return p()>=2?e.stack[p()-2]:null}n.d(t,"i",function(){return o}),n.d(t,"j",function(){return s}),n.d(t,"h",function(){return l}),n.d(t,"b",function(){return S}),n.d(t,"a",function(){return h}),n.d(t,"e",function(){return p}),n.d(t,"g",function(){return _}),n.d(t,"f",function(){return j}),n.d(t,"d",function(){return I}),n.d(t,"c",function(){return m})},6130:function(e,t,n){"use strict";var r=n(0),a=n(1),i=Object(a.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS",function(e){return{calendarIds:e}}),c=n(4227),u=n(2520),o=n(12),s=Object(u.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(u.a)(1e3)}),l=null,d=(Object(a.orchestrator)(i,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:t=e.calendarIds,r.label=1;case 1:return r.trys.push([1,3,,4]),l&&l.cancel(),[4,(l=s(function(){return Object(c.b)(t)})).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),o.c.warn("updateSelectedCalendarIdsOrchestrator: updateTimePanelCalendarIdsService with retry failed: "+n),[3,4];case 4:return l=null,[2]}})})}),Object(a.createStore)("timePanelSelectedCalendarIdsStore",{calendarIds:null})),f=(Object(a.mutator)(c.d,function(e){var t=e.settings;t.timePanelCalendarIds&&t.timePanelCalendarIds.length>0&&(d().calendarIds=t.timePanelCalendarIds)}),Object(a.mutator)(i,function(e){var t=e.calendarIds;d().calendarIds=t}),n(926)),w=n(45);function v(){var e=d().calendarIds;return e||function(){var e=Object(f.b)(Object(w.e)().primarySmtpAddress);return e||[]}()}n.d(t,"a",function(){return v})}},0,[463,87]]);
//# sourceMappingURL=owa.WorkloadScenarioSettings.js.map
self.scriptsLoaded['owa.WorkloadScenarioSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.WorkloadScenarioSettings.js'] = (new Date()).getTime();