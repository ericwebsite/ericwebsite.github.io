self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ExpandedListSelectionActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[186],{1160:function(e,t,n){"use strict";var a=n(384),o=n(340),i="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(o.a)(e)&&Object(a.a)(e)==i}},11825:function(e,t,n){"use strict";n.r(t);var a=n(4),o=n(8),i=n(13),r=n(73),c=n(3826),s=n(12);function u(e,t){var n=function(e){var t={},n=r.a.conversationNodes.get(e);for(;n;){if(t[n.internetMessageId]){s.c.error("Invalid loop found in ParentInternetMessageId pointers");break}if(Object(c.b)(n.internetMessageId)&&(t[n.internetMessageId]=!0),Object(a.g)(n.parentInternetMessageId))break;n=r.a.conversationNodes.get(n.parentInternetMessageId)}return t}(e);if(1===Object.keys(n).length)return function(e,t){var n=new o.ObservableMap({});return t.forEach(function(t){var a=r.a.conversationNodes.get(t),o=t===e?i.a.CheckMark:i.a.None;n.set(a.internetMessageId,o)}),n}(e,t);for(var u=new o.ObservableMap({}),d=!1,l=!1,f=0,m=0;m<t.length;m++){var b=r.a.conversationNodes.get(t[m]);n[b.internetMessageId]?(d?f+1===Object.keys(n).length?(u.set(b.internetMessageId,i.a.BusEnd),l=!0):u.set(b.internetMessageId,i.a.BusStop):(u.set(b.internetMessageId,i.a.BusStart),d=!0),f++):!d||l?u.set(b.internetMessageId,i.a.None):u.set(b.internetMessageId,i.a.NoStop)}return u}var d=n(281),l=n(72),f=n(6254),m=n(31),b=n(1);function p(){l.a.expandedConversationViewState.expandedRowKey=null,l.a.expandedConversationViewState.selectedNodeIds=[],l.a.expandedConversationViewState.shouldBeExpanded=!1,l.a.expandedConversationViewState.busStopStateMap=new o.ObservableMap({})}Object(b.mutator)(d.t,function(e){var t=e.nodeId,n=e.allNodeIds,a=l.a.expandedConversationViewState.selectedNodeIds;a.indexOf(t)>-1?(a.splice(a.indexOf(t),1),1===a.length&&(l.a.expandedConversationViewState.busStopStateMap=u(a[0],n))):a.push(t)}),Object(b.mutator)(d.h,function(e){l.a.expandedConversationViewState.busStopStateMap=new o.ObservableMap({})}),Object(b.mutator)(d.q,function(e){var t=e.rowKey,n=e.nodeIdToSelect,a=e.allNodeIds;l.a.expandedConversationViewState.expandedRowKey=t,l.a.expandedConversationViewState.selectedNodeIds=[n],l.a.expandedConversationViewState.busStopStateMap=u(n,a)}),Object(b.mutator)(d.u,function(e){var t=l.a.expandedConversationViewState;e.mailListItemSelectionSource==m.f.MailListItemCheckbox&&t.expandedRowKey!=e.rowKey&&p()}),Object(b.mutator)(d.p,function(e){var t=l.a.expandedConversationViewState;e.shouldSelect||t.expandedRowKey!=e.rowKey||p()}),Object(b.mutator)(d.i,function(e){p()}),Object(b.mutator)(d.k,function(e){p()}),Object(b.mutator)(d.r,function(e){var t=l.a.expandedConversationViewState;e.mailListItemSelectionSource==m.f.MailListItemTwisty&&t.expandedRowKey!=e.rowKey&&(t.expandedRowKey=e.rowKey,t.shouldBeExpanded=!0)}),Object(b.mutator)(d.o,function(e){l.a.expandedConversationViewState.shouldBeExpanded=e.shouldBeExpanded}),Object(b.mutator)(f.a,function(e){if(1===l.a.expandedConversationViewState.selectedNodeIds.length){var t=l.a.expandedConversationViewState.selectedNodeIds[0],n=m.H.conversations.get(e.conversationId).conversationNodeIds;l.a.expandedConversationViewState.busStopStateMap=u(t,n)}});var v=n(0),I=n(2123),h=n(622),g=n(263);Object(b.orchestrator)(d.b,function(e){O(e.itemId,e.tableView,e.nodeId,e.allNodeIds,m.f.MailListItemExpansion)});function O(e,t,n,a,o){Object(h.h)(t,!0,o),g.m.importAndExecute(e),d.q(i.O.expandedConversationViewState.expandedRowKey,n,a,t.id)}function j(e,t){var n,a,o=i.b.getConversationId(e,t),r=m.H.conversations.get(o);try{for(var s=v.__values(r.conversationNodeIds),u=s.next();!u.done;u=s.next()){var d=u.value,l=Object(c.b)(d);if(l){O(l.ItemId.Id,t,d,r.conversationNodeIds,m.f.RowRemoval);break}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}}function S(){d.i()}Object(b.orchestrator)(d.e,function(e){if(e.mailListItemSelectionSource==m.f.MailListItemTwisty){if(1==e.listViewType)throw new Error("Toggle expansion action cannot be called from message view");var t,n;Object(I.a)(e.rowKey)?S():(t=e.rowKey,n=e.tableView,d.o(!1),j(t,n))}}),Object(b.orchestrator)(d.c,function(e){Object(I.a)(e.rowKey)&&S()}),Object(b.orchestrator)(d.m,function(e){for(var t=i.b.getConversationId(e.rowKey,e.tableView),n=m.H.conversations.get(t),a=null,o=null,r=n.conversationNodeIds.indexOf(i.O.expandedConversationViewState.selectedNodeIds[0])+1;r<n.conversationNodeIds.length;r++){var s=n.conversationNodeIds[r],u=Object(c.b)(s);if(u){o=u.ItemId.Id,a=s;break}}a?O(o,e.tableView,a,n.conversationNodeIds,m.f.RowRemoval):j(e.rowKey,e.tableView)});var C=n(5846),P=n(6884),y=(Object(b.orchestrator)(P.a,function(e){Object(C.a)(),1===Object(i.E)().expandedConversationViewState.selectedNodeIds.length&&d.h()}),n(6862)),w=n(644);Object(b.orchestrator)(y.a,function(e){if(i.O.expandedConversationViewState.expandedRowKey){var t=m.H.conversations.get(e.conversationId);d.q(i.O.expandedConversationViewState.expandedRowKey,e.conversationNodeId,t.conversationNodeIds,Object(w.a)())}})},1315:function(e){e.exports={b:"Caa",d:"Daa",c:"Eaa",a:"Faa"}},1625:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a={attachmentTypes:{FILE_ATTACHMENT_TYPE:"FileAttachment:#Exchange",ITEM_ATTACHMENT_TYPE:"ItemAttachment:#Exchange",ITEM_ID_ATTACHMENT_TYPE:"ItemIdAttachment:#Exchange",REFERENCE_ATTACHMENT_TYPE:"ReferenceAttachment:#Exchange"}}},1697:function(e,t,n){"use strict";var a=n(1895);t.a=function(e){var t=Object(a.a)(e),n=t%1;return t==t?n?t-n:t:0}},1711:function(e){e.exports={a:"Mba",b:"Nba"}},1815:function(e,t,n){"use strict";var a=n(345),o=n(1886),i=n(879),r=n(1160),c=1/0,s=a.a?a.a.prototype:void 0,u=s?s.toString:void 0;t.a=function e(t){if("string"==typeof t)return t;if(Object(i.a)(t))return Object(o.a)(t,e)+"";if(Object(r.a)(t))return u?u.call(t):"";var n=t+"";return"0"==n&&1/t==-c?"-0":n}},1827:function(e,t,n){"use strict";n.d(t,"b",function(){return r});var a=n(1),o=n(2149),i={installationStatus:0,isBrowserSupportActiveX:Object(o.a)(),version:""},r=Object(a.createStore)("SmimeStore",i),c=r();t.a=c},1829:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(1827);function o(){var e=Object(a.b)();return 9==e.installationStatus||6==e.installationStatus}},1835:function(e,t,n){"use strict";t.a=function(e,t){void 0===t&&(t=!0);var n=t?23:24;return e>=n?n:e}},1886:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,a=null==e?0:e.length,o=Array(a);++n<a;)o[n]=t(e[n],n,e);return o}},1895:function(e,t,n){"use strict";var a=n(992),o=1/0,i=1.7976931348623157e308;t.a=function(e){return e?(e=Object(a.a)(e))===o||e===-o?(e<0?-1:1)*i:e==e?e:0:0===e?e:0}},1938:function(e,t,n){"use strict";n.d(t,"b",function(){return i});var a=n(2605),o=n(2559);function i(e){return Math.min(Math.floor(e/2),24)}t.a={RPPerfLoadConversationReadingPane:{name:"RPPerfLoadConversationReadingPane"},RPPerfLoadItemReadingPane:{name:"RPPerfLoadItemReadingPane"},RPCountExpCollQuotedText:{name:"RPCountExpCollQuotedText",customData:function(e,t,n){return[n?1:0,!e.isExpanded]}},RPCountExpCollItemPart:{name:"RPCountExpCollItemPart",customData:function(e,t,n){return[t||n?e.isExpanded?"EC":"CE":e==Object(a.b)()?"SC":e.isExpanded?"ES":"CS",t]}},RPCountExpCollSubject:{name:"RPCountExpCollSubject",customData:function(e){return[e&&!e.isSubjectExpanded]}},RPCountLoadMore:{name:"RPCountLoadMore"},RPCountExpCollItemsRollUp:{name:"RPCountExpCollItemsRollUp",customData:function(e,t){return[i(Object(o.a)(e)),t]}},RPCountExpCollAllItemParts:{name:"RPCountExpCollAllItemParts",customData:function(e,t){return[e,t]}},PrintItem:{name:"PrintItem",actionSource:function(e,t){return t}},ReplyByMeeting:{name:"ReplyByMeeting",actionSource:function(e,t,n,a){return a}},ToggleIsCalendarRollUpExpanded:{name:function(e){return e.isExpanded?"RPCollapseCalendarRollUp":"RPExpandCalendarRollUp"}},ToggleCalendarRollUpItemPartExpanded:{name:function(e){return e.isExpanded?"RPCollapseCalendarRollUpItemPart":"RPExpandCalendarRollUpItemPart"}}}},1979:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"GetCalendarEventRequest:#Exchange"},e)}},1980:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(59),o=n(2328);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),a.makeServiceRequest("GetCalendarEvent",e,t)}},2053:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(511);function o(e){return e&&e.ItemId&&0===e.ItemId.Id.indexOf(a.m)}},2133:function(e,t,n){"use strict";var a=n(1815);t.a=function(e){return null==e?"":Object(a.a)(e)}},2137:function(e,t,n){"use strict";t.a=function(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}},2144:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(9);function o(){var e=Object(a.a)();return"ChronologicalNewestOnBottom"==(e.UserOptions?e.UserOptions.ConversationSortOrderReact:"ChronologicalNewestOnBottom")}},2149:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(136);function o(){if(Object(a.g)())try{return new ActiveXObject("htmlfile"),!0}catch(e){return!1}return!1}},2162:function(e,t,n){"use strict";var a=n(2604);t.a=function(e){var t=function(e){return e&&e.Attachments&&e.Attachments.length&&e.Attachments[0]}(e);return Object(a.a)(t)?t:null}},2167:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a="defaultProvider"},2169:function(e,t,n){"use strict";var a=n(2616),o=n(1708),i=n(1938),r=n(2662),c=n(2668),s=n(2663),u=n(2630),d=n(2199),l=n(2617),f=n(26),m=n(5),b=n(194),p=n(246),v=n(73),I=n(1015),h=n(2310),g=n(1827),O=n(2171),j=n(1829),S=n(2402),C=n(2053),P=function(e){return e&&e.Smime&&e.Smime.ErrorState||0},y=n(1838),w=n(889),R=n(811),E=n(12),x=n(18),A=function(e,t){E.c.info("S/MIME: processing S/MIME message. isSmimeAdapterAlreadyUsable: "+Object(j.a)());var n=new x.a("RPProcessSmimeItem",{isCore:!0});return I.q.import().then(function(t){return t(e)}).then(function(){T(e,n,t)}).catch(function(){T(e,n,t)})};function M(e,t,n,i,d,f){if(e.itemId==t.Id){var m=t&&t.Id&&Object(v.c)().items.get(t.Id);e.itemViewState=function(e,t){return{itemId:e.Id,isContextMenuShown:!1,isConversationItemPart:!1,attachmentWell:null,meetingRequestViewState:null,infoBarIds:Object(r.a)(),loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,smartPillViewState:{smartPillBlockVisible:!1},hideSmartReplyFeedbackDialog:!0,isYammerThread:Object(u.a)(t),ampViewState:Object(c.a)(t)}}(t,m),e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!m,e.instrumentationContext=n,m&&(i.addCustomData(Object(s.b)(m,f,d)),o.d.import().then(function(e){e(m)}),Object(l.d)(m)?e.isUnsupportedItem=!0:Object(a.a)(e.itemViewState,!1,{item:m}))}}var N=function(e,t,n,a){return a?a(e):Object(p.j)(e,n?"LoadItemPreviewPane":"LoadItemReadingPane",t,Object(j.a)())},V=function(e,t,n,a,o){var i;return Object(m.d)("rp-smime")&&Object(R.a)(n)?h.a.import().then(function(){return Object(j.a)()&&Object(S.a)(n)?(i=!0,N(e,t,a,o)):n}).then(function(){return A(e,i)}):Promise.resolve()};function T(e,t,n){var a=Object(v.c)().items.get(e&&e.Id);t.addCustomData({smimeInstallationStatus:g.a.installationStatus,smimeType:Object(y.a)(a),numAttachments:_(a),wasReloaded:n}),Object(w.a)(a)?t.end():t.endWithError("ClientError",new Error(P(a).toString()))}function _(e){return e&&e.Attachments&&e.Attachments.length}t.a=Object(f.b)("loadItemReadingPane",i.a.RPPerfLoadItemReadingPane)(function(e,t,n,a,o,r){var c=function(e,t){return{itemId:e.Id,itemViewState:null,isPrint:t,loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(b.b)(),isUnsupportedItem:!1,isSubjectExpanded:!1,instrumentationContext:null,showDownlevelContent:!1}}(e,a);n(c);var s=Object(x.q)(function(e){return e.eventName==i.a.RPPerfLoadItemReadingPane.name}),u=Object(v.c)().items.get(e.Id);!Object(m.d)("ring-dogfood")||a||o||Object(x.o)("RPMailStoreItemsCount",{count:Object(v.c)().items.size});var l=Object(S.a)(u),f=Object(R.a)(u);return f&&u.Smime&&!Object(w.a)(u)&&(u.Smime.ErrorState=0),u&&(u.NormalizedBody&&!l||Object(C.a)(u))?(Object(d.a)(null,e.Id),Object(m.d)("rp-smime")&&f&&!Object(w.a)(u)?(new x.a("RPProcessSmimeItem").addCustomData({wasItemReloaded:!1}),A(e,!1).then(function(){return M(c,e,t,s,a,o)})):(M(c,e,t,s,a,o),Promise.resolve())):new Promise(function(e){return f&&l&&!Object(O.a)()?h.a.import().then(e):e()}).then(function(){return function(e,t,n,a,o,i,r){return N(t,a,i,r).then(function(e){V(t,a,e,i,r)}).then(function(){Object(d.a)(null,t.Id),M(e,t,n,a,o,i)}).catch(function(t){return e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!0,Promise.reject(t)})}(c,e,t,s,a,o,r).then(function(){Object(d.a)(null,e.Id)})})})},2171:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(1827),o=n(2535);function i(){var e=Object(a.b)();return Object(o.k)(e.installationStatus)}},2199:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(2673),o=n(5),i=n(31),r=n(2686);function c(e,t){var n;Object(o.d)("mc-voting")&&(e||t)&&((n=e?Object(a.a)(e):Object(i.t)().items.get(t))&&n.ItemId&&n.ItemId.Id&&r.c.import().then(function(e){return e(n.ItemId.Id)}))}},2202:function(e,t,n){"use strict";var a;!function(e){e[e.Open=0]="Open",e[e.VotingOptionMin=1]="VotingOptionMin",e[e.VotingOptionMax=31]="VotingOptionMax",e[e.First=100]="First",e[e.ReplyToSender=102]="ReplyToSender",e[e.ReplyToAll=103]="ReplyToAll",e[e.Forward=104]="Forward",e[e.ReplyToFolder=108]="ReplyToFolder"}(a||(a={})),t.a=a},2214:function(e){e.exports={c:"Gvb",b:"Hvb",a:"Ivb"}},2308:function(e,t,n){"use strict";var a=n(2137),o=n(1815),i=n(1697),r=n(2133);t.a=function(e,t,n){return e=Object(r.a)(e),n=null==n?0:Object(a.a)(Object(i.a)(n),0,e.length),t=Object(o.a)(t),e.slice(n,n+t.length)==t}},2310:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(3),o=new a.c(function(){return Promise.all([n.e(533),n.e(458)]).then(n.bind(null,3502))}),i=new a.b(o,function(e){return e.SmimeAdapter})},2328:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"GetCalendarEventJsonRequest:#Exchange"},e)}},2392:function(e,t,n){"use strict";var a;n.d(t,"a",function(){return a}),function(e){e[e.None=0]="None",e[e.AmpNotValidated=1]="AmpNotValidated",e[e.AmpValidationFailed=2]="AmpValidationFailed",e[e.AmpValidated=3]="AmpValidated"}(a||(a={}))},2402:function(e,t,n){"use strict";var a=n(2162),o=n(889),i=n(811),r=n(5),c=n(2171),s=n(1829),u=function(){return!!Object(c.a)()&&!Object(s.a)()};t.a=function(e){return Object(r.d)("rp-smime")&&!Object(o.a)(e)&&!u()&&Object(i.a)(e)&&!Object(a.a)(e)}},2422:function(e){e.exports={b:"Evb",a:"Fvb"}},2516:function(e,t,n){"use strict";var a=n(2137),o=n(1815),i=n(1697),r=n(2133);t.a=function(e,t,n){e=Object(r.a)(e),t=Object(o.a)(t);var c=e.length,s=n=void 0===n?c:Object(a.a)(Object(i.a)(n),0,c);return(n-=t.length)>=0&&e.slice(n,s)==t}},2535:function(e,t,n){"use strict";n.d(t,"n",function(){return s}),n.d(t,"m",function(){return u}),n.d(t,"j",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"k",function(){return f}),n.d(t,"f",function(){return m}),n.d(t,"a",function(){return b}),n.d(t,"c",function(){return p}),n.d(t,"g",function(){return v}),n.d(t,"d",function(){return I}),n.d(t,"h",function(){return h}),n.d(t,"e",function(){return O}),n.d(t,"l",function(){return j}),n.d(t,"b",function(){return S});var a=n(2554),o=n(2149),i=n(136),r=n(511),c=n(9);function s(){return Object(i.d)()}function u(e){return function(e){if(e.length<2)return!1;var t=e[0]-parseInt(r.b),n=e[1]-parseInt(r.c);return 0==t&&n>=0}("string"==typeof e?e.split(".").map(function(e){return parseInt(e)}):[])}function d(e){var t="string"==typeof e?e.split("."):[];return t.length&&t[0]!=r.b}function l(){return Object(i.k)()&&(Object(i.g)()&&Object(i.b)()[0]==r.i&&Object(o.a)()||Object(a.a)())}function f(e){return 0!==e}function m(e){var t=[];t.push(e.UserEmailAddress),t.push(e.LogonEmailAddress),t.push(e.UserPrincipalName),t.push(e.UserLegacyExchangeDN);var n=e.UserProxyAddresses;return n&&n.length>0&&n.forEach(function(e){t.indexOf(e)>=0||t.push(e)}),t}function b(e){var t=65001;return e.UseGB18030?t=54936:e.UseISO885915&&(t=28605),t}function p(e){return{AllowUserChoiceOfSigningCertificate:e.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:e.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:e.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:e.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:e.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:e.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:e.CopyRecipientHeaders,OnlyUseSmartCard:e.OnlyUseSmartCard,EncryptionAlgorithms:e.EncryptionAlgorithms,SigningAlgorithms:e.SigningAlgorithms}}function v(e,t){var n=Object(c.a)().SmimeAdminSettings.ClearSign;return t||e&&!n?r.e:r.f}function I(e){return btoa(unescape(encodeURIComponent(e)))}function h(e,t){var n=Object(c.a)().SmimeAdminSettings;return e&&t?n.TripleWrapSignedEncryptedMail?14:12:e?n.ClearSign?11:10:6}function g(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function O(){return r.m+g()+g()+g()+g()}function j(e,t){return t.IsInline&&-1===e.indexOf(t.ContentId)}function S(){return r.d+g()+"@"+g()+"."+g()}},2549:function(e,t,n){"use strict";var a;n.d(t,"a",function(){return a}),function(e){e[e.Item=0]="Item",e[e.Oof=1]="Oof",e[e.FossilizedText=2]="FossilizedText",e[e.GlobalReply=3]="GlobalReply",e[e.SeeMore=4]="SeeMore"}(a||(a={}))},2553:function(e,t,n){"use strict";var a=n(0),o=n(1027),i=n(7),r=Object(i.action)("addInfoBarMessage")(function(e,t,n,i){void 0===n&&(n="0"),-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=a.__spread(e.infoBarIds),i&&(o.b[n]||(o.b[n]={}),o.b[n][t]=i)});t.a=r},2554:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(136),o=n(511);function i(){return Object(a.d)()&&Object(a.j)([o.g])||Object(a.e)()&&Object(a.j)([o.h])}},2559:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"d",function(){return c}),n.d(t,"a",function(){return s});var a=n(73),o=n(5);function i(e){return e&&e.conversationNodeIdsInCollapsedItemsRollUp&&e.conversationNodeIdsInCollapsedItemsRollUp.length>0}function r(e){var t=a.a.conversations.get(e.conversationId.Id);return Object(o.d)("rp-collapsedItemsRollUp")&&(i(e)||t&&t.canLoadMore)}function c(e,t){return e&&e.conversationNodeIdsInCollapsedItemsRollUp&&t&&e.conversationNodeIdsInCollapsedItemsRollUp.includes(t.conversationNodeId)}function s(e){if(!i(e))return 0;var t=e.conversationNodeIdsInCollapsedItemsRollUp,n=e.itemPartsMap,a=t.length;return t.forEach(function(e){var t=n.get(e);t.oofRollUpViewState.oofReplyNodeIds&&(a+=t.oofRollUpViewState.oofReplyNodeIds.length),t.calendarRollUpViewState&&t.calendarRollUpViewState.calendarReponseNodeIds&&(a+=t.calendarRollUpViewState.calendarReponseNodeIds.length)}),a}},2604:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(511),o=n(2516),i=n(2308),r=function(e){return e.ContentType&&(Object(i.a)(e.ContentType,a.w)||Object(i.a)(e.ContentType,a.l))},c=function(e){return e.ContentType&&e.ContentType===a.j};function s(e){return e&&e.Name&&Object(o.a)(e.Name,a.u)&&(r(e)||c(e))}},2605:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return u});var a=n(2549),o=n(306),i=n(7),r=Object(i.select)({conversationReadingPaneState:function(){return o.a.conversationReadingPaneViewState}})(function(e){return e.conversationReadingPaneState&&e.conversationReadingPaneState.focusedItemPart?e.conversationReadingPaneState.focusedItemPart.itemPart:null}),c=Object(i.select)({conversationReadingPaneState:function(){return o.a.conversationReadingPaneViewState}})(function(e){return e.conversationReadingPaneState&&e.conversationReadingPaneState.focusedItemPart?e.conversationReadingPaneState.focusedItemPart.focusedItemArea:null}),s=Object(i.select)({conversationReadingPaneState:function(){return o.a.conversationReadingPaneViewState}})(function(e){return e.conversationReadingPaneState&&e.conversationReadingPaneState.initiallySelectedItemPart?e.conversationReadingPaneState.initiallySelectedItemPart.itemPart:null}),u=Object(i.select)({conversationReadingPaneState:function(){return o.a.conversationReadingPaneViewState}})(function(e,t){var n=r(t),o=c(t);return n==e&&o==a.a.Item})},2611:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(1),o={options:void 0,activeProviders:[n(2167).a],referenceItemId:void 0},i=Object(a.createStore)("mailVotingStore",o);i()},2616:function(e,t,n){"use strict";var a=n(0),o=n(2661),i=n(73),r=n(1127),c=n(7);t.a=Object(c.select)({item:function(e){return i.a.items.get(e.itemId)}})(Object(c.action)("initializeExtendedStateForItemViewState")(function(e,t,n){return void 0===t&&(t=!1),a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(a){switch(a.label){case 0:return[4,Object(o.a)(e,n.item,t)];case 1:return a.sent(),n.item&&r.o.importAndExecute(e,n.item.ItemClass),[2]}})})}))},2617:function(e,t,n){"use strict";n.d(t,"d",function(){return b}),n.d(t,"c",function(){return p}),n.d(t,"a",function(){return v}),n.d(t,"b",function(){return I});var a=n(21),o=n(73),i=n(33),r="IPM.Appointment",c="IPM.Contact",s="IPM.DistList",u="IPM.Task",d="calendar",l="contacts",f="tasks",m="inbox";function b(e){return e&&(h(e.ItemClass)||g(e.ItemClass)||O(e.ItemClass)||j(e.ItemClass))}function p(e){var t=o.a.conversations.get(e),n=o.a.conversationNodes.get(t&&t.conversationNodeIds[0]);if(n){var a=n.itemIds[0];if(b(o.a.items.get(a)))return a}return null}function v(e){var t=o.a.items.get(e);return h(t.ItemClass)?Object(i.a)(d):g(t.ItemClass)||O(t.ItemClass)?Object(i.a)(l):j(t.ItemClass)?Object(i.a)(f):Object(i.a)(m)}function I(e){var t="",n=a.n.folderTable.get(e);return n&&(t=n.DisplayName),t}function h(e){return 0==e.indexOf(r)}function g(e){return 0==e.indexOf(c)}function O(e){return 0==e.indexOf(s)}function j(e){return 0==e.indexOf(u)}},2626:function(e,t,n){"use strict";var a=n(7),o=n(2553),i=Object(a.action)("addInfoBarMessageInReadingPane")(function(e,t,n){Object(o.a)(e,t,e.itemId,n)});t.a=i},2630:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(4),o=n(5),i="Beta-Yammer-Outlook-PoC-2019";function r(e){if(!Object(o.d)("rp-yammer")||!e)return!1;var t=null;return e.UniqueBody?t=e.UniqueBody.Value:e.NormalizedBody&&(t=e.NormalizedBody.Value),!Object(a.g)(t)&&t.indexOf(i)>-1}},2661:function(e,t,n){"use strict";var a=n(0),o=n(2626),i=n(944),r=n(787),c=n(2162),s=n(889),u=n(811),d=n(7);t.a=Object(d.action)("initializeAttachmentsForItem")(function(e,t,n){return void 0===n&&(n=!1),a.__awaiter(this,void 0,void 0,function(){var d;return a.__generator(this,function(a){switch(a.label){case 0:return!t||Object(u.a)(t)&&!function(e,t){if(!Object(c.a)(t))return!0;if(!e.isConversationItemPart&&Object(s.a)(t))return!0;return!1}(e,t)?[2]:e.attachmentWell?[3,2]:[4,r.k.import()];case 1:d=a.sent(),e.attachmentWell=d(!0,!1,""),a.label=2;case 2:return n?[4,r.s.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0)]:[3,4];case 3:return a.sent(),[3,6];case 4:return[4,r.p.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0,!1)];case 5:a.sent(),a.label=6;case 6:return Object(i.e)(t.Attachments).map(i.h).forEach(function(t){return Object(o.a)(e,t)}),[2]}})})})},2662:function(e,t,n){"use strict";function a(){return["unsubscribeInfoBar","safetyBar","infoImportance","infoSensitivity","infoFlagStatus","irmInfoBar","infoMessageSubmitted","agendaMailFeedback","unauthenticatedSender","infoDelegate","infoMeetingAttendeeDoNotForward","infoSMIME","infoSmimeDecodeError","infoSmimeSigned","infoItemPartLoadFailure","infoLastUserAction","infoReadReceiptRequested","translateInfoBar","infoResend","infoPolicyTag","infoMessageApprovalAndVoting","nudged"]}n.d(t,"a",function(){return a})},2663:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return m});var a=n(2144),o=n(306),i=n(73),r=n(1835),c=n(1127),s=n(9),u=n(811),d="Meeting",l="Message";function f(e){var t=0,n=0,s=0,u=0,d=o.a.conversationReadingPaneViewState.itemPartsMap;return d.forEach(function(e){e.isExpanded&&u++;var a=i.a.items.get(e.itemId);a&&(a.IsRead||t++,a.IsDraft&&n++,Object(c.m)(a)&&s++)}),{owa_1:p(),owa_2:Object(a.a)(),owa_3:Object(r.a)(d.size),owa_4:Object(r.a)(u),owa_5:Object(r.a)(t),owa_6:Object(r.a)(s),owa_7:Object(r.a)(n),owa_8:e}}function m(e,t,n){return{owa_1:p(),owa_2:b(e),owa_3:t,owa_4:n,owa_5:Object(u.a)(e)}}function b(e){return Object(c.m)(e)?d:l}function p(){return Object(s.a)().UserOptions.GlobalReadingPanePositionReact}},2668:function(e,t,n){"use strict";var a=n(4);function o(e){return!(!e||Object(a.g)(e.AmpHtmlBody))&&null!=(e.From&&e.From.Mailbox?e.From.Mailbox.EmailAddress:null)}function i(e){return e&&!e.BlockStatus&&(!e.MessageSafety||!e.MessageSafety.MessageSafetyLevel||e.MessageSafety.MessageSafetyLevel<=2)}var r=n(87),c=n(2392);n.d(t,"a",function(){return u});var s=!Object(r.c)()&&!Object(r.e)();function u(e){return{preferAmp:!0,ampAvailability:o(e)&&i(e)&&s?c.a.AmpNotValidated:c.a.None}}},2673:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(2144),o=n(73),i=n(306);function r(e){var t,n=Object(o.c)(),r=n.conversations.get(e),c=r&&r.conversationNodeIds,s=c?c.length:0;if(s>0){var u=Object(i.b)().conversationReadingPaneViewState,d=u&&u.itemPartsMap;if(d){var l=Object(a.a)()?0:s-1,f=d.get(c[l]),m=f?f.itemId:null;t=n.items.get(m)}}return t}},2683:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(2611);function o(){var e=Object(a.a)();return e&&e.options?e.options:[]}},2686:function(e,t,n){"use strict";var a=n(3),o=n(2422),i=n(4),r=n(2202),c=n(6),s=n(1371),u=n(2214),d=n(2683),l=n(2167),f=n(18);function m(e){Object(f.o)("VotingOpportunityOnMessage",{hasUserVoted:e})}var b=n(5),p=n(45);function v(e,t,n){if(Object(b.d)("mc-voting")){var a=e.VotingInformation,f=a.UserOptions.length,v=Number(t(e)),I=v<=f&&v>=r.a.VotingOptionMin&&v<=r.a.VotingOptionMax?a.UserOptions[v-r.a.VotingOptionMin].DisplayName:null;if(I){m(!0);var h=n(e);if(h){var O=Object(c.U)(Object(c.Wb)(h));return Object(i.b)(Object(i.a)(o.b),I,O)}return Object(i.b)(Object(i.a)(o.a),I)}if(!Object(s.a)(e.ParentFolderId.Id)&&e.MailboxInfo.type===p.a.UserMailbox)return function(e){var t=Object(d.a)(),n=t;0==t.length&&e&&e.UserOptions.length>0?n=e.UserOptions.map(function(e){return{provider:l.a,displayName:e.DisplayName}}):m(!1);var a=n.map(function(e){return{displayName:e.displayName,value:e}});return{preActionText:Object(i.a)(u.c),actionLinkText:Object(i.a)(u.b),options:a,onSelect:function(e){return g.importAndExecute(e)},hasSelectionConfirmationDialog:!0,selectionConfirmDialogFormatString:Object(i.a)(u.a)}}(a)}return null}n.d(t,"c",function(){return h}),n.d(t,"b",function(){return g}),n.d(t,"a",function(){return v});var I=new a.c(function(){return n.e(268).then(n.bind(null,11728))}),h=new a.b(I,function(e){return e.loadActiveVotingProviders}),g=new a.a(I,function(e){return e.castVoteForProvider})},3826:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return l});var a=n(0),o=n(73),i=n(1322),r=n(194),c=n(9),s=n(305);function u(e){var t,n,c=e&&e.itemIds?e.itemIds.length:0;if(0==c)return[null,!1,!1];var u=null,d=2==Object(r.c)().type||!Object(r.b)();if(1==c){if(!(u=o.a.items.get(e.itemIds[0])))return[null,!1,!1];d=d||u.ParentFolderId&&u.ParentFolderId.Id==Object(r.b)()}else{var l=null;try{for(var f=a.__values(e.itemIds),m=f.next();!m.done;m=f.next()){var b=m.value,p=o.a.items.get(b);if(!p)return[null,!1,!1];if(p.ParentFolderId&&p.ParentFolderId.Id==Object(r.b)()){u=p,d=!0;break}Object(s.a)(p.ParentFolderId.Id,"sentitems")&&(l=p)}}catch(e){t={error:e}}finally{try{m&&!m.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}u||(u=l||o.a.items.get(e.itemIds[0]))}return[u,d,Object(i.a)(u.ParentFolderId.Id)]}function d(e,t,n){var a=Object(c.a)().UserOptions.HideDeletedItems;return e&&!((e.IsDraft||a)&&t&&!n)}function l(e){var t=o.a.conversationNodes.get(e),n=a.__read(u(t),3),i=n[0],r=n[1];return d(i,n[2],r)?i:null}},4325:function(e,t,n){"use strict";var a=n(0),o=n(5644),i=n(1938),r=n(2662),c=n(306),s=n(2663),u=n(2630),d=n(2668),l=n(1950),f=n(2199),m=n(4362),b=n(5530),p=n(8),v=n(18),I=n(26),h=n(5),g=n(72),O=n(73);function j(e){var t=g.a.conversationItems.get(e);if(t){var n=function(e){var t,n,o,i,r={unreadItemCount:0,totalItemCount:0},c=O.a.conversations.get(e);try{for(var s=a.__values(c.conversationNodeIds),u=s.next();!u.done;u=s.next()){var d=u.value,l=O.a.conversationNodes.get(d);if(!l){r.totalItemCount=0;break}r.totalItemCount+=l.itemIds.length;try{for(var f=(o=void 0,a.__values(l.itemIds)),m=f.next();!m.done;m=f.next()){var b=m.value,p=O.a.items.get(b);if(!p){r.totalItemCount=0;break}r.unreadItemCount+=p.IsRead?0:1}}catch(e){o={error:e}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return r}(e);return t.globalItemIds.length!=n.totalItemCount||t.globalUnreadCount!=n.unreadItemCount}return!1}var S=n(194),C=n(246),P=n(7),y=n(31),w=n(3826);n.d(t,"a",function(){return E});var R=[];var E=Object(P.select)({conversationNodes:function(){return y.H.conversationNodes}})(function(e,t){var n,o=t.conversationNodes.get(e.Id),i=(n=a.__read(Object(w.a)(o),3))[0],c=n[1],s=n[2];if(!Object(w.c)(i,s,c))return[null,null];var l={isExpanded:!1,loadingState:{isLoading:!1,hasLoadFailed:!1}},f=function(e,t,n){return!e.IsRead&&t||e.IsDraft&&!n}(i,c,s),p={mailboxInfo:e.mailboxInfo,Id:i.ItemId.Id};return[{conversationNodeId:e.Id,itemId:p.Id,isConversationItemPart:!0,isExpanded:f,isLocal:c,isDeleted:s,isContextMenuShown:!1,attachmentWell:null,quotedBodyViewState:l,isFossilizedTextExpanded:f,hideSmartReplyFeedbackDialog:!0,meetingRequestViewState:null,infoBarIds:Object(r.a)(),loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,calendarRollUpViewState:Object(m.f)(i.ItemClass),oofRollUpViewState:Object(b.b)(i.ItemClass),isInRollUp:!1,smartPillViewState:{smartPillBlockVisible:!1},isYammerThread:Object(u.a)(i),ampViewState:Object(d.a)(i)},i]});t.b=Object(P.select)({readingPaneStore:function(){return c.a},conversationNodes:function(){return y.H.conversationNodes},conversations:function(){return y.h}})(Object(I.b)("loadConversationReadingPane",i.a.RPPerfLoadConversationReadingPane)(function(e,t,n,a,i,r){var c,u=Promise.resolve();r.readingPaneStore.conversationReadingPaneViewState=function(e,t,n,a,o){return{conversationId:e,conversationSubject:t,conversationCategories:n,initiallySelectedItemPart:null,itemIdToScrollTo:o,itemPartsMap:new p.ObservableMap({}),loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(S.b)(),isSubjectExpanded:!1,unsupportedItemId:null,instrumentationContext:a,attachmentWell:null,calendarInlineComposeViewState:null,focusedItemPart:null,conversationNodeIdsInCollapsedItemsRollUp:[],nodeIdBundledWithSeeMoreMessages:null,isCalendarCardOpen:!1,showDownlevelContent:!1}}(e,n,a,t,i);var d=Object(l.a)(e.Id),m=Object(v.q)();if(Object(h.d)("ring-dogfood")){var b=!1;R.includes(e.Id)?b=!0:R.push(e.Id),Object(v.o)("RPCacheStatus",{hasValidConversationCache:d,hasOpened:b,OpenedCount:R.length})}return d&&(c="Valid",r.conversations.getAndTouch(e.Id),Object(o.a)(e.Id)),d&&!j(e.Id)||(c=d?"Stale":"Not",u=Object(C.i)(e,"LoadConversationReadingPane",m)),u.then(function(){Object(f.a)(e.Id),m.addCustomData(Object(s.a)(c))})}))},4362:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"e",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return l}),n.d(t,"d",function(){return f}),n.d(t,"f",function(){return m}),n.d(t,"h",function(){return b}),n.d(t,"g",function(){return p});var a=n(5),o=n(73),i=n(306),r=n(2144),c=/ipm.schedule.meeting.resp/i,s=/^ipm\.schedule\.meeting\.resp\.pos/i,u=/^ipm\.schedule\.meeting\.resp\.tent/i,d=/^ipm\.schedule\.meeting\.resp\.neg/i,l=/^ipm\.schedule\.meeting\.canceled/i,f=/^ipm\.schedule\.meeting\.request/i;function m(e){return{isCalendarResponse:c.test(e),isCalendarRequest:f.test(e),calendarReponseNodeIds:[],acceptedAttendees:[],tentativeAttendees:[],declinedAttendees:[],proposedNewTimeAttendeesCount:0,isExpanded:!1,isLoading:!0}}function b(e){if(!Object(a.d)("rp-calendarRollup"))return!1;var t=!1;return e&&e.itemPartsMap&&e.itemPartsMap.forEach(function(e){e.calendarRollUpViewState.calendarReponseNodeIds.length&&(t=!0)}),t}function p(){var e=i.a.conversationReadingPaneViewState;if(!e)return null;var t=o.a.conversations.get(e.conversationId.Id);if(!t||!t.conversationNodeIds.length)return null;for(var n=t.conversationNodeIds,a=Object(r.a)(),c=a?n.length-1:0,s=a?-1:1;c>=0&&c<=n.length-1;){var u=n[c],d=e.itemPartsMap.get(u);if(d&&d.calendarRollUpViewState.isCalendarRequest)return u;c+=s}return null}},4825:function(e,t,n){"use strict";function a(e,t,n){var a=n.get(e);return a?t.get(a.parentInternetMessageId):null}n.d(t,"a",function(){return a})},494:function(e,t,n){"use strict";function a(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function o(e){var t=a(e);return t?t.replace(".",""):null}var i=n(1315),r=n(4);function c(e){var t;return e>=1073741824?(e/=1073741824,t=Object(r.a)(i.b)):e>=1048576?(e/=1048576,t=Object(r.a)(i.d)):e>=1024?(e/=1024,t=Object(r.a)(i.c)):t=Object(r.a)(i.a),Object(r.b)(t,Math.round(e))}function s(e){return e&&(t=e,(n=d.exec(t))&&n.length>1&&u[n[1].toLowerCase()]);var t,n}var u={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},d=/^\s*([^;\s]*)(?:;|\s|$)/;var l=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"];function f(e,t){var n=a(e)||s(t);return!!n&&l.indexOf(n.toLowerCase())>=0}var m=n(5),b=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function p(e){if(!Object(m.d)("doc-attachment-documentThumbnail"))return!1;var t=a(e);return!!t&&b.indexOf(t.toLowerCase())>=0}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o}),n.d(t,"e",function(){return c}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return p})},4972:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(5529);function o(e,t){var n=t?t.Value:"",o=Object(a.a)(e);return o||n}},520:function(e,t,n){"use strict";var a,o,i;n.d(t,"c",function(){return a}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i}),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp"}(a||(a={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity"}(o||(o={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(i||(i={}))},5235:function(e,t,n){"use strict";var a=n(1);t.a=Object(a.action)("tryInitializeCalendarCard",function(e){return{conversationId:e}})},5526:function(e,t,n){"use strict";var a=n(0),o=n(2661),i=n(2144),r=n(787),c=n(960),s=n(73),u=n(7);t.a=Object(u.action)("initializeAttachmentsForConversationWell")(Object(u.select)({mailStoreItems:function(){return s.a.items}})(function(e,t){return a.__awaiter(this,void 0,void 0,function(){var n,s,u,d,l,f,m,b,p;return a.__generator(this,function(v){switch(v.label){case 0:return e.itemPartsMap.size>1?e.attachmentWell?[3,4]:[4,c.a.getAttachmentsForConversationWell(e.conversationId)]:[3,11];case 1:return n=a.__read.apply(void 0,[v.sent(),3]),s=n[0],u=n[1],d=n[2],[4,r.m.import()];case 2:return l=v.sent(),e.attachmentWell=l(u,d),[4,r.p.importAndExecute(s,e.conversationId.mailboxInfo,e.attachmentWell,!0,!1)];case 3:v.sent(),v.label=4;case 4:f=a.__spread(e.itemPartsMap.keys()),m=0,v.label=5;case 5:return m<f.length?(b=e.itemPartsMap.get(f[m]))&&(p=t.mailStoreItems.get(b.itemId))?[4,Object(o.a)(b,p,!1)]:[3,8]:[3,9];case 6:return v.sent(),[4,r.q.importAndExecute(b.attachmentWell,e.attachmentWell,a.__assign({},p.ItemId,{mailboxInfo:p.MailboxInfo}),p.DateTimeReceived)];case 7:v.sent(),v.label=8;case 8:return m++,[3,5];case 9:return[4,r.u.importAndExecute(e.attachmentWell,Object(i.a)())];case 10:v.sent(),v.label=11;case 11:return[2]}})})}))},5527:function(e,t,n){"use strict";var a=n(4825),o=n(7);t.a=Object(o.action)("tryAddCalendarNodesInRollUp")(function(e,t,n,o,i){o&&e.forEach(function(e){e.calendarRollUpViewState.calendarReponseNodeIds=[]}),n.forEach(function(n){var r=e.get(n);if(r&&r.calendarRollUpViewState.isCalendarResponse){r.isInRollUp=!1;var c=Object(a.a)(n,e,t);c&&(r.isInRollUp=!0,c.calendarRollUpViewState.calendarReponseNodeIds.push(n),r.isExpanded&&!c.calendarRollUpViewState.isExpanded&&(c.calendarRollUpViewState.isExpanded=!o||i&&i.includes(n)))}})})},5528:function(e,t,n){"use strict";var a=n(4825),o=n(7);t.a=Object(o.action)("tryAddOofNodesInRollUp")(function(e,t,n,o){o&&e.forEach(function(e){e.oofRollUpViewState.oofReplyNodeIds=[]}),n.forEach(function(n){var o=e.get(n);if(o&&o.oofRollUpViewState.isOofItem){o.isInRollUp=!1;var i=Object(a.a)(n,e,t);i&&!i.isInRollUp&&(o.isInRollUp=!0,i.oofRollUpViewState.oofReplyNodeIds.push(n))}})})},5529:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(5847),o=n(4);function i(e){var t;if(e&&e.RightsManagedMessageDecryptionStatus&&0!=e.RightsManagedMessageDecryptionStatus)switch(e.RightsManagedMessageDecryptionStatus){case-2147160052:case-2147160012:case-2147160011:t=Object(o.b)(Object(o.a)(a.d),r());break;case-2147160010:t=Object(o.a)(a.a);break;case-2147168507:t=Object(o.b)(Object(o.a)(a.l),r());break;case-2147160014:t=Object(o.a)(a.j);break;case-2147160054:case-2147160055:t=Object(o.a)(a.h);break;case-2147160064:case-2147160013:t=Object(o.a)(a.g);break;case-2147160051:t=Object(o.a)(a.c);break;case-2147160060:t=Object(o.a)(a.k);break;case-2147160009:default:t=Object(o.b)(Object(o.a)(a.i),e.RightsManagedMessageDecryptionStatus)}return t}function r(){var e=Object(o.b)('<a href="{0}" target="_blank">{1}</a>',Object(o.a)(a.f),Object(o.a)(a.e));return Object(o.b)(Object(o.a)(a.b),e)}},5530:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o});var a=/ipm.note.rules.ooftemplate.microsoft/i;function o(e){return{isOofItem:a.test(e),oofReplyNodeIds:[],isOofRollUpExpanded:!1}}},5644:function(e,t,n){"use strict";var a=n(0),o=n(5526),i=n(2616),r=n(4325),c=n(1938),s=n(2559),u=n(2144),d=n(18),l=n(7),f=Object(l.action)("markConversationCollapsedItemsRollUp")(function(e,t,n){var a=t.length;if(!(a<5)){var o=[],i=Object(u.a)()?1:a-2,r=Object(u.a)()?1:-1;n&&(i-=r);for(var l=i;l<=a-1&&l>=0&&!t[l].isExpanded;l+=r)o.push(t[l].conversationNodeId);if(o.length>=3){if(o.pop(),e.conversationNodeIdsInCollapsedItemsRollUp=o,!n){var f=Object(u.a)()?0:a-1;e.nodeIdBundledWithSeeMoreMessages=t[f].conversationNodeId}Object(d.o)("RPCountRenderCollItemsRollUp",[Object(c.b)(Object(s.a)(e))])}}}),m=n(5658),b=n(5527),p=n(5528),v=n(5235),I=n(2549),h=n(306),g=n(4972),O=n(13);var j=n(4362),S=n(2617),C=n(5),P=n(73),y=n(3826);function w(e,t,n,o){var c=[],s=t.itemPartsMap,u=t.itemIdToScrollTo,d=null;if(e.conversationNodeIds){e.conversationNodeIds.forEach(function(t){var n=a.__read(Object(r.a)({mailboxInfo:e.conversationId.mailboxInfo,Id:t}),1)[0];n&&s.set(t,n)}),Object(C.d)("rp-calendarRollup")&&(Object(b.a)(s,n,e.conversationNodeIds,!1),Object(m.a)()),Object(C.d)("rp-oofRollup")&&Object(p.a)(s,n,e.conversationNodeIds,!1);var l=!1;e.conversationNodeIds.forEach(function(e){var t=s.get(e);if(t&&!t.isInRollUp){c.push(t);var n=o.get(t.itemId);(function(e){var t=Object(O.C)();if(t&&t.highlightTerms){var n=Object(g.a)(e.RightsManagementLicenseData,e.UniqueBody),a=document.createElement("div");return a.innerHTML=n,t.highlightTerms.some(function(e){return a.innerText.toLowerCase().indexOf(e)>=0})}return!1})(n)&&(t.isExpanded=!0),l=l||t.isExpanded&&!n.IsDraft}});var v="ChronologicalNewestOnBottom"==e.conversationSortOrder;if(function(e,t,n,a){var o=n.length;if(0!=o&&!t){for(var i=null,r=e?o-1:0,c=r,s=e?-1:1,u=function(e){var t=a.get(e);return Object(y.a)(t)[1]};c>=0&&c<o;){var d=n[c],l=Object(C.d)("rp-oofRollup")&&d.oofRollUpViewState.oofReplyNodeIds.some(u);if(!d.isExpanded&&(d.isLocal||l)){i=d;break}c+=s}i||(i=n[r]),i.isExpanded=!0,i.isFossilizedTextExpanded=!0}}(v,l,c,n),d=function(e,t){for(var n=e.length,a=0;a<n;a++){var o=e[a],i=o.itemId;if(t){if(i==t)return o.isExpanded=!0,{itemPart:o,focusedItemArea:I.a.Item}}else{if(o.isExpanded)return{itemPart:o,focusedItemArea:I.a.Item};if(o.oofRollUpViewState.isOofRollUpExpanded)return{itemPart:o,focusedItemArea:I.a.Oof}}}return null}(c,u),c.forEach(function(e){e.isExpanded&&Object(i.a)(e)}),c.length&&Object(C.d)("rp-collapsedItemsRollUp")){var h=v?0:e.conversationNodeIds.length-1,S=e.conversationNodeIds[h],P=s.has(S);e.canLoadMore&&(t.nodeIdBundledWithSeeMoreMessages=S),Object(j.h)(t)||f(t,c,e.canLoadMore&&!P)}}return d}t.a=Object(l.select)({loadedConversation:function(e){return P.a.conversations.get(e)},conversationNodes:function(){return P.a.conversationNodes},conversationReadingPaneState:function(){return h.a.conversationReadingPaneViewState},items:function(){return P.a.items}})(Object(l.action)("firstLoadConversationReadingPane")(function(e,t){if(t.conversationReadingPaneState.conversationId.Id==e){var n=t.conversationReadingPaneState;if(n.loadingState.isLoading=!1,n.loadingState.hasLoadFailed=t.loadedConversation.loadingState.hasLoadFailed,!n.loadingState.hasLoadFailed){var a=Object(S.c)(e);if(n.unsupportedItemId=a,!a){var i=w(t.loadedConversation,n,t.conversationNodes,t.items);n.initiallySelectedItemPart=n.focusedItemPart=i,Object(o.a)(n),Object(C.d)("cal-mf-mailCalendarCard")&&Object(v.a)(e)}}}}))},5658:function(e,t,n){"use strict";var a=n(0),o=n(31),i=n(1979),r=n.n(i),c=n(385),s=n.n(c),u=n(1980),d=n.n(u),l=n(29);function f(e){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return[2,m(e).then(function(e){return Object(o.g)(e[0])?e[0].Items[0]:null}).catch(function(){return null})]})})}function m(e){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return[2,d()({Header:Object(l.getJsonRequestHeader)(),Body:r()({EventIds:[e],ItemShape:s()({BaseShape:"IdOnly"})})},null).then(function(e){return e.Body.ResponseMessages.Items})]})})}var b=n(306),p=n(2144),v=n(3826),I=n(1127),h=n(7),g=n(4362);t.a=Object(h.select)({loadedConversation:function(){return o.H.conversations.get(b.a.conversationReadingPaneViewState.conversationId.Id)},itemPartsMap:function(){return b.a.conversationReadingPaneViewState.itemPartsMap},items:function(){return o.H.items}})(Object(h.action)("generateSummaryForCalendarRollUp")(function(e){return a.__awaiter(this,void 0,void 0,function(){var t,n,o,i,r,c,s,u,d,l,m,b;return a.__generator(this,function(h){switch(h.label){case 0:if((t=e.loadedConversation.conversationNodeIds).length<=1)return[2];n=Object(p.a)()?t.length-1:0,o=Object(p.a)()?-1:1,i=!1,r=n,h.label=1;case 1:return r<=t.length-1&&r>=0?(c=t[r],e.itemPartsMap.has(c)?(s=e.itemPartsMap.get(c),u=s.calendarRollUpViewState,d=e.items.get(s.itemId),u.calendarReponseNodeIds.length>=1?(l=d,!i&&l&&l.AssociatedCalendarItemId?[4,f(l.AssociatedCalendarItemId)]:[3,3]):[3,5]):[3,6]):[3,7];case 2:return b=h.sent(),[3,4];case 3:b=null,h.label=4;case 4:m=b,function(e){e.acceptedAttendees=[],e.tentativeAttendees=[],e.declinedAttendees=[],e.proposedNewTimeAttendeesCount=0}(u),m&&function(e,t){a.__spread(t.RequiredAttendees,t.OptionalAttendees).forEach(function(t){var n=[];switch(t.ResponseType){case"Accept":n=e.acceptedAttendees;break;case"Tentative":n=e.tentativeAttendees;break;case"Decline":n=e.declinedAttendees}n.push({Mailbox:t.Mailbox}),t.ProposedStart&&t.ProposedEnd&&e.proposedNewTimeAttendeesCount++})}(u,m),0==function(e){var t=e.acceptedAttendees,n=e.tentativeAttendees,a=e.declinedAttendees;return t.length+n.length+a.length}(u)&&function(e){var t={},n=e.calendarReponseNodeIds,a=e.acceptedAttendees,o=e.tentativeAttendees,i=e.declinedAttendees;n.forEach(function(e){var n=Object(v.b)(e),a=n&&n.From?n.From:n.Sender,o=a&&a.Mailbox&&a.Mailbox.EmailAddress&&a.Mailbox.EmailAddress.toLowerCase();o&&(!t[o]||Date.parse(n.DateTimeSent)>Date.parse(t[o].DateTimeSent))&&(t[o]=n)}),Object.keys(t).forEach(function(e){var n=t[e],r=n.ItemClass,c=n.From?n.From:n.Sender;r.match(g.a)?a.push(c):r.match(g.e)?o.push(c):r.match(g.c)&&i.push(c)})}(u),h.label=5;case 5:u.isLoading=!1,!i&&d&&Object(I.n)(d.ItemClass)&&(i=!0),h.label=6;case 6:return r+=o,[3,1];case 7:return[2]}})})}))},5846:function(e,t,n){"use strict";var a=n(0),o=n(4325),i=n(2169),r=n(1463),c=n(197),s=n(1021),u=n(7),d=n(13);t.a=Object(u.select)({composeViewState:function(){return c.c.viewStates.get(c.c.primaryComposeId)},conversationItems:function(){return d.O.conversationItems}})(Object(u.action)("reloadReadingPane")(function(e){var t=Object(d.C)(),n=t?a.__spread(t.selectedRowKeys.keys()):[];if(1==n.length){var u=d.b.getRowClientItemId(n[0],t),l=Object(s.a)(n,t)[0];switch(t.tableQuery.listViewType){case 0:var f=e.conversationItems.get(u.Id);e.composeViewState&&e.composeViewState.isInlineCompose?c.C.importAndExecute(e.composeViewState).then(function(){Object(o.b)(u,l,f.subject)}):Object(o.b)(u,l,f.subject);break;case 1:e.composeViewState&&e.composeViewState.isInlineCompose?c.C.importAndExecute(e.composeViewState).then(function(){Object(i.a)(u,l,r.a)}):Object(i.a)(u,l,r.a)}}}))},5847:function(e){e.exports={d:"Jvb",a:"Kvb",l:"Lvb",j:"Mvb",h:"Nvb",g:"Ovb",c:"Pvb",k:"Qvb",i:"Rvb",f:"Svb",e:"Tvb",b:"Uvb"}},6254:function(e,t,n){"use strict";var a=n(1);t.a=Object(a.action)("UPDATE_LOADED_CONVERSATION_READING_PANE",function(e,t){return{conversationId:e,nodeIdCollectionChanged:t}})},6862:function(e,t,n){"use strict";var a=n(1);t.a=Object(a.action)("ON_ITEM_PART_SELECTED",function(e,t){return{conversationNodeId:e,conversationId:t}})},6884:function(e,t,n){"use strict";var a=n(1),o=Object(a.action)("ON_CONVERSATION_OPTION_SAVED");t.a=o},944:function(e,t,n){"use strict";var a;!function(e){e.InfoRestrictedAccess="infoRestrictedAccess"}(a||(a={}));var o=n(98);function i(e){switch(e){case 0:return a.InfoRestrictedAccess;default:return Object(o.a)(e)}}var r=n(9);function c(e){switch(e){case 0:return(t=Object(r.a)().AttachmentPolicy).ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked||t.ConditionalAccessPrintWithoutDownloadBlocked||t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked;default:return Object(o.a)(e)}var t}var s=[0],u=n(1625);function d(){return s.filter(c)}function l(e){return e&&e.length>0&&function(e){return e.some(function(e){return!((t=e).IsInline&&!function(e){return e.__type===u.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(t));var t})}(e)?s.filter(c):[]}var f=n(1711),m=n(4),b=n(520);function p(e){switch(e){case a.InfoRestrictedAccess:return{key:"access_control_info_bar",source:b.c.Compose,rank:b.b.Error,messageParts:[Object(m.a)(f.b),(t="https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done",{text:Object(m.a)(f.a),action:function(){window.open(t,"_blank")}})],color:b.a.Red};default:return Object(o.a)(e)}var t}var v,I=n(494);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.ConditionalAccess=4]="ConditionalAccess"}(v||(v={}));var h=function(){function e(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=v[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}return e.prototype.getPolicyInfo=function(e,t,n,a){e&&(e=e.toLowerCase());var o=this.getFileAccessLevel(e,t),i=!1,r=!1,c=!1,s="ReferenceAttachment:#Exchange"===a;return o!==v.Block&&n&&(this.isWacViewingEnabled(e)&&(i=!0),!this.directFileAccessEnabled&&s&&(i=!1),r=this.isForceBrowserViewingFirst(i),i&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(c="FileAttachment:#Exchange"===a?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),i||this.directFileAccessEnabled||(o=v.ConditionalAccess)),{directFileAccessEnabled:this.directFileAccessEnabled,level:o,useWac:i,forceBrowserViewingFirst:r,wacEdit:c}},e.prototype.isPdfPreviewEnabled=function(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled},e.prototype.getFileAccessLevel=function(e,t){var n=this.fileTypeToPolicyMap[e];if(n||(n=v.Undefined),n===v.Block)return v.Block;var a=this.mimeTypeToPolicyMap[t];return a===v.Block?v.Block:n===v.ForceSave||a===v.ForceSave?v.ForceSave:n===v.Allow||a===v.Allow?v.Allow:this.policyForUnknownTypes},e.prototype.isWacViewingEnabled=function(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0},e.prototype.isForceBrowserViewingFirst=function(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},e.prototype.addPolicyIntoMap=function(e,t,n){t&&t.forEach(function(t){e[t]=n})},e.prototype.createPolicyMap=function(e,t,n){var a={};return this.addPolicyIntoMap(a,n,v.Allow),this.addPolicyIntoMap(a,t,v.ForceSave),this.addPolicyIntoMap(a,e,v.Block),a},e}(),g=null,O=null;function j(){if(!g){var e=Object(r.a)(),t=e.AttachmentPolicy,n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;g=new h(t,n),n&&(O=g)}return g}function S(e,t){var n=Object(I.a)(e.Name),a=e.ContentType;return j().getPolicyInfo(n,a,t,e.__type)}function C(e,t){var n=Object(I.a)(e.Name),a=e.ContentType;return function(){if(!O){var e=Object(r.a)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return j();O=new h(e.AttachmentPolicy,!0)}return O}().getPolicyInfo(n,a,t,e.__type)}function P(e,t,n){var a=S(e,!0),o=j();return a.level!==v.Block&&o.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"i",function(){return p}),n.d(t,"b",function(){return a}),n.d(t,"d",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"a",function(){return s}),n.d(t,"h",function(){return i}),n.d(t,"j",function(){return P}),n.d(t,"c",function(){return v}),n.d(t,"f",function(){return S}),n.d(t,"g",function(){return C}),n.d(t,"k",function(){return j})},992:function(e,t,n){"use strict";var a=n(216),o=n(1160),i=NaN,r=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,u=/^0o[0-7]+$/i,d=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(o.a)(e))return i;if(Object(a.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(a.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var n=s.test(e);return n||u.test(e)?d(e.slice(2),n?2:8):c.test(e)?i:+e}}},0,[4,7,8,19,336,0,1,30,474,155,3,469,120,2,271,292,6,9,11,107,29,67,307,12,37,103,463,87,464,98,195,295,379,445,447]]);
//# sourceMappingURL=owa.ExpandedListSelectionActions.js.map
self.scriptsLoaded['owa.ExpandedListSelectionActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ExpandedListSelectionActions.js'] = (new Date()).getTime();