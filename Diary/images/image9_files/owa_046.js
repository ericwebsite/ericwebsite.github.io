self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentPreviewSxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[104],{1074:function(e,t,n){var r=n(1317),a=36e5,i=6e4,o=2,c=/[T ]/,u=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],m=/^-(\d{2})$/,h=/^-?(\d{3})$/,b=/^-?(\d{2})-?(\d{2})$/,p=/^-?W(\d{2})$/,v=/^-?W(\d{2})-?(\d{1})$/,w=/^(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,P=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,S=/([Z+-].*)$/,y=/^(Z)$/,I=/^([+-])(\d{2})$/,C=/^([+-])(\d{2}):?(\d{2})$/;function O(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var _=function(e){var t,n={},r=e.split(c);if(u.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]),t){var a=S.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),x=function(e,t){var n,r=d[t],a=f[t];if(n=l.exec(e)||a.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=s.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(_.date,n),T=x.year,j=function(e,t){if(null===t)return null;var n,r,a,i;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=m.exec(e))return r=new Date(0),a=parseInt(n[1],10)-1,r.setUTCFullYear(t,a),r;if(n=h.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=b.exec(e)){r=new Date(0),a=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,a,c),r}if(n=p.exec(e))return i=parseInt(n[1],10)-1,O(t,i);if(n=v.exec(e)){i=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return O(t,i,u)}return null}(x.restDateString,T);if(j){var E,k=j.getTime(),A=0;return _.time&&(A=function(e){var t,n,r;if(t=w.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*a;if(t=g.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*a+r*i;if(t=P.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*a+r*i+1e3*o}return null}(_.time)),_.timezone?(D=_.timezone,E=(R=y.exec(D))?0:(R=I.exec(D))?(B=60*parseInt(R[2],10),"+"===R[1]?-B:B):(R=C.exec(D))?(B=60*parseInt(R[2],10)+parseInt(R[3],10),"+"===R[1]?-B:B):0):(E=new Date(k+A).getTimezoneOffset(),E=new Date(k+A+E*i).getTimezoneOffset()),new Date(k+A+E*i)}var D,R,B;return new Date(e)}},1132:function(e,t,n){"use strict";function r(e){return e&&e.recipients?e.recipients.length:0}n.d(t,"a",function(){return r})},1167:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("ADD_PUBLIC_FOLDER_TO_STORE",function(e,t){return{state:e,item:t}})},1177:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),a=n(2305);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetFolder",e,t)}},1178:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetFolderRequest:#Exchange"},e)}},1188:function(e,t,n){"use strict";var r=n(0);function a(e,t,n,a,i,o,c,u){return{folderId:null,type:1,listViewType:i,searchNumber:e,queryString:t,searchScope:n,pillSuggestions:r.__spread(a.values()),includeAttachments:o,fromDate:c,toDate:u,scenarioType:"mail"}}function i(e){var t=e;return 1==e.type?t.scenarioType:void 0}var o=n(21),c=n(31),u=n(33),s=n(54);function d(e){var t=e;return Object(c.z)(t.folderId)?Object(s.e)(t.searchScope,Object(s.c)({folderId:Object(u.a)(o.b),kind:"ArchiveMailbox"})):Object(s.e)(t.searchScope,Object(s.O)({folderId:Object(u.a)(o.g),kind:"PrimaryMailbox"}))}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return d})},1271:function(e,t,n){"use strict";var r=n(98),a=n(1818),i=n(193);function o(e,t,n,i){void 0===i&&(i=!0);var o=e,c=o.AttachmentId,u=o.Name,d=o.OriginalPermissionType,l=o.PermissionType,f=s(e);switch(t){case 0:case 3:return a.b(c,f,t,n,l,d,i,u);case 1:return e.AttachmentPreviewUrl?e.AttachmentPreviewUrl:a.b(c,f,1,n,l,d,i,u);case 2:return e.AttachmentThumbnailUrl;default:return Object(r.a)(t)}}function c(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),a.a(e.mailboxInfo.routingKey,e,t,n,r)}function u(e,t,n,r,u){void 0===u&&(u=!1);var s=n?o(t,1,r,!1):c(e,1,u,!1);if(n)return{url:s,init:{credentials:"include"}};var d=Object(a.c)(),l=new Headers;return l.set("X-Token",d),l.set("X-OWA-CANARY",Object(i.getOwaCanaryCookie)()),{url:s,init:{headers:l}}}function s(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}function d(e,t,n,r,a,i){return void 0===i&&(i=!1),r?o(t,n,a):c(e,n,i)}n.d(t,"a",function(){return d}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return s})},1272:function(e,t,n){"use strict";n.d(t,"q",function(){return s}),n.d(t,"f",function(){return d}),n.d(t,"g",function(){return l}),n.d(t,"h",function(){return f}),n.d(t,"i",function(){return m}),n.d(t,"j",function(){return h}),n.d(t,"k",function(){return b}),n.d(t,"l",function(){return p}),n.d(t,"m",function(){return v}),n.d(t,"n",function(){return w}),n.d(t,"o",function(){return g}),n.d(t,"p",function(){return P}),n.d(t,"r",function(){return S});var r=n(1937);n.d(t,"b",function(){return r.a});var a=n(1277);n.d(t,"c",function(){return a.a});var i=n(1276);n.d(t,"e",function(){return i.a});var o=n(3),c=n(938);n.d(t,"a",function(){return c.a}),n.d(t,"d",function(){return c.d});var u=new o.c(function(){return Promise.all([n.e(8),n.e(516),n.e(12),n.e(28),n.e(384)]).then(n.bind(null,3088))}),s=new o.b(u,function(e){return e}),d=new o.b(u,function(e){return e.resetPreviewPane}),l=(new o.b(u,function(e){return e.setAudioPreviewState}),new o.b(u,function(e){return e.setBlankPreviewState}),new o.b(u,function(e){return e.setCustomPreviewState}),new o.b(u,function(e){return e.setIframePreviewState})),f=(new o.b(u,function(e){return e.setImageGalleryItems}),new o.b(u,function(e){return e.setImagePreviewLoaded})),m=new o.b(u,function(e){return e.setImagePreviewState}),h=new o.b(u,function(e){return e.setImagePreviewStateFromImageGalleryItem}),b=(new o.b(u,function(e){return e.setNativePdfPreviewState}),new o.b(u,function(e){return e.setPanesSize})),p=(new o.b(u,function(e){return e.setPdfJsPreviewState}),new o.b(u,function(e){return e.setPdfJsPreviewStateByData}),new o.b(u,function(e){return e.setPreviewError})),v=new o.b(u,function(e){return e.setPreviewLoading}),w=new o.b(u,function(e){return e.setRightPaneDisplayAndUpdateSize}),g=new o.b(u,function(e){return e.setTextPreviewState}),P=(new o.b(u,function(e){return e.setVideoPreviewState}),new o.b(u,function(e){return e.setWacPreviewState})),S=new o.b(u,function(e){return e.updatePanesSize})},1314:function(e,t,n){"use strict";var r=n(1),a=n(45),i=n(21),o=n(8),c=Object(r.createStore)("mailboxInfoStore",new o.ObservableMap),u=n(9);function s(e){if(!e)return Object(a.e)();if(!c().has(e)){var t=function(e){var t,n,r,o=Object(i.y)(),c=o&&o.get(e);c&&c.treeType===i.j?(t=c.principalSMTPAddress,n=c.principalSMTPAddress,r=Object(a.c)()+c.principalSMTPAddress):(t=Object(a.d)(),n=Object(u.a)().SessionSettings.UserEmailAddress,r=Object(a.b)());return{type:a.a.UserMailbox,deprecatedMailboxId:t,primarySmtpAddress:n,routingKey:r,returnModernConversationItems:!1,requestOptions:Object(i.t)(e)}}(e);d(e,t)}return c().get(e)}var d=Object(r.mutatorAction)("addMailboxInfoToStore",function(e,t){c().set(e,t)}),l=n(427),f=n(165),m=n(1520);function h(e){return e?b(e.tableQuery):Object(a.e)()}function b(e){var t=Object(f.b)(e),n=e&&e.folderId;return null!=t?Object(l.l)(t):p(n)}function p(e){return Object(i.M)(e)?Object(m.a)(e):s(e)}n.d(t,"a",function(){return h}),n.d(t,"c",function(){return b}),n.d(t,"b",function(){return p})},1317:function(e,t){e.exports=function(e){return e instanceof Date}},1339:function(e,t,n){"use strict";var r=n(0),a=n(1),i=n(9),o=n(66),c=n(564),u=n(5),s=Object(a.action)("POPULATE_PUBLIC_FOLDER_OUTLOOK_FAVORITE_STORE"),d=n(29),l=n(1177),f=n.n(l),m=n(108),h=n.n(m),b=n(1178),p=n.n(b),v=n(648),w=n.n(v),g=n(57),P=n.n(g),S=n(156);function y(e){return{headers:Object(S.e)(e)}}function I(e){var t=[];e.forEach(function(e){t.push(h()({Id:e}))});var n=Object(i.a)().SessionSettings.DefaultPublicFolderMailbox;return 0!==t.length&&n?f()({Header:Object(d.getJsonRequestHeader)(),Body:p()({FolderShape:w()({BaseShape:"AllProperties",AdditionalProperties:[P()({FieldURI:"ReplicaList"})]}),FolderIds:t})},y(n)).then(function(e){return e.Body.ResponseMessages}).catch(function(){return null}):null}var C=n(1167),O=n(659);Object(a.orchestrator)(o.loadFavorites,function(){return r.__awaiter(void 0,void 0,void 0,function(){var e,t,n;return r.__generator(this,function(r){switch(r.label){case 0:return Object(u.d)("tri-favorites-roaming")&&Object(u.d)("pf-favorite")?(e=[],(t=Object(i.a)().Favorites?Object(i.a)().Favorites.value:null)?(t.forEach(function(t){var n=Object(c.b)(t,"IsPublicFolder");n&&"true"===n.toLowerCase()&&e.push(Object(c.b)(t,"FolderId"))}),[4,I(e)]):[2]):[2];case 1:return(n=r.sent())&&(n.Items.forEach(function(e){e.Folders.forEach(function(e){null!=e&&Object(C.a)(O.a,e)})}),s()),[2]}})})}),Object(a.orchestrator)(s,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var e;return r.__generator(this,function(t){return(e=Object(i.a)().Favorites?Object(i.a)().Favorites.value:null)?(e.forEach(function(e){var t=Object(o.getSingleValueSettingValueForKey)(e,"IsPublicFolder");"folder"===e.Type.toLowerCase()&&t&&"true"===t.toLowerCase()&&function(e){(function(e){if(0===O.a.folderTable.size)return!1;return!o.favoritesStore.outlookFavorites.has(e.favoriteId)&&O.a.folderTable.has(e.publicFolderId)})(e)&&Object(o.addFavoriteToStoreInitial)(e)}({treeType:"favorites",favoriteId:e.Id,type:"publicFolder",displayName:e.DisplayName,publicFolderId:Object(o.getSingleValueSettingValueForKey)(e,"FolderId"),client:e.Client,lastModifiedTime:e.LastModifiedTime})}),[2]):[2]})})});var _=n(1722),x=(Object(a.mutator)(C.a,function(e){var t=e.state,n=e.item,a=n.FolderId.Id;if(!t.folderTable.has(a)){var i=n.DistinguishedFolderId?n.DistinguishedFolderId:void 0,o=r.__assign({childFolderIds:[],distinguishedFolderId:i,UnreadCount:n.UnreadCount,TotalCount:n.TotalCount,isHidden:Object(_.b)(n),sourceWellKnownFolderType:Object(_.c)(n),ReplicaList:n.ReplicaList},n);t.folderTable.set(a,o)}}),n(1488));Object(a.mutator)(x.a,function(e){var t=e.folderId;O.a.folderTable.has(t)&&O.a.folderTable.delete(t)});n.d(t,"a",function(){return y}),n.d(t,"b",function(){return O.a})},1456:function(e,t,n){"use strict";var r;!function(e){e[e.PrimaryReadingPane=0]="PrimaryReadingPane",e[e.SecondaryTab=1]="SecondaryTab",e[e.Popout=2]="Popout",e[e.SxS=3]="SxS"}(r||(r={})),t.a=r},1482:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(993);function a(e){return Object(r.a)().attachments.get(e.Id)}},1484:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(135);function a(e,t,n){var a={pathname:e+t,search:n};return r.format(a)}},1488:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("REMOVE_FAVORITE_FROM_PUBLIC_FOLDER_STORE",function(e){return{folderId:e}})},1520:function(e,t,n){"use strict";var r=n(13),a=n(21);function i(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(a.M)(e.tableQuery.folderId)}function o(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(a.M)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var c=n(1),u=n(1339),s=n(9),d=n(8),l=Object(c.createStore)("publicFolderUtilsStore",new d.ObservableMap);function f(e){if(!l().has(e)){var t=u.b.folderTable.get(e),n={type:null,deprecatedMailboxId:e,primarySmtpAddress:t.principalSMTPAddress,routingKey:"AAD-SMTP:"+t.principalSMTPAddress,returnModernConversationItems:null,requestOptions:Object(u.a)(null!=t.ReplicaList?t.ReplicaList[0]:Object(s.a)().SessionSettings.DefaultPublicFolderMailbox)};m(e,n)}return l().get(e)}var m=Object(c.mutatorAction)("addPublicFolderMailboxInfoToStore",function(e,t){l().set(e,t)});n.d(t,"b",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return f})},1583:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(9),a=n(5);function i(){var e=Object(r.a)(),t=e&&e.SessionSettings&&e.SessionSettings.IsExplicitLogon;return(Object(a.d)("rp-3SPeopleSuggestions")||Object(a.d)("rp-linkedInPeopleSuggestions"))&&!t&&e.SessionSettings.IsSubstrateSearchServiceAvailable}},1589:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var r=n(1132);function a(e){return e.isDirty||e.toRecipientWell&&e.toRecipientWell.isDirty||e.ccRecipientWell&&e.ccRecipientWell.isDirty||e.bccRecipientWell&&e.bccRecipientWell.isDirty}function i(e){return Object(r.a)(e.toRecipientWell)+Object(r.a)(e.ccRecipientWell)+Object(r.a)(e.bccRecipientWell)}function o(e){return function(e){return!!e.groupId}(e)&&(2==(t=e).operation||t.toRecipientWell.recipients.some(function(e){return e.persona.EmailAddress.EmailAddress.toLowerCase()===t.groupId.toLowerCase()}));var t}},1591:function(e,t,n){"use strict";var r=n(3),a=n(0),i=n(1592),o=n(7),c=Object(o.action)("addSessionMaskedRecipient")(function(e){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return i.a.sessionMaskedRecipients[e]=!0,[2]})})});n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c});var u=new r.c(function(){return n.e(379).then(n.bind(null,11908))}),s=new r.a(u,function(e){return e.execute3SPrimeCall})},1592:function(e,t,n){"use strict";n.d(t,"b",function(){return a});var r=n(1),a=Object(r.createStore)("substratepeoplesuggestions",{sessionMaskedRecipients:[]}),i=a();t.a=i},1593:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0);function a(e){var t,n,a=[];if(e&&e.recipients)try{for(var i=r.__values(e.recipients),o=i.next();!o.done;o=i.next()){var c=o.value,u=c.persona.EmailAddress;u&&u.ItemId&&"PrivateDL"==u.MailboxType?a.push({Name:u.Name,RoutingType:u.RoutingType,MailboxType:u.MailboxType,ItemId:{Id:u.ItemId.Id,ChangeKey:null},EmailAddressIndex:u.EmailAddressIndex,RelevanceScore:u.RelevanceScore||0}):a.push(c.persona.EmailAddress)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return a}},1597:function(e,t,n){"use strict";var r=n(230),a=n.n(r),i=n(7);function o(e){e&&(e.isDirty=!1)}t.a=Object(i.action)("updateComposeItemId")(function(e,t,n,r){e&&(e.itemId?e.itemId.ChangeKey=n:e.itemId=a()({Id:t,ChangeKey:n}),r&&(e.lastSaveTimeStamp=r,e.isDirty=!1,o(e.toRecipientWell),o(e.ccRecipientWell),o(e.bccRecipientWell)))})},1598:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),a=n(1623);function i(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,a.c.import()];case 1:return t=n.sent(),e&&t(e.referenceItemId&&e.referenceItemId.Id),[2]}})})}},1600:function(e,t,n){"use strict";var r=n(1),a=Object(r.createStore)("MRUAttachmentStore",{attachments:[]});t.a=a},1603:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=Object(r.action)("messageBeingSent")},1604:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),a=n(805),i=n(321),o=n(318);function c(e,t){var n,c,u=Object(a.b)();try{for(var s=r.__values(Object(o.a)().tabs),d=s.next();!d.done;d=s.next()){var l=d.value;if(l.type==i.a.Compose&&!l.isShown){var f=u.viewStates.get(l.data);if(f&&f.isInlineCompose&&f.conversationId==e&&(0==f.asyncSendState||t&&6==f.asyncSendState))return f}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(c=s.return)&&c.call(s)}finally{if(n)throw n.error}}return null}},1605:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("onInlineComposeSendStateChange",function(e,t){return{viewState:e,isSendPending:t}})},1623:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return c});var r=n(3),a=n(1600);n.d(t,"a",function(){return a.a});var i=new r.c(function(){return n.e(106).then(n.bind(null,2569))}),o=new r.b(i,function(e){return e.getAttachmentSuggestionsAction}),c=new r.b(i,function(e){return e.createCloudFileFromAttachmentData})},1625:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={attachmentTypes:{FILE_ATTACHMENT_TYPE:"FileAttachment:#Exchange",ITEM_ATTACHMENT_TYPE:"ItemAttachment:#Exchange",ITEM_ID_ATTACHMENT_TYPE:"ItemIdAttachment:#Exchange",REFERENCE_ATTACHMENT_TYPE:"ReferenceAttachment:#Exchange"}}},1708:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"a",function(){return u}),n.d(t,"d",function(){return s}),n.d(t,"b",function(){return d});var r=n(3),a=n(24),i=new r.c(function(){return Promise.all([n.e(0),n.e(1),n.e(3),n.e(469),n.e(120)]).then(n.bind(null,2583))}),o=new r.a(i,function(e){return e.loadCLPUserLabels}),c=new r.b(i,function(e){return e.showJustificationModal}),u=new r.a(i,function(e){return e.loadItemCLPInfo}),s=new r.b(i,function(e){return e.updateItemCLPInfo}),d=new r.b(i,function(e){return e.logReadCLPLabel});Object(a.d)(function(){o.importAndExecute()})},1710:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(3),a=n(24),i=new r.c(function(){return n.e(295).then(n.bind(null,2571))}),o=new r.a(i,function(e){return e.loadSignatureInUserOptions});Object(a.d)(function(){o.importAndExecute()})},1711:function(e){e.exports={a:"Mba",b:"Nba"}},1722:function(e,t,n){"use strict";var r=function(e,t){if(e.ExtendedProperty)for(var n=0;n<e.ExtendedProperty.length;n++){var r=e.ExtendedProperty[n];if(r.ExtendedFieldURI.PropertyTag===t||r.ExtendedFieldURI.PropertyName===t)return JSON.parse(r.Value)}},a=function(e){return r(e,"0x10f4")},i=function(e){return parseInt(r(e,"SourceWellKnownFolderType"),10)};n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i})},1817:function(e,t,n){"use strict";n.d(t,"a",function(){return m}),n.d(t,"c",function(){return h}),n.d(t,"b",function(){return b});var r=n(0),a=n(4),i=n(2520),o=n(2529),c=n.n(o),u=n(9),s=n(18),d=n(12),l=Object(i.b)({timeBetweenRetryInMS:function(){return 3e4}}),f=function(){function e(e,t,n){var i=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return r.__awaiter(i,void 0,void 0,function(){function e(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,c()()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),d.c.warn("Unable to get the download token "+e),e;case 3:return[2]}})})}var t,n,a,i,o=this;return r.__generator(this,function(c){switch(c.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,t=0,n=l(function(){return r.__awaiter(o,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return t++,n=this,[4,e()];case 1:return n.downloadToken=r.sent(),this.isRefreshingDownloadToken=!1,[2]}})})}).retriableFunc,a=new s.b("AttachmentRefreshDownloadToken"),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n()];case 2:return c.sent(),a.addCustomData([t]),a.end(),[3,4];case 3:return i=c.sent(),d.c.warn("Retry to refresh token failed: "+i),a.addCustomData([t]),a.endWithError("ServerError",i),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}})})},this.useDownloadUrlBase=!Object(a.g)(this.downloadUrlBase),this.downloadToken=n,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(u.a)().ApplicationSettings;e.instance=new e(t.DownloadTokenRefreshMinutes,t.DownloadUrlBase,t.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function m(){return f.getInstance().getDownloadToken()}function h(){return f.getInstance().getUseDownloadUrlBase()}function b(){return f.getInstance().getDownloadUrlBase()}},1818:function(e,t,n){"use strict";var r=n(2519);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b});var a=n(1817);n.d(t,"c",function(){return a.a})},1821:function(e,t,n){"use strict";var r=n(2528);n(806),n(22),n(1484);n(2135),n(2294);n.d(t,"a",function(){return r.a})},1937:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Default=0]="Default",e[e.NeedPassword=1]="NeedPassword",e[e.IncorrectPassword=2]="IncorrectPassword"}(r||(r={}))},197:function(e,t,n){"use strict";var r=n(1603),a=n(1456),i=n(3),o=(n(1710),n(1708),n(24)),c=n(1591),u=n(1583),s=new i.c(function(){return n.e(337).then(n.bind(null,11822))}),d=new i.a(s,function(e){return e.initializeCache});Object(o.c)(function(){d.importAndExecute(),Object(u.a)()&&c.b.importAndExecute(!0)});var l=n(805),f=n(991),m=n(1589),h=(n(1597),n(1593)),b=n(1604),p=n(1598),v=n(1),w=Object(v.action)("onComposeAddinsInitialized",function(e){return{hostItemIndex:e}}),g=n(1605),P=n(321);function S(){var e=Object(P.c)(),t=Object(l.b)(),n=e?function(e,t){switch(e.type){case P.a.Primary:return t.primaryComposeId;case P.a.Compose:return e.data;default:return null}}(e,t):t.primaryComposeId,r=n?t.viewStates.get(n):null;return r&&!r.isInlineCompose?r:null}n.d(t,"y",function(){return I}),n.d(t,"o",function(){return C}),n.d(t,"i",function(){return O}),n.d(t,"l",function(){return _}),n.d(t,"r",function(){return x}),n.d(t,"u",function(){return T}),n.d(t,"C",function(){return j}),n.d(t,"s",function(){return E}),n.d(t,"w",function(){return k}),n.d(t,"B",function(){return A}),n.d(t,"x",function(){return D}),n.d(t,"v",function(){return R}),n.d(t,"t",function(){return B}),n.d(t,"A",function(){return U}),n.d(t,"k",function(){return F}),n.d(t,"q",function(){return M}),n.d(t,"n",function(){return L}),n.d(t,"z",function(){return N}),n.d(t,"p",function(){return W}),n.d(t,"j",function(){return V}),n.d(t,"m",function(){return Y}),n.d(t,"c",function(){return l.a}),n.d(t,"e",function(){return f.c}),n.d(t,"b",function(){return f.b}),n.d(t,"h",function(){return m.c}),n.d(t,"g",function(){return h.a}),n.d(t,"d",function(){return b.a}),n.d(t,"D",function(){return p.a}),n.d(t,"F",function(){return w}),n.d(t,"G",function(){return g.a}),n.d(t,"f",function(){return S}),n.d(t,"a",function(){return a.a}),n.d(t,"E",function(){return r.a});var y=new i.c(function(){return Promise.all([n.e(0),n.e(1),n.e(3),n.e(2),n.e(271)]).then(n.bind(null,11549))}),I=new i.a(y,function(e){return e.replyToMessage}),C=new i.a(y,function(e){return e.forwardMessage}),O=new i.a(y,function(e){return e.closeCompose}),_=new i.a(y,function(e){return e.discardCompose}),x=new i.a(y,function(e){return e.loadDraftToCompose}),T=new i.a(y,function(e){return e.openCompose}),j=new i.a(y,function(e){return e.trySaveAndCloseCompose}),E=new i.a(y,function(e){return e.moveComposeToTab}),k=new i.a(y,function(e){return e.recreateComposeFromViewState}),A=new i.a(y,function(e){return e.tryCreateResendDraft}),D=new i.a(y,function(e){return e.replyToApprovalMessage}),R=new i.a(y,function(e){return e.preloadComposePlugins}),B=new i.a(y,function(e){return e.onEditDraftButtonClicked}),U=new i.a(y,function(e){return e.showSubjectPickerButton}),F=(new i.b(y,function(e){return e.createComposeViewState}),new i.b(y,function(e){return e.createReply})),M=new i.b(y,function(e){return e.getToCcRecipientsForReply}),L=new i.b(y,function(e){return e.findComposePlugins}),N=new i.b(y,function(e){return e.replyToMessageAndCreateViewState}),W=(new i.b(y,function(e){return e.infoBarAddHandler}),new i.b(y,function(e){return e.infoBarRemoveHandler}),new i.b(y,function(e){return e.getNextComposeId})),V=new i.b(y,function(e){return e.createAttachments}),Y=new i.b(y,function(e){return e.findComposeFromRecipientWell})},2135:function(e,t,n){"use strict";var r=n(806),a=n(22),i=n(1484),o=n(82);function c(e,t){if(t){var n=t.displayName?t.displayName+"<"+t.smtpAddress+">":t.smtpAddress;return e?"&"+e+"="+n:n}return""}function u(e,t){return t?"&"+e+"="+t:""}function s(e){if(!e.to||!e.to.smtpAddress)return"";var t=o.parse(Object(a.a)().search.substr(1));return t.mailtouri=function(e){if(!e.to||!e.to.smtpAddress)return"";var t="mailto:"+c(null,e.to),n="";return n+=c("cc",e.cc),n+=c("bcc",e.bcc),n+=u("subject",e.subject),(n+=u("body",e.body))?t+"?"+n.slice(1):t}(e),Object(i.a)(r.e,r.b,"?"+o.stringify(t))}n.d(t,"a",function(){return s})},2294:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(806),a=n(22),i=n(1484);function o(e){return e?Object(i.a)(r.e,r.f+"/"+encodeURIComponent(e),Object(a.a)().search):""}},2303:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}},2305:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetFolderJsonRequest:#Exchange"},e)}},2307:function(e,t,n){var r=n(3014),a=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*a)}},238:function(e,t,n){"use strict";var r=n(1314),a=n(13);function i(){return Object(r.a)(Object(a.C)())}n.d(t,"b",function(){return r.a}),n.d(t,"c",function(){return r.c}),n.d(t,"a",function(){return i})},2519:function(e,t,n){"use strict";var r=n(4),a=n(1817),i=n(56),o=n(193),c="/owa/",u="service.svc/s/GetFileAttachment?id={0}",s="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",d="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",l="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",f="service.svc/s/GetAttachmentThumbnail?id={0}",m="pdfprint.aspx?id={0}",h="pdfprint.aspx?id={0}&location={1}",b=n(136),p=n(15);var v=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var w=n(98);function g(e,t,n,a,i,u,d,f){var m;switch(void 0===i&&(i=0),void 0===u&&(u=0),void 0===d&&(d=!0),void 0===f&&(f=null),n){case 0:m=s;break;case 3:m=h;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&v.indexOf(t.toLowerCase())>=0}(f))return null;m=l;break;default:Object(w.a)(n)}var b=a?u:i;!b&&i&&(b=i);var p=Object(r.b)("{0}{1}&permissionLevel={2}",c,Object(r.b)(m,encodeURIComponent(e.Id),encodeURIComponent(t)),b);d&&(p=p+"&X-OWA-CANARY="+Object(o.getOwaCanaryCookie)());return p}function P(e,t,n,s,l){var h;switch(void 0===s&&(s=!1),void 0===l&&(l=!0),n){case 0:h=u;break;case 1:h=d;break;case 2:h=f;break;case 3:h=m;break;default:return Object(w.a)(n)}return Object(r.g)(h)?null:Object(r.b)("{0}{1}{2}",function(e,t,n,u,s){if(void 0===s&&(s=!1),!t||!t.Id)return null;var d=Object(r.b)(n,encodeURIComponent(t.Id));if(!Object(a.c)()||s&&"Firefox"===Object(b.a)().browser)return c+d+"&X-OWA-CANARY="+Object(o.getOwaCanaryCookie)();var l="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(i.a)()&&(l+="&isc=1");var f=Object(r.b)(l,Object(a.b)(),e,d,window.location.hostname,Object(p.i)()||"unofficial");return u&&(f+="&X-OWA-CANARY="+Object(o.getOwaCanaryCookie)(),f+="&token="+Object(a.a)()),f}(e,t,h,l,3===n),s?"&isDownload=true":"","&animation=true")}n.d(t,"b",function(){return g}),n.d(t,"a",function(){return P})},2520:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(o,c){a?c(new Error("The function retry was cancelled")):(r++,e().then(function(e){return o(e)}).catch(function(e){t&&r>=t?c(e):setTimeout(function(){return i(o,c)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return i(e,t)})},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a})},2528:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(806);function a(){return(location?location.pathname:"").split("/").indexOf(r.c)>=0}},2529:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59);t.default=function(e){return r.makeServiceRequest("GetAttachmentDownloadToken",{},e)}},2539:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),a=n(2303);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetAccessTokenforDataProvider",e,t)}},2568:function(e,t,n){"use strict";function r(e){var t=e.indexOf("/d/");return e.substring(t+3,e.indexOf("/",t+3))}n.d(t,"a",function(){return r})},3014:function(e,t,n){var r=n(1074);e.exports=function(e,t){var n=r(e).getTime(),a=Number(t);return new Date(n+a)}},3504:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1),i=Object(a.action)("initializeReadingPaneInSxS",function(e,t,n,r){return{readingPaneStrategy:e,previewPaneSelectionSource:t,parentItemId:n,instrumentationContext:r}}),o=Object(a.action)("initializeConversationReadingPaneInSxS",function(e,t,n,r){return{readingPaneStrategy:e,previewPaneSelectionSource:t,parentItemId:n,instrumentationContext:r}}),c=Object(a.action)("initializeItemReadingPaneInSxS",function(e,t){return{readingPaneStrategy:e,instrumentationContext:t}}),u=Object(a.action)("initializeReadingPaneInSxSByCopyingMailReadingPane",function(e,t,n){return{previewPaneSelectionSource:e,parentItemId:t,instrumentationContext:n}}),s=n(98),d=n(263),l=n(386);Object(a.orchestrator)(o,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return t=e.readingPaneStrategy,n=e.previewPaneSelectionSource,a=e.parentItemId,i=e.instrumentationContext,t&&t.conversationId?l.E.readingPaneState&&l.E.readingPaneState.mode===l.g.ConversationReadingPane&&l.E.readingPaneState.conversationId&&l.E.readingPaneState.conversationId.Id===t.conversationId.Id?(a&&function(e){switch(e){case l.c.MailList:case l.c.ConversationAttachmentWell:return!0;case l.c.ReadingPane:case l.c.FilesHub:case l.c.PhotoHub:case l.c.GroupFilesHub:case l.c.Deeplink:case l.c.FileSuggestion:case l.c.LinkSuggestion:case l.c.ComposeDocLink:case l.c.ReadingPaneDocLink:return!1;default:return Object(s.a)(e)}}(n)&&d.m.importAndExecute(a.Id),[2]):[4,d.f.importAndExecute(t.conversationId,i,t.conversationSubject,t.conversationCategories,t.itemIdToScrollTo)]:[2];case 1:return r.sent(),[4,l.x.import()];case 2:return r.sent()({mode:l.g.ConversationReadingPane,conversationId:t.conversationId,conversationCategories:t.conversationCategories,conversationSubject:t.conversationSubject}),a&&d.m.importAndExecute(a.Id),[2]}})})});Object(a.orchestrator)(c,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return t=e.readingPaneStrategy,n=e.instrumentationContext,t&&t.itemId?l.E.readingPaneState&&l.E.readingPaneState.mode===l.g.ItemReadingPane&&l.E.readingPaneState.itemId&&l.E.readingPaneState.itemId.Id===t.itemId.Id?[2]:[4,l.x.import()]:[2];case 1:return a=r.sent(),[4,d.h.import()];case 2:return[4,r.sent()(t.itemId,n,function(e){a({mode:l.g.ItemReadingPane,itemId:t.itemId,itemReadingPaneViewState:e})})];case 3:return r.sent(),[2]}})})});var f=n(2543),m=n(197),h=n(13),b=n(238),p=n(306),v=n(1821),w=n(321),g=n(1188);Object(a.orchestrator)(u,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,a,i,u,s,d,P,S,y,I,C,O,_,x,T,j,E;return r.__generator(this,function(k){switch(k.label){case 0:return l.E.shouldShow&&(l.E.readingPaneState||l.E.composeId)?[2]:(t=e.previewPaneSelectionSource,n=e.parentItemId,a=e.instrumentationContext,i=h.O.tableViews.get(h.O.selectedTableViewId).tableQuery,u=Object(h.J)(i)||Object(g.c)(i),s=Object(w.c)(),(d=Object(m.f)())?Object(v.a)()&&window.opener?[2]:d.composeId!==m.c.primaryComposeId?[3,3]:[4,m.s.import()]:[3,7]);case 1:return[4,k.sent()(d,!0,!0)];case 2:k.sent(),s=Object(w.c)(),k.label=3;case 3:return[4,w.g.import()];case 4:return[4,k.sent()(s,!0)];case 5:return k.sent(),[4,l.y.import()];case 6:return k.sent()(d),[2];case 7:if(P=p.a.conversationReadingPaneViewState,S=p.a.deeplinkId,y=Object(b.a)(),S)c({method:f.a.LoadItemReadingPane,itemId:{mailboxInfo:y,Id:S.id}},a);else if(s&&s.type===w.a.SecondaryReadingPane)switch((I=s.data).listViewType){case 0:o({method:f.a.LoadConversationReadingPane,conversationId:I.id,conversationSubject:I.subject,conversationCategories:I.categories},t,n,a);break;case 1:c({method:f.a.LoadItemReadingPane,itemId:I.id},a)}else if(P&&Object(m.d)(P.conversationId.Id))o({method:f.a.LoadConversationReadingPane,conversationId:P.conversationId,conversationSubject:P.conversationSubject,conversationCategories:P.conversationCategories},t,n,a);else if(C=Object(h.C)(),O=C&&r.__spread(C.selectedRowKeys.keys()),_=C&&C.isInVirtualSelectAllMode,x=h.O.expandedConversationViewState.selectedNodeIds.length,1==O.length&&x<=1&&!_&&!u)switch(T=h.b.getRowClientItemId(O[0],C),C&&C.tableQuery.listViewType){case 0:j=h.b.getSubject(O[0],C),E=h.b.getCategories(O[0],C),o({method:f.a.LoadConversationReadingPane,conversationId:T,conversationSubject:j,conversationCategories:E},t,n,a);break;case 1:c({method:f.a.LoadItemReadingPane,itemId:T},a)}return[2]}})})});Object(a.orchestrator)(i,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,a,i;return r.__generator(this,function(r){switch(r.label){case 0:if(t=e.readingPaneStrategy,n=e.previewPaneSelectionSource,a=e.parentItemId,i=e.instrumentationContext,!t)return[2];switch(t.method){case f.a.NoOp:return[3,1];case f.a.AlwaysHidden:return[3,2];case f.a.CopyMailReadingPaneContainer:return[3,4];case f.a.LoadConversationReadingPane:return[3,5];case f.a.LoadItemReadingPane:return[3,6]}return[3,7];case 1:return[2];case 2:return[4,l.x.import()];case 3:return r.sent()(null),[2];case 4:return u(n,a,i),[2];case 5:return o(t,n,a,i),[2];case 6:return c(t,i),[2];case 7:return[2]}})})});var P=n(18),S=n(522),y=n(297),I=n(2517),C=n(2568),O="download",_="open";function x(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t=Object(C.a)(e.AttachLongPathName),[4,Object(I.l)(t)];case 1:return[2,(n=r.sent()).result&&n.result.webContentLink&&(a=n.result.webContentLink,a.lastIndexOf(O,a.length-O.length)>-1)?T(n.result.webContentLink):null]}var a})})}function T(e){return e.slice(0,-O.length)+_}var j=n(747),E=n(944),k=n(1271),A=n(4438),D=n(6261),R=n(5),B=n(494),U=n(4),F=n(4027),M=n(4974),L=n(4330),N=n(6331),W=n(1309),V=n(5220),Y=n(1272),K=n(12),z=n(4009),H=n.n(z);function G(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,i,o,c,u;return r.__generator(this,function(r){switch(r.label){case 0:a={error:null,errorMessage:"Something went wrong while the document preview was being created. Please try again later."},r.label=1;case 1:return r.trys.push([1,3,,4]),n&&(i="getAttachmentTextPreview"+n,(t=t||{}).headers=t.headers||new Headers,t.headers.set("X-OWA-ActionName",i)),[4,H()({AttachmentId:e},t)];case 2:if((o=r.sent())&&0===o.Status)return[2,o.Content];switch(c=o&&o.Status||1){case 2:a.errorMessage="The attachment has been moved or deleted.";break;case 3:a.errorMessage="Something went wrong while the document preview was being created. Please try again later.";break;case 1:default:a.errorMessage="Something went wrong while the document preview was being created. Please try again later."}return a.error=new Error("getAttachmentTextPreview failed with status: "+c),[3,4];case 3:return u=r.sent(),K.c.warn("getAttachmentTextPreview failed with error: "+u),a.error=u,[3,4];case 4:throw a}})})}function J(e){switch(e){case S.b.Unsupported:return"Unsupported";case S.b.Image:return"Image";case S.b.MailItem:return"MailItem";case S.b.CalendarEvent:return"CalendarEvent";case S.b.Wac:return"Wac";case S.b.SuiteExtensions:return"SuiteExtensions";case S.b.Audio:return"Audio";case S.b.Text:return"Text";case S.b.NativeView:return"NativeView";case S.b.GoogleDoc:return"GoogleDoc";case S.b.PdfJs:return"PdfJs";case S.b.ItemAttachment:return"ItemAttachment";case S.b.Video:return"Video";default:return Object(s.a)(e)}}function X(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}var q="/owa/{0}/service.svc/s/GetAttachmentPdfPreview?id={1}";function Z(e,t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return n=Object(U.b)(q,e,encodeURIComponent(t)),[4,fetch(n,{credentials:"same-origin"})];case 1:return[2,r.sent()]}})})}function Q(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i,o,c,u;return r.__generator(this,function(r){switch(r.label){case 0:return[4,Z(e.mailboxInfo&&e.mailboxInfo.routingKey,e.Id)];case 1:return(t=r.sent()).ok?[4,t.text()]:[3,3];case 2:for(n=r.sent(),a=n.replace(/\s/gi,""),i=atob(a),o=i.length,c=new Uint8Array(new ArrayBuffer(o)),u=0;u<o;u++)c[u]=i.charCodeAt(u);return[2,c];case 3:throw t.statusText}})})}var $=n(2550);function ee(e){var t=new Error(e);throw t.isUserError=!0,t}function te(e){if(null!=e&&e.isUserError)return!0;return!1}var ne=n(9504),re=n(2557),ae=[".odp",".pot",".potm",".potx",".pps",".ppsm",".ppsx",".ppt",".pptm",".pptx"];function ie(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,m.r.import()];case 1:return t.sent()(e.Id,m.a.SxS),[2]}})})}function oe(e,t,n,a,o,c,u,s,d){return void 0===d&&(d=l.e.Mail),r.__awaiter(this,void 0,void 0,function(){function f(){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return c?[3,1]:(n=null,[3,3]);case 1:return[4,c()];case 2:n=r.sent(),r.label=3;case 3:return t=n,C(),T.setImagePreviewState(q,oe.previewImage.url,t,de),[4,y.k.import()];case 4:return[4,r.sent()(e.attachmentId,e.isReadOnly)];case 5:return r.sent(),C(),T.setImagePreviewState(q,Z(e.attachmentId).previewImage.url,t,de),[2]}})})}function m(){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return t=oe.model.ProviderType,function(e,t,n){if(e&&t===y.a.providers.ONE_DRIVE_PRO&&Object(R.d)("doc-SxS-jsApi-ODB-Core")){var r=Object(V.b)(n);if(null!==r)switch(r.app){case V.a.Word:return Object(R.d)("doc-SxS-jsApi-ODB-Word");case V.a.Excel:return Object(R.d)("doc-SxS-jsApi-ODB-Excel");case V.a.PowerPoint:return Object(R.d)("doc-SxS-jsApi-ODB-PowerPoint")}}return!1}(e.isCloudy,t,oe.model.Name)&&t===y.a.providers.ONE_DRIVE_PRO?[4,b()]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,h()];case 3:n.sent(),n.label=4;case 4:return[2]}})})}function h(){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(D.a)(e.attachmentId,!1,l.c[o])];case 1:return t=r.sent(),oe.model.Name&&(n=oe.model.Name.lastIndexOf("."))>=0&&(a=oe.model.Name.substr(n).toLowerCase(),de.useHighContrastCommandBar=ae.indexOf(a)>=0),C(),T.setWacPreviewState(q,t.wacUrl,null,t.token,O.getTime(),null,de),[3,3];case 2:if(i=r.sent(),(c=i)&&c.errorMessage)throw K.c.warn("Something went wrong while getting the attachment state: "+c),T.setPreviewError(q,c.errorMessage),c.error;throw i;case 3:return[2]}})})}function b(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,i,o;return r.__generator(this,function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),le.addCustomData({useJsApi:"true"}),null==(e=oe.openUrl))throw new Error("openUrl is null");return t=oe.model.Name,n=t&&t.substring(t.lastIndexOf(".")),a=".xls"!==n,[4,Object(A.a)(0,e,a)];case 1:if(!(i=r.sent()))throw new Error("Vroom API call failed");return C(),T.setWacPreviewState(q,i.openWith.wac.applicationUrl,{bootScriptUrl:i.openWith.wac.bootstrapperUrl,wopiSrcUrl:i.openWith.wac.wopiSrc,accessToken:i.openWith.wac.accessToken,fileSize:oe.model.Size,fileGetUrl:i.openWith.wac.fileGetUrl,bundleInfo:i.officeBundle,fetchStartTime:i.fetchStartTime,responseStartTime:i.responseStartTime,openUrl:e},null,O.getTime(),i.currentUserRole.readOnly,de),[3,3];case 2:throw o=r.sent(),K.c.warn("Something went wrong while getting the attachment state: "+o.message),T.setPreviewError(q,Object(U.a)(F.a)),o;case 3:return[2]}})})}function p(){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return Object(j.b)(oe.model)&&oe.model.ProviderType===y.a.providers.GDRIVE?[4,v()]:[3,2];case 1:return n.sent(),[3,3];case 2:t=Object(k.a)(e.attachmentId,oe.model,3,Object(j.b)(oe.model),e.isReadOnly),T.setNativePdfPreviewState(q,oe.download.url+"&isDocumentPreview=True#toolbar=0",t,"application/pdf",de),n.label=3;case 3:return[2]}})})}function v(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n;return r.__generator(this,function(r){switch(r.label){case 0:e=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,x(oe.model)];case 2:return(t=r.sent())?(C(),T.setNativePdfPreviewState(q,t,null,"application/pdf",de),[2]):[3,4];case 3:return n=r.sent(),e=n,[3,4];case 4:throw C(),T.setPreviewError(q,Object(U.a)(M.a)),e||new Error("Unexpected error in handleNativeViewPreviewForGDrive")}})})}function w(){return r.__awaiter(this,void 0,void 0,function(){var t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return t=oe.info.allowDownload,n=Object(E.g)(oe.model,!0),t&&n.directFileAccessEnabled?(T.setPdfJsPreviewState(q,oe.download.url+"&isDocumentPreview=True",!1,de),[3,3]):[3,1];case 1:return[4,Q(e.attachmentId)];case 2:a=r.sent(),C(),T.setPdfJsPreviewStateByData(q,a,!t&&!Object(E.k)().printWithoutDownloadEnabled,de),r.label=3;case 3:return[2]}})})}function g(){return r.__awaiter(this,void 0,void 0,function(){var t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,G(e.attachmentId.Id,e.attachmentId.mailboxInfo&&e.attachmentId.mailboxInfo.requestOptions,l.c[o])];case 1:return t=r.sent(),C(),T.setTextPreviewState(q,t,de),[3,3];case 2:if(n=r.sent(),(a=n)&&a.errorMessage)throw C(),T.setPreviewError(q,a.errorMessage),a.error;throw n;case 3:return[2]}})})}function I(){return r.__awaiter(this,void 0,void 0,function(){var t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return t={calendarItem:null,isIcsAttachmentLoading:!0,icsCalendarEventType:N.a.UNKNOWN,attachmentId:e.attachmentId,addToCalendarStatus:1,errorMessage:null},[4,N.d.import()];case 1:return n=r.sent(),a=null,[4,n({attachmentId:e.attachmentId,size:oe.model.Size,showSizeLimitExceedsError:function(){a=Object(U.a)(ne.a)},errorCallback:function(){a=Object(U.a)(L.a)},state:t})];case 2:if(r.sent(),C(),a)throw T.setPreviewError(q,a),new Error(a);return _.onShowCustomPreview(t),T.setCustomPreviewState(q,de),[2]}})})}function C(){l.E.pendingPreviewOperation&&fe.id===l.E.pendingPreviewOperation.id||ee("Preview changed before loading finished")}var O,_,T,z,H,q,Z,oe,ce,ue,se,de,le,fe,me;return r.__generator(this,function(r){switch(r.label){case 0:return O=new Date,[4,l.A.import()];case 1:return _=r.sent(),$.a.available()?($.a.run(),[4,Y.q.import()]):(_.openSxSInANewWindow(t,e.attachmentId.Id,null),[2]);case 2:return T=r.sent(),z=_.onPreviewOperationStart,H=_.onPreviewOperationFinished,q=l.E.viewState,[4,y.i.import()];case 3:Z=r.sent(),oe=Z(e.attachmentId),ce=e.strategy,ue=Object(E.j)(oe.model,e.isCloudy,e.isReadOnly)&&Object(U.g)(oe.model.AttachmentOriginalUrl),se=ue?l.d.available:l.d.disabled,de={downloadUrl:oe.download.url,downloadShouldOpenNewTab:!1,fileName:oe.model.Name,useHighContrastCommandBar:!1,id:e.attachmentId},le=function(e,t,n,r,a){var i=8!==e.attachmentClass&&9!==e.attachmentClass&&Object(B.b)(e.model.Name||"")||e.model.ContentType||"",o=new P.a("PreviewAttachmentInSxSE2E",{isQos:!0});return o.addCustomData({previewMethod:J(t),fileType:i,fileSize:e.model.Size,isCloudy:n?"cloudy":"classic",isChangingFromEditing:r?"changingFromEdit":"",officeFileType:X(i),actionSource:l.c[a]}),o}(oe,ce.previewMethod,e.isCloudy,l.E.editState.mode!==l.b.View,o),fe={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.attachmentId},z(fe),r.label=4;case 4:return r.trys.push([4,27,,28]),[4,_.canCloseSxS()];case 5:switch(r.sent()||le.addCustomData({exitEditMode:"notSaved"}),C(),i(u,o,t,s),T.setPreviewLoading(q,"",de),_.showSxS(l.E.shouldShow?null:d,{previewMode:ce.previewMethod,attachmentId:e.attachmentId,selectionSource:o,isCloudy:e.isCloudy,saveToCloudStatus:se},{editAllowed:ce.allowEdit,itemId:t,isDraft:n},null),Object(W.j)(null),ce.previewMethod){case S.b.Image:return[3,6];case S.b.Wac:return[3,8];case S.b.GoogleDoc:return[3,10];case S.b.NativeView:return[3,11];case S.b.PdfJs:return[3,13];case S.b.Audio:return[3,15];case S.b.Video:return[3,16];case S.b.Text:return[3,17];case S.b.ItemAttachment:return[3,19];case S.b.CalendarEvent:return[3,20]}return[3,22];case 6:return[4,f()];case 7:return r.sent(),[3,23];case 8:return[4,m()];case 9:return r.sent(),[3,23];case 10:return T.setIframePreviewState(q,oe.model.AttachLongPathName,de),[3,23];case 11:return[4,p()];case 12:return r.sent(),[3,23];case 13:return[4,w()];case 14:return r.sent(),[3,23];case 15:return T.setAudioPreviewState(q,oe.download.url,de),[3,23];case 16:return T.setVideoPreviewState(q,oe.download.url,de),[3,23];case 17:return[4,g()];case 18:return r.sent(),[3,23];case 19:return Object(re.a)(e.attachmentId,null),T.setCustomPreviewState(q,de),[3,23];case 20:return[4,I()];case 21:return r.sent(),[3,23];case 22:throw new Error("Unsupported preview method");case 23:return[4,_.waitForPreviewLoadOrThrowError()];case 24:return r.sent(),C(),H(),a?[4,l.q.import()]:[3,26];case 25:r.sent()(ie),r.label=26;case 26:return le.end(),[3,28];case 27:return me=r.sent(),le.endWithError(te(me)?"UserError":"ServerError",me),[3,28];case 28:return[2]}})})}var ce=n(1482),ue=n(1015);function se(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return(t=e.viewState&&Object(ce.a)(e.viewState.attachmentId))&&Object(y.e)(t.model)?[4,ue.n.import()]:[3,2];case 1:return n.sent()(t.model,e.parentItemId),[2];case 2:return e.onBeforePreview&&e.onBeforePreview(),[4,oe(e.viewState,e.parentItemId,e.isDraft,!1,e.previewPaneSelectionSource,e.createImageGallery,{method:f.a.CopyMailReadingPaneContainer},e.instrumentationContext)];case 3:return n.sent(),[2]}})})}var de=n(6012);function le(e,t,n,a){return r.__awaiter(this,void 0,void 0,function(){var o,c,u,s,d,m,h,b;return r.__generator(this,function(r){switch(r.label){case 0:return $.a.run(),[4,l.w.import()];case 1:return o=r.sent(),[4,l.v.import()];case 2:return c=r.sent(),u=null,a instanceof HTMLElement?[4,de.b.import()]:[3,4];case 3:return s=r.sent(),u=s(a),[3,5];case 4:u=a,r.label=5;case 5:u||(u=l.E.viewState),d={downloadUrl:e.downloadUrl,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:e.id},m={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.id},o(m),r.label=6;case 6:return r.trys.push([6,9,,10]),[4,l.z.import()];case 7:return h=r.sent(),[4,Y.i.import()];case 8:return b=r.sent(),l.E.pendingPreviewOperation&&m.id===l.E.pendingPreviewOperation.id||ee("Preview changed before loading finished"),i({method:f.a.CopyMailReadingPaneContainer},l.c.ReadingPane,null,null),b(u,e.previewUrl,t,d),h(l.E.shouldShow?null:l.e.Mail,{previewMode:S.b.Image,attachmentId:e.id,selectionSource:l.c.ReadingPane,isCloudy:!1,saveToCloudStatus:l.d.disabled},{editAllowed:!1,itemId:n,isDraft:!1},null),Object(W.j)(null),c(),[3,10];case 9:return r.sent(),[3,10];case 10:return[2]}})})}function fe(e,t,n,a,o,c,u,s){return void 0===s&&(s=l.e.Mail),r.__awaiter(this,void 0,void 0,function(){function d(){l.E.pendingPreviewOperation&&y.id===l.E.pendingPreviewOperation.id||ee("Preview changed before loading finished")}var f,m,h,b,p,v,w,g,y,I,C,O;return r.__generator(this,function(r){switch(r.label){case 0:return $.a.run(),f=e(),[4,Y.q.import()];case 1:return m=r.sent(),[4,l.A.import()];case 2:h=r.sent(),b=h.onPreviewOperationStart,p=h.onPreviewOperationFinished,v=l.E.viewState,w={downloadUrl:null,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:null,fileName:null},g=function(e,t){var n=new P.a("PreviewLinkInSxSE2E");return n.addCustomData({previewMethod:J(e),actionSource:l.c[t]}),n}(S.b.Wac,n),y={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:null},b(y),r.label=3;case 3:return r.trys.push([3,10,,11]),[4,h.canCloseSxS()];case 4:r.sent(),d(),i(a,n,t,o),m.setPreviewLoading(v,"",w),h.showSxS(l.E.shouldShow?null:s,{previewMode:S.b.Wac,attachmentId:null,selectionSource:n,isCloudy:!0,saveToCloudStatus:l.d.disabled},{editAllowed:!1,itemId:t,isDraft:!1},c),Object(W.j)(c,u),r.label=5;case 5:return r.trys.push([5,7,,8]),[4,f];case 6:return I=r.sent(),d(),I.jsApiInfo&&(w.fileName=I.jsApiInfo.fileName,g.addCustomData({useJsApi:"true"})),m.setWacPreviewState(v,I.wacUrl,I.jsApiInfo,I.token,(new Date).getTime(),u,w),[3,8];case 7:return C=r.sent(),m.setPreviewError(v,C.message||C),[3,8];case 8:return[4,h.waitForPreviewLoadOrThrowError()];case 9:return r.sent(),d(),p(),g.end(),[3,11];case 10:return O=r.sent(),g.endWithError(te(O)?"UserError":"ServerError",O),[3,11];case 11:return[2]}})})}n.d(t,"previewAttachment",function(){return se}),n.d(t,"previewAttachmentInSxS",function(){return oe}),n.d(t,"previewImageInSxS",function(){return le}),n.d(t,"previewLinkInSxS",function(){return fe})},3756:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59);t.default=function(e,t){return r.makeServiceRequest("GetWacAttachmentInfo",e,t)}},4009:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),a=n(4010);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetAttachmentTextPreview",e,t)}},4010:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAttachmentTextPreviewRequest:#Exchange"},e)}},4025:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function a(e){return e&&void 0!==e.fetchErrorType}function i(e,t){e.addCustomProperty("ErrorInformation",t)}function o(e,t){i(e,t?"Empty response from server":"Null response from server")}n.d(t,"c",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"b",function(){return o})},4027:function(e){e.exports={a:"QUa"}},4082:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},4330:function(e){e.exports={a:"hVa"}},4438:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),a=n(4439),i=n.n(a),o=n(4082),c=n.n(o),u=n(12);function s(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,o,s,d,l,f,m,h,b,p;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),a=btoa(t),o="u!"+a.replace(/^\=+|\=+$/g,"").replace("/","_").replace("+","-"),s=new RegExp(/.+?\:\/\/.+?(\/)/g).exec(t)[0],d=s+"_api/v2.0/shares/"+o+"/root?select=openWith/wac,officeBundle,@content.downloadUrl,name,size,currentUserRole&action="+(n?"Open":"View"),l=c()({ProviderType:e,Url:d}),f=(new Date).getTime(),[4,i()(l)];case 1:if(200===(m=r.sent()).Status&&m.Body)return h=(new Date).getTime(),(b=JSON.parse(m.Body)).fetchStartTime=f,b.responseStartTime=h,b.openWith.wac.fileGetUrl=b["@content.downloadUrl"],!n&&b.currentUserRole&&(b.currentUserRole.readOnly=!0),[2,b];throw new Error("Result status is: "+m.Status+" or empty response body.");case 2:return p=r.sent(),u.c.warn("Something went wrong while calling fetchDataProviderResourceOperation: "+p),[3,3];case 3:return[2,null]}})})}},4439:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),a=n(4082);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("FetchDataProviderResource",e,t)}},4509:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(3756),a=n.n(r);function i(e,t,n,r,i){if(i){var o="getWacAttachmentInfo"+i;(r=r||{}).headers=r.headers||new Headers,r.headers.set("X-OWA-ActionName",o)}return a()({attachmentId:e,isEdit:t,draftId:n,appId:null},r)}},4580:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n(0),a=n(18),i=n(4025),o=n(4509),c={},u={},s=[],d=0,l=2;function f(e,t,n,i){return r.__awaiter(this,void 0,void 0,function(){var o,c;return r.__generator(this,function(u){return o=new a.a("InitializeWacUrl"),n&&o.addCustomProperty("actionSource",n),(c=h(e,t,o))?[2,c]:[2,new Promise(function(a,c){var u={attachmentId:e,isEdit:t,actionSource:n,datapoint:o,resolve:a,reject:c};i?m(u):(s.push(u),function e(){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:if(!s.length)return[2];if(d>=l)return[2];t=s.shift(),d++,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,m(t)];case 2:return n.sent(),[3,4];case 3:return d--,e(),[7];case 4:return[2]}})})}())})]})})}function m(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,s,d,l,f,m,b;return r.__generator(this,function(r){switch(r.label){case 0:if(t=e.attachmentId,n=e.isEdit,a=e.actionSource,s=e.datapoint,d=e.resolve,l=e.reject,f=h(t,n,s))return d(f),[2];s.addCustomProperty("ReturnFromCache",!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(o.a)(t.Id,n,null,t.mailboxInfo&&t.mailboxInfo.requestOptions,a)];case 2:return 0===(m=r.sent()).Status&&((n?u:c)[t.Id]={expireTime:(new Date).getTime()+36e5,value:m}),m.WacUrl||s.addCustomProperty("WacUrlIsEmpty",!0),s.addCustomProperty("WacAttachmentResponseStatus",m.Status.toString()),s.end(),d(m),[3,4];case 3:return b=r.sent(),Object(i.a)(b)&&Object(i.c)(s,b.response),Object(i.d)(s,b.toString()),s.endWithError("ServerError"),l(b),[3,4];case 4:return[2]}})})}function h(e,t,n){var r=t?u:c,a=r[e.Id];if(a){if(a.expireTime>=(new Date).getTime())return n.addCustomProperty("ReturnFromCache",!0),n.end(),a.value;delete r[e.Id]}return null}},4827:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(4974),a=n(5237),i=n(4027),o=n(4);function c(e){switch(e){case 2:return Object(o.a)(a.d);case 3:return Object(o.a)(a.e);case 5:return Object(o.a)(a.c);case 6:return Object(o.a)(r.a);case 7:return Object(o.a)(a.g);case 4:return Object(o.a)(a.f);case 10:return Object(o.a)(a.a);case 11:return Object(o.a)(a.b);default:return Object(o.a)(i.a)}}},4864:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SINGLE_EVENT_ICS=1]="SINGLE_EVENT_ICS",e[e.MULTIPLE_EVENT_ICS=2]="MULTIPLE_EVENT_ICS"}(r||(r={}))},4962:function(e,t,n){var r=n(5811),a=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},4974:function(e){e.exports={a:"XUa"}},5220:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return s});var r,a=n(5221),i=n(5222),o=n(5223),c=n(4);!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(r||(r={}));var u=n(4962);function s(e){return function(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return{app:r.Word,displayName:Object(c.a)(o.a),className:u.word,appName:"Word"};case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return{app:r.Excel,displayName:Object(c.a)(i.a),className:u.excel,appName:"Excel"};case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return{app:r.PowerPoint,displayName:Object(c.a)(a.a),className:u.powerpoint,appName:"PowerPoint"};default:return null}}(e&&e.substring(e.lastIndexOf(".")))}},5221:function(e){e.exports={a:"eVa"}},5222:function(e){e.exports={a:"gVa"}},5223:function(e){e.exports={a:"fVa"}},5237:function(e){e.exports={d:"YUa",e:"ZUa",c:"_Ua",g:"$Ua",f:"aVa",a:"bVa",b:"cVa"}},5811:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'._2AgmdyJn3fNov57VaZDxoM{top:0;bottom:0;position:fixed;z-index:2}html[dir] ._2AgmdyJn3fNov57VaZDxoM{background:"[theme:white, default:#ffffff]"}html[dir=ltr] ._2AgmdyJn3fNov57VaZDxoM,html[dir=rtl] ._2AgmdyJn3fNov57VaZDxoM{left:0;right:0}._2AgmdyJn3fNov57VaZDxoM._229sBQxFJ4drfyKjIWkXrL{top:48px;height:calc(100% - 48px)}._1pe2rvEObT1HDN3h-ec1Iw{max-width:calc(100vw - 66px);height:100vh;max-height:calc(100vh - 76px);min-height:100px;overflow:hidden}html[dir] ._1pe2rvEObT1HDN3h-ec1Iw{margin:38px 33px;border-radius:2px;background:"[theme:white, default:#ffffff]"}._1pe2rvEObT1HDN3h-ec1Iw ._1XyC3P-lTM63ywVpBc3nhE{width:100vw}._1pe2rvEObT1HDN3h-ec1Iw .ms-Modal-scrollableContent{overflow:hidden;height:100%}.n6HeOr6RePaAY7uVODnmE{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:100%}html[dir=ltr] .n6HeOr6RePaAY7uVODnmE .ms-CommandBar-primaryCommands{margin-left:-4px}html[dir=rtl] .n6HeOr6RePaAY7uVODnmE .ms-CommandBar-primaryCommands{margin-right:-4px}html[dir=ltr] .n6HeOr6RePaAY7uVODnmE .ms-CommandBar-sideCommands{padding-right:0;margin-right:-4px}html[dir=rtl] .n6HeOr6RePaAY7uVODnmE .ms-CommandBar-sideCommands{padding-left:0;margin-left:-4px}._1cPFP118Kj1l5w4ETaiw7h{height:100%}._1cPFP118Kj1l5w4ETaiw7h.LYq6efsEPCIAZmDfweNmN{width:100%;min-width:auto}._3ODPm-UFo5sQvpLi13o_Zo{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;position:relative}html[dir=ltr] ._3ODPm-UFo5sQvpLi13o_Zo{border-left:1px solid "[theme:neutralLight, default:#eaeaea]"}html[dir=rtl] ._3ODPm-UFo5sQvpLi13o_Zo{border-right:1px solid "[theme:neutralLight, default:#eaeaea]"}._3PcY_c6Hos8oY_rUrXUZde{-webkit-box-flex:0;-ms-flex:0 0 44px;flex:0 0 44px}html[dir=ltr] ._3PcY_c6Hos8oY_rUrXUZde .ms-CommandBar-primaryCommand{margin-left:16px}html[dir=rtl] ._3PcY_c6Hos8oY_rUrXUZde .ms-CommandBar-primaryCommand{margin-right:16px}.PKTpY5TnCtiVPeKgU01CK{-webkit-box-flex:0;-ms-flex:0 0 44px;flex:0 0 44px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}html[dir] .PKTpY5TnCtiVPeKgU01CK{background:"[theme:white, default:#ffffff]";border-bottom:1px solid "[theme:neutralLight, default:#eaeaea]"}html[dir=ltr] .PKTpY5TnCtiVPeKgU01CK .ms-CommandBar-primaryCommand{margin-left:10px}html[dir=rtl] .PKTpY5TnCtiVPeKgU01CK .ms-CommandBar-primaryCommand{margin-right:10px}.PKTpY5TnCtiVPeKgU01CK ._3hCbzoGdLCTYiwLiYJ6P0O{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-size:16px;font-weight:600;line-height:100%;display:none}html[dir] .PKTpY5TnCtiVPeKgU01CK ._3hCbzoGdLCTYiwLiYJ6P0O{margin-bottom:1px}html[dir=ltr] .PKTpY5TnCtiVPeKgU01CK ._3hCbzoGdLCTYiwLiYJ6P0O{margin-left:24px}html[dir=rtl] .PKTpY5TnCtiVPeKgU01CK ._3hCbzoGdLCTYiwLiYJ6P0O{margin-right:24px}.PKTpY5TnCtiVPeKgU01CK ._3hCbzoGdLCTYiwLiYJ6P0O._10zP7nLlkV0emaGS9TZt2Q{color:#2b569a;display:block}.PKTpY5TnCtiVPeKgU01CK ._3hCbzoGdLCTYiwLiYJ6P0O._3U1WID_PO0RPJSg-4tXXYd{color:#217345;display:block}.PKTpY5TnCtiVPeKgU01CK ._3hCbzoGdLCTYiwLiYJ6P0O._1HU6OGj3jqEQq9qu8WqNoa{color:#b9553b;display:block}.PKTpY5TnCtiVPeKgU01CK ._181cRZ2YFDknIdRumztVMd{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-size:14px;color:"[theme:neutralPrimary, default:#333333]";line-height:200%;text-overflow:ellipsis;max-width:260px;white-space:nowrap;overflow:hidden}html[dir=ltr] .PKTpY5TnCtiVPeKgU01CK ._181cRZ2YFDknIdRumztVMd{margin-left:12px}html[dir=rtl] .PKTpY5TnCtiVPeKgU01CK ._181cRZ2YFDknIdRumztVMd{margin-right:12px}html[dir=ltr] .PKTpY5TnCtiVPeKgU01CK ._181cRZ2YFDknIdRumztVMd:first-child{margin-left:24px}html[dir=rtl] .PKTpY5TnCtiVPeKgU01CK ._181cRZ2YFDknIdRumztVMd:first-child{margin-right:24px}.PKTpY5TnCtiVPeKgU01CK ._3BxJzj5Ynr65T_59QJyEf9{-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}html[dir] .PKTpY5TnCtiVPeKgU01CK ._3BxJzj5Ynr65T_59QJyEf9 .ms-Button:not(:hover),html[dir] .PKTpY5TnCtiVPeKgU01CK ._3BxJzj5Ynr65T_59QJyEf9 .ms-CommandBar{background:"[theme:white, default:#ffffff]"}html[dir] .ms-CommandBar.lW23zZctzX6ymR0506r0b{border-bottom:1px solid "[theme:neutralLight, default:#eaeaea]"}._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBar{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage)}html[dir] ._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBar{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:"[theme:black, default:#000000]"}html[dir] ._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBar-overflowButton,html[dir] ._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link{background:"[theme:black, default:#000000]"}._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBar-overflowButton .ms-Button-menuIcon,._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link:hover:not([disabled]) .ms-Button-icon,._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link:hover:not([disabled]) .ms-Button-textContainer,._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link:not([disabled]) .ms-Button-icon,._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link:not([disabled]) .ms-Button-textContainer{color:"[theme:white, default:#ffffff]"}html[dir] ._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBar-overflowButton:hover,html[dir] ._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link:hover,html[dir] ._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem:hover{background:"[theme:neutralDark, default:#212121]"}._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link[disabled] .ms-CommandBarItem-iconColor,._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link:disabled{color:"[theme:neutralSecondary, default:#666666]"}._3lGb8Ny65JvILt8UzD2dU7{display:-webkit-box;display:-ms-flexbox;display:flex;height:calc(100% - 45px);-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}._3lGb8Ny65JvILt8UzD2dU7:first-child:last-child{height:100%}.amdAASP-UuvTbedSo8gd_{opacity:0}html[dir] .amdAASP-UuvTbedSo8gd_{-webkit-transition:none;transition:none}._1IH6jWRgbk5jrrT7FA3EBR{opacity:0}#app._2dIGUGnogcskHGsQS7Z8zm .customScrollBar{overflow-x:hidden;overflow-y:hidden}',""]),t.locals={owaSxSLayer:"_2AgmdyJn3fNov57VaZDxoM",showOwaHeader:"_229sBQxFJ4drfyKjIWkXrL",owaSxSDialog:"_1pe2rvEObT1HDN3h-ec1Iw",owaSxSDialogSpacer:"_1XyC3P-lTM63ywVpBc3nhE",owaSxS:"n6HeOr6RePaAY7uVODnmE",owaSxSLeftPane:"_1cPFP118Kj1l5w4ETaiw7h",hideRightPane:"LYq6efsEPCIAZmDfweNmN",owaSxSRightPane:"_3ODPm-UFo5sQvpLi13o_Zo",commandBar:"_3PcY_c6Hos8oY_rUrXUZde",commandBarStyleUpdate:"PKTpY5TnCtiVPeKgU01CK",officeOnlineBranding:"_3hCbzoGdLCTYiwLiYJ6P0O",word:"_10zP7nLlkV0emaGS9TZt2Q",excel:"_3U1WID_PO0RPJSg-4tXXYd",powerpoint:"_1HU6OGj3jqEQq9qu8WqNoa",fileName:"_181cRZ2YFDknIdRumztVMd",commandBarInner:"_3BxJzj5Ynr65T_59QJyEf9",newCommandBar:"lW23zZctzX6ymR0506r0b",highContrastCommandBar:"_1T-YX5n2-mPNCD5DRlBlWE",owaSxSMain:"_3lGb8Ny65JvILt8UzD2dU7",owaSxSDialogRoot:"amdAASP-UuvTbedSo8gd_",owaSxSLayerHidden:"_1IH6jWRgbk5jrrT7FA3EBR",excelWorkAroundForEdge:"_2dIGUGnogcskHGsQS7Z8zm"}},6012:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(3),a=new r.c(function(){return Promise.all([n.e(8),n.e(516),n.e(12),n.e(28),n.e(384)]).then(n.bind(null,7614))}),i=new r.b(a,function(e){return e.getSxSViewStateFromElement}),o=Object(r.d)(a,function(e){return e.SxSLayerView});Object(r.d)(a,function(e){return e.SxSView})},6261:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(0),a=n(4027),i=n(4),o=n(4827),c=n(4580);function u(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var u,s;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(c.a)(e,t,n,!0)];case 1:return u=r.sent(),[3,3];case 2:throw s=r.sent(),{errorMessage:Object(i.a)(a.a),error:s};case 3:if(0===u.Status)return[2,{wacUrl:u.WacUrl,bootScriptUrl:u.BootScriptUrl,wopiSrcUrl:u.WopiSrcUrl,accessToken:u.AccessToken,token:u.Token}];throw{errorMessage:Object(o.a)(u.Status),error:new Error("GetWacAttachmentInfo failed with status: "+u.Status)}}})})}},6331:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return u});var r=n(4864);n.d(t,"a",function(){return r.a});var a=n(3),i=new a.c(function(){return Promise.all([n.e(4),n.e(7),n.e(490),n.e(16),n.e(245)]).then(n.bind(null,8129))}),o=new a.b(i,function(e){return e.addToCalendar}),c=(new a.b(i,function(e){return e.getIcsCalendarItem}),new a.b(i,function(e){return e.getIcsCalendarItemOrchestrator})),u=Object(a.d)(i,function(e){return e.IcsPreview})},659:function(e,t,n){"use strict";var r=n(8),a=n(1),i={folderTable:new r.ObservableMap,rootFolder:null},o=Object(a.createStore)("publicFolderFavoriteStore",i)();t.a=o},747:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(994);function a(e){return o(e.type)}function i(e){return o(Object(r.a)(e))}function o(e){return 1===e||3===e}},805:function(e,t,n){"use strict";n.d(t,"b",function(){return o});var r=n(8),a=n(1),i={viewStates:new r.ObservableMap,primaryComposeId:null,complianceConfigurations:new r.ObservableMap,newMessageCreationInProgress:!1},o=Object(a.createStore)("compose",i),c=o();t.a=c},806:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"h",function(){return c}),n.d(t,"g",function(){return u}),n.d(t,"f",function(){return s}),n.d(t,"d",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"a",function(){return f});var r=n(0),a=n(176),i="deeplink",o="compose",c="reply",u="replyall",s="read",d="group",l="/"+r.__spread(["mail"],Object(a.a)().split("/").slice(1)).join("/")+i+"/",f="/"+r.__spread(["calendar"],Object(a.a)().split("/").slice(1)).join("/")+i+"/"},938:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return u});var r=600,a=600,i=650,o=1/2.89*100,c=420,u=420/1300*100},944:function(e,t,n){"use strict";var r;!function(e){e.InfoRestrictedAccess="infoRestrictedAccess"}(r||(r={}));var a=n(98);function i(e){switch(e){case 0:return r.InfoRestrictedAccess;default:return Object(a.a)(e)}}var o=n(9);function c(e){switch(e){case 0:return(t=Object(o.a)().AttachmentPolicy).ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked||t.ConditionalAccessPrintWithoutDownloadBlocked||t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked;default:return Object(a.a)(e)}var t}var u=[0],s=n(1625);function d(){return u.filter(c)}function l(e){return e&&e.length>0&&function(e){return e.some(function(e){return!((t=e).IsInline&&!function(e){return e.__type===s.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(t));var t})}(e)?u.filter(c):[]}var f=n(1711),m=n(4),h=n(520);function b(e){switch(e){case r.InfoRestrictedAccess:return{key:"access_control_info_bar",source:h.c.Compose,rank:h.b.Error,messageParts:[Object(m.a)(f.b),(t="https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done",{text:Object(m.a)(f.a),action:function(){window.open(t,"_blank")}})],color:h.a.Red};default:return Object(a.a)(e)}var t}var p,v=n(494);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.ConditionalAccess=4]="ConditionalAccess"}(p||(p={}));var w=function(){function e(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=p[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}return e.prototype.getPolicyInfo=function(e,t,n,r){e&&(e=e.toLowerCase());var a=this.getFileAccessLevel(e,t),i=!1,o=!1,c=!1,u="ReferenceAttachment:#Exchange"===r;return a!==p.Block&&n&&(this.isWacViewingEnabled(e)&&(i=!0),!this.directFileAccessEnabled&&u&&(i=!1),o=this.isForceBrowserViewingFirst(i),i&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(c="FileAttachment:#Exchange"===r?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),i||this.directFileAccessEnabled||(a=p.ConditionalAccess)),{directFileAccessEnabled:this.directFileAccessEnabled,level:a,useWac:i,forceBrowserViewingFirst:o,wacEdit:c}},e.prototype.isPdfPreviewEnabled=function(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled},e.prototype.getFileAccessLevel=function(e,t){var n=this.fileTypeToPolicyMap[e];if(n||(n=p.Undefined),n===p.Block)return p.Block;var r=this.mimeTypeToPolicyMap[t];return r===p.Block?p.Block:n===p.ForceSave||r===p.ForceSave?p.ForceSave:n===p.Allow||r===p.Allow?p.Allow:this.policyForUnknownTypes},e.prototype.isWacViewingEnabled=function(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0},e.prototype.isForceBrowserViewingFirst=function(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},e.prototype.addPolicyIntoMap=function(e,t,n){t&&t.forEach(function(t){e[t]=n})},e.prototype.createPolicyMap=function(e,t,n){var r={};return this.addPolicyIntoMap(r,n,p.Allow),this.addPolicyIntoMap(r,t,p.ForceSave),this.addPolicyIntoMap(r,e,p.Block),r},e}(),g=null,P=null;function S(){if(!g){var e=Object(o.a)(),t=e.AttachmentPolicy,n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;g=new w(t,n),n&&(P=g)}return g}function y(e,t){var n=Object(v.a)(e.Name),r=e.ContentType;return S().getPolicyInfo(n,r,t,e.__type)}function I(e,t){var n=Object(v.a)(e.Name),r=e.ContentType;return function(){if(!P){var e=Object(o.a)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return S();P=new w(e.AttachmentPolicy,!0)}return P}().getPolicyInfo(n,r,t,e.__type)}function C(e,t,n){var r=y(e,!0),a=S();return r.level!==p.Block&&a.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"i",function(){return b}),n.d(t,"b",function(){return r}),n.d(t,"d",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"h",function(){return i}),n.d(t,"j",function(){return C}),n.d(t,"c",function(){return p}),n.d(t,"f",function(){return y}),n.d(t,"g",function(){return I}),n.d(t,"k",function(){return S})},9504:function(e){e.exports={a:"dVa"}},991:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(9),a="HTML",i="Text",o="Html";function c(){return Object(r.a)().UserOptions.ComposeMarkup==o?"HTML":"Text"}}},0,[4,7,8,19,336,0,1,30,474,155,3,469,120,2,271,12,37,103,463,87,464,98,195,295,379,445,447]]);
//# sourceMappingURL=owa.AttachmentPreviewSxS.js.map
self.scriptsLoaded['owa.AttachmentPreviewSxS.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentPreviewSxS.js'] = (new Date()).getTime();