self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.2.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[2],{3495:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i(738),s=i(237),o=function(){function e(e){void 0===e&&(e={});var t=e.onSelectionChanged,i=e.getKey,s=e.canSelectItem,o=void 0===s?function(e){return!0}:s,r=e.selectionMode,l=void 0===r?n.c.multiple:r;this.mode=l,this._getKey=i||c,this._changeEventSuppressionCount=0,this._exemptedCount=0,this._anchoredIndex=0,this._unselectableCount=0,this._onSelectionChanged=t,this._canSelectItem=o,this._isModal=!1,this.setItems([],!0),this.count=this.getSelectedCount()}return e.prototype.canSelectItem=function(e,t){return!("number"==typeof t&&t<0)&&this._canSelectItem(e,t)},e.prototype.getKey=function(e,t){var i=this._getKey(e,t);return"number"==typeof i||i?""+i:""},e.prototype.setChangeEvents=function(e,t){this._changeEventSuppressionCount+=e?-1:1,0===this._changeEventSuppressionCount&&this._hasChanged&&(this._hasChanged=!1,t||this._change())},e.prototype.isModal=function(){return this._isModal},e.prototype.setModal=function(e){this._isModal!==e&&(this.setChangeEvents(!1),this._isModal=e,e||this.setAllSelected(!1),this._change(),this.setChangeEvents(!0))},e.prototype.setItems=function(e,t){void 0===t&&(t=!0);var i={},n={},s=!1;this.setChangeEvents(!1),this._unselectableCount=0;for(var o=0;o<e.length;o++){if(a=e[o]){var c=this.getKey(a,o);c&&(i[c]=o)}n[o]=a&&!this.canSelectItem(a),n[o]&&this._unselectableCount++}(t||0===e.length)&&this._setAllSelected(!1,!0);var r={},l=0;for(var h in this._exemptedIndices)if(this._exemptedIndices.hasOwnProperty(h)){var a,d=Number(h),u=(a=this._items[d])?this.getKey(a,Number(d)):void 0,_=u?i[u]:d;void 0===_?s=!0:(r[_]=!0,l++,s=s||_!==d)}this._items&&0===this._exemptedCount&&e.length!==this._items.length&&this._isAllSelected&&(s=!0),this._exemptedIndices=r,this._exemptedCount=l,this._keyToIndexMap=i,this._unselectableIndices=n,this._items=e,this._selectedItems=null,s&&(this._updateCount(),this._change()),this.setChangeEvents(!0)},e.prototype.getItems=function(){return this._items},e.prototype.getSelection=function(){if(!this._selectedItems){this._selectedItems=[];var e=this._items;if(e)for(var t=0;t<e.length;t++)this.isIndexSelected(t)&&this._selectedItems.push(e[t])}return this._selectedItems},e.prototype.getSelectedCount=function(){return this._isAllSelected?this._items.length-this._exemptedCount-this._unselectableCount:this._exemptedCount},e.prototype.getSelectedIndices=function(){if(!this._selectedIndices){this._selectedIndices=[];var e=this._items;if(e)for(var t=0;t<e.length;t++)this.isIndexSelected(t)&&this._selectedIndices.push(t)}return this._selectedIndices},e.prototype.isRangeSelected=function(e,t){if(0===t)return!1;for(var i=e+t,n=e;n<i;n++)if(!this.isIndexSelected(n))return!1;return!0},e.prototype.isAllSelected=function(){var e=this._items.length-this._unselectableCount;return this.mode===n.c.single&&(e=Math.min(e,1)),this.count>0&&this._isAllSelected&&0===this._exemptedCount||!this._isAllSelected&&this._exemptedCount===e&&e>0},e.prototype.isKeySelected=function(e){var t=this._keyToIndexMap[e];return this.isIndexSelected(t)},e.prototype.isIndexSelected=function(e){return!!(this.count>0&&this._isAllSelected&&!this._exemptedIndices[e]&&!this._unselectableIndices[e]||!this._isAllSelected&&this._exemptedIndices[e])},e.prototype.setAllSelected=function(e){if(!e||this.mode===n.c.multiple){var t=this._items?this._items.length-this._unselectableCount:0;this.setChangeEvents(!1),t>0&&(this._exemptedCount>0||e!==this._isAllSelected)&&(this._exemptedIndices={},(e!==this._isAllSelected||this._exemptedCount>0)&&(this._exemptedCount=0,this._isAllSelected=e,this._change()),this._updateCount()),this.setChangeEvents(!0)}},e.prototype.setKeySelected=function(e,t,i){var n=this._keyToIndexMap[e];n>=0&&this.setIndexSelected(n,t,i)},e.prototype.setIndexSelected=function(e,t,i){if(this.mode!==n.c.none&&!((e=Math.min(Math.max(0,e),this._items.length-1))<0||e>=this._items.length)){this.setChangeEvents(!1);var s=this._exemptedIndices[e];!this._unselectableIndices[e]&&(t&&this.mode===n.c.single&&this._setAllSelected(!1,!0),s&&(t&&this._isAllSelected||!t&&!this._isAllSelected)&&(delete this._exemptedIndices[e],this._exemptedCount--),!s&&(t&&!this._isAllSelected||!t&&this._isAllSelected)&&(this._exemptedIndices[e]=!0,this._exemptedCount++),i&&(this._anchoredIndex=e)),this._updateCount(),this.setChangeEvents(!0)}},e.prototype.selectToKey=function(e,t){this.selectToIndex(this._keyToIndexMap[e],t)},e.prototype.selectToIndex=function(e,t){if(this.mode!==n.c.none)if(this.mode!==n.c.single){var i=this._anchoredIndex||0,s=Math.min(e,i),o=Math.max(e,i);for(this.setChangeEvents(!1),t&&this._setAllSelected(!1,!0);s<=o;s++)this.setIndexSelected(s,!0,!1);this.setChangeEvents(!0)}else this.setIndexSelected(e,!0,!0)},e.prototype.toggleAllSelected=function(){this.setAllSelected(!this.isAllSelected())},e.prototype.toggleKeySelected=function(e){this.setKeySelected(e,!this.isKeySelected(e),!0)},e.prototype.toggleIndexSelected=function(e){this.setIndexSelected(e,!this.isIndexSelected(e),!0)},e.prototype.toggleRangeSelected=function(e,t){if(this.mode!==n.c.none){var i=this.isRangeSelected(e,t),s=e+t;if(!(this.mode===n.c.single&&t>1)){this.setChangeEvents(!1);for(var o=e;o<s;o++)this.setIndexSelected(o,!i,!1);this.setChangeEvents(!0)}}},e.prototype._updateCount=function(e){void 0===e&&(e=!1);var t=this.getSelectedCount();t!==this.count&&(this.count=t,this._change()),this.count||e||this.setModal(!1)},e.prototype._setAllSelected=function(e,t){if(void 0===t&&(t=!1),!e||this.mode===n.c.multiple){var i=this._items?this._items.length-this._unselectableCount:0;this.setChangeEvents(!1),i>0&&(this._exemptedCount>0||e!==this._isAllSelected)&&(this._exemptedIndices={},(e!==this._isAllSelected||this._exemptedCount>0)&&(this._exemptedCount=0,this._isAllSelected=e,this._change()),this._updateCount(t)),this.setChangeEvents(!0)}},e.prototype._change=function(){0===this._changeEventSuppressionCount?(this._selectedItems=null,this._selectedIndices=void 0,s.a.raise(this,n.a),this._onSelectionChanged&&this._onSelectionChanged()):this._hasChanged=!0},e}();function c(e,t){return e&&e.key?e.key:""+t}},3506:function(e,t,i){"use strict";i.d(t,"a",function(){return m});var n=i(0),s=i(2),o=i(222),c=i(162),r=i(53),l=i(101),h=i(506),a=i(125),d=i(77),u=i(131),_=i(738),p="data-selection-toggle",f="data-selection-invoke",g="data-selection-all-toggle",m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._root=s.createRef(),t.ignoreNextFocus=function(){t._handleNextFocus(!1)},t._onMouseDownCapture=function(e){if(document.activeElement===e.target||Object(o.a)(document.activeElement,e.target)){if(Object(o.a)(e.target,t._root.current))for(var i=e.target;i!==t._root.current;){if(t._hasAttribute(i,f)){t.ignoreNextFocus();break}i=Object(c.a)(i)}}else t.ignoreNextFocus()},t._onFocus=function(e){var i=e.target,n=t.props.selection,s=t._isCtrlPressed||t._isMetaPressed,o=t._getSelectionMode();if(t._shouldHandleFocus&&o!==_.c.none){var c=t._hasAttribute(i,p),r=t._findItemRoot(i);if(!c&&r){var l=t._getItemIndex(r);s?(n.setIndexSelected(l,n.isIndexSelected(l),!0),t.props.enterModalOnTouch&&t._isTouch&&n.setModal&&(n.setModal(!0),t._setIsTouch(!1))):t.props.isSelectedOnFocus&&t._onItemSurfaceClick(e,l)}}t._handleNextFocus(!1)},t._onMouseDown=function(e){t._updateModifiers(e);var i=e.target,n=t._findItemRoot(i);if(!t._isSelectionDisabled(i))for(;i!==t._root.current&&!t._hasAttribute(i,g);){if(n){if(t._hasAttribute(i,p))break;if(t._hasAttribute(i,f))break;if(!(i!==n&&!t._shouldAutoSelect(i)||t._isShiftPressed||t._isCtrlPressed||t._isMetaPressed)){t._onInvokeMouseDown(e,t._getItemIndex(n));break}if(t.props.disableAutoSelectOnInputElements&&("A"===i.tagName||"BUTTON"===i.tagName||"INPUT"===i.tagName))return}i=Object(c.a)(i)}},t._onTouchStartCapture=function(e){t._setIsTouch(!0)},t._onClick=function(e){t._updateModifiers(e);for(var i=e.target,n=t._findItemRoot(i),s=t._isSelectionDisabled(i);i!==t._root.current;){if(t._hasAttribute(i,g)){s||t._onToggleAllClick(e);break}if(n){var o=t._getItemIndex(n);if(t._hasAttribute(i,p)){s||(t._isShiftPressed?t._onItemSurfaceClick(e,o):t._onToggleClick(e,o));break}if(t._hasAttribute(i,f)){t._onInvokeClick(e,o);break}if(i===n){s||t._onItemSurfaceClick(e,o);break}if("A"===i.tagName||"BUTTON"===i.tagName||"INPUT"===i.tagName)return}i=Object(c.a)(i)}},t._onContextMenu=function(e){var i=e.target,n=t.props,s=n.onItemContextMenu,o=n.selection;if(s){var c=t._findItemRoot(i);if(c){var r=t._getItemIndex(c);t._onInvokeMouseDown(e,r),s(o.getItems()[r],r,e.nativeEvent)||e.preventDefault()}}},t._onDoubleClick=function(e){var i=e.target,n=t.props.onItemInvoked,s=t._findItemRoot(i);if(s&&n&&!t._isInputElement(i)){for(var o=t._getItemIndex(s);i!==t._root.current&&!t._hasAttribute(i,p)&&!t._hasAttribute(i,f);){if(i===s){t._onInvokeClick(e,o);break}i=Object(c.a)(i)}i=Object(c.a)(i)}},t._onKeyDownCapture=function(e){t._updateModifiers(e),t._handleNextFocus(!0)},t._onKeyDown=function(e){t._updateModifiers(e);var i=e.target,n=t._isSelectionDisabled(i),s=t.props.selection,o=e.which===r.a.a&&(t._isCtrlPressed||t._isMetaPressed),l=e.which===r.a.escape;if(!t._isInputElement(i)){var h=t._getSelectionMode();if(o&&h===_.c.multiple&&!s.isAllSelected())return n||s.setAllSelected(!0),e.stopPropagation(),void e.preventDefault();if(l&&s.getSelectedCount()>0)return n||s.setAllSelected(!1),e.stopPropagation(),void e.preventDefault();var a=t._findItemRoot(i);if(a)for(var d=t._getItemIndex(a);i!==t._root.current&&!t._hasAttribute(i,p);){if(t._shouldAutoSelect(i)){n||t._onInvokeMouseDown(e,d);break}if(!(e.which!==r.a.enter&&e.which!==r.a.space||"BUTTON"!==i.tagName&&"A"!==i.tagName&&"INPUT"!==i.tagName))return!1;if(i===a){if(e.which===r.a.enter)return t._onInvokeClick(e,d),void e.preventDefault();if(e.which===r.a.space)return n||t._onToggleClick(e,d),void e.preventDefault();break}i=Object(c.a)(i)}}},t}return n.__extends(t,e),t.prototype.componentDidMount=function(){var e=Object(l.a)(this._root.current);this._events.on(e,"keydown, keyup",this._updateModifiers,!0),this._events.on(document,"click",this._findScrollParentAndTryClearOnEmptyClick),this._events.on(document.body,"touchstart",this._onTouchStartCapture,!0),this._events.on(document.body,"touchend",this._onTouchStartCapture,!0)},t.prototype.render=function(){return s.createElement("div",n.__assign({className:"ms-SelectionZone",ref:this._root,onKeyDown:this._onKeyDown,onMouseDown:this._onMouseDown,onKeyDownCapture:this._onKeyDownCapture,onClick:this._onClick,role:"presentation",onDoubleClick:this._onDoubleClick,onContextMenu:this._onContextMenu},{onMouseDownCapture:this._onMouseDownCapture,onFocusCapture:this._onFocus}),this.props.children)},t.prototype._isSelectionDisabled=function(e){if(this._getSelectionMode()===_.c.none)return!0;for(;e!==this._root.current;){if(this._hasAttribute(e,"data-selection-disabled"))return!0;e=Object(c.a)(e)}return!1},t.prototype._onToggleAllClick=function(e){var t=this.props.selection;this._getSelectionMode()===_.c.multiple&&(t.toggleAllSelected(),e.stopPropagation(),e.preventDefault())},t.prototype._onToggleClick=function(e,t){var i=this.props.selection,n=this._getSelectionMode();if(i.setChangeEvents(!1),this.props.enterModalOnTouch&&this._isTouch&&!i.isIndexSelected(t)&&i.setModal&&(i.setModal(!0),this._setIsTouch(!1)),n===_.c.multiple)i.toggleIndexSelected(t);else{if(n!==_.c.single)return void i.setChangeEvents(!0);var s=i.isIndexSelected(t),o=i.isModal&&i.isModal();i.setAllSelected(!1),i.setIndexSelected(t,!s,!0),o&&i.setModal&&i.setModal(!0)}i.setChangeEvents(!0),e.stopPropagation()},t.prototype._onInvokeClick=function(e,t){var i=this.props,n=i.selection,s=i.onItemInvoked;s&&(s(n.getItems()[t],t,e.nativeEvent),e.preventDefault(),e.stopPropagation())},t.prototype._onItemSurfaceClick=function(e,t){var i=this.props.selection,n=this._isCtrlPressed||this._isMetaPressed,s=this._getSelectionMode();s===_.c.multiple?this._isShiftPressed&&!this._isTabPressed?i.selectToIndex(t,!n):n?i.toggleIndexSelected(t):this._clearAndSelectIndex(t):s===_.c.single&&this._clearAndSelectIndex(t)},t.prototype._onInvokeMouseDown=function(e,t){this.props.selection.isIndexSelected(t)||this._clearAndSelectIndex(t)},t.prototype._findScrollParentAndTryClearOnEmptyClick=function(e){var t=Object(h.e)(this._root.current);this._events.off(document,"click",this._findScrollParentAndTryClearOnEmptyClick),this._events.on(t,"click",this._tryClearOnEmptyClick),(t&&e.target instanceof Node&&t.contains(e.target)||t===e.target)&&this._tryClearOnEmptyClick(e)},t.prototype._tryClearOnEmptyClick=function(e){!this.props.selectionPreservedOnEmptyClick&&this._isNonHandledClick(e.target)&&this.props.selection.setAllSelected(!1)},t.prototype._clearAndSelectIndex=function(e){var t=this.props.selection;1===t.getSelectedCount()&&t.isIndexSelected(e)||(t.setChangeEvents(!1),t.setAllSelected(!1),t.setIndexSelected(e,!0,!0),this.props.enterModalOnTouch&&this._isTouch&&t.setModal&&(t.setModal(!0),this._setIsTouch(!1)),t.setChangeEvents(!0))},t.prototype._updateModifiers=function(e){this._isShiftPressed=e.shiftKey,this._isCtrlPressed=e.ctrlKey,this._isMetaPressed=e.metaKey;var t=e.keyCode;this._isTabPressed=!!t&&t===r.a.tab},t.prototype._findItemRoot=function(e){for(var t=this.props.selection;e!==this._root.current;){var i=e.getAttribute("data-selection-index"),n=Number(i);if(null!==i&&n>=0&&n<t.getItems().length)break;e=Object(c.a)(e)}if(e!==this._root.current)return e},t.prototype._getItemIndex=function(e){return Number(e.getAttribute("data-selection-index"))},t.prototype._shouldAutoSelect=function(e){return this._hasAttribute(e,"data-selection-select")},t.prototype._hasAttribute=function(e,t){for(var i=!1;!i&&e!==this._root.current;)i="true"===e.getAttribute(t),e=Object(c.a)(e);return i},t.prototype._isInputElement=function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName},t.prototype._isNonHandledClick=function(e){var t=Object(a.a)();if(t&&e)for(;e&&e!==t.documentElement;){if(Object(d.n)(e))return!1;e=Object(c.a)(e)}return!0},t.prototype._handleNextFocus=function(e){var t=this;this._shouldHandleFocusTimeoutId&&(this._async.clearTimeout(this._shouldHandleFocusTimeoutId),this._shouldHandleFocusTimeoutId=void 0),this._shouldHandleFocus=e,e&&this._async.setTimeout(function(){t._shouldHandleFocus=!1},100)},t.prototype._setIsTouch=function(e){var t=this;this._isTouchTimeoutId&&(this._async.clearTimeout(this._isTouchTimeoutId),this._isTouchTimeoutId=void 0),this._isTouch=!0,e&&this._async.setTimeout(function(){t._isTouch=!1},300)},t.prototype._getSelectionMode=function(){var e=this.props.selection,t=this.props.selectionMode;return void 0===t?e?e.mode:_.c.none:t},t.defaultProps={isMultiSelectEnabled:!0,isSelectedOnFocus:!0,selectionMode:_.c.multiple},t}(u.a)},738:function(e,t,i){"use strict";i.d(t,"a",function(){return o}),i.d(t,"c",function(){return n}),i.d(t,"b",function(){return s});var n,s,o="change";!function(e){e[e.none=0]="none",e[e.single=1]="single",e[e.multiple=2]="multiple"}(n||(n={})),function(e){e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical"}(s||(s={}))}}]);
//# sourceMappingURL=owa.2.js.map
self.scriptsLoaded['owa.2.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.2.js'] = (new Date()).getTime();