self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.HeaderCharms.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[238],{1183:function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"g",function(){return f}),n.d(t,"f",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"a",function(){return h});var r=n(3),i=n(1900);n.d(t,"b",function(){return i.a});var a=n(1899);n.d(t,"d",function(){return a.a});var c=n(5),u=new r.c(function(){return Promise.all([n.e(3),n.e(4),n.e(371)]).then(n.bind(null,3036))}),o=new r.b(u,function(e){return e.initializeSkypeForBusiness});function s(){Object(c.d)("fwk-skypeBusinessV2")&&o.import().then(function(e){return e()})}var f=new r.b(u,function(e){return e.tryRegisterForPresenceUpdates}),d=new r.b(u,function(e){return e.startChat}),l=new r.a(u,function(e){return e.setIsChatCalloutShown}),h=Object(r.d)(u,function(e){return e.UcmaChatView})},1359:function(e,t,n){"use strict";var r=n(1),i=Object(r.createStore)("SkypeStore",{unreadConversationCount:0,isRecentsInitialized:!1,isSwcInitialized:!1,isGlimpseOpen:!1})();t.a=i},1385:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(5),i=n(299);function a(){return Object(r.d)("rp-skypeInTabs")&&1==Object(i.b)()}},1413:function(e){e.exports={a:"wsb"}},1414:function(e){e.exports={a:"tsb"}},1492:function(e,t,n){"use strict";n.d(t,"b",function(){return c});var r=n(8),i=n(1),a={signInState:0,presences:new r.ObservableMap({}),processingManualSignIn:!1,isRetrySignInAllowed:!0},c=Object(i.createStore)("presenceStore",a),u=c();t.a=u},1899:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1492);function i(){return 3==r.a.signInState}},1900:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(1922),i=n(1492),a=n(17),c=n(5);function u(e){if(Object(c.d)("fwk-skypeBusinessV2")&&e){var t=Object(r.b)(e),n=function(e){switch(e){case"Offline":return a.b.offline;case"Away":case"BeRightBack":return a.b.away;case"Busy":case"IdleBusy":return a.b.busy;case"DoNotDisturb":return a.b.dnd;case"Online":case"IdleOnline":return a.b.online;case"None":return a.b.none}}(i.a.presences.get(t));return n||void 0}}},1922:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var r="sip:";function i(e){if(!e)return null;var t=e.toLowerCase();return 0!=t.indexOf(r)&&(t=r+t),t}},1968:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),i={chats:[],isChatCalloutShown:!1,isMoreChatMenuShown:!1,participantCache:new(n(8).ObservableMap),chatProvider:0},a=Object(r.createStore)("ucmaChatStore",i);a()},2432:function(e,t,n){"use strict";n.r(t);var r=n(2),i=n(168),a=n(144),c=n(51),u=Object(c.a)(function(e){return r.createElement(i.a,{title:"Feature Flags",key:"featureflags",icons:{iconName:"Flag"},ariaLabel:"featureflags charm",behavior:{paneComponent:a.e,charm:1}})}),o=n(0),s=n(1413),f=n(8606),d=n(1414),l=n(4),h=n(20),b=n(5),p=n(1183),m=n(4966),C=n(1968),v=n(1492),O=n(70),w=n(771),k="https://teams.microsoft.com",j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setCharmDiv=function(e){t.charmDiv=O.findDOMNode(e)},t.onDismiss=function(){w.g.importAndExecute(!1)},t.onUcmaDismiss=function(){p.e.importAndExecute(!1)},t.getBadgeCount=function(){return w.f.tryImportForRender()?w.h.unreadConversationCount:null},t.onClickUcmaCharm=function(){p.e.importAndExecute(!Object(C.a)().isChatCalloutShown)},t.onClickNonUcmaCharm=function(){var e=w.h.isGlimpseOpen;w.g.importAndExecute(!e)},t.onClickTeams=function(){window.open(k)},t}return o.__extends(t,e),t.prototype.render=function(){if(!Object(b.d)("fwk-skypeBusiness"))return w.h.isSwcInitialized&&this.renderCharm(w.h.isGlimpseOpen,"SkypeLogo",Object(l.a)(s.a),Object(l.a)(f.a),w.h.isGlimpseOpen&&this.renderCharmContent(),this.onClickNonUcmaCharm,this.getBadgeCount);var e=Object(C.a)(),t=!Object(b.d)("fwk-skypeBusinessV2");switch(t?5:e.chatProvider){case 3:case 4:return!Object(b.d)("fwk-skypeSuite")&&3==v.a.signInState&&this.renderCharm(e.isChatCalloutShown,"SkypeForBusinessLogo",Object(l.a)(d.a),Object(l.a)(f.b),e.isChatCalloutShown&&r.createElement(p.a,{onDismiss:this.onUcmaDismiss,target:this.charmDiv}),this.onClickUcmaCharm,m.c);case 5:return!Object(b.d)("fwk-skypeSuite")&&this.renderCharm(t&&w.h.isGlimpseOpen,"OfficeChat",Object(l.a)(d.a),Object(l.a)(f.b),t&&w.h.isGlimpseOpen&&this.renderCharmContent(),t?this.onClickNonUcmaCharm:this.onClickTeams,this.getBadgeCount);default:return null}},t.prototype.renderCharm=function(e,t,n,a,c,u,o){return r.createElement(i.a,{ref:this.setCharmDiv,key:"skype",icons:{iconName:t,hoverIconName:t},title:n,ariaLabel:n,ariaLabelWithBadgeCount:a,behavior:{isActive:e,content:c,onClick:u},getBadgeCount:o})},t.prototype.renderCharmContent=function(){return r.createElement(w.a,{onDismiss:this.onDismiss,target:this.charmDiv})},t=o.__decorate([h.observer],t)}(r.Component),y=n(761),g=n(4720),S=function(){return o.__spread(Object(g.a)().items.values()).filter(function(e){return!e.isSeen}).length},B=n(81),I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onActivityFeedCharmClick=function(){Object(b.d)("fwk-o365shellheader")||Object(B.c)(10)},t}return o.__extends(t,e),t.prototype.render=function(){return r.createElement("div",null,r.createElement(i.a,{key:"activityfeed",icons:{iconName:"Ringer"},ariaLabel:Object(l.a)(y.a),title:Object(l.a)(y.a),behavior:{paneComponent:Object(b.d)("fwk-o365shellheader")?null:a.a,charm:10,onClick:this.onActivityFeedCharmClick},getBadgeCount:S}))},t=o.__decorate([h.observer],t)}(r.Component);n.d(t,"FeatureFlagsCharm",function(){return u}),n.d(t,"SkypeCharm",function(){return j}),n.d(t,"ActivityFeedCharm",function(){return I})},4720:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),i=n(8),a=Object(r.createStore)("activityFeedStore",{firstFetchComplete:!1,isActivityFeedOpen:!1,items:new i.ObservableMap})},4966:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"a",function(){return o});var r=n(1968);function i(){return Object(r.a)().chats.filter(function(e){return 1==e.state||2==e.state})}function a(){return Object(r.a)().chats.filter(function(e){return 0==e.state})}function c(){return Object(r.a)().chats.filter(function(e){return 0==e.state||u(e)>0}).length}function u(e){return e.lastMessageSequence-e.lastReadMessageSequence}function o(){return Object(r.a)().chats.filter(function(e){return 4==e.state})}},761:function(e){e.exports={a:"vrb"}},771:function(e,t,n){"use strict";var r=n(1359),i=n(3),a=n(24),c=n(924),u=n(5),o=n(1385);n.d(t,"a",function(){return f}),n.d(t,"g",function(){return d}),n.d(t,"f",function(){return l}),n.d(t,"e",function(){return p}),n.d(t,"d",function(){return m}),n.d(t,"h",function(){return r.a}),n.d(t,"b",function(){return c.a}),n.d(t,"c",function(){return o.a});var s=new i.c(function(){return n.e(370).then(n.bind(null,11701))}),f=Object(i.d)(s,function(e){return e.SkypeGlimpse}),d=new i.a(s,function(e){return e.updateIsGlimpseOpen}),l=new i.b(s,function(e){return e.shouldShowUnreadConversationCount}),h=new i.a(s,function(e){return e.beginSkypeInitialization}),b=new i.a(s,function(e){return e.createOnSwcReadyEvent}),p=new i.a(s,function(e){return e.onNotificationReceived}),m=new i.a(s,function(e){return e.onHideNotificationReceived});Object(a.c)(function(){Object(u.d)("fwk-partner-code-off")||Object(u.d)("fwk-skypeSuite")&&Object(u.d)("fwk-o365shellheader")||!Object(u.d)("fwk-skypeConsumer")||h.importAndExecute(),b.importAndExecute()})},8606:function(e){e.exports={b:"usb",a:"vsb"}},924:function(e,t,n){"use strict";var r=n(1),i=Object(r.actionCreator)("ADD_CHAT_TAB",function(e){return{chatConversationId:e}});t.a=i}},0,[3,19,29,67,307,5,487,59,239,4,371,97,370]]);
//# sourceMappingURL=owa.HeaderCharms.js.map
self.scriptsLoaded['owa.HeaderCharms.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.HeaderCharms.js'] = (new Date()).getTime();