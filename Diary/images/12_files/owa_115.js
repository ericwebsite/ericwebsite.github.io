self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentFilePicker.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[101],{8130:function(e,t,r){"use strict";r.r(t);var n=r(0),i=r(4146),o=r(1586);function a(e,t,r,n){c(e,Object(o.e)(t),n,r)}function c(e,t,r,n,i){void 0===r&&(r=!1),void 0===n&&(n=!1),void 0===i&&(i=null),e({files:t,shouldShare:r,isInline:n,dataProviderType:i})}function u(e,t,r,n){if(r===i.f.LocalComputerFiles)a(e,t,n===i.a.Insert,n===i.a.Share);else if(r===i.f.ProviderFiles){var u=t;n!==i.a.AttachAndShare?function(e,t,r){var n=t.length>0?t[0].model.ProviderType:null,i=null;if(n&&10===n){var a=[],u=[];t.forEach(function(e){a.push(e.model.Subject),u.push(e.model.Id)}),i=Object(o.g)(a,u)}else i=t.map(function(e){return Object(o.d)(e.model)});c(e,i,r,!1,n)}(e,u,n===i.a.Share):function(e,t){var r=t.length>0?t[0].model.ProviderType:null,n=t.filter(function(e){return null!==e.location}),i=t.filter(function(e){return null===e.location});n.length>0&&c(e,n.map(function(e){return Object(o.d)(e.model)}),!0,!1,r),i.length>0&&c(e,i.map(function(e){return Object(o.c)(e.model)}),!1,!1,r)}(e,u)}}var l=r(9),s=r(56),f=1,h=2,d=3;function p(e){switch(e.ViewStateConfiguration.AttachmentsFilePickerViewTypeForMouse){case f:return i.b.List;case h:return i.b.Tile;default:return Object(s.a)()?i.b.Tile:i.b.List}}var g=r(98);function S(e){switch(e){case i.b.List:return f;case i.b.Tile:return h;case i.b.Groups:return d;default:return Object(g.a)(e)}}var F={AFPChangePreferredViewType:{name:"AFPChangePreferredViewType",customData:function(e,t){return[S(t)]}},AFPSetUserPreferredAction:{name:"AFPSetUserPrefferdAction",customData:function(e,t){return[t]}},AFPSetUserPreferredActionGroups:{name:"AFPSetUserPreferredActionGroups",customData:function(e,t){return[t]}}},v=r(26),A=r(120),m=r.n(A),P=r(311),w=r.n(P),b=r(314),y=r.n(b),C=r(315),O=r.n(C),V=r(139),T=r.n(V),j=r(91),k=r.n(j),I=r(312),_=r.n(I),G=r(29),U="root",D="OWA.ViewStateConfiguration";function E(e,t,r){var n=w()({UserConfigurationName:_()({Name:e,BaseFolderId:m()({Id:U})}),Dictionary:[T()({DictionaryKey:k()(t),DictionaryValue:k()(r)})]});return y()({Header:Object(G.getJsonRequestHeader)(),Body:O()({UserConfiguration:n})}).then(function(e){return e.Body.ResponseMessages.Items[0]})}var L=Object(v.b)("setUserPreferredViewType",F.AFPChangePreferredViewType)(function(e,t){e.ViewStateConfiguration.AttachmentsFilePickerViewTypeForMouse=S(t),E(D,{Type:"String",Value:["AttachmentsFilePickerViewTypeForMouse"]},{Type:"Integer32",Value:[""+e.ViewStateConfiguration.AttachmentsFilePickerViewTypeForMouse]})}),M=Object(v.b)("setPreferredActionForCloudFile",F.AFPSetUserPreferredAction)(function(e,t){e.ViewStateConfiguration.AttachOrShareCloudFiles=t,E(D,{Type:"String",Value:["AttachOrShareCloudFiles"]},{Type:"Integer32",Value:[""+e.ViewStateConfiguration.AttachOrShareCloudFiles]})}),B=Object(v.b)("setPreferredActionForGroupFile",F.AFPSetUserPreferredActionGroups)(function(e,t){e.ViewStateConfiguration.AttachOrShareGroupsFiles=t,E(D,{Type:"String",Value:["AttachOrShareGroupsFiles"]},{Type:"Integer32",Value:[""+e.ViewStateConfiguration.AttachOrShareGroupsFiles]})});function H(){var e=Object(l.a)();return{preferredViewType:{value:p(e),valueSetter:function(t){L(e,t)}},attachOrShareCloudFiles:{value:e.ViewStateConfiguration.AttachOrShareCloudFiles,valueSetter:function(t){M(e,t)}},attachOrShareGroupsFiles:{value:e.ViewStateConfiguration.AttachOrShareGroupsFiles,valueSetter:function(t){B(e,t)}}}}var N=r(12);function R(e,t,r,o,a){return n.__awaiter(this,void 0,void 0,function(){var c,l;return n.__generator(this,function(n){switch(n.label){case 0:return[4,i.i.import()];case 1:c=n.sent(),l=H();try{if(!t||0==t.length)throw new Error("files length cannot be 0.");return[2,c(t,a,r,t[0].type===i.c.Group,t.length>1,o,l).then(function(r){u(e,t,o,r)}).catch(function(){})]}catch(e){N.c.error("Error creating the action panel. Attaching or sharing files might not work! "+e)}return[2]}})})}function $(e,t){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,i.j.import()];case 1:r=n.sent(),t.userConfiguration||(t.userConfiguration=H());try{return[2,r(t).then(function(t){u(e,t.files,t.source,t.action)}).catch(function(){})]}catch(e){N.c.error("Error creating the file picker. Attaching or sharing files might not work! "+e)}return[2]}})})}var q=r(20),x=r(4508),z=r(2),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onFilesSelected=function(e){var r=t.props,n=r.action;a(r.createAttachmentHandler,e,n===x.b.Insert,n===x.b.Share)},t}return n.__extends(t,e),t.prototype.render=function(){var e=this;return z.createElement(i.e,{ref:function(t){return e.localComputerFilePicker=t},onFilesSelected:this.onFilesSelected,fileSelectionFilter:this.props.fileSelectionFilter})},t.prototype.click=function(){this.localComputerFilePicker.getInnerComponent().click()},t=n.__decorate([q.observer],t)}(z.Component),K=r(18),W=r(494);function Q(e){for(var t=e.files,r=e.shouldShare,n=e.isInline,i=e.dataProviderType,o=[],a=0;t[a];)o=o.concat(t[a].size),a++;var c=function(e){for(var t=[],r=0;e[r];)t=t.concat(Object(W.a)(e[r].name)),r++;return t}(t);Object(K.o)("AFPAttachOrShare",[r,n,o.join(","),t.length,i,c.join(","),!1])}r.d(t,"attachmentActionsPanel",function(){return R}),r.d(t,"attachmentFilePicker",function(){return $}),r.d(t,"AttachmentLocalComputerFilePicker",function(){return J}),r.d(t,"logAttachOrShareDatapoint",function(){return Q})}},0,[0,1,2,6,200,9,11,18,198,463,87,464,98]]);
//# sourceMappingURL=owa.AttachmentFilePicker.js.map
self.scriptsLoaded['owa.AttachmentFilePicker.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentFilePicker.js'] = (new Date()).getTime();