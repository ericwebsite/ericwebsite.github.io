self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.NotificationBar.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[300],{2180:function(t,e,a){"use strict";a.r(e);var i=a(1),r=a(8),o={notificationsMap:new r.ObservableMap,notificationStack:[],notificationBarViewState:{isHovered:!1,autoDismissTimerCompleted:!1}},n=Object(i.createStore)("NotificationBarStore",o)(),c=a(12),l=Object(i.mutatorAction)("removeNotification",function(t){var e=n.notificationStack.indexOf(t);if(e<0)return c.c.error("notification id cannot be found in removeNotification"),void n.notificationsMap.delete(t);n.notificationStack.splice(e,1),n.notificationsMap.delete(t)}),s={};function d(t){return s[t]}var f=Object(i.action)("notificationAutoDismissTimerCompleted"),h=Object(i.action)("notificationMouseEnter"),u=Object(i.action)("notificationMouseLeave",function(t){return{notificationId:t}}),m=Object(i.action)("resetNotificationViewState"),b=Object(i.action)("setNotificationIsHovered",function(t){return{isHovered:t}}),k=a(1110),p=1e3,x=null;function v(t){clearTimeout(x),function(t){delete s[t]}(t),l(t),m()}Object(i.orchestrator)(u,function(t){if(n.notificationBarViewState.autoDismissTimerCompleted){var e=d(t.notificationId);v(t.notificationId),e&&e(k.a.MouseLeaveAfterTimerCompleted)}b(!1)}),Object(i.mutator)(f,function(t){n.notificationBarViewState.autoDismissTimerCompleted=!0}),Object(i.mutator)(h,function(t){n.notificationBarViewState.isHovered=!0}),Object(i.mutator)(b,function(t){n.notificationBarViewState.isHovered=t.isHovered}),Object(i.mutator)(m,function(t){n.notificationBarViewState.isHovered=!1,n.notificationBarViewState.autoDismissTimerCompleted=!1});var g=a(0),y=a(8235),B=a(4),S=a(2),T=a(109),w=a(6516),A={root:{backgroundColor:Object(T.g)().neutralSecondary,marginRight:"8px",borderStyle:"solid",borderWidth:"1px",borderColor:Object(T.g)().white},rootHovered:{backgroundColor:Object(T.g)().neutralPrimaryAlt},rootPressed:{backgroundColor:Object(T.g)().neutralDark},textContainer:{overflow:"hidden"},label:w.actionButtonText},C={root:{marginRight:"8px",color:Object(T.g)().white},rootHovered:{color:Object(T.g)().white,backgroundColor:"transparent"},rootPressed:{color:Object(T.g)().neutralDark,backgroundColor:"transparent"}},O=a(14),E=a(4388),D=a(2515),I=a(1452),N=a(1166),j=a(209),_=a(20),H=a(1709),L=a(227),M=a(6516),W=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderSpinnerOrIcon=function(){if(e.props.notification.shouldShowSpinner)return S.createElement(H.a,{className:M.spinner,type:L.b.normal});if(e.props.notification.icon){var t={root:M.iconRoot};return S.createElement(j.a,{styles:t,iconName:e.props.notification.icon})}return S.createElement("div",{className:M.iconSpace})},e.onPrimaryButtonClick=function(t){e.closeAndExecuteCallback(k.a.PrimaryActionClicked)},e.onSecondaryButtonClick=function(t){e.closeAndExecuteCallback(k.a.SecondaryActionClicked)},e.onDismissClick=function(t){e.closeAndExecuteCallback(k.a.DismissClicked)},e.onMouseEnter=function(t){h()},e.onMouseLeave=function(t){u(e.props.notification.id)},e}return g.__extends(e,t),e.prototype.render=function(){var t=this.props,e=t.notification,a=g.__rest(t,["notification"]);return S.createElement(E.CSSTransition,g.__assign({},a,{timeout:167,classNames:{enter:O.AnimationClassNames.slideUpIn20,exit:O.AnimationClassNames.slideDownOut20}}),S.createElement("div",{className:M.positioningContainer},S.createElement("div",{className:M.notificationBarContainer,style:{minWidth:e.minWidth+"px",maxWidth:e.maxWidth+"px"},onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},S.createElement("div",{className:M.leftItems},this.renderSpinnerOrIcon(),S.createElement("span",{className:M.contentText},e.contentText)),S.createElement("div",{className:M.rightItems},e.primaryActionText&&S.createElement(D.a,{onClick:this.onPrimaryButtonClick,text:e.primaryActionText,title:e.primaryActionText,ariaLabel:e.primaryActionText,styles:A}),e.primaryActionText&&e.secondaryActionText&&S.createElement(I.a,{onClick:this.onSecondaryButtonClick,text:e.secondaryActionText,title:e.secondaryActionText,ariaLabel:e.secondaryActionText,styles:A}),e.shouldShowDismissIcon&&S.createElement(N.a,{onClick:this.onDismissClick,styles:C,iconProps:{iconName:"Cancel"}})))))},e.prototype.closeAndExecuteCallback=function(t){var e=d(this.props.notification.id);v(this.props.notification.id),e&&e(t)},e=g.__decorate([_.observer],e)}(S.Component),V=a(136),F=a(6516),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return g.__extends(e,t),e.prototype.render=function(){var t;if(n.notificationStack.length>0){var e=n.notificationStack[n.notificationStack.length-1],a=n.notificationsMap.get(e);if(!!(!this.props.hostId&&!a.hostId)||this.props.hostId===a.hostId){t=a;var i=V.k?Object(B.a)(y.c):Object(B.a)(y.b);this.ariaNotifString=null!==t.primaryActionText?Object(B.b)(Object(B.a)(y.a),t.contentText,i,t.primaryActionText):t.contentText}}return S.createElement(E.TransitionGroup,{className:F.notificationBarHostContainer},t&&S.createElement(W,{notification:Object(r.toJS)(t),key:t.id}),S.createElement("div",{className:"screenReaderOnly",role:"alert","aria-relevant":"additions",id:"notificationBarText"}))},e.prototype.componentDidUpdate=function(){n.notificationStack.length>0&&this.addAccessibilityNotifBarDiv()},e.prototype.addAccessibilityNotifBarDiv=function(){var t=document.getElementById("notificationBarText");t.firstChild&&t.removeChild(t.firstChild);var e=document.createElement("div");e.innerText=this.ariaNotifString,document.getElementById("notificationBarText").appendChild(e)},e=g.__decorate([_.observer],e)}(S.Component),q=Object(i.mutatorAction)("pushNotification",function(t,e){n.notificationsMap.has(t)?c.c.error("cannot add notification with the same id.  Please dismiss the notification before adding it again."):(n.notificationsMap.set(t,e),n.notificationStack.push(t))}),X=a(7),Q=Object(X.select)({store:function(){return n}})(function(t,e,a,i){var r=void 0===a?{}:a,o=r.icon,l=r.primaryActionText,h=r.secondaryActionText,u=r.minWidth,m=void 0===u?400:u,b=r.maxWidth,g=void 0===b?400:b,y=r.shouldShowDismissIcon,B=void 0===y||y,S=r.shouldShowSpinner,T=void 0!==S&&S,w=r.allowAutoDismiss,A=void 0===w||w,C=r.autoDismissInSeconds,O=void 0===C?7:C,E=(r.isHovered,r.notificationCallback),D=r.hostId,I=void 0===D?null:D;if(e="function"==typeof e?e():e)if(!l&&!h||E){var N={id:t,contentText:e,icon:o,primaryActionText:l,secondaryActionText:h,minWidth:m,maxWidth:g,shouldShowDismissIcon:B,shouldShowSpinner:T,allowAutoDismiss:A,autoDismissInSeconds:O,hostId:I};if(i.store.notificationStack.length>0){var j=i.store.notificationStack[i.store.notificationStack.length-1];i.store.notificationsMap.get(j).allowAutoDismiss&&v(j)}!function(t,e){if(void 0!==s[t])throw new Error("Cannot over write an existing notification callback.");s[t]=e}(t,E),q(t,N),A&&function(t,e){x=setTimeout(function(){if(f(),!n.notificationBarViewState.isHovered){var e=d(t);v(t),e&&e(k.a.AutoDismissed)}},e*p)}(t,O)}else c.c.error("notification callback must be defined with a primary or secondary action");else c.c.error("contentText is required to show the notification")});a.d(e,"NotificationBarHost",function(){return P}),a.d(e,"showNotification",function(){return Q}),a.d(e,"dismissNotification",function(){return v})},6516:function(t,e,a){var i=a(8236),r=a(44);"string"==typeof i&&(i=[[t.i,i]]);for(var o=0;o<i.length;o++)r.loadStyles(i[o][1],!1);i.locals&&(t.exports=i.locals)},8235:function(t){t.exports={c:"cob",b:"dob",a:"eob"}},8236:function(t,e,a){(e=t.exports=a(43)(!1)).push([t.i,'._3xqEuTlsJbTQdiBbqhDlEy{pointer-events:none;position:absolute;bottom:0;z-index:4}html[dir] ._3xqEuTlsJbTQdiBbqhDlEy{background-color:"[theme:white, default:#ffffff]"}html[dir=ltr] ._3xqEuTlsJbTQdiBbqhDlEy,html[dir=rtl] ._3xqEuTlsJbTQdiBbqhDlEy{left:0;right:0}._394rO9_XIBrDE0VaIH3AWj{width:100%;position:absolute;bottom:0;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}._24raGxVN-NYNI6ltdpiov2,._394rO9_XIBrDE0VaIH3AWj{display:-webkit-box;display:-ms-flexbox;display:flex}._24raGxVN-NYNI6ltdpiov2{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);height:48px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;pointer-events:auto}html[dir] ._24raGxVN-NYNI6ltdpiov2{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white);-webkit-box-shadow:0 1px 12px 0 "[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]";box-shadow:0 1px 12px 0 "[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]";background-color:"[theme:neutralSecondary, default:#666666]";border-radius:4px 4px 0 0}html[dir=ltr] .HFhW96xMp5v9DXf1mD-gE{margin-left:24px;margin-right:14px}html[dir=rtl] .HFhW96xMp5v9DXf1mD-gE{margin-right:24px;margin-left:14px}._2gL8VTsxpsj9xOhfHX0ARq{color:"[theme:white, default:#ffffff]";font-size:15px}html[dir=ltr] ._2gL8VTsxpsj9xOhfHX0ARq{margin-left:24px;margin-right:16px}html[dir=rtl] ._2gL8VTsxpsj9xOhfHX0ARq{margin-right:24px;margin-left:16px}html[dir=ltr] ._21g8jkqFMZX18DGFuOEVYw{margin-left:48px}html[dir=rtl] ._21g8jkqFMZX18DGFuOEVYw{margin-right:48px}._1HFU5ZOFiIWaCX1sxSRyO1{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow:hidden}html[dir=ltr] ._1HFU5ZOFiIWaCX1sxSRyO1{margin-right:8px}html[dir=rtl] ._1HFU5ZOFiIWaCX1sxSRyO1{margin-left:8px}._3Zb1dKENKlm20nLBci9L3G{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto;max-width:66%}.e8QWIPW0726cSzB7kykNB{font-size:14px;font-weight:400}.chQAugHvoCEfpy0BOor02,.e8QWIPW0726cSzB7kykNB{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:"[theme:white, default:#ffffff]"}.chQAugHvoCEfpy0BOor02{height:32px;line-height:32px}',""]),e.locals={notificationBarHostContainer:"_3xqEuTlsJbTQdiBbqhDlEy",positioningContainer:"_394rO9_XIBrDE0VaIH3AWj",notificationBarContainer:"_24raGxVN-NYNI6ltdpiov2",spinner:"HFhW96xMp5v9DXf1mD-gE",iconRoot:"_2gL8VTsxpsj9xOhfHX0ARq",iconSpace:"_21g8jkqFMZX18DGFuOEVYw",leftItems:"_1HFU5ZOFiIWaCX1sxSRyO1",rightItems:"_3Zb1dKENKlm20nLBci9L3G",contentText:"e8QWIPW0726cSzB7kykNB",actionButtonText:"chQAugHvoCEfpy0BOor02"}}}]);
//# sourceMappingURL=owa.NotificationBar.js.map
self.scriptsLoaded['owa.NotificationBar.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.NotificationBar.js'] = (new Date()).getTime();