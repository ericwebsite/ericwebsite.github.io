self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SharingData.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[367],{2142:function(e,n,i){"use strict";var t;i.d(n,"a",function(){return t}),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLMembers=3]="SucceededWithDLMembers",e[e.SucceededWithoutDLMembers=4]="SucceededWithoutDLMembers"}(t||(t={}))},3713:function(e,n,i){"use strict";var t;i.d(n,"a",function(){return t}),function(e){e[e.None=0]="None",e[e.To=1]="To",e[e.Cc=2]="Cc",e[e.Bcc=3]="Bcc"}(t||(t={}))},4823:function(e,n,i){"use strict";i.d(n,"c",function(){return o}),i.d(n,"d",function(){return c});var t=i(3),r=i(3713);i.d(n,"b",function(){return r.a});var a=i(2142);i.d(n,"a",function(){return a.a});var s=new t.c(function(){return i.e(338).then(i.bind(null,6485))}),o=new t.a(s,function(e){return e.setMembersToRecipientViewState}),c=new t.a(s,function(e){return e.setRecipientExpansionStatus})},4897:function(e,n,i){"use strict";i.r(n);var t=i(0),r=i(75),a="ows/api/beta/sharinglink/info";function s(e,n){return void 0===n&&(n=!1),t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(i){switch(i.label){case 0:return[4,Object(r.d)(a,{url:e},void 0,n)];case 1:return[2,i.sent()]}})})}var o,c,u=i(98),l=i(5),f=i(252),d=i(7819),g=i.n(d),h=i(7164),m=i.n(h),p=i(9964),b=i.n(p),S=i(12);function O(e){return Object(l.d)("doc-attachment-sharingLinkInfoOWSPrimeService")?function(e){return t.__awaiter(this,void 0,void 0,function(){var n,i,r,a,u,l,d,g,h,p,b,O;return t.__generator(this,function(L){switch(L.label){case 0:return[4,s(e,!0)];case 1:return n=L.sent(),Object(f.a)(n.status)?(a=(r=JSON).parse,[4,n.text()]):[3,3];case 2:if(function(e){return e.providerType===o.OneDrivePro}(i=a.apply(r,[L.sent()])))return u=t.__read(i.sharingLinks.filter(function(e){return e.type===c.AnonymousEdit}),1),l=u[0],d=t.__read(i.sharingLinks.filter(function(e){return e.type===c.AnonymousView}),1),g=d[0],h=t.__read(i.sharingLinks.filter(function(e){return e.type===c.OrganizationEdit}),1),p=h[0],b=t.__read(i.sharingLinks.filter(function(e){return e.type===c.OrganizationView}),1),O=b[0],[2,m()({AccessRequestMode:i.accessRequestMode,AnonymousEditLink:l?l.url:void 0,AnonymousViewLink:g?g.url:void 0,CanCreateAnonymousEditLink:i.canCreateAnonymousEditLink,CanCreateAnonymousViewLink:i.canCreateAnonymousViewLink,CanCreateOrganizationEditLink:i.canCreateOrganizationEditLink,CanCreateOrganizationViewLink:i.canCreateOrganizationViewLink,CanShareExternally:i.canShareExternally,CanShareInternally:i.canShareInternally,CanonicalUrl:i.canonicalUrl,ExpirationDate:i.expirationTime,FileName:i.name,IsAnonymousEditLinkAvailable:!!l,IsAnonymousViewLinkAvailable:!!g,IsOrganizationEditLinkAvailable:!!p,IsOrganizationViewLinkAvailable:!!O,MimeType:void 0,OrganizationEditLink:p?p.url:void 0,OrganizationViewLink:O?O.url:void 0,ResultCode:0,SharingLinkKind:v(i.linkType)})];throw new Error("Invalid response from OWS` from sharing link info");case 3:return 404===n.status?[2,m()({ResultCode:4})]:400===n.status?[2,m()({ResultCode:24})]:(S.c.warn("Invalid response for OWS' get share info. Status code: "+n.status),[2,m()({ResultCode:1})]);case 4:return[2]}})})}(e):b()(function(e){return g()({attachmentUrl:e})}(e))}function v(e){switch(e){case c.None:return 0;case c.View:case c.Edit:return 1;case c.AnonymousView:return 4;case c.AnonymousEdit:return 5;case c.OrganizationView:return 2;case c.OrganizationEdit:return 3;default:return Object(u.a)(e)}}!function(e){e.OneDrivePro="OneDrivePro"}(o||(o={})),function(e){e.None="None",e.View="View",e.Edit="Edit",e.AnonymousView="AnonymousView",e.AnonymousEdit="AnonymousEdit",e.OrganizationView="OrganizationView",e.OrganizationEdit="OrganizationEdit"}(c||(c={}));var L=i(4),j=i(9965),x=i(3636);var k=i(6008),I=i(5367),E=i(3858);function y(e,n,i){if(1!==e.length||null===i)return null;switch(n){case x.a.noPermissionToShare:case x.a.noPermissionToShareExternally:case x.a.externalRecipientCSL:case x.a.sharingWithLargeDL:return e[0].supportsDownsell?[i(e[0].id)]:null;case x.a.getSharingInfoFailed:case x.a.noPermissionSet:return null;case x.a.linkHasExpired:case x.a.linkWillExpire:return function(e){return[{text:Object(L.a)(I.a),action:function(){Object(E.a)(e.id)}},{text:Object(L.a)(k.a),action:function(){e.sharingTipsIgnored.push(x.a.linkHasExpired),e.sharingTipsIgnored.push(x.a.linkWillExpire)}}]}(e[0]);default:return Object(u.a)(n)}}var P=i(520);function w(e,n){return n.filter(function(e){return e.externalMemberCount>0}).length>0&&e.sharingInfo&&!e.sharingInfo.canShareExternally&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}function C(e){return e.sharingInfo&&e.sharingInfo.getSharingInfoSucceeded&&!e.sharingInfo.canShareInternally&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}var F=i(3726),T=i(4823),_=i(3825);function A(e,n){return D(e.sharingRecipientsInfo,n)?0===e.currentPermissionLevel&&!C(e):0===e.currentPermissionLevel&&e.sharingRecipientsInfo.recipientPermissionInfos.some(function(e){return!e.hasAccess&&e.getPermissionInfoStatus===_.a.Succeeded})}function D(e,n){return!Object(l.d)("doc-attachment-contextualSharingTips")||W(n)||V(n)||R(e)}function R(e){return e.recipientPermissionInfos.some(function(e){return e.getPermissionInfoStatus===_.a.Failed})}function W(e){return e.some(function(e){return e.totalMemberCount>F.b})}function V(e){return M(e).some(function(e){return e.recipient.expansionStatus===T.a.Failed||e.recipient.expansionStatus===T.a.SucceededWithDLMembers})}function M(e){return e.filter(function(e){return e.totalMemberCount>F.a&&e.totalMemberCount<=F.b})}function z(e,n){return W(n)&&e.sharingInfo&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}function N(e){return e.sharingInfo&&!e.sharingInfo.getSharingInfoSucceeded}function H(e,n){return n.filter(function(e){return e.externalMemberCount>0}).length>0&&(6===e.currentPermissionLevel||5===e.currentPermissionLevel)}var q=i(420),G=i(428);function U(e){return e&&e.sharingInfo&&!!e.sharingInfo.expirationDate&&Object(q.a)(e.sharingInfo.expirationDate,Object(G.a)())}var B=i(819);function $(e){return e&&e.sharingInfo&&!!e.sharingInfo.expirationDate&&Object(B.a)(e.sharingInfo.expirationDate,Object(G.a)())}var J=i(3857);var K=i(9966);var Q=function(e){return e?e.filter(function(e){return e.totalMemberCount>100}).map(function(e){return e.recipient.persona.EmailAddress.Name}).join(", "):""};function X(e,n){if(D(e,n))return Object(L.a)(K.l);var i=e.recipientPermissionInfos.filter(function(e){return!e.hasAccess&&e.getPermissionInfoStatus===_.a.Succeeded}),t=i.length,r=function(e){return e.map(function(e){return e.name?e.name:e.emailAddress}).join(", ")}(i);return 1===t?Object(L.b)(Object(L.a)(K.j),r,"{0}"):t<4?Object(L.b)(Object(L.a)(K.c),r,"{0}"):Object(L.a)(K.l)}function Y(e,n,i,t,r){if(!function(e){switch(e){case x.a.noPermissionToShare:case x.a.noPermissionToShareExternally:case x.a.externalRecipientCSL:case x.a.noPermissionSet:case x.a.sharingWithLargeDL:return!0;case x.a.getSharingInfoFailed:return Object(l.d)("doc-attachment-sharingInfoFailureTip");case x.a.linkWillExpire:case x.a.linkHasExpired:return Object(l.d)("doc-attachment-contextualSharingTips");default:return Object(u.a)(e)}}(n))return null;var a=function(e){switch(e){case x.a.noPermissionToShare:return C;case x.a.getSharingInfoFailed:return N;case x.a.linkHasExpired:return U;case x.a.linkWillExpire:return $;case x.a.externalRecipientCSL:return H;case x.a.noPermissionToShareExternally:return w;case x.a.noPermissionSet:return A;case x.a.sharingWithLargeDL:return z;default:return Object(u.a)(e)}}(n),s=e.filter(function(e){return a(e,i)});if(0===s.length)return null;var o=s.filter(function(e){return!Object(L.g)(e.name)}).map(function(e){return e.name}).join(", "),c=function(e,n,i){switch(e){case x.a.noPermissionToShare:return{singleFile:Object(L.a)(K.f),multipleFiles:Object(L.a)(K.f)};case x.a.getSharingInfoFailed:return{singleFile:Object(L.a)(K.g),multipleFiles:Object(L.a)(K.g)};case x.a.linkHasExpired:return{singleFile:Object(L.a)(K.h),multipleFiles:Object(L.a)(K.a)};case x.a.linkWillExpire:return{singleFile:Object(L.a)(K.i),multipleFiles:Object(L.a)(K.b)};case x.a.noPermissionToShareExternally:return{singleFile:Object(L.a)(K.e),multipleFiles:Object(L.a)(K.e)};case x.a.externalRecipientCSL:return{singleFile:Object(L.a)(K.k),multipleFiles:Object(L.a)(K.k)};case x.a.noPermissionSet:return{singleFile:X(i[0].sharingRecipientsInfo,n),multipleFiles:Object(L.a)(K.l)};case x.a.sharingWithLargeDL:var t=Q(n);return{singleFile:Object(L.b)(Object(L.a)(K.d),t,"{0}","{1}"),multipleFiles:Object(L.b)(Object(L.a)(K.d),t,"{0}","{1}")};default:return Object(u.a)(e)}}(n,i,s),f=s.length>1?c.multipleFiles:c.singleFile;o&&0!==o.length||!f||0===f.length||S.c.error("file names should not be null or empty if the infobarStringTemplate is not");var d,g=y(s,n,r),h=function(e){switch(e){case x.a.noPermissionToShare:case x.a.noPermissionToShareExternally:return[J.a.ignore,J.a.attachAsACopy];case x.a.getSharingInfoFailed:return[J.a.ignore];case x.a.externalRecipientCSL:case x.a.noPermissionSet:case x.a.sharingWithLargeDL:return[J.a.ignore,J.a.changePermission,J.a.attachAsACopy];case x.a.linkWillExpire:case x.a.linkHasExpired:return[J.a.ignore,J.a.refreshExpiration];default:return Object(u.a)(e)}}(n);if(t||null!==g&&0!==g.length)d=Object(L.b)(f,o);else{var m="",p=function(e){switch(e){case x.a.noPermissionToShare:case x.a.noPermissionToShareExternally:case x.a.externalRecipientCSL:return{singleFile:Object(L.a)(j.b),multipleFiles:Object(L.a)(j.a)};case x.a.getSharingInfoFailed:case x.a.linkHasExpired:case x.a.linkWillExpire:case x.a.noPermissionSet:case x.a.sharingWithLargeDL:return null;default:return Object(u.a)(e)}}(n);null!==p&&(m=s.length>1?p.multipleFiles:p.singleFile),d=Object(L.b)(f,o,m)}return{id:n,sharingTipString:d,actions:g,sharingTipActions:h,messageRank:function(e){switch(e){case x.a.noPermissionToShare:case x.a.noPermissionToShareExternally:case x.a.sharingWithLargeDL:case x.a.linkHasExpired:case x.a.externalRecipientCSL:case x.a.noPermissionSet:return P.b.Error;case x.a.linkWillExpire:case x.a.getSharingInfoFailed:return P.b.Info;default:return Object(u.a)(e)}}(n)}}function Z(e,n,i,t,r){var a=Y(e,n,i,t,r);if(null===a)return null;var s={key:n,source:P.c.Compose,rank:a.messageRank,messageParts:[a.sharingTipString]};return null!==a.actions&&a.actions.map(function(e){s.messageParts.push(e)}),function(e){return s}}var ee=i(18),ne=new Map;function ie(e){var n=[];ne.has(e)&&(n=ne.get(e)),te(n,[],e,"deleteLink")}function te(e,n,i,t){void 0===t&&(t=null);var r=n.filter(function(n){return-1===e.indexOf(n)}),a=e.filter(function(e){return-1===n.indexOf(e)}),s=t||"UnknownActionSource";r.unshift(s),a.unshift(s),r.length>1&&Object(ee.o)("LinkSharingTipsAdded",r,{cosmosOnlyData:i}),a.length>1&&Object(ee.o)("LinkSharingTipsRemoved",a,{cosmosOnlyData:i})}function re(e,n){var i,t,r,a=Object(x.b)().filter(function(n){return-1===e.sharingTipsIgnored.indexOf(n)}).map(function(i){return Y([e],i,n,!0)}).filter(function(e){return null!==e});if("string"==typeof e.id){var s=a.map(function(e){return e.id});i=e.id,t=s,r=[],ne.has(i)&&(r=ne.get(i)),te(r,t,i),ne.set(i,t)}return a}i.d(n,"getSharingInformation",function(){return O}),i.d(n,"getInfoBarCreator",function(){return Z}),i.d(n,"getSharingIssuesForSharingData",function(){return re}),i.d(n,"hasGetRecipientPermissionFailed",function(){return R}),i.d(n,"hasLargeDLRecipient",function(){return W}),i.d(n,"hasSmallDLExpansionFailure",function(){return V}),i.d(n,"getSmallDLs",function(){return M}),i.d(n,"logSharingTipChangesForLinkRemoval",function(){return ie})},5367:function(e){e.exports={a:"sca"}},6008:function(e){e.exports={a:"rca"}},7164:function(e,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=i(0);n.default=function(e){return t.__assign({__type:"GetSharingInfoResponse:#Exchange"},e)}},7819:function(e,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=i(0);n.default=function(e){return t.__assign({__type:"GetSharingInfoRequest:#Exchange"},e)}},9964:function(e,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=i(59),r=i(7819);n.default=function(e,n){return void 0===e||e.__type||(e=r.default(e)),t.makeServiceRequest("GetSharingInformation",e,n)}},9965:function(e){e.exports={b:"kca",a:"lca"}},9966:function(e){e.exports={f:"_ba",g:"$ba",h:"aca",a:"bca",i:"cca",b:"dca",e:"eca",k:"fca",l:"gca",d:"hca",j:"ica",c:"jca"}}},0,[463,87,464,98]]);
//# sourceMappingURL=owa.SharingData.js.map
self.scriptsLoaded['owa.SharingData.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SharingData.js'] = (new Date()).getTime();