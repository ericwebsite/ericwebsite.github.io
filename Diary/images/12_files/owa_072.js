self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailSmartPill.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[289],{11025:function(e){e.exports={a:"c4b"}},11026:function(e){e.exports={a:"a4b",b:"b4b"}},11027:function(e){e.exports={l:"Q3b",f:"R3b",a:"S3b",b:"T3b",c:"U3b",d:"V3b",e:"W3b",g:"X3b",h:"Y3b",i:"Z3b",j:"_3b",k:"$3b"}},11028:function(e,t,n){var r=n(11029),a=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},11029:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,"html[dir] ._1BIi6rH1j5rnLh1OlF1NvI{padding-top:10px}html[dir=ltr] ._1BIi6rH1j5rnLh1OlF1NvI{margin-left:52px}html[dir=rtl] ._1BIi6rH1j5rnLh1OlF1NvI{margin-right:52px}",""]),t.locals={bar:"_1BIi6rH1j5rnLh1OlF1NvI"}},11659:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1),i=Object(a.action)("setSmartPillBlockVisibility",function(e,t){return{viewState:e,smartPillBlockVisible:t}}),o=Object(a.action)("setSmartPillFeedbackSubmitted",function(e,t){return{item:e,smartPillFeedbackSubmitted:t}}),u=n(12),c=n(5);function s(e){if(e){if("SmartDoc"===e.featureName)return!0;null==e.confidenceScore&&u.c.info("[isConfidenceScoreAcceptable] confidence score is null. Feature: "+e.featureName+" EntityId: "+e.logData.mainPayload.EID);var t=e.confidenceScore;if(t>0){if(Object(c.d)("mc-smartPillConfidenceLevel_LOW"))return!0;if(Object(c.d)("mc-smartPillConfidenceLevel_MID"))switch(e.featureName){case"SmartTime":case"SmartTask":return t>=70;default:return!0}else switch(e.featureName){case"SmartTime":case"SmartTask":return t>=90;default:return!0}}}return!1}function l(e){switch(e.logData.mainPayload.language){case"English":return!0;case"Spanish":return Object(c.d)("mc-smartReplySpanishMexico");default:return!1}}var d=n(908),f=n(902);function m(e){var t=e.featureName;if("SmartReply"===t)return Object(c.d)("mc-smartReply");if("SmartTime"===t)return Object(c.d)("mc-smartReplyWithCustomMeeting");if("SmartDoc"===t)return Object(c.d)("mc-smartReplyWithDoc");if("SmartTodo"===t||"SmartReminder"===t){var n=Object(f.a)()||Object(d.a)();return n||u.c.info("[isPillTypeEnabled] Disable Smart Todo - Todo/Time panel is unavailable."),Object(c.d)("mc-smartTask")&&n}return u.c.info("[isPillTypeEnabled] Unknown pill type: "+t),!1}var p={arbitratePills:function(e){var t=[],n=[];e.forEach(function(e){m(e)?t.push(e):(e.logData.mainPayload.renderStory|=1,n.push(e))});var r=Math.min(t.length,3),a=t.slice(r,e.length);return a.forEach(function(e){e.logData.mainPayload.renderStory|=2}),{pillsToShow:t.slice(0,r),pillsToHide:a.concat(n),arbitratorId:"SimpleArbitrator"}}},g=1,b=2,h=3;function v(e,t,n,r){var a=[];return e.forEach(function(e){n(e)?a.push(e):(e.logData.mainPayload.renderStory|=r,t.push(e))}),a}var S={arbitratePills:function(e){var t=[],n=[];if(e){var a=v(e,n,m,1),i=v(a,n,l,8),o=v(i,n,s,4);if(o.length>0){var u=function(e){if(e){var t=e.some(function(e){return"SmartTime"===e.featureName}),n=e.some(function(e){return"SmartReply"===e.featureName}),r=e.some(function(e){return"SmartDoc"===e.featureName}),a=e.some(function(e){return"SmartTodo"===e.featureName}),i=e.some(function(e){return"SmartReminder"===e.featureName});if(r)return{smartDoc:{numOfPills:h}};if(t&&n)return{smartTime:{numOfPills:g},smartReply:{numOfPills:b}};if(a&&i&&n)return{smartReply:{numOfPills:g},smartReminder:{numOfPills:g},smartTodo:{numOfPills:g}};if(a&&n)return{smartTodo:{numOfPills:g},smartReply:{numOfPills:b}};if(a&&i)return{smartReminder:{numOfPills:g},smartTodo:{numOfPills:g}};if(a)return{smartTodo:{numOfPills:g}};if(t)return{smartTime:{numOfPills:g}};if(n)return{smartReply:{numOfPills:h}}}return null}(o);if(u)new Map([["SmartDoc",u.smartDoc],["SmartReply",u.smartReply],["SmartTime",u.smartTime],["SmartTodo",u.smartTodo],["SmartReminder",u.smartReminder]]).forEach(function(e,n){var a,i;e&&t.push.apply(t,r.__spread((a=n,i=e,o.filter(function(e){return e.featureName===a}).slice(0,i.numOfPills))))});for(var c=function(r){var a=e[r];t.some(function(e){return e===a})||(a.logData.mainPayload.renderStory|=2,n.push(a))},d=0;d<o.length;d++)c(d)}}return{pillsToShow:t,pillsToHide:n,arbitratorId:"complexArbitrator"}}};var y=3;function O(e,t){void 0===t&&(t=y);var n=[],r=null;if(e)for(var a=Object.keys(e),i=0;i<a.length;i++)for(var o=e[a[i]],c=0;c<o.length;c++)if(r=o&&o[c]){if(!(n.length<t))return n;n.push(r)}else u.c.info("[extractAttachmentSuggestions] ReplyWithAttachmentSuggestion is null");return n}var P="EntityExtraction/SubstrateSearchSuggestions",j="EntityExtraction/ReplyWithQueryCoverage";var T=n(75),w="/ows/search/api/v1/";function _(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i,o=this;return r.__generator(this,function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),t=function(e){var t={},n=function(e){var t=[];if(null!=e.ReplyWithQueryCoverage)for(var n=JSON.parse(e.ReplyWithQueryCoverage.Value)[0],r=n.coverageCheckResults,a=Object.keys(r),i=0;i<a.length;i++){var o=a[i];r[o]||t.push(o)}return t}(e);return JSON.parse(e.SubstrateSearchSuggestions.Value)[0].requests.forEach(function(e){var r=e.InputText;if(!n.includes(r)){var a=function(e,t){for(var n,r,a=w+e,i=0;i<t.length;i++)n=t[i].Key,r=t[i].Value,a+=0==i?"?":"&",a+=n+"="+r;return a}(e.Endpoint,e.UrlParameters);t[r]=a}}),t}(e),n={},(a=Object.keys(t)).length>0?[4,Promise.all(a.map(function(e){return r.__awaiter(o,void 0,void 0,function(){var a,i;return r.__generator(this,function(r){switch(r.label){case 0:return a=n,i=e,[4,I(t[e])];case 1:return[2,a[i]=r.sent()]}})})}))]:[3,2];case 1:return c.sent(),[2,R(n)];case 2:return[3,4];case 3:return i=c.sent(),u.c.info("Failed to parse property, error: "+i.message),[3,4];case 4:return[2,null]}})})}function I(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:t=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(T.b)(e)];case 2:return t=r.sent(),[3,4];case 3:return n=r.sent(),u.c.info("[getReplyWithSuggestions_executeAndLog3SQuery] Failed to make service call, error: "+n.message),[3,4];case 4:return[2,t]}})})}function R(e){try{var t={};return Object.keys(e).forEach(function(n){t[n]=e[n].Groups[0].Suggestions;for(var r=0;r<t[n].length;r++)t[n][r].Endpoint=0}),t}catch(e){return u.c.info("getSentenceToAttachmentSuggestionsMap: Failed to execute, error: "+e.message),null}}function E(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t=null,(n=function(e){var t={SubstrateSearchSuggestions:null,ReplyWithQueryCoverage:null},n=e.ExtendedProperty;if(n)for(var r=n.length,a=0;a<r;a++){var i=n[a];i.ExtendedFieldURI.PropertyName===P?t.SubstrateSearchSuggestions=i:i.ExtendedFieldURI.PropertyName===j&&(t.ReplyWithQueryCoverage=i)}return t}(e))?[4,_(n)]:[3,2];case 1:t=r.sent(),r.label=2;case 2:return[2,t]}})})}var x=Object(a.action)("createMessageWithAttachmentAction",function(e,t){return{item:e,attachment:t}}),D=n(4900);function A(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return(n=e.AttachmentSuggestions)?[3,2]:[4,E(e)];case 1:n=r.sent(),r.label=2;case 2:return(t=n)?[2,O(t).map(function(t,n){return function(e,t,n){var r=Object(D.b)("SmartDoc","suggestion"+n);return{ariaLabel:e.FileName,featureName:"SmartDoc",icon:{iconName:k(e.FileExtension)},onClick:function(){x(t,e)},logData:r,index:n,text:e.FileName}}(t,e,n)})]:[2,[]]}})})}function k(e){return e.indexOf("doc")>=0?"WordLogo":e.indexOf("ppt")>=0?"PowerPointLogo":e.indexOf("xls")>=0?"ExcelLogo":e.indexOf("pdf")>=0?"Pdf":"OfficeLogo"}var N=n(1586),C=n(3676);function F(e,t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return n=null,Object(C.i)()!==C.c.NotLoaded?[3,2]:[4,C.k.import()];case 1:return r.sent()(function(r){n=L(Object(C.g)(),e),t(n)}),[3,3];case 2:n=L(Object(C.g)(),e),t(n),r.label=3;case 3:return[2]}})})}function L(e,t){var n=function(e){for(var t=0;t<e.length;t++)if(0===e[t].type)return e[t].model.Id;return u.c.warn("createCloudFileFromAttachmentData: Could not get OneDrive Pro provider ID. Attachment will not upload."),""}(e);return{fileType:N.a.CloudSuggestion,name:t.FileName,size:null,providerId:n,providerType:0,location:t.Url,providerEndpointUrl:null,isFolder:!1,fileId:t.Id,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:null}}var M=n(197);Object(a.orchestrator)(x,function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i=this;return r.__generator(this,function(o){switch(o.label){case 0:t=e.item,n=e.attachment,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,F(n,function(e){return r.__awaiter(i,void 0,void 0,function(){return r.__generator(this,function(n){return function(e,t){r.__awaiter(this,void 0,void 0,function(){var n,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return t?[4,M.z.import()]:[3,5];case 1:return n=r.sent(),[4,M.j.import()];case 2:return a=r.sent(),(i=Object(M.d)(e.ConversationId.Id))?[3,4]:[4,n({referenceItemOrId:e,isReplyAll:!0,useFullCompose:!1,actionSource:null,instrumentationContexts:null,conversationId:e.ConversationId.Id,body:null})];case 3:i=r.sent(),r.label=4;case 4:a([t],i,{isInline:!1,isHiddenInline:!1,shouldShare:!0},null,null,null,null),r.label=5;case 5:return[2]}})})}(t,e),[2]})})})];case 2:return o.sent(),[3,4];case 3:return a=o.sent(),u.c.error("[createMessageWithAttachmentOrchestrator] Error when creating cloud file: "+a.message),[3,4];case 4:return[2]}})})});var U="EntityExtraction/SmartReplyForEmail",V=n(633);var B=Object(a.action)("cacheSmartReplyDataAction",function(e,t,n,r,a){return{item:e,validPropertyExists:t,smartReplies:n,loggableSmartReplies:r,smartReplyExtractionID:a}}),W="2018-06-20T00:00:00.0000000Z",H="@extractionTimeUtc",q="@EntityId",z=3;function G(e,t){var n=!1;if(e&&t)try{var r=JSON.parse(t.Value)[0],a=r[H];if(a)Date.parse(a)>=Date.parse(W)&&(n=function(e,t){for(var n=t[q],r=[],a=[],i=!1,o=t.entities.length,c=0;c<o;c++)r.push(t.entities[c].value),a.push(t.entities[c].valueRaw||t.entities[c].value);n&&r.length==z?B(e,i=!0,r,a,n):u.c.info("[getSmartRepliesForItem_extractAndCacheSmartRepliesFromProperty] Unexpected number of smart replies on item. Expected "+z+" but found "+r.length);return i}(e,r));else u.c.info("[getSmartRepliesForItem_parseSmartReplyProperty] Time stamp not found on property, aborting smart reply parsing.")}catch(e){u.c.info("[getSmartRepliesForItem_parseSmartReplyProperty] Malformed property, cannot parse. Error: "+e.message)}else u.c.info("[getSmartRepliesForItem_parseSmartReplyProperty] No item or property found.");e&&!n&&B(e,n)}function J(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){if(e){if(e.SmartReplyData||(t=function(e,t){var n=e.ExtendedProperty;if(n)for(var r=n.length,a=0;a<r;a++){var i=n[a];if(i.ExtendedFieldURI.PropertyName===t)return i}return null}(e,U),G(e,t)),e.SmartReplyData&&e.SmartReplyData.ExtractionID)return[2,e.SmartReplyData.SmartReplies.map(function(t,n){return function(e,t,n,r,a){var i=Object(D.b)("SmartReply",n);return i.mainPayload.EID=r,i.mainPayload.confidenceScore=a+1,{ariaLabel:"Suggested reply: "+t,featureName:"SmartReply",onClick:function(){V.h.importAndExecute(e.ItemId.Id,e.ConversationId.Id,t,1)},logData:i,index:a,text:t,toolTip:t,confidenceScore:i.mainPayload.confidenceScore}}(e,t,e.SmartReplyData.LoggableSmartReplies[n],e.SmartReplyData.ExtractionID,n)})]}else u.c.info("[getSmartRepliesForItem] No item, cannot produce smart replies.");return[2,[]]})})}var Q=n(8),K=(Object(a.mutator)(B,function(e){var t={SmartReplies:null,LoggableSmartReplies:null,ExtractionID:null,SuggestionAppropriatenessMap:null,FeedbackSubmitted:!1},n=e.item,r=e.validPropertyExists,a=e.smartReplies,i=e.loggableSmartReplies,o=e.smartReplyExtractionID;if(r){t={SmartReplies:a,LoggableSmartReplies:i,ExtractionID:o,SuggestionAppropriatenessMap:new Q.ObservableMap,FeedbackSubmitted:!1};for(var u=0;u<a.length;u++){var c=String(u);t.SuggestionAppropriatenessMap.set(c,"")}}n.SmartReplyData=t}),n(306)),$=n(263),X=n(11025);var Y="EntityExtraction/Events1.0";function Z(e){var t=null;if(e){var n=e.ExtendedProperty;n&&n.some(function(e){return e.ExtendedFieldURI.PropertyName==Y&&(t=e,!0)})}return t}var ee=n(6),te=n(166);var ne=n(4),re=Object(a.action)("cacheSmartTimeExtendedPropertyAction",function(e,t,n){return{item:e,validPropertyExists:t,smartTimesExtendedProp:n}}),ae="@EntityId",ie="confidence";function oe(e,t){e?e.SmartTimeExtendedProperty||function(e,t){var n,a;if(!e)return void u.c.info("getSmartTimeForItem_cacheAndParseSmartTimeProperty] Message item is unavailable.");if(!t)return void u.c.info("[getSmartTimeForItem_parseSmartTimeProperty] No smart time extended property found.");var i=null,o=!1;try{var c=JSON.parse(t.Value);if(c&&c.length>0){var s=c[0][ae],l=c[0][ie];try{for(var d=r.__values(c),f=d.next();!f.done;f=d.next()){var m=f.value;if(m.times&&m.times.length>0){var p=m.times[0],g=p.beginingOfTimeRange,b=p.endOfTimeRange;i={beginingOfTimeRange:g,endOfTimeRange:b,duration:p.duration,entityId:s,hasIntent:!0,confidenceScore:l},o=!0}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}}}catch(e){u.c.warn("[getSmartTimeForItem_parseSmartTimeProperty] Malformed property, cannot parse. Error: "+e.message)}finally{re(e,o,i)}}(e,t):u.c.info("[getSmartTimeForItem_parseSmartTimeProperty] No item or property found.")}var ue=n(6258);function ce(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i,o,s,l,d,f;return r.__generator(this,function(r){switch(r.label){case 0:return t=[],e?e.SmartTimeExtendedProperty?[3,2]:[4,Z(e)]:[3,6];case 1:n=r.sent(),oe(e,n),r.label=2;case 2:return(a=e.SmartTimeExtendedProperty)?(i=a.entityId,o=100*a.confidenceScore,s=null,l=null,Object(c.d)("mc-smartReplyWithMeeting-SuggestedTimeToCAS")&&(s=function(e){var t=null;if(e&&e.SmartTimeExtendedProperty){var n=Object(te.g)();try{var r=Object(ee.Wb)(e.SmartTimeExtendedProperty.beginingOfTimeRange),a=Object(ee.Wb)(e.SmartTimeExtendedProperty.endOfTimeRange);r>=n&&(t={startTime:r,endTime:a})}catch(e){u.c.error("[getSmartTimeSuggestion] Unable to parse suggested time. "+e)}}return t}(e))?[4,Object(ue.a)(e,s)]:[3,4]):[3,5];case 3:r.sent(),l=Object(K.b)().conversationReadingPaneViewState.calendarInlineComposeViewState,r.label=4;case 4:f=function(e,t,n,r){var a=Object(D.b)("SmartTime",Object(ne.a)(X.a)),i=null!=r,o=n.ToRecipients?n.ToRecipients.length:0,u=n.CcRecipients?n.CcRecipients.length:0;a.mainPayload.EID=e,a.mainPayload.confidenceScore=t,a.mainPayload.hasSuggestedTime=i,a.mainPayload.NumToRecipient=o,a.mainPayload.NumCCRecipient=u,i&&(a.mainPayload.suggestedStartTime=r.startTime,a.mainPayload.suggestedEndTime=r.endTime);return a}(i,o,d=e,s),t.push(function(e,t,n,r,a,i){return{ariaLabel:"Suggested time: "+t,featureName:"SmartTime",onClick:n,index:e,logData:r,text:t,toolTip:t,icon:i,confidenceScore:r.mainPayload.confidenceScore}}(t.length,Object(ne.a)(X.a),function(){$.l.importAndExecute(e.ItemId.Id,l,!1,null,i,d.InternetMessageId)},f,0,{iconName:"DateTime2"})),r.label=5;case 5:return[3,7];case 6:u.c.info("[getSmartTimesForItem] No item, cannot produce smart times."),r.label=7;case 7:return[2,t]}})})}Object(a.mutator)(re,function(e){var t={beginingOfTimeRange:null,endOfTimeRange:null,duration:null,entityId:null,hasIntent:!1,confidenceScore:0},n=e.item,r=e.validPropertyExists,a=e.smartTimesExtendedProp;r&&a&&(t={beginingOfTimeRange:a.beginingOfTimeRange,endOfTimeRange:a.endOfTimeRange,duration:a.duration,entityId:a.entityId,hasIntent:!0,confidenceScore:a.confidenceScore}),n.SmartTimeExtendedProperty=t});var se=n(11026),le=n(757),de=n(144);function fe(e,t,n,r){var a=Object(D.b)("SmartTodo",n);return a.mainPayload.confidenceScore=e.confidenceScore,a.mainPayload.EID=e.entityId,{ariaLabel:"Suggested todo: "+e.description,featureName:"SmartTodo",icon:{iconName:"ToDoLogoOutline"},onClick:function(){!function(e,t){if(Object(f.a)())return void le.i.importAndExecute("SmartTask",e,t);if(Object(d.a)())de.k.importAndExecute(e,t)}(e.description,t)},logData:a,index:r,text:n,toolTip:n,confidenceScore:e.confidenceScore}}var me=Object(a.action)("cacheSmartTaskData",function(e,t,n){return{item:e,validPropertyExists:t,smartTasks:n}}),pe="@EntityId",ge="@sourceConfidenceScore";function be(e,t){var n=!1;if(e&&t)try{n=function(e,t){var n=JSON.parse(t.Value),r=!1;if(!t)return u.c.info("[getSmartTaskForItem_parseSmartTaskProperty] No smart task extended property found."),r;var a=[];if(n&&n.length>0)for(var i=n.length,o=0;o<i;o++){var c=n[o];a.push({entityId:c[pe],description:c.description,confidenceScore:100*Number(c[ge])})}a.length>0?me(e,r=!0,a):u.c.info("[getSmartTasksForItem_extractAndCacheSmartTaskFromProperty] There are zero smart tasks for this item");return r}(e,t)}catch(e){u.c.info("[getSmartTasksForItem_parseSmartTaskProperty] Malformed property, cannot parse. Error: "+e.message)}else u.c.info("[getSmartTasksForItem_parseSmartTaskProperty] No item or property found.");e&&!n&&me(e,!1)}var he,ve="EntityExtraction/RequestForAction1.0";function Se(e,t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){if(e){if(e.SmartTaskData||(n=function(e){var t=null;if(e){var n=e.ExtendedProperty;n&&n.some(function(e){return e.ExtendedFieldURI.PropertyName==ve&&(t=e,!0)})}return t}(e),be(e,n)),e.SmartTaskData&&e.SmartTaskData.SmartTasks)return[2,e.SmartTaskData.SmartTasks.map(function(n,r){return t==he.Todo&&e.ItemId?fe(n,e.ItemId.Id,Object(ne.a)(se.a),r):function(e,t,n,r,a){var i=Object(D.b)("SmartReminder",r);return i.mainPayload.confidenceScore=e.confidenceScore,i.mainPayload.EID=e.entityId,{ariaLabel:"Suggested reminder: "+e.description,featureName:"SmartReminder",icon:{iconName:"AddEvent"},onClick:function(){$.l.importAndExecute(t,null,!1,null,e.entityId,n,!0)},logData:i,index:a,text:r,toolTip:r,confidenceScore:e.confidenceScore}}(n,e.ItemId.Id,e.InternetMessageId,Object(ne.a)(se.b),r)})]}else u.c.info("[getSmartTodosOrRemindersForItem] No item, cannot produce smart tasks.");return[2,[]]})})}!function(e){e[e.Todo=0]="Todo",e[e.Reminder=1]="Reminder"}(he||(he={}));Object(a.mutator)(me,function(e){var t={SmartTasks:null},n=e.item;if(e.validPropertyExists){var r=e.smartTasks;t.SmartTasks=r}n.SmartTaskData=t});function ye(e){var t=[];return t.push(function(e){return{buildPills:function(){return ce(e)}}}(e)),t.push(function(e){return{buildPills:function(){return A(e)}}}(e)),t.push(function(e){return{buildPills:function(){return J(e)}}}(e)),t.push(function(e){return{buildPills:function(){return Se(e,he.Todo)}}}(e)),Object(c.d)("mc-smartTaskWithReminder")&&t.push(function(e){return{buildPills:function(){return Se(e,he.Reminder)}}}(e)),t}var Oe=Object(a.action)("mergeItemPropertiesAction",function(e,t){return{oldItem:e,newItem:t}}),Pe=Object(a.action)("updateItemLanguageAction",function(e){return{item:e}}),je=n(226),Te=n.n(je),we=20,_e="Language",Ie="Locale",Re="LanguageScores",Ee="@EntityId",xe="EntityExtraction/ExtractLanguage1.0",De=Te()({PropertyName:xe,DistinguishedPropertySetId:"Common",PropertyType:"String"}),Ae=Te()({PropertyName:"EntityExtraction/SmartReplyForEmail",DistinguishedPropertySetId:"Common",PropertyType:"String"}),ke=Te()({PropertyName:"EntityExtraction/Events1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),Ne=Te()({PropertyName:"EntityExtraction/RequestForAction1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),Ce=Te()({PropertyName:"EntityExtraction/SubstrateSearchSuggestions",DistinguishedPropertySetId:"Common",PropertyType:"String"}),Fe=Te()({PropertyName:"EntityExtraction/ReplyWithQueryCoverage",DistinguishedPropertySetId:"Common",PropertyType:"String"});var Le=n(661),Me=n(660),Ue=n(385),Ve=n.n(Ue);function Be(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return(t=function(e){var t=[];return e.stampedLanguage||t.push(De),e.SmartReplyData||t.push(Ae),e.SmartTimeData||t.push(ke),e.AttachmentSuggestions||t.push(Ce,Fe),e.SmartTaskData||t.push(Ne),t.filter(function(t){return!function(e,t){if(e){var n=e.ExtendedProperty;if(n)for(var r=0;r<n.length;r++)if(n[r].ExtendedFieldURI.PropertyName==t)return!0}return!1}(e,t.PropertyName)})}(e)).length>0?(n=Ve()({BaseShape:"IdOnly",AdditionalProperties:t}),[4,Object(Le.a)([e.ItemId.Id],n,null,null,e.MailboxInfo&&e.MailboxInfo.requestOptions)]):[3,2];case 1:if(a=r.sent(),Object(Me.a)(a[0])&&(i=a[0])&&i.Items&&i.Items[0])return[2,i.Items[0]];r.label=2;case 2:return[2,null]}})})}function We(e){var t=[];return t.push(function(e){var t=this;return{preRun:function(){return r.__awaiter(t,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,Be(e)];case 1:return(t=n.sent())&&Oe(e,t),e.stampedLanguage||Pe(e),[2]}})})}}}(e)),t}function He(e){var t=this;return{updateLogData:function(n){return r.__awaiter(t,void 0,void 0,function(){var t,a,i;return r.__generator(this,function(r){return e&&(t=e.stampedLanguage&&e.stampedLanguage.language,a=e.stampedLanguage&&e.stampedLanguage.locale,i=e.InternetMessageId,n.forEach(function(e){e.logData.mainPayload.language=t,e.logData.mainPayload.locale=a,e.logData.cosmosOnlyData=i})),[2]})})}}}var qe=n(11027);function ze(e,t){var n;n=t.UniqueBody?t.UniqueBody.Value:t.NormalizedBody.Value;var r={subtitle:void 0,dSATOptions:void 0,donationJson:JSON.stringify({messageBody:n})},a=e.some(function(e){return"SmartTime"===e.featureName});return e.some(function(e){return"SmartReply"===e.featureName})?(r.subtitle=Object(ne.a)(qe.f),r.dSATOptions=a?[{logString:"They aren't relevant",uiString:Object(ne.a)(qe.a)},{logString:"They don't sound like me",uiString:Object(ne.a)(qe.c)},{logString:"They're offensive or rude",uiString:Object(ne.a)(qe.d)},{logString:"I'm not the person who should schedule the meeting",uiString:Object(ne.a)(qe.i)},{logString:"I don't want help scheduling a meeting",uiString:Object(ne.a)(qe.k)},{logString:"Other",uiString:Object(ne.a)(qe.e)}]:[{logString:"They aren't relevant",uiString:Object(ne.a)(qe.a)},{logString:"The meaning isn't clear",uiString:Object(ne.a)(qe.b)},{logString:"They don't sound like me",uiString:Object(ne.a)(qe.c)},{logString:"They're offensive or rude",uiString:Object(ne.a)(qe.d)},{logString:"Other",uiString:Object(ne.a)(qe.e)}]):a?(r.subtitle=Object(ne.a)(qe.l),r.dSATOptions=[{logString:"The meeting is already on my calendar",uiString:Object(ne.a)(qe.g)},{logString:"A meeting suggestion isn't relevant",uiString:Object(ne.a)(qe.h)},{logString:"I'm not the person who should schedule the meeting",uiString:Object(ne.a)(qe.i)},{logString:"I want to schedule the meeting later",uiString:Object(ne.a)(qe.j)},{logString:"I don't want help scheduling a meeting",uiString:Object(ne.a)(qe.k)},{logString:"Other",uiString:Object(ne.a)(qe.e)}]):r.subtitle=Object(ne.a)(qe.f),r}var Ge=n(20),Je=n(7294),Qe=n(2),Ke=n(11028),$e=function(e){function t(t){var n=e.call(this,t)||this,r=n.props.item;return n.smartPillBuilders=ye(r),n.smartPillArbitrator=Object(c.d)("mc-smartReplyWithDoc")||Object(c.d)("mc-smartReplyWithCustomMeeting")||Object(c.d)("mc-smartTask")?S:p,n.smartPillPreRunners=We(r),n.smartPillLogDataUpdaters=function(e){return[He(e)]}(r),n}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.runSmartPillBuilders()},t.prototype.componentWillUnmount=function(){this.smartPillBuilders=null,this.smartPillArbitrator=null,this.smartPillData=null,i(this.props.viewState,!1)},t.prototype.render=function(){var e=this.props.viewState.smartPillBlockVisible,t=!this.props.item.smartPillFeedbackSubmitted,n=this.smartPillData&&this.smartPillData.pillsToShow.length>0;return!!this.smartPillData&&e&&Qe.createElement("div",{className:n?Ke.bar:void 0},Qe.createElement(Je.a,{arbitratedPills:this.smartPillData,enableFeedbackForm:t,feedbackData:ze(this.smartPillData.pillsToShow,this.props.item)}))},t.prototype.runSmartPillBuilders=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return u.c.info("[MailSmartPillBlock] Running smart pill builders"),e=this,[4,Object(D.a)(this.smartPillBuilders,this.smartPillArbitrator,this.smartPillPreRunners,this.smartPillLogDataUpdaters,5e3)];case 1:return e.smartPillData=t.sent(),this.smartPillData&&this.smartPillData.pillsToShow&&i(this.props.viewState,!0),[2]}})})},t=r.__decorate([Ge.observer],t)}(Qe.Component);Object(a.mutator)(i,function(e){e.viewState.smartPillBlockVisible=e.smartPillBlockVisible}),Object(a.mutator)(o,function(e){e.item.smartPillFeedbackSubmitted=e.smartPillFeedbackSubmitted}),Object(a.mutator)(Oe,function(e){var t=e.oldItem,n=e.newItem;n.ExtendedProperty&&n.ExtendedProperty.length>0&&(t.ExtendedProperty=t.ExtendedProperty.concat(n.ExtendedProperty))});function Xe(e){var t=function(e){var t=e.ExtendedProperty;if(t){var n=t.filter(function(e){return e.ExtendedFieldURI.PropertyName===xe});if(n.length>0)return n[0]}return null}(e),n=void 0,r=void 0,a=0,i=void 0;try{if(t){var o=JSON.parse(t.Value)[0],c=o[_e],s=o[Re];i=o[Ee],r=Object.keys(s)[0],n=c&&c[Ie]&&c[Ie].toLowerCase(),a=parseInt(Object.values(s)[0])}}catch(e){u.c.info("[getStampedLanguage] Failed to parse property, error: "+e.message)}return{locale:n,language:r,confidenceScore:a,entityId:i}}var Ye=n(18);Object(a.mutator)(Pe,function(e){var t=e.item;t.stampedLanguage=Xe(t),Object(c.d)("mc-logMessagesInSpanish")&&function(e,t,n,r){void 0===r&&(r=we),function(e,t){return e.UniqueBody&&e.UniqueBody.Value.length>t||e.NormalizedBody&&e.NormalizedBody.Value.length>t}(e,r)&&e.stampedLanguage.language.toLowerCase()===t.toLowerCase()&&Object(Ye.o)(n,{entityId:e.stampedLanguage.entityId,confidenceScore:e.stampedLanguage.confidenceScore},{isCore:!0})}(t,"spanish","SpanishLanguageMessage")});n.d(t,"MailSmartPillBlock",function(){return $e})},1318:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o});var r=n(1),a=Object(r.createStore)("UserVoiceNpsStore",{npsSurveyBody:"",npsSurveyRatings:"",isRatingSelected:!1,isSent:!1}),i=Object(r.createStore)("UserVoiceSuggestionStore",{message:"",isMessageEnabled:!1,isSent:!1,customFields:[]})(),o=Object(r.createStore)("userVoiceTrendingIdeasStore",{suggestions:[],pagination:{page:0,per_page:0,total_pages:0,total_records:0}})},1332:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=Object(r.action)("DEACTIVATE_HELP_CHARM")},1382:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=Object(r.action)("openPremiumDashboard")},1396:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("SHOW_QUICK_OPTIONS",function(){return{}})},1397:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=Object(r.action)("contactSupport")},1403:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=Object(r.createStore)("whatsNewStore",{cards:null})},1406:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e.Read="Read",e.Unread="Unread"}(r||(r={}))},1408:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=Object(r.action)("TRY_TODO_PANEL")},144:function(e,t,n){"use strict";var r=n(3),a=n(0),i=n(369),o=n(5),u=n(350),c=n(1),s=(Object(c.orchestrator)(i.c,function(){return a.__awaiter(void 0,void 0,void 0,function(){return a.__generator(this,function(e){return Object(o.d)("auth-PremiumDashboardApril")?u.e.importAndExecute("premium","features"):Object(o.d)("auth-PremiumDashboard")?u.e.importAndExecute("general","Premium"):window.open("https://premium.outlook.com","_blank"),[2]})})}),n(1397)),l=n(81),d=(Object(c.orchestrator)(s.a,function(){Object(o.d)("fwk-o365shellheader")?window.O365Shell.FlexPane.OpenFlexPaneForProvider("OwaHelp"):Object(l.c)(2)}),n(896));Object(c.orchestrator)(d.a,function(){Object(o.d)("fwk-o365shellheader")?window.O365Shell.FlexPane.OpenFlexPaneForProvider("OwaSettings"):Object(l.c)(4)}),n(1746);n.d(t,"b",function(){return m}),n.d(t,"e",function(){return p}),n.d(t,"c",function(){return g}),n.d(t,"d",function(){return b}),n.d(t,"h",function(){return h}),n.d(t,"l",function(){return v}),n.d(t,"n",function(){return S}),n.d(t,"f",function(){return y}),n.d(t,"q",function(){return O}),n.d(t,"g",function(){return P}),n.d(t,"r",function(){return j}),n.d(t,"p",function(){return T}),n.d(t,"o",function(){return w}),n.d(t,"m",function(){return _}),n.d(t,"a",function(){return I}),n.d(t,"j",function(){return R}),n.d(t,"k",function(){return E}),n.d(t,"i",function(){return x});var f=new r.c(function(){return Promise.all([n.e(5),n.e(487),n.e(59),n.e(239)]).then(n.bind(null,11680))}),m=Object(r.d)(f,function(e){return e.DiagnosticsPane}),p=Object(r.d)(f,function(e){return e.FeatureFlagsPane}),g=Object(r.d)(f,function(e){return e.FeatureFlagsHeader}),b=Object(r.d)(f,function(e){return e.FeatureFlagsList}),h=Object(r.d)(f,function(e){return e.HelpPane}),v=Object(r.d)(f,function(e){return e.MeCardPane}),S=Object(r.d)(f,function(e){return e.SettingsPane}),y=Object(r.d)(f,function(e){return e.FeedbackPane}),O=Object(r.d)(f,function(e){return e.WafflePane}),P=Object(r.d)(f,function(e){return e.GetStartedPane}),j=Object(r.d)(f,function(e){return e.WhatsNewPane}),T=Object(r.d)(f,function(e){return e.TodoPane}),w=Object(r.d)(f,function(e){return e.TimePanelPane}),_=Object(r.d)(f,function(e){return e.MiniMavenPane}),I=Object(r.d)(f,function(e){return e.ActivityFeedPane}),R=new r.a(f,function(e){return e.launchHelpPane}),E=new r.a(f,function(e){return e.showTodoPanelWithSubject}),x=new r.a(f,function(e){return e.toggleGetStartedPane})},1746:function(e,t,n){"use strict";var r=n(1),a=n(1408),i=n(81),o=n(5);Object(r.orchestrator)(a.a,function(){Object(o.d)("fwk-o365shellheader")?window.O365Shell.FlexPane.OpenFlexPaneForProvider("OwaToDo"):Object(i.c)(9)})},3621:function(e,t,n){"use strict";var r=n(1),a=n(8),i=n(3724),o={providers:new a.ObservableMap,loadState:i.a.NotLoaded,removalPending:new a.ObservableMap},u=Object(r.createStore)("fileProviderStoreV2",o);t.a=u},3627:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return o});var r=n(1),a=Object(r.action)("FILE_PROVIDER_ADDED",function(e){return{providerViewState:e}}),i=Object(r.action)("FILE_PROVIDER_REMOVED",function(e){return{providerType:e}}),o=Object(r.action)("PROVIDERS_LOADED",function(e){return{providers:e}})},3640:function(e,t,n){"use strict";var r=n(0),a=n(4199),i=n.n(a),o=n(3878),u=n.n(o);function c(e){var t=u()({ProviderType:e});return i()(t)}var s=n(4200),l=n.n(s),d=n(3879),f=n.n(d);function m(e){var t=f()({ProviderType:e});return l()(t)}var p=n(4145),g=n(5);n.d(t,"a",function(){return j}),n.d(t,"b",function(){return _});var b="code",h="token",v=3e3,S=3;function y(e){return{state:e}}function O(e){return e.state}function P(e){return e.code}function j(e,t,n,a,i){var o={providerType:e,getAuthUrlInfo:null,getCSRFToken:O,getOAuthCode:P};return function e(t,n,a,i,o,u,s){return r.__awaiter(this,void 0,void 0,function(){var l,d;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),l=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,m(t)];case 1:return d=r.sent(),l=d.AttachmentDataProviderCreator.ProviderAppKey,a=d.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,c(t)];case 3:d=r.sent(),l=d.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(p.d)(t,a,i,l,o,u),[3,6];case 5:return r.sent(),s>0&&setTimeout(function(){return e(t,n,a,i,o,u,--s)},v),[3,6];case 6:return[2]}})})}(e,o,t,n,a,i,S),o}var T=null;function w(){if(!T){(T={})[3]=j(3,"https://app.box.com/api/oauth2/authorize",Object(p.c)(3),b,y),T[2]=j(2,"https://www.dropbox.com/oauth2/authorize",Object(p.b)(2),b,y);var e=j(6,"https://www.facebook.com/dialog/oauth",Object(p.b)(6),h,function(e){return{state:e,scope:"user_photos,email"}});e.getCSRFToken=O,e.getOAuthCode=function(e){return e.access_token},T[6]=e;var t=j(5,"https://accounts.google.com/o/oauth2/auth",p.a+"/ADPRedirect.aspx",b,function(e){var t={state:e,provider:5..toString(),url:Object(p.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});t.getCSRFToken=function(e){return JSON.parse(e.state).state},T[5]=t,T[1]=j(1,"https://login.live.com/oauth20_authorize.srf",Object(p.c)(1),b,function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}),Object(g.d)("doc-fileProvider-wopiClient")&&(T[7]=j(7,"",Object(p.c)(7),b,y),T[8]=j(8,"",Object(p.c)(8),b,y),T[9]=j(9,"",Object(p.c)(9),b,y))}return T}function _(e){var t=w();return e in t?t[e]:null}},3660:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(0),a=n(3621),i=function(){return r.__spread(Object(a.a)().providers.values())},o=function(e){return Object(a.a)().providers.get(e)||null}},3676:function(e,t,n){"use strict";var r=n(3823),a=n(3794),i=(n(3621),n(3627)),o=n(3685),u=(n(4112),n(4080),n(3660));var c=n(3780),s=n(3),l=n(3724),d=n(3640);n.d(t,"k",function(){return m}),n.d(t,"m",function(){return p}),n.d(t,"j",function(){return g}),n.d(t,"l",function(){return b}),n.d(t,"a",function(){return o.b}),n.d(t,"b",function(){return r.a}),n.d(t,"f",function(){return d.b}),n.d(t,"c",function(){return l.a}),n.d(t,"d",function(){return i.a}),n.d(t,"e",function(){return i.b}),n.d(t,"h",function(){return a.a}),n.d(t,"i",function(){return c.a}),n.d(t,"g",function(){return u.b}),n.d(t,"n",function(){return i.c});var f=new s.c(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(6),n.e(200)]).then(n.bind(null,11732))}),m=new s.b(f,function(e){return e.loadProviders}),p=new s.b(f,function(e){return e.removeFileProvider}),g=new s.b(f,function(e){return e.addFileProvider}),b=new s.b(f,function(e){return e.removeAndAddFileProvider})},3685:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return o});var r,a=n(0);!function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));var i=Object.freeze([1,3,2,6,5,7,8,9]),o=Object.freeze(a.__spread(i,[0,4,10]))},369:function(e,t,n){"use strict";var r=n(3),a=n(24),i=n(1403),o=n(1406);function u(){var e=Object(i.a)();return e.cards?Object.keys(e.cards).filter(function(t){return e.cards[t].status===o.a.Unread}).length:0}n(896);var c=n(1382);n.d(t,"a",function(){return l}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return c.a});var s=new r.c(function(){return n.e(412).then(n.bind(null,11664))}),l=Object(r.d)(s,function(e){return e.WhatsNewContainer}),d=new r.b(s,function(e){return e.initializeWhatsNew});Object(a.c)(function(){d.import().then(function(e){return e()})})},3724:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(r||(r={}))},3780:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3621);function a(){return Object(r.a)().loadState}},3794:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(4198),a=n(4079),i=n(4159),o=n(4),u=n(98);function c(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:case 1:return Object(o.a)(i.a);case 2:case 9:return Object(o.a)(r.b);case 3:case 7:return Object(o.a)(r.a);case 5:return Object(o.a)(r.e);case 6:return Object(o.a)(r.d);case 4:return Object(o.a)(r.f);case 10:return Object(o.a)(a.b);case 8:return Object(o.a)(r.c);default:return Object(u.a)(e)}}},3823:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},3878:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}},3879:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}},4079:function(e){e.exports={a:"Bda",b:"Cda"}},4080:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(9),a=n(56),i=n(98),o=n(5);function u(e){var t=Object(r.a)();switch(e){case 5:return Object(a.a)()&&t.AttachmentPolicy.GoogleDriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 4:case 0:return!0;case 3:return Object(a.a)()&&t.AttachmentPolicy.BoxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 2:return Object(a.a)()&&t.AttachmentPolicy.DropboxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 6:return Object(a.a)()&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.d)("doc-fileProvider-facebook");case 1:return!!Object(a.a)()||Object(o.d)("doc-filePicker-oneDriveConsumerForO365")&&t.AttachmentPolicy.OnedriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 10:return Object(o.d)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.d)("doc-fileProvider-wopiClient");default:return Object(i.a)(e)}}},4112:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(3685),a="file provider is not addable";function i(e){return r.a.indexOf(e)>-1}},4145:function(e,t,n){"use strict";var r=n(41),a=n(15);function i(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+n:e+"?"+t+"="+n}n.d(t,"a",function(){return o}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return s});var o=Object(a.y)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function u(e){var t=e?encodeURIComponent("?provider="+e):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.n)()+"/mail/"+n+t}function c(e){var t=Object(r.n)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+e+"&url="+t);return o+"/ADPRedirect.aspx?"+n}function s(e,t,n,r,a,o){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[],r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}(),u=i(t,"client_id",r);if(u=i(u,"redirect_uri",n),u=i(u,"response_type",a),o){var c=o(e);u=Object.keys(c).reduce(function(e,t){return i(e,t,c[t])},u)}return{authUrl:u,redirectUrl:n,csrfToken:e}}}},4159:function(e){e.exports={a:"Ada"}},4198:function(e){e.exports={b:"uda",a:"vda",e:"wda",d:"xda",f:"yda",c:"zda"}},4199:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),a=n(3878);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetNewAttachmentDataProviderCreationInfo",e,t)}},4200:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),a=n(3879);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetAttachmentDataProviderCreator",e,t)}},438:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("TOGGLE_CHARM",function(e){return{charm:e}})},446:function(e){e.exports={c:"NRa",f:"ORa",e:"PRa",b:"QRa",g:"RRa",a:"SRa",d:"TRa"}},4900:function(e,t,n){"use strict";var r=n(0),a=2500,i=n(12);function o(e,t,n,o,u){return r.__awaiter(this,void 0,void 0,function(){var c,s,l;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,6,,7]),n?[4,Promise.all(n.map(function(e){return e.preRun()}))]:[3,2];case 1:r.sent(),r.label=2;case 2:return[4,Promise.all(e.map(function(e){return Promise.race([e.buildPills(),(t=u||a,new Promise(function(e){setTimeout(e,t,[])}))]);var t}))];case 3:return c=r.sent(),s=[].concat.apply([],c),o?[4,Promise.all(o.map(function(e){return e.updateLogData(s)}))]:[3,5];case 4:r.sent(),r.label=5;case 5:return[2,t.arbitratePills(s)];case 6:return l=r.sent(),i.c.warn("[getPillsToRender] Please investigate error: "+l.message),[2,{pillsToShow:[],pillsToHide:[],arbitratorId:void 0}];case 7:return[2]}})})}function u(e,t){return{mainPayload:{renderStory:0,loggableText:t,type:e}}}var c=n(141),s=n(513);function l(e,t,n){var r=new s.a(e,t,{isCore:!0,isCosmosDatapoint:!0});n&&r.addCosmosOnlyData(n),c.g.importAndExecute(r)}function d(e,t,n){var r=void 0;e.concat(t).forEach(function(e){!r&&e.logData.cosmosOnlyData&&(r=e.logData.cosmosOnlyData)});var a={data:e.map(function(e){return e.logData.mainPayload})},i={data:t.map(function(e){return e.logData.mainPayload})};l("SmartPillsRendered",[e.length,t.length,JSON.stringify(a),JSON.stringify(i),n],r)}function f(e,t,n,r,a,i,o){l("SmartReply_Rendered",[e,!1,t.join("$"),!1,n.toString(),r.toString(),a,i],o)}function m(e){var t={data:[e.logData.mainPayload]};l("SmartPillClicked",[JSON.stringify(t)],e.logData.cosmosOnlyData)}function p(e,t,n,r,a,i,o){l("SmartReply_Clicked",[e,t,n,!1,r,a,i],o)}n(18);n.d(t,"a",function(){return o}),n.d(t,"b",function(){return u}),n.d(t,"e",function(){return d}),n.d(t,"f",function(){return f}),n.d(t,"c",function(){return m}),n.d(t,"d",function(){return p})},620:function(e,t,n){"use strict";n.d(t,"f",function(){return c}),n.d(t,"g",function(){return s}),n.d(t,"h",function(){return l}),n.d(t,"b",function(){return d});var r=n(883);n.d(t,"a",function(){return r.m}),n.d(t,"c",function(){return r.n}),n.d(t,"e",function(){return r.o});var a=n(3),i=n(1318);n.d(t,"i",function(){return i.b});var o=n(1332);n.d(t,"d",function(){return o.a});var u=new a.c(function(){return Promise.all([n.e(3),n.e(5),n.e(6),n.e(62),n.e(407)]).then(n.bind(null,2348))}),c=new a.a(u,function(e){return e.launchInAppFeedback}),s=new a.b(u,function(e){return e.postSuggestionAndSendLogDatapoint}),l=new a.b(u,function(e){return e.showUserVoiceSuggestionDialog}),d=Object(a.d)(u,function(e){return e.UserVoiceNps})},7294:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(3),a=new r.c(function(){return n.e(374).then(n.bind(null,8140))}),i=(Object(r.d)(a,function(e){return e.SmartPill}),Object(r.d)(a,function(e){return e.SmartPillBlock}))},757:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"e",function(){return u}),n.d(t,"j",function(){return c}),n.d(t,"h",function(){return s}),n.d(t,"f",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"i",function(){return f}),n.d(t,"g",function(){return m}),n.d(t,"d",function(){return p});var r=n(3),a=new r.c(function(){return Promise.all([n.e(19),n.e(519),n.e(21),n.e(23),n.e(389)]).then(n.bind(null,2381))}),i=Object(r.d)(a,function(e){return e.TimePanel}),o=Object(r.d)(a,function(e){return e.TimePanelHeaderBar}),u=new r.a(a,function(e){return e.preloadTimePanelData}),c=new r.a(a,function(e){return e.openTimePanel}),s=new r.a(a,function(e){return e.openEventDetailsView}),l=new r.a(a,function(e){return e.openAttendeeTrackingView}),d=new r.a(a,function(e){return e.closeAttendeeTrackingView}),f=new r.a(a,function(e){return e.openTasksView}),m=new r.a(a,function(e){return e.openConflictsView}),p=new r.a(a,function(e){return e.closeConflictsView})},81:function(e,t,n){"use strict";var r=n(1),a=Object(r.action)("DEACTIVATE_CHARM",function(e){return{charm:e}}),i=Object(r.createStore)("headerViewState",{activeCharm:null});Object(r.mutator)(a,function(e){var t=e.charm,n=i();n.activeCharm===t&&(n.activeCharm=null)});var o=n(438);Object(r.mutator)(o.a,function(e){var t=e.charm,n=i();n.activeCharm===t?n.activeCharm=null:n.activeCharm=t});var u=n(1396),c=(Object(r.orchestrator)(u.a,function(){Object(o.a)(4)}),Object(r.action)("HIDE_QUICK_OPTIONS",function(){return{}})),s=(Object(r.orchestrator)(c,function(){a(4)}),n(620));Object(r.orchestrator)(s.d,function(){a(2)});function l(){return i().activeCharm}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return o.a})},883:function(e,t,n){"use strict";n.d(t,"g",function(){return c}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l}),n.d(t,"j",function(){return d}),n.d(t,"h",function(){return f}),n.d(t,"c",function(){return m}),n.d(t,"i",function(){return p}),n.d(t,"k",function(){return g}),n.d(t,"f",function(){return b}),n.d(t,"m",function(){return h}),n.d(t,"n",function(){return v}),n.d(t,"o",function(){return S}),n.d(t,"p",function(){return y}),n.d(t,"q",function(){return O}),n.d(t,"l",function(){return P}),n.d(t,"e",function(){return j}),n.d(t,"d",function(){return T});var r=n(0),a=n(446),i=n(4),o=n(612),u=n.n(o),c="N/A",s="",l="CheckErrorDetails",d="React/Nps",f="UVNpsRating",m="UVFeedback",p="React/Feedback",g="Search_{0}",b="NoUserMessage",h="https://outlook.uservoice.com/forums/{0}",v=601444,S=907141,y=4,O=15;function P(){return[{name:"NoResults",label:Object(i.a)(a.c)},{name:"SlowResults",label:Object(i.a)(a.f)},{name:"ResultsNotRelevant",label:Object(i.a)(a.e)},{name:"ItemNotFound",label:Object(i.a)(a.b)},{name:"SuggestionsNotUseful",label:Object(i.a)(a.g)},{name:"ClientUXHardToUse",label:Object(i.a)(a.a)},{name:"Other",label:Object(i.a)(a.d)}]}function j(e){return e?"1":"2"}function T(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,u()()];case 1:return[2,(e=t.sent()).ConsumerSubscriptions?e.ConsumerSubscriptions.join(","):s]}})})}},896:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=Object(r.action)("OPEN_QUICK_SETTINGS")},902:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(5),a=n(27),i=n(41);function o(){return(!Object(i.u)()||!window.opener)&&(Object(r.d)("cal-time-panel")&&!Object(a.f)().SessionSettings.IsShadowMailbox)}},908:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(5),a=n(27),i=n(41);function o(){return(!Object(i.u)()||!window.opener)&&(Object(r.d)("todo-panel")&&!Object(r.d)("cal-time-panel")&&!Object(a.f)().SessionSettings.IsShadowMailbox)}}},0,[19,519,21,23,389,0,1,30,474,155,2,6,200,3,469,120,271,29,67,307,5,487,59,239,463,87,8,282,464,98,97,295,374,379]]);
//# sourceMappingURL=owa.MailSmartPill.js.map
self.scriptsLoaded['owa.MailSmartPill.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailSmartPill.js'] = (new Date()).getTime();