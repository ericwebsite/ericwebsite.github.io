<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <title>Skype</title>

    <script type="text/javascript" nonce="pfRygje1t9NpsMtb">
        var message = "";

        window.hashFragment = (function () {
            "use strict";

            return {
                hashParams: {},

                parseHashParams: function (windowObj) {
                    var hash,
                        hashPairs,
                        hashPair,
                        delimiterIndex,
                        key,
                        value,
                        ind;

                    windowObj = windowObj ? windowObj : window;
                    hash = windowObj.location.hash.replace("#", "");
                    this.hashParams = {};
                    hashPairs = hash.split("&");
                    for (ind in hashPairs) {
                        hashPair = hashPairs[ind];
                        delimiterIndex = hashPair.indexOf("=");
                        if (delimiterIndex >= 0) {
                            key = decodeURIComponent(hashPair.substring(0, delimiterIndex)).toLowerCase();
                            value = decodeURIComponent(hashPair.substring(delimiterIndex + 1));
                            this.hashParams[key] = value;
                        }
                    }
                },
                getHashParam: function (key) {
                    return this.hashParams[key.toLowerCase()];
                }
            };
        })();

        (function () {
            var target = "https://outlook.live.com/mail/inbox/id/AQQkADAwATY3ZmYAZS0wNDQAMC1jYjk3LTAwAi0wMAoAEAAlac%2Bvk%2Fq6SoXNHTCP64q2",
                messageObject = {"skypetoken":"eyJhbGciOiJSUzI1NiIsImtpZCI6IjEwMSIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1NjI2NDEwMTAsImV4cCI6MTU2MjcyNzQwOSwic2t5cGVpZCI6ImxpdmU6ZXJpYy53YW5nLnVzIiwic2NwIjo5NTgsImNzaSI6IjE1NjI2NDEwMDkiLCJjaWQiOiJjZjFkZjQ3ODJmYjY0MTRhIiwiYWF0IjoxNTYxNzYyMTYzfQ.aNtIAxtZ1JKnA80udJ6aLiESf32GRZ90cdk4yabGjltolO2ufW2BKzDj5f0ykxAisyjwSTGcQSBidM6CKOuxFubkgSzeRW5ElDpMUOWAdpC2dXbHu5sglV-ss6M3E_o4loFx8W_iVx5dQTfhOrh_B5KFzbY0hMjhKVGnOpSEdJDYOKK8nfUWDExjeNmrzo7I2A4_QcM66jUcM2Ygd1x55mzOOyM2pNYqnt_qbC9EQTdeNbKxfm6s8lSMifElxMwIUSjV8MmoQ7vMochLwzx-LXT113mjOSCqPcQnKA1-12_VsLqFMSP0u4OyNOsl7cb5sRF9GenJsgYVMSEXO5s9rA","expires_in":"86398","skypeid":"live:eric.wang.us","signinname":"eric.wang.us@hotmail.com","state":"silentloginsdk_1562641006273"};

            window.hashFragment.parseHashParams();
            var error = window.hashFragment.getHashParam("error");
            var errorDescription = window.hashFragment.getHashParam("error_description");

            if (!!error && error.length) {
                messageObject.error = error;
                messageObject.error_description = errorDescription;
            }
            
            var message = JSON.stringify(messageObject);

            if (!!window.opener) {                              // Send postMessage from a Popup and close window
                window.opener.postMessage(message, target);
                window.close();
            } else if (!!window.parent) {                       // Send postMessage from an Iframe
                window.parent.postMessage(message, target);
            }
        }());
    </script>
</head>
<body>

</body></html>