self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.567.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[567],{1130:function(e,t,n){"use strict";var r=n(306),a=n(7);t.a=Object(a.select)({loadedConversationState:function(){return r.a.conversationReadingPaneViewState}})(Object(a.action)("expandItemPartOnIsReadChanged")(function(e,t,n){var r=n.loadedConversationState?n.loadedConversationState.conversationId:null;r&&r.Id==e&&t.forEach(function(e){var t=n.loadedConversationState.itemPartsMap.get(e);t&&t.isLocal&&(t.isExpanded=!0)})}))},11747:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(13),i=n(1087),o=n(72),c=n(298),d=n(1),s=Object(d.mutatorAction)("removeSingleItemFromConversation",function(e,t){var n,i,c=o.a.tableViews.get(t),d=Object(a.B)([e.itemConversationId.Id],c);try{for(var s=r.__values(d),l=s.next();!l.done;l=s.next()){u(l.value,e,t)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}});function u(e,t,n){var r=Object(i.a)(t.itemConversationId.Id),a=Object(c.a)(e,n),o=a.itemIds.indexOf(t.itemId);o>=0&&(a.itemIds.splice(o,1),t.isRead||a.unreadCount--),(o=r.globalItemIds.indexOf(t.itemId))>=0&&(r.globalItemIds.splice(o,1),t.isRead||r.globalUnreadCount--),(o=a.draftItemIds.indexOf(t.itemId))>=0&&a.draftItemIds.splice(o,1)}var l=n(1522),f=n(304),v=n(923),m=n(3),b=n(1777),I=Object(m.e)(v.a,"clone_deleteItemsStoreUpdate",function(e){var t,n,a=e.itemContexts[0],i=Object(l.a)(a&&a.mailboxInfo,e.parentFolderId,!0);try{for(var o=r.__values(i),c=o.next();!c.done;c=o.next()){var d=c.value;1==d.tableQuery.listViewType?O(e.itemContexts,d):0==d.tableQuery.listViewType&&w(e.itemContexts,d)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}});function O(e,t){var n=e.map(function(e){return e.itemId}),r=Object(a.B)(n,t),i=r.filter(function(e){return t.rowKeys.indexOf(e)>=0});0!=i.length&&(Object(b.a)(i,t),y(t,r))}function w(e,t){var n,i,o,d;try{for(var u=r.__values(e),l=u.next();!l.done;l=u.next()){var f=l.value,v=Object(a.B)([f.itemConversationId.Id],t);try{for(var m=(o=void 0,r.__values(v)),I=m.next();!I.done;I=m.next()){var O=I.value,w=Object(c.a)(O,t.id);w&&(1==w.itemIds.length&&w.itemIds[0]==f.itemId?(Object(b.a)([O],t),y(t,[O])):s(f,t.id))}}catch(e){o={error:e}}finally{try{I&&!I.done&&(d=m.return)&&d.call(m)}finally{if(o)throw o.error}}}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}function y(e,t){0!==e.tableQuery.type&&2!==e.tableQuery.type||f.a.add(t,e.serverFolderId,3)}var j=n(1795),p=n(2784),g=n(281),h=n(2252),S=Object(m.e)(g.f,"clone_mailListItemExpansionOrchestrator",function(e){var t=Object(o.b)().expandedConversationViewState,n=t.selectedNodeIds;n&&-1!=n.indexOf(e.nodeId)||g.q(t.expandedRowKey,e.nodeId,e.allNodeIds,e.tableViewId),Object(j.b)(e.contextMenuAnchor,h.a.All,p.a.MailListItemPart)}),R=n(1192),V=n(1999),C=n(138),P=n(895),x=n(268),T=n(322),_=n(607),B=n(147),F=n(7);var M=Object(F.select)({tableViews:function(){return a.O.tableViews}})(function(e,t,n,r,i){var o=i.tableViews.get(t);0===o.tableQuery.type&&(f.a.add(e,o.serverFolderId,1),function(e,t){var n=e[e.length-1];if(t.selectedRowKeys.has(n)){var r=t.rowKeys.indexOf(n);r<t.rowKeys.length-1?Object(C.l)(t,t.rowKeys[r+1],!1,B.a.RowRemoval):Object(C.h)(t,B.a.Reset)}}(e,o)),Object(a.z)(e,t).forEach(function(e){i.tableViews.forEach(function(i){i.tableQuery.folderId==o.tableQuery.folderId&&Object(a.B)([e],i).forEach(function(e){(r(e,i.id,n),0===i.tableQuery.type)&&(function(e,t,n,r,a){var i,o=Object(R.a)(r,n);if(o<0)throw new Error("Row being pinned / unpinnned must exist in the list");var c=a?0:o+1;return o<(i=!a&&Object(_.e)(r,n.id)?Object(x.f)(n,c):Object(V.a)(e,t,n,c,!a))&&i--,-1==i?(Object(P.a)([r],n),!1):(T.a.updateRowPosition(i,r,n),!0)}(a.b.getLastDeliveryOrRenewTimeStamp(e,i),a.b.getLastDeliveryTimeStamp(e,i),i,e,n)||i.id!=t||f.a.add([e],o.serverFolderId,3))})})})}),A=n(1749),U=n(508),L=Object(m.e)(A.a,"clone_markConversationsAsPinnedStoreUpdate",function(e){var t=e.rowKeys,n=e.tableViewId,r=e.shouldMarkAsPinned;M(t,n,r,k)});function k(e,t,n){var r=Object(c.a)(e,t);if(r)if(n){var a=Object(U.d)();a&&(r.lastDeliveryOrRenewTimeStamp=a)}else r.lastDeliveryOrRenewTimeStamp=r.lastDeliveryTimeStamp}var E=n(2006),N=n(1279),Q=Object(m.e)(N.a,"clone_markConversationAsReadStoreUpdate",function(e){var t=e.conversationIds,n=e.tableViewId,r=e.isReadValue,i=e.isExplicit,o=a.O.tableViews.get(n),c=Object(a.B)(t,o);Object(E.a)(c,r,o,!0),Object(a.Q)(o,r,i)?(f.a.add(c,o.serverFolderId,3),Object(P.a)(c,o)):f.a.add(c,o.serverFolderId,2)}),z=n(1748),D=n(31),K=Object(m.e)(z.a,"clone_markItemsAsPinnedStoreUpdate",function(e){var t=e.rowKeys,n=e.tableViewId,r=e.shouldMarkAsPinned;M(t,n,r,q)});function q(e,t,n){var r=Object(a.G)(e,t);if(r){var i=D.H.items.get(r.clientId.Id);if(n){var o=Object(U.d)();o&&(i.ReceivedOrRenewTime=o)}else i.ReceivedOrRenewTime=i.DateTimeReceived}}var G=n(2007),H=n(1280),$=Object(m.e)(H.a,"clone_markItemsAsReadStoreUpdateOrchestrator",function(e){var t=e.itemIds,n=e.isReadValue,r=e.isExplicit,i=e.tableViewId,o=a.O.tableViews.get(i);if(o){Object(G.a)(o,t,n);var c=[],d=Object(a.Q)(o,n,r);1==o.tableQuery.listViewType?c=Object(a.B)(t,o):t.forEach(function(e){var t=D.H.items.get(e).ConversationId.Id,n=Object(a.B)([t],o);n.forEach(function(e){var t=Object(a.F)(e,i);d&&0!=t.unreadCount||n.push(e)})}),0!=c.length&&(d?(f.a.add(c,o.serverFolderId,3),Object(P.a)(c,o)):f.a.add(c,o.serverFolderId,2))}}),J=n(1257),W=n(225),X=n(383),Y=n(263),Z=n(422),ee=n(1996),te=n(437),ne=n(21),re=Object(m.e)(ee.a,"clone_onListViewTypeOptionSavedOrchestrator",function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,a,i,o;return r.__generator(this,function(r){if(t=e.newListViewType,n=Object(X.a)().tableQuery,a=Object(te.a)(),i=a&&a.treeType,1===n.type||i===ne.c||i===ne.j)return[2];switch(o=2===n.type?Object(J.a)(n.folderId,t):Object(W.c)(n.folderId,t,n.scenarioType,n.focusedViewFilter,n.viewFilter,n.categoryName,n.sortBy,n.inboxClassificationFilter),Object(Z.d)(o),t){case 0:Y.p.itemReadingPaneViewState=null;break;case 1:Y.p.conversationReadingPaneViewState=null}return[2]})})}),ae=n(1521),ie=n(234),oe=Object(m.e)(ie.p,"clone_removeSearchTableFromStore",function(e){Object(ae.a)(e.tableViewId)});n.d(t,"deleteItemsStoreUpdateOrchestrator",function(){return I}),n.d(t,"mailListItemExpansionOrchestrators",function(){return S}),n.d(t,"markConversationsAsPinnedStoreUpdateOrchestrator",function(){return L}),n.d(t,"markConversationsAsReadStoreUpdateOrchestrator",function(){return Q}),n.d(t,"markItemsAsPinnedStoreUpdateOrchestrator",function(){return K}),n.d(t,"markItemsAsReadStoreUpdateOrchestrator",function(){return $}),n.d(t,"onListViewTypeOptionSavedOrchestrator",function(){return re}),n.d(t,"removeSearchTableFromStoreOrchestrator",function(){return oe})},1257:function(e,t,n){"use strict";var r=n(13),a=n(31);function i(e,t){var n;switch(t){case 0:n=a.c;break;case 1:n=Object(a.q)()}return{categoryName:null,folderId:e,focusedViewFilter:-1,listViewType:t,viewFilter:"All",sortBy:r.c.getDefaultSortBy(),requestShapeName:n,type:2,shouldTryToUseSessionDataResponse:!1,scenarioType:"group",inboxClassificationFilter:0}}var o=n(9);function c(){var e=Object(o.a)().UserOptions.GlobalListViewTypeReact;return null==e?0:e}n.d(t,"a",function(){return i}),n.d(t,"b",function(){return c})},1463:function(e,t,n){"use strict";var r=n(306),a=n(7);t.a=Object(a.action)("setItemReadingPaneViewState")(function(e){r.a.itemReadingPaneViewState=e})},1465:function(e,t,n){"use strict";var r=n(306),a=n(7);t.a=Object(a.action)("setItemPrintPaneViewState")(function(e){r.a.itemPrintPaneViewState=e})},1650:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=Object(r.action)("loadFullBody",function(e){return{viewState:e}})},1651:function(e,t,n){"use strict";var r=n(0),a=n(1130),i=n(306),o=n(73),c=n(7);t.a=Object(c.action)("markConversationsReadInReadingPane")(Object(c.select)({conversations:function(){return o.a.conversations},conversationNodes:function(){return o.a.conversationNodes},items:function(){return o.a.items},loadedConversationId:function(){return i.a.conversationReadingPaneViewState&&i.a.conversationReadingPaneViewState.conversationId}})(function(e,t,n,i){var o=[];e.forEach(function(e){var a,c,d,s;if(i.conversations.has(e)){var u=i.conversations.get(e);try{for(var l=r.__values(u.conversationNodeIds),f=l.next();!f.done;f=l.next()){var v=f.value,m=i.conversationNodes.get(v);if(m){var b=!1;try{for(var I=(d=void 0,r.__values(m.itemIds)),O=I.next();!O.done;O=I.next()){var w=O.value,y=i.items.get(w);!y||y.ConversationId.Id!=e||null!=n&&y.ParentFolderId.Id!=n||(i.loadedConversationId&&i.loadedConversationId.Id==e&&(b=b||y.IsRead&&!t),y.IsRead=t)}}catch(e){d={error:e}}finally{try{O&&!O.done&&(s=I.return)&&s.call(I)}finally{if(d)throw d.error}}b&&o.push(v)}}}catch(e){a={error:e}}finally{try{f&&!f.done&&(c=l.return)&&c.call(l)}finally{if(a)throw a.error}}}}),o.length>0&&Object(a.a)(e[0],o)}))},1652:function(e,t,n){"use strict";var r=n(1130),a=n(73),i=n(7);t.a=Object(i.action)("markItemReadInReadingPane")(Object(i.select)({message:function(e){return a.a.items.get(e)}})(function(e,t,n){n.message.IsRead&&!t&&n.message.ConversationId&&Object(r.a)(n.message.ConversationId.Id,[n.message.InternetMessageId]),n.message.IsRead=t}))},1795:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(72),a=n(7),i=Object(a.action)("showMailItemContextMenu")(Object(a.select)({listViewStore:function(){return r.a}})(function(e,t,n,r){r.listViewStore.itemContextMenuState={anchor:e,menuType:t,menuSource:n}})),o=Object(a.action)("hideMailItemContextMenu")(Object(a.select)({listViewStore:function(){return r.a}})(function(e){e.listViewStore.itemContextMenuState=null}))},2252:function(e,t,n){"use strict";var r;!function(e){e[e.All=0]="All",e[e.MoveTo=1]="MoveTo",e[e.Categorize=2]="Categorize"}(r||(r={})),t.a=r},263:function(e,t,n){"use strict";var r=n(0),a=n(923),i=n(1),o=(Object(i.orchestrator)(a.a,function(e){var t,n,a=e.itemContexts;try{for(var i=r.__values(a),o=i.next();!o.done;o=i.next()){var c=o.value;V.importAndExecute({Id:c.itemId},c.itemConversationId)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}),n(1650)),c=Object(i.mutatorAction)("updateIsLoadingFullBody",function(e,t){e.isLoadingFullBody=t}),d=Object(i.mutatorAction)("updateCachedItemBodies",function(e,t){t.UniqueBody&&(e.UniqueBody=t.UniqueBody),t.NormalizedBody&&(e.NormalizedBody=t.NormalizedBody)}),s=n(661),u=n(660),l=n(73),f=n(658),v=n(57),m=n.n(v),b=(Object(i.orchestrator)(o.a,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,a,i,o,v,b;return r.__generator(this,function(r){switch(r.label){case 0:return t=e.viewState,n=t.itemId,c(t,!0),a=l.a.items.get(n),i=Object(f.a)(),o="ItemPart",a.UniqueBody?a.NormalizedBody&&i.AdditionalProperties.push(m()({FieldURI:"NormalizedBody"})):o="ItemNormalizedBody",i.MaximumBodySize=0,[4,Object(s.a)([n],i,o)];case 1:return v=r.sent(),l.a.items.get(n)&&Object(u.a)(v[0])&&(b=v[0],d(a,b.Items[0]),c(t,!1)),[2]}})})}),n(1651)),I=n(1279),O=n(13),w=(Object(i.orchestrator)(I.a,function(e){var t=e.conversationIds,n=e.tableViewId,r=e.isReadValue;Object(b.a)(t,r,Object(O.o)(n))}),n(1652)),y=n(1280),j=(Object(i.orchestrator)(y.a,function(e){var t=e.itemIds,n=e.isReadValue;t.forEach(function(e){return Object(w.a)(e,n)})}),n(3)),p=(n(1463),n(1465),n(306));n.d(t,"f",function(){return h}),n.d(t,"a",function(){return S}),n.d(t,"n",function(){return R}),n.d(t,"b",function(){return V}),n.d(t,"o",function(){return C}),n.d(t,"j",function(){return P}),n.d(t,"g",function(){return x}),n.d(t,"k",function(){return T}),n.d(t,"m",function(){return _}),n.d(t,"h",function(){return B}),n.d(t,"i",function(){return F}),n.d(t,"d",function(){return A}),n.d(t,"e",function(){return U}),n.d(t,"l",function(){return L}),n.d(t,"c",function(){return k}),n.d(t,"p",function(){return p.a});var g=new j.c(function(){return Promise.all([n.e(4),n.e(7),n.e(8),n.e(19),n.e(336)]).then(n.bind(null,11676))}),h=new j.a(g,function(e){return e.loadConversationReadingPane}),S=(new j.a(g,function(e){return e.reloadReadingPane}),new j.a(g,function(e){return e.applyConversationFlagInReadingPane})),R=new j.a(g,function(e){return e.updateLoadedConversation}),V=new j.a(g,function(e){return e.cleanUpItemClientSide}),C=new j.a(g,function(e){return e.updateOnItemMandatoryPropertiesChange}),P=new j.a(g,function(e){return e.moveReadingPaneToTab}),x=new j.a(g,function(e){return e.loadConversationReadingPaneForSingleMailItemSelected}),T=new j.a(g,function(e){return e.print}),_=new j.a(g,function(e){return e.setItemIdToScrollTo}),B=new j.a(g,function(e){return e.loadItemReadingPane}),F=new j.a(g,function(e){return e.loadItemReadingPaneForSingleMailItemSelected}),M=new j.a(g,function(e){return e.initializeStitches}),A=new j.b(g,function(e){return e.getLastestNonDraftItemId}),U=new j.b(g,function(e){return e.isUnsupportedItem}),L=(new j.a(g,function(e){return e.setCalendarInlineComposeViewState}),new j.a(g,function(e){return e.replyByMeeting})),k=new j.a(g,function(e){return e.clearReadingPaneStore});M.importAndExecute()},2784:function(e,t,n){"use strict";var r;!function(e){e[e.MailListItem=0]="MailListItem",e[e.MailListItemPart=1]="MailListItemPart"}(r||(r={})),t.a=r},306:function(e,t,n){"use strict";n.d(t,"b",function(){return i});var r=n(664),a=n(1),i=Object(a.createStore)("readingpane",{conversationReadingPaneViewState:null,floatingActionBarViewState:{isVisible:!1,itemId:""},itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null}),o=i();r.a.registerReference(function(){return o.conversationReadingPaneViewState&&o.conversationReadingPaneViewState.conversationId.Id}),t.a=o}},0,[4,7,8,19,336,0,1,30,474,155,292,11,513,354,2,6,9,107,3,5,288,12,37,103,463,87,464,98,498,299,195,287,445,447]]);
//# sourceMappingURL=owa.567.js.map
self.scriptsLoaded['owa.567.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.567.js'] = (new Date()).getTime();