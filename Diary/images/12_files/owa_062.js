self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SharingAccept.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[366],{11015:function(e){e.exports={a:"v3b"}},11016:function(e){e.exports={a:"s3b",b:"t3b",c:"u3b"}},11017:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),a=n(11018);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("AcceptSharedCalendarInvite",e,t)}},11018:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"AcceptSharedCalendarInviteJsonRequest:#Exchange"},e)}},11019:function(e,t,n){var r=n(11020),a=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var c=0;c<r.length;c++)a.loadStyles(r[c][1],!1);r.locals&&(e.exports=r.locals)},11020:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,"._1HzDhXErSwdC9-EzTRYHFr{display:inline-block}html[dir=ltr] ._1HzDhXErSwdC9-EzTRYHFr{padding-right:10px}html[dir=rtl] ._1HzDhXErSwdC9-EzTRYHFr{padding-left:10px}",""]),t.locals={spinner:"_1HzDhXErSwdC9-EzTRYHFr"}},11777:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(70),c=n(0),i=n(11015),s=n(4),o=n(5558),u=n(2515),d=n(1452),l=n(11016);function p(e){switch(e){case o.b:return Object(s.a)(l.a);case o.c:return Object(s.a)(l.b);case o.g:return Object(s.a)(l.c);default:return Object(s.a)(l.a)}}var f=n(1709),m=n(227),C=n(7769),E=n(11017),b=n.n(E),S=n(29);var A=n(45),h=n(926),v=n(7),O=Object(v.action)("acceptInvite")(function(e){return(t=e,b()({Header:Object(S.getJsonRequestHeader)(),Body:{MessageId:t}}).then(function(e){return e.Body})).then(function(e){return"Success"==e.ResponseClass&&e.NewCalendarEntryId&&Object(h.a)(e.NewCalendarEntryId.Id,Object(A.d)()),new Promise(function(t){t("Success"==e.ResponseClass)})}).catch(function(){return Promise.reject("[acceptSharedCalendarInvite] failed")});var t}),_=n(5),j=n(41),y=n(22),g=n(9),I=Object(v.action)("showCalendar")(function(e){var t=Object(g.a)().UserOptions,n=Object(_.d)("cal-react")||t&&t.ReactOptinSettings&&t.ReactOptinSettings.CalendarEnabled?Object(y.a)().href.replace(Object(y.a)().hash,"").replace(Object(y.a)().pathname,Object(j.e)()):Object(j.o)({path:"/calendar"});return e.open(n,"_self"),Promise.resolve()}),w=n(20),D=n(11019),R=function(e){function t(t){var n=e.call(this,t)||this;return n.onAcceptButtonClicked=function(e){n.setState({isLoading:!0}),O(n.props.item.ItemId).then(function(e){n.setState({isLoading:!1,successfulAccept:e})}).catch(function(){n.setState({isLoading:!1,successfulAccept:!1})})},n.onViewCalendarButtonClicked=function(e){var t=window.open();I(t)},n.state={isLoading:!1,successfulAccept:!1},n}return c.__extends(t,e),t.prototype.render=function(){var e=this.props.item,t=Object(C.a)(e);return this.renderActionButton(t)},t.prototype.renderActionButton=function(e){if(!e)return null;if(this.state.isLoading)return r.createElement("div",null,r.createElement(f.a,{className:D.spinner,size:m.a.small}),r.createElement("span",null,Object(s.a)(i.a)));var t=e.Importance===o.d;if(this.state.successfulAccept){var n=p(o.g);return t?r.createElement(u.a,{text:n,onClick:this.onViewCalendarButtonClicked}):r.createElement(d.a,{text:n,onClick:this.onViewCalendarButtonClicked})}n=p(this.state.successfulAccept?o.g:e.Action);return e.Importance===o.d?r.createElement(u.a,{text:n,onClick:this.onAcceptButtonClicked}):r.createElement(d.a,{text:n,onClick:this.onAcceptButtonClicked})},t=c.__decorate([w.observer],t)}(r.Component);function T(e,t){var n=r.createElement(R,{item:t});a.render(n,e,null),e.className=""}function L(e){a.unmountComponentAtNode(e)}n.d(t,"addInteractiveElementsForReadingPane",function(){return T}),n.d(t,"removeInteractiveElementsForReadingPane",function(){return L}),n.d(t,"SharingAcceptButton",function(){return R})},2515:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(0),a=n(2),c=n(131),i=n(801),s=n(1452),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._skipComponentRefResolution=!0,t}return r.__extends(t,e),t.prototype.render=function(){return a.createElement(s.a,r.__assign({},this.props,{primary:!0,onRenderDescription:c.b}))},t=r.__decorate([Object(i.a)("PrimaryButton",["theme","styles"],!0)],t)}(c.a)},675:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(3),a=new r.c(function(){return n.e(405).then(n.bind(null,2196))}),c=new r.a(a,function(e){return e.updateUserConfigurationService})},926:function(e,t,n){"use strict";var r=n(1),a=Object(r.action)("UPDATE_SELECTED_CALENDARS_IN_STORE",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),c=Object(r.action)("ADD_SELECTED_CALENDAR_IN_STORE",function(e,t){return{calendarId:e,primarySmtpAddress:t}}),i={selectedCalendars:new(n(8).ObservableMap)},s=Object(r.createStore)("selectedCalendarsStore",i);Object(r.mutator)(a,function(e){var t=e.calendarIds,n=e.primarySmtpAddress;s().selectedCalendars.set(n,t)}),Object(r.mutator)(c,function(e){var t=e.calendarId,n=e.primarySmtpAddress,r=s().selectedCalendars.get(n);r&&r.indexOf(t)<0&&r.push(t)});var o,u=Object(r.action)("UPDATE_SELECTED_CALENDARS",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),d=Object(r.action)("ADD_SELECTED_CALENDAR",function(e,t){return{calendarId:e,primarySmtpAddress:t}}),l=(Object(r.action)("INITIALIZE_SELECTED_CALENDARS",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),Object(r.action)("SELECTED_CALENDARS_UPDATED",function(e,t){return{calendarIds:e,primarySmtpAddress:t}})),p=n(45),f=n(12),m=n(675),C="OWA.ViewStateConfiguration",E=5e3,b=null;function S(e,t){var n=Object(p.e)(t);(o=e)&&(b||(b=setTimeout(function(){b=null,m.a.importAndExecute(C,{Type:"String",Value:["SelectedCalendarsDesktop"]},{Type:"StringArray",Value:o},n).catch(function(e){f.c.warn("Could not save new selected calendars list to user configuration")})},E)))}function A(e){return s().selectedCalendars.get(e)}Object(r.orchestrator)(u,function(e){var t=e.calendarIds,n=e.primarySmtpAddress;a(t,n),l(t,n),S(t,n)}),Object(r.orchestrator)(d,function(e){var t=e.calendarId,n=e.primarySmtpAddress;c(t,n);var r=A(n);l(r,n),S(r,n)});var h=n(27);Object(r.mutator)(h.r,function(e){var t=e.userConfiguration,n=e.primarySmtpAddress;s().selectedCalendars.set(n||Object(p.e)().primarySmtpAddress,t.ViewStateConfiguration.SelectedCalendarsDesktop)}),n.d(t,"d",function(){return u}),n.d(t,"a",function(){return d}),n.d(t,"c",function(){return l}),n.d(t,"b",function(){return A})}}]);
//# sourceMappingURL=owa.SharingAccept.js.map
self.scriptsLoaded['owa.SharingAccept.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SharingAccept.js'] = (new Date()).getTime();