self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.CalendarCard~InAppNotifications~RSVPPeek~TimePanel~UpNextV2.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[23],{100:function(e,n,t){"use strict";var r=t(52),a={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,SecondsInOneMinute:60,DaysInOneWeek:7,AllDaysOfWeek:[r.b.Sunday,r.b.Monday,r.b.Tuesday,r.b.Wednesday,r.b.Thursday,r.b.Friday,r.b.Saturday]};n.a=a},1145:function(e,n,t){"use strict";t.d(n,"g",function(){return o}),t.d(n,"f",function(){return c}),t.d(n,"k",function(){return d}),t.d(n,"c",function(){return u}),t.d(n,"d",function(){return s}),t.d(n,"n",function(){return l}),t.d(n,"l",function(){return f}),t.d(n,"m",function(){return v}),t.d(n,"a",function(){return p}),t.d(n,"h",function(){return I}),t.d(n,"b",function(){return _}),t.d(n,"e",function(){return b}),t.d(n,"j",function(){return m}),t.d(n,"i",function(){return y}),t.d(n,"o",function(){return g});var r=t(100),a=t(52),i=t(6);function o(e,n){return void 0===n&&(n=Object(i.Db)()),u(Object(i.Ob)(n,e),r.a.DaysInOneWeek)}function c(e,n){var t=d(e,n),r=Object(i.w)(e),a=Object(i.a)(Object(i.x)(r,n),1);return u(t,Math.abs(Object(i.n)(t,a)-1))}function d(e,n){var t=Object(i.Nb)(e);return Object(i.Ob)(t,n)}function u(e,n){return{start:e,end:Object(i.a)(e,n-1)}}function s(e,n,t,r){switch(e){case a.a.Day:return u(Object(i.Kb)(n),1);case a.a.Month:var c=Object(i.Nb)(n),d=Object(i.w)(n);return u(c,Math.abs(Object(i.n)(c,d)-1));case a.a.Week:return o(t,n);case a.a.WorkWeek:return function(e,n,t){void 0===t&&(t=Object(i.Db)());for(var r,a,c=o(e,t),d=0;d<=m(c);d++){var u=Object(i.a)(c.start,d);if(!r&&n.includes(Object(i.eb)(u))&&(r=u),u=Object(i.a)(c.end,-d),!a&&n.includes(Object(i.eb)(u))&&(a=u),r&&a)break}return{start:r,end:a}}(t,r,n)}}function l(e,n){var t=c(e,n);return Object(i.o)(t.end,t.start,n)}function f(e,n){var t;return u(t=n==a.a.WorkWeek?Object(i.g)(e.start,1):Object(i.a)(e.end,1),n==a.a.Month?Object(i.fb)(t):Object(i.n)(e.end,e.start)+1)}function v(e,n){var t,r;if(n==a.a.WorkWeek)t=Object(i.g)(e.start,-1),r=Object(i.g)(e.end,-1);else{r=Object(i.a)(e.start,-1);var o=n==a.a.Month?-Object(i.fb)(r):Object(i.n)(e.start,e.end)-1;t=Object(i.a)(e.start,o)}return{start:t,end:r}}function p(e,n){return e&&n&&0==Object(i.l)(e.start,n.start)&&0==Object(i.l)(e.end,n.end)}function I(e,n,t){if(!e||!n)throw new Error("Date ranges cannot be null in call to areDateRangesOverlapping");return t?Object(i.l)(e.start,n.start)<=0?Object(i.l)(e.end,n.start)>=0?0:1:Object(i.l)(n.end,e.start)>=0?0:-1:Object(i.l)(e.start,n.start)<0?Object(i.l)(e.end,n.start)>0?0:1:Object(i.l)(n.end,e.start)>0?0:-1}function _(e,n,t){return!(!e||!n)&&(t?Object(i.l)(e.start,n.start)<=0&&Object(i.l)(e.end,n.end)>=0:Object(i.l)(e.start,n.start)<0&&Object(i.l)(e.end,n.end)>0)}function b(e,n){return e&&n?{start:Object(i.l)(e.start,n.start)<0?e.start:n.start,end:Object(i.l)(e.end,n.end)>0?e.end:n.end}:null}function m(e){return Object(i.n)(e.end,e.start)}function y(e){return Math.floor(Object(i.q)(e.end,e.start)/24)+(Object(i.q)(e.end,e.start)%24>0?1:0)}function g(e,n){return Object(i.n)(e.start,n)<=0&&Object(i.n)(e.end,n)>=0}},1149:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(6),a=t(852);function i(e,n,t,i){var o=Object(a.a)(n,t,i);return Object(r.tb)(e,o)&&(o=Object(r.Eb)(n,e)),{start:e,end:o}}},1182:function(e,n,t){"use strict";t.d(n,"a",function(){return a}),t.d(n,"e",function(){return i}),t.d(n,"i",function(){return o}),t.d(n,"b",function(){return c}),t.d(n,"c",function(){return d}),t.d(n,"f",function(){return u}),t.d(n,"g",function(){return s}),t.d(n,"d",function(){return l}),t.d(n,"h",function(){return f});var r=t(527);function a(e){return e?l(e)?r.e:f(e)?r.A:u(e)?r.r:c(e)?r.a:s(e)?r.t:d(e)?r.c:r.p:r.p}function i(e){return c(e)||u(e)}function o(e){return d(e)||s(e)}function c(e){return e&&e.RecurrencePattern&&e.RecurrencePattern.__type==r.b}function d(e){return e&&e.RecurrencePattern&&e.RecurrencePattern.__type==r.d}function u(e){return e&&e.RecurrencePattern&&e.RecurrencePattern.__type==r.s}function s(e){return e&&e.RecurrencePattern&&e.RecurrencePattern.__type==r.u}function l(e){return e&&e.RecurrencePattern&&e.RecurrencePattern.__type==r.f}function f(e){return e&&e.RecurrencePattern&&e.RecurrencePattern.__type==r.B}},1301:function(e,n,t){"use strict";var r=t(948);t(1935);function a(e){var n=[];return e&&"string"!=typeof e&&n.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress}),n}var i=t(9),o=t(74),c="en-us",d={"am-et":"a_c_pc_pr_ctry","ar-dz":"a_pc_c_pr_ctry","ar-bh":"a_pc_c_pr_ctry","ar-eg":"a_ctry_c_pr_pc","ar-iq":"a_pc_c_pr_ctry","ar-jo":"a_c_pc_pr_ctry","ar-kw":"a_pc_c_pr_ctry","ar-lb":"a_c_pc_pr_ctry","ar-ly":"a_pc_c_pr_ctry","ar-ma":"a_pc_c_pr_ctry","ar-om":"a_c_pr_ctry_pc","ar-qa":"a_pc_c_pr_ctry","ar-sa":"a_c_pc_pr_ctry","ar-sy":"a_pc_c_pr_ctry","ar-tn":"a_pc_c_pr_ctry","ar-ae":"a_pc_c_pr_ctry","ar-ye":"a_pc_c_pr_ctry","eu-es":"a_pc_c_pr_ctry","bn-in":"a_c_pc_pr_ctry","bg-bg":"a_pc_c_pr_ctry","ca-es":"a_pc_c_pr_ctry","zh-cn":"pc_ctry_pr_c_a","zh-sg":"a_c_pc_pr_ctry","zh-hk":"ctry_pc_pr_c_a","zh-mo":"ctry_pr_c_pc_a","zh-tw":"pc_ctry_pr_c_a","hr-hr":"a_pc_c_pr_ctry","cs-cz":"a_pc_c_pr_ctry","da-dk":"a_pc_c_pr_ctry","nl-be":"a_pc_c_pr_ctry","nl-nl":"a_pc_c_pr_ctry","en-au":"a_c_pc_pr_ctry","en-bz":"a_pc_c_pr_ctry","en-ca":"a_c_pc_pr_ctry","en-ie":"a_c_pc_pr_ctry","en-jm":"a_pc_c_pr_ctry","en-nz":"a_c_pc_pr_ctry","en-ph":"a_pc_pr_c_ctry","en-za":"a_c_pc_pr_ctry","en-tt":"a_pc_c_pr_ctry","en-gb":"a_c_pc_pr_ctry","en-us":"a_c_pr_pc_ctry","en-zw":"a_pc_c_pr_ctry","et-ee":"a_pc_c_pr_ctry","fil-ph":"a_pc_pr_c_ctry","fi-fi":"a_pc_c_pr_ctry","fr-be":"a_pc_c_pr_ctry","fr-ca":"a_c_pc_pr_ctry","fr-fr":"a_pc_c_pr_ctry","fr-lu":"a_pc_c_pr_ctry","fr-mc":"a_pc_c_pr_ctry","fr-ch":"a_pc_c_pr_ctry","gl-es":"a_pc_c_pr_ctry","de-at":"a_pc_c_pr_ctry","de-de":"a_pc_c_pr_ctry","de-li":"a_pc_c_pr_ctry","de-lu":"a_pc_c_pr_ctry","de-ch":"a_pc_c_pr_ctry","el-gr":"a_pc_c_pr_ctry","gu-in":"a_c_pc_pr_ctry","he-il":"a_pc_c_pr_ctry","hi-in":"a_c_pc_pr_ctry","hu-hu":"c_a_pc_pr_ctry","is-is":"a_pc_c_pr_ctry","id-id":"a_c_pc_pr_ctry","it-it":"a_pc_c_pr_ctry","it-ch":"a_pc_c_pr_ctry","ja-jp":"pc_pr_c_a_ctry","kn-in":"a_c_pc_pr_ctry","kk-kz":"ctry_pr_c_pc_a","sw-ke":"a_c_pc_pr_ctry","ko-kr":"pc_pr_c_a_ctry","lv-lv":"a_c_pc_pr_ctry","lt-lt":"a_c_pc_pr_ctry","ms-bn":"a_c_pc_pr_ctry","ms-my":"a_pc_c_pr_ctry","ml-in":"a_c_pc_pr_ctry","mr-in":"a_c_pc_pr_ctry","nb-no":"a_pc_c_pr_ctry","or-in":"a_c_pc_pr_ctry","fa-ir":"a_c_pc_pr_ctry","pl-pl":"a_pc_c_pr_ctry","pt-br":"a_pc_c_pr_ctry","pt-pt":"a_pc_c_pr_ctry","ro-ro":"a_pc_c_pr_ctry","ru-ru":"ctry_pc_pr_c_a","sr-cyrl-cs":"a_pc_c_pr_ctry","sk-sk":"a_pc_c_pr_ctry","sl-si":"a_pc_c_pr_ctry","es-ar":"a_pc_c_pr_ctry","es-bo":"a_pc_c_pr_ctry","es-cl":"a_pc_c_pr_ctry","es-co":"a_pc_c_pr_ctry","es-cr":"a_pc_c_pr_ctry","es-do":"a_pc_c_pr_ctry","es-ec":"a_pc_c_pr_ctry","es-sv":"a_c_pc_pr_ctry","es-gt":"a_pc_c_pr_ctry","es-hn":"a_pc_c_pr_ctry","es-mx":"a_pc_c_pr_ctry","es-ni":"a_c_pc_pr_ctry","es-pa":"a_pc_c_pr_ctry","es-py":"a_pc_c_pr_ctry","es-pe":"a_pc_c_pr_ctry","es-pr":"a_c_pc_pr_ctry","es-es":"a_pc_c_pr_ctry","es-us":"a_c_pc_pr_ctry","es-uy":"a_pc_c_pr_ctry","es-ve":"a_pc_c_pr_ctry","sv-fi":"a_pc_c_pr_ctry","sv-se":"a_pc_c_pr_ctry","ta-in":"a_c_pc_pr_ctry","te-in":"a_c_pc_pr_ctry","th-th":"a_c_pc_pr_ctry","tr-tr":"a_pc_pr_c_ctry","uk-ua":"ctry_pc_pr_c_a","ur-pk":"a_c_pc_pr_ctry","cy-gb":"a_c_pc_pr_ctry"};var u=", ";function s(e,n,t,r,a,i){var c=[];Object(o.b)(e)||(c[c.length]=e);var d="";return Object(o.b)(n)||(d=n),Object(o.b)(t)||(d=Object(o.b)(d)?t:d+i+t),Object(o.b)(r)||(d=Object(o.b)(d)?r:d+i+r),Object(o.b)(d)||(c[c.length]=d),Object(o.b)(a)||(c[c.length]=a),c}function l(e,n,t,r,a){var l=function(){var e=Object(i.a)(),n="";e&&e.SessionSettings&&!Object(o.b)(e.SessionSettings.UserCulture)&&(n=e.SessionSettings.UserCulture.toLowerCase());var t=d[n];return null==t&&(t=d[c]),t}(),f=[],v=u;switch(l){case"a_c_pc_pr_ctry":f=s(e,n,t,r,a,v);break;case"a_c_pr_ctry_pc":f=s(e,n,r,a,t,v);break;case"a_c_pr_pc_ctry":f=s(e,n,r,t,a,v);break;case"a_ctry_c_pr_pc":f=s(e,a,n,r,t,v);break;case"a_pc_c_pr_ctry":f=s(e,t,n,r,a,v);break;case"a_pc_pr_c_ctry":f=s(e,t,r,n,a,v);break;case"c_a_pc_pr_ctry":f=s(n,e,t,r,a,v);break;case"ctry_pc_pr_c_a":f=s(a,t,r,n,e,v);break;case"ctry_pr_c_pc_a":f=s(a,r,n,t,e,v);break;case"pc_ctry_pr_c_a":f=s(t,a,r,n,e,v);break;case"pc_pr_c_a_ctry":f=s(t,r,n,e,a,v)}return f.join(v)}function f(e){return e?l(e.Street,e.City,e.PostalCode,e.State,e.Country):""}function v(e,n){return Object(o.b)(e)?f(n):e}var p=t(4);function I(e,n){var t=f(n);return Object(o.b)(e)?t:""==t?e:Object(p.b)("{0} ({1})",e,f(n))}var _=/\(([^)]*)\)/gi,b=/\([^)]*\)|[\0-\u001F\!-\/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,m=/\s+/gi;function y(e){var n="";if(!e)return n;var t=(e=(e=(e=(e=e.replace(_,"")).replace(b,"")).replace(m," ")).trim()).split(" ");return t.length>=2?(n+=t[0].charAt(0).toUpperCase(),n+=t[t.length-1].charAt(0).toUpperCase()):0!=t.length&&(n+=t[0].charAt(0).toUpperCase()),n}var g=t(17),h=Object.keys(g.a).length/2;function O(e){if(!e)return null;for(var n=0,t=e.length-1;t>=0;t--){var r=e.charCodeAt(t),a=t%8;n^=(r<<a)+(r>>8-a)}return n%h}function E(e){return{personaId:e,displayName:e,postalAddress:{Type:"Business",LocationSource:"None"},displayAddress:"",initials:y(e),textBoyColor:O(e),selectionSource:"ExplicitTyping",personaType:"Unknown",personaControlId:e}}function j(e){if(e){var n=function(e){return e?null!=e.HomeAddressesArray&&e.HomeAddressesArray.length>0?e.HomeAddressesArray[0].Value:null!=e.BusinessAddressesArray&&e.BusinessAddressesArray.length>0?e.BusinessAddressesArray[0].Value:null!=e.OtherAddressesArray&&e.OtherAddressesArray.length>0?e.OtherAddressesArray[0].Value:null:null}(e),t=v(e.DisplayName,n);return"Room"==e.PersonaTypeString&&(n.LocationUri=e.EmailAddress.EmailAddress),{personaId:e.PersonaId&&e.PersonaId.Id,feedbackId:e.FeedbackId,displayName:t,postalAddress:n,emailAddress:e.EmailAddress,displayAddress:f(n),initials:y(t),textBoyColor:O(t),selectionSource:"LocationWell",personaType:Object(o.b)(e.PersonaTypeString)?"Unknown":e.PersonaTypeString,personaControlId:null==e.PersonaId?e.FeedbackId:e.PersonaId.Id,availability:e.Availability,numberOfAvailableTimeSlots:e.NumberOfAvailableTimeSlots,totalNumberOfTimeSlots:e.TotalNumberOfTimeSlots,isPartialAvailability:e.IsPartialAvailability,capacity:e.Capacity}}return null}var C=t(793);function R(e){if(e&&e.DisplayName&&e.PostalAddress){var n=v(e.DisplayName,e.PostalAddress),t=Object(C.a)(e.PostalAddress)&&!Object(o.b)(e.PostalAddress.LocationUri)?{EmailAddress:e.PostalAddress.LocationUri}:null;return{personaId:e.Id,displayName:e.DisplayName,postalAddress:e.PostalAddress,emailAddress:t,displayAddress:f(e.PostalAddress),initials:y(n),textBoyColor:O(n),personaType:Object(C.a)(e.PostalAddress)?"Room":"Unknown",personaControlId:e.DisplayName}}return null}var T=t(0),S=t(2);function A(e,n,t,r){var a=Object(i.a)(),c="",d="",u="";return null!=a&&null!=a.ApplicationSettings&&null!=a.SessionSettings&&null!=a.PolicySettings&&a.PolicySettings.PlacesEnabled&&(c=a.ApplicationSettings.StaticMapUrl,d=a.ApplicationSettings.MapControlKey,u=a.SessionSettings.UserCulture),Object(o.b)(c)||Object(o.b)(d)||Object(o.b)(u)||!e||!n?"":Object(p.b)(c+"?centerPoint={0},{1}&pp={0},{1};51&ms={2},{3}&fmt=png&key={4}&c={5}",e,n,t,r,d,u)}var F=100,w=64,M=64;var N=t(20),k=t(2190),D=t(12),P=t(210),x=function(e){function n(n){var t=e.call(this,n)||this;return t.onCompleteDownload=function(e){t.setState({blobUrl:e}),e?t.requestStatus="success":(t.requestStatus="failed",D.c.warn("getLocationPhoto.downloadLocationPhoto failed"))},t.state={blobUrl:null},t}return T.__extends(n,e),n.prototype.componentDidMount=function(){this.fetchPersonaPhoto(this.props)},n.prototype.componentWillReceiveProps=function(e){this.fetchPersonaPhoto(e)},n.prototype.fetchPersonaPhoto=function(e){e.locationPersona.postalAddress&&e.locationPersona.postalAddress.Latitude&&e.locationPersona.postalAddress.Longitude&&!Object(o.b)(e.locationPersona.displayName)&&!this.state.blobUrl&&"pending"!=this.requestStatus&&"failed"!=this.requestStatus&&(this.requestStatus="pending",function(e,n){var t="";e.postalAddress&&e.postalAddress.Latitude&&e.postalAddress.Longitude&&(t=A(e.postalAddress.Latitude,e.postalAddress.Longitude,w,M));var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="blob",r.onreadystatechange=function(){if(4===r.readyState){var e=null,t=!1;if(200===r.status){e=r.response;var a=r.getResponseHeader("Content-Type");t=a&&0==a.toLowerCase().indexOf("image")&&e instanceof Blob}var i=void 0;t&&e&&e.size>F&&(i=URL.createObjectURL(e)),n(i)}},r.send()}(e.locationPersona,this.onCompleteDownload))},n.prototype.render=function(){var e=this.props,n=e.locationPersona,t=e.className,r=e.size,a=e.showPersonaDetails;if(n){var i={};return Object(o.b)(this.state.blobUrl)?P(i,{imageInitials:n.initials,initialsColor:n.textBoyColor}):P(i,{imageUrl:this.state.blobUrl,imageShouldFadeIn:!1}),S.createElement(k.a,T.__assign({className:t,presence:g.b.none,hidePersonaDetails:!a,size:r,text:n.displayName,secondaryText:n.displayAddress},i))}return null},n=T.__decorate([N.observer],n)}(S.Component),L="https://www.bing.com/maps?v=2&rtp=~pos.{0}_{1}_{2}_{3}",K="https://www.bing.com/maps?v=2&rtp=~adr.{0}_{1}";function U(e,n,t,r){return e&&n?Object(p.b)(L,e.toString(),n.toString(),t,r):t?Object(p.b)(K,t,r):null}var B=t(1514),z=t(109),V=t(505);function G(e){var n=e&&e.accessibleText&&e.accessibleText.msColorWhiteBackground||Object(z.g)().themePrimary,t=e?e.calDarker:Object(z.g)().themeDarker;return Object(V.a)({color:n,cursor:"pointer",selectors:{"&:hover":{color:t},"&:focus":{color:t}}})}var q=t(3);function H(e,n){return{Id:n,DisplayName:e,PostalAddress:{LocationSource:"Resource",LocationUri:n,Type:"Business"}}}function W(e){return{EmailAddress:e.PostalAddress.LocationUri,Name:e.DisplayName}}function Z(e){return{Id:e,DisplayName:e,PostalAddress:{Type:"Business",LocationSource:"None"}}}function J(e,n,t,r){return e?{PostalAddress:{LocationUri:t,LocationSource:r,Type:n,Street:e.streetAddress,City:e.addressLocality,State:e.addressRegion,Country:e.addressCountry,PostalCode:e.postalCode,PostOfficeBox:e.postOfficeBoxNumber,Longitude:e.longitude,Latitude:e.latitude}}:null}function Q(e){return!Object(B.a)(e.PostalAddress)&&/^((http[s]?:\/\/)|(www\.)?){1}[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}\b([-a-zA-Z0-9@:*%_\+.~#?&\/\/=]*)/i.test(e.DisplayName)}function Y(e){return function(){var n=/^http*/i.test(e)?e:"//"+e;window.open(n,"_blank")}}t.d(n,"v",function(){return $}),t.d(n,"p",function(){return I}),t.d(n,"n",function(){return f}),t.d(n,"o",function(){return l}),t.d(n,"l",function(){return E}),t.d(n,"k",function(){return j}),t.d(n,"j",function(){return R}),t.d(n,"a",function(){return x}),t.d(n,"m",function(){return U}),t.d(n,"b",function(){return A}),t.d(n,"s",function(){return B.a}),t.d(n,"t",function(){return C.a}),t.d(n,"q",function(){return G}),t.d(n,"f",function(){return H}),t.d(n,"c",function(){return r.a}),t.d(n,"d",function(){return r.b}),t.d(n,"e",function(){return r.c}),t.d(n,"r",function(){return W}),t.d(n,"g",function(){return Z}),t.d(n,"i",function(){return a}),t.d(n,"h",function(){return J}),t.d(n,"w",function(){return Y}),t.d(n,"u",function(){return Q});var X=new q.c(function(){return t.e(775).then(t.bind(null,11917))}),$=new q.b(X,function(e){return e.createTxpPostalAddressFromLocationPersona})},1377:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(3),a=new r.c(function(){return Promise.all([t.e(2),t.e(6),t.e(9),t.e(18),t.e(212)]).then(t.bind(null,3100))}),i=new r.b(a,function(e){return e.logServiceCallForDiagnostics})},1514:function(e,n,t){"use strict";function r(e){return!!e&&(!!e.LocationUri||!(!e.Latitude||!e.Longitude))}t.d(n,"a",function(){return r})},1541:function(e){e.exports={a:"Ckb"}},1546:function(e,n,t){"use strict";var r;!function(e){e[e.EventSharingFromCalendar=0]="EventSharingFromCalendar",e[e.EventSharingFromMail=1]="EventSharingFromMail",e[e.EmailReminder=2]="EmailReminder"}(r||(r={})),n.a=r},1554:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(6);function a(e,n){if(n&&n.RecurrenceRange){var t=n.RecurrenceRange.EndDate;if(t)return Object(r.Eb)(e,t)}return null}},1561:function(e,n,t){"use strict";function r(){return{__type:void 0,ItemId:void 0,ParentFolderId:void 0,Subject:void 0,ReminderIsSet:void 0,ReminderMinutesBeforeStart:void 0,LastModifiedTime:void 0,InstanceKey:void 0,Preview:void 0,EffectiveRights:void 0,HasAttachments:void 0,Attachments:void 0,Sensitivity:void 0,Body:void 0,EntityNamesMap:void 0,IsDraft:void 0,Categories:void 0,Start:void 0,End:void 0,IsAllDayEvent:void 0,FreeBusyType:void 0,IsMeeting:void 0,IsCancelled:void 0,IsRecurring:void 0,IsResponseRequested:void 0,CalendarItemType:void 0,ResponseType:void 0,Organizer:void 0,RequiredAttendees:void 0,OptionalAttendees:void 0,Resources:void 0,AppointmentReplyTime:void 0,Recurrence:void 0,Location:void 0,IntendedFreeBusyStatus:void 0,IsOrganizer:void 0,AppointmentReplyName:void 0,IsSeriesCancelled:void 0,CharmId:void 0,Locations:void 0,ClientSeriesId:void 0,UID:void 0,ExperienceType:void 0,DoNotForwardMeeting:void 0,IsOnlineMeeting:void 0,JoinOnlineMeetingUrl:void 0,InboxReminders:void 0,MeetingRequestWasSent:void 0,ExtractionSourceId:void 0,TxpObject:void 0,StartTimeZoneId:void 0,EndTimeZoneId:void 0,OnlineMeetingProvider:void 0,OnlineMeetingJoinUrl:void 0,OnlineMeetingConferenceId:void 0,OnlineMeetingTollNumber:void 0,OnlineMeetingTollFreeNumbers:void 0,SeriesMasterItemId:void 0,ExtractionSourceInternetMessageId:void 0,HideAttendees:void 0,PersonId:void 0,InReplyTo:void 0,IsFreeBusyOnly:void 0,MeetingNotesWebUrl:void 0}}t.d(n,"a",function(){return r})},1563:function(e,n,t){"use strict";var r;function a(e){var n=e.getCalendarFolders;return r=n,e}function i(){var e=r;return r=void 0,e}t.d(n,"b",function(){return a}),t.d(n,"a",function(){return i})},1577:function(e){e.exports={c:"Lsb",a:"Msb",b:"Nsb"}},161:function(e,n,t){"use strict";var r=t(1956),a=t(62);function i(e){return!(!e.EffectiveRights||!e.EffectiveRights.Modify||Object(a.F)(e.ParentFolderId.Id)||V(e)||T(e)&&"Private"==e.Sensitivity)}var o=function(e){return B(e)&&i(e)&&!e.IsCancelled},c=t(45),d=function(e){return e&&e.ParentFolderId&&e.ParentFolderId.mailboxInfo&&e.ParentFolderId.mailboxInfo.type==c.a.GroupMailbox};function u(e,n){if(!e)return!1;var t=!d(e),r=function(n){return n?t?n.filter(function(n){return!e.Organizer||n.Mailbox.EmailAddress!=e.Organizer.Mailbox.EmailAddress}):n:[]},a=r(e.RequiredAttendees).length,i=r(e.OptionalAttendees).length;return n?a+i>0:a+i+r(e.Resources).length>0}function s(e){return e.IsDraft?u(e):e.IsMeeting||u(e)}var l=function(e){return!s(e)&&!e.IsOrganizer&&i(e)&&!e.IsCancelled},f=function(e){return!(!e.IsOrganizer||s(e)&&e.MeetingRequestWasSent||!i(e))},v=t(27),p=t(528);function I(e){var n=Object(a.r)(e.ParentFolderId.Id),t=Object(p.b)(e);return i(e)&&s(e)&&!([3,6,7].includes(n.CalendarFolderType)||t.IsMeetingPollEvent)}function _(e){return!!(e.IsOrganizer&&e.IsMeeting&&e.MeetingRequestWasSent&&i(e))}var b=function(e){return f(e)||o(e)||l(e)};function m(e){return!e.IsOrganizer&&e.IsMeeting&&!e.IsCancelled&&i(e)}function y(e){return 0==Object(v.f)().SessionSettings.WebSessionType&&m(e)&&e.IsResponseRequested&&!e.IsAllDayEvent&&(!e.IsRecurring||O(e))}function g(e){return!e.IsOrganizer&&e.IsCancelled&&i(e)}function h(e){return!Object(r.h)(e.EntityNamesMap)&&e.IsOrganizer&&i(e)}function O(e){return e.IsRecurring&&"RecurringMaster"!==e.CalendarItemType&&"ThisAndFollowingInstancesMaster"!==e.CalendarItemType}function E(e){return"RecurringMaster"===e.CalendarItemType}function j(e){return"ThisAndFollowingInstancesMaster"===e.CalendarItemType}function C(e){return d(e)&&!e.IsCancelled}var R=t(972);function T(e){if(e){var n=Object(a.r)(e.ParentFolderId.Id);if(n)return n.IsSharedWithMe||Object(R.b)(n)}return!1}var S=t(5);function A(e){return Object(S.d)("cal-recurrenceThisDateForward")&&!T(e)&&!d(e)}var F=function(e){var n=Object(a.r)(e.ParentFolderId.Id).CalendarFolderType;return(V(e)||i(e))&&(0==n||1==n||3==n||5==n)};function w(e){return e.IsMeeting}var M=function(e){if(!e)return!1;var n=e.ParentFolderId.mailboxInfo.deprecatedMailboxId;return N(e.RequiredAttendees,n)||N(e.OptionalAttendees,n)};function N(e,n){return e&&e.some(function(e){return e.Mailbox.EmailAddress.toLowerCase()==n})}var k=t(1300);function D(e){if(!e)return!1;var n=!1;return e.forEach(function(e){Object(k.a)(e.Mailbox.EmailAddress)||(n=!0)}),n}function P(e){return!(!e.EffectiveRights||!e.EffectiveRights.Read)}function x(e){if(!e)return!1;var n=Object(a.r)(e.ParentFolderId.Id);return n&&3==n.CalendarFolderType}function L(e){return"Exception"===e}function K(e){return"Occurrence"===e}function U(e){return K(e.CalendarItemType)||L(e.CalendarItemType)}function B(e){return e&&e.IsMeeting&&!e.IsOrganizer}function z(e){return e.IsMeeting&&e.IsOrganizer}function V(e){if(e&&e.ItemId&&e.ItemId.Id){var n=e.ClientSeriesId;return n&&(e.IsRecurring?n==e.InstanceKey:n==e.ItemId.Id)}return!0}function G(e){return V(e)&&s(e)}var q=t(6);function H(e,n){return e&&n&&!V(e)&&Object(q.wb)(n.Start,e.Start)&&Object(q.wb)(n.End,e.End)&&n.IsAllDayEvent==e.IsAllDayEvent}function W(e){return"RecurringMaster"===e}function Z(e){return!(!e.IsMeeting||!e.IsOrganizer||!e.IsDraft&&e.MeetingRequestWasSent)}t.d(n,"j",function(){return I}),t.d(n,"c",function(){return _}),t.d(n,"d",function(){return b}),t.d(n,"o",function(){return m}),t.d(n,"l",function(){return y}),t.d(n,"m",function(){return g}),t.d(n,"h",function(){return h}),t.d(n,"H",function(){return O}),t.d(n,"I",function(){return E}),t.d(n,"x",function(){return j}),t.d(n,"b",function(){return C}),t.d(n,"a",function(){return A}),t.d(n,"e",function(){return o}),t.d(n,"f",function(){return l}),t.d(n,"g",function(){return f}),t.d(n,"i",function(){return F}),t.d(n,"k",function(){return i}),t.d(n,"n",function(){return w}),t.d(n,"p",function(){return u}),t.d(n,"q",function(){return M}),t.d(n,"r",function(){return D}),t.d(n,"s",function(){return P}),t.d(n,"t",function(){return x}),t.d(n,"u",function(){return s}),t.d(n,"v",function(){return U}),t.d(n,"w",function(){return L}),t.d(n,"y",function(){return B}),t.d(n,"z",function(){return T}),t.d(n,"A",function(){return z}),t.d(n,"B",function(){return V}),t.d(n,"C",function(){return G}),t.d(n,"D",function(){return K}),t.d(n,"E",function(){return d}),t.d(n,"F",function(){return H}),t.d(n,"G",function(){return W}),t.d(n,"J",function(){return Z})},164:function(e,n,t){"use strict";var r=t(0),a=t(69);function i(e,n){for(var t={start:e.Start,end:e.End},r=0;r<n.length;r++)if(0===Object(a.j)(n[r],t,!0))return!0;return!1}function o(e,n,t){var o=t.dateRangesToRetain,c=t.eventsToRetain;return function(e,n,t){for(var a=n.dateRangesToRetain,o=n.eventsToRetain,c=t.startIndex,d=t.endIndex,u=[{startIndex:c,removeCount:0,finished:!1}],s=0,l=c;l>=0&&l<=d&&l<=e.length;l++){var f=e[l];o[f.Key]||i(f,a)?u[s].finished=!0:u[s].finished?(u.push({startIndex:l,removeCount:1,finished:!1}),s+=1):u[s].removeCount+=1}var v=[];return u.filter(function(e){return 0!==e.removeCount}).reverse().forEach(function(n){var t=e.splice(n.startIndex,n.removeCount);v.push.apply(v,r.__spread(t.reverse()))}),v.reverse()}(n,{dateRangesToRetain:o.filter(function(n){return 0===Object(a.j)(n,e,!0)}),eventsToRetain:c},function(e,n){for(var t={startIndex:-1,endIndex:-1},r=0;r<e.length;r++){var i=Object(a.j)({start:e[r].Start,end:e[r].End},n,!0);if(0===i&&-1===t.startIndex)t.startIndex=r;else if(0!==i&&-1!==t.startIndex){t.endIndex=r-1;break}}return-1!==t.startIndex&&-1===t.endIndex&&(t.endIndex=e.length-1),t}(n,e))}function c(e,n,t){e=r.__spread(e);for(var a=[],i=n.length-1;i>=0&&e.length>0;i--){var o=n[i],c=e.indexOf(o.Key);if(-1!==c&&d(o,t)){var u=n.splice(i,1);a.push.apply(a,r.__spread(u)),e.splice(c,1)}else-1!==c&&e.splice(c,1)}return a.reverse()}function d(e,n){var t=n.dateRangesToRetain,r=n.eventsToRetain;return!i(e,t)&&!r[e.Key]}function u(e,n){n.locksInfo.get(e)||n.locksInfo.set(e,{lockedDateRange:null,lockedEvents:{}})}function s(e){return void 0===e&&(e=function(){return!0}),function(n,t){var a=r.__read(t,2),i=a[0],o=a[1];return e([i,o])&&Object.keys(o.lockedEvents).forEach(function(e){return n[e]=!0}),n}}function l(e){return void 0===e&&(e=function(){return!0}),function(n,t){var a=r.__read(t,2),i=a[0],o=a[1];return e([i,o])&&o.lockedDateRange&&n.push(o.lockedDateRange),n}}var f,v=function(e){return function(n){return r.__read(n,1)[0]!==e}};function p(e,n,t){u(n,t);var a=t.locksInfo.get(n),i=a.lockedDateRange,d=a.lockedEvents,p=r.__spread(t.locksInfo.entries()).reduce(l(e!==f.EventIds?v(n):function(){return!0}),[]),I=r.__spread(t.locksInfo.entries()).reduce(s(e!==f.DateRange?v(n):function(){return!0}),{});!i||e!==f.All&&e!==f.DateRange||(o(i,t.events,{dateRangesToRetain:p,eventsToRetain:I}),a.lockedDateRange=null);var _=Object.keys(d);_.length>0&&(e===f.All||e===f.EventIds)&&(c(_,t.events,{dateRangesToRetain:p,eventsToRetain:I}),a.lockedEvents={})}!function(e){e[e.All=0]="All",e[e.DateRange=1]="DateRange",e[e.EventIds=2]="EventIds"}(f||(f={}));var I=t(6);var _=t(210);function b(e,n,t){void 0===t&&(t=!1);n.Key;var a,i=r.__rest(n,["Key"]),o=t?i:(a=i,Object.keys(a).reduce(function(e,n){return void 0!==a[n]&&(e[n]=a[n]),e},{}));_(e,o)}var m=function(e){setTimeout(function(){h.import().then(function(n){return n(e)})},0)},y=t(3),g=new y.c(function(){return Promise.all([t.e(2),t.e(6),t.e(9),t.e(18),t.e(121)]).then(t.bind(null,11762))}),h=new y.b(g,function(e){return e.logCacheUpdateForDiagnostics});function O(e,n,t,a){void 0===t&&(t=0),void 0===a&&(a=!1),e=function(e,n,t){for(var r=function(e){return e.reduce(function(e,n,t){return e[n.Key]=t,e},{})}(n),a=[],i=[],o=0;o<e.length;o++){var c=e[o],d=r[c.Key];if(void 0!==d){var u=n[d];b(u,c,t),i.push(d),a.push(u)}else a.push(c)}return(s=i,l=s.reduce(function(e,n){return e[n]=n,e},{}),Object.keys(l).map(function(e){return l[e]})).sort(function(e,n){return n-e}).forEach(function(e){return n.splice(e,1)}),{newEventsToAdd:a};var s,l}(e,n,a).newEventsToAdd;for(var i=[{startIndex:-1,eventsToAdd:[],finished:!1}],o=t,c=0;o<n.length&&c<e.length;){var d=n[o],u=e[c],s=Object(I.l)(u.Start,d.Start),l=-1===s,f=1===s;0===s?(E(u,o,i),c++):l?(E(u,o,i),c++):f&&(i[i.length-1].finished=!0,o++)}if(c<e.length){var v=e.slice(c,e.length);i.push({startIndex:n.length,eventsToAdd:v,finished:!0})}i.filter(function(e){return 0!==e.eventsToAdd.length}).reverse().forEach(function(e){return n.splice.apply(n,r.__spread([e.startIndex,0],e.eventsToAdd))});var p=r.__spread(e);return function(e){e.sort(function(e,n){return Object(I.l)(e.Start,n.Start)})}(p),m({lockId:"",updateMessage:"Upserted "+p.length+" items in the cache"}),p}function E(e,n,t){var r=t[t.length-1];if(-1===r.startIndex)r.startIndex=n,r.eventsToAdd.push(e);else if(r.finished){var a={startIndex:n,eventsToAdd:[e],finished:!1};t.push(a)}else r.eventsToAdd.push(e)}var j=function(e,n){return Object(I.l)(e.Start,n.Start)};function C(e,n,t,a,i){void 0===a&&(a=!1),void 0===i&&(i=!1),u(n,t);var o=t.events;if(a){var c=function(e,n){for(var t=null,r=0;r<n.length;r++)if(n[r].Key===e){t=n[r];break}return t?{event:t,index:r}:{event:null,index:-1}}(e.Key,o);c.event&&(o.splice(c.index,1),b(c.event,e,i),e=c.event)}var d=function(e,n,t){for(var r=0,a=0,i=n?n.length-1:0;a<=i;){var o=t(e,n[r=Math.floor((a+i)/2)]);if(0==o)return r;if(o<0){if(i=r-1,r<=a)return Math.max(a,i)}else if(a=r+1,r>=i)return a}return r}(e,o,j),s=d>=0?d:0,l=r.__read(O([e],o,s,i),1)[0];return t.locksInfo.get(n).lockedEvents[e.Key]=!0,m({lockId:n,updateMessage:"Event with startTime "+l.Start+" added to the lock"}),l}var R=t(12);function T(e,n,t,r){u(t,r);var i,o,c=r.locksInfo.get(t).lockedDateRange,d=c?c.start+" - "+c.end:"null";c&&(i=c,o=e,0==Object(a.j)(i,o,!0)||function(e,n){return 1==(Object(I.l)(e.start,n.start)<0?Object(I.r)(n.start,e.end):Object(I.r)(e.start,n.end))}(i,o))&&!Object(a.c)(e,c,!0)?Object(a.c)(c,e,!0)?R.c.info("[addEventsForLock]: Date range in lock "+t+" already contains the range to be added."):c=Object(a.f)(c,e):(R.c.info('[addEventsForLock] Replacing all items in cache for lock "'+t+'". Date range: '+e.start+" - "+e.end),p(f.DateRange,t,r),c=e);var s=O(n,r.events);return r.locksInfo.get(t).lockedDateRange=c,R.c.info('[addEvents] New range in cache for lock "'+t+'": '+c.start+" - "+c.end),m({lockId:t,updateMessage:s.length+" events added to the lock. Previous locked daterange: "+d+". New locked daterange: "+c.start+" - "+c.end}),s}function S(e,n,t){u(n,t);var i=t.locksInfo.get(n),c=i.lockedDateRange;if(c&&!Object(a.c)(e,i.lockedDateRange,!0)){m({lockId:n,updateMessage:"Now evicting events in cache except for events in date range "+e.start+" - "+e.end+". Current locked cache range: "+c.start+" - "+c.end});var d=r.__spread(t.locksInfo.entries()).reduce(l(v(n)),[e]),f=r.__spread(t.locksInfo.entries()).reduce(s(),{}),p=o(c,t.events,{dateRangesToRetain:d,eventsToRetain:f});R.c.info("[owa-events-cache:evictEventsExceptInDateRangeForLock] Evicted "+p.length+" events for lock '"+n+"'"),Object(a.c)(c,e,!0)?i.lockedDateRange=r.__assign({},e):i.lockedDateRange=function(e,n){var t=-1===Object(I.l)(e.start,n.start),r=1===Object(I.l)(e.end,n.end),a=e.start,i=e.end;t&&(a=n.start);r&&(i=n.end);return{start:a,end:i}}(e,c),m({lockId:n,updateMessage:"Evicted "+p.length+" events for lock. New locked cache range: "+c.start+" - "+c.end})}}function A(e,n){for(var t=n.events,a=0,i=[],o=t.length-1;o>=0;o--){var c=t[o];e(c)&&(i.push(c),t.splice(o,1),a++)}return function(e,n){r.__spread(n.locksInfo.keys()).forEach(function(t){var r=n.locksInfo.get(t);e.forEach(function(e){return delete r.lockedEvents[e.Key]})})}(i,n),m({lockId:"",updateMessage:"Unloaded "+a+" items from cache"}),i.reverse()}function F(e,n){var t,i,o=[];try{for(var c=r.__values(n),d=c.next();!d.done;d=c.next()){var u=d.value,s={start:u.Start,end:u.End},l=Object(a.j)(e,s,!0);if(0===l)o.push(u);else if(l>0)break}}catch(e){t={error:e}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(t)throw t.error}}return o}var w=t(23);function M(e,n,t){var r=t.locksInfo.get(n)||{},i=r.lockedDateRange,o=void 0===i?null:i,c=r.lockedEvents,d=void 0===c?[]:c;return null===o&&0===Object.keys(d).length?e.map(function(e){return null}):function(e,n,t){for(var r=t.locksInfo.get(n),i=r.lockedDateRange,o=r.lockedEvents,c=e.reduce(function(e,n){return e[n]=!0,e},{}),d={},u=0,s=0;s<t.events.length&&u<e.length;s++){var l=t.events[s],f={start:l.Start,end:l.End},v=!!i&&0===Object(a.j)(i,f,!0);c[l.Key]&&(v||o[l.Key])&&(d[l.Key]=l,u++)}return e.map(function(e){return d[e]||null})}(e,n,t)}var N=0;var k=t(8);function D(){return{events:[],locksInfo:new k.ObservableMap}}var P=t(1),x={calendarFolderEvents:new k.ObservableMap,fullItemsMruMap:new k.ObservableMap},L=Object(P.createStore)("calendarEventsStore",x);function K(e,n){var t=L().calendarFolderEvents.get(e);return t?t.events.filter(n):[]}function U(e,n){return void 0===n&&(n=null),n?r.__read(K(n,function(n){return n.ItemId.Id===e}),1)[0]||null:V(function(n){return n.ItemId.Id===e})}function B(e,n){return void 0===n&&(n=null),n?r.__read(K(n,function(n){return n.Key===e}),1)[0]||null:V(function(n){return n.Key===e})}function z(e,n,t){var a=null;return a=e?function(e,n,t){var a=L().calendarFolderEvents.get(e);if(a){var i=r.__read(M([n],t,a),1),o=i[0];return o||null}return null}(e,n,t):function(e,n){for(var t=L(),a=r.__spread(t.calendarFolderEvents.keys()),i=0;i<a.length;i++){var o=a[i],c=t.calendarFolderEvents.get(o),d=r.__read(c?M([e],n,c):[null],1),u=d[0];if(u)return u}return null}(n,t),m({lockId:t,updateMessage:"Got "+(a?"1":"no")+" item from the cache for given folder and key"}),a}function V(e){for(var n=L(),t=r.__spread(n.calendarFolderEvents.keys()),a=0;a<t.length;a++){var i=t[a],o=n.calendarFolderEvents.get(i),c=r.__read(o?o.events.filter(e):[null],1)[0];if(c)return c}return null}function G(e){var n=q(e);return n?r.__spread(n.locksInfo.entries()).reduce(l(),[]):[]}function q(e){return L().calendarFolderEvents.get(e)||null}function H(e){var n=q(e);return n?r.__spread(n.events):[]}function W(e){return!!q(e)}function Z(e,n){var t=[],r=[];return e.forEach(function(e){var i={start:e.Start,end:e.End};n.some(function(e){return 0===Object(a.j)(e,i,!0)})?t.push(e):r.push(e)}),{eventsOverlapping:t,eventsNotOverlapping:r}}var J=Object(P.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK",function(e,n,t,r){return{lockId:e,folderId:n,eventKey:t,partialCalendarEvent:r}}),Q=Object(P.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK_FAILED",function(e,n,t){return{lockId:e,folderId:n,eventKey:t}}),Y=Object(P.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED_FOR_LOCK",function(e,n,t,r,a,i){return{lockId:e,folderId:n,eventKey:t,event:r,eventScope:a,forceOverrideAllPropertiesForEventIfAvailable:i}}),X=Object(P.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED",function(e,n,t){return{folderId:e,eventKey:n,event:t}}),$=Object(P.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_SERVER",function(e){return{partialCalendarEvent:e}}),ee=Object(P.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_PARTIAL_CALENDAR_EVENT",function(e){return{partialCalendarEvent:e}}),ne=Object(P.action)("CALENDAR_EVENTS_REMOVE_FULL_CALENDAR_EVENT",function(e,n){return{folderId:e,eventKey:n}}),te=Object(P.action)("CALENDAR_EVENTS_REMOVE_ALL_FULL_CALENDAR_EVENTS_INFO_FOR_CACHE",function(e){return{folderId:e}}),re=Object(P.action)("ADD_CALENDAR_EVENTS_TO_EVENTS_CACHE",function(e,n,t){return void 0===t&&(t=!1),{folderId:e,calendarEvents:n,forceReplace:t}}),ae=Object(P.action)("ADD_CALENDAR_EVENTS_WITHING_CURRENT_LOCKED_DATE_RANGES",function(e,n){return{folderId:e,calendarEvents:n}}),ie=Object(P.action)("REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",function(e,n){return{folderId:e,instanceKey:n}}),oe=Object(P.action)("INTERNAL_REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",function(e,n,t){return{folderId:e,instanceKey:n,onEventsRemoved:t}}),ce=Object(P.action)("REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",function(e,n){return{folderId:e,predicate:n}}),de=Object(P.action)("INTERNAL_REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",function(e,n,t){return{folderId:e,predicate:n,onEventsRemoved:t}}),ue=Object(P.action)("CALENDAR_EVENTS_RELEASE_LOCK",function(e){return{lockId:e}}),se=Object(P.action)("CALENDAR_EVENTS_IN_EVENTS_CACHE_RELOADED",function(e,n,t){return void 0===t&&(t=!1),{folderId:e,eventsReloaded:n,forceReload:t}}),le=Object(P.action)("CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",function(e,n,t,r){return{lockId:e,folderId:n,dateRange:t,calendarEvents:r}}),fe=Object(P.action)("INTERNAL_DELETE_EVENTS_CACHE",function(e){return{folderId:e}}),ve=Object(P.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_WAS_USED",function(e,n){return{lockId:e,eventKey:n}}),pe=Object(P.action)("UpdateItem",function(e,n){return{existingItem:e,updatedItem:n}}),Ie=t(1541),_e=t(1757),be=t(1773),me=t(4),ye=t(26),ge=Object(P.action)("calendarEventsRemoved",function(e){return{eventsRemoved:e}}),he=Object(P.action)("calendarEventsAdded",function(e){return{eventsAdded:e}}),Oe=Object(P.action)("calendarEventUpdated",function(e){return{eventUpdated:e}}),Ee=Object(P.action)("cacheReloaded",function(e,n){return{previousEvents:e,reloadedEvents:n}}),je=Object(P.action)("deleteEventsCache",function(e){return{folderId:e}}),Ce=Object(P.action)("loadingCalendarEvents",function(e,n){return Object(ye.a)({name:"CalendarLoadState",customData:{loadingState:n},options:{isVerbose:!0}},{calendarId:e,loadingState:n})}),Re=Object(P.action)("instantCalendarEventCreate",function(e,n,t,r,a,i,o){return void 0===a&&(a=function(){}),void 0===i&&(i=void 0),void 0===o&&(o=Object(me.a)(_e.a)),{eventToCreate:e,rangeToCreate:n,actionToExecute:t,onEventCreatedSuccess:r,onEventCreatedFailed:a,actionSource:i,errorMessage:o}}),Te=Object(P.action)("instantCalendarEventUpdate",function(e,n,t,r,a,i,o,c,d,u){return void 0===o&&(o=function(){}),void 0===c&&(c=void 0),void 0===d&&(d=Object(me.a)(Ie.a)),void 0===u&&(u=!1),{eventId:e,eventChanges:n,eventScope:t,rangeToCreate:r,actionToExecute:a,onEventUpdateSuccess:i,onEventUpdateFailed:o,actionSource:c,errorMessage:d,showNotification:u}}),Se=Object(P.action)("instantCalendarEventDelete",function(e,n,t,r,a,i,o,c,d){return void 0===i&&(i=function(){}),void 0===o&&(o=void 0),void 0===c&&(c=Object(me.a)(be.a)),void 0===d&&(d=!1),{eventId:e,eventScope:n,dataPoint:t,actionToExecute:r,onEventDeleteSuccess:a,onEventDeleteFailed:i,actionSource:o,errorMessage:c,responseSent:d}}),Ae=Object(P.action)("updatingCalendarEventFailed",function(e,n,t,r,a){return void 0===a&&(a=void 0),{eventBeforeUpdate:e,errorMessage:n,allowLocalUpdate:t,retryFunction:r,actionSource:a}});Object(P.orchestrator)(Ee,function(e){var n=e.previousEvents,t=e.reloadedEvents;t&&(n&&ge(n),he(t))}),Object(P.orchestrator)(ce,function(e){var n=e.folderId,t=e.predicate,r=null;de(n,t,function(e){r=e}),r&&(r.forEach(function(e){return ne(n,e.Key)}),ge(r))}),Object(P.orchestrator)(ie,function(e){var n=e.folderId,t=e.instanceKey,r=null;oe(n,t,function(e){r=e}),r&&(r.forEach(function(e){return ne(n,e.Key)}),ge(r))}),Object(P.orchestrator)(ae,function(e){var n=e.folderId,t=Z(e.calendarEvents,G(n)).eventsOverlapping;t.length>0&&(re(n,t),he(t))}),Object(P.orchestrator)(se,function(e){var n=e.folderId,t=e.eventsReloaded,r=e.forceReload,a=H(n);re(n,t,r),Ee(a,t)}),Object(P.orchestrator)(je,function(e){var n=e.folderId;te(n),fe(n)});var Fe=t(2067),we=t(899),Me=t(161);function Ne(e,n,t){var r=function(e,n,t){var r=t&&t.locksInfo.get(n)?t.locksInfo.get(n).lockedDateRange:null;if(null!=r&&Object(a.c)(r,e,!0)){var i=F(e,t.events);if(Object(w.d)("debugEventsCache")){var o=i?i.length:"no";m({lockId:n,updateMessage:"Returning "+o+" items from cache for date range: "+e.start+" - "+e.end})}return i}return null}(t,e,q(n));return(r||[]).filter(function(e){return!Object(Me.G)(e.CalendarItemType)})}var ke=t(2009),De=t.n(ke),Pe=t(2010),xe=t.n(Pe),Le=t(2011),Ke=t.n(Le),Ue=t(2012),Be=t.n(Ue),ze=t(2013),Ve=t.n(ze),Ge=t(2014),qe=t.n(Ge),He=t(29),We=t(1377),Ze=t(5),Je=t(156);function Qe(e,n,t,a,i,o){return r.__awaiter(this,void 0,void 0,function(){var c,d,u;return r.__generator(this,function(r){switch(r.label){case 0:return c=Object(He.getJsonRequestHeader)(),i&&(c.TimeZoneContext.TimeZoneDefinition.Id=i),u=null,o?[4,Object(Je.b)(o)]:[3,2];case 1:u=r.sent(),r.label=2;case 2:return r.trys.push([2,,4,5]),[4,qe()({request:{Header:c,Body:Be()({MailboxDataArray:t.map(function(e){return Ve()({Email:xe()({Address:e})})}),FreeBusyViewOptions:Ke()({RequestedView:a,TimeWindow:De()({StartTime:Object(I.hb)(e),EndTime:Object(I.hb)(n)})})})}},u)];case 3:return d=r.sent(),[3,5];case 4:return Object(Ze.d)("cal-mf-diagnostics")&&We.a.import().then(function(e){return e({action:"GetUserAvailabilityInternal",status:d?d.Body.ResponseCode:"Error",response:d&&d.Body})}),[7];case 5:return[2,d.Body]}})})}var Ye=t(1561),Xe=t(45),$e=t(415);function en(e,n,t,i){if(i=i||Object(Xe.e)(),!t){var o=G(n);o&&o.length>0&&(t=o.sort(function(e,n){var t=Object(a.l)(e),r=Object(a.l)(n);return t>r?-1:t<r?1:0})[0])}var c=Object(Ye.a)(),d=function(e,n){var t=Object(I.Wb)(e),r=nn(t,Object(I.sb)(n.start));return Object(a.q)(n,r)?r:nn(t,Object(I.sb)(n.end))}(e.Birthday,t),u=r.__assign({},c,e,{Subject:e.Name,Start:d,End:Object(I.a)(d,1),IsAllDayEvent:!0,ParentFolderId:{Id:n,mailboxInfo:i},ItemId:{Id:e.Id.Id,mailboxInfo:i},PersonId:e.PersonId,EffectiveRights:{Delete:!0,Modify:!0,Read:!0},FreeBusyType:"Free",ReminderIsSet:e.PopupReminderSettings[0].IsReminderSet,ReminderMinutesBeforeStart:e.PopupReminderSettings[0].ReminderMinutesBeforeStart,InboxReminders:e.EmailReminderSettings});return u||null}function nn(e,n){var t=Object(I.nb)(e),r=Object(I.cb)(e),a=Object($e.a)(n,t),i=Math.min(r,a);return Object(I.Wb)(n,t,i)}var tn=t(18),rn=t(2056),an=t(2038),on=t.n(an),cn=t(2039),dn=t.n(cn);function un(e,n,t){return r.__awaiter(this,void 0,void 0,function(){var a,i;return r.__generator(this,function(r){switch(r.label){case 0:return a=dn.a,i=[{Header:Object(He.getJsonRequestHeader)(),Body:on()({StartRange:Object(I.hb)(e),EndRange:Object(I.hb)(n)})}],[4,Object(Je.b)(t.mailboxInfo)];case 1:return[4,a.apply(void 0,i.concat([r.sent()]))];case 2:return[2,r.sent().Body]}})})}var sn=t(528),ln=t(62);function fn(e,n,t,a){return void 0===a&&(a=0),r.__awaiter(this,void 0,void 0,function(){var i,o,c;return r.__generator(this,function(r){switch(r.label){case 0:return(i=Object(tn.q)())&&i.addCustomData({outOfCacheRange:!0}),o=Object(ln.x)(n),t(o,"Loading"),Object(ln.E)(n)?3!=(c=Object(ln.r)(n)).CalendarFolderType?[3,2]:[4,In(e,o,n,t,a)]:[3,5];case 1:return[2,r.sent()];case 2:return[4,pn(e,o,n,t,o.mailboxInfo.type==Xe.a.GroupMailbox?o.mailboxInfo.primarySmtpAddress:null,a)];case 3:return[2,r.sent()];case 4:return[3,8];case 5:return c=Object(ln.o)({id:o}),Object(ln.G)(c)?[4,vn(Object(ln.s)({id:{id:c.ItemId.Id,mailboxInfo:o.mailboxInfo}}),c,e,o,t,a)]:[3,7];case 6:return[2,r.sent()];case 7:return t(o,"Failed"),[2,null];case 8:return[2]}})})}function vn(e,n,t,a,i,o){return void 0===o&&(o=0),r.__awaiter(this,void 0,void 0,function(){var c,d,u;return r.__generator(this,function(r){switch(r.label){case 0:if(!(!e&&null==n.SharedFolderId||n.hasOwnProperty("OwnerEmailAddress")&&!n.IsGroupMailboxCalendar&&e&&!e.EffectiveRights||e&&!e.EffectiveRights.Read&&n.IsGeneralScheduleCalendar))return[3,7];r.label=1;case 1:if(!(o>=0))return[3,6];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Qe(t.start,t.end,[n.OwnerEmailAddress],"DetailedMerged",null,a.mailboxInfo)];case 3:return"NoError"==(c=r.sent()).ResponseCode?(i(a,"Loaded"),[2,c.Responses[0].CalendarView.Items.map(function(e){return Object(sn.a)(e)})]):(o--,[3,5]);case 4:return d=r.sent(),R.c.warn("[loadCalendarEventsInDateRange:loadCalendarEventsUsingFolderId: Exception occured: "+d),d.message&&(d.message.indexOf("ErrorApiQuarantined")>=0||d.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(i(a,"Throttled"),[2,null]):(o--,[3,5]);case 5:return[3,1];case 6:return i(a,"Failed"),[2,null];case 7:return u=e?e.FolderId.Id:n.SharedFolderId.Id,[4,pn(t,a,u,i,n.OwnerEmailAddress,o)];case 8:return[2,r.sent()]}})})}function pn(e,n,t,a,i,o){return void 0===o&&(o=0),r.__awaiter(this,void 0,void 0,function(){var c,d;return r.__generator(this,function(r){switch(r.label){case 0:if(!(o>=0))return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(rn.a)(e.start,e.end,t,n,i,Object(Ze.d)("cal-surface-declinedMeetings"))];case 2:return"NoError"==(c=r.sent()).ResponseCode?(a(n,"Loaded"),[2,c.Items.map(function(e){return Object(sn.a)(e,n.mailboxInfo)})]):(o--,[3,4]);case 3:return d=r.sent(),R.c.warn("[loadCalendarEventsInDateRange:getCalendarView: Exception occured: "+d),d.message&&(d.message.indexOf("ErrorApiQuarantined")>=0||d.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(a(n,"Throttled"),[2,null]):(o--,[3,4]);case 4:return[3,0];case 5:return a(n,"Failed"),[2,null]}})})}function In(e,n,t,a,i){return void 0===i&&(i=0),r.__awaiter(this,void 0,void 0,function(){var o,c;return r.__generator(this,function(r){switch(r.label){case 0:if(!(i>=0))return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,un(e.start,e.end,n)];case 2:return"NoError"==(o=r.sent()).ResponseCode?(a(n,"Loaded"),[2,o.BirthdayEvents.map(function(r){return en(r,t,e,n.mailboxInfo)})]):(i--,[3,4]);case 3:return c=r.sent(),R.c.warn("[loadCalendarEventsInDateRange:getBirthdayCalendarView: Exception occured: "+c),c.message&&(c.message.indexOf("ErrorApiQuarantined")>=0||c.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(a(n,"Throttled"),[2,null]):(i--,[3,4]);case 4:return[3,0];case 5:return a(n,"Failed"),[2,null]}})})}var _n=3,bn=1,mn={};function yn(e){mn[e]||(mn[e]=[])}function gn(e,n){yn(e);for(var t=mn[e],r=0;r<t.length;r++)if(Object(a.c)(t[r].dateRange,n,!0))return{index:r,info:t[r]};return{index:-1,info:null}}function hn(e,n,t){var i=function(e,n){var t=L().calendarFolderEvents.get(n);return t?t.locksInfo.get(e):null}(e,n);if(i&&i.lockedDateRange&&Object(a.c)(i.lockedDateRange,t,!0)){var o=Ne(e,n,t);return{fetchPromise:Promise.resolve(o),events:o}}var c=function(e,n,t){var i=G(n),o=q(n);return i.some(function(e){return Object(a.c)(e,t,!0)})&&o?F(t,o.events).map(function(e){return r.__assign({},e)}):null}(0,n,t);if(c)return{fetchPromise:On(e,n,t,Promise.resolve(c),"existing"),events:c};var d=gn(n,t).info;if(d)return{fetchPromise:On(e,n,t,d.requestPromise.then(function(e){return e.filter(function(e){var n=e.Start,r=e.End;return 0==Object(a.j)(t,{start:n,end:r},!0)})}),"new"),events:null};var u=function(e,n){var t=this,a=r.__awaiter(t,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,,2,3]),[4,fn(n,e,Ce,bn)];case 1:return[2,t.sent()];case 2:return function(e,n){var t=gn(e,n).index;-1!==t&&mn[e].splice(t,1)}(e,n),[7];case 3:return[2]}})});return function(e,n,t){yn(e),mn[e].push({dateRange:n,requestPromise:t})}(e,n,a),a}(n,t);return{fetchPromise:On(e,n,t,u,"new"),events:null}}function On(e,n,t,a,i){return r.__awaiter(this,void 0,void 0,function(){var o,c;return r.__generator(this,function(r){switch(r.label){case 0:return[4,a];case 1:return o=r.sent(),c=o?o.length:"no",m({lockId:e,updateMessage:"Fetched "+c+" "+i+" items for date range: "+t.start+" - "+t.end}),o&&le(e,n,t,o),[2,o]}})})}function En(e){if(0===e.length)return[];var n=[];return e.forEach(function(e){return function(e,n){for(var t=!1,r=0;r<n.length&&!t;r++){var i=n[r];0===Object(a.j)(i,e,!0)&&(n[r]=Object(a.f)(i,e),t=!0)}t||n.push(e)}(e,n)}),n}function jn(e,n){return void 0===n&&(n=!1),r.__awaiter(this,void 0,void 0,function(){var t,a,i;return r.__generator(this,function(o){switch(o.label){case 0:return t=function(e){var n=function(e){return yn(e),mn[e].map(function(e){return e.dateRange})}(e),t=G(e);return En(r.__spread(n,t))}(e),a=t.map(function(n){return fn(n,e,Ce,bn)}),[4,Promise.all(a)];case 1:return(i=o.sent())?(i.forEach(function(t){t&&(se(e,t,n),t.forEach(function(e){return $(e)}))}),[2,i.reduce(function(e,n){return n&&e.push.apply(e,r.__spread(n)),e},[])]):[2,null]}})})}function Cn(e,n,t,r){void 0===r&&(r=!1);var a=e.ParentFolderId.Id,i=!1,o=Tn(a,e,n);o?o.IsRecurring&&!n?r?ge([o]):i=!0:ge([o]):R.c.info("[SharedCacheFunctions] addOrModifyItemInCache: Skipping removal of old item from cache as no old item was found"),!o&&t||(i||Rn(a,[e]),r?$(e):ee(e))}function Rn(e,n){var t=Z(n,G(e)).eventsOverlapping;re(e,t),he(t)}function Tn(e,n,t){var a=null;if(t)a=U(n.ItemId.Id,e);else{a=r.__read(K(e,function(e){return e.InstanceKey==n.InstanceKey}),1)[0]}if(!a){var i=n.ClientSeriesId;if(i){a=r.__read(K(e,function(e){return e.ClientSeriesId==i}),1)[0]}}return a}function Sn(e,n){return void 0===n&&(n=!1),r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,jn(e,n)];case 1:return t.sent(),[2]}})})}var An=t(1554),Fn=t(1182),wn=t(210);function Mn(e,n){var t=[],i=e.Recurrence,o=function(e,n){var t=Object(I.Kb)(e.Start),r=Object(An.a)(t.tz,e.Recurrence),a={start:t,end:r};return i=a,o=n,i.start=Object(I.l)(i.start,o.start)>0?i.start:o.start,i.end=null!=i.end&&Object(I.l)(i.end,o.end)<0?i.end:o.end,a;var i,o}(e,n),c=i.RecurrencePattern.Interval,d=Object(I.s)(e.Start,Object(I.Kb)(e.Start)),u=Object(I.s)(e.End,Object(I.Kb)(e.Start));if(Object(Fn.d)(i))t=function(e,n,t){for(var r=[],a=Object(I.n)(n.end,n.start),i=0;i<=a;i+=t){var o=Object(I.a)(n.start,i);r.push(o)}return r}(0,o,c);else if(Object(Fn.h)(i))t=function(e,n,t){var r=[],i=e.Recurrence.RecurrencePattern,o=i.DaysOfWeek.split(" ").map(function(e){return Nn(e)}),c=Math.max(Nn(i.FirstDayOfWeek),0),d=n.start;for(;Object(I.l)(d,n.end)<=0;){for(var u=d,s=Object(I.x)(u,c);Object(I.l)(u,s)<=0;)o.includes(Object(I.eb)(u))&&Object(a.q)(n,u)&&r.push(u),u=Object(I.a)(u,1);d=Object(I.Ob)(Object(I.a)(d,7*t),c)}return r}(e,o,c);else{if(!Object(Fn.e)(i))return Object(Fn.i)(i),[r.__assign({},e)];t=function(e,n,t){var r=[];if(Object(Fn.b)(e.Recurrence))for(var i=e.Recurrence.RecurrencePattern,o=i.DayOfMonth,c=n.start;Object(I.l)(c,n.end)<=0;){for(var d=c,u=Object(I.w)(d);Object(I.l)(d,u)<=0;)Object(I.cb)(d)==o&&Object(a.q)(n,d)&&r.push(d),d=Object(I.a)(d,1);c=Object(I.Nb)(Object(I.e)(c,t))}else{var i=e.Recurrence.RecurrencePattern,s=Nn(i.DaysOfWeek),l=-1;switch(i.DayOfWeekIndex){case"First":l=1;break;case"Second":l=2;break;case"Third":l=3;break;case"Fourth":l=4}for(var c=n.start;Object(I.l)(c,n.end)<=0;){var f=void 0;f=l>0?kn(s,l,c):Dn(s,c),Object(a.q)(n,f)&&r.push(f),c=Object(I.Nb)(Object(I.e)(c,t))}}return r}(e,o,c)}return function(e,n,t,r){var a=[];return r.forEach(function(r){var i={};wn(i,e),i.Start=Object(I.d)(r,n),i.End=Object(I.d)(r,t),i.CalendarItemType="Occurrence",a.push(i)}),a}(e,d,u,t)}function Nn(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].indexOf(e)}function kn(e,n,t){var r=Object(I.Nb)(t),a=(e-Object(I.eb)(r)+7)%7+7*(n-1);return Object(I.a)(r,a)}function Dn(e,n){var t=kn(e,5,n);return Object(I.nb)(t)==Object(I.nb)(n)?t:kn(e,4,n)}var Pn=t(376),xn=t(230),Ln=t.n(xn),Kn=t(94);function Un(e){var n=Object(Kn.a)();e.forEach(function(e){Bn(e,n),e.IsRecurring=!0,e.InstanceKey=e.InstanceKey?e.InstanceKey:n})}function Bn(e,n,t){void 0===n&&(n=Object(Kn.a)()),void 0===t&&(t=Object(Kn.a)()),e.ItemId=r.__assign({},Ln()({Id:t}),{mailboxInfo:e.ParentFolderId.mailboxInfo}),e.ClientSeriesId||(e.ClientSeriesId=n),e.EffectiveRights={Read:!0,Modify:!0,Delete:!0,ViewPrivateItems:!0},e.IsOrganizer=!0}function zn(e,n,t,r,a){if(t){var i=e.ParentFolderId.Id;e.Recurrence?ce(i,function(n){return n.InstanceKey==e.InstanceKey}):ce(i,function(n){return n.ItemId.Id===e.ItemId.Id})}Pn.f.import().then(function(e){e("instantCalendarEventCreate",a,n,Object(me.a)(we.a),function(){return r()},"Error")})}Object(P.orchestrator)(Re,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var n,t,a,i,o,c,d,u,s,l,f,v;return r.__generator(this,function(p){switch(p.label){case 0:n=e.eventToCreate,t=e.rangeToCreate,a=e.actionToExecute,i=e.actionSource,o=e.onEventCreatedFailed,c=e.onEventCreatedSuccess,d=e.errorMessage,u=W(n.ParentFolderId.Id),function(e,n,t,a){if(n){var i=e.ParentFolderId.Id;if(e.Recurrence){var o=Mn(e,t);Un(o.concat(e));var c=o.map(function(e){return r.__assign({},e,{CalendarItemType:"Occurrence"})});return void ae(i,c)}d=e,void 0===u&&(u=Object(Kn.a)()),Bn(d,u,u),ae(i,[e]),Object(Ze.d)("cal-surface-notificationBar")&&Pn.e.import().then(function(e){e("instantCalendarEventCreate",a,Object(me.a)(Fe.a),{icon:"CheckMark"})})}var d,u}(n,u,t,i),s=function(){return Re(n,t,a,o,c,i,d)},l=null,p.label=1;case 1:return p.trys.push([1,3,,4]),[4,a(n)];case 2:return l=p.sent(),[3,4];case 3:throw f=p.sent(),zn(n,d,u,s,i),o(f),f;case 4:if(v=null,!l.isSuccessful)throw zn(n,d,u,s,i),o(d),d;return v=l.createdItem,function(e,n,t){n.ParentFolderId||(n.ParentFolderId=r.__assign({},e.ParentFolderId));if(t){if(n.Recurrence)return;var a=n.ParentFolderId.Id;ce(a,function(n){return n.ItemId.Id===e.ItemId.Id}),Cn(n,!0,!1)}}(n,v,u),c(v),[2]}})})});var Vn=t(210);function Gn(e,n){var t={Key:e,Start:n.Start,End:n.End};return Vn(n,t),n}function qn(){return Jn.get()}function Hn(e){return qn()[e]||null}function Wn(e,n){var t=L().fullItemsMruMap.get(e);return t&&r.__read(t.eventInfos.filter(function(e){return e.eventKey===n}),1)[0]||null}function Zn(e){var n=Hn(e);return n?n.loadState:null}var Jn=Object(k.computed)(function(){var e=L();return r.__spread(e.fullItemsMruMap.keys()).reduce(function(n,t){return e.fullItemsMruMap.get(t).eventInfos.forEach(function(e){return n[e.eventKey]=e}),n},{})});var Qn=t(210);function Yn(e){if(e){var n=L();n.calendarFolderEvents.get(e)||n.calendarFolderEvents.set(e,D())}}Object(P.mutator)(ue,function(e){var n=e.lockId,t=L();r.__spread(t.calendarFolderEvents.keys()).forEach(function(e){t.calendarFolderEvents.get(e).locksInfo.get(n)&&function(e,n){p(f.All,e,n),n.locksInfo.delete(e)}(n,t.calendarFolderEvents.get(e))}),t.fullItemsMruMap.delete(n)}),Object(P.mutator)(X,function(e){var n=e.folderId,t=e.eventKey,r=e.event,a=B(t,n);a&&b(a,r,!0)}),Object(P.mutator)(ee,function(e){var n,t=e.partialCalendarEvent;if((n=t).Key&&void 0!==n.Start&&void 0!==n.End){t.Key;t=r.__rest(t,["Key"])}var a=B(Object(Me.G)(t.CalendarItemType)?t.InstanceKey:t.ItemId.Id,t.ParentFolderId.Id);a&&b(a,t)}),Object(P.mutator)(le,function(e){var n=e.lockId,t=e.folderId,r=e.dateRange,a=e.calendarEvents;Yn(t);var i=q(t),o=qn();T(r,a.filter(function(e){return!Object(Me.G)(e.CalendarItemType)}).map(function(e){return Gn(e.ItemId.Id,e)}).filter(function(e){return!o[e.Key]}),n,i);var c=i.locksInfo.get(n).lockedDateRange;Object(I.n)(c.end,c.start)>110&&S(function(e,n,t){var r=Object(I.n)(n.end,n.start);if(r===t)return n;if(r>t)return{start:n.start,end:Object(I.a)(n.start,t)};var a=t-r,i=Math.abs(Object(I.n)(n.end,e.end)),o=Math.abs(Object(I.n)(e.start,n.start)),c=n.start,d=n.end;if(i>0){var u=Math.min(a,i);d=Object(I.a)(d,u),a-=u}if(a>0&&o>0){var s=Math.min(a,o);c=Object(I.a)(c,-1*s)}return{start:c,end:d}}(c,r,110),n,i)}),Object(P.mutator)(oe,function(e){var n=e.folderId,t=e.instanceKey,r=e.onEventsRemoved;Yn(n),r(A(function(e){return e.InstanceKey===t},q(n)))}),Object(P.mutator)(de,function(e){var n=e.folderId,t=e.predicate,r=e.onEventsRemoved;Yn(n),r(A(t,q(n)))}),Object(P.mutator)(fe,function(e){var n=e.folderId;L().calendarFolderEvents.delete(n)}),Object(P.mutator)(re,function(e){var n=e.folderId,t=e.calendarEvents,a=e.forceReplace;Yn(n);var i,o,c,d,u=t.map(function(e){return Gn(e.ItemId.Id,e)}),s=q(n);a?(i=u,d=(o=s).events.length,(c=o.events).splice.apply(c,r.__spread([0,o.events.length],i)),m({lockId:"",updateMessage:"Replaced "+d+" items from cache with "+i.length+" items"})):O(u,s.events)}),Object(P.mutator)(pe,function(e){Qn(e.existingItem,e.updatedItem)});var Xn=Object(P.action)("CALENDAR_EVENTS_CLEAR_ALL_FULL_CALENDAR_EVENTS",function(){return{}}),$n=5;function et(e,n,t,a){tt(n,t);var i=e.eventKey,o=t.get(n),c=o.eventInfos,d=r.__read(c.filter(function(e){return e.eventKey===i}),1)[0];d?rt(o.eventInfos.indexOf(d),e,o):(c.push(e),function(e,n){!function(e,n,t){for(;e.eventInfos.length>n&&0<e.eventInfos.length;)at(0,e,t)}(e,$n,n)}(o,a))}function nt(e,n,t,a){void 0===a&&(a=function(){}),tt(n,t);var i=t.get(n),o=r.__read(i.eventInfos.filter(function(n){return n.eventKey===e}),1)[0],c=i.eventInfos.indexOf(o);return-1!==c&&at(c,i,a),-1!==c}function tt(e,n){n.get(e)||n.set(e,{eventInfos:[]})}function rt(e,n,t){if(-1===e)throw new Error("Item with eventKey "+n.eventKey+" does not exist in the MRU");t.eventInfos.splice(e,1),t.eventInfos.push(n)}function at(e,n,t){if(e<0||e>=n.eventInfos.length)throw new Error("Invalid index to remove "+e);var r=n.eventInfos[e];n.eventInfos.splice(e,1),t(r.eventKey)}function it(e){if(e){var n=L();n.calendarFolderEvents.get(e)||n.calendarFolderEvents.set(e,D())}}function ot(e,n){return function(t){!function(e,n,t){if(0===e.length)return[];u(n,t);var a=t.locksInfo.get(n);e=e.filter(function(e){return a.lockedEvents[e]});var i=r.__spread(t.locksInfo.entries()).reduce(l(),[]),o=r.__spread(t.locksInfo.entries()).reduce(s(v(n)),{}),d=c(e,t.events,{dateRangesToRetain:i,eventsToRetain:o});e.forEach(function(e){delete a.lockedEvents[e]})}([t],e,L().calendarFolderEvents.get(n))}}Object(P.mutator)(J,function(e){var n=e.eventKey,t=e.folderId,r=e.lockId,a=e.partialCalendarEvent;it(t);var i=L();a&&C(Gn(n,a),r,i.calendarFolderEvents.get(t));et({eventKey:n,folderId:t,loadState:0},r,i.fullItemsMruMap,ot(r,t))}),Object(P.mutator)(Q,function(e){var n=e.eventKey,t=e.folderId,r=e.lockId;it(t),et({eventKey:n,folderId:t,loadState:2},r,L().fullItemsMruMap,ot(r,t))}),Object(P.mutator)(Y,function(e){var n=e.lockId,t=e.eventKey,r=e.folderId,a=e.event,i=e.eventScope,o=e.forceOverrideAllPropertiesForEventIfAvailable;it(r);var c=L(),d=3===i;C(Gn(t,a),n,c.calendarFolderEvents.get(r),d,o),et({eventKey:t,folderId:r,loadState:1},n,c.fullItemsMruMap,ot(n,r))}),Object(P.mutator)(ne,function(e){var n=e.folderId,t=e.eventKey,a=L();a.calendarFolderEvents.get(n)&&r.__spread(a.fullItemsMruMap.keys()).forEach(function(e){nt(t,e,a.fullItemsMruMap)})}),Object(P.mutator)(te,function(e){var n=e.folderId,t=L(),a=t.calendarFolderEvents.get(n);if(a){var i=r.__spread(a.locksInfo.entries()).reduce(s(),{}),o=Object.keys(i);r.__spread(t.fullItemsMruMap.keys()).forEach(function(e){o.forEach(function(n){return nt(n,e,t.fullItemsMruMap)})})}}),Object(P.mutator)(Xn,function(){var e=L();r.__spread(e.fullItemsMruMap.keys()).forEach(function(n){!function(e,n){tt(e,n),n.get(e).eventInfos=[]}(n,e.fullItemsMruMap)})}),Object(P.mutator)(ve,function(e){var n=L(),t=e.lockId;!function(e,n,t){tt(n,t);var a=t.get(n),i=a.eventInfos,o=r.__read(i.filter(function(n){return n.eventKey===e}),1)[0];o&&rt(a.eventInfos.indexOf(o),o,a)}(e.eventKey,t,n.fullItemsMruMap)});var ct=t(1577),dt=t(2017),ut=t(1402),st=t.n(ut);function lt(e,n){var t;if(3==n){var r=U(e);t=r&&r.SeriesMasterItemId?Ln()({Id:r.SeriesMasterItemId.Id}):t=st()({OccurrenceId:e})}else t=Ln()({Id:e});return t}function ft(e,n){n&&Sn(e.ParentFolderId.Id)}function vt(e,n,t){var r=Object(me.a)(ct.c);return e.IsMeeting&&n&&!e.IsCancelled&&(r=e.IsOrganizer?Object(me.a)(ct.a):Object(me.a)(ct.b)),new Promise(function(e,n){Pn.e.import().then(function(n){n("instantCalendarEventDelete",t,r,{icon:"Error"},{primaryActionText:Object(me.a)(dt.a),notificationCallback:function(n){n===Pn.a.PrimaryActionClicked?e(!0):e(!1)}})})})}Object(P.orchestrator)(Se,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var n,t,a,i,o,c,d,u,s,l,f,v,p;return r.__generator(this,function(r){switch(r.label){case 0:n=e.eventId,t=e.eventScope,a=e.dataPoint,i=e.actionToExecute,o=e.onEventDeleteSuccess,c=e.onEventDeleteFailed,d=e.responseSent,u=e.actionSource,s=e.errorMessage,l=U(n.Id),f=(_=l)&&W(_.ParentFolderId.Id),function(e,n,t){if(t){var r=e.ParentFolderId.Id;if(3==n||2==n){var a=e.Start;ce(r,function(t){return t.InstanceKey==e.InstanceKey&&(3==n||2==n&&!Object(I.vb)(t.Start,a))})}else ce(r,function(n){return n.ItemId.Id===e.ItemId.Id})}}(l,t,f),a&&a.markUserPerceivedTime(),v=lt(n.Id,t),null,r.label=1;case 1:return r.trys.push([1,5,,6]),Object(Ze.d)("cal-surface-notificationBar")?[4,vt(l,d,u)]:[3,3];case 2:if(r.sent())return ft(l,f),[2];r.label=3;case 3:return[4,i(v)];case 4:if(!r.sent().isSuccessful)throw c(s),s;return[3,6];case 5:throw p=r.sent(),function(e,n,t,r,a){ft(e,t),Pn.f.import().then(function(e){e("instantCalendarEventDeleteFailed",a,n,Object(me.a)(we.a),function(){return r()},"Delete")})}(l,s,f,function(){return Se(n,t,null,i,o,c,u,s,d)},u),c(p),p;case 6:return o(),[2]}var _})})}),Object(P.orchestrator)(Ae,function(e){var n=e.eventBeforeUpdate,t=e.errorMessage,r=e.allowLocalUpdate,a=e.retryFunction,i=e.actionSource;r&&Sn(n.ParentFolderId.Id),Pn.f.import().then(function(e){e("updateCalendarEventFailed",i,t,Object(me.a)(we.a),function(){return a()},"Error")})});var pt=t(1979),It=t.n(pt),_t=t(1980),bt=t.n(_t),mt=t(948),yt=t(1301);function gt(e,n,t,a){return void 0===t&&(t=0),void 0===a&&(a=void 0),r.__awaiter(this,void 0,void 0,function(){var i,o,c,d,u,s,l,f;return r.__generator(this,function(r){switch(r.label){case 0:return i=e.Id,o=e.mailboxInfo,c=3==t||2==t,d=null,u=null,[4,Object(Je.b)(o)];case 1:(s=r.sent()||{}).datapoint={customData:{itemId:i,fetchingMasterItem:c},jsonCustomData:function(e){var n=e.Body.ResponseMessages.Items[0];return{responseClass:n.ResponseClass,responseCode:n.ResponseCode}}},r.label=2;case 2:return r.trys.push([2,,4,5]),[4,bt()({Header:Object(He.getJsonRequestHeader)(),Body:It()({EventIds:[c?a?Ln()({Id:a.Id}):st()({OccurrenceId:i}):Ln()({Id:i})],ItemShape:n,IncludeDeclinedMeetings:Object(Ze.d)("cal-surface-declinedMeetings")})},s)];case 3:return d=r.sent(),null!=(l=d.Body.ResponseMessages.Items[0])&&"Success"==l.ResponseClass&&null!=(f=l.Items[0])&&(!function(e){e.Locations?e.Locations=e.Locations.filter(function(e){return e}):e.Locations=[],e.Resources&&e.Resources.map(function(n){Object(mt.c)(e.Locations,n.Mailbox.EmailAddress)||(e.Locations=e.Locations.filter(function(e){return e.DisplayName!==n.Mailbox.Name||Object(yt.s)(e.PostalAddress)}),e.Locations.push(Object(yt.f)(n.Mailbox.Name,n.Mailbox.EmailAddress)))})}(f),u=Object(sn.a)(f,e.mailboxInfo)),[3,5];case 4:return Object(Ze.d)("cal-mf-diagnostics")&&We.a.import().then(function(e){return e({action:"GetCalendarEvent",status:"Error",response:d&&d.Body})}),[7];case 5:return[2,u]}})})}var ht=t(2040),Ot=t.n(ht),Et=t(2041),jt=t.n(Et);var Ct=t(458);function Rt(e,n,t,a){void 0===t&&(t=0),void 0===a&&(a=void 0);var i=Object(ln.r)(n);return i&&3==i.CalendarFolderType?function(e,n){return r.__awaiter(this,void 0,void 0,function(){var t,a,i,o;return r.__generator(this,function(r){switch(r.label){case 0:return t=e.Id,a=e.mailboxInfo,[4,Object(Je.b)(a)];case 1:return(r.sent()||{}).datapoint={customData:{itemId:t},jsonCustomData:function(e){return{responseClass:e&&e.Body&&e.Body.ResponseClass,responseCode:e&&e.Body&&e.Body.ResponseCode}}},[4,jt()({Header:Object(He.getJsonRequestHeader)(),Body:Ot()({CalendarItemId:Ln()({Id:t})})})];case 2:return null!=(i=r.sent()).Body&&"Success"==i.Body.ResponseClass&&null!=(o=i.Body.BirthdayEvent)?[2,en(o,n,void 0,e.mailboxInfo)]:[2,null]}})})}(e,n):gt(e,{BaseShape:"IdOnly",MaximumBodySize:0,BodyType:"HTML",InlineImageCustomDataTemplate:Ct.e,InlineImageUrlTemplate:Ct.g,AddBlankTargetToLinks:!0},t,a)}Object(P.orchestrator)($,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var n,t,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return n=e.partialCalendarEvent,t=Object(Me.G)(n.CalendarItemType)?n.InstanceKey:n.ItemId.Id,a=n.ParentFolderId.Id,null===Zn(n.ItemId.Id)?[3,2]:[4,Rt(n.ItemId,a)];case 1:(i=r.sent())&&X(a,t,i),r.label=2;case 2:return[2]}})})});var Tt=t(1800);Object(P.orchestrator)(Te,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var n,t,a,i,o,c,d,u,s,l,f,v,p,_,b,m;return r.__generator(this,function(y){switch(y.label){case 0:n=e.eventId,t=e.eventChanges,a=e.errorMessage,i=e.actionToExecute,o=e.onEventUpdateFailed,c=e.onEventUpdateSuccess,d=e.rangeToCreate,u=e.showNotification,s=e.actionSource,l=e.eventScope,f=U(n.Id),v=lt(n.Id,e.eventScope),f&&Object(Me.G)(f.CalendarItemType)&&(l=3),(p=function(e,n){if(!e)return!1;var t=e.ParentFolderId.Id;if(!W(t))return!1;var r=n.ParentFolderId;if(r&&r.Id!=t)return!1;return!0}(f,t))&&function(e,n,t,a,i,o){var c,d,u=e.ParentFolderId.Id,s=r.__assign({},e,n);if(3==t||2==t)if(n.Recurrence||n.Start||n.StartTimeZoneId||n.End||n.EndTimeZoneId||2==t){var l=e.Start;if(ce(u,function(n){return Object(Me.D)(n.CalendarItemType)&&n.InstanceKey==e.InstanceKey&&(3==t||2==t&&!Object(I.vb)(n.Start,l))}),3==t){var f=Mn(s,a);Un(f.concat(s));var v=f.map(function(e){return r.__assign({},e,{CalendarItemType:"Occurrence"})});ae(s.ParentFolderId.Id,v)}}else{var p=K(u,function(n){return n.InstanceKey==e.InstanceKey&&Object(Me.D)(n.CalendarItemType)});try{for(var _=r.__values(p),b=_.next();!b.done;b=_.next()){var m=b.value,y=m;pe(y,n),Oe(y)}}catch(e){c={error:e}}finally{try{b&&!b.done&&(d=_.return)&&d.call(_)}finally{if(c)throw c.error}}}if(!Object(Me.w)(e.CalendarItemType)||3!=t){var g=null==e.InstanceKey||Object(Me.D)(e.CalendarItemType)||Object(Me.w)(e.CalendarItemType);Cn(s,g,!0)}if(Object(Ze.d)("cal-surface-notificationBar")&&i){var h=s.IsMeeting||s.RequiredAttendees.length>0||s.OptionalAttendees.length>0,O=h?Object(me.a)(Tt.b):Object(me.a)(Tt.a),E={icon:h?"Send":"Save"};setTimeout(function(){Pn.e.import().then(function(e){e("instantCalendarEventUpdate",o,O,E)})},0)}}(f,t,l,d,u,s),_=function(){return Te(n,t,l,d,i,c,o,s,a)},b=null,y.label=1;case 1:return y.trys.push([1,3,,4]),[4,i(v)];case 2:return b=y.sent(),[3,4];case 3:throw m=y.sent(),Ae(f,a,p,_),o(m),m;case 4:if(!b.isSuccessful)throw Ae(f,a,p,_),o(a),a;return c(),[2]}})})});var St=t(2042),At=t.n(St),Ft=t(2043),wt=t.n(Ft);var Mt,Nt=t(436),kt={RowAdded:"RowAdded",RowModified:"RowModified",RowDeleted:"RowDeleted",Reload:"Reload"},Dt=2e3,Pt={},xt={},Lt=[],Kt=!0,Ut={};function Bt(e){Pt[e]?R.c.info("[CalendarNotifications] Already subscribed to notifications on folder: "+e):Nt.b.import().then(function(n){var t={ChannelId:n(),NotificationType:"CalendarItemNotification",FolderId:e,IncludeDeclinedMeetings:Object(Ze.d)("cal-surface-declinedMeetings")},r={subscriptionId:""+t.NotificationType+e+(Object(Ze.d)("cal-surface-declinedMeetings")?"declinedMeetings":""),requiresExplicitSubscribe:!0,subscriptionParameters:t},a={folderId:e,subscription:r};R.c.info("[CalendarNotifications] Subscribing calendar item notifications. Folder: "+e),Nt.f.importAndExecute(r,Vt),Pt[e]=a})}function zt(e){var n=Pt[e];n?(R.c.info("[CalendarNotifications] Unsubscribing calendar item notifications. Folder: "+e),Nt.g.importAndExecute(n.subscription,Vt),delete Pt[e]):R.c.warn("[CalendarNotifications] Could not unsubscribe notifications on folder: '"+e+"', subscription data not found")}function Vt(e){Ht(e,!0),function(e){if(Wt(e.NotificationPayload))R.c.info("[CalendarNotifications]: A reload notification will be enqueued. All existing notifications will be discarded."),(Lt=[])[0]=e;else{for(var n=Lt.length-1;n>=0;n--){var t=Lt[n].NotificationPayload.Item,r=void 0,a=void 0,i=void 0;if(null!=e.NotificationPayload.Item.InstanceKey?(a=e.NotificationPayload.Item.InstanceKey,r=t.InstanceKey,i="InstanceKey"):(a=e.NotificationPayload.Item.ItemId.Id,r=t.ItemId.Id,i="ItemId"),a===r){R.c.info("[CalendarNotifications]: Found an existing notification in the queue for the same "+i+". Old notification will be removed."),Lt[n].InstanceKeyToDelete&&(e.InstanceKeyToDelete=Lt[n].InstanceKeyToDelete),Lt.splice(n,1);break}}var o=!1;if(null!=e.NotificationPayload.Item.InstanceKey)if(e.NotificationPayload.EventType==kt.RowModified&&Object(Me.G)(e.NotificationPayload.Item.CalendarItemType)&&null!=e.NotificationPayload.Item.UID&&(xt[e.NotificationPayload.Item.InstanceKey]=e.NotificationPayload.Item.UID),e.NotificationPayload.EventType===kt.RowAdded||e.NotificationPayload.EventType===kt.RowModified){for(var n=Lt.length-1;n>=0;n--)if(Lt[n].NotificationPayload.EventType===kt.RowDeleted&&Lt[n].OriginalUID==e.NotificationPayload.Item.UID){R.c.info('[CalendarNotifications]: "Found an existing RowDeleted notification in the queue for the same UID, which will be removed from the queue.'),e.InstanceKeyToDelete=Lt[n].NotificationPayload.Item.InstanceKey,Lt.splice(n,1);break}}else if(e.NotificationPayload.EventType===kt.RowDeleted){var c=xt[e.NotificationPayload.Item.InstanceKey];if(delete xt[e.NotificationPayload.Item.InstanceKey],c){e.OriginalUID=c;for(var n=Lt.length-1;n>=0;n--){var d=Lt[n].NotificationPayload.Item.UID;if((Lt[n].NotificationPayload.EventType===kt.RowAdded||Lt[n].NotificationPayload.EventType===kt.RowModified)&&d==c){R.c.info('[CalendarNotifications]: "Found an existing RowAdded or RowModified notification in the queue for the same UID, which will be merged with the RowDelete.'),Lt[n].InstanceKeyToDelete=e.NotificationPayload.Item.InstanceKey,o=!0;break}}}}o?R.c.info("[CalendarNotifications]: RowDeleted notification was merged with a RowAdded notification for the same UID and will not be enqueued."):(R.c.info("[CalendarNotifications]: Notification will be enqueued."),Lt.push(e))}R.c.info("[CalendarNotifications]: Notification queue length is: "+Lt.length)}({NotificationPayload:e,InstanceKeyToDelete:null,OriginalUID:null}),Kt?(Mt&&(R.c.info("[CalendarNotifications]: Notification processing timer was already started. It will be cancelled and restarted."),clearTimeout(Mt)),Mt=setTimeout(qt,Dt),R.c.info("[CalendarNotifications]: Timer to drain queue has started.")):R.c.info("[CalendarNotifications]: The notification was received while notification processing was suspended.")}function Gt(e){if(Ht(e.NotificationPayload,!1),Wt(e.NotificationPayload))Zt();else{var n=e.NotificationPayload.FolderId,t=W(n),i=G(n),o=Object(ln.r)(n);o&&3==o.CalendarFolderType?Zt(n,!0):t&&i.length>0?e.NotificationPayload.EventType==kt.RowDeleted?function(e,n){var t=n.Item.InstanceKey;Ut[t]&&(R.c.info("[CalendarNotifications] Received delete notification for a recurring series we are currently expanding items for.\n            Ignoring expansion. Instance key: "+t),delete Ut[t]);ie(e,t)}(n,e.NotificationPayload):Object(Me.G)(e.NotificationPayload.Item.CalendarItemType)?function(e,n){var t=Object(sn.a)(n.NotificationPayload.Item);if(t.UID){var i=G(e),o=En(i);o.forEach(function(i){var o=function(e,n){return r.__awaiter(this,void 0,void 0,function(){var t,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return t={Header:Object(He.getJsonRequestHeader)(),Body:At()({EventId:Ln()({Id:e.Id}),WindowStart:Object(I.hb)(n.start),WindowEnd:Object(I.hb)(n.end),ReturnMaster:!0,ReturnRegularOccurrences:!0,ReturnExceptions:!0,ReturnCancellations:!0,IncludeDeclinedMeetings:Object(Ze.d)("cal-surface-declinedMeetings")})},a=wt.a,i=[t],[4,Object(Je.b)(e.mailboxInfo)];case 1:return[4,a.apply(void 0,i.concat([r.sent()]))];case 2:return[2,r.sent().Body]}})})}(t.ItemId,i);Ut[t.InstanceKey]=o,o.then(function(r){r&&"Success"==r.ResponseClass?function(e,n,t,r,i,o,c){if(Qt(e,n)){R.c.info("[CalendarNotifications] Action to expand series completed successfully. Retrieved "+(i?i.length:0)+" items.");var d=G(r),u=d.some(function(e){return Object(a.b)(t,e)});u?(Yt(i,e.ItemId.Id,e.InstanceKey,c,r),$(o),Rn(r,i),i.forEach(function(e){$(e)})):Sn(r),delete Ut[e.InstanceKey]}}(t,o,i,e,r.Occurrences.map(function(e){return Object(sn.a)(e)}),Object(sn.a)(r.RecurrenceMaster),n.InstanceKeyToDelete):Jt(t,o,e,n.InstanceKeyToDelete,r)}).catch(function(r){Jt(t,o,e,n.InstanceKeyToDelete,null,r.message)})})}}(n,e):function(e,n){var t=Object(sn.a)(n.Item),r=!1;switch(n.EventType){case kt.RowAdded:r=!0;break;case kt.RowModified:r=null==t.InstanceKey||Object(Me.D)(t.CalendarItemType)||Object(Me.w)(t.CalendarItemType),function(e,n,t){var r=Object(sn.a)(n.Item),a=Tn(e,r,t);if(a){var i=0!=Object(I.l)(a.Start,r.Start),o=0!=Object(I.l)(a.End,r.End);Object(tn.o)("ProcessedSingleItemNotification",{NotificationType:n.EventType,ItemType:r.CalendarItemType,isStartTimeChanged:i,isEndTimeChanged:o},{isVerbose:!0})}}(e,n,r)}Cn(t,r,!1,!0)}(n,e.NotificationPayload):t?R.c.warn("[CalendarNotifications]: Events cache not yet loaded once for folder "+e.NotificationPayload.FolderId+"."):R.c.warn("[CalendarNotifications]: Events cache was empty for folder "+e.NotificationPayload.FolderId+".")}}function qt(){var e=Lt.length;if(e>=8||Lt.some(function(e){return Wt(e.NotificationPayload)}))Zt();else for(var n=0;n<e;n++){Gt(Lt[n])}Lt=[],xt={},clearTimeout(Mt)}function Ht(e,n){var t=e.Item&&e.Item.ItemId?e.Item.ItemId.Id:"<null>",r=e.Item&&e.Item.InstanceKey?e.Item.InstanceKey:"<null>",a=n?"Got calendar notification":"Now Processing calendar notification";if(R.c.info("[CalendarNotifications] '"+new Date(Date.now()).toString()+": "+a+"':\n        Type: '"+e.EventType+"',\n        FolderId: '"+e.FolderId+"',\n        ItemId: '"+t+"',\n        InstanceKey: '"+r+"'"),n){var i=e.Item?e.Item.CalendarItemType:"<null>";Object(tn.o)("IncomingNotification",{NotificationType:e.EventType,ItemType:i,ItemId:t},{isCosmosDatapoint:!0})}}function Wt(e){return e.EventType==kt.Reload||e.Reload}function Zt(e,n){var t,a;void 0===n&&(n=!1);var i=e?[e]:Object.keys(Pt);try{for(var o=r.__values(i),c=o.next();!c.done;c=o.next()){Sn(c.value,n)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(a=o.return)&&a.call(o)}finally{if(t)throw t.error}}}function Jt(e,n,t,r,a,i){if(void 0===i&&(i=null),Qt(e,n)){if(a&&"ErrorItemNotFound"==a.ResponseCode)R.c.warn("[CalendarNotifications] Action to expand recurring series failed with item not found because item is not on the server. Removing series.\n                Item Instance Key: "+e.InstanceKey),Yt(void 0,e.ItemId.Id,e.InstanceKey,r,t);else{var o=a?a.ResponseCode+": "+a.MessageText:i;R.c.warn("[CalendarNotifications] Action to expand recurring series failed for unknown reason, reloading cache.\n                Item Instance Key: "+e.InstanceKey+",\n                Message: '"+o+"'"),Sn(t)}delete Ut[e.InstanceKey]}}function Qt(e,n){var t=Ut[e.InstanceKey];return t&&t==n}function Yt(e,n,t,r,a){var i=e?e.map(function(e){return e.UID}):void 0,o=function(e){return e.InstanceKey==t||r&&e.InstanceKey==r||e.InstanceKey==e.ClientSeriesId||e.SeriesMasterItemId.Id===n||i.includes(e.UID)};ce(a,function(e){return e.ClientSeriesId&&o(e)});var c=K(a,o);ge(c)}function Xt(){Kt&&(clearTimeout(Mt),R.c.info("[CalendarNotifications]: Processing of notifications will be suspended"),Kt=!1)}function $t(){Kt||(Kt=!0,R.c.info("[CalendarNotifications]: Processing of notifications will be resumed"),Mt=setTimeout(qt,Dt))}function er(e){var n=Object(ln.x)(e),t=n&&Object(ln.s)({id:n});return t?t.CharmId:null}function nr(e){return e&&e.CharmId||er(e.ParentFolderId.Id)}function tr(){var e;(e=L(),r.__spread(e.calendarFolderEvents.keys())).map(function(e){return jn(e)})}function rr(e,n){return n||Object(Me.G)(e.CalendarItemType)?e.InstanceKey:e.ItemId.Id}function ar(e){var n=e.StartTimeZoneId,t=e.Recurrence,r=Object(I.Vb)();return Mn(e,{start:r,end:Object(An.a)(n,t)||Object(I.h)(r,1)})}var ir=t(167),or=t(229),cr=5e3;function dr(e,n,t,r,a,i){if(void 0===a&&(a=!0),0!==t.length){var o=new ir.a("FreeBusyAvailabilityRequested");o.addCustomData({numAttendees:t.length}),Qe(e,n,t,"DetailedMerged",e.tz,i).then(function(c){o.end();var d={};if("Success"===c.ResponseClass&&t.length===c.Responses.length)for(var u=0;u<t.length;u++){var s=t[u],l=c.Responses[u];d[s]=l.CalendarView}else t.forEach(function(e){return d[e]={FreeBusyViewType:"None"}});a&&(Object.keys(d).filter(function(e){return"None"==d[e].FreeBusyViewType}).length>0&&dr(e,n,t,r,!1,i));r(d)},function(c){if(o.endWithError("ServerError",c),R.c.warn('[getAvailabilityFunction] Received error calling getUserAvailabilityService, Error: "'+c.stack+'"'),a)c&&"GetUserAvailabilityInternal failed: Microsoft.Exchange.Services.Core.Types.ErrorApiQuarantinedException"==c.message&&Object(or.a)(cr),dr(e,n,t,r,!1,i);else{var d={};t.forEach(function(e){return d[e]={FreeBusyViewType:"None"}}),r(d)}})}}var ur=t(98),sr={};function lr(e){return sr[e]||null}function fr(e,n,t,a,i){void 0===t&&(t=null),void 0===a&&(a=function(){return null}),void 0===i&&(i=0);var o,c=3===i,d=function(e,n){return function(t){var r=U(t.Id,e);return r||n&&n(t)}}(t,a),u=Hn(n.Id);if(u)o=function(e,n,t,a,i){var o=i(n),c=3==a;if(o&&c)return vr(e,o);if(!o&&c)return null;switch(t.loadState){case 1:return{event:o,fullEventPromise:Promise.resolve(o),promiseSource:2};case 0:return{event:o,fullEventPromise:lr(n.Id),promiseSource:0};case 2:var d=pr(o,n.Id,n,a,e);return r.__assign({event:o},d);default:return Object(ur.a)(t.loadState)}}(t=t||u.folderId,n,u,i,d);else{var s=d(n);if(s&&c)o=vr(t=t||s.ParentFolderId.Id,s);else{if(!s&&c)return null;var l=pr(s,n.Id,n,i,t||(s?s.ParentFolderId.Id:null));o=r.__assign({event:s},l)}}if(o){var f=c||o.event&&Object(Me.G)(o.event.CalendarItemType)?o.event.InstanceKey:n.Id;t=t||(o.event?o.event.ParentFolderId.Id:null),o=r.__assign({},o,{fullEventPromise:Ir(o.fullEventPromise,o.promiseSource,o.event,e,t,f,i)})}return o}function vr(e,n){var t=n.InstanceKey,a=Hn(t);if(a&&1===a.loadState){var i=B(t,e);return{event:i,fullEventPromise:Promise.resolve(i),promiseSource:2}}return a&&0===a.loadState?{event:B(t,e)||n,fullEventPromise:lr(t),promiseSource:0}:{event:r.__assign({},n),fullEventPromise:_r(t,n.ItemId,3,n.ParentFolderId.Id,n.SeriesMasterItemId),promiseSource:0}}function pr(e,n,t,r,a){return!e||Object(Me.s)(e)?{fullEventPromise:_r(n,t,r,a,e&&e.SeriesMasterItemId),promiseSource:0}:{fullEventPromise:Promise.resolve(e),promiseSource:1}}function Ir(e,n,t,a,i,o,c){return r.__awaiter(this,void 0,void 0,function(){var d,u,s,l,f;return r.__generator(this,function(r){switch(r.label){case 0:d=Wn(a,o),r.label=1;case 1:return r.trys.push([1,5,,6]),R.c.info("[fetchFullCalendarEvent] Handling loading full calendar event Key: "+o+", Lock: "+a),!i||d&&1===d.loadState||(R.c.info("[fetchFullCalendarEvent] Loading full calendar event Key: "+o+", Lock: "+a),J(a,i,o,t)),2!=n?[3,2]:(u=t,[3,4]);case 2:return[4,e];case 3:u=r.sent(),r.label=4;case 4:if(!u)throw new Error("[fetchFullCalendarEvent] Unable to fetch full calendar event for event Key: "+o);return s=i||u.ParentFolderId.Id,f=d,d=Wn(a,o),!s||d&&1===d.loadState?(R.c.info('[fetchFullCalendarEvent] Full calendar event already loaded. EventKey: "'+o+'", Lock: "'+a+'", FolderId: "'+s+'"'),ve(a,o)):(R.c.info('[fetchFullCalendarEvent] Loaded full calendar event Key: "'+o+'", Lock: "'+a+'", FolderId: "'+s+'"'),Object(tn.o)("FullCalendarEventLoaded",{eventKey:o,lockId:a,prevFullItemLoadState:f?f.loadState:null,fullItemLoadState:d?d.loadState:null,isFullItem:void 0!==u.RequiredAttendees,isSameAsExistingEvent:t===u}),Y(a,s,o,u,c,0===n)),[2,B(o,i)];case 5:throw l=r.sent(),R.c.warn("[fetchFullCalendarEvent] Received error when fetching for "+o+" with error "+l),f=d,d=Wn(a,o),Object(tn.o)("FullCalendarEventLoaded",{eventKey:o,lockId:a,prevFullItemLoadState:f?f.loadState:null,fullItemLoadState:d?d.loadState:null,isFullItem:!1,isSameAsExistingEvent:!1}),i&&Q(a,i,o),l;case 6:return[2]}})})}function _r(e,n,t,a,i){var o=this,c=r.__awaiter(o,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,,2,3]),[4,br(_n,n,t,a,i)];case 1:return[2,r.sent()];case 2:return function(e){delete sr[e]}(e),[7];case 3:return[2]}})});return function(e,n){sr[e]=n}(e,c),c}function br(e,n,t,a,i){return r.__awaiter(this,void 0,void 0,function(){var o,c,d;return r.__generator(this,function(r){switch(r.label){case 0:o=0,r.label=1;case 1:if(!(o<e))return[3,6];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Rt(n,a,t,i)];case 3:return c=r.sent(),o++,c||o>=e?[2,c]:[3,5];case 4:if(d=r.sent(),R.c.warn('[fetchFullCalendarEvent] Received error when trying to load calendar event from server for "'+n.Id+'" with try '+o+": Error "+d.toString()),++o>=e)throw d;return[3,5];case 5:return[3,1];case 6:return[2,null]}})})}function mr(e){if(!e)throw new Error("The lock id should be provided");return{fetchCalendarEventsForDateRange:function(n,t){return hn(e,n,t)},fetchFullCalendarEvent:function(n,t,r,a){return fr(e,n,t,r,a)},getLockId:function(){return e},release:function(){return ue(e)}}}function yr(){return mr(function(){var e="events_cache_lock_"+N;return N++,e}())}function gr(e){return{getCalendarEventsForDateRange:function(n,t){return Ne(e,n,t)},getFullCalendarEvent:function(n,t){return z(n,t,e)}}}t.d(n,"k",function(){return hr}),t.d(n,"c",function(){return ge}),t.d(n,"b",function(){return he}),t.d(n,"a",function(){return Oe}),t.d(n,"f",function(){return je}),t.d(n,"w",function(){return Ce}),t.d(n,"t",function(){return Re}),t.d(n,"v",function(){return Te}),t.d(n,"u",function(){return Se}),t.d(n,"d",function(){return Xn}),t.d(n,"z",function(){return Bt}),t.d(n,"B",function(){return zt}),t.d(n,"y",function(){return $t}),t.d(n,"A",function(){return Xt}),t.d(n,"j",function(){return er}),t.d(n,"m",function(){return nr}),t.d(n,"p",function(){return lt}),t.d(n,"l",function(){return Z}),t.d(n,"o",function(){return Zn}),t.d(n,"x",function(){return tr}),t.d(n,"n",function(){return rr}),t.d(n,"g",function(){return ar}),t.d(n,"i",function(){return dr}),t.d(n,"s",function(){return Qe}),t.d(n,"e",function(){return yr}),t.d(n,"r",function(){return mr}),t.d(n,"q",function(){return gr}),t.d(n,"h",function(){return H});var hr=U},1649:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(6),a=t(852);function i(e,n,t){if(e&&n&&t){var i=Object(r.s)(n,e),o=Object(a.a)(e.tz,t,e);return{start:o,end:Object(r.Eb)(n.tz,Object(r.d)(o,i))}}return null}},1656:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(1149);function a(e,n,t){return e&&n&&t?Object(r.a)(e,n.tz,t,n):null}},1657:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(1149);function a(e,n,t){return e&&n&&t?Object(r.a)(e,n.tz,n,t):null}},1658:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(6),a=t(852);function i(e,n,t,i){if(e&&n&&t){var o=Object(a.a)(e.tz,e,t),c=n;if(!Object(r.vb)(o,n)||i){var d=Object(r.s)(n,e);c=Object(r.Eb)(n.tz,Object(r.d)(o,d))}return{start:o,end:c}}return null}},1666:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(1145),a=t(6);function i(e,n){return e&&null!=n?Object(r.c)(Object(a.Kb)(e),n+1):null}},1678:function(e,n,t){"use strict";function r(e){var n=0,t=[];function r(){n-=1,t.length>0&&t.shift()()}return{add:function(a){return new Promise(function(i,o){var c=function(){n+=1,a().then(function(e){r(),i(e)},function(e){r(),o(e)})};n===e?t.push(c):c()})},getRunningCount:function(){return n},getQueueLength:function(){return t.length}}}t.d(n,"a",function(){return r})},1757:function(e){e.exports={a:"Qlb"}},1773:function(e){e.exports={a:"Rlb"}},1783:function(e,n,t){"use strict";var r;!function(e){e[e.Primary=0]="Primary",e[e.Secondary=1]="Secondary"}(r||(r={})),n.a=r},1800:function(e){e.exports={b:"Osb",a:"Psb"}},1935:function(e,n,t){"use strict";function r(e){var n=[];return e&&e.forEach(function(e){n.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress})}),n}t.d(n,"a",function(){return r})},1978:function(e,n,t){"use strict";t.d(n,"a",function(){return r}),t.d(n,"b",function(){return a}),t.d(n,"c",function(){return i});var r=2,a="",i=-1},2003:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.ForceDismissedFromCode=11]="ForceDismissedFromCode"}(r||(r={}))},2017:function(e){e.exports={a:"zHa"}},2054:function(e,n,t){"use strict";var r,a=t(674),i={TxpActivity:"TxpActivity",flightdeparture:a.a.FlightDeparture,hotelcheckin:a.a.HotelCheckin,hotelcheckout:a.a.HotelCheckout,invoicedue:a.a.InvoiceDue,invoicescheduled:a.a.InvoiceScheduled,parceldelivery:a.a.ParcelDelivery,rentalcarpickup:a.a.RentalCarPickup,rentalcardropoff:a.a.RentalCarDropOff,dining:a.a.Dining,miscevent:a.a.EventActivityType,serviceappointment:a.a.ServiceAppointment};!function(e){e[e.None=0]="None",e[e.Unexpected=1]="Unexpected",e[e.Configuration=2]="Configuration",e[e.Trust=3]="Trust",e[e.Error=4]="Error",e[e.ByDesign=5]="ByDesign",e[e.InThePast=6]="InThePast",e[e.SharedEvent=7]="SharedEvent"}(r||(r={}));var o=r,c={EventReservation:"miscevent",FlightReservation:"flightdeparture",FoodEstablishmentReservation:"dining",Invoice:"invoicedue",LodgingReservation:"hotelcheckin",ParcelDelivery:"parceldelivery",RentalCarReservation:"rentalcarpickup",ServiceReservation:"serviceappointment"},d=t(1783),u={primary:d.a.Primary,secondary:d.a.Secondary},s=t(1978);function l(e,n,t,r){return{activityId:n.toString(),type:t,entityId:e,calendarEventIdIndex:s.c,eventOmission:o.None,role:u.primary,activityName:r}}var f={none:o.None,unexpected:o.Unexpected,configuration:o.Configuration,trust:o.Trust,error:o.Error,bydesign:o.ByDesign,inthepast:o.InThePast,sharedevent:o.SharedEvent};function v(e,n){var t=e.type?e.type.toLowerCase():null,r=i[t];return r?function(e,n,t,r){var a=e.calendarEventOmission?e.calendarEventOmission.toLowerCase():null,i=e.role?e.role.toLowerCase():null,o=f[a],c=u[i];return{activityId:r.toString(),type:n,entityId:e.entityId,calendarEventIdIndex:e.calendarEventIdIndex,eventOmission:o,role:c,activityName:t}}(e,r,t,n):null}var p=t(293),I=t(1546),_="schema.org parser",b="schema",m="extraction";function y(e,n){if(e){var t=n?e["@EntityId"]:e["@id"];if(t){var r=I.a[e["additionalType/Txp"]],a=e["@source"],i=function(e,n){var t=null;return null!=e?t=I.a[e]:n&&(t=n.toLowerCase().indexOf(_)>-1?b:m),t}(r,a),o=e["originEmails/Txp"],c=e["@inferenceId"],d=e.immutableMessageIds,u=null,s=null,l=null;return o&&o.length&&(u=o[0].ewsId,s=o[0].receivedTime,l=o[0].internetMessageId),{id:t,source:a,trustScore:e["@entityExtractionTrustLevel"],txpAdditionalType:r,origin:i,originalEmailEwsId:u,originalEmailReceivedTime:s,originalEmailInternetMessageId:l,inferenceId:c,immutableMessageIds:d}}}return null}var g=t(0),h=t(496);function O(e,n){return e&&n?g.__assign({basicEntity:e},{name:n.name,phone:n.phone}):null}function E(e,n,t){if(e&&n){var r=void 0;if(n.reservationId)r=n.reservationId;else if(n.reservationNumber)r=n.reservationNumber;else if(!t)return null;var a=n.underName,i=g.__assign({},e,{reservationId:r,reservationStatus:n.reservationStatus,modifyReservationUrl:n.modifyReservationUrl,underName:O({},a)}),o=n.reservedTicket;if(o){var c=o.ticketSeat;i=g.__assign({},i,{reservedTicket:{ticketNumber:o.ticketNumber,seat:{row:c?c.seatRow:null,seatNumber:c?c.seatNumber:null,section:c?c.seatSection:null}}})}return i}return null}function j(e,n){return e&&n?g.__assign({},e,{streetAddress:n.streetAddress,addressLocality:n.addressLocality,addressRegion:n.addressRegion,addressCountry:n.addressCountry,postalCode:n.postalCode,postOfficeBoxNumber:n.postOfficeBoxNumber}):null}function C(e){var n=j({},e.reservationFor.address);return{name:e.reservationFor.name,address:n,telephone:e.reservationFor.telephone,city:e.reservationFor.city}}function R(e,n){if(e&&n){var t=g.__assign({},e,{name:n.name,telephone:n.telephone,city:n["address/commonCity"]});return n.address&&(t=g.__assign({},t,{address:g.__assign({},n.address)})),t}return null}var T="numSeats";function S(e){var n=0;return e[T]&&e[T]>0&&(n=parseInt(e[T],10)-1),n}function A(e,n){return e&&n?e=R(e=g.__assign({},e,{iataCode:n.iataCode}),n):null}function F(e,n,t){if(e&&n){var r=E(e,n,!1);if(function(e,n,t){if(e&&e.reservationFor&&e.reservationFor.provider){var r=e.reservationFor,a=e.reservationFor.provider,i=!t||t(r.arrivalTime,!1,n)&&t(r.arrivalTimeUTC,!0,n)&&t(r.departureTime,!1,n)&&t(r.departureTimeUTC,!0,n);if(a.iataCode&&a.name&&w(r.arrivalAirport)&&w(r.departureAirport)&&r.flightNumber&&r.arrivalTime&&r.departureTime&&i)return!0}return!1}(n,e,t)){var a=n.reservationFor,i=a.provider;return r=g.__assign({},r,{entityName:p.a.FlightReservation,entityType:h.a.FlightReservation,checkinUrl:n.checkinUrl?n.checkinUrl:n.potentialAction?n.potentialAction.target:null,departureTime:a.departureTime,departureTimeUTC:a["departureTime/utc"],departureTerminal:a.departureTerminal,departureGate:a.departureGate,departureTimeZone:a["departureTime/windowsTimeZoneName"],arrivalTime:a.arrivalTime,arrivalTimeUTC:a["arrivalTime/utc"],arrivalTerminal:a.arrivalTerminal,arrivalGate:a.arrivalGate,arrivalTimeZone:a["arrivalTime/windowsTimeZoneName"],flightNumber:a.flightNumber,airline:{name:i.name,iataCode:i.iataCode}}),r=g.__assign({},r,{departureAirport:A(r,a.departureAirport)}),r=g.__assign({},r,{arrivalAirport:A(r,a.arrivalAirport)})}}return null}function w(e){return!!(e&&e.iataCode&&(e["address/commonCity"]||e.address&&e.address.addressLocality))}function M(e,n){return e&&n?g.__assign({basicEntity:e},{name:n.name,telephone:n.telephone}):null}function N(e){if(e){if(!Array.isArray(e))return e;if(e.length>0)return e[0]}}function k(e,n){return e&&n?g.__assign({},e,{price:n.price,priceCurrency:n.priceCurrency}):null}function D(e,n,t){if(e&&n&&function(e,n,t){if(e){var r=!0,a=!0;t&&(r=t(e.expectedArrivalFrom,!1,n),a=t(e.expectedArrivalUntil,!1,n));var i=N(e.partOfOrder);if(i&&i.seller&&i.seller.name&&(e.expectedArrivalFrom&&r||e.expectedArrivalUntil&&a))return!0}return!1}(n,e,t)){var r=N(n.partOfOrder),a=r.seller,i=g.__assign({},e,{entityName:p.a.ParcelDelivery,entityType:h.a.ParcelDelivery,trackingUrl:n.trackingUrl,trackingNumber:n.trackingNumber,expectedArrivalFrom:n.expectedArrivalFrom,expectedArrivalUntil:n.expectedArrivalUntil,expectedArrivalUntilUtc:n["expectedArrivalUntil/utc"],deliveryAddress:{},partOfOrder:{orderNumber:r.orderNumber,orderStatus:r.orderStatus,seller:{name:a.name,telephone:a.telephone}}});i.provider=M({},n.provider),i.deliveryAddress=j({},n.deliveryAddress);var o=N(n.partOfOrder.orderedItem);return o&&(i.partOfOrder=g.__assign({},i.partOfOrder,{orderedItem:{url:o.url,name:o.name,sku:o.sku,description:o.description,brand:o.brand,color:o.color}})),i}return null}function P(e,n){if(n=N(n),e&&n){var t=g.__assign({},e,{name:n.name,description:n.addressLocality,model:n.model});return n.brand&&(t=g.__assign({},t,{brand:g.__assign({},n.brand)})),t}return null}function x(e,n,t,r,a){if(e){var i=y(e,r);if(i){switch(e["@type"]){case p.a.FlightReservation:i=F(i,e,a);break;case p.a.RentalCarReservation:i=function(e,n,t){if(e&&n&&function(e,n,t){var r=!t||t(e.pickupTime,!1,n)&&t(e.dropoffTime,!1,n);return!!(e.reservationFor&&e.dropoffLocation&&e.pickupLocation&&e.pickupTime&&e.dropoffTime&&r)}(n,e,t)){var r=E(e,n,!0);return r=g.__assign({},r,{entityName:p.a.RentalCarReservation,entityType:h.a.RentalCarReservation,pickupTime:n.pickupTime,pickupTimeUTC:n["pickupTime/utc"],dropoffTime:n.dropoffTime,dropoffTimeUTC:n["dropoffTime/utc"],car:P(r,n.reservationFor),dropoffLocation:R(r,n.dropoffLocation),pickupLocation:R(r,n.pickupLocation),provider:n.provider})}return null}(i,e,a);break;case p.a.ParcelDelivery:i=D(i,e,a);break;case p.a.LodgingReservation:i=function(e,n,t){if(e&&n&&function(e,n,t){if(e){var r=!t||t(e.checkinTime,!1,n)&&t(e.checkoutTime,!1,n);if(e.checkinTime&&e.checkoutTime&&e.reservationFor&&r)return!0}return!1}(n,e,t)){var r=E(e,n,!0),a=N((r=g.__assign({},r,{entityName:p.a.LodgingReservation,entityType:h.a.LodgingReservation,checkinTime:n.checkinTime,checkoutTime:n.checkoutTime,checkinTimeUTC:n["checkinTime/utc"],checkoutTimeUTC:n["checkoutTime/utc"],lodgingBusiness:{}})).lodgingBusiness);return a.address=j({},n.reservationFor.address),a.name=n.reservationFor.name,a.telephone=n.reservationFor.telephone,r}return null}(i,e,a);break;case p.a.FoodReservation:i=function(e,n,t){if(e&&n&&function(e,n,t){var r=!t||t(e.startTime,!1,n);return!!(e&&e.startTime&&e.underName&&e.underName.name&&e.reservationFor&&e.reservationFor.name&&r)}(n,e,t)){var r=E(e,n,!0);return r=g.__assign({},r,{entityName:p.a.FoodReservation,entityType:h.a.FoodReservation,startTime:n.startTime,startTimeUTC:n["startTime/utc"],partySize:Number(n["partySize/excludingOrganizer"]),restaurantInfo:C(n)})}return null}(i,e,a);break;case p.a.EventReservation:i=function(e,n){if(e&&n&&function(e){return!!(e&&e.reservationFor&&e.reservationFor.startDate&&e.underName&&e.underName.name)}(n)){var t=E(e,n,!0),r=n.reservationFor;if(r)return t=g.__assign({},t,{entityName:p.a.EventReservation,entityType:h.a.EventReservation,name:n.underName.name,startDate:r.startDate,startDateUtc:r["startDate/utc"],endDate:r.endDate,endDateUtc:r["endDate/utc"],numSeats:S(n),location:R(t,r.location),eventName:r.name})}return null}(i,e);break;case p.a.Invoice:i=n?function(e,n,t){var r,a,i;return e&&n&&function(e,n,t){var r=!t||t(e.scheduledPaymentDate,!1,n)||t(e.paymentDueDate,!1,n);return!!(e&&(e.accountId||e.accountIdEndsIn)&&e.provider&&e.provider.name&&(e.scheduledPaymentDate||e.paymentDueDate)&&r)}(n,e,t)?g.__assign({},e,{entityName:p.a.Invoice,entityType:h.a.Invoice,accountId:n.accountId,accountIdEndsIn:n["accountId/ending"],billingPeriod:n.billingPeriod,scheduledPaymentDate:n.scheduledPaymentDate,broker:M({},n.broker),category:n.category,customer:n.customer,provider:M({},n.provider),minimumPaymentDue:k({},n.minimumPaymentDue),totalPaymentDue:k({},n.totalPaymentDue),paymentDueDate:n.paymentDueDate,potentialAction:(r={},a=n.potentialAction,i=N(a),r&&i?g.__assign({},r,{url:i.url,description:i.description}):null),paymentStatus:n.paymentStatus}):null}(i,e,a):null;break;case p.a.ServiceReservation:i=t?function(e,n,t){if(e&&n&&function(e,n,t){if(e){var r=e.reservationFor,a=!t||t(r.startTimeFrom,!1,n);if(r&&r.name&&r.startTimeFrom&&a&&r.provider&&r.provider.name)return!0}return!1}(n,e,t)){var r=E(e,n,!0),a=n.reservationFor;return r=g.__assign({},r,{entityName:p.a.ServiceReservation,entityType:h.a.ServiceReservation,startTimeFrom:a.startTimeFrom,startTimeFromUtc:n.reservationFor["startTimeFrom/utc"],endTimeFrom:a.endTimeFrom,endTimeFromUtc:n.reservationFor["endTimeFrom/utc"],name:a.name,underName:O(r,n.underName),provider:O(r,a.provider),location:R({},a.location),confirmReservationUrl:n.confirmReservationUrl,modifyReservationUrl:n.modifyReservationUrl})}return null}(i,e,a):null;break;default:return null}return i}}return null}function L(e,n,t,r,a,o){if(e){var d=void 0,u=void 0;try{u=JSON.parse(e)}catch(e){u=null}if(u)if(d=function(e,n,t,r,a){var i={},o=[];return e&&e.forEach(function(e){var c=x(e,n,t,r,a);if(!c)return null;i[c.id]=c,o.push(c)}),0==Object.keys(i).length?null:{entitiesDictionary:i,entitiesArray:o}}(function(e){var n;if(e){var t=e.filter(function(e){return e.type!=i.TxpActivity}).map(function(e){return e.entities});n=[].concat.apply([],t)}return 0!=n.length?n:null}(u),n,t,a,o)){var s=void 0;if(r)s=function(e){var n;if(e){n=[];for(var t=0;t<e.length;t++){var r=e[t],a=c[r.entityName],o=i[a];o&&n.push(l(r.id,t,o,a))}}return n}(d.entitiesArray);else s=function(e,n){if(e){for(var t=[],r=0;r<e.length;r++){var a=e[r];if(a&&n&&n[a.entityId]){var i=v(a,r);if(!i)return null;t.push(i)}}return 0==t.length?null:t}return null}(((f=u)&&(p=f.filter(function(e){return e.type==i.TxpActivity}).map(function(e){return e.entities})),0!=p[0].length?p[0]:null),d.entitiesDictionary);if(s&&s.length>0)return{txpEntities:d.entitiesDictionary,txpActivities:s}}}var f,p;return null}t.d(n,"a",function(){return L})},2056:function(e,n,t){"use strict";t.d(n,"a",function(){return h});var r=t(0),a=t(108),i=t.n(a),o=t(2015),c=t.n(o),d=t(2016),u=t.n(d),s=t(272),l=t.n(s),f=t(6),v=t(29),p=t(33),I=t(156),_=t(1678),b="X-OWA-ExplicitLogonUser",m="X-AnchorMailbox",y=6,g=null;function h(e,n,t,a,o,d){return void 0===t&&(t=Object(p.a)("calendar")),r.__awaiter(this,void 0,void 0,function(){var s,p;return r.__generator(this,function(r){switch(r.label){case 0:return s=null,o?(s={headers:(p={},p[b]=o,p[m]=o,p)},[3,3]):[3,1];case 1:return a?[4,Object(I.b)(a.mailboxInfo)]:[3,3];case 2:s=r.sent(),r.label=3;case 3:return g||(g=Object(_.a)(y)),[2,g.add(function(){return c()({Header:Object(v.getJsonRequestHeader)(),Body:u()({CalendarId:l()({BaseFolderId:i()({Id:t})}),RangeStart:Object(f.hb)(e),RangeEnd:Object(f.hb)(n),IncludeDeclinedMeetings:d})},s).then(function(e){return e.Body})})]}})})}},2067:function(e){e.exports={a:"Qsb"}},293:function(e,n,t){"use strict";n.a={EventReservation:"EventReservation",FlightReservation:"FlightReservation",FoodReservation:"FoodEstablishmentReservation",Invoice:"Invoice",LodgingReservation:"LodgingReservation",ParcelDelivery:"ParcelDelivery",RentalCarReservation:"RentalCarReservation",ServiceReservation:"ServiceReservation",UnsuccessfulFlightReservation:"UnsuccessfulFlightReservation",UnsuccessfulLodgingReservation:"UnsuccessfulLodgingReservation",UnsuccessfulRentalCarReservation:"UnsuccessfulRentalCarReservation"}},376:function(e,n,t){"use strict";t.d(n,"e",function(){return o}),t.d(n,"f",function(){return c}),t.d(n,"c",function(){return d}),t.d(n,"d",function(){return u});var r=t(3),a=(t(2003),t(571));t.d(n,"a",function(){return a.a}),t.d(n,"b",function(){return a.b});var i=new r.c(function(){return t.e(135).then(t.bind(null,3205))}),o=new r.b(i,function(e){return e.showNotification}),c=new r.b(i,function(e){return e.showNotificationWithButtonCallback}),d=new r.b(i,function(e){return e.dismissNotification}),u=new r.b(i,function(e){return e.enableNotificationBar})},496:function(e,n,t){"use strict";var r;!function(e){e[e.EventReservation=0]="EventReservation",e[e.FlightReservation=1]="FlightReservation",e[e.FoodReservation=2]="FoodReservation",e[e.Invoice=3]="Invoice",e[e.LodgingReservation=4]="LodgingReservation",e[e.ParcelDelivery=5]="ParcelDelivery",e[e.RentalCarReservation=6]="RentalCarReservation",e[e.ServiceReservation=7]="ServiceReservation",e[e.UnsuccessfulFlightReservation=8]="UnsuccessfulFlightReservation",e[e.UnsuccessfulLodgingReservation=9]="UnsuccessfulLodgingReservation",e[e.UnsuccessfulRentalCarReservation=10]="UnsuccessfulRentalCarReservation"}(r||(r={})),n.a=r},527:function(e,n,t){"use strict";t.d(n,"w",function(){return r}),t.d(n,"n",function(){return a}),t.d(n,"y",function(){return i}),t.d(n,"z",function(){return o}),t.d(n,"x",function(){return c}),t.d(n,"m",function(){return d}),t.d(n,"v",function(){return u}),t.d(n,"g",function(){return s}),t.d(n,"o",function(){return l}),t.d(n,"p",function(){return f}),t.d(n,"e",function(){return v}),t.d(n,"A",function(){return p}),t.d(n,"r",function(){return I}),t.d(n,"a",function(){return _}),t.d(n,"t",function(){return b}),t.d(n,"c",function(){return m}),t.d(n,"h",function(){return y}),t.d(n,"f",function(){return g}),t.d(n,"B",function(){return h}),t.d(n,"s",function(){return O}),t.d(n,"b",function(){return E}),t.d(n,"u",function(){return j}),t.d(n,"d",function(){return C}),t.d(n,"l",function(){return R}),t.d(n,"i",function(){return T}),t.d(n,"j",function(){return S}),t.d(n,"k",function(){return A}),t.d(n,"q",function(){return F});var r="Sunday",a="Monday",i="Tuesday",o="Wednesday",c="Thursday",d="Friday",u="Saturday",s=[r,a,i,o,c,d,u],l=["January","February","March","April","May","June","July","August","September","October","November","December"],f="None",v="DailyRecurrence",p="WeeklyRecurrence",I="RelativeMonthlyRecurrence",_="AbsoluteMonthlyRecurrence",b="RelativeYearlyRecurrence",m="AbsoluteYearlyRecurrence",y=["None","First","Second","Third","Fourth","Last"],g="DailyRecurrence:#Exchange",h="WeeklyRecurrence:#Exchange",O="RelativeMonthlyRecurrence:#Exchange",E="AbsoluteMonthlyRecurrence:#Exchange",j="RelativeYearlyRecurrence:#Exchange",C="AbsoluteYearlyRecurrence:#Exchange",R="EndDateRecurrence:#Exchange",T=3,S=25,A=1,F=[1,2,3,4,5,6,7,8,9,10]},528:function(e,n,t){"use strict";var r=t(0),a=t(45),i=t(6),o=t(88),c=t(5),d=t(71),u=t(2054),s=t(1535),l=t(1536);var f=t(1561);t.d(n,"a",function(){return p}),t.d(n,"b",function(){return _});var v=Object(f.a)();function p(e,n){return n=n||Object(a.e)(),r.__assign({},v,e,{ItemId:e.ItemId?r.__assign({},e.ItemId,{mailboxInfo:n}):e.ItemId,ParentFolderId:e.ParentFolderId?r.__assign({},e.ParentFolderId,{mailboxInfo:n}):e.ParentFolderId,Start:I(e.Start),End:I(e.End),StartTimeZoneId:Object(o.b)(e.StartTimeZoneId),EndTimeZoneId:Object(o.b)(e.EndTimeZoneId),LastModifiedTime:I(e.LastModifiedTime),FreeBusyType:e.FreeBusyType,ResponseType:e.ResponseType,AppointmentReplyTime:I(e.AppointmentReplyTime),ExperienceType:e.ExperienceType?e.ExperienceType:"Unspecified",TxpObject:e.TailoredXpEntities?(t=e.TailoredXpEntities,i=e.EntityNamesMap,c=Object(s.a)(i),d=Object(l.a)(i),Object(u.a)(t,c,d)):void 0,SeriesMasterItemId:e.SeriesMasterItemId?r.__assign({},e.SeriesMasterItemId,{mailboxInfo:n}):null,Sensitivity:n.type==a.a.GroupMailbox&&"Private"==e.Sensitivity?"Normal":e.Sensitivity});var t,i,c,d}function I(e){if(e){if(Object(c.d)("cal-assumeTzOffsetFromCalendarItem")){var n=Object(d.getConfig)().timezone,t=!!n;return Object(i.Fb)(n,e,t)}return Object(i.gb)(e)}}function _(e){return r.__assign({__type:"CalendarItem:#Exchange"},e,{Start:e.Start&&Object(i.hb)(e.Start),End:e.End&&Object(i.hb)(e.End),LastModifiedTime:e.LastModifiedTime&&Object(i.hb)(e.LastModifiedTime),AppointmentReplyTime:e.AppointmentReplyTime&&Object(i.hb)(e.AppointmentReplyTime),FreeBusyType:e.FreeBusyType,CharmId:e.CharmId,IsDraft:e.IsDraft})}},62:function(e,n,t){"use strict";var r=t(1),a=t(8),i={calendarEntryMapping:new a.ObservableMap,calendarFolderMapping:new a.ObservableMap,calendarItemIdToChangeKey:new a.ObservableMap,folderIdToCalendarId:new a.ObservableMap,validEntryMapping:new a.ObservableMap,calendarGroupsMapping:new a.ObservableMap,defaultCalendars:new a.ObservableMap,calendarCacheInitializationState:{calendarCacheInitializationLoadState:new a.ObservableMap,calendarCacheInitializationLoadingScenarios:[]}},o=Object(r.createStore)("calendarsCacheStore",i),c=t(0),d=Object(r.action)("initializeCalendarsCacheInStore",function(e,n,t,r,a,i){return{defaultCalendarEntry:e,calendarEntries:n,calendarFolders:t,calendarGroups:r,folderIdMapping:a,calendarIdToChangeKeyMapping:i}}),u=Object(r.action)("calendarCacheInitializeFailed",function(e,n){return{calendarCacheScenarioId:e,primarySmtpAddress:n}}),s=Object(r.action)("initializeCalendarsCache",function(e,n){return void 0===n&&(n=!0),{calendarCacheScenarioId:e,isPrimaryAccount:n}}),l=Object(r.action)("calendarCacheInitialized",function(e,n){return{calendarCacheScenarioId:e,primarySmtpAddress:n}}),f=Object(r.action)("updateChangeKeyByCalendarItemId",function(e){return{itemId:e}}),v=Object(r.action)("addToCalendarsCache",function(e,n,t){return{calendarEntry:e,folder:n,mailboxInfo:t}}),p=Object(r.action)("addCalendarGroupToCalendarsCache",function(e){return{calendarGroup:e}}),I=Object(r.action)("updateCalendarEntry",function(e,n){return{itemId:e,calendarEntry:n}}),_=Object(r.action)("updateCalendarFolder",function(e,n){return{calendar:e,calendarFolder:n}}),b=Object(r.action)("removeCalendarFromCalendarsCache",function(e){return{calendar:e}}),m=Object(r.action)("markCalendarEntryAsValid",function(e){return{calendarEntry:e}}),y=Object(r.action)("calendarUpdated",function(e,n){return{calendarId:e,updates:n}});Object(r.mutator)(f,function(e){var n=e.itemId,t=n.Id,r=n.ChangeKey;o().calendarItemIdToChangeKey.set(t,r)}),Object(r.mutator)(I,function(e){var n=e.itemId.Id,t=e.calendarEntry,r=o().calendarEntryMapping.get(n),a=(t.ItemId,c.__rest(t,["ItemId"]));r&&Object.keys(a).forEach(function(e){r[e]=a[e]})}),Object(r.mutator)(m,function(e){var n=e.calendarEntry;o().validEntryMapping.set(n.ItemId.Id,!0)});var g=Object(r.action)("calendarCacheInitializedInternal",function(e){return{primarySmtpAddress:e}}),h=Object(r.action)("calendarCacheInitializeFailedInternal",function(e){return{primarySmtpAddress:e}}),O=Object(r.action)("clearCalendarCacheInitializationLoadingScenarios"),E=Object(r.action)("addCalendarCacheInitializationLoadingScenario",function(e){return{calendarCacheScenarioId:e}}),j=Object(r.action)("setCalendarCacheInitializationLoadState",function(e,n){return{calendarCacheInitializationLoadState:e,primarySmtpAddress:n}}),C=Object(r.action)("removeCalendarWithIDFromCalendarsCache",function(e){return{calendarId:e}});function R(e){if(void 0!==e.CalendarFolderId)return e.CalendarFolderId;var n=e;return n.IsGeneralScheduleCalendar?{Id:n.OwnerEmailAddress,ChangeKey:""}:n.SharedFolderId?{Id:n.SharedFolderId.Id,ChangeKey:null!=n.SharedFolderId.ChangeKey?n.SharedFolderId.ChangeKey:""}:null}var T=t(45);function S(e){return e||(e=Object(T.e)().primarySmtpAddress),o().defaultCalendars.get(e)}function A(){var e=o().calendarEntryMapping;return c.__spread(e.values())}function F(){return A().map(function(e){return k(e.id.id)}).filter(function(e){return e})}function w(){var e=o().calendarGroupsMapping;return c.__spread(e.values())}function M(e){return o().folderIdToCalendarId.get(e)}function N(e){return o().calendarEntryMapping.get(e)}function k(e){var n=N(e);return n?{id:{id:e,mailboxInfo:c.__assign({},n.id.mailboxInfo)},calculatedFolderId:z(e),displayName:n.CalendarName,colorScheme:null}:null}function D(e){return o().calendarFolderMapping.get(e.id.id)}function P(e){return N(e.id.id)}function x(e){var n=M(e);return n?N(n.id):void 0}function L(e){var n=o().calendarFolderMapping,t=M(e);return t?n.get(t.id):void 0}function K(e){return o().calendarItemIdToChangeKey.get(e)}function U(e){return B(e.id.id)}function B(e){var n=o().calendarFolderMapping.get(e);return n&&(n.FolderId||n.DistinguishedFolderId)?n.FolderId?n.FolderId.Id:n.DistinguishedFolderId:z(e)}function z(e){var n=o().calendarEntryMapping.get(e);if(n){var t=R(n);return t?t.Id:null}return null}function V(e){var n=o(),t=n.folderIdToCalendarId,r=n.calendarEntryMapping,a=t.get(e);if(a){var i=r.get(a.id);return!i.IsGroupMailboxCalendar&&null!=i.CalendarFolderId}return!1}function G(e){if(V(e)){var n=x(e);return n&&n.IsReadOnly}return!1}function q(e){var n=o().validEntryMapping;return e&&n.get(e.ItemId.Id)}function H(e){return!V(B(e))&&!q(N(e))}function W(e){var n,t=o(),r=t.folderIdToCalendarId,a=t.calendarEntryMapping,i=r.get(e);i?n=a.get(i.id):n=c.__spread(a.values()).filter(function(n){return n.OwnerEmailAddress&&n.OwnerEmailAddress.toLowerCase()==e.toLowerCase()})[0];return n}function Z(e,n){return n+"_"+e}function J(e){return Object.keys(e).map(function(n){return[n,e[n]]})}function Q(e,n){var t=o();t.calendarItemIdToChangeKey.delete(e),t.calendarEntryMapping.delete(e),t.calendarFolderMapping.delete(e),n&&t.folderIdToCalendarId.delete(n)}Object(r.mutator)(d,function(e){var n=e.defaultCalendarEntry,t=e.calendarEntries,r=e.calendarFolders,i=e.folderIdMapping,d=e.calendarIdToChangeKeyMapping,u=e.calendarGroups,s=o();n&&s.defaultCalendars.set(n.id.mailboxInfo.primarySmtpAddress,n),s.calendarEntryMapping||(s.calendarEntryMapping=new a.ObservableMap),J(t).forEach(function(e){var n=c.__read(e,2),t=n[0],r=n[1];return s.calendarEntryMapping.set(t,r)}),s.calendarFolderMapping||(s.calendarFolderMapping=new a.ObservableMap),J(r).forEach(function(e){var n=c.__read(e,2),t=n[0],r=n[1];return s.calendarFolderMapping.set(t,r)}),s.folderIdToCalendarId||(s.folderIdToCalendarId=new a.ObservableMap),J(i).forEach(function(e){var n=c.__read(e,2),t=n[0],r=n[1];return s.folderIdToCalendarId.set(t,r)}),s.calendarItemIdToChangeKey||(s.calendarItemIdToChangeKey=new a.ObservableMap),J(d).forEach(function(e){var n=c.__read(e,2),t=n[0],r=n[1];return s.calendarItemIdToChangeKey.set(t,r)}),s.calendarGroupsMapping||(s.calendarGroupsMapping=new a.ObservableMap),J(u).forEach(function(e){var n=c.__read(e,2),t=n[0],r=n[1];return s.calendarGroupsMapping.set(t,r)}),s.validEntryMapping=new a.ObservableMap}),Object(r.mutator)(v,function(e){var n=e.calendarEntry,t=e.folder,r=e.mailboxInfo,a=o();a.calendarItemIdToChangeKey.set(n.ItemId.Id,n.ItemId.ChangeKey);var i=c.__assign({},n,{id:{id:n.ItemId.Id,mailboxInfo:r}});a.calendarEntryMapping.set(n.ItemId.Id,i),a.calendarFolderMapping.set(n.ItemId.Id,t),t.FolderId?a.folderIdToCalendarId.set(t.FolderId.Id,{id:n.ItemId.Id,mailboxInfo:r}):t.DistinguishedFolderId&&a.folderIdToCalendarId.set(t.DistinguishedFolderId,{id:n.ItemId.Id,mailboxInfo:r})}),Object(r.mutator)(p,function(e){var n=e.calendarGroup,t=o(),r=Z(n.id.mailboxInfo.primarySmtpAddress,n.GroupId);t.calendarGroupsMapping.set(r,n)}),Object(r.mutator)(b,function(e){var n=e.calendar;Q(n.id.id,n.calculatedFolderId?n.calculatedFolderId:null)}),Object(r.mutator)(C,function(e){var n=e.calendarId;Q(n,B(n))}),Object(r.mutator)(_,function(e){var n=e.calendar,t=e.calendarFolder,r=D(n);Object.keys(t).forEach(function(e){r[e]=t[e]})}),Object(r.mutator)(E,function(e){o().calendarCacheInitializationState.calendarCacheInitializationLoadingScenarios.push(e.calendarCacheScenarioId)}),Object(r.mutator)(O,function(){o().calendarCacheInitializationState.calendarCacheInitializationLoadingScenarios=[]}),Object(r.mutator)(j,function(e){var n=e.primarySmtpAddress;n||(n=Object(T.e)().primarySmtpAddress);var t=o();t.calendarCacheInitializationState.calendarCacheInitializationLoadState||(t.calendarCacheInitializationState.calendarCacheInitializationLoadState=new a.ObservableMap),t.calendarCacheInitializationState.calendarCacheInitializationLoadState.set(n,e.calendarCacheInitializationLoadState)});var Y=t(1992),X=t.n(Y),$=t(29),ee=t(1563),ne=t(156);function te(e){return c.__awaiter(this,void 0,void 0,function(){var n,t;return c.__generator(this,function(r){switch(r.label){case 0:return n=null,e&&!Object(T.h)(e)||(n=Object(ee.a)()),n?[3,3]:[4,Object(ne.b)(Object(T.e)(e))];case 1:return t=r.sent(),[4,X()({Header:Object($.getJsonRequestHeader)()},t)];case 2:n=r.sent(),r.label=3;case 3:return[2,n]}})})}var re,ae=t(9),ie=t(5),oe=t(12),ce="LinkedCalendarEntry:#Exchange";function de(e,n){if(7==e.CalendarFolderType)return!1;if(function(e){return Object(ie.d)("cal-linkedCalendarEntry")?e.__type==ce:e.hasOwnProperty("OwnerEmailAddress")}(e)){var t=e;if(t.IsOwnerEmailAddressInvalid)return oe.c.info("[getCalendarsService] Ommitting shared calendar with IsOwnerEmailAddressInvalid flag on, OwnerEmailAddress: {1}: "+t.OwnerEmailAddress),!1;var r=t.IsGeneralScheduleCalendar?t.OwnerEmailAddress:t.SharedFolderId?t.SharedFolderId.Id:null;if(!r)return oe.c.info("[getCalendarsService] Ommitting linked calendar with null SharedFolderId, Id: {1}: "+e.ItemId.Id),!1;if(n.includes(r))return oe.c.info("[getCalendarsService] Ommitting duplicate shared calendar from Calendar folder list. DuplicateKey: {1}: "+r),!1;if(n.push(r),t.OwnerEmailAddress=t.OwnerEmailAddress.toLowerCase(),t.IsGroupMailboxCalendar)return!1}return!0}function ue(e,n,t){var r,a={},i={},o={},d={},u={},s=t?[t]:[Object(ae.a)().SessionSettings.LogonEmailAddress],l=Object(T.e)(t);return e.forEach(function(e){u[e.ItemId.Id]=e.ItemId.ChangeKey;var t=c.__assign({},e,{id:{id:e.GroupId,mailboxInfo:l}}),i=Z(l.primarySmtpAddress,e.GroupId);d[i]=t,e.Calendars.forEach(function(e){if(de(e,s)){var t=e.ItemId.Id,i=R(e).Id;if(1==e.CalendarFolderType){var d=n&&n.filter(function(e){return e.FolderId.Id===i})[0];r={id:{id:t,mailboxInfo:l},calculatedFolderId:i,displayName:d?d.DisplayName:e.CalendarName,colorScheme:null}}var f=c.__assign({},e,{id:{id:t,mailboxInfo:l}});!a[t]&&(a[t]=f),!o[i]&&(o[i]={id:e.ItemId.Id,mailboxInfo:l}),!u[t]&&(u[t]=e.ItemId.ChangeKey)}})}),n.forEach(function(e){var n=o[e.FolderId.Id];n&&(i[n.id]=e)}),{defaultCalendar:r,calendarEntryMapping:a,calendarFolderMapping:i,folderIdMapping:o,calendarGroupMapping:d,calendarIdToChangeKeyMapping:u}}function se(e){e||(e=Object(T.e)().primarySmtpAddress);var n=o().calendarCacheInitializationState.calendarCacheInitializationLoadState.get(e);return null==n&&(n=re.NotLoaded),n}function le(){return o().calendarCacheInitializationState.calendarCacheInitializationLoadingScenarios}!function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(re||(re={}));var fe=t(98),ve=t(273);Object(r.orchestrator)(s,function(e){return c.__awaiter(void 0,void 0,void 0,function(){var n,t,r,a,i,o,u,s,l,f;return c.__generator(this,function(v){switch(v.label){case 0:if(n=Object(T.e)().primarySmtpAddress,"CalendarModule"==e.calendarCacheScenarioId&&!e.isPrimaryAccount){n=null,t=Object(ve.g)();try{for(r=c.__values(t),a=r.next();!a.done;a=r.next())if(se((i=a.value).primarySmtpAddress)==re.NotLoaded){n=i.primarySmtpAddress;break}}catch(e){l={error:e}}finally{try{a&&!a.done&&(f=r.return)&&f.call(r)}finally{if(l)throw l.error}}}if(!n)return[3,10];switch(E(e.calendarCacheScenarioId),o=se(n),o){case re.NotLoaded:return[3,1];case re.Loaded:return[3,7];case re.Loading:return[3,8]}return[3,9];case 1:return j(re.Loading,n),[4,te(n)];case 2:return null!==(u=v.sent())&&u.WasSuccessful?(s=ue(u.CalendarGroups,u.CalendarFolders,n),[4,d(s.defaultCalendar,s.calendarEntryMapping,s.calendarFolderMapping,s.calendarGroupMapping,s.folderIdMapping,s.calendarIdToChangeKeyMapping)]):[3,5];case 3:return v.sent(),[4,g(n)];case 4:return v.sent(),[3,6];case 5:h(),oe.c.error("[getCalendarFoldersFromServer] Failed to load calendars from server"),v.label=6;case 6:return[3,10];case 7:return g(n),[3,10];case 8:return[3,10];case 9:return Object(fe.a)(o),[3,10];case 10:return[2]}})})});Object(r.orchestrator)(g,function(e){return c.__awaiter(void 0,void 0,void 0,function(){var n=this;return c.__generator(this,function(t){switch(t.label){case 0:return j(re.Loaded,e.primarySmtpAddress),[4,Promise.all(le().map(function(t){return c.__awaiter(n,void 0,void 0,function(){return c.__generator(this,function(n){switch(n.label){case 0:return[4,l(t,e.primarySmtpAddress)];case 1:return[2,n.sent()]}})})}))];case 1:return t.sent(),O(),[2]}})})}),Object(r.orchestrator)(h,function(e){j(re.NotLoaded,e.primarySmtpAddress),le().forEach(function(n){return u(n,e.primarySmtpAddress)}),O()});var pe=t(120),Ie=t.n(pe),_e=t(2008),be=t.n(_e);function me(e,n){return c.__awaiter(this,void 0,void 0,function(){var t,r,a;return c.__generator(this,function(i){switch(i.label){case 0:return t={headers:Object(ne.e)(n)},r=x(e.Id),a=r&&(r.IsGeneralScheduleCalendar||r.IsGroupMailboxCalendar)?Ie()({Id:"calendar",Mailbox:{EmailAddress:n}}):5==r.CalendarFolderType?r.SharedFolderId:e,[4,be()({request:{FolderId:a}},t)];case 1:return[2,i.sent()]}})})}var ye=t(108),ge=t.n(ye),he=t(18);function Oe(e){return c.__awaiter(this,void 0,void 0,function(){var n,t,r,a,i,o,d;return c.__generator(this,function(c){switch(c.label){case 0:if(!(n=N(e)))throw new Error("Unable to get calendar entry for calendar "+e);t=B(e),r=z(e),a=M(t),i=a?a.mailboxInfo:Object(T.e)(),o=5==n.CalendarFolderType&&Object(ae.a)().SessionSettings.DefaultPublicFolderMailbox?Object(ae.a)().SessionSettings.DefaultPublicFolderMailbox:function(e,n){return e||(n?n.primarySmtpAddress:null)}(n.OwnerEmailAddress,i),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,me(ge()({Id:r}),o)];case 2:return d=c.sent(),[3,4];case 3:return c.sent(),Object(he.o)("getCalendarFolderConfigurationServiceFailed"),m(n),[2];case 4:if(!d)throw new Error("Unable to get folder for calendar "+e);return m(n),5==n.CalendarFolderType?function(e,n,t){var r=e.CalendarFolder;if(r){n.CalendarFolderId||(n.CalendarFolderId=e.CalendarFolder.FolderId);var a=r.ReplicaList[0];v(n,r,{type:0,deprecatedMailboxId:a,primarySmtpAddress:a,routingKey:Object(T.c)()+a,requestOptions:Object(ne.a)(a,t),returnModernConversationItems:t.returnModernConversationItems})}}(d,n,i):function(e,n,t,r){var a=e.CalendarFolder;a&&a.EffectiveRights&&a.EffectiveRights.Read&&(e.MasterList&&(n.RemoteCategories=e.MasterList),(r==n.OwnerEmailAddress||n.ItemId&&r==n.ItemId.Id)&&(y(r,{id:{id:n.ItemId.Id,mailboxInfo:t},calculatedFolderId:a.FolderId.Id}),C(r),v(n,a,t)))}(d,n,i,e),[2]}})})}function Ee(e){var n=D(e),t=P(e);return n&&t&&!t.IsReadOnly&&n.EffectiveRights&&n.EffectiveRights.CreateContents}var je=t(972);function Ce(e,n){var t=P(e);if(Object(je.b)(t)){var r=t;return!r.IsOwnerEmailAddressInvalid&&r.OwnerEmailAddress==n}return Object(ae.a)().SessionSettings.UserEmailAddress==n}t.d(n,"C",function(){return s}),t.d(n,"d",function(){return l}),t.d(n,"M",function(){return f}),t.d(n,"c",function(){return v}),t.d(n,"b",function(){return p}),t.d(n,"K",function(){return I}),t.d(n,"L",function(){return _}),t.d(n,"J",function(){return b}),t.d(n,"I",function(){return m}),t.d(n,"f",function(){return y}),t.d(n,"A",function(){return S}),t.d(n,"n",function(){return A}),t.d(n,"h",function(){return F}),t.d(n,"w",function(){return w}),t.d(n,"x",function(){return M}),t.d(n,"p",function(){return N}),t.d(n,"m",function(){return k}),t.d(n,"s",function(){return D}),t.d(n,"o",function(){return P}),t.d(n,"r",function(){return x}),t.d(n,"t",function(){return L}),t.d(n,"z",function(){return K}),t.d(n,"u",function(){return U}),t.d(n,"B",function(){return B}),t.d(n,"l",function(){return z}),t.d(n,"E",function(){return V}),t.d(n,"F",function(){return G}),t.d(n,"G",function(){return q}),t.d(n,"e",function(){return H}),t.d(n,"q",function(){return W}),t.d(n,"j",function(){return se}),t.d(n,"i",function(){return Oe}),t.d(n,"k",function(){return R}),t.d(n,"g",function(){return ue}),t.d(n,"v",function(){return Z}),t.d(n,"H",function(){return Ee}),t.d(n,"D",function(){return Ce}),t.d(n,"y",function(){return te}),t.d(n,"a",function(){return re})},674:function(e,n,t){"use strict";var r;!function(e){e[e.TxpActivity=0]="TxpActivity",e[e.Dining=1]="Dining",e[e.EventActivityType=2]="EventActivityType",e[e.FlightDeparture=3]="FlightDeparture",e[e.HotelCheckin=4]="HotelCheckin",e[e.HotelCheckout=5]="HotelCheckout",e[e.InvoiceDue=6]="InvoiceDue",e[e.ParcelDelivery=7]="ParcelDelivery",e[e.RentalCarPickup=8]="RentalCarPickup",e[e.RentalCarDropOff=9]="RentalCarDropOff",e[e.InvoiceScheduled=10]="InvoiceScheduled",e[e.ServiceAppointment=11]="ServiceAppointment"}(r||(r={})),n.a=r},69:function(e,n,t){"use strict";var r=t(100);function a(e){for(var n=[],t=0;t<r.a.DaysInOneWeek;t++)e&1<<t&&n.push(t);return n}t(1666),t(1656),t(1657),t(1649),t(1658);var i=t(1145),o=t(6);function c(e,n,t){return Object(o.Bb)(e,n,t)}t.d(n,"h",function(){return i.g}),t.d(n,"g",function(){return i.f}),t.d(n,"m",function(){return i.k}),t.d(n,"d",function(){return i.c}),t.d(n,"e",function(){return i.d}),t.d(n,"p",function(){return i.n}),t.d(n,"n",function(){return i.l}),t.d(n,"o",function(){return i.m}),t.d(n,"b",function(){return i.a}),t.d(n,"j",function(){return i.h}),t.d(n,"c",function(){return i.b}),t.d(n,"f",function(){return i.e}),t.d(n,"l",function(){return i.j}),t.d(n,"k",function(){return i.i}),t.d(n,"q",function(){return i.o}),t.d(n,"r",function(){return c}),t.d(n,"i",function(){return a}),t.d(n,"a",function(){return r.a})},793:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(1514);function a(e){return Object(r.a)(e)&&"Resource"===e.LocationSource}},852:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(6);function a(e,n,t){return Object(r.Eb)(e,Object(r.sb)(n),Object(r.nb)(n),Object(r.cb)(n),Object(r.ib)(t),Object(r.mb)(t),Object(r.ob)(t),Object(r.lb)(t))}},899:function(e){e.exports={a:"lGa"}},948:function(e,n,t){"use strict";t.d(n,"d",function(){return a}),t.d(n,"a",function(){return o}),t.d(n,"c",function(){return c}),t.d(n,"b",function(){return d});var r=t(793);function a(e,n){if(null==e&&null!=n||null!=e&&null==n)return!1;if(null==e&&null==n)return!0;if(0==e.length&&0==n.length)return!0;if(e.length!=n.length)return!1;for(var t=0;t<e.length;){if(!i(e[t],n[t]))return!1;t++}return!0}function i(e,n){return!(!e&&n||e&&!n)&&(e.Id===n.Id||Object(r.a)(e.PostalAddress)&&Object(r.a)(n.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===n.PostalAddress.LocationUri.toLowerCase())}function o(e,n){return e&&Object(r.a)(n.PostalAddress)?c(e,n.PostalAddress.LocationUri):d(e,n.Id)}function c(e,n){return e&&e.some(function(e){return Object(r.a)(e.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===n.toLowerCase()})}function d(e,n){return e&&e.some(function(e){return e.Id===n})}},972:function(e,n,t){"use strict";var r=t(5),a="LinkedCalendarEntry:#Exchange";function i(e){return Object(r.d)("cal-linkedCalendarEntry")?e.__type==a:e.hasOwnProperty("OwnerEmailAddress")}t.d(n,"b",function(){return i}),t.d(n,"a",function(){return a})}}]);
//# sourceMappingURL=owa.CalendarCard~InAppNotifications~RSVPPeek~TimePanel~UpNextV2.js.map
self.scriptsLoaded['owa.CalendarCard~InAppNotifications~RSVPPeek~TimePanel~UpNextV2.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.CalendarCard~InAppNotifications~RSVPPeek~TimePanel~UpNextV2.js'] = (new Date()).getTime();