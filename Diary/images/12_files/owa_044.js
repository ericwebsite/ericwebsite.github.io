self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Translation.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[396],{8128:function(e,n,t){"use strict";t.r(n);var r="-",a=4;function u(e){if(0===(e=e.toLowerCase()).lastIndexOf("zh-",0))switch(e){case"zh-cht":case"zh-hant":case"zh-hk":case"zh-tw":return"zh-cht";default:return"zh-chs"}var n=e.indexOf(r,1);if(-1===n)return e;var t=e.indexOf(r,n+r.length);return-1===t&&(t=e.length),t-n==r.length+a&&(n=t),e.substring(0,n)}var o=t(1),s=t(94),i=Object(o.createStore)("TranslationStore",{sessionId:Object(s.a)(),localeOfSupportedLanguageMap:null,supportedLanguageMap:null,isUserLocaleSupported:!1,userLanguageName:null,userLanguageTag:null})();function c(e){return!!i.supportedLanguageMap&&i.supportedLanguageMap.has(e)}function l(e,n){void 0===n&&(n=null);var t=u(e);if(!c(t))return!1;if(null!=n){var r=u(n);return!!c(r)&&t!==r}return!0}var g=t(0),d="https://ogma.osi.office.net",p="/TradukoApi/api/v1.0/translateContentArray",f="/TradukoApi/api/v1.0/supportedLanguages",h="/TradukoApi/api/v1.0/detectLanguage";var L=t(15);function v(e,n){e.setRequestHeader("Content-type","application/json"),e.setRequestHeader("Accept","application/json, text/plain, */*"),e.setRequestHeader("x-translator-sid",i.sessionId),e.setRequestHeader("x-translator-cross-sid",i.sessionId),e.setRequestHeader("x-translator-cid",n),e.setRequestHeader("x-translator-user-id",Object(L.h)()),e.setRequestHeader("x-translator-client-version",Object(L.i)()),e.setRequestHeader("x-translator-client-app","Outlook"),e.setRequestHeader("x-translator-client-type","Browser")}function O(e,n){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(t){return[2,new Promise(function(t,r){var a=new XMLHttpRequest;a.timeout=3e4,a.onload=function(){if(200===a.status){var e=function(e){try{var n=new Map;return JSON.parse(e).forEach(function(e){n.set(e.LanguageTag,e)}),n}catch(e){return null}}(this.responseText);e?t(e):r("OGMA returned invalid response: "+this.response)}else r("OGMA failed to retrieve supported languages: "+this.response)},a.onerror=function(){r("OGMA call failed: "+this.response)},a.ontimeout=function(){r("OGMA call timed out")};var o=u(e);a.open("GET",function(e){return""+d+f+"?clientLocale="+e}(o)),v(a,n),a.send()})]})})}var w=t(9),M=Object(o.mutatorAction)("setSupportedLanguageMap",function(e,n){var t=u(e);i.localeOfSupportedLanguageMap=e,i.userLanguageName=n.get(t).LanguageName,i.userLanguageTag=t,i.supportedLanguageMap=n,i.isUserLocaleSupported=l(e)}),T=t(18),S=15e3,m=0,_=S;function x(){return g.__awaiter(this,void 0,void 0,function(){var e,n,t,r,a,u,o;return g.__generator(this,function(c){switch(c.label){case 0:if(e=Object(w.a)().SessionSettings.UserCulture,n=Date.now(),e===i.localeOfSupportedLanguageMap||!(0===m||n>m+_))return[3,5];t=null,r=Object(s.a)(),a=new T.a("InlineTranslationGetSupportedLanguages"),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,O(e,r)];case 2:return t=c.sent(),m=0,_=S,a.end(),[3,4];case 3:throw u=c.sent(),o=new Error("[InlineTranslation] getSupportedLanguages failed. Error:"+u+" | cid:"+r),m=n,_*=2,a.endWithError("ServerError",o),u;case 4:return M(e,t),[2,!0];case 5:return[2,!1]}})})}function b(){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(e){switch(e.label){case 0:return[4,x()];case 1:return e.sent(),[2,i.supportedLanguageMap]}})})}function A(){return i.localeOfSupportedLanguageMap}function j(e,n){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(t){return[2,new Promise(function(t,r){var a=new XMLHttpRequest;a.onload=function(){if(200===a.status){var e=JSON.parse(this.responseText);e?t(e):r("OGMA returned invalid response: "+this.response)}else r("OGMA failed to detect email language: "+this.response)},a.onerror=function(){r("OGMA call failed: "+this.response)},a.open("POST",""+d+h),v(a,n),a.send(JSON.stringify(e))})]})})}var E=1e4;function G(e){return g.__awaiter(this,void 0,void 0,function(){var n,t,r,a,u,o;return g.__generator(this,function(i){switch(i.label){case 0:n=Object(s.a)(),t=null,r=new T.a("InlineTranslationGetDetectedLanguage"),i.label=1;case 1:return i.trys.push([1,3,,4]),(a=e.join(" ")).length>E&&(a=a.substring(0,E)),[4,j(a,n)];case 2:return t=i.sent(),r.end(),[3,4];case 3:return u=i.sent(),o=new Error("[InlineTranslation] getOgmaDetectedLanguage failed. Error:"+u+" | cid:"+n),r.endWithError("ServerError",o),[3,4];case 4:return[2,t]}})})}function R(e){return i.supportedLanguageMap.has(e)?i.supportedLanguageMap.get(e).LanguageName:null}function q(){return i.userLanguageName}function y(){return i.userLanguageTag}function H(){return i.isUserLocaleSupported}function I(e,n){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(t){return[2,new Promise(function(t,r){var a,u=new XMLHttpRequest;u.timeout=15e3,u.onload=function(){if(200===u.status){var e=JSON.parse(this.responseText);null!=e?t((n=[],e.forEach(function(e){n.push(e.TranslatedText)}),n)):r("OGMA returned invalid response: "+this.response)}else r("OGMA failed to translate messaage: "+this.response);var n},u.onerror=function(){r("OGMA call failed: "+this.response)},u.ontimeout=function(){r("OGMA call timed out")},u.open("POST",(a=i.userLanguageTag,""+d+p+"?fromLang=&toLang="+a)),v(u,n),u.send(function(e){var n=[];return e.forEach(function(e){var t={Data:e,DataType:"html"};n.push(t)}),JSON.stringify(n)}(e))})]})})}var N=t(266);function D(e,n){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(t){switch(t.label){case 0:return e.translationMode!==n.translationMode&&Object(T.o)("InlineTranslationChangeTranslationMode",[],{cosmosOnlyData:n.translationMode.toString()}),n.excludedLanguages.forEach(function(n){e.excludedLanguages.includes(n)||Object(T.o)("InlineTranslationOptOutOfLanguage",[],{cosmosOnlyData:n})}),e.excludedLanguages.forEach(function(e){n.excludedLanguages.includes(e)||Object(T.o)("InlineTranslationRemoveOptOutOfLanguage",[],{cosmosOnlyData:e})}),[4,N.d.importAndExecute(N.a.Translation,n)];case 1:return t.sent(),[2]}})})}t.d(n,"checkCanTranslate",function(){return l}),t.d(n,"initSupportedLanguages",function(){return x}),t.d(n,"initAndGetSupportedLanguageMap",function(){return b}),t.d(n,"getLocaleOfSupportedLanguageMap",function(){return A}),t.d(n,"getOgmaSupportedLanguageTag",function(){return u}),t.d(n,"getDetectedLanguage",function(){return G}),t.d(n,"getSupportedLanguageMap",function(){return R}),t.d(n,"getUserLanguageName",function(){return q}),t.d(n,"getUserLanguageTag",function(){return y}),t.d(n,"getIsUserLocaleSupported",function(){return H}),t.d(n,"translateText",function(){return I}),t.d(n,"updateTranslationOptions",function(){return D})}},0,[463,87,464,98]]);
//# sourceMappingURL=owa.Translation.js.map
self.scriptsLoaded['owa.Translation.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Translation.js'] = (new Date()).getTime();