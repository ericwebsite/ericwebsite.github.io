self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Lightning.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[261],{11733:function(n,e,t){"use strict";t.r(e);var i=t(12),r=t(7),o=t(23),a=t(0),c=t(8),u=t(1093),s=Object(r.action)("initializeLightning")(function(n){var e,t;if(i.c.info("initialize lightning store"),Object(u.a)().lastShownId=null,Object(u.a)().lightedCount=0,Object(u.a)().unseenItems=new c.ObservableMap,n)try{for(var r=a.__values(n),o=r.next();!o.done;o=r.next()){var s=o.value;Object(u.a)().unseenItems.set(s.identity,s)}}catch(n){e={error:n}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}});var l,g=t(75),h="ows/v1.0/lightning/items/unseen";function d(){return i.c.info("initialize lightning from server"),Object(g.b)(h).then(function(n){var e=n.map(f);s(e)})}function f(n){return n.category?{identity:n.id,visible:!1,category:n.category}:{identity:n,visible:!1}}var b="lightning";function v(){if(!l){var n=Object(o.a)(b);l=n?function(n){i.c.info("initialize lightning from override query parameter");var e=n.split(",").map(function(n){return{identity:n,visible:!1}});return s(e),Promise.resolve()}(n):d()}return l}var O,j=t(18),m=Object(r.action)("lightup")(function(n){i.c.info("lightup - id:"+n),Object(u.a)().lastShownId=n,Object(u.a)().lightedCount++;var e=Object(u.a)().unseenItems.get(n);e&&(e.visible=!0),Object(j.o)("LIGHTUP",[n])}),w=t(41);function I(n,e){(i.c.info("lightupOrReject - id:"+n+", recurrenceCount:"+e+", lightedCount:"+Object(u.a)().lightedCount+", lastShown:"+Object(u.a)().lastShownId),Object(w.u)(location))?i.c.info("lightning is disabled for deeplink"):Object(u.a)().unseenItems.has(n)&&(!Object(u.a)().lastShownId||function(n,e){var t=!1,i=Object(u.a)().lastShownId;if(i&&e&&!function(){var n=Object(u.a)(),e=n.lastShownId,t=n.unseenItems;return e&&t.has(e)&&t.get(e).visible}()){var r=e.indexOf(i),o=e.indexOf(n);r>=0&&r+1==o&&(t=!0)}return t}(n,e)||function(n){var e=Object(u.a)().unseenItems.get(n);return!!e&&e.category==O.UIFeatureDiscovery}(n))&&m(n)}!function(n){n.None="0",n.UpSell="1",n.FeatureDiscovery="2",n.TeachingMoment="3",n.UITeachingMoment="4",n.UIFeatureDiscovery="5",n.UIUpSell="6",n.JITNewUser="7",n.Compliance="8",n.SatCoreMetric="9",n.UpSellExperiment="10"}(O||(O={}));var p=Object(r.action)("beginLightning")(function(n,e,t){i.c.info("beginLightning - id:"+n),e(function(){v().then(function(){return I(n,t)}).catch(function(e){i.c.warn("something is wrong, lightning id:"+n+", reason:"+e)})})}),y="ows/v1.0/lightning/items";function S(n,e){return void 0===e&&(e="Primary"),Object(g.e)(y+"/"+n+"?actionType="+e,{id:n})}var L=Object(r.action)("endLightning")(function(n,e){return a.__awaiter(this,void 0,void 0,function(){var t;return a.__generator(this,function(r){return i.c.info("endLightning - id:"+n),t=Object(u.a)().unseenItems,Object(u.a)().lastShownId==n&&t.has(n)&&t.get(n).visible?(t.delete(n),Object(j.o)("Lighted",[n]),Object(o.d)("lightning")?(i.c.info("skipping the update because override exists"),[2]):[2,S(n,e)]):[2]})})});t.d(e,"beginLightningImp",function(){return p}),t.d(e,"endLightningImp",function(){return L})}},0,[463,87,464,98]]);
//# sourceMappingURL=owa.Lightning.js.map
self.scriptsLoaded['owa.Lightning.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Lightning.js'] = (new Date()).getTime();