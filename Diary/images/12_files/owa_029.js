self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OutlookServiceOptions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[308],{11810:function(t,e,o){"use strict";o.r(e);var n=o(0),a=o(74),i=o(7),r=Object(i.action)("setFeatureSettings")(function(t,e,o){t.options[e]=o}),c=o(47),s=o(1098),d=o(688),u=o(94),f=o(75),O=o(12),p="ows/v1.0/OutlookOptions/{0}";function l(t,e){var o=Object(a.a)(p,c.a[t]);if(Object(d.a)().loadState===s.a.OptionsLoaded){if(Object(d.a)().options[t]&&Object(d.a)().options[t].lastModifiedDateTime){if(e&&0!==Object.keys(e).length){var i=e;i["feature@is.Queryable"],i["feature@odata.type"],i.createdDateTime,i.lastModifiedDateTime;return b(1,o,n.__rest(i,["feature@is.Queryable","feature@odata.type","createdDateTime","lastModifiedDateTime"]))}return O.c.info("createOrUpdateOptionsForFeature called with no changes to options"),Promise.resolve()}return b(0,o,e)}return Promise.reject("Options are not loaded. Cannot update options.")}function b(t,e,o){var n={correlationId:Object(u.a)(),options:o};return(1==t?f.c:f.d)(e,n,n.correlationId).then(function(t){if(!function(t){if(t&&t.options&&1==t.options.length){var e=t.options[0];return r(Object(d.a)(),e.feature,e),!0}return!1}(t))throw new Error("Error processing options response")})}var j=o(680),v=o(210),S=Object(i.action)("applyDefaultOptions")(function(t){void 0===t&&(t=Object(j.a)()),Object.keys(Object(d.a)().options).forEach(function(e){Object(d.a)().options[e].lastModifiedDateTime||t[e]&&v(Object(d.a)().options[e],t[e])})}),h=o(1099),w=null,m=Object(i.action)("loadOptions")(function(){switch(Object(d.a)().loadState){case s.a.OptionsNotLoaded:return Object(d.a)().loadState=s.a.OptionsLoading,w=Object(f.b)("ows/v1.0/OutlookOptions").then(function(t){!function(t){t?(t.options&&t.options.forEach(function(t){null!=t&&r(Object(d.a)(),t.feature,t)}),S(),Object(d.a)().loadState=s.a.OptionsLoaded):(O.c.info("Error loading options"),Object(h.a)(),Object(d.a)().loadState=s.a.OptionsNotLoaded)}(t),w=null});case s.a.OptionsLoading:return w;case s.a.OptionsLoaded:return Promise.resolve()}});var g=o(1075);function A(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,m()];case 1:return e.sent(),[2,Object(g.a)(t)]}})})}var y=Object(i.action)("updateAddinPinStatus")(function(t,e,o){var n=Object(g.a)(c.a.SurfaceActions),a=Object(g.a)(c.a.CalendarSurfaceAddins),i=!!o.readMode&&D(n.readSurfaceAddins,t,e);i=o.composeMode&&D(n.composeSurfaceAddins,t,e)||i;var r=!!o.calendarMode&&D(a.calendarSurfaceAddins,t,e);i&&l(c.a.SurfaceActions,n),r&&l(c.a.CalendarSurfaceAddins,a)}),D=function(t,e,o){var n=!1;return o?-1===t.indexOf(e)&&(t.push(e),n=!0):-1!==t.indexOf(e)&&(t.splice(t.indexOf(e),1),n=!0),n};o.d(e,"createOrUpdateOptionsForFeature",function(){return l}),o.d(e,"loadOptions",function(){return m}),o.d(e,"getServerOptionsForFeature",function(){return A}),o.d(e,"updateAddinPinStatus",function(){return y})}},0,[463,87]]);
//# sourceMappingURL=owa.OutlookServiceOptions.js.map
self.scriptsLoaded['owa.OutlookServiceOptions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OutlookServiceOptions.js'] = (new Date()).getTime();