self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.CLP.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[120],{1027:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return r});var i={};function r(e,t){return i[e]&&i[e][t]}},1335:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n(2),r=n(70),a=n(389),o=0;function c(e){var t=document.createElement("div");t.id="owa-modal-"+o++,document.body.appendChild(t);var n,c=!1,l=function(){c||(c=!0,r.unmountComponentAtNode(t),document.body.removeChild(t))};return[new Promise(function(o,c){n=c,r.render(i.createElement(a.a,{child:i.createElement(e,{onDismiss:function(e){l(),o(e)}}),type:a.b.None,onError:function(){l(),c()}}),t)}),function(){l(),n()}]}},1725:function(e,t,n){"use strict";var i=n(1027),r=n(7),a=Object(r.action)("removeInfoBarMessageInReadingPane")(function(e,t,n){void 0===n&&(n="0");for(var r=0;r<e.infoBarIds.length;r++)if(e.infoBarIds[r]==t){e.infoBarIds.splice(r,1);break}i.b[n]&&(delete i.b[n][t],0===Object.keys(i.b[n]).length&&delete i.b[n])});t.a=a},2553:function(e,t,n){"use strict";var i=n(0),r=n(1027),a=n(7),o=Object(a.action)("addInfoBarMessage")(function(e,t,n,a){void 0===n&&(n="0"),-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=i.__spread(e.infoBarIds),a&&(r.b[n]||(r.b[n]={}),r.b[n][t]=a)});t.a=o},2583:function(e,t,n){"use strict";n.r(t);var i=n(1),r=Object(i.action)("loadCLPUserLabels"),a=n(5859),o=n(75),c=n(9),l=function(e){if(!e||!e.value)return{userLabels:[],learnMoreUrl:""};var t=e.value,n=Object(c.a)().SessionSettings.UserLanguage,i={},r="";return t.forEach(function(e){"true"==e.Setting_enabled&&(!r&&e.PolicySetting_customurl&&(r=e.PolicySetting_customurl),i[e.Id]=function(e,t){var n=e["DisplayName_"+t]||e.DisplayName_Fallback;return{id:e.Id,parentId:e.ParentId,displayName:n,infobarDisplayText:n,tooltip:e.Setting_tooltip,settingOrder:parseInt(e.Setting_order),isDefault:"true"==e.PolicySetting_default,isEncryptingLabel:!!e.RightsProtectMessage_Disabled&&"false"==e.RightsProtectMessage_Disabled,children:[]}}(e,n))}),Object.keys(i).forEach(function(e){var t=i[e];if(t.parentId){var n=i[t.parentId];t.infobarDisplayText=n.displayName+"\\"+t.displayName,n&&n.children.push(t),delete i[e]}}),{userLabels:u(Object.values(i)),learnMoreUrl:r}};function u(e){return e?(e.sort(s),e.forEach(function(e){e.children&&e.children.sort(s)}),e):null}function s(e,t){return e.settingOrder-t.settingOrder}var d=n(5),f=n(4517);Object(i.orchestrator)(r,function(){Object(d.d)("cmp-clp")&&Object(o.b)("/compliancepolicy/api/v1.0/user/label").then(function(e){Object(a.a)(l(e)),Object(f.c)(e)})});var b=Object(i.action)("setJustificationSent",function(e,t){return{clpViewState:e,justificationSent:t}});Object(i.mutator)(b,function(e){var t=e.clpViewState,n=e.justificationSent;t.justificationSent=n});var L=Object(i.action)("setSelectedCLPLabel",function(e,t,n){return{labelToSet:e,infoBarViewState:t,clpViewState:n}}),g=n(2553),p=n(1725);Object(i.mutator)(L,function(e){var t=e.infoBarViewState,n=e.clpViewState,i=e.labelToSet,r=t.infoBarIds;n.selectedCLPLabel&&i.id==n.selectedCLPLabel.id?(n.selectedCLPLabel=null,r.indexOf("CLPLabel")>=0&&Object(p.a)(t,"CLPLabel")):i.isDefault?(n.selectedCLPLabel=i,r.indexOf("CLPLabel")>=0&&Object(p.a)(t,"CLPLabel")):(n.selectedCLPLabel=i,r.indexOf("CLPLabel")<0&&Object(g.a)(t,"CLPLabel"))});var v=n(0),O=n(9025),m=n(4),P=n(20),h=n(2),j=n(3013),C=n(1012),y=n(1891),I=n(2515),E=n(1452),S=n(3675),_=n(3101),w=function(e){function t(t){var n=e.call(this,t)||this;return n.confirmDialog=function(){n.props.onDismiss({success:!0,downgradeJustification:n.state.downgradeJustification})},n.closeDialog=function(){n.props.onDismiss({success:!1,downgradeJustification:null})},n.onChoiceChange=function(e,t){if("OTHERS"!=t.key)return n.setState({downgradeJustification:t.value||""}),void(n.isPresetJustification=!0);n.isPresetJustification=!1},n.onTextFieldChange=function(e,t){n.isPresetJustification||n.setState({downgradeJustification:t||""})},n.isPresetJustification=!0,n.state={downgradeJustification:""},n}return v.__extends(t,e),t.prototype.render=function(){var e=this,t=[{key:"LABEL_NOT_APPLY",text:Object(m.a)(O.g),value:"Previous label no longer applies"},{key:"LABEL_NOT_CORRECT",text:Object(m.a)(O.f),value:"Previous label was incorrect"},{key:"OTHERS",text:Object(m.a)(O.e),onRenderField:function(t,n){return h.createElement("div",null,n(t),t.checked&&h.createElement(_.a,{multiline:!0,rows:3,onChange:e.onTextFieldChange}))},styles:{choiceFieldWrapper:{width:"100%"},field:{marginBottom:"10px"}}}],n=!this.state.downgradeJustification;return h.createElement(j.a,{hidden:!1,onDismiss:this.closeDialog,dialogContentProps:{type:C.a.normal,title:Object(m.a)(O.c),subText:Object(m.a)(O.d)}},h.createElement(S.a,{options:t,onChange:this.onChoiceChange}),h.createElement(y.a,null,h.createElement(I.a,{onClick:this.confirmDialog,disabled:n,text:Object(m.a)(O.b)}),h.createElement(E.a,{onClick:this.closeDialog,text:Object(m.a)(O.a)})))},t=v.__decorate([P.observer],t)}(h.Component),D=n(1335);function x(e,t,n,i){var r=n.originalCLPLabel;i&&r&&e.settingOrder<=r.settingOrder&&!n.justificationSent?v.__read(Object(D.a)(w),1)[0].then(function(i){var r=i.success,a=i.downgradeJustification;r&&a&&(b(n,!0),L(e,t,n),Object(f.d)(n,a),Object(f.b)(n.selectedCLPLabel,e))}):(L(e,t,n),Object(f.b)(n.selectedCLPLabel,e))}var B=n(226),T=n.n(B),U=n(661),J=n(385),k=n.n(J),A=n(4836),N=n(73),R=n(4639),M=Object(i.mutatorAction)("updateItemCLPInfoInMailStore",function(e,t){e&&(e.itemCLPInfo=t)}),V=n(5267);function F(e,t){if(Object(d.d)("cmp-clp")&&e&&!e.itemCLPInfo){var n="";n=t?t.Value:Object(V.a)(e),M(e,Object(R.a)(n))}}var H=n(4831),$=n(4522);function z(e){return v.__awaiter(this,void 0,void 0,function(){var t;return v.__generator(this,function(n){return(t=N.a.items.get(e))?t.itemCLPInfo?[2,Promise.resolve(t.itemCLPInfo)]:[2,W(e).then(function(e){return F(t,e),t.itemCLPInfo})]:[2,Promise.resolve(Object($.a)())]})})}function W(e){return v.__awaiter(this,void 0,void 0,function(){return v.__generator(this,function(t){return[2,Object(U.a)([e],k()({BaseShape:"IdOnly",AdditionalProperties:[T()({PropertyName:H.a,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})]}),null).then(function(e){return e&&e[0]&&e[0].Items&&e[0].Items[0]?Object(A.b)(e[0].Items[0],null,H.a):null})]})})}n.d(t,"loadCLPUserLabels",function(){return r}),n.d(t,"showJustificationModal",function(){return x}),n.d(t,"loadItemCLPInfo",function(){return z}),n.d(t,"updateItemCLPInfo",function(){return F}),n.d(t,"logReadCLPLabel",function(){return f.e})},3866:function(e,t,n){"use strict";n.d(t,"b",function(){return r});var i=n(1),r=Object(i.createStore)("CLPUserLabels",{userLabels:[],learnMoreUrl:""});t.a=r()},4517:function(e,t,n){"use strict";n.d(t,"d",function(){return c}),n.d(t,"e",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"a",function(){return s}),n.d(t,"b",function(){return d});var i=n(0),r=n(18),a=n(6),o=n(9);function c(e,t){var n=f(e.selectedCLPLabel,"Change"),a=e.originalCLPLabel,o=e.selectedCLPLabel,c=i.__assign({},n,{IsLabelChanged:!0,LabelIdBefore:a.id,IsProtectionChanged:a.isEncryptingLabel!=o.isEncryptingLabel,ProtectedBefore:a.isEncryptingLabel,UserJustification:t});r.i.importAndExecute(c)}function l(e){var t=f(e,"Discover");r.i.importAndExecute(t)}function u(e){e&&Object(r.o)("LoadCLPLabelOnBoot",{isLabelListEmpty:!e.value||0==e.value.length})}function s(e){e&&Object(r.o)("LoadCLPLabelComposeUsage",{isDefaultLabel:e.isDefault,isEncryptingLabel:e.isEncryptingLabel})}function d(e,t){t&&e?Object(r.o)("LoadCLPLabelChange",{isDowngrade:e.settingOrder>t.settingOrder,isOriginalLabelDefault:e.isDefault}):e&&Object(r.o)("LoadCLPLabelUnselect",{isOriginalLabelDefault:e.isDefault,isOriginalLabelEncrypting:e.isEncryptingLabel})}function f(e,t){var n=Object(o.a)().SessionSettings,i=n.ExternalDirectoryTenantGuid,r=n.UserEmailAddress;return{CreationTime:Object(a.jb)(Object(a.Db)()),Version:"1.1",Operation:t,OrganizationId:i,UserId:r,ApplicationId:"00000002-0000-0ff1-ce00-000000000000",ApplicationName:"Outlook Web",DataState:"Use",LabelId:e?e.id:null,Protected:e?e.isEncryptingLabel:null}}},4522:function(e,t,n){"use strict";function i(){return{nonTenantLabelString:"",selectedLabel:null}}n.d(t,"a",function(){return i})},4639:function(e,t,n){"use strict";var i=n(3866),r=n(4522),a=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/g;function o(e,t){if(!t)return null;for(var n=0;n<t.length;n++){var i=t[n];if(i.id==e)return i;var r=o(e,i.children);if(r)return r}return null}t.a=function(e){var t=Object(r.a)();if(!e)return t;for(var n=e.split(";"),c=Object(i.b)().userLabels,l={},u=0;u<n.length;u++){var s=n[u];if(s){var d=s.match(a);if(d&&0!=d.length){var f=d[0];l[f]?l[f].push(s):l[f]=[s]}}}var b=Object.keys(l);for(u=0;u<b.length;u++){var L=o(b[u],c);if(L){t.selectedLabel=L,delete l[b[u]];break}}return Object.values(l).forEach(function(e){t.nonTenantLabelString+=e.join(";")+";"}),t}},4831:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i="msip_labels"},4836:function(e,t,n){"use strict";function i(e,t,n){var i=r(e,t,n);return i?i.Value:null}function r(e,t,n){if(!e||!e.ExtendedProperty)return null;for(var i=0;i<e.ExtendedProperty.length;i++){var r=e.ExtendedProperty[i],a=null,o=null;if(r&&r.ExtendedFieldURI&&(a=r.ExtendedFieldURI.PropertyTag,o=r.ExtendedFieldURI.PropertyName),t&&a==t)return r;if(n&&o==n)return r}return null}n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r})},5267:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(4836),r="msip_labels";function a(e){return e&&e.ExtendedProperty?Object(i.a)(e,null,r):null}},5859:function(e,t,n){"use strict";var i=n(1),r=n(3866);t.a=Object(i.mutatorAction)("initializeCLPStore",function(e){var t=Object(r.b)();t.userLabels=e.userLabels,t.learnMoreUrl=e.learnMoreUrl})},9025:function(e){e.exports={g:"Zub",f:"_ub",e:"$ub",c:"avb",d:"bvb",b:"cvb",a:"dvb"}}},0,[463,87,464,98]]);
//# sourceMappingURL=owa.CLP.js.map
self.scriptsLoaded['owa.CLP.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.CLP.js'] = (new Date()).getTime();