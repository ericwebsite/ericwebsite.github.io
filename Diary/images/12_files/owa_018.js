self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Analytics.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[98],{11707:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(217),o=n(27),a=n(46),s=n(15),d=n(50);function c(){var e=[],t=window.performance&&window.performance.getEntriesByType?window.performance.getEntriesByType("mark"):function(){var e=[],t=window.performance&&window.performance.timing&&window.performance.timing.fetchStart||Object(s.w)(),n=Object(d.c)();n&&Object.keys(n).map(function(r){e.push({name:r,startTime:n[r]-t|0})});return e}();if(t)for(var n=0;n<t.length;++n){var r={};r.nam=t[n].name,r.st=0|t[n].startTime,e.push(r)}return e}var u=function(e){function t(t){var n=e.call(this,null,null,{isCore:!0})||this;n.addData(a.b.bootType,t),n.addData("FEServer",Object(s.l)()),n.addData("RefUrl",Object(s.r)());var r=window.pltData&&window.pltData.navigationTiming||Object(s.n)();r&&n.addMetrics(r,{pltnav:"pltnav"});var i=c();if(i)for(var d=0;d<i.length;d++){var u=i[d];n.addCustomProperty(u.nam,u.st)}var p=window.pltData&&window.pltData.resourcesTiming||Object(s.s)();if(p){var l=0;for(d=0;d<p.length;d++){var f=p[d],g=void 0;0==f.nam.indexOf("sessiondata.ashx")?g="sd":0==f.nam.indexOf("userbootsettings.ashx")?g="ubs":0==f.nam.indexOf("owa.mail.js")?g="mjs":0==f.nam.indexOf("owa-common-strings.json")?g="cmst":0==f.nam.indexOf("owa-mail-strings.json")?g="mst":"service.svc"!=f.nam&&(g=""+l,l++),n.addMetrics(f,{},g)}}var m=Object(o.f)();return m&&m.UserOptions&&(m.UserOptions.ReactOptinSettings&&m.UserOptions.ReactOptinSettings.MailGraduatedFromBeta&&n.addCustomProperty("graduated","1"),n.addCustomProperty("optin",""+m.UserOptions.ClientTypeOptInState)),n}return r.__extends(t,e),t.prototype.getEventType=function(){return"Owa_PageLoadTime"},t.prototype.addMetrics=function(e,t,n){var i,o,a=Object.keys(e);try{for(var s=r.__values(a),d=s.next();!d.done;d=s.next()){var c=d.value;t[c]?this.addData(t[c],e[c]):this.addCustomProperty(n?c+"-"+n:c,e[c])}}catch(e){i={error:e}}finally{try{d&&!d.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}},t}(i.a);function p(e,t){return e&&e>0&&t&&t>0?Math.floor(e-t):-1}var l=function(e){function t(t,n,r){var i=e.call(this,t,null)||this;return n&&(n.headers&&i.addData(a.b.correlationVectors,n.headers.get("ms-cv")),n.datapoint&&n.datapoint.customData&&i.addCustomData(n.datapoint.customData)),"number"==typeof r&&i.addData(a.b.attemptCount,r,!0),i.addData(a.b.throughAFD,Object(s.x)()),i}return r.__extends(t,e),t.prototype.getEventType=function(){return"client_network_request"},t.prototype.addResponseDiagnostics=function(e){e&&(e.headers&&(this.addData(a.b.requestIds,e.headers.get("request-id")),this.addData(a.b.afdId,e.headers.get("x-msedge-ref")),this.addData(a.b.contentEncoding,e.headers.get("content-encoding")),this.addData(a.b.responseContentLength,e.headers.get("content-length"),!0),this.logTimeDifferenceForHeaders(e.headers,"x-frontend-begin","x-frontend-end",a.c.FETimeElapsed),this.logTimeDifferenceForHeaders(e.headers,"x-backend-begin","x-backend-end",a.c.BETimeElapsed)),this.addData(a.b.status,e.status)),this.parsingTime=Object(d.d)()},t.prototype.addErrorDiagnostics=function(e){this.options=this.options||{},this.options.isCore=!0;var t=typeof e;"object"==t?(this.addData(a.a.errorMsg,e.message),this.addData(a.a.errorDetails,e.stack)):"string"==t&&this.addData(a.a.errorMsg,e)},t.prototype.addResourceTimings=function(e,t){this.addData(a.d.Type,e),this.addTiming(a.b.responseRecieved,p(this.parsingTime,t.ST)),this.addTiming(a.d.WorkerStart,t.WS),this.addTiming(a.d.RedirectStart,t.RdS),this.addTiming(a.d.RedirectEnd,t.RdE),this.addTiming(a.d.FetchStart,t.FS),this.addTiming(a.d.DomainLookupStart,t.DS),this.addTiming(a.d.DomainLookupEnd,t.DE),this.addTiming(a.d.ConnectStart,t.CS),this.addTiming(a.d.SecureConnectionStart,t.SCS),this.addTiming(a.d.ConnectEnd,t.CE),this.addTiming(a.d.RequestStart,t.RqS),this.addTiming(a.d.ResponseStart,t.RpS),this.addTiming(a.d.ResponseEnd,t.RpE),this.addData(a.d.NextHopProtocol,t.P)},t.prototype.addTiming=function(e,t){this.addData(e,t,!0)},t.prototype.logTimeDifferenceForHeaders=function(e,t,n,r){var i=e.get(t),o=e.get(n),a=i?new Date(i):void 0,s=o?new Date(o):void 0;if(a&&s){var d=Math.abs(s.getTime()-a.getTime());this.addCustomProperty(r,d)}},t}(i.a),f=n(855),g=n(5),m=n(2516);var h,v={},b={};function y(e){return new Promise(function(t){var n=D(e);if(!Object(f.a)()||-1==n)return t(void 0);v[n]=function(e,t){if(e)return function(n){e(n),t(n)};return t}(v[n],t),w(),clearTimeout(h),h=setTimeout(function(){var e,t;w();try{for(var n=r.__values(Object.keys(v)),i=n.next();!i.done;i=n.next()){T(i.value)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}b={}},2e3)})}function w(){var e,t,n;n=window.performance.getEntriesByType("resource"),b=n.reduce(function(e,t){var n=D(t.name);return n>-1&&(e[n]=t),e},b||{}),function(e){Object(g.d)("an-log-assets")&&e.forEach(function(e){if(e&&(Object(m.a)(e.name,".js")||Object(m.a)(e.name,".json"))){var t=e.name.split("/"),n=t[t.length-1],r=new l(n);r.addResourceTimings("Asset",e),le(r)}})}(n.map(O)),window.performance.clearResourceTimings?window.performance.clearResourceTimings():window.performance.webkitClearResourceTimings&&window.performance.webkitClearResourceTimings();try{for(var i=r.__values(Object.keys(v)),o=i.next();!o.done;o=i.next()){var a=o.value,s=b[a];s&&T(a,s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}}function T(e,t){v[e](O(t)),delete v[e],delete b[e]}function O(e){if(e){var t=e.startTime;return{name:e.name,ST:t,WS:p(e.workerStart,t),RdS:p(e.redirectStart,t),RdE:p(e.redirectEnd,t),FS:p(e.fetchStart,t),DS:p(e.domainLookupStart,t),DE:p(e.domainLookupEnd,t),CS:p(e.connectStart,t),SCS:p(e.secureConnectionStart,t),CE:p(e.connectEnd,t),RqS:p(e.requestStart,t),RpS:p(e.responseStart,t),RpE:p(e.responseEnd,t),P:e.nextHopProtocol}}}var S=/n=([\d]+)/;function D(e){var t=S.exec(e);return t&&parseInt(t[1])||-1}function P(e,t,n,r,i){var o=new l(t,i,r);return e.then(function(e){return o.addResponseDiagnostics(e),i&&i.datapoint&&(i.datapoint.headersCustomData&&e&&o.addCustomData(i.datapoint.headersCustomData(e.headers)),i.datapoint.jsonCustomData)?e.clone().json().then(function(e){o.addCustomData(i.datapoint.jsonCustomData(e))}):Promise.resolve()}).catch(function(e){o.addErrorDiagnostics(e)}).then(function(){return y(n)}).then(function(e){e&&o.addResourceTimings("ServiceAction",e),le(o)})}var j=n(23),E=n(853),C=n(634),x=n(12),A=function(e){var t=e.eventName;if(t&&Object(j.d)("dp")&&(!Object(j.a)("dp")||t.toLowerCase().indexOf(Object(j.a)("dp").toLowerCase())>-1)||Object(E.a)().traceDatapoints){var n="Datapoint: "+t+"-"+Object(C.a)(e.properties)+"-"+Object(C.b)(e);x.c.info(n)}},I=function(){var e=navigator,t=e.connection||e.mozConnection||e.webkitConnection;return t?{type:t.type,effectiveType:t.effectiveType,downlink:t.downlink,rtt:t.rtt,saveData:t.saveData}:null},L=null,k=!1;"undefined"!=typeof location&&(k=location.hostname&&location.hostname.indexOf("live.com")>-1);var R=function(){if(!L){var e=Object(o.f)();e&&(L=e.IsConsumerChild?"c_child":e.SessionSettings.IsPremiumConsumerMailbox?"c_premium":e.SessionSettings.IsShadowMailbox?"c_shadow":k?"c_standard":"business")}return L},M=n(1692);function _(e){return M.AWTLogManager.getLogger(e)}function W(e){return new M.AWTEventProperties(e)}function N(e){var t=Object(o.f)().SessionSettings;e.setProperty(a.b.beServer,Object(s.c)()),e.setProperty(a.b.mbxGuid,t.MailboxGuid),e.setProperty(a.b.forest,Object(s.k)()),e.setProperty(a.b.puid,t.UserPuid),e.setProperty(a.b.clientId,Object(s.h)()),e.setProperty(a.b.ring,Object(s.m)()),e.setProperty(a.b.userType,R()),e.setProperty(a.b.app,Object(s.b)()),e.setProperty(a.b.layout,"Desktop"),e.setProperty(a.b.tenantGuid,t.ExternalDirectoryTenantGuid)}var F=n(1857),U=n(414),V=["https://swc.cdn.skype.com","https://acdn.adnxs.com/","https://s.aolcdn.com"];var B="client_error",H="diagnostics",G=function(e){function t(t){var n,r,i=this,o=t.stack||t.message,a=o?F.Md5.hashStr(o):-1;(i=e.call(this,a)||this).isExternal=(n=t.message,r=t.stack,V.some(function(e){return n&&n.indexOf(e)>-1||r&&r.indexOf(e)>-1}));try{i.addData("message",t.message),i.addData("background",Object(U.b)()),i.addIfNotNull("name",t.name),i.addIfNotNull("stack",t.stack||new Error(t.message).stack),i.addIfNotNull("file",t.filename),i.addIfNotNull("line",t.lineno,!0),i.addIfNotNull("col",t.colno,!0),i.addIfNotNull(H,t.diagnosticInfo),window&&window.navigator&&"boolean"==typeof window.navigator.onLine&&i.addData("online",window.navigator.onLine)}catch(e){i.addData(H,e.message)}return i}return r.__extends(t,e),t.prototype.getEventType=function(){return this.isExternal?"client_error_external":B},t.prototype.addIfNotNull=function(e,t,n){t&&this.addData(e,t,n)},t}(i.a),q=n(2838),z=n(647),J=n(24),K=n(75),Z=n(56);function $(e,t){Object(g.d)("fwk-sigs")&&Object(J.d)(function(){var n=Object(o.f)(),r=n&&n.SessionSettings,i=t&&t.customProperties?t.customProperties:{},a={SignalType:e,Locale:r&&r.UserCulture,Compliance:"EUII",StartTime:(t&&t.start||new Date).toISOString(),EndTime:(new Date).toISOString(),Application:{AadAppId:"00000002-0000-0ff1-ce00-000000000000",AppName:"OWA",AppVer:Object(s.i)(),Workload:"EXO"},Actor:{AadTenantId:r&&r.ExternalDirectoryTenantGuid,ActorIdType:Object(Z.a)()?"MSA":"AAD",ActorId:r&&"PUID:"+r.UserPuid,ActorType:"User"},Device:{},CustomProperties:i};t&&t.itemId&&(a.Item={ItemType:"Message",ItemId:t.itemId}),Object(K.d)("/api/v2.0/me/signals",a,null,!1,{Prefer:'exchange.behavior="SignalAccessV2,OpenComplexTypeExtensions,EhamJitProvisioning",outlook.data-source="Substrate"'},!1,!0,!0,"SigsUpload",{customData:{Type:e}})})}var X,Q=n(513);function Y(e){return"function"==typeof e.ariaTenantTokens?e.ariaTenantTokens():e.ariaTenantTokens}n.d(t,"getInitializeAnalyticsPromse",function(){return te}),n.d(t,"defaultAnalyticsOptions",function(){return re}),n.d(t,"initializeAnalytics",function(){return ie}),n.d(t,"getOTelAddinsLogger",function(){return oe}),n.d(t,"getSessionId",function(){return ae}),n.d(t,"flush",function(){return se}),n.d(t,"shouldLogDatapoint",function(){return pe}),n.d(t,"logDatapoint",function(){return le}),n.d(t,"logPLTDatapoint",function(){return fe}),n.d(t,"logErrorDatapoint",function(){return me}),n.d(t,"logCLPAriaDataPoint",function(){return he}),n.d(t,"captureServiceActionOptics",function(){return P}),n.d(t,"getResourceTimingForUrl",function(){return y}),n.d(t,"logSigsDatapoint",function(){return $});var ee=new Promise(function(e){X=e});function te(){return ee}var ne,re={ariaTenantTokens:[],isTesting:!1,maxErrorsPerSession:100,flightControls:null,verboseWhiteListEvents:[]};function ie(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var i,d,c,u;return r.__generator(this,function(p){switch(p.label){case 0:if(e&&(e=r.__assign({},re,e)),(Object(g.d)("ring-dogfood")||Object(g.d)("an-no-sample-ppe"))&&delete e.flightControls,l=e.ariaTenantTokens[0],M.AWTLogManager.setTransmitProfile(M.AWT_NEAR_REAL_TIME),M.AWTLogManager.initialize(l),i=M.AWTLogManager.getSemanticContext(),d=Object(o.f)(),i&&(i.setAppVersion(Object(s.i)()),d&&(i.setUserTimeZone(d.UserOptions.TimeZone),i.setUserLanguage(d.SessionSettings.UserCulture))),!de(e))return[3,5];p.label=1;case 1:return p.trys.push([1,4,,5]),[4,n];case 2:return c=p.sent(),[4,Object(s.d)()];case 3:return u=p.sent(),Y(e).forEach(function(e){ne=function(e,t,n,r,i){var o=_(e),d=W();if(d.setProperty(a.b.features,JSON.stringify(n)),N(d),d.setProperty(a.b.serviceVersion,Object(s.v)()),d.setProperty(a.b.dag,Object(s.j)()),d.setProperty(a.b.bootType,i),t){var c=t.UserOptions,u=t.ViewStateConfiguration,p={WindowWidth:window.innerWidth,WindowHeight:window.innerHeight};window.screen&&(p.ScreenWidth=window.screen.availWidth,p.ScreenHeight=window.screen.availHeight),d.setProperty(a.b.Settings,JSON.stringify({ReadingPanePosition:c.GlobalReadingPanePositionReact,ListViewType:c.GlobalListViewTypeReact,FocusedEnabled:c.IsFocusedInboxEnabled,ListViewBits:u.ListViewBitFlags,FolderViewBits:u.GlobalFolderViewState,PreviewText:c.ShowPreviewTextInListView,SenderOnTop:c.ShowSenderOnTopInListView,InlinePreviews:c.ShowInlinePreviews,HoverActions:u.MailTriageOnHoverActions,Ponts:c.NewEnabledPonts,Theme:(c.ThemeStorageId||"")+"|"+c.IsDarkModeTheme,MasterCategories:(t.MasterCategoryList.MasterList||[]).length,IsEdu:r&&r.IsEdu,NetworkInfo:I(),Dimensions:p,AdMarket:t.AdMarket,DisplayDensity:c.DisplayDensityMode,ConsumerAdsExperiment:c.ConsumerAdsExperimentMode})),d.setProperty(a.b.Dates,JSON.stringify({OwaLogon:c.FirstOWALogon,MailLogon:c.FirstOWAReactMailLogon,PeopleLogon:c.FirstOWAReactPeopleLogon,CalendarLogon:c.FirstOWAReactCalendarLogon,MiniLogon:c.FirstOWAReactMiniLogon,MailboxCreate:t.MailboxCreateDate}))}return o.logSession(M.AWTSessionState.Started,d),o.getSessionId()}(e,d,t,c,u)}),[3,5];case 4:return p.sent(),[3,5];case 5:return X(e),[2]}var l})})}function oe(e){return _(e)}function ae(){return ne}function se(){M.AWTLogManager.flush(function(){})}function de(e){return Object(j.e)()||e&&e.isTesting||Object(s.y)()}function ce(e,t){return!t||!t.flightControls||e.options&&e.options.isCore?null:t.flightControls[e.getEventType()]}var ue=0;function pe(e,t){var n=e.getEventType();if(Object(i.d)(n))return!0;if(n==i.b&&(!t.verboseWhiteListEvents||-1==t.verboseWhiteListEvents.indexOf(e.eventName)))return!1;if(n==B&&++ue>t.maxErrorsPerSession)return!1;var r=ce(e,t);return!(r&&!Object(g.a)(r.flight))&&((!e.options||!e.options.logEvery||(e.sessionOccurence-1)%e.options.logEvery==0)&&(function(e){return!e.options||!e.options.sessionSampleRate||Object(q.a)(e.options.sessionSampleRate)}(e)&&function(e){switch(e.options&&e.options.variant){case 0:return!1;case 2:return 1==e.sessionOccurence;case 3:return e.sessionOccurence>1;default:return!0}}(e)))}function le(e){ee.then(function(t){var n=Object(g.d)("an-full-logging"),r=ce(e,t);if((pe(e,t)||n)&&(A(e),!de(t)))for(var o=function(e,t){return t&&t.tenantTokens?t.tenantTokens:Y(e)}(t,e.options),s=e.getEventType(),d=0;d<o.length;d++){var c=W(n?i.b:s);n&&c.setProperty(a.b.originalEvent,s,M.AWTPropertyType.String);for(var u=Object.keys(e.properties),p=0;p<u.length;p++){var l=e.properties[u[p]];c.setProperty(u[p],l.value,l.isInt?M.AWTPropertyType.Int64:M.AWTPropertyType.Unspecified)}N(c),c.setProperty(a.b.Sampled,r&&r.rate?r.rate:100),e.propertyBag&&c.setProperty(a.b.miscData,Object(C.b)(e)),e.piiBag&&c.setPropertyWithPii(a.b.piiData,Object(C.a)(e.piiBag),M.AWTPiiKind.GenericData),_(o[d]).logEvent(c)}})}function fe(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return e=le,t=u.bind,[4,Object(s.d)()];case 1:return e.apply(void 0,[new(t.apply(u,[void 0,n.sent()]))]),[2]}})})}var ge=["out of memory","not enough storage is available"];function me(e){try{le(e.knownError||function(e){if(e)for(var t=0;t<ge.length;t++)if(e.toLowerCase().indexOf(ge[t])>-1)return!0;return!1}(e.message)?new Q.a("KNOWN_ERROR",{message:e.message}):new G(e))}catch(e){}}function he(e){var t=W("CLPLabel");Object.keys(e).map(function(n){t.setProperty(n,e[n])}),_(Object(z.b)()).logEvent(t)}},2838:function(e,t,n){"use strict";var r;function i(e){return void 0===r&&(r=Math.floor(1e4*Math.random())),r<100*e}n.d(t,"a",function(){return i})}},0,[463,87]]);
//# sourceMappingURL=owa.Analytics.js.map
self.scriptsLoaded['owa.Analytics.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Analytics.js'] = (new Date()).getTime();