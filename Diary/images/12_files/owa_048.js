self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailFavoritesStore.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[274],{1002:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"IsLessThanOrEqualTo:#Exchange"},e)}},1003:function(e,t,n){"use strict";var r=n(0),o=n(7),i=function(){function e(e){this.maxSize=e,this.references=[],this.mruList=[]}return e.prototype.initialize=function(e,t){var n,o;if(this.store)throw new Error("MruCache cannot be initialized twice.");this.store=e,this.deleteCallback=t;try{for(var i=r.__values(e.keys()),a=i.next();!a.done;a=i.next()){var c=a.value;this.mruList.push(c)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}},e.prototype.add=function(e,t){var n=this;Object(o.action)("MruCache_add")(function(){n.store.set(e,t),n.mruList.indexOf(e)>=0?n.touch(e):(n.mruList.push(e),n.purgeIfNecessary())})()},e.prototype.get=function(e){return this.store.get(e)},e.prototype.getAndTouch=function(e){var t=this.store.get(e);return t&&this.touch(e),t},e.prototype.has=function(e){return this.store.has(e)},e.prototype.remove=function(e){var t=this;Object(o.action)("MruCache_remove")(function(){if(t.store.has(e)&&!t.isReferenced(e))return t.removeItemAtIndex(t.mruList.indexOf(e))})()},e.prototype.registerReference=function(e){this.references.push(e)},e.prototype.clear=function(){var e=this;Object(o.action)("MruCache_clear")(function(){e.purgeTillSize(0)})()},e.prototype.getItemIds=function(){return new(Array.bind.apply(Array,r.__spread([void 0],this.mruList)))},e.prototype.touch=function(e){var t=this.mruList.indexOf(e);if(t<0)throw new Error("Item with key '"+e+"' does not exist in the cache.");this.mruList.splice(t,1),this.mruList.push(e)},e.prototype.purgeIfNecessary=function(){this.purgeTillSize(this.maxSize)},e.prototype.purgeTillSize=function(e){for(var t=0;this.mruList.length>e&&t<this.mruList.length;){var n=this.mruList[t];this.isReferenced(n)?t++:this.removeItemAtIndex(t)}},e.prototype.removeItemAtIndex=function(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);var t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)},e.prototype.isReferenced=function(e){for(var t=0;t<this.references.length;t++)if(this.references[t]()==e)return!0;return!1},e}();n.d(t,"a",function(){return i})},1015:function(e,t,n){"use strict";n.d(t,"m",function(){return i}),n.d(t,"l",function(){return a}),n.d(t,"o",function(){return c}),n.d(t,"q",function(){return u}),n.d(t,"p",function(){return s}),n.d(t,"b",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"g",function(){return f}),n.d(t,"h",function(){return b}),n.d(t,"k",function(){return h}),n.d(t,"n",function(){return p}),n.d(t,"r",function(){return m}),n.d(t,"c",function(){return v}),n.d(t,"d",function(){return g}),n.d(t,"j",function(){return S}),n.d(t,"f",function(){return O}),n.d(t,"i",function(){return _}),n.d(t,"a",function(){return I});var r=n(3),o=(n(1319),new r.c(function(){return Promise.all([n.e(532),n.e(12),n.e(37),n.e(57),n.e(457)]).then(n.bind(null,2337))})),i=new r.a(o,function(e){return e.onSmimeItemAttachmentOpened}),a=new r.a(o,function(e){return e.mergeSmimeDecodedMessageProperties}),c=(new r.b(o,function(e){return e.fetchAndDecodeSmimeMessage}),new r.b(o,function(e){return e.setSmimePropertiesInDraftMessage})),u=new r.b(o,function(e){return e.trySetSmimeProperties}),s=new r.b(o,function(e){return e.tryAddSmimeProperties}),d=new r.b(o,function(e){return e.createMailResponseBodyContent}),l=new r.b(o,function(e){return e.downloadSmimeAttachment}),f=new r.b(o,function(e){return e.getMergedSmimeViewState}),b=new r.b(o,function(e){return e.getMergedSmimeViewStateForDraft}),h=new r.b(o,function(e){return e.isSmimeItemDecoding}),p=new r.b(o,function(e){return e.previewSmimeAttachment}),m=new r.b(o,function(e){return e.updateSmimeAttachmentIds}),v=new r.b(o,function(e){return e.createSmimeAttachmentsFromFiles}),g=new r.b(o,function(e){return e.createSmimeAttachmentsViaSmimeQueueManager}),S=new r.b(o,function(e){return e.initializeAttachmentStateForSmimeAttachments}),O=new r.b(o,function(e){return e.getAttachmentsForSmimeResponse}),_=new r.b(o,function(e){return e.getSmimeAttachmentsForRequest}),I=Object(r.d)(o,function(e){return e.SignatureDetails})},1017:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(266),o=n(5),i=n(27);function a(){var e=!0;if(Object(i.n)()){var t=Object(r.c)(r.a.ExternalImages);e=!Object(o.d)("rp-externalImagesProxyOption")||null===t.externalImagesSelectedOption||0===t.externalImagesSelectedOption}else{var n=Object(i.f)().PolicySettings;e=void 0===n.ExternalImageProxyEnabled||n.ExternalImageProxyEnabled}return e}},1019:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetConversationItemsJsonRequest:#Exchange"},e)}},1020:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"e",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c});var r="X-OWA-SmimeInstalled",o="1",i="SmimeWithoutActiveX",a="message/rfc822",c="ErrorSmimeSendCancelled"},1033:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConversationResponseShape:#Exchange"},e)}},1069:function(e,t,n){"use strict";var r=n(0),o=n(4),i=n(642),a=n(7),c=Object(a.action)("setIsPendingFetch")(function(e,t){e.personaBlob.isPendingFetch=t}),u={},s=n(495),d=n(561),l=n(18),f=n(5),b=n(56),h=n(282),p=n(12);n.d(t,"a",function(){return _});var m="GetProfileImageTime",v="GetPersonaTime",g="GetProfileImageNoPhoto",S="GetPersonaResponseNoPhoto",O="https://outlook.office.com/M365.Access";function _(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,i=this;return r.__generator(this,function(a){switch(a.label){case 0:return n=e.personaBlob,!t&&(n.isPendingFetch||n.hasFetchFailed||n.blobUrl&&u[n.blobUrl]||Object(o.g)(e.emailAddress)&&Object(o.g)(e.personaId))?[2]:[4,new Promise(function(n,o){return r.__awaiter(i,void 0,void 0,function(){var i,a,u;return r.__generator(this,function(r){switch(r.label){case 0:return Object(b.a)()&&Object(f.d)("rp-imageApiConsumer")?[4,I(e,t)]:[3,2];case 1:return a=r.sent(),[3,3];case 2:a=function(e,t){var n=Object(d.a)(e.emailAddress,e.personaId),r=new XMLHttpRequest;r.open("GET",n),r.responseType="blob",t&&r.setRequestHeader("Cache-Control","no-cache");return r}(e,t),r.label=3;case 3:if(i=a){c(e,!0),s=Object(b.a)()&&Object(f.d)("rp-imageApiConsumer")?m:v,u=new l.b(s),i.onreadystatechange=function(){4===i.readyState&&(j(e,i),u.end(),u=null,n())};try{i.send()}catch(t){c(e,!1),p.c.warn("Error in getPersonaPhoto "+t),o(t)}}else o("request is null");return[2]}var s})})})];case 1:return a.sent(),[2]}})})}function I(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,o,a,c,u,d,l,f;return r.__generator(this,function(r){switch(r.label){case 0:return[4,Object(h.getDelegationTokenForOwa)(O)];case 1:return(n=r.sent())?(o=Object(s.a)(e.emailAddress,e.mailboxType),(a=new XMLHttpRequest).open("GET",o),a.responseType="blob",t&&a.setRequestHeader("Cache-Control","no-cache"),a.setRequestHeader("Content-Type","image/gif"),a.setRequestHeader("Authorization","Bearer "+n),a.setRequestHeader("X-AnchorMailbox",e.emailAddress),[2,a]):(c=e.name,u=e.emailAddress,d=e.personaId,l=e.size,f=e.mailboxType,i.a.add({name:c,emailAddress:u,personaId:d,size:l,mailboxType:f}),[2,null])}})})}var j=Object(a.action)("processGetPhotoResponse")(function(e,t){if(c(e,!1),200===t.status){var n=t.response,r=t.getResponseHeader("Content-Type");if(r&&0==r.toLowerCase().indexOf("image")&&n instanceof Blob){if(n.size>100)return e.personaBlob.blobUrl=URL.createObjectURL(n),u[e.personaBlob.blobUrl]=!0,void(e.personaBlob.hasFetchFailed=!1);o=Object(b.a)()&&Object(f.d)("rp-imageApiConsumer")?g:S,Object(l.p)(o)}}var o;e.personaBlob.hasFetchFailed=!0})},1070:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e.NotInitialized="NotInitialized",e.Initializing="Initializing",e.Initialized="Initialized",e.Failed="Failed"}(r||(r={}))},1075:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(688);function o(e){return Object(r.a)().options[e]}},1076:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UnifiedGroupIdentity:#Exchange"},e)}},1081:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(1),o=Object(r.action)("REFRESH_SHARING_TIPS_ATTACHMENT_WELL",function(e,t,n,r,o,i){return{attachmentWellViewState:e,parentItemId:t,recipientInfo:n,infoBarIds:r,infoBarAddHandler:o,infoBarRemoveHandler:i}}),i=Object(r.action)("REMOVE_LINKS_THEN_REFRESH_SHARING_TIPS",function(e){return{linkIds:e}})},1084:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(34);function o(e){return Object(r.a)(e).searchBoxWidth}},1088:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("ON_ATTACHMENT_CREATED",function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}})},1089:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("ON_ATTACHMENT_DELETED",function(e,t,n){return{parentItemId:e,attachmentId:t,attachment:n}})},1098:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.OptionsNotLoaded=0]="OptionsNotLoaded",e[e.OptionsLoading=1]="OptionsLoading",e[e.OptionsLoaded=2]="OptionsLoaded"}(r||(r={}))},1099:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1),o=n(680),i=Object(r.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",function(e){return void 0===e&&(e=Object(o.a)()),{defaultOptions:e}})},1105:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(429),o=n(4),i=n(456);function a(e,t){var n=t||Object(o.a)(r.a),a=n;return Object(i.a)(e)||(a=""),{ariaLabel:n,placeholder:a}}},1106:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(34);function o(e){var t=Object(r.a)(e);return!!t.suggestionPills.size||!!t.suggestionSegments.size}},1109:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r={};function o(e){return r[e]}function i(e,t){r[e]=t}},1112:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"DynamicRefinerQueryType:#Exchange"},e)}},1113:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"PrimaryMailboxSearchScopeType:#Exchange"},e)}},1114:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},e)}},1115:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SingleGroupSearchScopeType:#Exchange"},e)}},1118:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ExecuteSearchJsonRequest:#Exchange"},e)}},1119:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ExecuteSearchRequest:#Exchange"},e)}},1120:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"StartSearchSessionRequest:#Exchange"},e)}},1121:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(1495);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("StartSearchSession",e,t)}},1122:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"EndSearchSessionRequest:#Exchange"},e)}},1123:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(1496);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("EndSearchSession",e,t)}},1125:function(e,t,n){"use strict";var r=n(0),o=n(7),i=n(388),a=0;t.a=Object(o.action)("addNotification")(function(e){var t=r.__assign({id:a++},e);i.a.notificationViewStates.push(t)})},1126:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return c});var r=n(570),o=n(694),i={};function a(e,t){var n=r.a[e];i[n]||(i[n]=t)}function c(e){var t=i[r.a[e.actionType]];t&&t(e),Object(o.a)(e)}},1127:function(e,t,n){"use strict";n.d(t,"o",function(){return s}),n.d(t,"h",function(){return d}),n.d(t,"d",function(){return l}),n.d(t,"c",function(){return f}),n.d(t,"g",function(){return b}),n.d(t,"f",function(){return h}),n.d(t,"j",function(){return p}),n.d(t,"k",function(){return m}),n.d(t,"e",function(){return v}),n.d(t,"i",function(){return g}),n.d(t,"b",function(){return S});var r=n(3),o=n(1907);n.d(t,"a",function(){return o.a});var i=n(1910);n.d(t,"m",function(){return i.a});var a=n(1903);n.d(t,"n",function(){return a.a});var c=n(1905);n.d(t,"l",function(){return c.a});var u=new r.c(function(){return Promise.all([n.e(4),n.e(7),n.e(8),n.e(19),n.e(292)]).then(n.bind(null,3074))}),s=new r.a(u,function(e){return e.initializeMeetingRequestViewStateAction}),d=Object(r.d)(u,function(e){return e.MeetingMessageInfo}),l=(Object(r.d)(u,function(e){return e.MeetingRequestActions}),Object(r.d)(u,function(e){return e.MeetingCancellationInfo})),f=Object(r.d)(u,function(e){return e.MeetingActionButton}),b=Object(r.d)(u,function(e){return e.MeetingDetailsTime}),h=Object(r.d)(u,function(e){return e.MeetingDetailsLocation}),p=Object(r.d)(u,function(e){return e.MeetingRequestInfo}),m=Object(r.d)(u,function(e){return e.MeetingRequestResponseEditor}),v=Object(r.d)(u,function(e){return e.MeetingDetails}),g=Object(r.d)(u,function(e){return e.MeetingRequestConflicts}),S=Object(r.d)(u,function(e){return e.EditEventLink})},1140:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(1),o=Object(r.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),i=Object(r.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},1162:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(500),o=n(501),i=n(502),a=n(226);t.getJsonRequestHeader=function(e){return r.default({RequestServerVersion:"Exchange2015",TimeZoneContext:o.default({TimeZoneDefinition:i.default({Id:null!=e?e:"Pacific Standard Time"})})})},t.getExtendedPropertyUri=function(e,t,n){return a.default({PropertySetId:e,PropertyName:t,PropertyType:n})}},1166:function(e,t,n){"use strict";var r=n(0),o=n(2),i=n(338),a=n(131),c=n(801),u=n(14),s=n(333),d=n(339),l=n(435),f=Object(s.b)(function(e,t){var n,r=Object(d.a)(e),o=Object(l.a)(e),i=e.palette,a=e.semanticColors,c={root:{padding:"0 4px",width:"32px",height:"32px",backgroundColor:"transparent",border:"none",color:a.actionLink},rootHovered:{color:a.actionLinkHovered,selectors:(n={},n[u.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},n)},rootPressed:{color:i.themePrimary},rootExpanded:{color:i.themePrimary},rootChecked:{backgroundColor:a.buttonBackgroundChecked},rootCheckedHovered:{backgroundColor:a.buttonBackgroundHovered},rootDisabled:{color:a.disabledText}};return Object(u.concatStyleSets)(r,c,o,t)});n.d(t,"a",function(){return b});var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._skipComponentRefResolution=!0,t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return o.createElement(i.a,r.__assign({},this.props,{variantClassName:"ms-Button--icon",styles:f(n,t),onRenderText:a.b,onRenderDescription:a.b}))},t=r.__decorate([Object(c.a)("IconButton",["theme","styles"],!0)],t)}(a.a)},1167:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("ADD_PUBLIC_FOLDER_TO_STORE",function(e,t){return{state:e,item:t}})},11692:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1),i=n(26),a=n(5),c=n(95),u=1e4,s={folderId:"",timeRemoved:null};var d=Object(o.action)("ADD_FAVORITE_FOLDER",function(e,t){return Object(i.a)({name:Object(a.d)("tri-favorites-roaming")?"AddOutlookFavoriteFolder":"AddFavoriteFolder",customData:{actionSource:t,distinguishedFolderName:Object(c.a)(e),wasFolderUnfavoritedRecently:(n=e,!(!s.folderId||s.folderId!=n)&&(new Date).getTime()-s.timeRemoved.getTime()<u)}},{folderIdToAdd:e,actionSource:t});var n}),l=n(6267),f=n(21),b=n(7),h=n(66),p=Object(b.action)("addFavoriteFolderV1")(Object(b.select)({favoritesFolderNodes:function(){return h.favoritesStore.favoritesFolderNodes},orderedFavoritesNodeIds:function(){return h.favoritesStore.orderedFavoritesNodeIds},folder:function(e){return f.n.folderTable.get(e)}})(function(e,t){if(t.favoritesFolderNodes.has(e))throw new Error("addFavoriteFolderV1: Cannot add duplicate folder to favorites.");t.orderedFavoritesNodeIds.push(e),t.favoritesFolderNodes.set(e,{id:e,type:0}),Object(h.updateFavoritesUserOption)(),Object(l.a)(t.folder,!0)})),m=(Object(o.orchestrator)(d,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return t=e.folderIdToAdd,Object(a.d)("tri-favorites-roaming")?[4,h.lazyAddFavoriteFolderV2.import()]:[3,2];case 1:return n.sent()(t),[3,3];case 2:p(t),n.label=3;case 3:return[2]}})})}),Object(o.action)("REMOVE_FAVORITE_FOLDER",function(e,t){return Object(i.a)({name:Object(a.d)("tri-favorites-roaming")?"RemoveFavoriteFolderV2":"RemoveFavoriteFolderV1",customData:{actionSource:t,distinguishedFolderName:Object(c.a)(e)}},{folderIdToRemove:e,actionSource:t})})),v=Object(b.action)("removeFavoriteFolderV1")(Object(b.select)({favoritesFolderNodes:function(){return h.favoritesStore.favoritesFolderNodes},orderedFavoritesNodeIds:function(){return h.favoritesStore.orderedFavoritesNodeIds},folder:function(e){return f.n.folderTable.get(e)}})(function(e,t){if(!t.favoritesFolderNodes.has(e))throw new Error("removeFavoriteFolderV1: Cannot find the folder id in favorite folder list.");t.orderedFavoritesNodeIds.splice(t.orderedFavoritesNodeIds.indexOf(e),1),t.favoritesFolderNodes.delete(e),Object(h.updateFavoritesUserOption)(),s={folderId:e,timeRemoved:new Date},Object(l.a)(t.folder,!1)})),g=(Object(o.orchestrator)(m,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return t=e.folderIdToRemove,Object(a.d)("tri-favorites-roaming")?[4,h.lazyRemoveFavoriteFolderV2.import()]:[3,2];case 1:return n.sent()(t),[3,3];case 2:v(t),n.label=3;case 3:return[2]}})})}),n(1545)),S=n(225),O=n(422);Object(o.orchestrator)(h.onCategoryFavorited,function(e){var t=e.categoryId;g.a(t),function(e){var t=Object(S.b)(e),n=Object(O.c)(t,!0);Object(S.i)(n,!1,function(t,n,r,o){return function(e){g.b(e)}(e)})}(t)});Object(o.orchestrator)(h.onCategoryUnfavorited,function(e){g.b(e.categoryId)});var _=n(9008),I=n(2875),j=n(2796),E=n(2876),T=n(2797),w=n(4),C=n(798);function y(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){return t=e?C.c.RemoveFavoritePersonaFailedNotification:C.c.AddFavoritePersonaFailedNotification,Object(C.g)(t,null),n={actionType:t,title:e?Object(w.a)(j.a):Object(w.a)(T.a),description:e?Object(w.a)(I.a):Object(w.a)(E.a),actionLink:Object(w.a)(_.a)},Object(C.f)(n),[2]})})}var x=n(12);function A(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){return t=e?Object(w.a)(j.a):Object(w.a)(T.a),x.c.warn(t),[2]})})}Object(o.orchestrator)(h.addFavoriteFailed,function(e){var t=e.favoriteKind;"persona"===t?y(!1):"privatedistributionlist"===t&&A(!1)}),Object(o.orchestrator)(h.removeFavoriteFailed,function(e){var t=e.favoriteKind,n=e.error;n&&404===n.statusCode||("persona"===t?y(!0):"privatedistributionlist"===t&&A(!0))});var P=Object(b.action)("markFavoritePersonaNodeAsAdded")(Object(b.select)({favoritesPersonaNodes:function(){return h.favoritesStore.favoritesPersonaNodes}})(function(e,t){var n=t.favoritesPersonaNodes.get(e);n&&(n.isJustAdded=!1)})),R=n(1981),N=n(1984),F=n(94),M=n(18),k=n(789),D=Object(i.b)("validateAndUpdateFavorite",k.a.ValidateAndUpdateFavorite)(function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,o,i,a,c,u,s,d,l,f,b,p;return r.__generator(this,function(r){switch(r.label){case 0:return t=Object(h.getStore)(),n=t.favoritesPersonaNodes.get(e),o=Object(F.b)(e)?e:"",n.personaId?(i=Object(N.a)(n.mainEmailAddress,n.displayName,!1),[4,Object(R.a)(n.personaId)]):[3,5];case 1:return(p=r.sent())?(c=p,[3,4]):[3,2];case 2:return[4,i];case 3:c=r.sent(),r.label=4;case 4:return(a=c)?(u=a.DisplayName,s=B(a.EmailAddress),d=(a.EmailAddresses||[]).map(B),l=n.displayName!==u,f=n.mainEmailAddress!==s,m=n.allEmailAddresses,v=d,b=!(m&&v&&m.length===v.length&&m.every(function(e){return v.includes(e)})),l||f||b?(Object(M.o)("ValidateAndUpdateFavorite: Change Detected",["ContactToUpdatedContact",o,l,f,b]),L(n,u,s,d,a.PersonaId.Id),[2,!0]):[2,!1]):(Object(M.o)("ValidateAndUpdateFavorite: Change Detected",["ContactToRecipentCache",o]),L(n,n.displayName,n.mainEmailAddress,n.allEmailAddresses),[2,!0]);case 5:return[4,Object(N.a)(n.mainEmailAddress,n.displayName,!1)];case 6:return(p=r.sent())?(Object(M.o)("ValidateAndUpdateFavorite: Change Detected",["RecipientCacheToContact",o]),L(n,p.DisplayName,B(p.EmailAddress),p.EmailAddresses.map(B),p.PersonaId.Id),[2,!0]):[2,!1];case 7:return[2]}var m,v})})}),L=Object(b.action)("updatePersona")(function(e,t,n,r,o){e.displayName=t||n,e.mainEmailAddress=n,e.allEmailAddresses=r,o?e.personaId=o:delete e.personaId});function B(e){return e?e.RoutingType&&"EX"===e.RoutingType.toUpperCase()?e.OriginalDisplayName:e.EmailAddress||e.OriginalDisplayName:""}var G=n(1971),U=n(194),H=Object(b.action)("updateSelectedNodeWithNewPersona")(function(e){var t=Object(h.getStore)().favoritesPersonaNodes.get(e),n=Object(U.d)();n.selectedNode=r.__assign({},n.selectedNode,{displayName:t.displayName,mainEmailAddress:t.mainEmailAddress})}),V=n(1750),q=Object(i.b)("onFavoritePersonaSelected",k.a.OnFavoritePersonaSelectedAction)(Object(b.select)({favoritesPersonaNodes:function(){return h.favoritesStore.favoritesPersonaNodes}})(function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,o,i,a,c;return r.__generator(this,function(r){switch(r.label){case 0:if((n=t.favoritesPersonaNodes.get(e)).isSyncUpdateDone)return[2];r.label=1;case 1:return r.trys.push([1,6,,7]),[4,D(n.id)];case 2:return(o=r.sent())&&H(n.id),[4,Object(G.a)(n,"OnClick",o)];case 3:return(i=r.sent())&&setTimeout(function(){Object(V.b)(n.id)},V.a),o||i?[4,Object(h.updateFavoritesUserOption)()]:[3,5];case 4:r.sent(),r.label=5;case 5:return[3,7];case 6:return a=r.sent(),c="UpdatePersonaAndSearchFolderFailure",x.c.warn(c+": "+a),Object(M.o)(c,[a.toString()]),[3,7];case 7:return[2]}})})})),z=Object(i.b)("onFavoritePersonaUpdated",k.a.OnFavoritePersonaUpdatedAction)(function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,o;return r.__generator(this,function(r){switch(r.label){case 0:return t=Object(h.getStore)().favoritesPersonaNodes.get(e),[4,D(t.id)];case 1:return n=r.sent(),[4,Object(G.a)(t,"OnFavoriteUpdate",n)];case 2:return o=r.sent(),n||o?[4,Object(h.updateFavoritesUserOption)()]:[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}})})}),Q=n(792);function W(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,o,i;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e.markedForDeletion?[4,Object(Q.c)([e.searchFolderId],!0)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[3,4];case 3:return t=r.sent(),n=k.a.DeleteFolderFailure,o=n.name,i=n.customData,x.c.warn(o+": "+t),Object(M.o)(o,i(t.toString())),[3,4];case 4:return[2]}})})}var X=n(1515),K=Object(i.b)("removeFavoritePersona",k.a.RemoveFavoritePersonaAction)(function(e,t){return r.__awaiter(this,void 0,void 0,function(){var t,n,o,i,a,c,u,s,d,l,f,b,p;return r.__generator(this,function(m){switch(m.label){case 0:t=Object(h.getStore)(),n=t.favoritesPersonaNodes.get(e),o=void 0,i=!1,m.label=1;case 1:if(m.trys.push([1,9,,10]),!n)throw new Error("RemoveFavoritePersona - NodeId could not be found in the store");if(o=n.mainEmailAddress||n.personaId||n.id,Object(X.a)(o))throw new Error("RemoveFavoritePersona - Favoriting is already in progress");return g.a(o),i=!0,(a=t.orderedFavoritesNodeIds.indexOf(e))>-1&&t.orderedFavoritesNodeIds.splice(a,1),t.favoritesPersonaNodes.delete(e),[4,Object(h.updateFavoritesUserOption)()];case 2:m.sent(),c=n.searchFolderId,m.label=3;case 3:return m.trys.push([3,7,,8]),c?(u=Object(U.c)()).id!==e?[3,4]:(u.markedForDeletion=!0,[3,6]):[3,6];case 4:return[4,Object(Q.c)([c],!0)];case 5:m.sent(),m.label=6;case 6:return[3,8];case 7:return s=m.sent(),d=k.a.DeleteFolderFailure,b=d.name,l=d.customData,x.c.warn(b+": "+s),Object(M.o)(b,l(s.toString())),[3,8];case 8:return g.b(o),[3,10];case 9:throw f=m.sent(),i&&g.b(o),b="RemoveFavoritePersonaFailure",x.c.warn(b+": "+f),p=t.favoritesPersonaNodes.size,Object(M.o)(b,[f.toString(),e,p.toString()]),n&&!t.favoritesPersonaNodes.has(n.id)&&(t.orderedFavoritesNodeIds.push(n.id),t.favoritesPersonaNodes.set(n.id,n)),r.__assign({type:"RemoveFavoritePersonaError"},f);case 10:return[2]}})})});function Y(e,t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(n){switch(n.label){case 0:return Object(a.d)("tri-favorites-roaming")?[4,h.lazyRemoveFavoritePersonaV2.import()]:[3,2];case 1:return n.sent()(e,t),[3,4];case 2:return[4,K(e,t)];case 3:return[2,n.sent()];case 4:return[2]}})})}var J=Object(i.b)("RemoveFavoriteSearch",k.a.RemoveFavoriteSearch)(function(e,t){var n=Object(h.getStore)();if(!n.favoriteSearches.has(e))throw new Error("Cannot find the search query in favorite search list.");n.orderedFavoritesNodeIds.splice(n.orderedFavoritesNodeIds.indexOf(e),1),n.favoriteSearches.delete(e),Object(h.updateFavoritesUserOption)()}),Z=n(139),$=n.n(Z),ee=n(91),te=n.n(ee),ne=n(9),re=n(155),oe=Object(b.action)("toggleFavoritesTreeExpansion")(function(){var e=Object(ne.a)().UserOptions;e.IsFavoritesFolderTreeCollapsed=!e.IsFavoritesFolderTreeCollapsed,Object(re.a)("OWA.UserOptions",[$()({DictionaryKey:te()({Type:"String",Value:["IsFavoritesFolderTreeCollapsed"]}),DictionaryValue:te()({Type:"Boolean",Value:[String(e.IsFavoritesFolderTreeCollapsed)]})})])});n.d(t,"addFavoriteFolder",function(){return d}),n.d(t,"removeFavoriteFolder",function(){return m}),n.d(t,"markFavoritePersonaNodeAsAdded",function(){return P}),n.d(t,"onFavoritePersonaSelected",function(){return q}),n.d(t,"onFavoritePersonaUpdated",function(){return z}),n.d(t,"onSelectedPersonaNodeChanged",function(){return W}),n.d(t,"removeFavoritePersona",function(){return Y}),n.d(t,"handleToggleFavoritePersonaError",function(){return y}),n.d(t,"removeFavoriteSearch",function(){return J}),n.d(t,"toggleFavoritesTreeExpansion",function(){return oe})},1174:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindItemRequest:#Exchange"},e)}},1175:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(1702);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("FindItem",e,t)}},1180:function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c});var r=n(511);function o(e){return e&&0===e.indexOf(r.f)}function i(e){return e&&0===e.indexOf(r.e)&&!o(e)}function a(e){return e&&0===e.indexOf(r.e)}function c(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},1279:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("MARK_CONVERSATIONS_AS_READ_STORE_UPDATE",function(e,t,n,r){return{conversationIds:e,tableViewId:t,isReadValue:n,isExplicit:r}})},1280:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("MARK_ITEMS_AS_READ_STORE_UPDATE",function(e,t,n,r){return{itemIds:e,isReadValue:t,isExplicit:n,tableViewId:r}})},1310:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(5);function o(e){return Object(r.d)("rp-smime")&&e&&e.AttachmentId&&i(e.AttachmentId.Id)}function i(e){return e&&-1!==e.indexOf("smime-")}},1314:function(e,t,n){"use strict";var r=n(1),o=n(45),i=n(21),a=n(8),c=Object(r.createStore)("mailboxInfoStore",new a.ObservableMap),u=n(9);function s(e){if(!e)return Object(o.e)();if(!c().has(e)){var t=function(e){var t,n,r,a=Object(i.y)(),c=a&&a.get(e);c&&c.treeType===i.j?(t=c.principalSMTPAddress,n=c.principalSMTPAddress,r=Object(o.c)()+c.principalSMTPAddress):(t=Object(o.d)(),n=Object(u.a)().SessionSettings.UserEmailAddress,r=Object(o.b)());return{type:o.a.UserMailbox,deprecatedMailboxId:t,primarySmtpAddress:n,routingKey:r,returnModernConversationItems:!1,requestOptions:Object(i.t)(e)}}(e);d(e,t)}return c().get(e)}var d=Object(r.mutatorAction)("addMailboxInfoToStore",function(e,t){c().set(e,t)}),l=n(427),f=n(165),b=n(1520);function h(e){return e?p(e.tableQuery):Object(o.e)()}function p(e){var t=Object(f.b)(e),n=e&&e.folderId;return null!=t?Object(l.l)(t):m(n)}function m(e){return Object(i.M)(e)?Object(b.a)(e):s(e)}n.d(t,"a",function(){return h}),n.d(t,"c",function(){return p}),n.d(t,"b",function(){return m})},1319:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("saveSigningCertificate",function(e,t){return{smimeViewState:e,signingCertRawData:t}})},1339:function(e,t,n){"use strict";var r=n(0),o=n(1),i=n(9),a=n(66),c=n(564),u=n(5),s=Object(o.action)("POPULATE_PUBLIC_FOLDER_OUTLOOK_FAVORITE_STORE"),d=n(29),l=n(1177),f=n.n(l),b=n(108),h=n.n(b),p=n(1178),m=n.n(p),v=n(648),g=n.n(v),S=n(57),O=n.n(S),_=n(156);function I(e){return{headers:Object(_.e)(e)}}function j(e){var t=[];e.forEach(function(e){t.push(h()({Id:e}))});var n=Object(i.a)().SessionSettings.DefaultPublicFolderMailbox;return 0!==t.length&&n?f()({Header:Object(d.getJsonRequestHeader)(),Body:m()({FolderShape:g()({BaseShape:"AllProperties",AdditionalProperties:[O()({FieldURI:"ReplicaList"})]}),FolderIds:t})},I(n)).then(function(e){return e.Body.ResponseMessages}).catch(function(){return null}):null}var E=n(1167),T=n(659);Object(o.orchestrator)(a.loadFavorites,function(){return r.__awaiter(void 0,void 0,void 0,function(){var e,t,n;return r.__generator(this,function(r){switch(r.label){case 0:return Object(u.d)("tri-favorites-roaming")&&Object(u.d)("pf-favorite")?(e=[],(t=Object(i.a)().Favorites?Object(i.a)().Favorites.value:null)?(t.forEach(function(t){var n=Object(c.b)(t,"IsPublicFolder");n&&"true"===n.toLowerCase()&&e.push(Object(c.b)(t,"FolderId"))}),[4,j(e)]):[2]):[2];case 1:return(n=r.sent())&&(n.Items.forEach(function(e){e.Folders.forEach(function(e){null!=e&&Object(E.a)(T.a,e)})}),s()),[2]}})})}),Object(o.orchestrator)(s,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var e;return r.__generator(this,function(t){return(e=Object(i.a)().Favorites?Object(i.a)().Favorites.value:null)?(e.forEach(function(e){var t=Object(a.getSingleValueSettingValueForKey)(e,"IsPublicFolder");"folder"===e.Type.toLowerCase()&&t&&"true"===t.toLowerCase()&&function(e){(function(e){if(0===T.a.folderTable.size)return!1;return!a.favoritesStore.outlookFavorites.has(e.favoriteId)&&T.a.folderTable.has(e.publicFolderId)})(e)&&Object(a.addFavoriteToStoreInitial)(e)}({treeType:"favorites",favoriteId:e.Id,type:"publicFolder",displayName:e.DisplayName,publicFolderId:Object(a.getSingleValueSettingValueForKey)(e,"FolderId"),client:e.Client,lastModifiedTime:e.LastModifiedTime})}),[2]):[2]})})});var w=n(1722),C=(Object(o.mutator)(E.a,function(e){var t=e.state,n=e.item,o=n.FolderId.Id;if(!t.folderTable.has(o)){var i=n.DistinguishedFolderId?n.DistinguishedFolderId:void 0,a=r.__assign({childFolderIds:[],distinguishedFolderId:i,UnreadCount:n.UnreadCount,TotalCount:n.TotalCount,isHidden:Object(w.b)(n),sourceWellKnownFolderType:Object(w.c)(n),ReplicaList:n.ReplicaList},n);t.folderTable.set(o,a)}}),n(1488));Object(o.mutator)(C.a,function(e){var t=e.folderId;T.a.folderTable.has(t)&&T.a.folderTable.delete(t)});n.d(t,"a",function(){return I}),n.d(t,"b",function(){return T.a})},1357:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(1714);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetItem",e,t)}},1358:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetItemRequest:#Exchange"},e)}},1362:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i});var r=n(54),o=[r.b.Files,r.b.People,r.b.Keywords],i=[r.b.Files,r.b.People,r.b.Keywords,r.b.Message,r.b.Category]},1365:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindConversationRequest:#Exchange"},e)}},1366:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(1713);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("FindConversation",e,t)}},1367:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConversationRequestType:#Exchange"},e)}},1368:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetConversationItemsRequest:#Exchange"},e)}},1369:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(1019);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetConversationItems",e,t)}},1371:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(21);function o(e){return Object(r.I)(e,r.j)}},138:function(e,t,n){"use strict";var r=n(1),o=Object(r.action)("USERMAIL_INTERACTION",function(e,t){return{interactionType:e,instrumentationContexts:t}}),i=n(923),a=n(281),c=n(1455);n.d(t,"o",function(){return o}),n.d(t,"a",function(){return i.a}),n.d(t,"c",function(){return a.c}),n.d(t,"d",function(){return a.d}),n.d(t,"f",function(){return a.e}),n.d(t,"g",function(){return a.g}),n.d(t,"h",function(){return a.j}),n.d(t,"j",function(){return a.n}),n.d(t,"l",function(){return a.r}),n.d(t,"m",function(){return a.s}),n.d(t,"n",function(){return a.u}),n.d(t,"i",function(){return a.l}),n.d(t,"b",function(){return a.a}),n.d(t,"k",function(){return a.p}),n.d(t,"e",function(){return c.a})},1411:function(e,t,n){"use strict";function r(){return{selectedSearchScope:null,subjectFieldText:"",keywordsFieldText:"",fromDate:null,toDate:null,hasAttachments:null,fromPeopleSuggestions:[],toPeopleSuggestions:[]}}n.d(t,"a",function(){return r})},1452:function(e,t,n){"use strict";var r=n(0),o=n(2),i=n(338),a=n(131),c=n(801),u=n(14),s=n(333),d=n(339),l=n(435),f=n(881),b=Object(s.b)(function(e,t,n){var r=Object(d.a)(e),o=Object(l.a)(e),i={root:{minWidth:"80px",height:"32px"},label:{fontWeight:u.FontWeights.semibold}};return Object(u.concatStyleSets)(r,i,n?Object(f.a)(e):Object(f.b)(e),o,t)});n.d(t,"a",function(){return h});var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._skipComponentRefResolution=!0,t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.primary,n=void 0!==t&&t,c=e.styles,u=e.theme;return o.createElement(i.a,r.__assign({},this.props,{variantClassName:n?"ms-Button--primary":"ms-Button--default",styles:b(u,c,n),onRenderDescription:a.b}))},t=r.__decorate([Object(c.a)("DefaultButton",["theme","styles"],!0)],t)}(a.a)},1455:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a});var r=n(1),o=Object(r.action)("ON_COMPOSE_OPENED"),i=Object(r.action)("ON_COMPOSE_CLOSED"),a=Object(r.action)("NEW_MESSAGE_V3",function(e,t,n,r,o){return{actionSource:e,groupId:t,toEmailAddressWrappers:n,subject:r,body:o}})},1488:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("REMOVE_FAVORITE_FROM_PUBLIC_FOLDER_STORE",function(e){return{folderId:e}})},1495:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"StartSearchSessionJsonRequest:#Exchange"},e)}},1496:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"EndSearchSessionJsonRequest:#Exchange"},e)}},1508:function(e,t,n){var r=n(1509),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1509:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'.DqR_QI9wxI9eR6VFTBDcQ{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 30px;flex:1 1 30px;position:relative}html[dir] .DqR_QI9wxI9eR6VFTBDcQ{padding-bottom:2px}._2NkYO2Iqj_5RPVJ_u09zQT,._1Qs0_GHrFMawJzYAmLNL2x,._1Ni7eAfyUBqk15RoZliWfC{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px;font-weight:400;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;width:100%}html[dir] ._2NkYO2Iqj_5RPVJ_u09zQT,html[dir] ._1Qs0_GHrFMawJzYAmLNL2x,html[dir] ._1Ni7eAfyUBqk15RoZliWfC{background:transparent;border:0}._2NkYO2Iqj_5RPVJ_u09zQT::-ms-clear,._1Qs0_GHrFMawJzYAmLNL2x::-ms-clear,._1Ni7eAfyUBqk15RoZliWfC::-ms-clear{display:none}._1dMfnPdablqcwDvVlOI1Ai::-webkit-input-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1dMfnPdablqcwDvVlOI1Ai::-moz-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1dMfnPdablqcwDvVlOI1Ai:-ms-input-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1dMfnPdablqcwDvVlOI1Ai:-moz-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1LtnCG5oLbhQOwtufJyBi8::-webkit-input-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1LtnCG5oLbhQOwtufJyBi8::-moz-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1LtnCG5oLbhQOwtufJyBi8:-ms-input-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1LtnCG5oLbhQOwtufJyBi8:-moz-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1Qs0_GHrFMawJzYAmLNL2x{color:"[theme:black, default:#000000]";z-index:1}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0::-webkit-input-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0::-moz-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0:-ms-input-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0:-moz-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._2NkYO2Iqj_5RPVJ_u09zQT{color:"[theme:neutralSecondary, default:#666666]";position:absolute;z-index:0}',""]),t.locals={searchBoxInputContainer:"DqR_QI9wxI9eR6VFTBDcQ",ghostTextInput:"_2NkYO2Iqj_5RPVJ_u09zQT",searchBoxInput:"_1Qs0_GHrFMawJzYAmLNL2x",searchBoxInputBase:"_1Ni7eAfyUBqk15RoZliWfC",inputPlaceholder:"_1dMfnPdablqcwDvVlOI1Ai",inSearchinputPlaceholder:"_1LtnCG5oLbhQOwtufJyBi8",isDisabled:"_28FTnx_o_MRIbFoSOl9_0"}},1510:function(e,t,n){var r=n(1511),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1511:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'._33tO85F3n_fu7qMMmS4oN3{color:inherit;font:inherit;cursor:pointer;outline:inherit;color:"[theme:headerSearchButtonIcon, default:#FFFFFF]";-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-size:16px;height:100%;width:32px}html[dir] ._33tO85F3n_fu7qMMmS4oN3{background:none;border:none;padding-bottom:0;padding-top:0;background:"[theme:headerSearchButtonBackground, default:#0078D4]"}._33tO85F3n_fu7qMMmS4oN3:hover{color:"[theme:white, default:#ffffff]"}html[dir] ._33tO85F3n_fu7qMMmS4oN3:hover{background:"[theme:headerSearchButtonBackgroundHover, default:#004578]"}._2s2g07d_g4rYONa6EUffoe{font-size:16px;min-width:32px;width:32px;color:"[theme:neutralDark, default:#212121]"}html[dir] ._2s2g07d_g4rYONa6EUffoe{padding:0;border-style:none;background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._2s2g07d_g4rYONa6EUffoe:hover{background-color:"[theme:neutralLight, default:#eaeaea]"}html[dir] ._2s2g07d_g4rYONa6EUffoe:active{background-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._2gHlig06CLXTog_sHdBjxU{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-sizing:border-box;box-sizing:border-box;height:16px;width:16px;color:"[theme:neutralDark, default:#212121]"}html[dir] ._2gHlig06CLXTog_sHdBjxU{border-radius:50%;padding:3px;background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir=ltr] ._2gHlig06CLXTog_sHdBjxU{margin-right:16px}html[dir=rtl] ._2gHlig06CLXTog_sHdBjxU{margin-left:16px}html[dir] ._2gHlig06CLXTog_sHdBjxU:hover{background-color:"[theme:neutralLight, default:#eaeaea]"}html[dir] ._2gHlig06CLXTog_sHdBjxU:active{background-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._12DoG-LvHF0uq_P3mCl9l1{color:"[theme:themePrimary, default:#0078D4]";-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-size:16px;height:100%;width:44px}html[dir] ._12DoG-LvHF0uq_P3mCl9l1{background-color:transparent}._12DoG-LvHF0uq_P3mCl9l1:hover{color:"[theme:themeDarker, default:#004578]"}._3WHacxy3jm55FX7LXtoTbT,._3OXD24zi--NRNzhEiiUbDf,._1pJKwDVgnVvtTYbSPBYHUf{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:"[theme:headerSearchBoxIcon, default:#004578]";-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-size:16px;height:100%;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px}._2ItmDfaS1i9SxH_w5mCuKy._3OXD24zi--NRNzhEiiUbDf,._2ItmDfaS1i9SxH_w5mCuKy._1pJKwDVgnVvtTYbSPBYHUf,._3WHacxy3jm55FX7LXtoTbT._2ItmDfaS1i9SxH_w5mCuKy{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1pJKwDVgnVvtTYbSPBYHUf{color:"[theme:themeDarker, default:#004578]"}._3OXD24zi--NRNzhEiiUbDf{color:"[theme:neutralDark, default:#212121]"}._1IASxdr5glbGM5ZXvqT4EN{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-item-align:center;align-self:center;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;height:32px;width:100%}html[dir] ._1IASxdr5glbGM5ZXvqT4EN{border-radius:2px}@media screen and (-ms-high-contrast:active){html[dir] ._1IASxdr5glbGM5ZXvqT4EN{border:1px solid "[theme:neutralLight, default:#eaeaea]"}}html[dir] ._5qNpXCd-7jY8_77B7v2Nm ._3pB3B8SOyfUABGIvVa4Yof{background:"[theme:white, default:#ffffff]"}._3pB3B8SOyfUABGIvVa4Yof{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;height:100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}html[dir] ._3pB3B8SOyfUABGIvVa4Yof{background:"[theme:headerSearchBoxBackground, default:rgba(255,255,255,.7)]"}html[dir] ._3pB3B8SOyfUABGIvVa4Yof._2ItmDfaS1i9SxH_w5mCuKy{background:"[theme:neutralLight, default:#eaeaea]"}._5j-xjOS68WJ1zbIJWTFG7{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;-ms-flex-pack:distribute;justify-content:space-around}html[dir=ltr] ._5j-xjOS68WJ1zbIJWTFG7{margin-right:12px}html[dir=rtl] ._5j-xjOS68WJ1zbIJWTFG7{margin-left:12px}',""]),t.locals={searchButton:"_33tO85F3n_fu7qMMmS4oN3",searchBoxButton:"_2s2g07d_g4rYONa6EUffoe",clearBoxButton:"_2gHlig06CLXTog_sHdBjxU",backButton:"_12DoG-LvHF0uq_P3mCl9l1",searchIcon:"_3WHacxy3jm55FX7LXtoTbT",searchIconFocused:"_3OXD24zi--NRNzhEiiUbDf",searchIconRest:"_1pJKwDVgnVvtTYbSPBYHUf",isDisabled:"_2ItmDfaS1i9SxH_w5mCuKy",searchBoxContainer:"_1IASxdr5glbGM5ZXvqT4EN",searchBoxContainerInSearch:"_5qNpXCd-7jY8_77B7v2Nm",searchBox:"_3pB3B8SOyfUABGIvVa4Yof",searchQueryContainer:"_5j-xjOS68WJ1zbIJWTFG7"}},1520:function(e,t,n){"use strict";var r=n(13),o=n(21);function i(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(o.M)(e.tableQuery.folderId)}function a(){var e=Object(r.C)();return e&&0==e.tableQuery.type&&Object(o.M)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var c=n(1),u=n(1339),s=n(9),d=n(8),l=Object(c.createStore)("publicFolderUtilsStore",new d.ObservableMap);function f(e){if(!l().has(e)){var t=u.b.folderTable.get(e),n={type:null,deprecatedMailboxId:e,primarySmtpAddress:t.principalSMTPAddress,routingKey:"AAD-SMTP:"+t.principalSMTPAddress,returnModernConversationItems:null,requestOptions:Object(u.a)(null!=t.ReplicaList?t.ReplicaList[0]:Object(s.a)().SessionSettings.DefaultPublicFolderMailbox)};b(e,n)}return l().get(e)}var b=Object(c.mutatorAction)("addPublicFolderMailboxInfoToStore",function(e,t){l().set(e,t)});n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return f})},1533:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SeekToConditionPageView:#Exchange"},e)}},1596:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1),o=Object(r.action)("REFRESH_SHARING_TIPS_FOR_ATTACHMENT",function(e){return{attachmentId:e}})},163:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Mail=1]="Mail",e[e.Calendar=2]="Calendar",e[e.FilesHub=3]="FilesHub",e[e.FilesPicker=4]="FilesPicker"}(r||(r={})),t.b=r},1644:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(776),o=n(5),i=n(336),a=n(27);function c(){var e=Object(r.c)().staticSearchScope,t=e&&e.kind;return Object(a.f)().SessionSettings.IsExplicitLogon?"ArchiveMailbox"===t?2:Object(i.a)("sea-explicitLogon3S")?0:1:"PrimaryMailbox"===t?Object(i.a)("sea-substrateQuery")?0:1:"ArchiveMailbox"===t?Object(i.a)("sea-substrateQuery")&&Object(o.d)("sea-archive-mailbox-3S")?0:1:"Group"===t?1:"SharedFolders"===t?2:null}},165:function(e,t,n){"use strict";var r=n(3),o=n(13);function i(){return a(Object(o.C)())}function a(e){return e&&2==e.tableQuery.type?e.tableQuery.folderId:null}function c(){var e=Object(o.C)();return e&&2==e.tableQuery.type}function u(e){return!!e&&(2==e.type||s(e))}function s(e){return!(!e||1!=e.type)&&"Group"==e.searchScope.kind}function d(e){return 2==e.type?e.folderId:s(e)?e.searchScope.groupId:null}function l(){var e=Object(o.C)();return e&&u(e.tableQuery)}n.d(t,"g",function(){return b}),n.d(t,"h",function(){return h}),n.d(t,"m",function(){return p}),n.d(t,"l",function(){return m}),n.d(t,"j",function(){return v}),n.d(t,"i",function(){return g}),n.d(t,"k",function(){return S}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"d",function(){return c}),n.d(t,"e",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"f",function(){return l});var f=new r.c(function(){return Promise.all([n.e(0),n.e(1),n.e(502),n.e(26),n.e(310)]).then(n.bind(null,11844))}),b=new r.b(f,function(e){return e.getGroupDisplayName}),h=new r.b(f,function(e){return e.getGroupDisplayNameFromTableView}),p=new r.b(f,function(e){return e.isPrivateUnjoinedGroup}),m=new r.b(f,function(e){return e.isJoinedGroup}),v=new r.b(f,function(e){return e.getRetentionPolicyTagsForGroup}),g=new r.b(f,function(e){return e.getRetentionPolicyTagListForGroupTableQuery}),S=new r.b(f,function(e){return e.isGroupOwner})},1702:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindItemJsonRequest:#Exchange"},e)}},1713:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindConversationJsonRequest:#Exchange"},e)}},1714:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetItemJsonRequest:#Exchange"},e)}},1716:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAttachmentPreviewsRequest:#Exchange"},e)}},172:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return a}),n.d(t,"e",function(){return c}),n.d(t,"g",function(){return u}),n.d(t,"k",function(){return s}),n.d(t,"l",function(){return d}),n.d(t,"m",function(){return l}),n.d(t,"n",function(){return f}),n.d(t,"o",function(){return b}),n.d(t,"j",function(){return h}),n.d(t,"f",function(){return p}),n.d(t,"i",function(){return m}),n.d(t,"h",function(){return v});var r="Click",o=356,i=928,a=String.fromCharCode(57345),c=new RegExp(a,"g"),u=String.fromCharCode(160),s=/\s/g,d=String.fromCharCode(57344),l=new RegExp(d,"g"),f="searchSuggestionsCallout",b="searchSuggestion-",h=38,p=52,m="searchBoxId",v="searchBoxAnchorId"},1722:function(e,t,n){"use strict";var r=function(e,t){if(e.ExtendedProperty)for(var n=0;n<e.ExtendedProperty.length;n++){var r=e.ExtendedProperty[n];if(r.ExtendedFieldURI.PropertyTag===t||r.ExtendedFieldURI.PropertyName===t)return JSON.parse(r.Value)}},o=function(e){return r(e,"0x10f4")},i=function(e){return parseInt(r(e,"SourceWellKnownFolderType"),10)};n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return i})},1744:function(e){e.exports={a:"_Ta",b:"$Ta"}},185:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(8),o=n(1),i=function(){return{alteredQuery:"",currentSearchQueryId:null,currentSuggestions:null,displayedQFRequestTime:null,flaggedTokens:[],ghostText:"",isLastKeyPressedDeletion:!1,isSuggestionsCalloutClickable:!1,isSuggestionsDropdownVisible:!1,isUsing3S:null,latestQFRequestId:null,latestRenderedQFTraceId:null,latestQFTraceId:null,latestTraceId:null,nextSearchQueryId:null,recourseQuery:"",searchBoxHasFocus:!1,searchBoxWidth:null,searchSessionGuid:null,searchText:"",searchTextForSuggestion:"",selectedPillIndex:-1,selectedSuggestionIndex:-1,showRefiners:!1,suggestedSearchTerm:"",suggestedSearchTermReferenceId:"",suggestionPillIds:[],suggestionPills:new r.ObservableMap,suggestionSegments:new r.ObservableMap,queryAlterationType:null,queryActionSource:null}},a={scenarioStores:new r.ObservableMap},c=Object(o.createStore)("commonSearchStore",a);t.b=c},1903:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.request/i)}n.d(t,"a",function(){return r})},1905:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.canceled/i)}n.d(t,"a",function(){return r})},1907:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(7),o="deleteMeetingMessage";t.b=Object(r.action)(o)(function(e,t){})},1910:function(e,t,n){"use strict";function r(e){return e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}n.d(t,"a",function(){return r})},1963:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(1716);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetAttachmentPreviews",e,t)}},1995:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(2342);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetFolderChangeDigest",e,t)}},224:function(e,t,n){"use strict";var r;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(r||(r={})),t.a=r},230:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ItemId:#Exchange"},e)}},2325:function(e,t){e.exports=function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}},234:function(e,t,n){"use strict";var r=n(3),o=n(24),i=n(48),a=n(1362),c=n(776),u=n(743);function s(e){var t=e.tableQuery;return 0===t.type?t.folderId:function(e){if(1!=e.type)return!1;var t=e.searchScope;return["PrimaryMailbox","ArchiveMailbox","SharedFolders"].indexOf(t.kind)>-1}(t)?t.searchScope.folderId:null}var d=n(1644);n.d(t,"b",function(){return f}),n.d(t,"c",function(){return b}),n.d(t,"k",function(){return h}),n.d(t,"l",function(){return m}),n.d(t,"i",function(){return v}),n.d(t,"j",function(){return g}),n.d(t,"h",function(){return S}),n.d(t,"a",function(){return a.b}),n.d(t,"o",function(){return c.a}),n.d(t,"g",function(){return c.c}),n.d(t,"d",function(){return u.a}),n.d(t,"m",function(){return u.b}),n.d(t,"n",function(){return u.c}),n.d(t,"p",function(){return u.d}),n.d(t,"q",function(){return u.e}),n.d(t,"r",function(){return u.f}),n.d(t,"e",function(){return s}),n.d(t,"f",function(){return d.a});var l=new r.c(function(){return Promise.all([n.e(3),n.e(2),n.e(5),n.e(4),n.e(288)]).then(n.bind(null,11663))}),f=Object(r.d)(l,function(e){return e.SearchHeaderFirstRowContent}),b=Object(r.d)(l,function(e){return e.SearchRefiners}),h=new r.b(l,function(e){return e.setStaticSearchScopeData}),p=new r.b(l,function(e){return e.registerSearchStoreOrchestrators}),m=new r.b(l,function(e){return e.startSearchWithCategory}),v=(new r.b(l,function(e){return e.initializeLivePersonaCard}),new r.b(l,function(e){return e.personaControlStore}),new r.b(l,function(e){return e.createFallbackPersonaSearchTableQuery})),g=new r.b(l,function(e){return e.createFallbackPrivateDistributionListSearchTableQuery}),S=new r.b(l,function(e){return e.createFallbackCategorySearchTableQuery});Object(r.f)(i.s,l,function(e){return e.getSuggestionsOrchestrator}),Object(r.f)(i.Q,l,function(e){return e.searchSessionStartedOrchestrator}),Object(o.b)(function(){p.import()})},2342:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetFolderChangeDigestRequest:#Exchange"},e)}},238:function(e,t,n){"use strict";var r=n(1314),o=n(13);function i(){return Object(r.a)(Object(o.C)())}n.d(t,"b",function(){return r.a}),n.d(t,"c",function(){return r.c}),n.d(t,"a",function(){return i})},246:function(e,t,n){"use strict";var r=n(0),o=n(31),i=n(617),a=n(7),c=n(1140),u=Object(a.action)("deleteConversationItemParts")(Object(a.select)({conversations:function(){return o.H.conversations},conversationNodes:function(){return o.H.conversationNodes},items:function(){return o.H.items}})(function(e,t){var n,o,a,u;if(t.conversations.has(e)){var s=t.conversations.get(e);try{for(var d=r.__values(s.conversationNodeIds),l=d.next();!l.done;l=d.next()){var f=l.value,b=t.conversationNodes.get(f);try{for(var h=(a=void 0,r.__values(b.itemIds)),p=h.next();!p.done;p=h.next()){var m=p.value;Object(i.a)(m,1)}}catch(e){a={error:e}}finally{try{p&&!p.done&&(u=h.return)&&u.call(h)}finally{if(a)throw a.error}}t.conversationNodes.delete(f)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=d.return)&&o.call(d)}finally{if(n)throw n.error}}t.conversations.delete(e)}Object(c.a)()})),s=n(24),d=function(e,t){var n=e,r=t;n.ToRecipients=r.ToRecipients,n.CcRecipients=r.CcRecipients,n.BccRecipients=r.BccRecipients};function l(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,i;return r.__generator(this,function(r){switch(r.label){case 0:return(t=Object(o.k)()).MaximumRecipientsToReturn=0,[4,Object(o.r)([e.ItemId.Id],t,"ItemPart")];case 1:return n=r.sent(),Object(o.g)(n[0])&&(i=n[0],d(e,i.Items[0])),[2]}})})}d=Object(a.action)("updateItemRecipients")(d);var f=Object(a.action)("setIsPendingDeleteConversationItemParts")(Object(a.select)({conversationItemParts:function(e){return o.H.conversations.get(e)}})(function(e,t,n){var r=n.conversationItemParts;r&&(r.isPendingDelete=t)})),b=n(18),h=n(813),p=Object(a.action)("getItemTailoredXpData")(Object(a.select)({items:function(){return o.H.items}})(function(e,t){var n=e.ItemId.Id,r=e.TailoredXpEntitiesChangeNumber;if(r&&r>0){var i=t.items.get(n),c=i&&i.TailoredXpEntitiesChangeNumber?i.TailoredXpEntitiesChangeNumber:0;if((!i||c<r)&&!e.TailoredXpEntities){var u=new b.a("RPPerfGetTailoredXpData"),s=Object(h.a)("TXPLoadMail");Object(o.G)(n).then(Object(a.action)("updateTailoredXpEntities")(function(e){var r=t.items.get(n);r&&(r.TailoredXpEntities=e.TailoredXpEntities,r.TailoredXpCalendarEventIds=e.TailoredXpCalendarEventIds,r.TailoredXpEntitiesStatus=e.TailoredXpEntitiesStatus,r.EntityNamesMap=e.EntityNamesMap),u.end(),s.end()})).catch(function(e){u.endWithError("ServerError",e),s.endWithError("ServerError",e)})}}})),m=Object(a.action)("getConversationTailoredXpData")(Object(a.select)({items:function(){return o.H.items}})(function(e,t,n){Object(o.m)(e,t).Items.forEach(function(e){p(e,n)})}));function v(e,t){return{conversationId:e,conversationNodeIds:[],conversationSortOrder:t,canLoadMore:!1,isLoadMoreInProgress:!1,maxItemsToReturn:G,loadingState:{isLoading:!1},syncState:"",isPendingDelete:!1,pendingRequestState:null,canDelete:null,subjectTranslationData:{isShowingTranslation:!1}}}var g=function(e,t){Object.keys(t).forEach(function(n){e[n]||(e[n]=t[n])})},S=[{name:"ItemClass",shouldInitializeUndefinedToNull:!1},{name:"LastModifiedTime",shouldInitializeUndefinedToNull:!1},{name:"DateTimeReceived",shouldInitializeUndefinedToNull:!1},{name:"ParentFolderId",shouldInitializeUndefinedToNull:!1},{name:"SystemCategories",shouldInitializeUndefinedToNull:!1},{name:"Hashtags",shouldInitializeUndefinedToNull:!1},{name:"PredictedActionReasons",shouldInitializeUndefinedToNull:!1},{name:"Flag",shouldInitializeUndefinedToNull:!1},{name:"IsRead",shouldInitializeUndefinedToNull:!1},{name:"Size",shouldInitializeUndefinedToNull:!1},{name:"IsClutter",shouldInitializeUndefinedToNull:!1},{name:"IconIndex",shouldInitializeUndefinedToNull:!1},{name:"Categories",shouldInitializeUndefinedToNull:!0},{name:"Likers",shouldInitializeUndefinedToNull:!0},{name:"LikeCount",shouldInitializeUndefinedToNull:!0},{name:"AdjacentMeetings",shouldInitializeUndefinedToNull:!0},{name:"ConflictingMeetings",shouldInitializeUndefinedToNull:!0}],O=function(e){S.forEach(function(t){t.shouldInitializeUndefinedToNull&&void 0===e[t.name]&&(e[t.name]=null)})},_=n(12),I=n(106),j="ChronologicalNewestOnBottom",E="PLACEHOLDER_NODE_INTERNET_MESSAGE_ID",T=function(e){return e.InternetMessageId},w=function(e){return e.ItemId.Id};function C(e,t,n){var o=function(e,t){var n=[];return e.forEach(function(e){n.push(t(e))}),n}(t,n);if(function(e,t){if(e.length!=t.length)return!0;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!0;return!1}(e,o)){var i=function(e,t){var n=[];return e.forEach(function(e){t.indexOf(e)<0&&n.push(e)}),n}(e,o),a=e.length;return e.splice.apply(e,r.__spread([0,a],o)),[!0,i]}return[!1,[]]}function y(e,t){Object(i.a)(e,1)}function x(e,t,n,i,a,c){!function(e,t,n,i,a){if(e.length>0){var c=a==j,u=c?e.length-1:0,s=n.get(e[u]);if(s.localLieState==o.e.Pending){var d=!0,l=function(e,t){return t.internetMessageId==E?t.itemIds&&t.itemIds.length>0?function(e,t){var n,o,i,a;try{for(var c=r.__values(e),u=c.next();!u.done;u=c.next()){var s=u.value;try{for(var d=(i=void 0,r.__values(s.Items)),l=d.next();!l.done;l=d.next()){var f=l.value;if(f.ItemId.Id==t)return s}}catch(e){i={error:e}}finally{try{l&&!l.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}return null}(e,t.itemIds[0]):null:function(e,t){var n,o;try{for(var i=r.__values(e),a=i.next();!a.done;a=i.next()){var c=a.value;if(T(c)==t)return c}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return null}(e,t.internetMessageId)}(t,s);l&&(l.Items[0].IsDraft?t.splice(t.indexOf(l),1):(d=!1,function(e,t){e.localLieState=o.e.Complete,e.hasQuotedText=t.HasQuotedText,e.isQuotedTextChanged=t.IsQuotedTextChanged,e.quotedTextList=t.QuotedTextList}(s,l),function(e,t){var n=t.get(e.itemIds[0]);n&&delete n.localLieSentTime}(s,i))),d&&(l={InternetMessageId:s.internetMessageId,Items:[i.get(s.itemIds[0])]},c?t.push(l):t.unshift(l))}}}(e,t,n,i,a);var u=C(e,t,T)[1],s={added:[],removed:[],modified:[]},d={isReadChangedToUnread:[]};return t.forEach(function(e){var t,a=T(e),u=n.get(a);u?(e.ParentInternetMessageId&&(u.parentInternetMessageId=e.ParentInternetMessageId),e.QuotedTextList&&(u.quotedTextList=e.QuotedTextList),e.QuotedTextState&&(u.quotedTextState=e.QuotedTextState),e.HasQuotedText&&(u.hasQuotedText=!0),e.IsQuotedTextChanged&&(u.isQuotedTextChanged=!0),t=u):(n.set(a,{conversationId:c.Id,internetMessageId:a,itemIds:[],quotedTextList:e.QuotedTextList,hasQuotedText:e.HasQuotedText,isQuotedTextChanged:e.IsQuotedTextChanged,quotedTextState:e.QuotedTextState,localLieState:o.e.None,parentInternetMessageId:e.ParentInternetMessageId}),t=n.get(a),s.added.push(a));var l=t.itemIds,f=r.__read(C(l,e.Items,w),2),b=f[0],h=f[1];u&&b&&s.modified.push(a),u&&!b&&function(e,t,n,o){var i,a;try{for(var c=r.__values(t),u=c.next();!u.done;u=c.next()){var s=u.value,d=n.get(s.ItemId.Id);d&&d.IsRead&&!s.IsRead&&o.isReadChangedToUnread.push(e)}}catch(e){i={error:e}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}}(a,e.Items,i,d),function(e,t,n,o,i){t.forEach(function(t){var n=t.ItemId.Id,a=o.get(n);O(t),t.ContainsOnlyMandatoryProperties?a?S.forEach(function(e){void 0!==t[e.name]&&(a[e.name]=t[e.name])}):e.splice(e.indexOf(n),1):(a&&g(t,a),o.set(n,r.__assign({TranslationData:{isShowingTranslation:!1,isTranslatable:!1,isTranslating:!1,shouldGetFeedback:!1,isShowingForwardContentTranslation:!1,isForwardContentTranslatable:!1,manuallyTranslated:!1,userLanguage:null}},t,{MailboxInfo:i,SmartReplyData:null,SmartTimeData:null,SmartTaskData:null,SmartTimeExtendedProperty:null,AttachmentSuggestions:null,ContextualAttachmentSuggestions:null,smartPillFeedbackSubmitted:!1,adaptiveCardDetails:null,YammerThreadId:null,itemCLPInfo:null})))}),n.forEach(function(e){y(e)})}(l,e.Items,h,i,c.mailboxInfo)}),u.forEach(function(e){!function(e,t,n){t.get(e).itemIds.forEach(function(e){y(e)}),t.delete(e)}(e,n),s.removed.push(e)}),[s,d]}var A=Object(a.action)("parseConversationResponse")(Object(a.select)({conversations:function(){return o.h},conversationNodes:function(){return o.H.conversationNodes},items:function(){return o.H.items}})(function(e,t,n,o){var i=n.Id,a=o.conversations.get(i);a||(a=v(n,t)),o.conversations.add(i,a),a=o.conversations.get(i);var c,u=!(e&&"Success"==e.ResponseClass);if(void 0===a.loadingState.hasLoadFailed&&(a.loadingState.hasLoadFailed=u),a.loadingState.hasLoadFailed&&Object(I.raiseAction)("conversationReadyToLoadStitch")(i),!u){var s=e.Conversation;if(!s.ConversationNodes)return _.c.warn("GCI response has no ConversationNodes, but TotalConversationNodesCount is "+s.TotalConversationNodesCount),a.loadingState.hasLoadFailed=!0,void Object(I.raiseAction)("conversationReadyToLoadStitch")(i);if(s.ConversationNodes.length==s.TotalConversationNodesCount)a.syncState=s.SyncState;else{var d=s.ConversationNodes.length,l=s.TotalConversationNodesCount;_.c.warn("Count of conversationNodes ("+d+") returned from GetConversationItems doesn't match TotalConversationNodesCount ("+l+")")}a.canLoadMore=s.RemainingConversationNodesCount>0||a.maxItemsToReturn<U&&s.ConversationNodes&&!(s.ConversationNodes.length<a.maxItemsToReturn),a.isLoadMoreInProgress=!1,a.canDelete=s.CanDelete||null,function(e,t,n,r){for(var o={},i=t.length,a=n==j,c=a?0:i-1,u=a?1:-1,s=function(){var n=t[c],i=e.get(n.InternetMessageId);i&&i.conversationId!=r.Id||o[n.InternetMessageId]?(n.InternetMessageId+=n.Items[0].ItemId.Id,n.Items.forEach(function(e){return e.InternetMessageId=n.InternetMessageId})):o[n.InternetMessageId]=!0,c+=u};c>=0&&c<i;)s()}(o.conversationNodes,s.ConversationNodes,t,n),m(s.ConversationNodes,t);var f=r.__read(x(a.conversationNodeIds,s.ConversationNodes,o.conversationNodes,o.items,t,n),2),b=f[0],h=f[1];((c=b).added.length>0||c.removed.length>0||c.modified.length>0)&&Object(I.raiseAction)("conversationReadyToLoadStitch")(i,b),function(e){return e.isReadChangedToUnread.length>0}(h)&&Object(I.raiseAction)("updateItemMandatoryPropertiesStitchAction")(i,h)}})),P=n(57),R=n.n(P);var N=n(56),F=n(5);function M(e){Object(N.a)()&&Object(F.d)("rp-amp")&&function(e,t){var n;e&&t&&(e.AdditionalProperties||(e.AdditionalProperties=[]),(n=e.AdditionalProperties).push.apply(n,r.__spread(t)))}(e,[R()({FieldURI:"AmpHtmlBody"})])}function k(e){return e&&"Success"!=e.ResponseClass?[e.ResponseCode,e.StackTrace]:[null,null]}function D(e){return["PrefetchFirstN","PrefetchSingleRow","PrefetchRowInCache","PrefetchAdjacentRowsOnDelay"].includes(e)}var L=n(9),B=n(210),G=20,U=100,H={};var V=Object(a.action)("processGetConversationItemsResponse")(function(e,t,n,r){A(n,e,t);var o=r.get(t.Id);o.loadingState.isLoading=!1,delete H[t.Id],o.pendingRequestState&&q(t,o.pendingRequestState.actionSource)}),q=Object(a.action)("loadConversation")(Object(a.select)({conversations:function(){return o.h}})(function(e,t,n,i){var a,c=Promise.resolve(),s=Object(L.a)().UserOptions.ConversationSortOrderReact,d=e.Id,l=i.conversations.get(d);if(l&&l.conversationSortOrder!=s&&(u(d),l=null),l&&!l.loadingState.hasLoadFailed||(l=v(e,s)),i.conversations.add(d,l),function(e,t){e.pendingRequestState?e.pendingRequestState.shouldUseEmptySyncState=e.pendingRequestState.shouldUseEmptySyncState||!e.syncState:e.pendingRequestState={shouldUseEmptySyncState:!e.syncState},e.pendingRequestState.actionSource=t}(l=i.conversations.get(d),t),n&&(a=n.addCheckmark("request_start")),l.loadingState.isLoading&&(D(t)||H[d]))H[d]&&(c=H[d],n&&n.addCustomData({pendingRequest:!0}));else{var f=l.pendingRequestState.shouldUseEmptySyncState;l.loadingState.isLoading=!0,l.pendingRequestState=null;var b=l.conversationId.mailboxInfo,h=b.returnModernConversationItems,p={};if(B(p,b&&b.requestOptions),p&&p.headers){var m=new Headers(p.headers);m.set("X-OWA-ActionSource",t),p.headers=m}var g=Object(o.n)();M(g),c=Object(o.o)(l.conversationId,g,l.syncState,l.maxItemsToReturn,s,f,h,Object(F.d)("rp-collapsedItemsRollUp")?"ReturnRootNode":"Default",p).then(function(t){if(n){var o=n.addCheckmark("request_end");n.addCustomData({requestTime:o-a})}V(s,e,t,i.conversations);var c=r.__read(k(t),2),u=c[0],d=c[1];return u?Promise.reject(new Error("ErrorResponseCode="+u+", StackTrace="+d)):Promise.resolve()}).catch(function(n){return V(s,e,null,i.conversations),n.message+=", ActionSource="+t,D(t)?Promise.resolve():Promise.reject(n)}),D(t)||(H[d]=c)}return c})),z={DeleteConversationStoreUpdate:"deleteConversationStoreUpdate",EmptyFolderStoreUpdate:"emptyFolderStoreUpdate",DeleteFolderAction:"deleteFolderAction",ForwardMessageAction:"forwardMessageAction",LoadDraftToComposeAction:"loadDraftToComposeAction",MarkAllAsReadStoreUpdate:"markAllAsReadStoreUpdate",ReloadMailListTableAction:"reloadMailListTableAction",SingleMailItemSelectedAction:"singleMailItemSelectedAction",SendFeedbackActionName:"SendFeedbackAction"},Q=n(1015),W=n(889),X=n(1020),K=n(210),Y="X-OWA-ActionSource";var J=Object(a.action)("parseItemResponse")(function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,i,a;return r.__generator(this,function(c){switch(c.label){case 0:return(n=o.H.items.get(t.Id))&&g(e,n),O(e),i=r.__assign({Smime:null},e,{MailboxInfo:t.mailboxInfo,SmartReplyData:null,SmartTimeData:null,SmartTaskData:null,SmartTimeExtendedProperty:null,AttachmentSuggestions:null,ContextualAttachmentSuggestions:null,smartPillFeedbackSubmitted:!1,adaptiveCardDetails:null,YammerThreadId:null,itemCLPInfo:null}),o.H.items.set(t.Id,i),a=o.H.items.get(t.Id),p(a),Object(W.a)(n)?[4,Q.l.importAndExecute(a,n)]:[3,2];case 1:c.sent(),c.label=2;case 2:return[2]}})})});function Z(e,t,n,i){var a;n&&(a=n.addCheckmark("request_start"));var c={};K(c,e.mailboxInfo&&e.mailboxInfo.requestOptions);var u=c.headers?new Headers(c.headers):new Headers;i&&u.set(X.c,X.d),c&&c.headers&&u.set(Y,t),c.headers=u;var s=Object(o.k)();return M(s),Object(o.r)([e.Id],s,"ItemNormalizedBody","V2017_08_18",c).then(function(i){if(n){var c=n.addCheckmark("request_end");n.addCustomData({requestTime:c-a})}if(Object(o.g)(i[0])){var u=i[0];return J(u.Items[0],e).then(function(){return o.H.items.get(e.Id)})}switch(t){case"PrefetchFirstN":case"PrefetchSingleRow":case"PrefetchRowInCache":case"PrefetchAdjacentRowsOnDelay":break;case"LoadItemReadingPane":case"LoadItemPreviewPane":default:_.c.warn(t+": "+i[0].MessageText)}var s=r.__read(k(i[0]),2),d=s[0],l=s[1];return d?Promise.reject(new Error("ErrorResponseCode="+d+", StackTrace="+l)):Promise.resolve(null)}).catch(function(e){return e.message+=", ActionSource="+t,D(t)?Promise.resolve():Promise.reject(e)})}function $(){return window.innerWidth||document.body.clientWidth}n.d(t,"h",function(){return l}),n.d(t,"f",function(){return u}),n.d(t,"k",function(){return f}),n.d(t,"i",function(){return q}),n.d(t,"c",function(){return 10}),n.d(t,"e",function(){return z}),n.d(t,"a",function(){return"applyConverstionFlagStateStoreUpdate"}),n.d(t,"b",function(){return"conversationReadyToLoadStitch"}),n.d(t,"d",function(){return"updateItemMandatoryPropertiesStitchAction"}),n.d(t,"j",function(){return Z}),n.d(t,"g",function(){return $}),Object(s.b)(function(){o.h.initialize(o.H.conversations,function(e){u(e)})})},25:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"f",function(){return s}),n.d(t,"h",function(){return d}),n.d(t,"j",function(){return l}),n.d(t,"k",function(){return f}),n.d(t,"m",function(){return b}),n.d(t,"o",function(){return h}),n.d(t,"p",function(){return p}),n.d(t,"q",function(){return m}),n.d(t,"s",function(){return v}),n.d(t,"r",function(){return g}),n.d(t,"u",function(){return S}),n.d(t,"w",function(){return O}),n.d(t,"x",function(){return _}),n.d(t,"z",function(){return I}),n.d(t,"y",function(){return j}),n.d(t,"i",function(){return E}),n.d(t,"g",function(){return T}),n.d(t,"n",function(){return w}),n.d(t,"A",function(){return C}),n.d(t,"e",function(){return y}),n.d(t,"v",function(){return x}),n.d(t,"l",function(){return A}),n.d(t,"t",function(){return P});var r=n(1),o=n(26),i=Object(r.action)("ADD_SUGGESTION_PILL",function(e,t,n){return{suggestionPill:e,suggestionSelected:t,scenarioId:n}}),a=Object(r.action)("CHANGE_SELECTED_SUGGESTION_VIA_KEYBOARD",function(e,t,n){return{indexToSelect:e,suggestionToSelect:t,scenarioId:n}}),c=Object(r.action)("CLEAR_SEARCH_BOX",function(e){return{scenarioId:e}}),u=Object(r.action)("CLEAR_SEGMENTS",function(e){return{scenarioId:e}}),s=Object(r.action)("END_SEARCH_CONVERSATION",function(e){return{scenarioId:e}}),d=(Object(r.action)("EXECUTE_COMMAND",function(e){return{scenarioId:e}}),Object(r.action)("EXIT_SEARCH",function(e,t){return{actionSource:e,scenarioId:t}})),l=Object(r.action)("GET_SUGGESTIONS",function(e){return Object(o.a)({name:"Search_SuggestionsE2E"},{scenarioId:e})}),f=Object(r.action)("ON_SEARCH_TEXT_CHANGED",function(e,t){return{searchText:e,scenarioId:t}}),b=Object(r.action)("SEARCH_BOX_BLURRED",function(e){return{scenarioId:e}}),h=Object(r.action)("SEARCH_SESSION_STARTED",function(e,t,n){return{actionSource:e,shouldStartSearch:t,scenarioId:n}}),p=Object(r.action)("SET_CURRENT_SUGGESTIONS",function(e,t,n){return void 0===n&&(n=null),{suggestionSet:e,scenarioId:t,qfRequestId:n}}),m=Object(r.action)("SET_DISPLAYED_QF_REQUEST_TIME",function(e,t){return{displayedQFRequestTime:e,scenarioId:t}}),v=Object(r.action)("SET_LATEST_TRACE_ID",function(e,t,n){return{latestTraceId:e,scenarioId:t,isQFTraceId:n}}),g=Object(r.action)("SET_IS_SUGGESTIONS_DROPDOWN_VISIBLE",function(e,t){return{isSuggestionsDropdownVisible:e,scenarioId:t}}),S=Object(r.action)("SET_SUGGESTION_SEGMENTS",function(e,t,n){return{segments:e,suggestionSelected:t,scenarioId:n}}),O=Object(r.action)("START_SEARCH",function(e,t,n){return void 0===n&&(n=!1),{actionSource:e,scenarioId:t,explicitSearch:n}}),_=Object(r.action)("START_SEARCH_SESSION",function(e,t,n){return{actionSource:e,shouldStartSearch:t,scenarioId:n}}),I=Object(r.action)("SUGGESTION_SELECTED",function(e,t,n,r,o){return{suggestion:e,actionSource:t,scenarioId:n,suggestionSetTraceId:r,index:o}}),j=Object(r.action)("SUGGESTION_SECONDARY_ACTION_SELECTED",function(e,t,n,r,o,i){return{suggestion:e,suggestionIndex:t,actionSource:n,scenarioId:r,suggestionSetTraceId:o,entityActionTakenType:i}}),E=Object(r.action)("FEEDBACK_SUBMITTED",function(e,t,n,r){return{scenario:e,yesSelected:t,suggestionSetTraceId:n,feedbackString:r}}),T=Object(r.action)("END_SEARCH_SESSION",function(e,t){return{scenarioId:e,actionSource:t}}),w=Object(r.action)("SEARCH_SESSION_ENDED",function(e,t,n,r){return{searchSessionGuid:e,scenarioId:t,latestTraceId:n,actionSource:r}}),C=Object(r.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE",function(e,t){return{isComplete:e,scenarioId:t}}),y=Object(r.action)("DOWNLOAD_FILE_SUGGESTION",function(e,t,n){return{attachmentId:e,attachmentType:t,scenarioId:n}}),x=Object(r.action)("SHARE_FILE_SUGGESTION",function(e,t,n){return{attachmentId:e,attachmentType:t,scenarioId:n}}),A=Object(r.action)("REGISTER_ADDITIONAL_QUICK_ACTIONS",function(e,t){return{scenarioId:e,callback:t}}),P=Object(r.action)("SET_SEARCH_TEXT_FOR_SUGGESTION",function(e,t){return{searchTextForSuggestion:e,scenarioId:t}})},262:function(e,t,n){"use strict";var r=n(1070),o=n(449),i=n(1),a={viewStates:new(n(8).ObservableMap),livePersonaCardInitializationStatus:{state:r.a.NotInitialized,timestamp:Date.now()},isLivePersonaCardInitialized:!1,isPersonaCardDisabled:!1,brandList:null,brandListLoadState:o.a.unloaded},c=Object(i.createStore)("personacontrol",a)();t.a=c},266:function(e,t,n){"use strict";var r=n(47),o=(function(){}(),n(3)),i=n(24),a=n(1099),c=n(688),u=n(8),s=n(1),d=[r.a.SurfaceActions];Object(s.mutator)(a.a,function(e){var t=e.defaultOptions;d.forEach(function(e){t[e]&&Object(u.extendObservable)(Object(c.a)().options[e],t[e])})});var l=n(1075),f=n(680);n.d(t,"d",function(){return h}),n.d(t,"g",function(){return p}),n.d(t,"e",function(){return m}),n.d(t,"f",function(){return v}),n.d(t,"c",function(){return l.a}),n.d(t,"b",function(){return f.a}),n.d(t,"a",function(){return r.a});var b=new o.c(function(){return n.e(308).then(n.bind(null,11810))}),h=new o.a(b,function(e){return e.createOrUpdateOptionsForFeature}),p=new o.a(b,function(e){return e.updateAddinPinStatus}),m=new o.b(b,function(e){return e.getServerOptionsForFeature}),v=new o.a(b,function(e){return e.loadOptions});Object(i.c)(function(){v.importAndExecute()})},2796:function(e){e.exports={a:"kjb"}},2797:function(e){e.exports={a:"djb"}},281:function(e,t,n){"use strict";n.d(t,"r",function(){return a}),n.d(t,"u",function(){return c}),n.d(t,"e",function(){return u}),n.d(t,"p",function(){return s}),n.d(t,"i",function(){return d}),n.d(t,"o",function(){return l}),n.d(t,"b",function(){return f}),n.d(t,"m",function(){return b}),n.d(t,"f",function(){return h}),n.d(t,"q",function(){return p}),n.d(t,"t",function(){return m}),n.d(t,"s",function(){return v}),n.d(t,"g",function(){return g}),n.d(t,"j",function(){return S}),n.d(t,"k",function(){return O}),n.d(t,"n",function(){return _}),n.d(t,"d",function(){return I}),n.d(t,"c",function(){return j}),n.d(t,"h",function(){return E}),n.d(t,"l",function(){return T}),n.d(t,"a",function(){return w});var r=n(1),o=n(26),i=n(13),a=Object(r.action)("SINGLE_SELECT_ROW",function(e,t,n,r){var a=i.b.getValidCouponIndexes(t,e);return Object(o.a)({name:"SelectMailItem",options:{isQos:!0},customData:[r,e.tableQuery.listViewType,e.tableQuery.type,1===e.tableQuery.type&&e.tableQuery.searchScope.kind,a?a.length:0]},{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})}),c=Object(r.action)("TOGGLE_SELECT_ROW",function(e,t,n,r){return{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r}}),u=Object(r.action)("ON_AFTER_SELECTION_CHANGED",function(e,t,n,r){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r}}),s=Object(r.action)("SET_SELECTION_ON_ROW",function(e,t,n){return{rowKey:e,tableViewId:t,shouldSelect:n}}),d=Object(r.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),l=Object(r.action)("SET_LIST_VIEW_EXPANSION_LOADING_STATE",function(e){return{shouldBeExpanded:e}}),f=Object(r.action)("ITEM_PART_CLICKED",function(e,t,n,r){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r}}),b=Object(r.action)("SELECT_NEXT_ITEM_PART",function(e,t){return{rowKey:e,tableView:t}}),h=Object(r.action)("ON_ITEM_PART_CONTEXT_MENU",function(e,t,n,r){return{contextMenuAnchor:e,nodeId:t,allNodeIds:n,tableViewId:r}}),p=Object(r.action)("SINGLE_SELECT_ITEM_PART",function(e,t,n,r){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r}}),m=Object(r.action)("TOGGLE_SELECT_ITEM_PART",function(e,t){return{nodeId:e,allNodeIds:t}}),v=Object(r.action)("TOGGLE_SELECT_ALL_ROWS",function(e){return{tableView:e}}),g=Object(r.action)("RANGE_SELECT_ROW",function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlKeyDown:r}}),S=Object(r.action)("RESET_SELECTION",function(e,t){return{tableView:e,mailListItemSelectionSource:t}}),O=Object(r.action)("RESET_SELECTION",function(e){return{tableView:e}}),_=Object(r.action)("SELECT_ROW_IN_DIRECTION",function(e,t,n){return Object(o.a)({name:t===i.d.Next?"SelectNextMailRow":"SelectPreviousMailRow",customData:[n,e.tableQuery.listViewType,e.tableQuery.type,1===e.tableQuery.type&&e.tableQuery.searchScope.kind]},{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})}),I=Object(r.action)("KEYBOARD_MULTI_SELECT_ROW",function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlDown:r}}),j=Object(r.action)("KEYBOARD_COLLAPSE_CONVERSATION",function(e){return{rowKey:e}}),E=Object(r.action)("RESET_BUS_STOP_STATE_MAP"),T=Object(r.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}}),w=Object(r.action)("INIT_TABLE_SELECTION_ON_LOAD",function(e){return{tableView:e}})},2875:function(e){e.exports={a:"ljb"}},2876:function(e){e.exports={a:"jjb"}},297:function(e,t,n){"use strict";n.d(t,"f",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"j",function(){return f}),n.d(t,"h",function(){return b}),n.d(t,"m",function(){return h}),n.d(t,"l",function(){return p}),n.d(t,"k",function(){return m}),n.d(t,"i",function(){return v}),n.d(t,"g",function(){return g}),n.d(t,"o",function(){return S});var r=n(320);n.d(t,"a",function(){return r.a});var o=n(1310);n.d(t,"e",function(){return o.a}),n.d(t,"d",function(){return o.b});var i=n(994);n.d(t,"c",function(){return i.a});var a=n(3),c=n(1596);n.d(t,"p",function(){return c.a});var u=n(993);n.d(t,"b",function(){return u.a});var s=new a.c(function(){return Promise.all([n.e(12),n.e(37),n.e(103)]).then(n.bind(null,2567))}),d=new a.a(s,function(e){return e.addAndInitializeAttachments}),l=new a.a(s,function(e){return e.setPreviewImageUrl}),f=new a.a(s,function(e){return e.refreshDownloadUrl}),b=new a.a(s,function(e){return e.createAttachmentInfo}),h=new a.a(s,function(e){return e.setAttachmentInfo}),p=new a.a(s,function(e){return e.refreshThumbnailImageUrl}),m=new a.a(s,function(e){return e.refreshPreviewImageUrl}),v=new a.b(s,function(e){return e.getAttachment}),g=new a.b(s,function(e){return e.checkPendingAttachmentOperation}),S=new a.b(s,function(e){return e.shouldShowImageView})},303:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a});var r=n(9),o=n(7);function i(e){return!!(e&Object(r.a)().ViewStateConfiguration.ListViewBitFlags)}var a=Object(o.action)("setBit")(function(e,t){i(t)!==e&&(e?Object(r.a)().ViewStateConfiguration.ListViewBitFlags|=t:Object(r.a)().ViewStateConfiguration.ListViewBitFlags&=~t)})},304:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"add",function(){return s}),n.d(r,"remove",function(){return d}),n.d(r,"removeAll",function(){return l}),n.d(r,"getCount",function(){return f}),n.d(r,"getTombstonedReasons",function(){return b}),n.d(r,"clearMapForFolder",function(){return h}),n.d(r,"removeRowsFromTombstone",function(){return p});var o=n(0),i=n(1),a=Object(i.createStore)("tombstone",{folderTombstoneMap:{}}),c=(a(),n(18)),u=n(7),s=Object(u.action)("tombstoneOperations.add")(function(e,t,n){var r=a().folderTombstoneMap;t in r||(r[t]={});var o=r[t];e.forEach(function(e){var t=o[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):o[e]=[3]:o[e]=[n]})}),d=Object(u.action)("tombstoneOperations.remove")(function(e,t,n){var r=a().folderTombstoneMap;if(t in r){var o=r[t],i=o[e],c=i?i.indexOf(n):-1;if(-1==c)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");i.splice(c,1),0==i.length&&delete o[e],0==Object.keys(o).length&&delete r[t]}}),l=Object(u.action)("tombstoneOperations.removeAll")(function(){a().folderTombstoneMap={},Object(c.p)("TnS_RemoveAllFromTombstone")}),f=function(e,t){var n=a().folderTombstoneMap;if(!(e in n))return 0;var r=0,o=n[e];return Object.values(o).forEach(function(e){e==t&&r++}),r},b=function(e,t){var n=a().folderTombstoneMap;if(t in n){var r=n[t][e];if(r)return r}return[]},h=Object(u.action)("tombstoneOperations.clearMapForFolder")(function(e){var t=a().folderTombstoneMap;t[e]&&(Object(c.p)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])}),p=Object(u.action)("tombstoneOperations.removeRowsFromTombstone")(function(e,t){var n,r,i=a().folderTombstoneMap;if(t in i){var c=i[t];try{for(var u=o.__values(e),s=u.next();!s.done;s=u.next()){var d=s.value;d in c&&delete c[d]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}0==Object.keys(c).length&&delete i[t]}});t.a=r},320:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"g",function(){return o}),n.d(t,"h",function(){return i}),n.d(t,"n",function(){return a}),n.d(t,"i",function(){return c}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return d}),n.d(t,"f",function(){return l}),n.d(t,"j",function(){return f}),n.d(t,"k",function(){return b}),n.d(t,"l",function(){return h}),n.d(t,"m",function(){return p}),n.d(t,"o",function(){return m}),n.d(t,"p",function(){return v}),n.d(t,"q",function(){return g}),n.d(t,"a",function(){return S});var r="FileAttachment:#Exchange",o="ItemAttachment:#Exchange",i="ItemIdAttachment:#Exchange",a="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange",u="Box",s="Dropbox",d="Facebook",l="GDrive",f="Mailbox",b="MailMessage",h="OneDriveConsumer",p="OneDrivePro",m="WopiBox",v="WopiDropbox",g="WopiEgnyte",S={providers:{BOX:u,DROPBOX:s,FACEBOOK:d,GDRIVE:l,MAILBOX:f,ONE_DRIVE_CONSUMER:h,ONE_DRIVE_PRO:p,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:m,WOPI_EGNYTE:g},attachmentTypes:{FILE_ATTACHMENT_TYPE:r,ITEM_ATTACHMENT_TYPE:o,ITEM_ID_ATTACHMENT_TYPE:i,REFERENCE_ATTACHMENT_TYPE:a,LINK_ATTACHMENT_TYPE:c}}},336:function(e,t,n){"use strict";var r=n(9),o=n(5),i=function(e){return Object(r.a)().SessionSettings.IsSubstrateSearchServiceAvailable&&Object(o.d)(e)};n.d(t,"a",function(){return i})},34:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(692),o=n(185);function i(e){return Object(o.b)().scenarioStores.get(Object(r.a)(e))||Object(o.a)()}},385:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ItemResponseShape:#Exchange"},e)}},388:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.createStore)("headerToastNotificationViewState",{notificationViewStates:[]})()},396:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(5),o=n(56);function i(e,t,n,i,a){var c="",u=Object(r.d)("rp-imageApiConsumer")&&Object(o.a)();return e?c+=e.toLowerCase():t?c+=t:a&&(c+=a.toLowerCase()),i&&u&&(c+=i),n&&!u&&(c+=n),c}},397:function(e,t,n){"use strict";var r;!function(e){e[e.ChangePermissions=0]="ChangePermissions",e[e.CopyLink=1]="CopyLink",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.Preview=4]="Preview",e[e.SaveToCloud=5]="SaveToCloud",e[e.ViewInProvider=6]="ViewInProvider",e[e.ConvertClassicToCloudy=7]="ConvertClassicToCloudy",e[e.ConvertCloudyToClassic=8]="ConvertCloudyToClassic",e[e.ImportCalendarEventAttachment=9]="ImportCalendarEventAttachment",e[e.MoveAttachmentToInline=10]="MoveAttachmentToInline",e[e.RefreshLink=11]="RefreshLink",e[e.IgnoreExpiration=12]="IgnoreExpiration"}(r||(r={})),t.a=r},427:function(e,t,n){"use strict";var r=n(947),o=n(45),i={};function a(e){var t=e.toLocaleLowerCase();if(!i[t]){var n={type:o.a.GroupMailbox,deprecatedMailboxId:e,primarySmtpAddress:e,routingKey:Object(o.c)()+e,returnModernConversationItems:!1,requestOptions:Object(r.a)(e)};i[t]=n}return i[t]}var c=n(1),u=Object(c.action)("EDIT_GROUP_SUCCESS",function(e,t){return{groupSmtp:e,photoUrl:t}}),s=Object(c.action)("ADD_GROUP_MEMBER_SUCCESS",function(e){return{groupSmtp:e}}),d=Object(c.action)("POPUP_OPENED",function(){return{isOpen:!0}}),l=Object(c.action)("POPUP_CLOSED",function(){return{isOpen:!1}}),f=Object(c.action)("DELETE_GROUP_SUCCESS",function(e){return{groupSmtp:e}});n.d(t,"m",function(){return r.a}),n.d(t,"l",function(){return a}),n.d(t,"k",function(){return u}),n.d(t,"i",function(){return s}),n.d(t,"p",function(){return d}),n.d(t,"o",function(){return l}),n.d(t,"j",function(){return f}),n.d(t,"q",function(){return"SwitchGroup"}),n.d(t,"n",function(){return"NavigateFromMeToWe"}),n.d(t,"f",function(){return"GroupHeader_SendEmail_Button_Clicked"}),n.d(t,"b",function(){return"GroupHeader_Email_Button_Clicked"}),n.d(t,"c",function(){return"GroupHeader_Files_Button_Clicked"}),n.d(t,"a",function(){return"GroupHeader_Calendar_Button_Clicked"}),n.d(t,"d",function(){return"GroupHeader_Notebook_Button_Clicked"}),n.d(t,"e",function(){return"GroupHeader_Planner_Button_Clicked"}),n.d(t,"h",function(){return"GroupHeader_Site_Button_Clicked"}),n.d(t,"g",function(){return"GroupHeader_Settings_Button_Clicked"})},429:function(e){e.exports={a:"Oda"}},435:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(14),o=n(333),i=Object(o.b)(function(e,t){var n={position:"absolute",width:1,right:31,top:8,bottom:8},o={splitButtonContainer:[Object(r.getFocusStyle)(e,{highContrastStyle:{left:-2,top:-2,bottom:-2,right:-2,border:"none"}}),{display:"inline-flex"}],splitButtonContainerFocused:{outline:"none!important"},splitButtonMenuButton:{padding:6,height:"auto",boxSizing:"border-box",border:0,borderRadius:0,outline:"transparent",userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",width:32,marginLeft:-1,marginTop:0,marginRight:0,marginBottom:0},splitButtonDivider:n,splitButtonDividerDisabled:n,splitButtonMenuButtonDisabled:{pointerEvents:"none",selectors:{":hover":{cursor:"default"}}},splitButtonFlexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},splitButtonContainerDisabled:{outline:"none",border:"none"}};return Object(r.concatStyleSets)(o,t)})},448:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return a});var r=n(5);function o(){return Object(r.d)("sea-gf1")||Object(r.d)("sea-gf2")||Object(r.d)("sea-gf3")||Object(r.d)("sea-gf4")||Object(r.d)("sea-gf5")||Object(r.d)("sea-gf6")||Object(r.d)("sea-gf")}function i(){return Object(r.d)("sea-gf2")||Object(r.d)("sea-gf4")||Object(r.d)("sea-gf6")||Object(r.d)("sea-gfct1")||Object(r.d)("sea-sendPillDisplayText")}function a(){return Object(r.d)("sea-gf1")||Object(r.d)("sea-gf2")?"sea-gfa":Object(r.d)("sea-gf3")||Object(r.d)("sea-gf4")?"sea-gfb":Object(r.d)("sea-gf5")||Object(r.d)("sea-gf6")?"sea-gfc":null}},449:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.unloaded=0]="unloaded",e[e.loading=1]="loading",e[e.loadSucceeded=2]="loadSucceeded",e[e.loadFailed=3]="loadFailed"}(r||(r={}))},456:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(34);function o(e){var t=Object(r.a)(e);return 0===t.searchText.trim().length&&0===t.suggestionPillIds.length&&0===t.suggestionSegments.size}},458:function(e,t,n){"use strict";n.d(t,"e",function(){return"{id}"}),n.d(t,"f",function(){return"InlineImageLoader.GetLoader().Load(this)"}),n.d(t,"g",function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"}),n.d(t,"a",function(){return"data-custom"}),n.d(t,"c",function(){return"originalsrc"}),n.d(t,"b",function(){return"data-loadstatus"}),n.d(t,"d",function(){return"pending"})},47:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.TestFeature=1]="TestFeature",e[e.SmartSuggestions=2]="SmartSuggestions",e[e.DiverseEmojis=4]="DiverseEmojis",e[e.SurfaceActions=5]="SurfaceActions",e[e.SkypeNotifications=6]="SkypeNotifications",e[e.WebPushNotifications=7]="WebPushNotifications",e[e.Confetti=8]="Confetti",e[e.GdprAdsPrefs=9]="GdprAdsPrefs",e[e.CalendarSurfaceAddins=10]="CalendarSurfaceAddins",e[e.ExternalImages=11]="ExternalImages",e[e.EventCapture=12]="EventCapture",e[e.LinkedInBindingDismissed=13]="LinkedInBindingDismissed",e[e.Translation=14]="Translation",e[e.CalendarSurfaceOptions=15]="CalendarSurfaceOptions",e[e.TxpEventNotifications=16]="TxpEventNotifications",e[e.MentionEventNotifications=17]="MentionEventNotifications",e[e.ComposeAssistance=18]="ComposeAssistance"}(r||(r={}))},48:function(e,t,n){"use strict";var r=n(3),o=n(34),i=n(1),a=n(25);Object(i.mutator)(a.p,function(e){var t=e.suggestionSet;Object(o.a)(e.scenarioId).currentSuggestions=t});var c=n(0),u=n(692),s=n(185),d=n(97);Object(i.mutator)(d.c,function(e){var t=Object(u.a)(e.scenarioId);Object(s.b)().scenarioStores.get(t)||(Object(s.b)().scenarioStores.set(t,c.__assign({},Object(s.a)())),Object(s.b)().scenarioStores.get(t).isUsing3S=e.isUsing3S)}),Object(i.mutator)(a.r,function(e){Object(o.a)(e.scenarioId).isSuggestionsDropdownVisible=e.isSuggestionsDropdownVisible});Object(i.mutator)(d.u,function(e){Object(o.a)(e.scenarioId).searchText=e.searchText}),Object(i.mutator)(d.a,function(e){var t=Object(o.a)(e.scenarioId),n=e.suggestionPill,r=n.ReferenceId;t.suggestionPills.set(r,n),t.suggestionPillIds.push(r)}),Object(i.mutator)(a.s,function(e){var t=Object(o.a)(e.scenarioId),n=e.latestTraceId;t.latestTraceId=n,e.isQFTraceId&&(t.latestQFTraceId=n)});Object(i.mutator)(d.l,function(e){Object(o.a)(e.scenarioId).searchBoxHasFocus=!0}),Object(i.mutator)(a.m,function(e){Object(o.a)(e.scenarioId).searchBoxHasFocus=!1});var l=Object(i.mutatorAction)("setLatestRenderedQFTraceId",function(e,t){Object(o.a)(t).latestRenderedQFTraceId=e}),f=n(54),b=n(689),h=(Object(i.orchestrator)(a.f,function(e){var t=e.scenarioId;f.y.importAndExecute(Object(b.a)(t)),f.v.importAndExecute()}),Object(i.mutator)(a.w,function(e){Object(o.a)(e.scenarioId).queryActionSource=e.actionSource}),Object(i.orchestrator)(d.l,function(e){var t=e.scenarioId,n=Object(o.a)(t),r=n.searchSessionGuid,i=n.searchText,c=n.searchTextForSuggestion;if(Object(a.r)(!0,t),r){if(i&&i===c)return;Object(a.t)(i,t),Object(a.j)(t)}else Object(a.x)("SearchBox",!1,t)}),n(456)),p=n(690);Object(i.orchestrator)(d.f,function(e){return c.__awaiter(void 0,void 0,void 0,function(){var t,n,r,i,u,l,b;return c.__generator(this,function(c){return t=e.scenarioId,n=e.selectedSuggestionIndex,r=e.searchInputValue,i=e.isAutocompleteTextVisible,u=Object(o.a)(t),n!==Object(s.a)().selectedSuggestionIndex?(Object(a.z)(u.currentSuggestions.Suggestions[n],"keyboard",t,u.currentSuggestions.TraceId,n),u.searchText||(Object(a.k)("",t),Object(a.t)("",t))):i?(l=Object(p.a)(0,t),b=l.kind===f.b.People,Object(d.b)(t),b?(Object(a.a)(l,!0,t),Object(a.k)("",t),Object(a.t)("",t)):Object(a.k)(r,t),Object(a.w)("Keyboard",t,!0)):Object(h.a)(t)||Object(a.w)("Keyboard",t,!0),Object(a.r)(!1,t),[2]})})}),Object(i.orchestrator)(a.k,function(e){return c.__awaiter(void 0,void 0,void 0,function(){var t,n;return c.__generator(this,function(r){return t=e.scenarioId,n=e.searchText,Object(d.u)(n,t),Object(d.A)(t),[2]})})});var m=n(998),v=Object(i.mutatorAction)("setSearchSessionGuid",function(e,t){Object(o.a)(t).searchSessionGuid=e}),g=n(94),S=n(18),O=n(163),_=n(448),I=(Object(i.orchestrator)(a.x,function(e){var t=e.actionSource,n=e.shouldStartSearch,r=e.scenarioId,i=Object(o.a)(r);if(i.searchSessionGuid)throw new Error("searchSessionGuid should not be set when starting a search session.");var c=Object(g.a)();v(c,r),Object(m.a)(Object(g.a)(),r),i.isUsing3S&&f.N.import().then(function(e){e(i.nextSearchQueryId,Object(b.a)(r),Object(_.a)())}),Object(a.o)(t,n,r),ee.import(),te.import(),ge.import(),ae.import(),le.import(),Object(S.o)("Search_SessionStarted",[O.b[r],t])}),n(1109));Object(i.orchestrator)(a.l,function(e){Object(I.b)(e.scenarioId,e.callback)});Object(i.orchestrator)(a.a,function(e){var t=e.scenarioId,n=e.suggestionPill;n&&(function(e,t){var n=Object(o.a)(t);switch(e.kind){case f.b.People:return c.__spread(n.suggestionPills.values()).filter(function(t){var n,r,o,i;if(t.kind!==f.b.People)return!1;try{for(var a=c.__values(e.EmailAddresses),u=a.next();!u.done;u=a.next()){var s=u.value;try{for(var d=(o=void 0,c.__values(t.EmailAddresses)),l=d.next();!l.done;l=d.next())if(s===l.value)return!0}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!1}).length>0;case f.b.Category:return n.suggestionPillIds.indexOf(e.ReferenceId)>-1;default:return!1}}(n,t)||Object(d.a)(n,t),e.suggestionSelected&&(Object(a.k)("",t),Object(a.t)("",t)))}),Object(i.mutator)(a.f,function(e){var t=Object(o.a)(e.scenarioId),n=Object(s.a)();t.latestQFRequestId=n.latestQFRequestId,t.searchTextForSuggestion=n.searchTextForSuggestion,t.currentSuggestions=n.currentSuggestions,t.selectedSuggestionIndex=n.selectedSuggestionIndex});var j=n(5);function E(e){if(!Object(j.d)("sea-pillHighlight"))return e.SearchTerms;var t=Object(o.a)(O.b.Mail),n=t.suggestionPills,r=t.suggestionSegments,i=e.SearchTerms;return n.forEach(function(e){switch(e.kind){case f.b.People:var t=e,n=t.DisplayName.toLowerCase().split(" ");T(i,n),T(i,t.EmailAddresses);break;case f.b.Category:var r=e.Name.toLowerCase().split(" ");T(i,r)}}),c.__spread(r.values()).filter(function(e){return"Person"===e.Type}).forEach(function(e){var t=e.DisplayName.toLowerCase().split(" ");T(i,t),w(i,e.EmailAddress)}),i}function T(e,t){t.forEach(function(t){w(e,t)})}function w(e,t){for(var n=-1,r=0;r<e.length;r++)0==e[r].localeCompare(t,"en",{sensitivity:"base",ignorePunctuation:!0})&&(n=r);n>-1&&e.splice(n,1)}var C=n(172),y=n(480),x=n(429),A=n(4),P=n(2),R=n(1105),N=n(8),F=n(20),M=n(87),k=n(203),D=n(1508),L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onKeyDown=function(e){return c.__awaiter(t,void 0,void 0,function(){var t,n,r,i,a;return c.__generator(this,function(c){switch(c.label){case 0:switch(e.stopPropagation(),t=e.keyCode,n=this.props.scenarioId,r=Object(o.a)(n),i=r.ghostText,a=r.selectedSuggestionIndex,Object(d.h)(t,this.props.scenarioId),e.key===i&&this.onSearchTextChange(),t){case 13:return[3,1];case 8:return[3,2];case 38:return[3,4];case 40:return[3,6];case 39:return[3,8];case 37:return[3,9];case 9:return[3,12];case 27:return[3,13]}return[3,14];case 1:return this.clearSelection(),Object(d.f)(a,this.searchInput.value,this.isGhostTextVisible,n),[3,15];case 2:return[4,re.import()];case 3:return c.sent()(this.getCursorPosition(),n),[3,15];case 4:return e.preventDefault(),[4,ie.import()];case 5:return c.sent()(n),[3,15];case 6:return[4,ne.import()];case 7:return c.sent()(n),[3,15];case 8:return this.acceptGhostTextHandler({isBack:!1}),[3,15];case 9:return this.acceptGhostTextHandler({isBack:!0})?[3,11]:[4,oe.import()];case 10:c.sent()(this.getCursorPosition(),n),c.label=11;case 11:return[3,15];case 12:return this.isGhostTextVisible&&(e.preventDefault(),this.acceptGhostTextHandler({isBack:!1}),this.clearSelection()),[3,15];case 13:return e.preventDefault(),Object(d.g)(n),[3,15];case 14:return[3,15];case 15:return[2]}})})},t.onClick=function(e){e.stopPropagation(),Object(a.r)(!0,t.props.scenarioId)},t.onFocus=function(e){Object(d.l)(t.props.scenarioId)},t.onSearchTextChange=function(){var e=t.props.scenarioId,n=t.searchInput.value;Object(a.k)(n,e),Object(a.t)(n,e),Object(a.j)(e),Object(o.a)(e).isSuggestionsDropdownVisible||Object(a.r)(!0,e)},t}return c.__extends(t,e),t.prototype.setFocus=function(){this.searchInput&&this.searchInput.focus()},Object.defineProperty(t.prototype,"isGhostTextVisible",{get:function(){if(Object(M.e)()||Object(M.c)())return!1;var e=Object(o.a)(this.props.scenarioId),t=e.ghostText,n=e.isSuggestionsDropdownVisible,r=e.searchText;return t&&n&&this.searchInput.selectionStart===r.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"searchInputText",{get:function(){var e=Object(o.a)(this.props.scenarioId),t=e.searchText,n=e.ghostText;return this.isGhostTextVisible?""+t+n:t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activeDescendant",{get:function(){var e=this.props,t=e.isSuggestionsCalloutVisible,n=e.scenarioId,r=Object(o.a)(n).selectedSuggestionIndex;return t&&r>=0?""+C.o+r:""},enumerable:!0,configurable:!0}),t.prototype.componentDidUpdate=function(){var e=Object(o.a)(this.props.scenarioId),t=e.searchText,n=e.ghostText,r=t.length,i=t.length+n.length;this.isGhostTextVisible&&this.searchInput.setSelectionRange(r,i)},t.prototype.render=function(){var e=this,t=this.props,n=t.scenarioId,r=t.searchPlaceHolderText,i=t.isDisabled,a=t.isSuggestionsCalloutVisible,c=!!Object(o.a)(this.props.scenarioId).searchSessionGuid,u=k(D.searchBoxInput,i&&D.isDisabled,c?D.inSearchinputPlaceholder:D.inputPlaceholder),s=Object(R.a)(n,r),d=s.ariaLabel,l=s.placeholder;return P.createElement("div",{className:D.searchBoxInputContainer},P.createElement("input",{"aria-activedescendant":this.activeDescendant,"aria-autocomplete":"list","aria-label":d,"aria-owns":a?C.n:"",autoComplete:"off",className:u,disabled:i,onChange:this.onSearchTextChange,onClick:this.onClick,onFocus:this.onFocus,onKeyDown:this.onKeyDown,placeholder:l,ref:function(t){return e.searchInput=t},value:this.searchInputText,spellCheck:!1,autoCorrect:"off"}))},t.prototype.getCursorPosition=function(){return this.searchInput?this.searchInput.selectionStart!==this.searchInput.selectionEnd?-1:this.searchInput.selectionStart:-1},t.prototype.acceptGhostTextHandler=function(e){var t=e.isBack,n=this.props.scenarioId;if(!this.isGhostTextVisible)return!1;var r=Object(p.a)(0,n);return!!r&&(!t&&r.kind===f.b.People?(Object(a.a)(r,!0,n),Object(a.k)("",n),Object(a.t)("",n),Object(a.j)(n)):this.onSearchTextChange(),Object(d.b)(n),!0)},t.prototype.clearSelection=function(){var e=this.searchInput.value.length;this.searchInput.setSelectionRange(e,e)},c.__decorate([N.computed],t.prototype,"isGhostTextVisible",null),c.__decorate([N.computed],t.prototype,"searchInputText",null),c.__decorate([N.computed],t.prototype,"activeDescendant",null),t=c.__decorate([F.observer],t)}(P.Component),B=n(1106);function G(e,t){return e?C.c:t||C.b}var U=n(1166),H=n(1452),V=n(209),q=n(222),z=n(53),Q=n(114),W=n(203),X=n(1510),K="LPCPseudoTabbableElement",Y=function(e){function t(t){var n=e.call(this,t)||this;n.focusSearchInput=function(){n.searchInput.setFocus()},n.onSearchBoxClick=function(e){e.stopPropagation(),n.focusSearchInput()},n.onExit=function(e){Object(a.h)(e,n.props.scenarioId)},n.onSearchBoxBlur=function(e){var t=e.relatedTarget;t||(t=document.activeElement),Object(q.a)(n.searchBoxContainer,t)||t.id==K||t.firstElementChild&&t.firstElementChild.id===C.i||(Object(a.r)(!1,n.props.scenarioId),Object(a.m)(n.props.scenarioId))},n.onRemovePill=function(e){return c.__awaiter(n,void 0,void 0,function(){return c.__generator(this,function(t){switch(t.label){case 0:return[4,ae.import()];case 1:return t.sent()(e,this.props.scenarioId,"Click"),[2]}})})},n.onRemoveSegment=function(e){return c.__awaiter(n,void 0,void 0,function(){return c.__generator(this,function(t){return Object(d.r)(e,this.props.scenarioId),[2]})})},n.onClearSearchBoxClicked=function(e){var t=n.props.scenarioId;e.stopPropagation(),Object(a.c)(t),n.focusSearchInput(),Object(S.o)("Search_ClearSearchBoxButtonClicked",[O.a[t]])},n.onClearSearchBoxClickedKeyDown=function(e){e.keyCode!==z.a.enter&&e.keyCode!==z.a.space||n.onClearSearchBoxClicked(e)};var r=t.isUsing3S,o=void 0===r||r;return Object(d.c)(t.scenarioId,o),n}return c.__extends(t,e),Object.defineProperty(t.prototype,"isSuggestionsCalloutVisible",{get:function(){var e=Object(o.a)(this.props.scenarioId),t=e.isSuggestionsDropdownVisible,n=e.currentSuggestions;return n&&n.Suggestions&&n.Suggestions.length>0&&t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"searchBoxButtonProps",{get:function(){var e=this;return Object(o.a)(this.props.scenarioId).searchBoxHasFocus?{ariaLabel:Object(A.a)(x.a),iconProps:{iconName:"Forward"},onClick:this.onSearchButtonClicked(),title:Object(A.a)(x.a)}:{ariaLabel:Object(A.a)(y.b),iconProps:{iconName:"Clear"},onClick:function(){return e.onExit("SearchBoxXButton")},title:Object(A.a)(y.b)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"searchGlyphClasses",{get:function(){return Object(j.d)("sea-searchBoxInteractions1")?W(Object(o.a)(this.props.scenarioId).searchSessionGuid?X.searchIconFocused:X.searchIconRest,this.props.isDisabled&&X.isDisabled):W(X.searchIcon,this.props.isDisabled&&X.isDisabled)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isClearSearchBoxButtonVisible",{get:function(){return!!Object(j.d)("sea-searchBoxInteractionsClear")&&!Object(h.a)(this.props.scenarioId)},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this,t=!!Object(o.a)(this.props.scenarioId).searchSessionGuid,n={maxWidth:G(t,this.props.customCollapsedMaxWidth)+"px",width:"100%"},r=W(X.searchBoxContainer,t&&X.searchBoxContainerInSearch),i=X.searchBox,a=W(i,this.props.isDisabled&&X.isDisabled),u=this.searchGlyphClasses,s=this.isSuggestionsCalloutVisible?P.createElement(he,{scenarioId:this.props.scenarioId}):null,d={role:Q.a.button,label:Object(A.a)(y.a)};return P.createElement("div",{style:n},P.createElement("div",{role:"search",tabIndex:-1,className:r,ref:function(t){return e.searchBoxContainer=t},"aria-expanded":this.isSuggestionsCalloutVisible,onBlur:this.onSearchBoxBlur},P.createElement("div",{id:C.i,className:a},s,t&&!Object(j.d)("sea-searchBoxInteractions1")?P.createElement(U.a,{className:W(X.backButton,"flipForRtl"),iconProps:{iconName:"Back"},onClick:function(){e.onExit("SearchBoxBackArrow")},ariaLabel:Object(A.a)(y.b)}):P.createElement("div",{"aria-hidden":!0,className:u,onClick:this.onSearchBoxClick},P.createElement(V.a,{iconName:"Search"})),P.createElement("div",{className:X.searchQueryContainer,onClick:this.onSearchBoxClick},Object(B.a)(this.props.scenarioId)&&P.createElement(be,{focusSearchInput:this.focusSearchInput,onRemovePill:this.onRemovePill,onRemoveSegment:this.onRemoveSegment,scenarioId:this.props.scenarioId}),P.createElement(L,{ref:function(t){return e.searchInput=t},searchPlaceHolderText:this.props.searchPlaceHolderText,isDisabled:this.props.isDisabled,scenarioId:this.props.scenarioId,isSuggestionsCalloutVisible:this.isSuggestionsCalloutVisible})),this.isClearSearchBoxButtonVisible&&P.createElement("div",c.__assign({className:X.clearBoxButton,onClick:this.onClearSearchBoxClicked,onKeyDown:this.onClearSearchBoxClickedKeyDown,tabIndex:0,title:Object(A.a)(y.a)},Object(Q.b)(d)),P.createElement(V.a,{iconName:"Clear",styles:{root:{fontSize:"8px"}}})),t&&this.props.renderRefiners&&P.createElement("div",{tabIndex:-1},this.props.renderRefiners()),t&&Object(j.d)("sea-searchBoxInteractions1")&&P.createElement(H.a,c.__assign({className:X.searchBoxButton,styles:{icon:{fontSize:"16px"}}},this.searchBoxButtonProps))),t&&!Object(j.d)("sea-searchBoxInteractions1")&&P.createElement(U.a,{className:X.searchButton,iconProps:{iconName:"Search"},onClick:this.onSearchButtonClicked(),ariaLabel:Object(A.a)(x.a)})),P.createElement("div",{id:C.h}))},t.prototype.onSearchButtonClicked=function(){var e=this;return function(t){return c.__awaiter(e,void 0,void 0,function(){var e;return c.__generator(this,function(n){switch(n.label){case 0:return t.stopPropagation(),e=this.props.scenarioId,[4,ge.import()];case 1:return n.sent()(e)?this.focusSearchInput():(Object(o.a)(e).searchText!==this.searchInput.searchInputText&&(Object(d.b)(e),Object(a.k)(this.searchInput.searchInputText,e)),Object(a.r)(!1,this.props.scenarioId),Object(a.w)("SearchButton",e,!0)),[2]}})})}},c.__decorate([N.computed],t.prototype,"isSuggestionsCalloutVisible",null),c.__decorate([N.computed],t.prototype,"searchBoxButtonProps",null),c.__decorate([N.computed],t.prototype,"searchGlyphClasses",null),c.__decorate([N.computed],t.prototype,"isClearSearchBoxButtonVisible",null),t=c.__decorate([F.observer],t)}(P.Component),J=n(1084);function Z(e){var t=Object(o.a)(e),n=t.suggestionPills,r=t.suggestionSegments;return!!(n&&0!==n.size||0!==r.size)&&(c.__spread(n.values()).filter(function(e){return e.kind===f.b.People}).length>0||c.__spread(r.values()).filter(function(e){return"Person"===e.Type}).length>0)}n.d(t,"v",function(){return ee}),n.d(t,"w",function(){return te}),n.d(t,"C",function(){return ne}),n.d(t,"B",function(){return re}),n.d(t,"D",function(){return oe}),n.d(t,"E",function(){return ie}),n.d(t,"F",function(){return ae}),n.d(t,"H",function(){return ce}),n.d(t,"G",function(){return ue}),n.d(t,"J",function(){return se}),n.d(t,"K",function(){return de}),n.d(t,"I",function(){return le}),n.d(t,"d",function(){return fe}),n.d(t,"e",function(){return be}),n.d(t,"g",function(){return he}),n.d(t,"x",function(){return pe}),n.d(t,"y",function(){return me}),n.d(t,"z",function(){return ve}),n.d(t,"A",function(){return ge}),n.d(t,"T",function(){return l}),n.d(t,"p",function(){return E}),n.d(t,"q",function(){return o.a}),n.d(t,"k",function(){return s.a}),n.d(t,"b",function(){return C.l}),n.d(t,"a",function(){return C.d}),n.d(t,"f",function(){return O.b}),n.d(t,"h",function(){return a.a}),n.d(t,"i",function(){return a.c}),n.d(t,"j",function(){return a.d}),n.d(t,"l",function(){return a.e}),n.d(t,"n",function(){return a.h}),n.d(t,"s",function(){return a.j}),n.d(t,"O",function(){return a.m}),n.d(t,"P",function(){return a.n}),n.d(t,"Q",function(){return a.o}),n.d(t,"R",function(){return a.p}),n.d(t,"S",function(){return a.q}),n.d(t,"W",function(){return a.v}),n.d(t,"Y",function(){return a.w}),n.d(t,"U",function(){return a.s}),n.d(t,"bb",function(){return a.z}),n.d(t,"ab",function(){return a.y}),n.d(t,"o",function(){return a.i}),n.d(t,"L",function(){return a.k}),n.d(t,"Z",function(){return a.x}),n.d(t,"N",function(){return a.l}),n.d(t,"V",function(){return a.t}),n.d(t,"m",function(){return a.f}),n.d(t,"u",function(){return _.b}),n.d(t,"X",function(){return _.c}),n.d(t,"t",function(){return _.a}),n.d(t,"c",function(){return Y}),n.d(t,"r",function(){return J.a}),n.d(t,"M",function(){return Z});var $=new r.c(function(){return Promise.all([n.e(4),n.e(7),n.e(11),n.e(513),n.e(354)]).then(n.bind(null,11661))}),ee=new r.b($,function(e){return e.clearSearchBox}),te=new r.b($,function(e){return e.endSearchSession}),ne=new r.b($,function(e){return e.onDownArrowPressedSearchInput}),re=new r.b($,function(e){return e.onBackspacePressedSearchInput}),oe=new r.b($,function(e){return e.onLeftArrowPressedSearchInput}),ie=(new r.b($,function(e){return e.onRightArrowPressedSearchInput}),new r.b($,function(e){return e.onUpArrowPressedSearchInput})),ae=new r.b($,function(e){return e.removeSuggestionPillFromSearchBox}),ce=new r.b($,function(e){return e.setLatestQFRequestId}),ue=new r.b($,function(e){return e.setIsSuggestionsDropdownVisible}),se=new r.b($,function(e){return e.setSuggestionSegments}),de=new r.b($,function(e){return e.updateIsSuggestionSetComplete}),le=new r.a($,function(e){return e.setSpellerData}),fe=(Object(r.d)($,function(e){return e.PersonaPill}),Object(r.d)($,function(e){return e.PrivateDistributionListPill}),Object(r.d)($,function(e){return e.SearchBoxDropdown})),be=Object(r.d)($,function(e){return e.SearchBoxPillWell}),he=Object(r.d)($,function(e){return e.SuggestionsCallout}),pe=new r.b($,function(e){return e.getSuggestionAtIndex}),me=new r.b($,function(e){return e.isInSearchMode}),ve=new r.b($,function(e){return e.isQFRequestIdEqualToLatest}),ge=new r.b($,function(e){return e.isSearchBoxEmpty})},480:function(e){e.exports={b:"vFa",a:"wFa"}},511:function(e,t,n){"use strict";n.d(t,"j",function(){return r}),n.d(t,"l",function(){return o}),n.d(t,"w",function(){return i}),n.d(t,"u",function(){return a}),n.d(t,"a",function(){return c}),n.d(t,"q",function(){return u}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"g",function(){return l}),n.d(t,"h",function(){return f}),n.d(t,"i",function(){return b}),n.d(t,"f",function(){return h}),n.d(t,"e",function(){return p}),n.d(t,"m",function(){return m}),n.d(t,"d",function(){return v}),n.d(t,"k",function(){return g}),n.d(t,"t",function(){return S}),n.d(t,"o",function(){return O}),n.d(t,"v",function(){return _}),n.d(t,"p",function(){return I}),n.d(t,"r",function(){return j}),n.d(t,"s",function(){return E}),n.d(t,"n",function(){return T});var r="multipart/signed",o="application/pkcs7-mime",i="application/x-pkcs7-mime",a=".p7m",c="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",u="CLASSID",s="4",d="0800",l=57,f=16,b=11,h="IPM.Note.SMIME.MultipartSigned",p="IPM.Note.SMIME",m="smime-",v="image",g="OwaToSmime",S="SmimeToOwa",O="en-US",_=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],I="https://ow2.res.office365.com/owasmime/20.19.214.1/owasmime.msi",j="OwaSmimeEdgeExtension.appxbundle",E="https://ow2.res.office365.com/owasmime/20.19.214.1/OwaSmimeEdgeExtension.appxbundle",T="https://ow2.res.office365.com/owasmime/20.19.214.1/SmimeOutlookWebChrome.msi"},5241:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateFavoriteFolderRequest:#Exchange"},e)}},5533:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(5241);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=o.default(e.request)),r.makeServiceRequest("UpdateFavoriteFolder",e,t)}},570:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.AsyncSendFailed=0]="AsyncSendFailed",e[e.AddFavoritePersonaFailedNotification=1]="AddFavoritePersonaFailedNotification",e[e.RemoveFavoritePersonaFailedNotification=2]="RemoveFavoritePersonaFailedNotification",e[e.PeopleHubNotification=3]="PeopleHubNotification",e[e.SkypeNotification=4]="SkypeNotification",e[e.SkypeForBusinessNotification=5]="SkypeForBusinessNotification"}(r||(r={}))},607:function(e,t,n){"use strict";var r=n(1),o=Object(r.action)("ON_GET_NUDGES_COMPLETED",function(e){return{nudgedRows:e}}),i=Object(r.action)("ON_NUDGE_REMOVED",function(e){return{rowKey:e}}),a=Object(r.createStore)("nudgeStore",{nudgedRows:[]}),c=a();function u(e){return c.nudgedRows.filter(function(t){return t.tableViewId===e}).length}Object(r.mutator)(o,function(e){c.nudgedRows=e.nudgedRows}),Object(r.mutator)(i,function(e){for(var t=c.nudgedRows.length-1;t>=0;t--)c.nudgedRows[t].rowKey===e.rowKey&&c.nudgedRows.splice(t,1)});var s=n(1744),d=n(4);function l(e){var t=c.nudgedRows.filter(function(t){return t.rowKey===e})[0];switch(t.reason){case 0:return Object(d.b)(Object(d.a)(s.a),t.daysAgo);case 1:return Object(d.b)(Object(d.a)(s.b),t.daysAgo)}}function f(e){var t=c.nudgedRows.filter(function(t){return t.itemId===e});return 1==t.length?t[0].rowKey:null}function b(e,t){return 1==c.nudgedRows.filter(function(n){return n.rowKey===e&&n.tableViewId===t}).length}var h=n(13);function p(e,t){return b(e,t.id)&&!h.b.getIsPinned(e,t)}n.d(t,"c",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"b",function(){return f}),n.d(t,"f",function(){return p}),n.d(t,"e",function(){return b}),n.d(t,"d",function(){return a}),n.d(t,"g",function(){return o}),n.d(t,"h",function(){return i})},617:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",function(e,t){return{itemIdToRemove:e,removeItemSource:t}})},6267:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(603),o=n.n(r),i=n(108),a=n.n(i),c=n(5241),u=n.n(c),s=n(5533),d=n.n(s);function l(e,t){var n=function(e,t){var n=a()({Id:e.FolderId.Id,ChangeKey:e.FolderId.ChangeKey});return u()({Folder:o()({FolderId:n,DisplayName:e.DisplayName}),Operation:t?0:1})}(e,t);return d()({request:n}).then(function(e){return e})}},642:function(e,t,n){"use strict";var r=n(499),o=n(1069),i=n(262),a=n(396),c=new r.a(3,function(e){var t=Object(a.a)(e.emailAddress,e.personaId,e.size,e.mailboxType,e.name),n=i.a.viewStates.get(t);return Object(o.a)(n)},500);t.a=c},659:function(e,t,n){"use strict";var r=n(8),o=n(1),i={folderTable:new r.ObservableMap,rootFolder:null},a=Object(o.createStore)("publicFolderFavoriteStore",i)();t.a=a},680:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(56),o=n(47),i=n(5);function a(){var e;return(e={})[o.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[o.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[o.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(r.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddInlineImage","AddEmoji","ToggleDictation","ToggleRibbon"],composeSurfaceAddins:[]},e[o.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[o.a.Confetti]={confettiEnabled:!0},e[o.a.ComposeAssistance]={composeAssistanceEnabled:!0},e[o.a.GdprAdsPrefs]={feature:o.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[o.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[o.a.ExternalImages]={externalImagesSelectedOption:0},e[o.a.EventCapture]={autoCollectionEnabled:!1},e[o.a.LinkedInBindingDismissed]={linkedInBindingDismissedInPeoplePicker:!1},e[o.a.Translation]={translationMode:0,excludedLanguages:[]},e[o.a.CalendarSurfaceOptions]={agendaPaneIsClosed:!Object(i.d)("cal-agenda")},e}},688:function(e,t,n){"use strict";var r,o=n(47),i=n(1098),a=n(1);t.a=Object(a.createStore)("owsOptionsStore",{options:(r={},r[o.a.SmartSuggestions]={feature:o.a.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},r[o.a.DiverseEmojis]={feature:o.a.DiverseEmojis,diverseEmojisSelectedSkinTone:""},r[o.a.SurfaceActions]={feature:o.a.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},r[o.a.SkypeNotifications]={feature:o.a.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},r[o.a.WebPushNotifications]={feature:o.a.WebPushNotifications,enabled:!1,applicationServerKey:null},r[o.a.Confetti]={feature:o.a.Confetti,confettiEnabled:!1},r[o.a.GdprAdsPrefs]={feature:o.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},r[o.a.CalendarSurfaceAddins]={feature:o.a.CalendarSurfaceAddins,calendarSurfaceAddins:[]},r[o.a.ExternalImages]={feature:o.a.ExternalImages,externalImagesSelectedOption:null},r[o.a.EventCapture]={autoCollectionEnabled:!1},r[o.a.LinkedInBindingDismissed]={linkedInBindingDismissedInPeoplePicker:!1},r[o.a.Translation]={feature:o.a.Translation,translationMode:0,excludedLanguages:[]},r[o.a.CalendarSurfaceOptions]={feature:o.a.CalendarSurfaceOptions,agendaPaneIsClosed:!0},r[o.a.MentionEventNotifications]={feature:o.a.MentionEventNotifications,enabled:!1},r[o.a.TxpEventNotifications]={feature:o.a.TxpEventNotifications,enabled:!1},r[o.a.ComposeAssistance]={feature:o.a.ComposeAssistance,composeAssistanceEnabled:!1},r),loadState:i.a.OptionsNotLoaded})},689:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(163),o=n(54);function i(e){switch(e){case r.b.Mail:return o.a.Mail;case r.b.Calendar:return o.a.Calendar;case r.b.FilesHub:return o.a.FilesHub;default:throw Error("No corresponding SubstrateSearchScenario for given SearchScenarioId ("+e+").")}}},690:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(34);function o(e,t){var n=Object(r.a)(t).currentSuggestions;if(!n||!n.IsComplete)return null;var o=n.Suggestions[e];return o||null}},691:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return i});var r="Calling",o="UnreadMessage",i="Summary"},692:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(163);function o(e){switch(e){case r.b.Mail:return"Mail";case r.b.Calendar:return"Calendar";case r.b.FilesHub:return"FilesHub";case r.b.FilesPicker:return"FilesPicker";default:throw Error("Unknown SearchScenarioId value!")}}},694:function(e,t,n){"use strict";var r=n(7),o=n(388);t.a=Object(r.action)("removeNotification")(function(e){var t=o.a.notificationViewStates.indexOf(e);t>=0&&o.a.notificationViewStates.splice(t,1)})},743:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return c}),n.d(t,"e",function(){return u}),n.d(t,"f",function(){return s}),n.d(t,"g",function(){return d});var r=n(1),o=Object(r.action)("CLEAR_SEARCH_SCOPE",function(e,t,n){return{actionSource:e,shouldStartSearch:t,searchScopeKind:n}}),i=Object(r.action)("LOAD_MESSAGE_SUGGESTION_INTO_TABLE",function(e,t,n,r,o,i){return{actionSource:e,row:t,searchTableQuery:n,referenceId:r,traceId:o,itemPartId:i}}),a=Object(r.action)("LOAD_TABLE_VIEW_FROM_SEARCH_TABLE_QUERY",function(e,t,n){return{searchTableQuery:e,searchEndToEndPerformanceDatapoint:t,actionSource:n}}),c=Object(r.action)("REMOVE_SEARCH_TABLE_FROM_STORE",function(e){return{tableViewId:e}}),u=Object(r.action)("SELECT_PREVIOUS_NODE",function(e){return{actionSource:e}}),s=Object(r.action)("SET_STATIC_SEARCH_SCOPE",function(e){return{searchScope:e}}),d=Object(r.action)("START_SEARCH_WITH_CATEGORY",function(e,t){return{actionSource:e,categoryName:t}})},776:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"c",function(){return s});var r=n(0),o=n(8),i=n(1),a=n(1411),c={fromDate:null,includeAttachments:!1,initialSearchScope:null,isSearchHistoryDirty:!1,legacySuggestions:new o.ObservableMap({}),previousNode:null,refinersVisible:!1,searchNumber:0,staticSearchScope:null,staticSearchScopeList:null,toDate:null,advancedSearchViewState:Object(a.a)(),initialAdvancedSearchViewState:Object(a.a)()},u=r.__assign({},c),s=Object(i.createStore)("mailSearchStore",u),d=s();t.a=d},787:function(e,t,n){"use strict";n.d(t,"p",function(){return u}),n.d(t,"s",function(){return s}),n.d(t,"t",function(){return d}),n.d(t,"a",function(){return l}),n.d(t,"r",function(){return f}),n.d(t,"g",function(){return b}),n.d(t,"h",function(){return h}),n.d(t,"e",function(){return p}),n.d(t,"f",function(){return m}),n.d(t,"k",function(){return v}),n.d(t,"j",function(){return g}),n.d(t,"m",function(){return S}),n.d(t,"n",function(){return O}),n.d(t,"l",function(){return _}),n.d(t,"d",function(){return I}),n.d(t,"q",function(){return j}),n.d(t,"u",function(){return E}),n.d(t,"c",function(){return T}),n.d(t,"o",function(){return w}),n.d(t,"b",function(){return C}),n.d(t,"i",function(){return y});var r=n(1088);n.d(t,"v",function(){return r.a});var o=n(1089);n.d(t,"w",function(){return o.a});var i=n(1081);n.d(t,"x",function(){return i.b});n(224),n(397);var a=n(3),c=new a.c(function(){return Promise.all([n.e(2),n.e(6),n.e(9),n.e(11),n.e(107)]).then(n.bind(null,2158))}),u=new a.a(c,function(e){return e.initializeAttachments}),s=new a.a(c,function(e){return e.reinitializeAttachments}),d=new a.a(c,function(e){return e.setInlineAttachmentStatus}),l=new a.a(c,function(e){return e.addAttachmentIntoWellBeforeUpload}),f=new a.b(c,function(e){return e.refreshSharingTipsAttachmentWell}),b=new a.b(c,function(e){return e.createAttachmentsViaQueueManager}),h=new a.a(c,function(e){return e.deleteAttachmentViaQueueManager}),p=new a.b(c,function(e){return e.createAttachmentFullViewStateAndStoreBackingModel}),m=new a.b(c,function(e){return e.createAttachmentFullViewState}),v=new a.b(c,function(e){return e.getAttachmentWellInitialValue}),g=new a.b(c,function(e){return e.getAttachmentWellForCompose}),S=new a.b(c,function(e){return e.getConversationAttachmentWellInitialValue}),O=new a.b(c,function(e){return e.getImageDimensionsFromFile}),_=(new a.b(c,function(e){return e.getMaxClassicAttachmentsSize}),new a.b(c,function(e){return e.getAvailableLocalAttachmentSize})),I=new a.b(c,function(e){return e.createAttachmentFileFromExistingMailboxAttachment}),j=new a.a(c,function(e){return e.mergeToConversationAttachmentWell}),E=new a.a(c,function(e){return e.sortConversationAttachmentWell}),T=new a.a(c,function(e){return e.convertImageViewAttachmentToInlineAttachment}),w=new a.b(c,function(e){return e.getLastCloudyAttachmentsSharingIssueForBlockOnSend}),C=new a.b(c,function(e){return e.checkForRemovedLinks}),y=new a.b(c,function(e){return e.getAllValidAttachments})},798:function(e,t,n){"use strict";n.d(t,"d",function(){return l}),n.d(t,"i",function(){return f});var r=n(3),o=n(1125);n.d(t,"f",function(){return o.a});var i=n(694);n.d(t,"j",function(){return i.a});var a=n(388);n.d(t,"h",function(){return a.a});var c=n(691);n.d(t,"a",function(){return c.a}),n.d(t,"b",function(){return c.b}),n.d(t,"e",function(){return c.c});var u=n(1126);n.d(t,"g",function(){return u.a});var s=n(570);n.d(t,"c",function(){return s.a});var d=new r.c(function(){return Promise.all([n.e(0),n.e(1),n.e(4),n.e(500),n.e(302)]).then(n.bind(null,2181))}),l=Object(r.d)(d,function(e){return e.NotificationToast}),f=new r.a(d,function(e){return e.addNotification})},811:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1180);function o(e){return e&&Object(r.b)(e.ItemClass)}},813:function(e,t,n){"use strict";var r=n(18),o=n(141),i=n(513),a={tenantTokens:Object(r.e)(),isCore:!0};function c(e,t,n){var r=new i.a(e,t,a);n&&r.addCosmosOnlyData(n),o.g.importAndExecute(r)}function u(e){return new r.a(e,a)}n.d(t,"b",function(){return c}),n.d(t,"a",function(){return u})},881:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i});var r=n(14);function o(e){var t,n,o,i=e.semanticColors,a=i.buttonBackground,c=i.buttonBackgroundChecked,u=i.buttonBackgroundHovered,s=i.buttonText,d=i.buttonTextHovered,l=i.buttonTextChecked,f=i.buttonTextCheckedHovered;return{root:{backgroundColor:a,color:s},rootHovered:{backgroundColor:u,color:d,selectors:(t={},t[r.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},t)},rootPressed:{backgroundColor:c,color:l},rootExpanded:{backgroundColor:c,color:l},rootChecked:{backgroundColor:c,color:l},rootCheckedHovered:{backgroundColor:e.palette.neutralLight,color:f},splitButtonContainer:{selectors:(n={},n[r.HighContrastSelector]={border:"none"},n)},splitButtonMenuButton:{color:e.palette.white,backgroundColor:e.palette.neutralLighter,selectors:{":hover":{backgroundColor:e.palette.neutralLight,selectors:(o={},o[r.HighContrastSelector]={color:"Highlight"},o)}}},splitButtonMenuButtonDisabled:{backgroundColor:e.palette.neutralLighter,selectors:{":hover":{backgroundColor:e.palette.neutralLighter}}},splitButtonDivider:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:e.palette.themePrimary},splitButtonMenuButtonExpanded:{backgroundColor:e.palette.neutralLight},splitButtonMenuIcon:{color:e.palette.neutralPrimary},splitButtonMenuIconDisabled:{color:e.palette.neutralTertiary}}}function i(e){return{root:{backgroundColor:e.palette.themePrimary,color:e.palette.white,selectors:(t={},t[r.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},t)},rootHovered:{backgroundColor:e.palette.themeDarkAlt,color:e.palette.white,selectors:(n={},n[r.HighContrastSelector]={color:"Window",backgroundColor:"Highlight"},n)},rootPressed:{backgroundColor:e.palette.themeDark,color:e.palette.white,selectors:(o={},o[r.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},o)},rootExpanded:{backgroundColor:e.palette.themeDark,color:e.palette.white},rootChecked:{backgroundColor:e.palette.themeDark,color:e.palette.white},rootCheckedHovered:{backgroundColor:e.palette.themePrimary,color:e.palette.white},rootDisabled:{selectors:(i={},i[r.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},i)},splitButtonContainer:{selectors:(a={},a[r.HighContrastSelector]={border:"none"},a)},splitButtonDivider:{backgroundColor:e.palette.white},splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButton:{backgroundColor:e.palette.themePrimary,color:e.palette.white,selectors:{":hover":{backgroundColor:e.palette.themeDark,selectors:(c={},c[r.HighContrastSelector]={color:"Highlight"},c)}}},splitButtonMenuButtonDisabled:{backgroundColor:e.palette.neutralLighter,selectors:{":hover":{backgroundColor:e.palette.neutralLighter}}},splitButtonMenuButtonChecked:{backgroundColor:e.palette.themeDark},splitButtonMenuButtonExpanded:{backgroundColor:e.palette.themeDark},splitButtonMenuIcon:{color:e.palette.white},splitButtonMenuIconDisabled:{color:e.palette.neutralTertiary}};var t,n,o,i,a,c}},889:function(e,t,n){"use strict";t.a=function(e){return e&&e.Smime&&e.Smime.isDecoded}},893:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SearchFolderScopeType:#Exchange"},e)}},900:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("GET_FOLDER_DATA",function(e){return{folderId:e}})},9008:function(e){e.exports={a:"mjb"}},923:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("DELETE_ITEMS_STORE_UPDATE",function(e,t){return{itemContexts:e,parentFolderId:t}})},925:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"IsGreaterThanOrEqualTo:#Exchange"},e)}},960:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"add",function(){return T}),n.d(r,"getPreviews",function(){return w}),n.d(r,"getAttachmentsForConversationWell",function(){return y});var o=n(0),i=n(7),a=n(72),c=Object(i.action)("removeAttachmentPreviewsForRow")(function(e){var t=a.a.rowAttachmentPreviewWellViews,n=t.get(e);if(n){var r=a.a.attachmentViewStates;n.imageViewStateIds.forEach(function(e){r.delete(e)}),n.documentViewStateIds.forEach(function(e){r.delete(e)}),t.delete(e)}});var u=n(18),s=n(297),d=n(787),l=n(31),f=n(8);var b=Object(i.action)("createAndStoreAttachmentViewState")(function(e,t,n,r,i){return o.__awaiter(this,void 0,void 0,function(){var c,u,l,b=this;return o.__generator(this,function(h){switch(h.label){case 0:return c=function(e,t){return e+"_"+t}(e,n.AttachmentId.Id),u=a.a.attachmentViewStates.get(c),l=f.observable.object(o.__assign({},n.AttachmentId,{mailboxInfo:i})),[4,d.e.import().then(function(e){return o.__awaiter(b,void 0,void 0,function(){return o.__generator(this,function(o){switch(o.label){case 0:return u=u||e(l,n,!0,!0,!1,t),[4,s.i.import()];case 1:return n=o.sent()(l).model,a.a.attachmentViewStates.set(c,u),[4,s.o.import()];case 2:return o.sent()(n)?r.imageViewStateIds.push(c):r.documentViewStateIds.push(c),[2]}})})})];case 1:return h.sent(),[2]}})})});var h=Object(i.select)({listView:function(){return a.a}})(Object(i.action)("processAttachmentsForConversation")(function(e,t,n){var r=n.listView.conversationItems.get(e.ConversationId.Id);if(r)if(e.AttachmentPreviews){var o=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n],i=o.Attachment,a=-1;if(i.IsInline)for(var c=0;c<t.length;c++){var u=t[c];if(u.Attachment.IsInline&&u.Attachment.Name==i.Name&&u.ParentItemId.Id!=o.ParentItemId.Id){a=c;break}}-1==a&&t.push(o)}return t}(e.AttachmentPreviews.Previews);m(e.ConversationId.Id,o,t);var i=e.AttachmentPreviews.Previews.length-o.length;i>0&&Object(u.p)("IP_II_DP",[i])}else r.shouldShowAttachmentPreviews=!1,c(e.ConversationId.Id),Object(u.p)("IP_FP")})),p=Object(i.action)("processAttachmentPreviewsForItems")(function(e,t,n){var r=e.filter(function(e){return e.AttachmentPreviews}),i=[];r.forEach(function(e){i.push.apply(i,o.__spread(e.AttachmentPreviews.Previews))});var a={};i.forEach(function(e){var n=e.ParentItemId.Id;t.indexOf(n)>-1&&(a[n]||(a[n]=[]),a[n].push(e))}),t.forEach(function(e){var t=l.H.items.get(e);t?a[e]?m(e,a[e],n):(t.shouldShowAttachmentPreviews=!1,c(e)):delete a[e]})}),m=Object(i.action)("processAttachmentsForRow")(function(e,t,n){return o.__awaiter(this,void 0,void 0,function(){var r,i=this;return o.__generator(this,function(c){switch(c.label){case 0:return r={documentViewStateIds:[],imageViewStateIds:[]},[4,Promise.all(t.map(function(t){return o.__awaiter(i,void 0,void 0,function(){return o.__generator(this,function(i){switch(i.label){case 0:return[4,b(e,o.__assign({},t.ParentItemId,{mailboxInfo:n}),t.Attachment,r,n)];case 1:return i.sent(),[2]}})})}))];case 1:return c.sent(),a.a.rowAttachmentPreviewWellViews.set(e,r),[2]}})})}),v=n(1963),g=n.n(v),S=n(1716),O=n.n(S);function _(e,t,n){var r=O()(o.__assign({},n,{ConversationIds:e}));return g()(r,t).then(function(e){return e})}var I=n(13),j=n(56),E=new Map,T=Object(i.select)({rowIdsToGetPreviewsMap:function(){return E}})(Object(i.action)("AttachmentPreviewsOperations.add")(function(e,t,n,r){var o=r.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId];o||(o={conversationsIdsArray:[],itemIdsArray:[]},r.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId]=o),-1==o.conversationsIdsArray.indexOf(t)&&o.conversationsIdsArray.push(t),-1==o.itemIdsArray.indexOf(n)&&o.itemIdsArray.push(n)})),w=Object(i.select)({rowIdsToGetPreviewsMap:function(){return E}})(Object(i.action)("AttachmentPreviewsOperations.getPreviews")(function(e,t,n){return o.__awaiter(this,void 0,void 0,function(){var r,i,a,c,u;return o.__generator(this,function(o){switch(o.label){case 0:if(!(r=n.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId]))return[2];i=r.conversationsIdsArray,a=r.itemIdsArray,c=Object(j.a)(),delete n.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId],o.label=1;case 1:return o.trys.push([1,3,,4]),[4,_(i,e&&e.requestOptions,{IncludeInlineAttachments:c})];case 2:return void 0!==(u=o.sent()).Conversations?1==t?p(u.Conversations,a,e):function(e,t){e.forEach(function(e){h(e,t)})}(u.Conversations,e):C(t,a,i),[3,4];case 3:return o.sent(),C(t,a,i),[3,4];case 4:return[2]}})})}));function C(e,t,n){1==e?t.forEach(function(e){var t=l.H.items.get(e);t&&(I.O.rowAttachmentPreviewWellViews.get(e)||(t.shouldShowAttachmentPreviews=!1))}):n.forEach(function(e){var t=e.Id,n=I.O.conversationItems.get(t);n&&(I.O.rowAttachmentPreviewWellViews.get(t)||(n.shouldShowAttachmentPreviews=!1))})}var y=Object(i.action)("AttachmentPreviewsOperations.getAttachmentsForConversationWell")(function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n,r,i,a;return o.__generator(this,function(c){switch(c.label){case 0:t=[e],n=[],r={},i={},c.label=1;case 1:return c.trys.push([1,3,,4]),[4,_(t,e.mailboxInfo&&e.mailboxInfo.requestOptions,{FullPreviewsPerConversation:300,PreviewsPerConversation:300,MinimumAttachmentSize:0,IncludeInlineAttachments:!1})];case 2:return void 0!==(a=c.sent()).Conversations&&a.Conversations.forEach(function(t){t.ConversationId.Id==e.Id&&t.AttachmentPreviews&&t.AttachmentPreviews.Previews&&t.AttachmentPreviews.Previews.forEach(function(t){n.push(t.Attachment),r[t.Attachment.AttachmentId.Id]=o.__assign({},t.ParentItemId,{mailboxInfo:e.mailboxInfo}),i[t.Attachment.AttachmentId.Id]=t.ItemReceivedTime})}),[3,4];case 3:return c.sent(),[3,4];case 4:return[2,[n,r,i]]}})})}),x=n(238),A=n(95),P=n(511);var R=n(811);function N(e,t){if(t.folderId&&"junkemail"==Object(A.a)(t.folderId))return!1;if(Object(R.a)(e))return!1;var n=l.H.items.get(e.ItemId.Id);return n?n.shouldShowAttachmentPreviews:!(!e.HasAttachments&&!e.HasSharepointLink)&&(T(Object(x.c)(t),e.ConversationId,e.ItemId.Id),!0)}var F=Object(i.select)({listViewStore:function(){return I.O}})(function(e,t,n){var r,o,i,a=1==t.type,c=e.ConversationId,u=n.listViewStore.conversationItems.get(c.Id);if(t.folderId&&"junkemail"==Object(A.a)(t.folderId))return!1;if((r=e)&&r.ItemClasses&&r.ItemClasses.length>0&&r.ItemClasses.some(function(e){return 0===e.indexOf(P.e)}))return!1;if(a){if(u)return u.shouldShowAttachmentPreviews;o=i=!!e.HasAttachments}else{if(!e.HasAttachmentPreviews&&!e.HasSharepointLink)return!1;u?(o=u.globalItemIds.length!=e.GlobalItemIds.length,i=u.shouldShowAttachmentPreviews):(o=!0,i=!0)}return o&&T(Object(x.c)(t),e.ConversationId,null),i});n.d(t,"a",function(){return r}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return F}),n.d(t,"d",function(){return N})},97:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"e",function(){return s}),n.d(t,"f",function(){return d}),n.d(t,"g",function(){return l}),n.d(t,"h",function(){return f}),n.d(t,"i",function(){return b}),n.d(t,"j",function(){return h}),n.d(t,"k",function(){return p}),n.d(t,"l",function(){return m}),n.d(t,"o",function(){return v}),n.d(t,"p",function(){return g}),n.d(t,"q",function(){return S}),n.d(t,"r",function(){return O}),n.d(t,"s",function(){return _}),n.d(t,"t",function(){return I}),n.d(t,"u",function(){return j}),n.d(t,"v",function(){return E}),n.d(t,"w",function(){return T}),n.d(t,"x",function(){return w}),n.d(t,"y",function(){return C}),n.d(t,"z",function(){return y}),n.d(t,"A",function(){return x}),n.d(t,"B",function(){return A}),n.d(t,"m",function(){return P}),n.d(t,"n",function(){return R});var r=n(1),o=n(26),i=Object(r.action)("ADD_SUGGESTION_PILL_INTERNAL",function(e,t){return{suggestionPill:e,scenarioId:t}}),a=Object(r.action)("GHOST_TEXT_ACCEPTED",function(e){return{scenarioId:e}}),c=Object(r.action)("INITIALIZE_SCENARIO_STORE",function(e,t){return{scenarioId:e,isUsing3S:t}}),u=Object(r.action)("ON_BACKSPACE_PRESSED_SEARCH_INPUT",function(e,t){return{cursorPosition:e,scenarioId:t}}),s=Object(r.action)("ON_DOWN_ARROW_PRESSED_SEARCH_INPUT",function(e){return{scenarioId:e}}),d=Object(r.action)("ON_ENTER_PRESSED_SEARCH_INPUT",function(e,t,n,r){return{selectedSuggestionIndex:e,searchInputValue:t,isAutocompleteTextVisible:n,scenarioId:r}}),l=Object(r.action)("ON_ESCAPE_PRESSED_SEARCH_INPUT",function(e){return{scenarioId:e}}),f=Object(r.action)("ON_KEY_DOWN_SEARCH_INPUT",function(e,t){return{evtKeyCode:e,scenarioId:t}}),b=Object(r.action)("ON_LEFT_ARROW_PRESSED_SEARCH_INPUT",function(e,t){return{cursorPosition:e,scenarioId:t}}),h=Object(r.action)("ON_RESIZE_SUGGESTIONSCALLOUT",function(e,t){return{searchBoxWidth:e,scenarioId:t}}),p=Object(r.action)("ON_Right_ARROW_PRESSED_SEARCH_INPUT",function(e){return{scenarioId:e}}),m=Object(r.action)("ON_SEARCH_INPUT_FOCUSED",function(e){return Object(o.a)({name:"ON_SEARCH_INPUT_FOCUSED"},{scenarioId:e})}),v=Object(r.action)("ON_UP_ARROW_PRESSED_SEARCH_INPUT",function(e){return{scenarioId:e}}),g=(Object(r.action)("REMOVE_PARAMETER_PILL_FROM_STORE",function(e){return{scenarioId:e}}),Object(r.action)("REMOVE_SUGGESTION_PILL_FROM_SEARCHBOX",function(e,t,n){return{suggestionPillId:e,scenarioId:t,actionSource:n}})),S=Object(r.action)("REMOVE_SUGGESTION_PILL_FROM_STORE",function(e,t,n){return{suggestionPillId:e,suggestionPillIndex:t,scenarioId:n}}),O=Object(r.action)("REMOVE_SUGGESTION_SEGMENT_FROM_SEARCHBOX",function(e,t){return{segmentKey:e,scenarioId:t}}),_=Object(r.action)("REMOVE_SUGGESTION_SEGMENT_FROM_SEARCHBOX_INTERNAL",function(e,t){return{segmentKey:e,scenarioId:t}}),I=Object(r.action)("RESET_SEARCH_STORE",function(e){return{scenarioId:e}}),j=Object(r.action)("SET_SEARCH_TEXT",function(e,t){return{searchText:e,scenarioId:t}}),E=Object(r.action)("SET_SELECTED_PILL_INDEX",function(e,t){return{selectedPillIndex:e,scenarioId:t}}),T=Object(r.action)("SET_SELECTED_SUGGESTION_INDEX",function(e,t){return{selectedSuggestionIndex:e,scenarioId:t}}),w=Object(r.action)("SET_SUGGESTION_PILL_IDS",function(e,t){return{suggestionPillIds:e,scenarioId:t}}),C=Object(r.action)("SET_SUGGESTION_PILLS",function(e,t){return{suggestionPills:e,scenarioId:t}}),y=Object(r.action)("SET_SUGGESTION_SEGMENTS_INTERNAL",function(e,t){return{segments:e,scenarioId:t}}),x=Object(r.action)("UPDATE_GHOST_TEXT",function(e){return{scenarioId:e}}),A=Object(r.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE_INTERNAL",function(e,t){return{isComplete:e,scenarioId:t}}),P=Object(r.action)("ON_SUGGESTIONS_CALLOUT_POSITIONED",function(e){return{scenarioId:e}}),R=Object(r.action)("ON_SUGGESTIONS_CALLOUT_WILL_UNMOUNT",function(e){return{scenarioId:e}})},993:function(e,t,n){"use strict";var r=n(8),o=n(1),i={attachments:new r.ObservableMap({})},a=Object(o.createStore)("attachment",i);t.a=a},994:function(e,t,n){"use strict";var r=function(e){return e&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(e)},o=n(4),i=n(320);function a(e){switch(e.__type){case i.e:return 0;case i.n:return e.IsLink?3:1;case i.i:return 3;case i.g:return 2;case i.h:var t=e;return r(e.EmbeddedItemClass)||Object(o.g)(t.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+e.__type)}}n.d(t,"a",function(){return a})},998:function(e,t,n){"use strict";var r=n(34),o=n(1);t.a=Object(o.mutatorAction)("setNextSearchQueryId",function(e,t){Object(r.a)(t).nextSearchQueryId=e})}},0,[0,1,30,474,155,4,7,8,19,292,11,513,354,2,6,9,107,3,5,288,12,37,103,463,87,464,98,498,299,195,287,445,447,567]]);
//# sourceMappingURL=owa.MailFavoritesStore.js.map
self.scriptsLoaded['owa.MailFavoritesStore.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailFavoritesStore.js'] = (new Date()).getTime();